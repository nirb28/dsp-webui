var iD=Object.defineProperty;var iv=n=>{throw TypeError(n)};var sD=(n,e,t)=>e in n?iD(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var He=(n,e,t)=>sD(n,typeof e!="symbol"?e+"":e,t),Zy=(n,e,t)=>e.has(n)||iv("Cannot "+t);var b=(n,e,t)=>(Zy(n,e,"read from private field"),t?t.call(n):e.get(n)),B=(n,e,t)=>e.has(n)?iv("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),O=(n,e,t,i)=>(Zy(n,e,"write to private field"),i?i.call(n,t):e.set(n,t),t),D=(n,e,t)=>(Zy(n,e,"access private method"),t);var Mr=(n,e,t,i)=>({set _(s){O(n,e,s,t)},get _(){return b(n,e,i)}});import{s as Ut,y as It,e as ee,k as Ce,c as te,o as Ae,f as A,U as nn,i as $,u as yt,A as qt,d as E,j as Pe,p as as,C as hn,a as q,r as Gs,v as Vs,w as qs,x as Ws,l as zt,S as vo,g as K,D as at,E as ot,t as vt,b as kt,h as Et,F as ko,n as Ct,W as Xa,q as ol,J as Kh,G as Qr,Z as b0,z as qg,B as yo,X as Q6,Y as $6,aq as mn,L as $i,M as oi,N as ll,Q as aa,V as Ls,a3 as $e,a4 as Ep,ar as d3,al as TI,a0 as f3,O as Xn,a2 as Ag,K as s0,ak as rD,as as aD,ao as oD,am as sv,an as rv,T as av,R as Ex,m as lD}from"./osRMcaoZ.js";import{S as Nt,i as Ot,f as Wt,b as me,d as xe,m as pe,t as U,a as W,e as be,g as bt,c as xt,h as Xf}from"./Cz_TVcYH.js";import{g as RI}from"./D0QH3NT1.js";import{t as Jt,p as g3}from"./CvcJvn8o.js";import{j as Ko,bB as MI,bC as e4,bD as Qy,bE as $y,aG as Wg,bF as cD,aq as hD,bG as uD,bH as dD,bI as fD,bJ as gD}from"./RzT9Pn6s.js";import{C as mD,D as pD,I as bD,a as xD,h as yD,b as PI,c as wD,P as _D}from"./DdKTxnuc.js";import{w as en,a as Io,d as Yf,g as ov}from"./1eR21JWE.js";import{p as lv}from"./DfjoWiH-.js";import{t as Gd,u as k0,c as Kg,j as nx,E as NI,a as Ga,n as Fd,m as Xg,T as Qw,e as Yo,d as vD,Z as cv,_ as Ba,H as Xi,K as r0,G as Zl,W as OI,h as uu,s as $w,P as kD,i as CD,f as hv,C as AD,J as SD,Q as Jf,D as kl,F as mc,o as ID,S as Tx,l as ED}from"./DUlFqCOB.js";import{v as Cl,L as uv,M as TD,a as Da,h as RD,i as MD,j as PD,k as ND,n as OD,o as DD,p as FD,m as Sg,q as LD,d as t4,y as BD,l as UD,g as HD,w as m3,N as zD,O as jD,P as GD,b as VD,E as ew,D as tw}from"./C3cxvGum.js";import{h as e8,v as qD,j as T0,C as WD,u as nw,e as KD,a as XD}from"./BiJCbRrE.js";import{g as YD}from"./-Lmj9_YH.js";import{p as JD,c as ZD}from"./DiCcU1O6.js";import{j as dv,g as fv,k as gv}from"./6yqafMIy.js";import{w as QD,x as $D,y as eF,z as tF,A as nF,B as iF,C as sF}from"./D5SIsFJr.js";import{g as n4,j as rF,k as aF,m as oF}from"./C16yeCz_.js";import{f as Zf}from"./DMHG7wso.js";import{e as Zn,u as ix,o as q5,d as lF}from"./DCwEHxc-.js";import{u as cF}from"./DSe3e2a0.js";import"./BWrnINzs.js";import{M as DI,a as FI,b as LI}from"./Ba9RO0z0.js";import{M as ua}from"./EBD6j5Xg.js";import{b as i4}from"./zuTWMoVs.js";import{f as W5}from"./CBc5jlPY.js";import{D as s4}from"./D8FxhTRD.js";import{T as wi}from"./BOoEfdYa.js";import{S as hF}from"./7W7X_sVg.js";import{W as uF,B as r4}from"./pT-D0jZt.js";import{V as dF,R as fF,D as gF}from"./Dp4U4rP8.js";import{F as mF}from"./0VwBZy6c.js";import{M as pF}from"./BbL-Ydhu.js";import{X as sx}from"./YHUoul5_.js";import{F as BI}from"./5RhMWXVw.js";import{G as bF}from"./CajVTryx.js";import{a as xF}from"./DuxTsn3k.js";import{K as yF,S as wF,M as _F}from"./CQwG-mXl.js";import{T as vF,S as kF,F as CF,a as AF,u as SF,d as IF}from"./D1FiY7TG.js";import{S as EF}from"./C4FzyR2d.js";import{f as UI}from"./CyTOOynw.js";import{E as mv,h as TF}from"./Bo__pBor.js";import{M as RF,U as MF}from"./BvEeXm2X.js";import{M as PF}from"./D4CPDuR7.js";import{P as HI}from"./DqQWfcuJ.js";/* empty css        */import{A as NF}from"./Dwz7WGHO.js";import{g as OF,j as DF,k as FF,m as LF}from"./DYXaXl2Z.js";import{S as a4}from"./XYvaYOQu.js";import{V as BF,H as UF}from"./ByAUCNUj.js";import{s as HF,t as zF}from"./Dx8G6d6m.js";import{P as zI}from"./UzcSbTlA.js";import{g as Lh,a as Tp}from"./CgU5AtxT.js";import{E as jF}from"./Dsx5TKO5.js";import{A as GF}from"./wbTxV288.js";import{C as jI}from"./CxRe37LO.js";import{E as VF}from"./CHRctSa9.js";import{d as t8}from"./I1CDPYOB.js";import{E as qF}from"./B2AZZEdi.js";function WF(n){let e;for(;e=n.sourceEvent;)n=e;return n}function Al(n,e){if(n=WF(n),e===void 0&&(e=n.currentTarget),e){var t=e.ownerSVGElement||e;if(t.createSVGPoint){var i=t.createSVGPoint();return i.x=n.clientX,i.y=n.clientY,i=i.matrixTransform(e.getScreenCTM().inverse()),[i.x,i.y]}if(e.getBoundingClientRect){var s=e.getBoundingClientRect();return[n.clientX-s.left-e.clientLeft,n.clientY-s.top-e.clientTop]}}return[n.pageX,n.pageY]}const KF={passive:!1},Rp={capture:!0,passive:!1};function iw(n){n.stopImmediatePropagation()}function Qf(n){n.preventDefault(),n.stopImmediatePropagation()}function GI(n){var e=n.document.documentElement,t=Ko(n).on("dragstart.drag",Qf,Rp);"onselectstart"in e?t.on("selectstart.drag",Qf,Rp):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function VI(n,e){var t=n.document.documentElement,i=Ko(n).on("dragstart.drag",null);e&&(i.on("click.drag",Qf,Rp),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in t?i.on("selectstart.drag",null):(t.style.MozUserSelect=t.__noselect,delete t.__noselect)}const Rx=n=>()=>n;function n8(n,{sourceEvent:e,subject:t,target:i,identifier:s,active:r,x:a,y:o,dx:l,dy:c,dispatch:h}){Object.defineProperties(this,{type:{value:n,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:t,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},identifier:{value:s,enumerable:!0,configurable:!0},active:{value:r,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:o,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:h}})}n8.prototype.on=function(){var n=this._.on.apply(this._,arguments);return n===this._?this:n};function XF(n){return!n.ctrlKey&&!n.button}function YF(){return this.parentNode}function JF(n,e){return e??{x:n.x,y:n.y}}function ZF(){return navigator.maxTouchPoints||"ontouchstart"in this}function QF(){var n=XF,e=YF,t=JF,i=ZF,s={},r=MI("start","drag","end"),a=0,o,l,c,h,u=0;function d(_){_.on("mousedown.drag",f).filter(i).on("touchstart.drag",x).on("touchmove.drag",p,KF).on("touchend.drag touchcancel.drag",y).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function f(_,v){if(!(h||!n.call(this,_,v))){var C=w(this,e.call(this,_,v),_,v,"mouse");C&&(Ko(_.view).on("mousemove.drag",g,Rp).on("mouseup.drag",m,Rp),GI(_.view),iw(_),c=!1,o=_.clientX,l=_.clientY,C("start",_))}}function g(_){if(Qf(_),!c){var v=_.clientX-o,C=_.clientY-l;c=v*v+C*C>u}s.mouse("drag",_)}function m(_){Ko(_.view).on("mousemove.drag mouseup.drag",null),VI(_.view,c),Qf(_),s.mouse("end",_)}function x(_,v){if(n.call(this,_,v)){var C=_.changedTouches,k=e.call(this,_,v),I=C.length,S,M;for(S=0;S<I;++S)(M=w(this,k,_,v,C[S].identifier,C[S]))&&(iw(_),M("start",_,C[S]))}}function p(_){var v=_.changedTouches,C=v.length,k,I;for(k=0;k<C;++k)(I=s[v[k].identifier])&&(Qf(_),I("drag",_,v[k]))}function y(_){var v=_.changedTouches,C=v.length,k,I;for(h&&clearTimeout(h),h=setTimeout(function(){h=null},500),k=0;k<C;++k)(I=s[v[k].identifier])&&(iw(_),I("end",_,v[k]))}function w(_,v,C,k,I,S){var M=r.copy(),N=Al(S||C,v),F,H,T;if((T=t.call(_,new n8("beforestart",{sourceEvent:C,target:d,identifier:I,active:a,x:N[0],y:N[1],dx:0,dy:0,dispatch:M}),k))!=null)return F=T.x-N[0]||0,H=T.y-N[1]||0,function z(R,L,Y){var j=N,J;switch(R){case"start":s[I]=z,J=a++;break;case"end":delete s[I],--a;case"drag":N=Al(Y||L,v),J=a;break}M.call(R,_,new n8(R,{sourceEvent:L,subject:T,target:d,identifier:I,active:J,x:N[0]+F,y:N[1]+H,dx:N[0]-j[0],dy:N[1]-j[1],dispatch:M}),k)}}return d.filter=function(_){return arguments.length?(n=typeof _=="function"?_:Rx(!!_),d):n},d.container=function(_){return arguments.length?(e=typeof _=="function"?_:Rx(_),d):e},d.subject=function(_){return arguments.length?(t=typeof _=="function"?_:Rx(_),d):t},d.touchable=function(_){return arguments.length?(i=typeof _=="function"?_:Rx(!!_),d):i},d.on=function(){var _=r.on.apply(r,arguments);return _===r?d:_},d.clickDistance=function(_){return arguments.length?(u=(_=+_)*_,d):Math.sqrt(u)},d}var $F=1e-12;function pv(n){return((n=Math.exp(n))+1/n)/2}function eL(n){return((n=Math.exp(n))-1/n)/2}function tL(n){return((n=Math.exp(2*n))-1)/(n+1)}const nL=function n(e,t,i){function s(r,a){var o=r[0],l=r[1],c=r[2],h=a[0],u=a[1],d=a[2],f=h-o,g=u-l,m=f*f+g*g,x,p;if(m<$F)p=Math.log(d/c)/e,x=function(k){return[o+k*f,l+k*g,c*Math.exp(e*k*p)]};else{var y=Math.sqrt(m),w=(d*d-c*c+i*m)/(2*c*t*y),_=(d*d-c*c-i*m)/(2*d*t*y),v=Math.log(Math.sqrt(w*w+1)-w),C=Math.log(Math.sqrt(_*_+1)-_);p=(C-v)/e,x=function(k){var I=k*p,S=pv(v),M=c/(t*y)*(S*tL(e*I+v)-eL(v));return[o+M*f,l+M*g,c*S/pv(e*I+v)]}}return x.duration=p*1e3*e/Math.SQRT2,x}return s.rho=function(r){var a=Math.max(.001,+r),o=a*a,l=o*o;return n(a,o,l)},s}(Math.SQRT2,2,4),Mx=n=>()=>n;function iL(n,{sourceEvent:e,target:t,transform:i,dispatch:s}){Object.defineProperties(this,{type:{value:n,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:t,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:s}})}function sw(n){n.stopImmediatePropagation()}function wm(n){n.preventDefault(),n.stopImmediatePropagation()}function sL(n){return(!n.ctrlKey||n.type==="wheel")&&!n.button}function rL(){var n=this;return n instanceof SVGElement?(n=n.ownerSVGElement||n,n.hasAttribute("viewBox")?(n=n.viewBox.baseVal,[[n.x,n.y],[n.x+n.width,n.y+n.height]]):[[0,0],[n.width.baseVal.value,n.height.baseVal.value]]):[[0,0],[n.clientWidth,n.clientHeight]]}function bv(){return this.__zoom||e4}function aL(n){return-n.deltaY*(n.deltaMode===1?.05:n.deltaMode?1:.002)*(n.ctrlKey?10:1)}function oL(){return navigator.maxTouchPoints||"ontouchstart"in this}function lL(n,e,t){var i=n.invertX(e[0][0])-t[0][0],s=n.invertX(e[1][0])-t[1][0],r=n.invertY(e[0][1])-t[0][1],a=n.invertY(e[1][1])-t[1][1];return n.translate(s>i?(i+s)/2:Math.min(0,i)||Math.max(0,s),a>r?(r+a)/2:Math.min(0,r)||Math.max(0,a))}function cL(){var n=sL,e=rL,t=lL,i=aL,s=oL,r=[0,1/0],a=[[-1/0,-1/0],[1/0,1/0]],o=250,l=nL,c=MI("start","zoom","end"),h,u,d,f=500,g=150,m=0,x=10;function p(T){T.property("__zoom",bv).on("wheel.zoom",I,{passive:!1}).on("mousedown.zoom",S).on("dblclick.zoom",M).filter(s).on("touchstart.zoom",N).on("touchmove.zoom",F).on("touchend.zoom touchcancel.zoom",H).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}p.transform=function(T,z,R,L){var Y=T.selection?T.selection():T;Y.property("__zoom",bv),T!==Y?v(T,z,R,L):Y.interrupt().each(function(){C(this,arguments).event(L).start().zoom(null,typeof z=="function"?z.apply(this,arguments):z).end()})},p.scaleBy=function(T,z,R,L){p.scaleTo(T,function(){var Y=this.__zoom.k,j=typeof z=="function"?z.apply(this,arguments):z;return Y*j},R,L)},p.scaleTo=function(T,z,R,L){p.transform(T,function(){var Y=e.apply(this,arguments),j=this.__zoom,J=R==null?_(Y):typeof R=="function"?R.apply(this,arguments):R,G=j.invert(J),se=typeof z=="function"?z.apply(this,arguments):z;return t(w(y(j,se),J,G),Y,a)},R,L)},p.translateBy=function(T,z,R,L){p.transform(T,function(){return t(this.__zoom.translate(typeof z=="function"?z.apply(this,arguments):z,typeof R=="function"?R.apply(this,arguments):R),e.apply(this,arguments),a)},null,L)},p.translateTo=function(T,z,R,L,Y){p.transform(T,function(){var j=e.apply(this,arguments),J=this.__zoom,G=L==null?_(j):typeof L=="function"?L.apply(this,arguments):L;return t(e4.translate(G[0],G[1]).scale(J.k).translate(typeof z=="function"?-z.apply(this,arguments):-z,typeof R=="function"?-R.apply(this,arguments):-R),j,a)},L,Y)};function y(T,z){return z=Math.max(r[0],Math.min(r[1],z)),z===T.k?T:new Qy(z,T.x,T.y)}function w(T,z,R){var L=z[0]-R[0]*T.k,Y=z[1]-R[1]*T.k;return L===T.x&&Y===T.y?T:new Qy(T.k,L,Y)}function _(T){return[(+T[0][0]+ +T[1][0])/2,(+T[0][1]+ +T[1][1])/2]}function v(T,z,R,L){T.on("start.zoom",function(){C(this,arguments).event(L).start()}).on("interrupt.zoom end.zoom",function(){C(this,arguments).event(L).end()}).tween("zoom",function(){var Y=this,j=arguments,J=C(Y,j).event(L),G=e.apply(Y,j),se=R==null?_(G):typeof R=="function"?R.apply(Y,j):R,de=Math.max(G[1][0]-G[0][0],G[1][1]-G[0][1]),he=Y.__zoom,we=typeof z=="function"?z.apply(Y,j):z,ye=l(he.invert(se).concat(de/he.k),we.invert(se).concat(de/we.k));return function(P){if(P===1)P=we;else{var V=ye(P),re=de/V[2];P=new Qy(re,se[0]-V[0]*re,se[1]-V[1]*re)}J.zoom(null,P)}})}function C(T,z,R){return!R&&T.__zooming||new k(T,z)}function k(T,z){this.that=T,this.args=z,this.active=0,this.sourceEvent=null,this.extent=e.apply(T,z),this.taps=0}k.prototype={event:function(T){return T&&(this.sourceEvent=T),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(T,z){return this.mouse&&T!=="mouse"&&(this.mouse[1]=z.invert(this.mouse[0])),this.touch0&&T!=="touch"&&(this.touch0[1]=z.invert(this.touch0[0])),this.touch1&&T!=="touch"&&(this.touch1[1]=z.invert(this.touch1[0])),this.that.__zoom=z,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(T){var z=Ko(this.that).datum();c.call(T,this.that,new iL(T,{sourceEvent:this.sourceEvent,target:p,type:T,transform:this.that.__zoom,dispatch:c}),z)}};function I(T,...z){if(!n.apply(this,arguments))return;var R=C(this,z).event(T),L=this.__zoom,Y=Math.max(r[0],Math.min(r[1],L.k*Math.pow(2,i.apply(this,arguments)))),j=Al(T);if(R.wheel)(R.mouse[0][0]!==j[0]||R.mouse[0][1]!==j[1])&&(R.mouse[1]=L.invert(R.mouse[0]=j)),clearTimeout(R.wheel);else{if(L.k===Y)return;R.mouse=[j,L.invert(j)],$y(this),R.start()}wm(T),R.wheel=setTimeout(J,g),R.zoom("mouse",t(w(y(L,Y),R.mouse[0],R.mouse[1]),R.extent,a));function J(){R.wheel=null,R.end()}}function S(T,...z){if(d||!n.apply(this,arguments))return;var R=T.currentTarget,L=C(this,z,!0).event(T),Y=Ko(T.view).on("mousemove.zoom",se,!0).on("mouseup.zoom",de,!0),j=Al(T,R),J=T.clientX,G=T.clientY;GI(T.view),sw(T),L.mouse=[j,this.__zoom.invert(j)],$y(this),L.start();function se(he){if(wm(he),!L.moved){var we=he.clientX-J,ye=he.clientY-G;L.moved=we*we+ye*ye>m}L.event(he).zoom("mouse",t(w(L.that.__zoom,L.mouse[0]=Al(he,R),L.mouse[1]),L.extent,a))}function de(he){Y.on("mousemove.zoom mouseup.zoom",null),VI(he.view,L.moved),wm(he),L.event(he).end()}}function M(T,...z){if(n.apply(this,arguments)){var R=this.__zoom,L=Al(T.changedTouches?T.changedTouches[0]:T,this),Y=R.invert(L),j=R.k*(T.shiftKey?.5:2),J=t(w(y(R,j),L,Y),e.apply(this,z),a);wm(T),o>0?Ko(this).transition().duration(o).call(v,J,L,T):Ko(this).call(p.transform,J,L,T)}}function N(T,...z){if(n.apply(this,arguments)){var R=T.touches,L=R.length,Y=C(this,z,T.changedTouches.length===L).event(T),j,J,G,se;for(sw(T),J=0;J<L;++J)G=R[J],se=Al(G,this),se=[se,this.__zoom.invert(se),G.identifier],Y.touch0?!Y.touch1&&Y.touch0[2]!==se[2]&&(Y.touch1=se,Y.taps=0):(Y.touch0=se,j=!0,Y.taps=1+!!h);h&&(h=clearTimeout(h)),j&&(Y.taps<2&&(u=se[0],h=setTimeout(function(){h=null},f)),$y(this),Y.start())}}function F(T,...z){if(this.__zooming){var R=C(this,z).event(T),L=T.changedTouches,Y=L.length,j,J,G,se;for(wm(T),j=0;j<Y;++j)J=L[j],G=Al(J,this),R.touch0&&R.touch0[2]===J.identifier?R.touch0[0]=G:R.touch1&&R.touch1[2]===J.identifier&&(R.touch1[0]=G);if(J=R.that.__zoom,R.touch1){var de=R.touch0[0],he=R.touch0[1],we=R.touch1[0],ye=R.touch1[1],P=(P=we[0]-de[0])*P+(P=we[1]-de[1])*P,V=(V=ye[0]-he[0])*V+(V=ye[1]-he[1])*V;J=y(J,Math.sqrt(P/V)),G=[(de[0]+we[0])/2,(de[1]+we[1])/2],se=[(he[0]+ye[0])/2,(he[1]+ye[1])/2]}else if(R.touch0)G=R.touch0[0],se=R.touch0[1];else return;R.zoom("touch",t(w(J,G,se),R.extent,a))}}function H(T,...z){if(this.__zooming){var R=C(this,z).event(T),L=T.changedTouches,Y=L.length,j,J;for(sw(T),d&&clearTimeout(d),d=setTimeout(function(){d=null},f),j=0;j<Y;++j)J=L[j],R.touch0&&R.touch0[2]===J.identifier?delete R.touch0:R.touch1&&R.touch1[2]===J.identifier&&delete R.touch1;if(R.touch1&&!R.touch0&&(R.touch0=R.touch1,delete R.touch1),R.touch0)R.touch0[1]=this.__zoom.invert(R.touch0[0]);else if(R.end(),R.taps===2&&(J=Al(J,this),Math.hypot(u[0]-J[0],u[1]-J[1])<x)){var G=Ko(this).on("dblclick.zoom");G&&G.apply(this,arguments)}}}return p.wheelDelta=function(T){return arguments.length?(i=typeof T=="function"?T:Mx(+T),p):i},p.filter=function(T){return arguments.length?(n=typeof T=="function"?T:Mx(!!T),p):n},p.touchable=function(T){return arguments.length?(s=typeof T=="function"?T:Mx(!!T),p):s},p.extent=function(T){return arguments.length?(e=typeof T=="function"?T:Mx([[+T[0][0],+T[0][1]],[+T[1][0],+T[1][1]]]),p):e},p.scaleExtent=function(T){return arguments.length?(r[0]=+T[0],r[1]=+T[1],p):[r[0],r[1]]},p.translateExtent=function(T){return arguments.length?(a[0][0]=+T[0][0],a[1][0]=+T[1][0],a[0][1]=+T[0][1],a[1][1]=+T[1][1],p):[[a[0][0],a[0][1]],[a[1][0],a[1][1]]]},p.constrain=function(T){return arguments.length?(t=T,p):t},p.duration=function(T){return arguments.length?(o=+T,p):o},p.interpolate=function(T){return arguments.length?(l=T,p):l},p.on=function(){var T=c.on.apply(c,arguments);return T===c?p:T},p.clickDistance=function(T){return arguments.length?(m=(T=+T)*T,p):Math.sqrt(m)},p.tapDistance=function(T){return arguments.length?(x=+T,p):x},p}function hL(n){let e,t,i,s,r,a,o;return l(),{feed:c,reset:l};function l(){e=!0,t="",i=0,s=-1,r=void 0,a=void 0,o=""}function c(u){t=t?t+u:u,e&&uL(t)&&(t=t.slice(qI.length)),e=!1;const d=t.length;let f=0,g=!1;for(;f<d;){g&&(t[f]===`
`&&++f,g=!1);let m=-1,x=s,p;for(let y=i;m<0&&y<d;++y)p=t[y],p===":"&&x<0?x=y-f:p==="\r"?(g=!0,m=y-f):p===`
`&&(m=y-f);if(m<0){i=d-f,s=x;break}else i=0,s=-1;h(t,f,x,m),f+=m+1}f===d?t="":f>0&&(t=t.slice(f))}function h(u,d,f,g){if(g===0){o.length>0&&(n({type:"event",id:r,event:a||void 0,data:o.slice(0,-1)}),o="",r=void 0),a=void 0;return}const m=f<0,x=u.slice(d,d+(m?g:f));let p=0;m?p=g:u[d+f+1]===" "?p=f+2:p=f+1;const y=d+p,w=g-p,_=u.slice(y,y+w).toString();if(x==="data")o+=_?"".concat(_,`
`):`
`;else if(x==="event")a=_;else if(x==="id"&&!_.includes("\0"))r=_;else if(x==="retry"){const v=parseInt(_,10);Number.isNaN(v)||n({type:"reconnect-interval",value:v})}}}const qI=[239,187,191];function uL(n){return qI.every((e,t)=>n.charCodeAt(t)===e)}class dL extends TransformStream{constructor(){let e;super({start(t){e=hL(i=>{i.type==="event"&&t.enqueue(i)})},transform(t){e.feed(t)}})}}async function fL(n,e){const t=n.pipeThrough(new TextDecoderStream).pipeThrough(new dL).getReader();let i=gL(t);return e&&(i=mL(i)),i}async function*gL(n){var e,t,i;for(;;){const{value:s,done:r}=await n.read();if(r){yield{done:!0,value:""};break}if(!s)continue;const a=s.data;if(a.startsWith("[DONE]")){yield{done:!0,value:""};break}try{const o=JSON.parse(a);if(o.error){yield{done:!0,value:"",error:o.error};break}if(o.sources){yield{done:!1,value:"",sources:o.sources};continue}if(o.selected_model_id){yield{done:!1,value:"",selectedModelId:o.selected_model_id};continue}if(o.usage){yield{done:!1,value:"",usage:o.usage};continue}yield{done:!1,value:((i=(t=(e=o.choices)==null?void 0:e[0])==null?void 0:t.delta)==null?void 0:i.content)??""}}catch(o){console.error("Error extracting delta from SSE event:",o)}}}async function*mL(n){for await(const e of n){if(e.done){yield e;return}if(e.error){yield e;continue}if(e.sources){yield e;continue}if(e.selectedModelId){yield e;continue}if(e.usage){yield e;continue}let t=e.value;if(t.length<5){yield{done:!1,value:t};continue}for(;t!="";){const i=Math.min(Math.floor(Math.random()*3)+1,t.length);yield{done:!1,value:t.slice(0,i)},(document==null?void 0:document.visibilityState)!=="hidden"&&await pL(5),t=t.slice(i)}}}const pL=n=>new Promise(e=>setTimeout(e,n)),Ur=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),i8=[.001,0,0,.001,0,0],rw=1.35,Fa={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},O0={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},WI="pdfjs_internal_editor_",wn={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,SIGNATURE:101},Gn={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},bL={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},br={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},x9={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},fs={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},yf={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},K5={ERRORS:0,WARNINGS:1,INFOS:5},p3={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},Px={moveTo:0,lineTo:1,curveTo:2,closePath:3},xL={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let X5=K5.WARNINGS;function yL(n){Number.isInteger(n)&&(X5=n)}function wL(){return X5}function Y5(n){X5>=K5.INFOS&&`${n}`}function _n(n){X5>=K5.WARNINGS&&`${n}`}function mi(n){throw new Error(n)}function ps(n,e){n||mi(e)}function _L(n){switch(n==null?void 0:n.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function KI(n,e=null,t=null){if(!n)return null;if(t&&typeof n=="string"){if(t.addDefaultProtocol&&n.startsWith("www.")){const s=n.match(/\./g);(s==null?void 0:s.length)>=2&&(n=`http://${n}`)}if(t.tryConvertEncoding)try{n=SL(n)}catch{}}const i=e?URL.parse(n,e):URL.parse(n);return _L(i)?i:null}function XI(n,e,t=!1){const i=URL.parse(n);return i?(i.hash=e,i.href):t&&KI(n,"http://example.com")?n.split("#",1)[0]+`${e?`#${e}`:""}`:""}function Hn(n,e,t,i=!1){return Object.defineProperty(n,e,{value:t,enumerable:!i,configurable:!0,writable:!1}),t}const af=function(){function e(t,i){this.message=t,this.name=i}return e.prototype=new Error,e.constructor=e,e}();let xv=class extends af{constructor(e,t){super(e,"PasswordException"),this.code=t}},aw=class extends af{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}},s8=class extends af{constructor(e){super(e,"InvalidPDFException")}},b3=class extends af{constructor(e,t,i){super(e,"ResponseException"),this.status=t,this.missing=i}},vL=class extends af{constructor(e){super(e,"FormatError")}},Bh=class extends af{constructor(e){super(e,"AbortException")}};function YI(n){(typeof n!="object"||(n==null?void 0:n.length)===void 0)&&mi("Invalid argument for bytesToString");const e=n.length,t=8192;if(e<t)return String.fromCharCode.apply(null,n);const i=[];for(let s=0;s<e;s+=t){const r=Math.min(s+t,e),a=n.subarray(s,r);i.push(String.fromCharCode.apply(null,a))}return i.join("")}function rx(n){typeof n!="string"&&mi("Invalid argument for stringToBytes");const e=n.length,t=new Uint8Array(e);for(let i=0;i<e;++i)t[i]=n.charCodeAt(i)&255;return t}function kL(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function CL(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function AL(){try{return new Function(""),!0}catch{return!1}}class dr{static get isLittleEndian(){return Hn(this,"isLittleEndian",CL())}static get isEvalSupported(){return Hn(this,"isEvalSupported",AL())}static get isOffscreenCanvasSupported(){return Hn(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Hn(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return Hn(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){var e,t;return Hn(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const ow=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));var g0,Zw,y9,r8;let tn=(Zw=class{static makeHexColor(e,t,i){return`#${ow[e]}${ow[t]}${ow[i]}`}static scaleMinMax(e,t){let i;e[0]?(e[0]<0&&(i=t[0],t[0]=t[2],t[2]=i),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(i=t[1],t[1]=t[3],t[3]=i),t[1]*=e[3],t[3]*=e[3]):(i=t[0],t[0]=t[1],t[1]=i,i=t[2],t[2]=t[3],t[3]=i,e[1]<0&&(i=t[1],t[1]=t[3],t[3]=i),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(i=t[0],t[0]=t[2],t[2]=i),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t,i=0){const s=e[i],r=e[i+1];e[i]=s*t[0]+r*t[2]+t[4],e[i+1]=s*t[1]+r*t[3]+t[5]}static applyTransformToBezier(e,t,i=0){const s=t[0],r=t[1],a=t[2],o=t[3],l=t[4],c=t[5];for(let h=0;h<6;h+=2){const u=e[i+h],d=e[i+h+1];e[i+h]=u*s+d*a+l,e[i+h+1]=u*r+d*o+c}}static applyInverseTransform(e,t){const i=e[0],s=e[1],r=t[0]*t[3]-t[1]*t[2];e[0]=(i*t[3]-s*t[2]+t[2]*t[5]-t[4]*t[3])/r,e[1]=(-i*t[1]+s*t[0]+t[4]*t[1]-t[5]*t[0])/r}static axialAlignedBoundingBox(e,t,i){const s=t[0],r=t[1],a=t[2],o=t[3],l=t[4],c=t[5],h=e[0],u=e[1],d=e[2],f=e[3];let g=s*h+l,m=g,x=s*d+l,p=x,y=o*u+c,w=y,_=o*f+c,v=_;if(r!==0||a!==0){const C=r*h,k=r*d,I=a*u,S=a*f;g+=I,p+=I,x+=S,m+=S,y+=C,v+=C,_+=k,w+=k}i[0]=Math.min(i[0],g,x,m,p),i[1]=Math.min(i[1],y,_,w,v),i[2]=Math.max(i[2],g,x,m,p),i[3]=Math.max(i[3],y,_,w,v)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const i=e[0],s=e[1],r=e[2],a=e[3],o=i**2+s**2,l=i*r+s*a,c=r**2+a**2,h=(o+c)/2,u=Math.sqrt(h**2-(o*c-l**2));t[0]=Math.sqrt(h+u||1),t[1]=Math.sqrt(h-u||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const i=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),s=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(i>s)return null;const r=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),a=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return r>a?null:[i,r,s,a]}static pointBoundingBox(e,t,i){i[0]=Math.min(i[0],e),i[1]=Math.min(i[1],t),i[2]=Math.max(i[2],e),i[3]=Math.max(i[3],t)}static rectBoundingBox(e,t,i,s,r){r[0]=Math.min(r[0],e,i),r[1]=Math.min(r[1],t,s),r[2]=Math.max(r[2],e,i),r[3]=Math.max(r[3],t,s)}static bezierBoundingBox(e,t,i,s,r,a,o,l,c){c[0]=Math.min(c[0],e,o),c[1]=Math.min(c[1],t,l),c[2]=Math.max(c[2],e,o),c[3]=Math.max(c[3],t,l),D(this,g0,r8).call(this,e,i,r,o,t,s,a,l,3*(-e+3*(i-r)+o),6*(e-2*i+r),3*(i-e),c),D(this,g0,r8).call(this,e,i,r,o,t,s,a,l,3*(-t+3*(s-a)+l),6*(t-2*s+a),3*(s-t),c)}},g0=new WeakSet,y9=function(e,t,i,s,r,a,o,l,c,h){if(c<=0||c>=1)return;const u=1-c,d=c*c,f=d*c,g=u*(u*(u*e+3*c*t)+3*d*i)+f*s,m=u*(u*(u*r+3*c*a)+3*d*o)+f*l;h[0]=Math.min(h[0],g),h[1]=Math.min(h[1],m),h[2]=Math.max(h[2],g),h[3]=Math.max(h[3],m)},r8=function(e,t,i,s,r,a,o,l,c,h,u,d){if(Math.abs(c)<1e-12){Math.abs(h)>=1e-12&&D(this,g0,y9).call(this,e,t,i,s,r,a,o,l,-u/h,d);return}const f=h**2-4*u*c;if(f<0)return;const g=Math.sqrt(f),m=2*c;D(this,g0,y9).call(this,e,t,i,s,r,a,o,l,(-h+g)/m,d),D(this,g0,y9).call(this,e,t,i,s,r,a,o,l,(-h-g)/m,d)},B(Zw,g0),Zw);function SL(n){return decodeURIComponent(escape(n))}let lw=null,yv=null;function IL(n){return lw||(lw=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,yv=new Map([["ﬅ","ſt"]])),n.replaceAll(lw,(e,t,i)=>t?t.normalize("NFKC"):yv.get(i))}function JI(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),YI(n)}const o4="pdfjs_internal_id_";function EL(n,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[i,s,...r]=t;if(!n(i)&&!Number.isInteger(i)||!e(s))return!1;const a=r.length;let o=!0;switch(s.name){case"XYZ":if(a<2||a>3)return!1;break;case"Fit":case"FitB":return a===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(a>1)return!1;break;case"FitR":if(a!==4)return!1;o=!1;break;default:return!1}for(const l of r)if(!(typeof l=="number"||o&&l===null))return!1;return!0}function Hr(n,e,t){return Math.min(Math.max(n,e),t)}function ZI(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(YI(n))}function TL(n){return Uint8Array.fromBase64?Uint8Array.fromBase64(n):rx(atob(n))}typeof Promise.try!="function"&&(Promise.try=function(n,...e){return new Promise(t=>{t(n(...e))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(n){return n.reduce((e,t)=>e+t,0)});const uc="http://www.w3.org/2000/svg",mu=class mu{};He(mu,"CSS",96),He(mu,"PDF",72),He(mu,"PDF_TO_CSS_UNITS",mu.CSS/mu.PDF);let Uh=mu;async function ax(n,e="text"){if(zm(n,document.baseURI)){const t=await fetch(n);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,i)=>{const s=new XMLHttpRequest;s.open("GET",n,!0),s.responseType=e,s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE){if(s.status===200||s.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(s.response);return}t(s.responseText);return}i(new Error(s.statusText))}},s.send(null)})}class ox{constructor({viewBox:e,userUnit:t,scale:i,rotation:s,offsetX:r=0,offsetY:a=0,dontFlip:o=!1}){this.viewBox=e,this.userUnit=t,this.scale=i,this.rotation=s,this.offsetX=r,this.offsetY=a,i*=t;const l=(e[2]+e[0])/2,c=(e[3]+e[1])/2;let h,u,d,f;switch(s%=360,s<0&&(s+=360),s){case 180:h=-1,u=0,d=0,f=1;break;case 90:h=0,u=1,d=1,f=0;break;case 270:h=0,u=-1,d=-1,f=0;break;case 0:h=1,u=0,d=0,f=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}o&&(d=-d,f=-f);let g,m,x,p;h===0?(g=Math.abs(c-e[1])*i+r,m=Math.abs(l-e[0])*i+a,x=(e[3]-e[1])*i,p=(e[2]-e[0])*i):(g=Math.abs(l-e[0])*i+r,m=Math.abs(c-e[1])*i+a,x=(e[2]-e[0])*i,p=(e[3]-e[1])*i),this.transform=[h*i,u*i,d*i,f*i,g-h*i*l-d*i*c,m-u*i*l-f*i*c],this.width=x,this.height=p}get rawDims(){const e=this.viewBox;return Hn(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:i=this.offsetX,offsetY:s=this.offsetY,dontFlip:r=!1}={}){return new ox({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:i,offsetY:s,dontFlip:r})}convertToViewportPoint(e,t){const i=[e,t];return tn.applyTransform(i,this.transform),i}convertToViewportRectangle(e){const t=[e[0],e[1]];tn.applyTransform(t,this.transform);const i=[e[2],e[3]];return tn.applyTransform(i,this.transform),[t[0],t[1],i[0],i[1]]}convertToPdfPoint(e,t){const i=[e,t];return tn.applyInverseTransform(i,this.transform),i}}class l4 extends af{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function J5(n){const e=n.length;let t=0;for(;t<e&&n[t].trim()==="";)t++;return n.substring(t,t+5).toLowerCase()==="data:"}function c4(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function RL(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function ML(n,e="document.pdf"){if(typeof n!="string")return e;if(J5(n))return _n('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const i=(o=>{try{return new URL(o)}catch{try{return new URL(decodeURIComponent(o))}catch{try{return new URL(o,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(o),"https://foo.bar")}catch{return null}}}}})(n);if(!i)return e;const s=o=>{try{let l=decodeURIComponent(o);return l.includes("/")?(l=l.split("/").at(-1),l.test(/^\.pdf$/i)?l:o):l}catch{return o}},r=/\.pdf$/i,a=i.pathname.split("/").at(-1);if(r.test(a))return s(a);if(i.searchParams.size>0){const o=Array.from(i.searchParams.values()).reverse();for(const c of o)if(r.test(c))return s(c);const l=Array.from(i.searchParams.keys()).reverse();for(const c of l)if(r.test(c))return s(c)}if(i.hash){const l=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(i.hash);if(l)return s(l[0])}return e}class wv{constructor(){He(this,"started",Object.create(null));He(this,"times",[])}time(e){e in this.started&&_n(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||_n(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:i}of this.times)t=Math.max(i.length,t);for(const{name:i,start:s,end:r}of this.times)e.push(`${i.padEnd(t)} ${r-s}ms
`);return e.join("")}}function zm(n,e){const t=e?URL.parse(n,e):URL.parse(n);return(t==null?void 0:t.protocol)==="http:"||(t==null?void 0:t.protocol)==="https:"}function nl(n){n.preventDefault()}function ms(n){n.preventDefault(),n.stopPropagation()}function PL(n){""+n}var l2;class h4{static toDateObject(e){if(!e||typeof e!="string")return null;b(this,l2)||O(this,l2,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=b(this,l2).exec(e);if(!t)return null;const i=parseInt(t[1],10);let s=parseInt(t[2],10);s=s>=1&&s<=12?s-1:0;let r=parseInt(t[3],10);r=r>=1&&r<=31?r:1;let a=parseInt(t[4],10);a=a>=0&&a<=23?a:0;let o=parseInt(t[5],10);o=o>=0&&o<=59?o:0;let l=parseInt(t[6],10);l=l>=0&&l<=59?l:0;const c=t[7]||"Z";let h=parseInt(t[8],10);h=h>=0&&h<=23?h:0;let u=parseInt(t[9],10)||0;return u=u>=0&&u<=59?u:0,c==="-"?(a+=h,o+=u):c==="+"&&(a-=h,o-=u),new Date(Date.UTC(i,s,r,a,o,l))}}l2=new WeakMap,B(h4,l2);function NL(n,{scale:e=1,rotation:t=0}){const{width:i,height:s}=n.attributes.style,r=[0,0,parseInt(i),parseInt(s)];return new ox({viewBox:r,userUnit:1,scale:e,rotation:t})}function u4(n){if(n.startsWith("#")){const e=parseInt(n.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(e=>parseInt(e)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(_n(`Not a valid color format: "${n}"`),[0,0,0])}function OL(n){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const t of n.keys()){e.style.color=t;const i=window.getComputedStyle(e).color;n.set(t,u4(i))}e.remove()}function qi(n){const{a:e,b:t,c:i,d:s,e:r,f:a}=n.getTransform();return[e,t,i,s,r,a]}function gl(n){const{a:e,b:t,c:i,d:s,e:r,f:a}=n.getTransform().invertSelf();return[e,t,i,s,r,a]}function Vd(n,e,t=!1,i=!0){if(e instanceof ox){const{pageWidth:s,pageHeight:r}=e.rawDims,{style:a}=n,o=dr.isCSSRoundSupported,l=`var(--total-scale-factor) * ${s}px`,c=`var(--total-scale-factor) * ${r}px`,h=o?`round(down, ${l}, var(--scale-round-x))`:`calc(${l})`,u=o?`round(down, ${c}, var(--scale-round-y))`:`calc(${c})`;!t||e.rotation%180===0?(a.width=h,a.height=u):(a.width=u,a.height=h)}i&&n.setAttribute("data-main-rotation",e.rotation)}class ic{constructor(){const{pixelRatio:e}=ic;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,i,s,r=-1){let a=1/0,o=1/0,l=1/0;i=ic.capPixels(i,r),i>0&&(a=Math.sqrt(i/(e*t))),s!==-1&&(o=s/e,l=s/t);const c=Math.min(a,o,l);return this.sx>c||this.sy>c?(this.sx=c,this.sy=c,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const i=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,i):i}return e}}const a8=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];var L0,vu,$a,B0,c2,h1,h2,d5,QI,qr,$I,eE,jm,w9;const bc=class bc{constructor(e){B(this,qr);B(this,L0,null);B(this,vu,null);B(this,$a);B(this,B0,null);B(this,c2,null);B(this,h1,null);O(this,$a,e),b(bc,h2)||O(bc,h2,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}render(){const e=O(this,L0,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=b(this,$a)._uiManager._signal;e.addEventListener("contextmenu",nl,{signal:t}),e.addEventListener("pointerdown",D(bc,d5,QI),{signal:t});const i=O(this,B0,document.createElement("div"));i.className="buttons",e.append(i);const s=b(this,$a).toolbarPosition;if(s){const{style:r}=e,a=b(this,$a)._uiManager.direction==="ltr"?1-s[0]:s[0];r.insetInlineEnd=`${100*a}%`,r.top=`calc(${100*s[1]}% + var(--editor-toolbar-vert-offset))`}return e}get div(){return b(this,L0)}hide(){var e;b(this,L0).classList.add("hidden"),(e=b(this,vu))==null||e.hideDropdown()}show(){var e;b(this,L0).classList.remove("hidden"),(e=b(this,c2))==null||e.shown()}addDeleteButton(){const{editorType:e,_uiManager:t}=b(this,$a),i=document.createElement("button");i.className="delete",i.tabIndex=0,i.setAttribute("data-l10n-id",b(bc,h2)[e]),D(this,qr,jm).call(this,i),i.addEventListener("click",s=>{t.delete()},{signal:t._signal}),b(this,B0).append(i)}async addAltText(e){const t=await e.render();D(this,qr,jm).call(this,t),b(this,B0).append(t,b(this,qr,w9)),O(this,c2,e)}addColorPicker(e){O(this,vu,e);const t=e.renderButton();D(this,qr,jm).call(this,t),b(this,B0).append(t,b(this,qr,w9))}async addEditSignatureButton(e){const t=O(this,h1,await e.renderEditButton(b(this,$a)));D(this,qr,jm).call(this,t),b(this,B0).append(t,b(this,qr,w9))}async addButton(e,t){switch(e){case"colorPicker":this.addColorPicker(t);break;case"altText":await this.addAltText(t);break;case"editSignature":await this.addEditSignatureButton(t);break;case"delete":this.addDeleteButton();break}}updateEditSignatureButton(e){b(this,h1)&&(b(this,h1).title=e)}remove(){var e;b(this,L0).remove(),(e=b(this,vu))==null||e.destroy(),O(this,vu,null)}};L0=new WeakMap,vu=new WeakMap,$a=new WeakMap,B0=new WeakMap,c2=new WeakMap,h1=new WeakMap,h2=new WeakMap,d5=new WeakSet,QI=function(e){e.stopPropagation()},qr=new WeakSet,$I=function(e){b(this,$a)._focusEventsAllowed=!1,ms(e)},eE=function(e){b(this,$a)._focusEventsAllowed=!0,ms(e)},jm=function(e){const t=b(this,$a)._uiManager._signal;e.addEventListener("focusin",D(this,qr,$I).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",D(this,qr,eE).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",nl,{signal:t})},w9=function(){const e=document.createElement("div");return e.className="divider",e},B(bc,d5),B(bc,h2,null);let o8=bc;var u2,ku,Cu,Vh,tE,nE,iE;class DL{constructor(e){B(this,Vh);B(this,u2,null);B(this,ku,null);B(this,Cu);O(this,Cu,e)}show(e,t,i){const[s,r]=D(this,Vh,nE).call(this,t,i),{style:a}=b(this,ku)||O(this,ku,D(this,Vh,tE).call(this));e.append(b(this,ku)),a.insetInlineEnd=`${100*s}%`,a.top=`calc(${100*r}% + var(--editor-toolbar-vert-offset))`}hide(){b(this,ku).remove()}}u2=new WeakMap,ku=new WeakMap,Cu=new WeakMap,Vh=new WeakSet,tE=function(){const e=O(this,ku,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",nl,{signal:b(this,Cu)._signal});const t=O(this,u2,document.createElement("div"));return t.className="buttons",e.append(t),D(this,Vh,iE).call(this),e},nE=function(e,t){let i=0,s=0;for(const r of e){const a=r.y+r.height;if(a<i)continue;const o=r.x+(t?r.width:0);if(a>i){s=o,i=a;continue}t?o>s&&(s=o):o<s&&(s=o)}return[t?1-s:s,i]},iE=function(){const e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const i=b(this,Cu)._signal;e.addEventListener("contextmenu",nl,{signal:i}),e.addEventListener("click",()=>{b(this,Cu).highlightSelection("floating_button")},{signal:i}),b(this,u2).append(e)};function sE(n,e,t){for(const i of t)e.addEventListener(i,n[i].bind(n))}var f5;class FL{constructor(){B(this,f5,0)}get id(){return`${WI}${Mr(this,f5)._++}`}}f5=new WeakMap;var u1,d2,yr,d1,_9;const V_=class V_{constructor(){B(this,d1);B(this,u1,JI());B(this,d2,0);B(this,yr,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',i=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),s=new Image;s.src=e;const r=s.decode().then(()=>(i.drawImage(s,0,0,1,1,0,0,1,3),new Uint32Array(i.getImageData(0,0,1,1).data.buffer)[0]===0));return Hn(this,"_isSVGFittingCanvas",r)}async getFromFile(e){const{lastModified:t,name:i,size:s,type:r}=e;return D(this,d1,_9).call(this,`${t}_${i}_${s}_${r}`,e)}async getFromUrl(e){return D(this,d1,_9).call(this,e,e)}async getFromBlob(e,t){const i=await t;return D(this,d1,_9).call(this,e,i)}async getFromId(e){b(this,yr)||O(this,yr,new Map);const t=b(this,yr).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:i}=t;return delete t.blobPromise,this.getFromBlob(t.id,i)}return this.getFromUrl(t.url)}getFromCanvas(e,t){b(this,yr)||O(this,yr,new Map);let i=b(this,yr).get(e);if(i!=null&&i.bitmap)return i.refCounter+=1,i;const s=new OffscreenCanvas(t.width,t.height);return s.getContext("2d").drawImage(t,0,0),i={bitmap:s.transferToImageBitmap(),id:`image_${b(this,u1)}_${Mr(this,d2)._++}`,refCounter:1,isSvg:!1},b(this,yr).set(e,i),b(this,yr).set(i.id,i),i}getSvgUrl(e){const t=b(this,yr).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var s;b(this,yr)||O(this,yr,new Map);const t=b(this,yr).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:i}=t;if(!t.url&&!t.file){const r=new OffscreenCanvas(i.width,i.height);r.getContext("bitmaprenderer").transferFromImageBitmap(i),t.blobPromise=r.convertToBlob()}(s=i.close)==null||s.call(i),t.bitmap=null}isValidId(e){return e.startsWith(`image_${b(this,u1)}_`)}};u1=new WeakMap,d2=new WeakMap,yr=new WeakMap,d1=new WeakSet,_9=async function(e,t){b(this,yr)||O(this,yr,new Map);let i=b(this,yr).get(e);if(i===null)return null;if(i!=null&&i.bitmap)return i.refCounter+=1,i;try{i||(i={bitmap:null,id:`image_${b(this,u1)}_${Mr(this,d2)._++}`,refCounter:0,isSvg:!1});let s;if(typeof t=="string"?(i.url=t,s=await ax(t,"blob")):t instanceof File?s=i.file=t:t instanceof Blob&&(s=t),s.type==="image/svg+xml"){const r=V_._isSVGFittingCanvas,a=new FileReader,o=new Image,l=new Promise((c,h)=>{o.onload=()=>{i.bitmap=o,i.isSvg=!0,c()},a.onload=async()=>{const u=i.svgUrl=a.result;o.src=await r?`${u}#svgView(preserveAspectRatio(none))`:u},o.onerror=a.onerror=h});a.readAsDataURL(s),await l}else i.bitmap=await createImageBitmap(s);i.refCounter=1}catch(s){_n(s),i=null}return b(this,yr).set(e,i),i&&b(this,yr).set(i.id,i),i};let l8=V_;var ns,U0,f2,Vi;class LL{constructor(e=128){B(this,ns,[]);B(this,U0,!1);B(this,f2);B(this,Vi,-1);O(this,f2,e)}add({cmd:e,undo:t,post:i,mustExec:s,type:r=NaN,overwriteIfSameType:a=!1,keepUndo:o=!1}){if(s&&e(),b(this,U0))return;const l={cmd:e,undo:t,post:i,type:r};if(b(this,Vi)===-1){b(this,ns).length>0&&(b(this,ns).length=0),O(this,Vi,0),b(this,ns).push(l);return}if(a&&b(this,ns)[b(this,Vi)].type===r){o&&(l.undo=b(this,ns)[b(this,Vi)].undo),b(this,ns)[b(this,Vi)]=l;return}const c=b(this,Vi)+1;c===b(this,f2)?b(this,ns).splice(0,1):(O(this,Vi,c),c<b(this,ns).length&&b(this,ns).splice(c)),b(this,ns).push(l)}undo(){if(b(this,Vi)===-1)return;O(this,U0,!0);const{undo:e,post:t}=b(this,ns)[b(this,Vi)];e(),t==null||t(),O(this,U0,!1),O(this,Vi,b(this,Vi)-1)}redo(){if(b(this,Vi)<b(this,ns).length-1){O(this,Vi,b(this,Vi)+1),O(this,U0,!0);const{cmd:e,post:t}=b(this,ns)[b(this,Vi)];e(),t==null||t(),O(this,U0,!1)}}hasSomethingToUndo(){return b(this,Vi)!==-1}hasSomethingToRedo(){return b(this,Vi)<b(this,ns).length-1}cleanType(e){if(b(this,Vi)!==-1){for(let t=b(this,Vi);t>=0;t--)if(b(this,ns)[t].type!==e){b(this,ns).splice(t+1,b(this,Vi)-t),O(this,Vi,t);return}b(this,ns).length=0,O(this,Vi,-1)}}destroy(){O(this,ns,null)}}ns=new WeakMap,U0=new WeakMap,f2=new WeakMap,Vi=new WeakMap;var g5,rE;class lx{constructor(e){B(this,g5);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=dr.platform;for(const[i,s,r={}]of e)for(const a of i){const o=a.startsWith("mac+");t&&o?(this.callbacks.set(a.slice(4),{callback:s,options:r}),this.allKeys.add(a.split("+").at(-1))):!t&&!o&&(this.callbacks.set(a,{callback:s,options:r}),this.allKeys.add(a.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const i=this.callbacks.get(D(this,g5,rE).call(this,t));if(!i)return;const{callback:s,options:{bubbles:r=!1,args:a=[],checker:o=null}}=i;o&&!o(e,t)||(s.bind(e,...a,t)(),r||ms(t))}}g5=new WeakSet,rE=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const m5=class m5{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return OL(e),Hn(this,"_colors",e)}convert(e){const t=u4(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[i,s]of this._colors)if(s.every((r,a)=>r===t[a]))return m5._colorsMapping.get(i);return t}getHexCode(e){const t=this._colors.get(e);return t?tn.makeHexColor(...t):e}};He(m5,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let c8=m5;var f1,_a,Cs,er,g1,vc,m1,eo,H0,z0,p1,Au,Sl,Mo,Su,g2,m2,b1,p2,Il,j0,x1,G0,El,p5,V0,b2,q0,Iu,Eu,W0,x2,Ts,li,kc,K0,Tu,y2,w2,X0,Tl,Cc,_2,v2,to,St,v9,h8,aE,oE,k9,lE,cE,hE,u8,uE,d8,f8,dE,Or,dc,fE,gE,g8,mE,Gm,m8;const jf=class jf{constructor(e,t,i,s,r,a,o,l,c,h,u,d,f,g,m){B(this,St);B(this,f1,new AbortController);B(this,_a,null);B(this,Cs,new Map);B(this,er,new Map);B(this,g1,null);B(this,vc,null);B(this,m1,null);B(this,eo,new LL);B(this,H0,null);B(this,z0,null);B(this,p1,0);B(this,Au,new Set);B(this,Sl,null);B(this,Mo,null);B(this,Su,new Set);He(this,"_editorUndoBar",null);B(this,g2,!1);B(this,m2,!1);B(this,b1,!1);B(this,p2,null);B(this,Il,null);B(this,j0,null);B(this,x1,null);B(this,G0,!1);B(this,El,null);B(this,p5,new FL);B(this,V0,!1);B(this,b2,!1);B(this,q0,null);B(this,Iu,null);B(this,Eu,null);B(this,W0,null);B(this,x2,null);B(this,Ts,wn.NONE);B(this,li,new Set);B(this,kc,null);B(this,K0,null);B(this,Tu,null);B(this,y2,null);B(this,w2,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});B(this,X0,[0,0]);B(this,Tl,null);B(this,Cc,null);B(this,_2,null);B(this,v2,null);B(this,to,null);const x=this._signal=b(this,f1).signal;O(this,Cc,e),O(this,_2,t),O(this,v2,i),O(this,g1,s),O(this,K0,r),this._eventBus=a,a._on("editingaction",this.onEditingAction.bind(this),{signal:x}),a._on("pagechanging",this.onPageChanging.bind(this),{signal:x}),a._on("scalechanging",this.onScaleChanging.bind(this),{signal:x}),a._on("rotationchanging",this.onRotationChanging.bind(this),{signal:x}),a._on("setpreference",this.onSetPreference.bind(this),{signal:x}),a._on("switchannotationeditorparams",p=>this.updateParams(p.type,p.value),{signal:x}),D(this,St,lE).call(this),D(this,St,dE).call(this),D(this,St,u8).call(this),O(this,vc,o.annotationStorage),O(this,p2,o.filterFactory),O(this,Tu,l),O(this,x1,c||null),O(this,g2,h),O(this,m2,u),O(this,b1,d),O(this,x2,f||null),this.viewParameters={realScale:Uh.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=g||null,this._supportsPinchToZoom=m!==!1}static get _keyboardManager(){const e=jf.prototype,t=a=>b(a,Cc).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&a.hasSomethingToControl(),i=(a,{target:o})=>{if(o instanceof HTMLInputElement){const{type:l}=o;return l!=="text"&&l!=="number"}return!0},s=this.TRANSLATE_SMALL,r=this.TRANSLATE_BIG;return Hn(this,"_keyboardManager",new lx([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:i}],[["ctrl+z","mac+meta+z"],e.undo,{checker:i}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:i}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:i}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&b(a,Cc).contains(o)&&!a.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&b(a,Cc).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-s,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-r,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[s,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[r,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-s],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-r],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,s],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,r],checker:t}]]))}destroy(){var e,t,i,s,r,a,o,l;(e=b(this,to))==null||e.resolve(),O(this,to,null),(t=b(this,f1))==null||t.abort(),O(this,f1,null),this._signal=null;for(const c of b(this,er).values())c.destroy();b(this,er).clear(),b(this,Cs).clear(),b(this,Su).clear(),(i=b(this,W0))==null||i.clear(),O(this,_a,null),b(this,li).clear(),b(this,eo).destroy(),(s=b(this,g1))==null||s.destroy(),(r=b(this,K0))==null||r.destroy(),(a=b(this,El))==null||a.hide(),O(this,El,null),(o=b(this,Eu))==null||o.destroy(),O(this,Eu,null),b(this,Il)&&(clearTimeout(b(this,Il)),O(this,Il,null)),b(this,Tl)&&(clearTimeout(b(this,Tl)),O(this,Tl,null)),(l=this._editorUndoBar)==null||l.destroy()}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return b(this,x2)}get useNewAltTextFlow(){return b(this,m2)}get useNewAltTextWhenAddingImage(){return b(this,b1)}get hcmFilter(){return Hn(this,"hcmFilter",b(this,Tu)?b(this,p2).addHCMFilter(b(this,Tu).foreground,b(this,Tu).background):"none")}get direction(){return Hn(this,"direction",getComputedStyle(b(this,Cc)).direction)}get highlightColors(){return Hn(this,"highlightColors",b(this,x1)?new Map(b(this,x1).split(",").map(e=>(e=e.split("=").map(t=>t.trim()),e[1]=e[1].toUpperCase(),e))):null)}get highlightColorNames(){return Hn(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),O(this,z0,e)}setMainHighlightColorPicker(e){O(this,Eu,e)}editAltText(e,t=!1){var i;(i=b(this,g1))==null||i.editAltText(this,e,t)}getSignature(e){var t;(t=b(this,K0))==null||t.getSignature({uiManager:this,editor:e})}get signatureManager(){return b(this,K0)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":O(this,b1,t);break}}onPageChanging({pageNumber:e}){O(this,p1,e-1)}focusMainContainer(){b(this,Cc).focus()}findParent(e,t){for(const i of b(this,er).values()){const{x:s,y:r,width:a,height:o}=i.div.getBoundingClientRect();if(e>=s&&e<=s+a&&t>=r&&t<=r+o)return i}return null}disableUserSelect(e=!1){b(this,_2).classList.toggle("noUserSelect",e)}addShouldRescale(e){b(this,Su).add(e)}removeShouldRescale(e){b(this,Su).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*Uh.PDF_TO_CSS_UNITS;for(const i of b(this,Su))i.onScaleChanging();(t=b(this,z0))==null||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e=""){const t=document.getSelection();if(!t||t.isCollapsed)return;const{anchorNode:i,anchorOffset:s,focusNode:r,focusOffset:a}=t,o=t.toString(),c=D(this,St,v9).call(this,t).closest(".textLayer"),h=this.getSelectionBoxes(c);if(!h)return;t.empty();const u=D(this,St,h8).call(this,c),d=b(this,Ts)===wn.NONE,f=()=>{u==null||u.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:h,anchorNode:i,anchorOffset:s,focusNode:r,focusOffset:a,text:o}),d&&this.showAllEditors("highlight",!0,!0)};if(d){this.switchToMode(wn.HIGHLIGHT,f);return}f()}addToAnnotationStorage(e){!e.isEmpty()&&b(this,vc)&&!b(this,vc).has(e.id)&&b(this,vc).setValue(e.id,e)}a11yAlert(e,t=null){const i=b(this,v2);i&&(i.setAttribute("data-l10n-id",e),t?i.setAttribute("data-l10n-args",JSON.stringify(t)):i.removeAttribute("data-l10n-args"))}blur(){if(this.isShiftKeyDown=!1,b(this,G0)&&(O(this,G0,!1),D(this,St,k9).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of b(this,li))if(t.div.contains(e)){O(this,Iu,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!b(this,Iu))return;const[e,t]=b(this,Iu);O(this,Iu,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){D(this,St,u8).call(this),D(this,St,d8).call(this)}removeEditListeners(){D(this,St,uE).call(this),D(this,St,f8).call(this)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const i of b(this,Mo))if(i.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const i of b(this,Mo))if(i.isHandlingMimeForPasting(t.type)){i.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var i;if(e.preventDefault(),(i=b(this,_a))==null||i.commitOrRemove(),!this.hasSelection)return;const t=[];for(const s of b(this,li)){const r=s.serialize(!0);r&&t.push(r)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const r of t.items)for(const a of b(this,Mo))if(a.isHandlingMimeForPasting(r.type)){a.paste(r,this.currentLayer);return}let i=t.getData("application/pdfjs");if(!i)return;try{i=JSON.parse(i)}catch(r){_n(`paste: "${r.message}".`);return}if(!Array.isArray(i))return;this.unselectAll();const s=this.currentLayer;try{const r=[];for(const l of i){const c=await s.deserialize(l);if(!c)return;r.push(c)}const a=()=>{for(const l of r)D(this,St,g8).call(this,l);D(this,St,m8).call(this,r)},o=()=>{for(const l of r)l.remove()};this.addCommands({cmd:a,undo:o,mustExec:!0})}catch(r){_n(`paste: "${r.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),b(this,Ts)!==wn.NONE&&!this.isEditorHandlingKeyboard&&jf._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,b(this,G0)&&(O(this,G0,!1),D(this,St,k9).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(e){e?(D(this,St,cE).call(this),D(this,St,d8).call(this),D(this,St,Or).call(this,{isEditing:b(this,Ts)!==wn.NONE,isEmpty:D(this,St,Gm).call(this),hasSomethingToUndo:b(this,eo).hasSomethingToUndo(),hasSomethingToRedo:b(this,eo).hasSomethingToRedo(),hasSelectedEditor:!1})):(D(this,St,hE).call(this),D(this,St,f8).call(this),D(this,St,Or).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!b(this,Mo)){O(this,Mo,e);for(const t of b(this,Mo))D(this,St,dc).call(this,t.defaultPropertiesToUpdate)}}getId(){return b(this,p5).id}get currentLayer(){return b(this,er).get(b(this,p1))}getLayer(e){return b(this,er).get(e)}get currentPageIndex(){return b(this,p1)}addLayer(e){b(this,er).set(e.pageIndex,e),b(this,V0)?e.enable():e.disable()}removeLayer(e){b(this,er).delete(e.pageIndex)}async updateMode(e,t=null,i=!1,s=!1){var r,a,o;if(b(this,Ts)!==e&&!(b(this,to)&&(await b(this,to).promise,!b(this,to)))){if(O(this,to,Promise.withResolvers()),(r=b(this,z0))==null||r.commitOrRemove(),O(this,Ts,e),e===wn.NONE){this.setEditingState(!1),D(this,St,gE).call(this),(a=this._editorUndoBar)==null||a.hide(),b(this,to).resolve();return}e===wn.SIGNATURE&&await((o=b(this,K0))==null?void 0:o.loadSignatures()),this.setEditingState(!0),await D(this,St,fE).call(this),this.unselectAll();for(const l of b(this,er).values())l.updateMode(e);if(!t){i&&this.addNewEditorFromKeyboard(),b(this,to).resolve();return}for(const l of b(this,Cs).values())l.annotationElementId===t||l.id===t?(this.setSelected(l),s&&l.enterInEditMode()):l.unselect();b(this,to).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==b(this,Ts)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,t){var i;if(b(this,Mo)){switch(e){case Gn.CREATE:this.currentLayer.addNewEditor(t);return;case Gn.HIGHLIGHT_DEFAULT_COLOR:(i=b(this,Eu))==null||i.updateColor(t);break;case Gn.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(b(this,y2)||O(this,y2,new Map)).set(e,t),this.showAllEditors("highlight",t);break}for(const s of b(this,li))s.updateParams(e,t);for(const s of b(this,Mo))s.updateDefaultParams(e,t)}}showAllEditors(e,t,i=!1){var r;for(const a of b(this,Cs).values())a.editorType===e&&a.show(t);(((r=b(this,y2))==null?void 0:r.get(Gn.HIGHLIGHT_SHOW_ALL))??!0)!==t&&D(this,St,dc).call(this,[[Gn.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(b(this,b2)!==e){O(this,b2,e);for(const t of b(this,er).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}getEditors(e){const t=[];for(const i of b(this,Cs).values())i.pageIndex===e&&t.push(i);return t}getEditor(e){return b(this,Cs).get(e)}addEditor(e){b(this,Cs).set(e.id,e)}removeEditor(e){var t,i;e.div.contains(document.activeElement)&&(b(this,Il)&&clearTimeout(b(this,Il)),O(this,Il,setTimeout(()=>{this.focusMainContainer(),O(this,Il,null)},0))),b(this,Cs).delete(e.id),e.annotationElementId&&((t=b(this,W0))==null||t.delete(e.annotationElementId)),this.unselect(e),(!e.annotationElementId||!b(this,Au).has(e.annotationElementId))&&((i=b(this,vc))==null||i.remove(e.id))}addDeletedAnnotationElement(e){b(this,Au).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return b(this,Au).has(e)}removeDeletedAnnotationElement(e){b(this,Au).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){b(this,_a)!==e&&(O(this,_a,e),e&&D(this,St,dc).call(this,e.propertiesToUpdate))}updateUI(e){b(this,St,mE)===e&&D(this,St,dc).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){D(this,St,dc).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(b(this,li).has(e)){b(this,li).delete(e),e.unselect(),D(this,St,Or).call(this,{hasSelectedEditor:this.hasSelection});return}b(this,li).add(e),e.select(),D(this,St,dc).call(this,e.propertiesToUpdate),D(this,St,Or).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;this.updateToolbar({mode:e.mode,editId:e.id}),(t=b(this,z0))==null||t.commitOrRemove();for(const i of b(this,li))i!==e&&i.unselect();b(this,li).clear(),b(this,li).add(e),e.select(),D(this,St,dc).call(this,e.propertiesToUpdate),D(this,St,Or).call(this,{hasSelectedEditor:!0})}isSelected(e){return b(this,li).has(e)}get firstSelectedEditor(){return b(this,li).values().next().value}unselect(e){e.unselect(),b(this,li).delete(e),D(this,St,Or).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return b(this,li).size!==0}get isEnterHandled(){return b(this,li).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;b(this,eo).undo(),D(this,St,Or).call(this,{hasSomethingToUndo:b(this,eo).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:D(this,St,Gm).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){b(this,eo).redo(),D(this,St,Or).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:b(this,eo).hasSomethingToRedo(),isEmpty:D(this,St,Gm).call(this)})}addCommands(e){b(this,eo).add(e),D(this,St,Or).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:D(this,St,Gm).call(this)})}cleanUndoStack(e){b(this,eo).cleanType(e)}delete(){var r;this.commitOrRemove();const e=(r=this.currentLayer)==null?void 0:r.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...b(this,li)],i=()=>{var a;(a=this._editorUndoBar)==null||a.show(s,t.length===1?t[0].editorType:t.length);for(const o of t)o.remove()},s=()=>{for(const a of t)D(this,St,g8).call(this,a)};this.addCommands({cmd:i,undo:s,mustExec:!0})}commitOrRemove(){var e;(e=b(this,_a))==null||e.commitOrRemove()}hasSomethingToControl(){return b(this,_a)||this.hasSelection}selectAll(){for(const e of b(this,li))e.commit();D(this,St,m8).call(this,b(this,Cs).values())}unselectAll(){var e;if(!(b(this,_a)&&(b(this,_a).commitOrRemove(),b(this,Ts)!==wn.NONE))&&!((e=b(this,z0))!=null&&e.commitOrRemove())&&this.hasSelection){for(const t of b(this,li))t.unselect();b(this,li).clear(),D(this,St,Or).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,i=!1){if(i||this.commitOrRemove(),!this.hasSelection)return;b(this,X0)[0]+=e,b(this,X0)[1]+=t;const[s,r]=b(this,X0),a=[...b(this,li)],o=1e3;b(this,Tl)&&clearTimeout(b(this,Tl)),O(this,Tl,setTimeout(()=>{O(this,Tl,null),b(this,X0)[0]=b(this,X0)[1]=0,this.addCommands({cmd:()=>{for(const l of a)b(this,Cs).has(l.id)&&(l.translateInPage(s,r),l.translationDone())},undo:()=>{for(const l of a)b(this,Cs).has(l.id)&&(l.translateInPage(-s,-r),l.translationDone())},mustExec:!1})},o));for(const l of a)l.translateInPage(e,t),l.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),O(this,Sl,new Map);for(const e of b(this,li))b(this,Sl).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!b(this,Sl))return!1;this.disableUserSelect(!1);const e=b(this,Sl);O(this,Sl,null);let t=!1;for(const[{x:s,y:r,pageIndex:a},o]of e)o.newX=s,o.newY=r,o.newPageIndex=a,t||(t=s!==o.savedX||r!==o.savedY||a!==o.savedPageIndex);if(!t)return!1;const i=(s,r,a,o)=>{if(b(this,Cs).has(s.id)){const l=b(this,er).get(o);l?s._setParentAndPosition(l,r,a):(s.pageIndex=o,s.x=r,s.y=a)}};return this.addCommands({cmd:()=>{for(const[s,{newX:r,newY:a,newPageIndex:o}]of e)i(s,r,a,o)},undo:()=>{for(const[s,{savedX:r,savedY:a,savedPageIndex:o}]of e)i(s,r,a,o)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(b(this,Sl))for(const i of b(this,Sl).keys())i.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||b(this,li).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return b(this,_a)===e}getActive(){return b(this,_a)}getMode(){return b(this,Ts)}get imageManager(){return Hn(this,"imageManager",new l8)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let c=0,h=t.rangeCount;c<h;c++)if(!e.contains(t.getRangeAt(c).commonAncestorContainer))return null;const{x:i,y:s,width:r,height:a}=e.getBoundingClientRect();let o;switch(e.getAttribute("data-main-rotation")){case"90":o=(c,h,u,d)=>({x:(h-s)/a,y:1-(c+u-i)/r,width:d/a,height:u/r});break;case"180":o=(c,h,u,d)=>({x:1-(c+u-i)/r,y:1-(h+d-s)/a,width:u/r,height:d/a});break;case"270":o=(c,h,u,d)=>({x:1-(h+d-s)/a,y:(c-i)/r,width:d/a,height:u/r});break;default:o=(c,h,u,d)=>({x:(c-i)/r,y:(h-s)/a,width:u/r,height:d/a});break}const l=[];for(let c=0,h=t.rangeCount;c<h;c++){const u=t.getRangeAt(c);if(!u.collapsed)for(const{x:d,y:f,width:g,height:m}of u.getClientRects())g===0||m===0||l.push(o(d,f,g,m))}return l.length===0?null:l}addChangedExistingAnnotation({annotationElementId:e,id:t}){(b(this,m1)||O(this,m1,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=b(this,m1))==null||t.delete(e)}renderAnnotationElement(e){var s;const t=(s=b(this,m1))==null?void 0:s.get(e.data.id);if(!t)return;const i=b(this,vc).getRawValue(t);i&&(b(this,Ts)===wn.NONE&&!i.hasBeenModified||i.renderAnnotationElement(e))}setMissingCanvas(e,t,i){var r;const s=(r=b(this,W0))==null?void 0:r.get(e);s&&(s.setCanvas(t,i),b(this,W0).delete(e))}addMissingCanvas(e,t){(b(this,W0)||O(this,W0,new Map)).set(e,t)}};f1=new WeakMap,_a=new WeakMap,Cs=new WeakMap,er=new WeakMap,g1=new WeakMap,vc=new WeakMap,m1=new WeakMap,eo=new WeakMap,H0=new WeakMap,z0=new WeakMap,p1=new WeakMap,Au=new WeakMap,Sl=new WeakMap,Mo=new WeakMap,Su=new WeakMap,g2=new WeakMap,m2=new WeakMap,b1=new WeakMap,p2=new WeakMap,Il=new WeakMap,j0=new WeakMap,x1=new WeakMap,G0=new WeakMap,El=new WeakMap,p5=new WeakMap,V0=new WeakMap,b2=new WeakMap,q0=new WeakMap,Iu=new WeakMap,Eu=new WeakMap,W0=new WeakMap,x2=new WeakMap,Ts=new WeakMap,li=new WeakMap,kc=new WeakMap,K0=new WeakMap,Tu=new WeakMap,y2=new WeakMap,w2=new WeakMap,X0=new WeakMap,Tl=new WeakMap,Cc=new WeakMap,_2=new WeakMap,v2=new WeakMap,to=new WeakMap,St=new WeakSet,v9=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},h8=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const i of b(this,er).values())if(i.hasTextLayer(e))return i;return null},aE=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const i=D(this,St,v9).call(this,e).closest(".textLayer"),s=this.getSelectionBoxes(i);s&&(b(this,El)||O(this,El,new DL(this)),b(this,El).show(i,s,this.direction==="ltr"))},oE=function(){var r,a,o;const e=document.getSelection();if(!e||e.isCollapsed){b(this,kc)&&((r=b(this,El))==null||r.hide(),O(this,kc,null),D(this,St,Or).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===b(this,kc))return;const s=D(this,St,v9).call(this,e).closest(".textLayer");if(!s){b(this,kc)&&((a=b(this,El))==null||a.hide(),O(this,kc,null),D(this,St,Or).call(this,{hasSelectedText:!1}));return}if((o=b(this,El))==null||o.hide(),O(this,kc,t),D(this,St,Or).call(this,{hasSelectedText:!0}),!(b(this,Ts)!==wn.HIGHLIGHT&&b(this,Ts)!==wn.NONE)&&(b(this,Ts)===wn.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),O(this,G0,this.isShiftKeyDown),!this.isShiftKeyDown)){const l=b(this,Ts)===wn.HIGHLIGHT?D(this,St,h8).call(this,s):null;l==null||l.toggleDrawing();const c=new AbortController,h=this.combinedSignal(c),u=d=>{d.type==="pointerup"&&d.button!==0||(c.abort(),l==null||l.toggleDrawing(!0),d.type==="pointerup"&&D(this,St,k9).call(this,"main_toolbar"))};window.addEventListener("pointerup",u,{signal:h}),window.addEventListener("blur",u,{signal:h})}},k9=function(e=""){b(this,Ts)===wn.HIGHLIGHT?this.highlightSelection(e):b(this,g2)&&D(this,St,aE).call(this)},lE=function(){document.addEventListener("selectionchange",D(this,St,oE).bind(this),{signal:this._signal})},cE=function(){if(b(this,j0))return;O(this,j0,new AbortController);const e=this.combinedSignal(b(this,j0));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},hE=function(){var e;(e=b(this,j0))==null||e.abort(),O(this,j0,null)},u8=function(){if(b(this,q0))return;O(this,q0,new AbortController);const e=this.combinedSignal(b(this,q0));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},uE=function(){var e;(e=b(this,q0))==null||e.abort(),O(this,q0,null)},d8=function(){if(b(this,H0))return;O(this,H0,new AbortController);const e=this.combinedSignal(b(this,H0));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},f8=function(){var e;(e=b(this,H0))==null||e.abort(),O(this,H0,null)},dE=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},Or=function(e){Object.entries(e).some(([i,s])=>b(this,w2)[i]!==s)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(b(this,w2),e)}),b(this,Ts)===wn.HIGHLIGHT&&e.hasSelectedEditor===!1&&D(this,St,dc).call(this,[[Gn.HIGHLIGHT_FREE,!0]]))},dc=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},fE=async function(){if(!b(this,V0)){O(this,V0,!0);const e=[];for(const t of b(this,er).values())e.push(t.enable());await Promise.all(e);for(const t of b(this,Cs).values())t.enable()}},gE=function(){if(this.unselectAll(),b(this,V0)){O(this,V0,!1);for(const e of b(this,er).values())e.disable();for(const e of b(this,Cs).values())e.disable()}},g8=function(e){const t=b(this,er).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},mE=function(){let e=null;for(e of b(this,li));return e},Gm=function(){if(b(this,Cs).size===0)return!0;if(b(this,Cs).size===1)for(const e of b(this,Cs).values())return e.isEmpty();return!1},m8=function(e){for(const t of b(this,li))t.unselect();b(this,li).clear();for(const t of e)t.isEmpty()||(b(this,li).add(t),t.select());D(this,St,Or).call(this,{hasSelectedEditor:this.hasSelection})},He(jf,"TRANSLATE_SMALL",1),He(jf,"TRANSLATE_BIG",10);let qd=jf;var Rs,Rl,Po,y1,Ml,va,w1,Pl,ia,Ac,Ru,Nl,Y0,Qo,Vm,C9;const Dr=class Dr{constructor(e){B(this,Qo);B(this,Rs,null);B(this,Rl,!1);B(this,Po,null);B(this,y1,null);B(this,Ml,null);B(this,va,null);B(this,w1,!1);B(this,Pl,null);B(this,ia,null);B(this,Ac,null);B(this,Ru,null);B(this,Nl,!1);O(this,ia,e),O(this,Nl,e._uiManager.useNewAltTextFlow),b(Dr,Y0)||O(Dr,Y0,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){Dr._l10n??(Dr._l10n=e)}async render(){const e=O(this,Po,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=O(this,y1,document.createElement("span"));e.append(t),b(this,Nl)?(e.classList.add("new"),e.setAttribute("data-l10n-id",b(Dr,Y0).missing),t.setAttribute("data-l10n-id",b(Dr,Y0)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const i=b(this,ia)._uiManager._signal;e.addEventListener("contextmenu",nl,{signal:i}),e.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:i});const s=r=>{r.preventDefault(),b(this,ia)._uiManager.editAltText(b(this,ia)),b(this,Nl)&&b(this,ia)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:b(this,Qo,Vm)}})};return e.addEventListener("click",s,{capture:!0,signal:i}),e.addEventListener("keydown",r=>{r.target===e&&r.key==="Enter"&&(O(this,w1,!0),s(r))},{signal:i}),await D(this,Qo,C9).call(this),e}finish(){b(this,Po)&&(b(this,Po).focus({focusVisible:b(this,w1)}),O(this,w1,!1))}isEmpty(){return b(this,Nl)?b(this,Rs)===null:!b(this,Rs)&&!b(this,Rl)}hasData(){return b(this,Nl)?b(this,Rs)!==null||!!b(this,Ac):this.isEmpty()}get guessedText(){return b(this,Ac)}async setGuessedText(e){b(this,Rs)===null&&(O(this,Ac,e),O(this,Ru,await Dr._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),D(this,Qo,C9).call(this))}toggleAltTextBadge(e=!1){var t;if(!b(this,Nl)||b(this,Rs)){(t=b(this,Pl))==null||t.remove(),O(this,Pl,null);return}if(!b(this,Pl)){const i=O(this,Pl,document.createElement("div"));i.className="noAltTextBadge",b(this,ia).div.append(i)}b(this,Pl).classList.toggle("hidden",!e)}serialize(e){let t=b(this,Rs);return!e&&b(this,Ac)===t&&(t=b(this,Ru)),{altText:t,decorative:b(this,Rl),guessedText:b(this,Ac),textWithDisclaimer:b(this,Ru)}}get data(){return{altText:b(this,Rs),decorative:b(this,Rl)}}set data({altText:e,decorative:t,guessedText:i,textWithDisclaimer:s,cancel:r=!1}){i&&(O(this,Ac,i),O(this,Ru,s)),!(b(this,Rs)===e&&b(this,Rl)===t)&&(r||(O(this,Rs,e),O(this,Rl,t)),D(this,Qo,C9).call(this))}toggle(e=!1){b(this,Po)&&(!e&&b(this,va)&&(clearTimeout(b(this,va)),O(this,va,null)),b(this,Po).disabled=!e)}shown(){b(this,ia)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:b(this,Qo,Vm)}})}destroy(){var e,t;(e=b(this,Po))==null||e.remove(),O(this,Po,null),O(this,y1,null),O(this,Ml,null),(t=b(this,Pl))==null||t.remove(),O(this,Pl,null)}};Rs=new WeakMap,Rl=new WeakMap,Po=new WeakMap,y1=new WeakMap,Ml=new WeakMap,va=new WeakMap,w1=new WeakMap,Pl=new WeakMap,ia=new WeakMap,Ac=new WeakMap,Ru=new WeakMap,Nl=new WeakMap,Y0=new WeakMap,Qo=new WeakSet,Vm=function(){return b(this,Rs)&&"added"||b(this,Rs)===null&&this.guessedText&&"review"||"missing"},C9=async function(){var s,r,a;const e=b(this,Po);if(!e)return;if(b(this,Nl)){if(e.classList.toggle("done",!!b(this,Rs)),e.setAttribute("data-l10n-id",b(Dr,Y0)[b(this,Qo,Vm)]),(s=b(this,y1))==null||s.setAttribute("data-l10n-id",b(Dr,Y0)[`${b(this,Qo,Vm)}-label`]),!b(this,Rs)){(r=b(this,Ml))==null||r.remove();return}}else{if(!b(this,Rs)&&!b(this,Rl)){e.classList.remove("done"),(a=b(this,Ml))==null||a.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=b(this,Ml);if(!t){O(this,Ml,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${b(this,ia).id}`;const o=100,l=b(this,ia)._uiManager._signal;l.addEventListener("abort",()=>{clearTimeout(b(this,va)),O(this,va,null)},{once:!0}),e.addEventListener("mouseenter",()=>{O(this,va,setTimeout(()=>{O(this,va,null),b(this,Ml).classList.add("show"),b(this,ia)._reportTelemetry({action:"alt_text_tooltip"})},o))},{signal:l}),e.addEventListener("mouseleave",()=>{var c;b(this,va)&&(clearTimeout(b(this,va)),O(this,va,null)),(c=b(this,Ml))==null||c.classList.remove("show")},{signal:l})}b(this,Rl)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=b(this,Rs)),t.parentNode||e.append(t);const i=b(this,ia).getElementForAltText();i==null||i.setAttribute("aria-describedby",t.id)},B(Dr,Y0,null),He(Dr,"_l10n",null);let x3=Dr;var _1,Mu,k2,C2,A2,S2,I2,Sc,Pu,Ic,Nu,Ec,qh,pE,bE,xE;const q_=class q_{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:i=null,onPinchStart:s=null,onPinching:r=null,onPinchEnd:a=null,signal:o}){B(this,qh);B(this,_1);B(this,Mu,!1);B(this,k2,null);B(this,C2);B(this,A2);B(this,S2);B(this,I2);B(this,Sc,null);B(this,Pu);B(this,Ic,null);B(this,Nu);B(this,Ec,null);O(this,_1,e),O(this,k2,i),O(this,C2,t),O(this,A2,s),O(this,S2,r),O(this,I2,a),O(this,Nu,new AbortController),O(this,Pu,AbortSignal.any([o,b(this,Nu).signal])),e.addEventListener("touchstart",D(this,qh,pE).bind(this),{passive:!1,signal:b(this,Pu)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/ic.pixelRatio}destroy(){var e,t;(e=b(this,Nu))==null||e.abort(),O(this,Nu,null),(t=b(this,Sc))==null||t.abort(),O(this,Sc,null)}};_1=new WeakMap,Mu=new WeakMap,k2=new WeakMap,C2=new WeakMap,A2=new WeakMap,S2=new WeakMap,I2=new WeakMap,Sc=new WeakMap,Pu=new WeakMap,Ic=new WeakMap,Nu=new WeakMap,Ec=new WeakMap,qh=new WeakSet,pE=function(e){var s,r,a;if((s=b(this,C2))!=null&&s.call(this))return;if(e.touches.length===1){if(b(this,Sc))return;const o=O(this,Sc,new AbortController),l=AbortSignal.any([b(this,Pu),o.signal]),c=b(this,_1),h={capture:!0,signal:l,passive:!1},u=d=>{var f;d.pointerType==="touch"&&((f=b(this,Sc))==null||f.abort(),O(this,Sc,null))};c.addEventListener("pointerdown",d=>{d.pointerType==="touch"&&(ms(d),u(d))},h),c.addEventListener("pointerup",u,h),c.addEventListener("pointercancel",u,h);return}if(!b(this,Ec)){O(this,Ec,new AbortController);const o=AbortSignal.any([b(this,Pu),b(this,Ec).signal]),l=b(this,_1),c={signal:o,capture:!1,passive:!1};l.addEventListener("touchmove",D(this,qh,bE).bind(this),c);const h=D(this,qh,xE).bind(this);l.addEventListener("touchend",h,c),l.addEventListener("touchcancel",h,c),c.capture=!0,l.addEventListener("pointerdown",ms,c),l.addEventListener("pointermove",ms,c),l.addEventListener("pointercancel",ms,c),l.addEventListener("pointerup",ms,c),(r=b(this,A2))==null||r.call(this)}if(ms(e),e.touches.length!==2||(a=b(this,k2))!=null&&a.call(this)){O(this,Ic,null);return}let[t,i]=e.touches;t.identifier>i.identifier&&([t,i]=[i,t]),O(this,Ic,{touch0X:t.screenX,touch0Y:t.screenY,touch1X:i.screenX,touch1Y:i.screenY})},bE=function(e){var _;if(!b(this,Ic)||e.touches.length!==2)return;ms(e);let[t,i]=e.touches;t.identifier>i.identifier&&([t,i]=[i,t]);const{screenX:s,screenY:r}=t,{screenX:a,screenY:o}=i,l=b(this,Ic),{touch0X:c,touch0Y:h,touch1X:u,touch1Y:d}=l,f=u-c,g=d-h,m=a-s,x=o-r,p=Math.hypot(m,x)||1,y=Math.hypot(f,g)||1;if(!b(this,Mu)&&Math.abs(y-p)<=q_.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(l.touch0X=s,l.touch0Y=r,l.touch1X=a,l.touch1Y=o,!b(this,Mu)){O(this,Mu,!0);return}const w=[(s+a)/2,(r+o)/2];(_=b(this,S2))==null||_.call(this,w,y,p)},xE=function(e){var t;e.touches.length>=2||(b(this,Ec)&&(b(this,Ec).abort(),O(this,Ec,null),(t=b(this,I2))==null||t.call(this)),b(this,Ic)&&(ms(e),O(this,Ic,null),O(this,Mu,!1)))};let y3=q_;var Ou,No,Mi,v1,J0,E2,Du,tr,Fu,Tc,Z0,T2,Lu,ka,R2,Bu,Rc,Ol,k1,C1,no,Uu,M2,b5,ln,p8,P2,b8,A9,yE,wE,x8,S9,y8,_E,vE,kE,w8,CE,_8,AE,SE,IE,v8,qm;const In=class In{constructor(e){B(this,ln);B(this,Ou,null);B(this,No,null);B(this,Mi,null);B(this,v1,!1);B(this,J0,null);B(this,E2,"");B(this,Du,!1);B(this,tr,null);B(this,Fu,null);B(this,Tc,null);B(this,Z0,null);B(this,T2,"");B(this,Lu,!1);B(this,ka,null);B(this,R2,!1);B(this,Bu,!1);B(this,Rc,!1);B(this,Ol,null);B(this,k1,0);B(this,C1,0);B(this,no,null);B(this,Uu,null);He(this,"isSelected",!1);He(this,"_isCopy",!1);He(this,"_editToolbar",null);He(this,"_initialOptions",Object.create(null));He(this,"_initialData",null);He(this,"_isVisible",!0);He(this,"_uiManager",null);He(this,"_focusEventsAllowed",!0);B(this,M2,!1);B(this,b5,In._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null;const{rotation:t,rawDims:{pageWidth:i,pageHeight:s,pageX:r,pageY:a}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[i,s],this.pageTranslation=[r,a];const[o,l]=this.parentDimensions;this.x=e.x/o,this.y=e.y/l,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=In.prototype._resizeWithKeyboard,t=qd.TRANSLATE_SMALL,i=qd.TRANSLATE_BIG;return Hn(this,"_resizerKeyboardManager",new lx([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-i,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[i,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-i]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,i]}],[["Escape","mac+Escape"],In.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return Hn(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new BL({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(In._l10n??(In._l10n=e),In._l10nResizer||(In._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),In._borderLineWidth!==-1)return;const i=getComputedStyle(document.documentElement);In._borderLineWidth=parseFloat(i.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){mi("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return b(this,M2)}set _isDraggable(e){var t;O(this,M2,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=b(this,b5)}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):D(this,ln,qm).call(this),this.parent=e}focusin(e){this._focusEventsAllowed&&(b(this,Lu)?O(this,Lu,!1):this.parent.setSelected(this))}focusout(e){var i;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(i=this.parent)!=null&&i.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,i,s){const[r,a]=this.parentDimensions;[i,s]=this.screenToPageTranslation(i,s),this.x=(e+i)/r,this.y=(t+s)/a,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[i,s]=this.parentDimensions;this.setAt(e*i,t*s,this.width*i,this.height*s),this._onTranslated()}translate(e,t){D(this,ln,p8).call(this,this.parentDimensions,e,t)}translateInPage(e,t){b(this,ka)||O(this,ka,[this.x,this.y,this.width,this.height]),D(this,ln,p8).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){b(this,ka)||O(this,ka,[this.x,this.y,this.width,this.height]);const{div:i,parentDimensions:[s,r]}=this;if(this.x+=e/s,this.y+=t/r,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:u,y:d}=this.div.getBoundingClientRect();this.parent.findNewParent(this,u,d)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:a,y:o}=this;const[l,c]=this.getBaseTranslation();a+=l,o+=c;const{style:h}=i;h.left=`${(100*a).toFixed(2)}%`,h.top=`${(100*o).toFixed(2)}%`,this._onTranslating(a,o),i.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!b(this,ka)&&(b(this,ka)[0]!==this.x||b(this,ka)[1]!==this.y)}get _hasBeenResized(){return!!b(this,ka)&&(b(this,ka)[2]!==this.width||b(this,ka)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:i}=In,s=i/e,r=i/t;switch(this.rotation){case 90:return[-s,r];case 180:return[s,r];case 270:return[s,-r];default:return[-s,-r]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[i,s]}=this;let{x:r,y:a,width:o,height:l}=this;if(o*=i,l*=s,r*=i,a*=s,this._mustFixPosition)switch(e){case 0:r=Hr(r,0,i-o),a=Hr(a,0,s-l);break;case 90:r=Hr(r,0,i-l),a=Hr(a,o,s);break;case 180:r=Hr(r,o,i),a=Hr(a,l,s);break;case 270:r=Hr(r,l,i),a=Hr(a,0,s-o);break}this.x=r/=i,this.y=a/=s;const[c,h]=this.getBaseTranslation();r+=c,a+=h,t.left=`${(100*r).toFixed(2)}%`,t.top=`${(100*a).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var i;return D(i=In,P2,b8).call(i,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var i;return D(i=In,P2,b8).call(i,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,i]}=this;return[t*e,i*e]}setDims(e,t){const[i,s]=this.parentDimensions,{style:r}=this.div;r.width=`${(100*e/i).toFixed(2)}%`,b(this,Du)||(r.height=`${(100*t/s).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:t,width:i}=e,s=i.endsWith("%"),r=!b(this,Du)&&t.endsWith("%");if(s&&r)return;const[a,o]=this.parentDimensions;s||(e.width=`${(100*parseFloat(i)/a).toFixed(2)}%`),!b(this,Du)&&!r&&(e.height=`${(100*parseFloat(t)/o).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){var e;(e=b(this,Mi))==null||e.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||b(this,Bu))return this._editToolbar;this._editToolbar=new o8(this),this.div.append(this._editToolbar.render());const{toolbarButtons:e}=this;if(e)for(const[t,i]of e)await this._editToolbar.addButton(t,i);return this._editToolbar.addButton("delete"),this._editToolbar}removeEditToolbar(){var e;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,(e=b(this,Mi))==null||e.destroy())}addContainer(e){var i;const t=(i=this._editToolbar)==null?void 0:i.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return b(this,Mi)||(x3.initialize(In._l10n),O(this,Mi,new x3(this)),b(this,Ou)&&(b(this,Mi).data=b(this,Ou),O(this,Ou,null))),b(this,Mi)}get altTextData(){var e;return(e=b(this,Mi))==null?void 0:e.data}set altTextData(e){b(this,Mi)&&(b(this,Mi).data=e)}get guessedAltText(){var e;return(e=b(this,Mi))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=b(this,Mi))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=b(this,Mi))==null?void 0:t.serialize(e)}hasAltText(){return!!b(this,Mi)&&!b(this,Mi).isEmpty()}hasAltTextData(){var e;return((e=b(this,Mi))==null?void 0:e.hasData())??!1}render(){var a;const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=b(this,v1)?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),D(this,ln,_8).call(this);const[t,i]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*i/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/i).toFixed(2)}%`);const[s,r]=this.getInitialTranslation();return this.translate(s,r),sE(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(b(this,Uu)||O(this,Uu,new y3({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:D(this,ln,_E).bind(this),onPinching:D(this,ln,vE).bind(this),onPinchEnd:D(this,ln,kE).bind(this),signal:this._uiManager._signal}))),(a=this._uiManager._editorUndoBar)==null||a.hide(),e}pointerdown(e){const{isMac:t}=dr.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(O(this,Lu,!0),this._isDraggable){D(this,ln,CE).call(this,e);return}D(this,ln,w8).call(this,e)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){b(this,Ol)&&clearTimeout(b(this,Ol)),O(this,Ol,setTimeout(()=>{var e;O(this,Ol,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,i){e.changeParent(this),this.x=t,this.y=i,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,i=this.rotation){const s=this.parentScale,[r,a]=this.pageDimensions,[o,l]=this.pageTranslation,c=e/s,h=t/s,u=this.x*r,d=this.y*a,f=this.width*r,g=this.height*a;switch(i){case 0:return[u+c+o,a-d-h-g+l,u+c+f+o,a-d-h+l];case 90:return[u+h+o,a-d+c+l,u+h+g+o,a-d+c+f+l];case 180:return[u-c-f+o,a-d+h+l,u-c+o,a-d+h+g+l];case 270:return[u-h-g+o,a-d-c-f+l,u-h+o,a-d-c+l];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[i,s,r,a]=e,o=r-i,l=a-s;switch(this.rotation){case 0:return[i,t-a,o,l];case 90:return[i,t-s,l,o];case 180:return[r,t-s,o,l];case 270:return[r,t-a,l,o];default:throw new Error("Invalid rotation")}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),O(this,Bu,!0),!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),O(this,Bu,!1),!0):!1}isInEditMode(){return b(this,Bu)}shouldGetKeyboardEvents(){return b(this,Rc)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:i,right:s}=this.getClientDimensions(),{innerHeight:r,innerWidth:a}=window;return t<a&&s>0&&e<r&&i>0}rebuild(){D(this,ln,_8).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){mi("An editor must be serializable")}static async deserialize(e,t,i){const s=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:i,annotationElementId:e.annotationElementId});s.rotation=e.rotation,O(s,Ou,e.accessibilityData),s._isCopy=e.isCopy||!1;const[r,a]=s.pageDimensions,[o,l,c,h]=s.getRectInCurrentCoords(e.rect,a);return s.x=o/r,s.y=l/a,s.width=c/r,s.height=h/a,s}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e,t;if((e=b(this,Z0))==null||e.abort(),O(this,Z0,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),b(this,Ol)&&(clearTimeout(b(this,Ol)),O(this,Ol,null)),D(this,ln,qm).call(this),this.removeEditToolbar(),b(this,no)){for(const i of b(this,no).values())clearTimeout(i);O(this,no,null)}this.parent=null,(t=b(this,Uu))==null||t.destroy(),O(this,Uu,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(D(this,ln,yE).call(this),b(this,tr).classList.remove("hidden"))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),O(this,Tc,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=b(this,tr).children;if(!b(this,No)){O(this,No,Array.from(t));const a=D(this,ln,AE).bind(this),o=D(this,ln,SE).bind(this),l=this._uiManager._signal;for(const c of b(this,No)){const h=c.getAttribute("data-resizer-name");c.setAttribute("role","spinbutton"),c.addEventListener("keydown",a,{signal:l}),c.addEventListener("blur",o,{signal:l}),c.addEventListener("focus",D(this,ln,IE).bind(this,h),{signal:l}),c.setAttribute("data-l10n-id",In._l10nResizer[h])}}const i=b(this,No)[0];let s=0;for(const a of t){if(a===i)break;s++}const r=(360-this.rotation+this.parentRotation)%360/90*(b(this,No).length/4);if(r!==s){if(r<s)for(let o=0;o<s-r;o++)b(this,tr).append(b(this,tr).firstChild);else if(r>s)for(let o=0;o<r-s;o++)b(this,tr).firstChild.before(b(this,tr).lastChild);let a=0;for(const o of t){const c=b(this,No)[a++].getAttribute("data-resizer-name");o.setAttribute("data-l10n-id",In._l10nResizer[c])}}D(this,ln,v8).call(this,0),O(this,Rc,!0),b(this,tr).firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){b(this,Rc)&&D(this,ln,y8).call(this,b(this,T2),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){D(this,ln,qm).call(this),this.div.focus()}select(){var e,t,i;if(!(this.isSelected&&this._editToolbar)){if(this.isSelected=!0,this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var s,r;(s=this.div)!=null&&s.classList.contains("selectedEditor")&&((r=this._editToolbar)==null||r.show())});return}(t=this._editToolbar)==null||t.show(),(i=b(this,Mi))==null||i.toggleAltTextBadge(!1)}}unselect(){var e,t,i,s,r;this.isSelected&&(this.isSelected=!1,(e=b(this,tr))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(i=this.div)!=null&&i.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(s=this._editToolbar)==null||s.hide(),(r=b(this,Mi))==null||r.toggleAltTextBadge(!0))}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id})}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return b(this,R2)}set isEditing(e){O(this,R2,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){O(this,Du,!0);const i=e/t,{style:s}=this.div;s.aspectRatio=i,s.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){b(this,no)||O(this,no,new Map);const{action:i}=e;let s=b(this,no).get(i);s&&clearTimeout(s),s=setTimeout(()=>{this._reportTelemetry(e),b(this,no).delete(i),b(this,no).size===0&&O(this,no,null)},In._telemetryTimeout),b(this,no).set(i,s);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),O(this,v1,!1)}disable(){this.div&&(this.div.tabIndex=-1),O(this,v1,!0)}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const i=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),i.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};Ou=new WeakMap,No=new WeakMap,Mi=new WeakMap,v1=new WeakMap,J0=new WeakMap,E2=new WeakMap,Du=new WeakMap,tr=new WeakMap,Fu=new WeakMap,Tc=new WeakMap,Z0=new WeakMap,T2=new WeakMap,Lu=new WeakMap,ka=new WeakMap,R2=new WeakMap,Bu=new WeakMap,Rc=new WeakMap,Ol=new WeakMap,k1=new WeakMap,C1=new WeakMap,no=new WeakMap,Uu=new WeakMap,M2=new WeakMap,b5=new WeakMap,ln=new WeakSet,p8=function([e,t],i,s){[i,s]=this.screenToPageTranslation(i,s),this.x+=i/e,this.y+=s/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},P2=new WeakSet,b8=function(e,t,i){switch(i){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},A9=function(e){switch(e){case 90:{const[t,i]=this.pageDimensions;return[0,-t/i,i/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,i]=this.pageDimensions;return[0,t/i,-i/t,0]}default:return[1,0,0,1]}},yE=function(){if(b(this,tr))return;O(this,tr,document.createElement("div")),b(this,tr).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const i of e){const s=document.createElement("div");b(this,tr).append(s),s.classList.add("resizer",i),s.setAttribute("data-resizer-name",i),s.addEventListener("pointerdown",D(this,ln,wE).bind(this,i),{signal:t}),s.addEventListener("contextmenu",nl,{signal:t}),s.tabIndex=-1}this.div.prepend(b(this,tr))},wE=function(e,t){var h;t.preventDefault();const{isMac:i}=dr.platform;if(t.button!==0||t.ctrlKey&&i)return;(h=b(this,Mi))==null||h.toggle(!1);const s=this._isDraggable;this._isDraggable=!1,O(this,Fu,[t.screenX,t.screenY]);const r=new AbortController,a=this._uiManager.combinedSignal(r);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",D(this,ln,y8).bind(this,e),{passive:!0,capture:!0,signal:a}),window.addEventListener("touchmove",ms,{passive:!1,signal:a}),window.addEventListener("contextmenu",nl,{signal:a}),O(this,Tc,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const o=this.parent.div.style.cursor,l=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const c=()=>{var u;r.abort(),this.parent.togglePointerEvents(!0),(u=b(this,Mi))==null||u.toggle(!0),this._isDraggable=s,this.parent.div.style.cursor=o,this.div.style.cursor=l,D(this,ln,S9).call(this)};window.addEventListener("pointerup",c,{signal:a}),window.addEventListener("blur",c,{signal:a})},x8=function(e,t,i,s){this.width=i,this.height=s,this.x=e,this.y=t;const[r,a]=this.parentDimensions;this.setDims(r*i,a*s),this.fixAndSetPosition(),this._onResized()},S9=function(){if(!b(this,Tc))return;const{savedX:e,savedY:t,savedWidth:i,savedHeight:s}=b(this,Tc);O(this,Tc,null);const r=this.x,a=this.y,o=this.width,l=this.height;r===e&&a===t&&o===i&&l===s||this.addCommands({cmd:D(this,ln,x8).bind(this,r,a,o,l),undo:D(this,ln,x8).bind(this,e,t,i,s),mustExec:!0})},y8=function(e,t){const[i,s]=this.parentDimensions,r=this.x,a=this.y,o=this.width,l=this.height,c=In.MIN_SIZE/i,h=In.MIN_SIZE/s,u=D(this,ln,A9).call(this,this.rotation),d=(R,L)=>[u[0]*R+u[2]*L,u[1]*R+u[3]*L],f=D(this,ln,A9).call(this,360-this.rotation),g=(R,L)=>[f[0]*R+f[2]*L,f[1]*R+f[3]*L];let m,x,p=!1,y=!1;switch(e){case"topLeft":p=!0,m=(R,L)=>[0,0],x=(R,L)=>[R,L];break;case"topMiddle":m=(R,L)=>[R/2,0],x=(R,L)=>[R/2,L];break;case"topRight":p=!0,m=(R,L)=>[R,0],x=(R,L)=>[0,L];break;case"middleRight":y=!0,m=(R,L)=>[R,L/2],x=(R,L)=>[0,L/2];break;case"bottomRight":p=!0,m=(R,L)=>[R,L],x=(R,L)=>[0,0];break;case"bottomMiddle":m=(R,L)=>[R/2,L],x=(R,L)=>[R/2,0];break;case"bottomLeft":p=!0,m=(R,L)=>[0,L],x=(R,L)=>[R,0];break;case"middleLeft":y=!0,m=(R,L)=>[0,L/2],x=(R,L)=>[R,L/2];break}const w=m(o,l),_=x(o,l);let v=d(..._);const C=In._round(r+v[0]),k=In._round(a+v[1]);let I=1,S=1,M,N;if(t.fromKeyboard)({deltaX:M,deltaY:N}=t);else{const{screenX:R,screenY:L}=t,[Y,j]=b(this,Fu);[M,N]=this.screenToPageTranslation(R-Y,L-j),b(this,Fu)[0]=R,b(this,Fu)[1]=L}if([M,N]=g(M/i,N/s),p){const R=Math.hypot(o,l);I=S=Math.max(Math.min(Math.hypot(_[0]-w[0]-M,_[1]-w[1]-N)/R,1/o,1/l),c/o,h/l)}else y?I=Hr(Math.abs(_[0]-w[0]-M),c,1)/o:S=Hr(Math.abs(_[1]-w[1]-N),h,1)/l;const F=In._round(o*I),H=In._round(l*S);v=d(...x(F,H));const T=C-v[0],z=k-v[1];b(this,ka)||O(this,ka,[this.x,this.y,this.width,this.height]),this.width=F,this.height=H,this.x=T,this.y=z,this.setDims(i*F,s*H),this.fixAndSetPosition(),this._onResizing()},_E=function(){var e;O(this,Tc,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(e=b(this,Mi))==null||e.toggle(!1),this.parent.togglePointerEvents(!1)},vE=function(e,t,i){let r=.7*(i/t)+1-.7;if(r===1)return;const a=D(this,ln,A9).call(this,this.rotation),o=(C,k)=>[a[0]*C+a[2]*k,a[1]*C+a[3]*k],[l,c]=this.parentDimensions,h=this.x,u=this.y,d=this.width,f=this.height,g=In.MIN_SIZE/l,m=In.MIN_SIZE/c;r=Math.max(Math.min(r,1/d,1/f),g/d,m/f);const x=In._round(d*r),p=In._round(f*r);if(x===d&&p===f)return;b(this,ka)||O(this,ka,[h,u,d,f]);const y=o(d/2,f/2),w=In._round(h+y[0]),_=In._round(u+y[1]),v=o(x/2,p/2);this.x=w-v[0],this.y=_-v[1],this.width=x,this.height=p,this.setDims(l*x,c*p),this.fixAndSetPosition(),this._onResizing()},kE=function(){var e;(e=b(this,Mi))==null||e.toggle(!0),this.parent.togglePointerEvents(!0),D(this,ln,S9).call(this)},w8=function(e){const{isMac:t}=dr.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},CE=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let i=!1;const s=new AbortController,r=this._uiManager.combinedSignal(s),a={capture:!0,passive:!1,signal:r},o=c=>{s.abort(),O(this,J0,null),O(this,Lu,!1),this._uiManager.endDragSession()||D(this,ln,w8).call(this,c),i&&this._onStopDragging()};t&&(O(this,k1,e.clientX),O(this,C1,e.clientY),O(this,J0,e.pointerId),O(this,E2,e.pointerType),window.addEventListener("pointermove",c=>{i||(i=!0,this._onStartDragging());const{clientX:h,clientY:u,pointerId:d}=c;if(d!==b(this,J0)){ms(c);return}const[f,g]=this.screenToPageTranslation(h-b(this,k1),u-b(this,C1));O(this,k1,h),O(this,C1,u),this._uiManager.dragSelectedEditors(f,g)},a),window.addEventListener("touchmove",ms,a),window.addEventListener("pointerdown",c=>{c.pointerType===b(this,E2)&&(b(this,Uu)||c.isPrimary)&&o(c),ms(c)},a));const l=c=>{if(!b(this,J0)||b(this,J0)===c.pointerId){o(c);return}ms(c)};window.addEventListener("pointerup",l,{signal:r}),window.addEventListener("blur",l,{signal:r})},_8=function(){if(b(this,Z0)||!this.div)return;O(this,Z0,new AbortController);const e=this._uiManager.combinedSignal(b(this,Z0));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},AE=function(e){In._resizerKeyboardManager.exec(this,e)},SE=function(e){var t;b(this,Rc)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==b(this,tr)&&D(this,ln,qm).call(this)},IE=function(e){O(this,T2,b(this,Rc)?e:"")},v8=function(e){if(b(this,No))for(const t of b(this,No))t.tabIndex=e},qm=function(){O(this,Rc,!1),D(this,ln,v8).call(this,-1),D(this,ln,S9).call(this)},B(In,P2),He(In,"_l10n",null),He(In,"_l10nResizer",null),He(In,"_borderLineWidth",-1),He(In,"_colorManager",new c8),He(In,"_zIndex",1),He(In,"_telemetryTimeout",1e3);let ki=In;class BL extends ki{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const _v=3285377520,Ja=4294901760,ml=65535;let EE=class{constructor(e){this.h1=e?e&4294967295:_v,this.h2=e?e&4294967295:_v}update(e){let t,i;if(typeof e=="string"){t=new Uint8Array(e.length*2),i=0;for(let m=0,x=e.length;m<x;m++){const p=e.charCodeAt(m);p<=255?t[i++]=p:(t[i++]=p>>>8,t[i++]=p&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),i=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const s=i>>2,r=i-s*4,a=new Uint32Array(t.buffer,0,s);let o=0,l=0,c=this.h1,h=this.h2;const u=3432918353,d=461845907,f=u&ml,g=d&ml;for(let m=0;m<s;m++)m&1?(o=a[m],o=o*u&Ja|o*f&ml,o=o<<15|o>>>17,o=o*d&Ja|o*g&ml,c^=o,c=c<<13|c>>>19,c=c*5+3864292196):(l=a[m],l=l*u&Ja|l*f&ml,l=l<<15|l>>>17,l=l*d&Ja|l*g&ml,h^=l,h=h<<13|h>>>19,h=h*5+3864292196);switch(o=0,r){case 3:o^=t[s*4+2]<<16;case 2:o^=t[s*4+1]<<8;case 1:o^=t[s*4],o=o*u&Ja|o*f&ml,o=o<<15|o>>>17,o=o*d&Ja|o*g&ml,s&1?c^=o:h^=o}this.h1=c,this.h2=h}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&Ja|e*36045&ml,t=t*4283543511&Ja|((t<<16|e>>>16)*2950163797&Ja)>>>16,e^=t>>>1,e=e*444984403&Ja|e*60499&ml,t=t*3301882366&Ja|((t<<16|e>>>16)*3120437893&Ja)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}};const k8=Object.freeze({map:null,hash:"",transfer:void 0});var Hu,zu,nr,x5,TE;class d4{constructor(){B(this,x5);B(this,Hu,!1);B(this,zu,null);B(this,nr,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const i=b(this,nr).get(e);return i===void 0?t:Object.assign(t,i)}getRawValue(e){return b(this,nr).get(e)}remove(e){if(b(this,nr).delete(e),b(this,nr).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const t of b(this,nr).values())if(t instanceof ki)return;this.onAnnotationEditor(null)}}setValue(e,t){const i=b(this,nr).get(e);let s=!1;if(i!==void 0)for(const[r,a]of Object.entries(t))i[r]!==a&&(s=!0,i[r]=a);else s=!0,b(this,nr).set(e,t);s&&D(this,x5,TE).call(this),t instanceof ki&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return b(this,nr).has(e)}get size(){return b(this,nr).size}resetModified(){b(this,Hu)&&(O(this,Hu,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new RE(this)}get serializable(){if(b(this,nr).size===0)return k8;const e=new Map,t=new EE,i=[],s=Object.create(null);let r=!1;for(const[a,o]of b(this,nr)){const l=o instanceof ki?o.serialize(!1,s):o;l&&(e.set(a,l),t.update(`${a}:${JSON.stringify(l)}`),r||(r=!!l.bitmap))}if(r)for(const a of e.values())a.bitmap&&i.push(a.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:i}:k8}get editorStats(){let e=null;const t=new Map;for(const i of b(this,nr).values()){if(!(i instanceof ki))continue;const s=i.telemetryFinalData;if(!s)continue;const{type:r}=s;t.has(r)||t.set(r,Object.getPrototypeOf(i).constructor),e||(e=Object.create(null));const a=e[r]||(e[r]=new Map);for(const[o,l]of Object.entries(s)){if(o==="type")continue;let c=a.get(o);c||(c=new Map,a.set(o,c));const h=c.get(l)??0;c.set(l,h+1)}}for(const[i,s]of t)e[i]=s.computeTelemetryFinalData(e[i]);return e}resetModifiedIds(){O(this,zu,null)}get modifiedIds(){if(b(this,zu))return b(this,zu);const e=[];for(const t of b(this,nr).values())!(t instanceof ki)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return O(this,zu,{ids:new Set(e),hash:e.join(",")})}[Symbol.iterator](){return b(this,nr).entries()}}Hu=new WeakMap,zu=new WeakMap,nr=new WeakMap,x5=new WeakSet,TE=function(){b(this,Hu)||(O(this,Hu,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var N2;class RE extends d4{constructor(t){super();B(this,N2);const{map:i,hash:s,transfer:r}=t.serializable,a=structuredClone(i,r?{transfer:r}:null);O(this,N2,{map:a,hash:s,transfer:r})}get print(){mi("Should not call PrintAnnotationStorage.print")}get serializable(){return b(this,N2)}get modifiedIds(){return Hn(this,"modifiedIds",{ids:new Set,hash:""})}}N2=new WeakMap;var A1;class UL{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){B(this,A1,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),b(this,A1).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:i}){if(!(!e||b(this,A1).has(e.loadedName))){if(ps(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:s,src:r,style:a}=e,o=new FontFace(s,r,a);this.addNativeFontFace(o);try{await o.load(),b(this,A1).add(s),i==null||i(e)}catch{_n(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(o)}return}mi("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const i=e.createNativeFontFace();if(i){this.addNativeFontFace(i);try{await i.loaded}catch(s){throw _n(`Failed to load font '${i.family}': '${s}'.`),e.disableFontFace=!0,s}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(i=>{const s=this._queueLoadingCallback(i);this._prepareFontLoadEvent(e,s)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return Hn(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return Hn(this,"isSyncFontLoadingSupported",Ur||dr.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(ps(!s.done,"completeRequest() cannot be called twice."),s.done=!0;i.length>0&&i[0].done;){const r=i.shift();setTimeout(r.callback,0)}}const{loadingRequests:i}=this,s={done:!1,complete:t,callback:e};return i.push(s),s}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Hn(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function i(_,v){return _.charCodeAt(v)<<24|_.charCodeAt(v+1)<<16|_.charCodeAt(v+2)<<8|_.charCodeAt(v+3)&255}function s(_,v,C,k){const I=_.substring(0,v),S=_.substring(v+C);return I+k+S}let r,a;const o=this._document.createElement("canvas");o.width=1,o.height=1;const l=o.getContext("2d");let c=0;function h(_,v){if(++c>30){_n("Load test font never loaded."),v();return}if(l.font="30px "+_,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0){v();return}setTimeout(h.bind(null,_,v))}const u=`lt${Date.now()}${this.loadTestFontId++}`;let d=this._loadTestFont;d=s(d,976,u.length,u);const g=16,m=1482184792;let x=i(d,g);for(r=0,a=u.length-3;r<a;r+=4)x=x-m+i(u,r)|0;r<u.length&&(x=x-m+i(u+"XXX",r)|0),d=s(d,g,4,kL(x));const p=`url(data:font/opentype;base64,${btoa(d)});`,y=`@font-face {font-family:"${u}";src:${p}}`;this.insertRule(y);const w=this._document.createElement("div");w.style.visibility="hidden",w.style.width=w.style.height="10px",w.style.position="absolute",w.style.top=w.style.left="0px";for(const _ of[e.loadedName,u]){const v=this._document.createElement("span");v.textContent="Hi",v.style.fontFamily=_,w.append(v)}this._document.body.append(w),h(u,()=>{w.remove(),t.complete()})}}A1=new WeakMap;class HL{constructor(e,t=null){this.compiledGlyphs=Object.create(null);for(const i in e)this[i]=e[i];this._inspectFont=t}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const i={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(i.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,i)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var i;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${ZI(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let s=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(s+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${s}src:${e}}`}return(i=this._inspectFont)==null||i.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const i=this.loadedName+"_path_"+t;let s;try{s=e.get(i)}catch(a){_n(`getPathGenerator - ignoring character: "${a}".`)}const r=new Path2D(s||"");return this.fontExtraProperties||e.delete(i),this.compiledGlyphs[t]=r}}function zL(n){if(n instanceof URL)return n.href;if(typeof n=="string"){if(Ur)return n;const e=URL.parse(n,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function jL(n){if(Ur&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return rx(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n==null?void 0:n.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Nx(n){if(typeof n!="string")return null;if(n.endsWith("/"))return n;throw new Error(`Invalid factory url: "${n}" must include trailing slash.`)}const C8=n=>typeof n=="object"&&Number.isInteger(n==null?void 0:n.num)&&n.num>=0&&Number.isInteger(n==null?void 0:n.gen)&&n.gen>=0,GL=n=>typeof n=="object"&&typeof(n==null?void 0:n.name)=="string",VL=EL.bind(null,C8,GL);var Mc,y5;class qL{constructor(){B(this,Mc,new Map);B(this,y5,Promise.resolve())}postMessage(e,t){const i={data:structuredClone(e,t?{transfer:t}:null)};b(this,y5).then(()=>{for(const[s]of b(this,Mc))s.call(this,i)})}addEventListener(e,t,i=null){let s=null;if((i==null?void 0:i.signal)instanceof AbortSignal){const{signal:r}=i;if(r.aborted){_n("LoopbackPort - cannot use an `aborted` signal.");return}const a=()=>this.removeEventListener(e,t);s=()=>r.removeEventListener("abort",a),r.addEventListener("abort",a)}b(this,Mc).set(t,s)}removeEventListener(e,t){const i=b(this,Mc).get(t);i==null||i(),b(this,Mc).delete(t)}terminate(){for(const[,e]of b(this,Mc))e==null||e();b(this,Mc).clear()}}Mc=new WeakMap,y5=new WeakMap;const Ox={DATA:1,ERROR:2},hs={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function vv(){}function ta(n){if(n instanceof Bh||n instanceof s8||n instanceof xv||n instanceof b3||n instanceof aw)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||mi('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new Bh(n.message);case"InvalidPDFException":return new s8(n.message);case"PasswordException":return new xv(n.message,n.code);case"ResponseException":return new b3(n.message,n.status,n.missing);case"UnknownErrorException":return new aw(n.message,n.details)}return new aw(n.message,n.toString())}var S1,bo,ME,PE,NE,I9,II;let Wm=(II=class{constructor(e,t,i){B(this,bo);B(this,S1,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),i.addEventListener("message",D(this,bo,ME).bind(this),{signal:b(this,S1).signal})}on(e,t){const i=this.actionHandler;if(i[e])throw new Error(`There is already an actionName called "${e}"`);i[e]=t}send(e,t,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},i)}sendWithPromise(e,t,i){const s=this.callbackId++,r=Promise.withResolvers();this.callbackCapabilities[s]=r;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:s,data:t},i)}catch(a){r.reject(a)}return r.promise}sendWithStream(e,t,i,s){const r=this.streamId++,a=this.sourceName,o=this.targetName,l=this.comObj;return new ReadableStream({start:c=>{const h=Promise.withResolvers();return this.streamControllers[r]={controller:c,startCall:h,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:a,targetName:o,action:e,streamId:r,data:t,desiredSize:c.desiredSize},s),h.promise},pull:c=>{const h=Promise.withResolvers();return this.streamControllers[r].pullCall=h,l.postMessage({sourceName:a,targetName:o,stream:hs.PULL,streamId:r,desiredSize:c.desiredSize}),h.promise},cancel:c=>{ps(c instanceof Error,"cancel must have a valid reason");const h=Promise.withResolvers();return this.streamControllers[r].cancelCall=h,this.streamControllers[r].isClosed=!0,l.postMessage({sourceName:a,targetName:o,stream:hs.CANCEL,streamId:r,reason:ta(c)}),h.promise}},i)}destroy(){var e;(e=b(this,S1))==null||e.abort(),O(this,S1,null)}},S1=new WeakMap,bo=new WeakSet,ME=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){D(this,bo,NE).call(this,e);return}if(e.callback){const i=e.callbackId,s=this.callbackCapabilities[i];if(!s)throw new Error(`Cannot resolve callback ${i}`);if(delete this.callbackCapabilities[i],e.callback===Ox.DATA)s.resolve(e.data);else if(e.callback===Ox.ERROR)s.reject(ta(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const i=this.sourceName,s=e.sourceName,r=this.comObj;Promise.try(t,e.data).then(function(a){r.postMessage({sourceName:i,targetName:s,callback:Ox.DATA,callbackId:e.callbackId,data:a})},function(a){r.postMessage({sourceName:i,targetName:s,callback:Ox.ERROR,callbackId:e.callbackId,reason:ta(a)})});return}if(e.streamId){D(this,bo,PE).call(this,e);return}t(e.data)},PE=function(e){const t=e.streamId,i=this.sourceName,s=e.sourceName,r=this.comObj,a=this,o=this.actionHandler[e.action],l={enqueue(c,h=1,u){if(this.isCancelled)return;const d=this.desiredSize;this.desiredSize-=h,d>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),r.postMessage({sourceName:i,targetName:s,stream:hs.ENQUEUE,streamId:t,chunk:c},u)},close(){this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:i,targetName:s,stream:hs.CLOSE,streamId:t}),delete a.streamSinks[t])},error(c){ps(c instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,r.postMessage({sourceName:i,targetName:s,stream:hs.ERROR,streamId:t,reason:ta(c)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[t]=l,Promise.try(o,e.data,l).then(function(){r.postMessage({sourceName:i,targetName:s,stream:hs.START_COMPLETE,streamId:t,success:!0})},function(c){r.postMessage({sourceName:i,targetName:s,stream:hs.START_COMPLETE,streamId:t,reason:ta(c)})})},NE=function(e){const t=e.streamId,i=this.sourceName,s=e.sourceName,r=this.comObj,a=this.streamControllers[t],o=this.streamSinks[t];switch(e.stream){case hs.START_COMPLETE:e.success?a.startCall.resolve():a.startCall.reject(ta(e.reason));break;case hs.PULL_COMPLETE:e.success?a.pullCall.resolve():a.pullCall.reject(ta(e.reason));break;case hs.PULL:if(!o){r.postMessage({sourceName:i,targetName:s,stream:hs.PULL_COMPLETE,streamId:t,success:!0});break}o.desiredSize<=0&&e.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=e.desiredSize,Promise.try(o.onPull||vv).then(function(){r.postMessage({sourceName:i,targetName:s,stream:hs.PULL_COMPLETE,streamId:t,success:!0})},function(c){r.postMessage({sourceName:i,targetName:s,stream:hs.PULL_COMPLETE,streamId:t,reason:ta(c)})});break;case hs.ENQUEUE:if(ps(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(e.chunk);break;case hs.CLOSE:if(ps(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),D(this,bo,I9).call(this,a,t);break;case hs.ERROR:ps(a,"error should have stream controller"),a.controller.error(ta(e.reason)),D(this,bo,I9).call(this,a,t);break;case hs.CANCEL_COMPLETE:e.success?a.cancelCall.resolve():a.cancelCall.reject(ta(e.reason)),D(this,bo,I9).call(this,a,t);break;case hs.CANCEL:if(!o)break;const l=ta(e.reason);Promise.try(o.onCancel||vv,l).then(function(){r.postMessage({sourceName:i,targetName:s,stream:hs.CANCEL_COMPLETE,streamId:t,success:!0})},function(c){r.postMessage({sourceName:i,targetName:s,stream:hs.CANCEL_COMPLETE,streamId:t,reason:ta(c)})}),o.sinkCapability.reject(l),o.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},I9=async function(e,t){var i,s,r;await Promise.allSettled([(i=e.startCall)==null?void 0:i.promise,(s=e.pullCall)==null?void 0:s.promise,(r=e.cancelCall)==null?void 0:r.promise]),delete this.streamControllers[t]},II);var O2;class OE{constructor({enableHWA:e=!1}){B(this,O2,!1);O(this,O2,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const i=this._createCanvas(e,t);return{canvas:i,context:i.getContext("2d",{willReadFrequently:!b(this,O2)})}}reset(e,t,i){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||i<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=i}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){mi("Abstract method `_createCanvas` called.")}}O2=new WeakMap;class WL extends OE{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const i=this._document.createElement("canvas");return i.width=e,i.height=t,i}}class DE{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(i=>({cMapData:i,isCompressed:this.isCompressed})).catch(i=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){mi("Abstract method `_fetch` called.")}}class kv extends DE{async _fetch(e){const t=await ax(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):rx(t)}}class FE{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,i,s,r){return"none"}destroy(e=!1){}}var ju,I1,Pc,Nc,wr,Gu,Vu,Dt,xr,Km,wf,E9,_f,LE,A8,vf,Xm,Ym,S8,Jm;class KL extends FE{constructor({docId:t,ownerDocument:i=globalThis.document}){super();B(this,Dt);B(this,ju);B(this,I1);B(this,Pc);B(this,Nc);B(this,wr);B(this,Gu);B(this,Vu,0);O(this,Nc,t),O(this,wr,i)}addFilter(t){if(!t)return"none";let i=b(this,Dt,xr).get(t);if(i)return i;const[s,r,a]=D(this,Dt,E9).call(this,t),o=t.length===1?s:`${s}${r}${a}`;if(i=b(this,Dt,xr).get(o),i)return b(this,Dt,xr).set(t,i),i;const l=`g_${b(this,Nc)}_transfer_map_${Mr(this,Vu)._++}`,c=D(this,Dt,_f).call(this,l);b(this,Dt,xr).set(t,c),b(this,Dt,xr).set(o,c);const h=D(this,Dt,vf).call(this,l);return D(this,Dt,Ym).call(this,s,r,a,h),c}addHCMFilter(t,i){var g;const s=`${t}-${i}`,r="base";let a=b(this,Dt,Km).get(r);if((a==null?void 0:a.key)===s||(a?((g=a.filter)==null||g.remove(),a.key=s,a.url="none",a.filter=null):(a={key:s,url:"none",filter:null},b(this,Dt,Km).set(r,a)),!t||!i))return a.url;const o=D(this,Dt,Jm).call(this,t);t=tn.makeHexColor(...o);const l=D(this,Dt,Jm).call(this,i);if(i=tn.makeHexColor(...l),b(this,Dt,wf).style.color="",t==="#000000"&&i==="#ffffff"||t===i)return a.url;const c=new Array(256);for(let m=0;m<=255;m++){const x=m/255;c[m]=x<=.03928?x/12.92:((x+.055)/1.055)**2.4}const h=c.join(","),u=`g_${b(this,Nc)}_hcm_filter`,d=a.filter=D(this,Dt,vf).call(this,u);D(this,Dt,Ym).call(this,h,h,h,d),D(this,Dt,A8).call(this,d);const f=(m,x)=>{const p=o[m]/255,y=l[m]/255,w=new Array(x+1);for(let _=0;_<=x;_++)w[_]=p+_/x*(y-p);return w.join(",")};return D(this,Dt,Ym).call(this,f(0,5),f(1,5),f(2,5),d),a.url=D(this,Dt,_f).call(this,u),a.url}addAlphaFilter(t){let i=b(this,Dt,xr).get(t);if(i)return i;const[s]=D(this,Dt,E9).call(this,[t]),r=`alpha_${s}`;if(i=b(this,Dt,xr).get(r),i)return b(this,Dt,xr).set(t,i),i;const a=`g_${b(this,Nc)}_alpha_map_${Mr(this,Vu)._++}`,o=D(this,Dt,_f).call(this,a);b(this,Dt,xr).set(t,o),b(this,Dt,xr).set(r,o);const l=D(this,Dt,vf).call(this,a);return D(this,Dt,S8).call(this,s,l),o}addLuminosityFilter(t){let i=b(this,Dt,xr).get(t||"luminosity");if(i)return i;let s,r;if(t?([s]=D(this,Dt,E9).call(this,[t]),r=`luminosity_${s}`):r="luminosity",i=b(this,Dt,xr).get(r),i)return b(this,Dt,xr).set(t,i),i;const a=`g_${b(this,Nc)}_luminosity_map_${Mr(this,Vu)._++}`,o=D(this,Dt,_f).call(this,a);b(this,Dt,xr).set(t,o),b(this,Dt,xr).set(r,o);const l=D(this,Dt,vf).call(this,a);return D(this,Dt,LE).call(this,l),t&&D(this,Dt,S8).call(this,s,l),o}addHighlightHCMFilter(t,i,s,r,a){var y;const o=`${i}-${s}-${r}-${a}`;let l=b(this,Dt,Km).get(t);if((l==null?void 0:l.key)===o||(l?((y=l.filter)==null||y.remove(),l.key=o,l.url="none",l.filter=null):(l={key:o,url:"none",filter:null},b(this,Dt,Km).set(t,l)),!i||!s))return l.url;const[c,h]=[i,s].map(D(this,Dt,Jm).bind(this));let u=Math.round(.2126*c[0]+.7152*c[1]+.0722*c[2]),d=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),[f,g]=[r,a].map(D(this,Dt,Jm).bind(this));d<u&&([u,d,f,g]=[d,u,g,f]),b(this,Dt,wf).style.color="";const m=(w,_,v)=>{const C=new Array(256),k=(d-u)/v,I=w/255,S=(_-w)/(255*v);let M=0;for(let N=0;N<=v;N++){const F=Math.round(u+N*k),H=I+N*S;for(let T=M;T<=F;T++)C[T]=H;M=F+1}for(let N=M;N<256;N++)C[N]=C[M-1];return C.join(",")},x=`g_${b(this,Nc)}_hcm_${t}_filter`,p=l.filter=D(this,Dt,vf).call(this,x);return D(this,Dt,A8).call(this,p),D(this,Dt,Ym).call(this,m(f[0],g[0],5),m(f[1],g[1],5),m(f[2],g[2],5),p),l.url=D(this,Dt,_f).call(this,x),l.url}destroy(t=!1){var i,s,r,a;t&&((i=b(this,Gu))!=null&&i.size)||((s=b(this,Pc))==null||s.parentNode.parentNode.remove(),O(this,Pc,null),(r=b(this,I1))==null||r.clear(),O(this,I1,null),(a=b(this,Gu))==null||a.clear(),O(this,Gu,null),O(this,Vu,0))}}ju=new WeakMap,I1=new WeakMap,Pc=new WeakMap,Nc=new WeakMap,wr=new WeakMap,Gu=new WeakMap,Vu=new WeakMap,Dt=new WeakSet,xr=function(){return b(this,I1)||O(this,I1,new Map)},Km=function(){return b(this,Gu)||O(this,Gu,new Map)},wf=function(){if(!b(this,Pc)){const t=b(this,wr).createElement("div"),{style:i}=t;i.visibility="hidden",i.contain="strict",i.width=i.height=0,i.position="absolute",i.top=i.left=0,i.zIndex=-1;const s=b(this,wr).createElementNS(uc,"svg");s.setAttribute("width",0),s.setAttribute("height",0),O(this,Pc,b(this,wr).createElementNS(uc,"defs")),t.append(s),s.append(b(this,Pc)),b(this,wr).body.append(t)}return b(this,Pc)},E9=function(t){if(t.length===1){const c=t[0],h=new Array(256);for(let d=0;d<256;d++)h[d]=c[d]/255;const u=h.join(",");return[u,u,u]}const[i,s,r]=t,a=new Array(256),o=new Array(256),l=new Array(256);for(let c=0;c<256;c++)a[c]=i[c]/255,o[c]=s[c]/255,l[c]=r[c]/255;return[a.join(","),o.join(","),l.join(",")]},_f=function(t){if(b(this,ju)===void 0){O(this,ju,"");const i=b(this,wr).URL;i!==b(this,wr).baseURI&&(J5(i)?_n('#createUrl: ignore "data:"-URL for performance reasons.'):O(this,ju,XI(i,"")))}return`url(${b(this,ju)}#${t})`},LE=function(t){const i=b(this,wr).createElementNS(uc,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(i)},A8=function(t){const i=b(this,wr).createElementNS(uc,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(i)},vf=function(t){const i=b(this,wr).createElementNS(uc,"filter");return i.setAttribute("color-interpolation-filters","sRGB"),i.setAttribute("id",t),b(this,Dt,wf).append(i),i},Xm=function(t,i,s){const r=b(this,wr).createElementNS(uc,i);r.setAttribute("type","discrete"),r.setAttribute("tableValues",s),t.append(r)},Ym=function(t,i,s,r){const a=b(this,wr).createElementNS(uc,"feComponentTransfer");r.append(a),D(this,Dt,Xm).call(this,a,"feFuncR",t),D(this,Dt,Xm).call(this,a,"feFuncG",i),D(this,Dt,Xm).call(this,a,"feFuncB",s)},S8=function(t,i){const s=b(this,wr).createElementNS(uc,"feComponentTransfer");i.append(s),D(this,Dt,Xm).call(this,s,"feFuncA",t)},Jm=function(t){return b(this,Dt,wf).style.color=t,u4(getComputedStyle(b(this,Dt,wf)).getPropertyValue("color"))};class BE{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(i=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){mi("Abstract method `_fetch` called.")}}class Cv extends BE{async _fetch(e){const t=await ax(e,"arraybuffer");return new Uint8Array(t)}}class UE{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(i=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){mi("Abstract method `_fetch` called.")}}class Av extends UE{async _fetch(e){const t=await ax(e,"arraybuffer");return new Uint8Array(t)}}Ur&&_n("Please use the `legacy` build in Node.js environments.");async function f4(n){const t=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(t)}class XL extends FE{}class YL extends OE{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class JL extends DE{async _fetch(e){return f4(e)}}class ZL extends BE{async _fetch(e){return f4(e)}}class QL extends UE{async _fetch(e){return f4(e)}}const or={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function I8(n,e){if(!e)return;const t=e[2]-e[0],i=e[3]-e[1],s=new Path2D;s.rect(e[0],e[1],t,i),n.clip(s)}class g4{isModifyingCurrentTransform(){return!1}getPattern(){mi("Abstract method `getPattern` called.")}}class $L extends g4{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const i of this._colorStops)t.addColorStop(i[0],i[1]);return t}getPattern(e,t,i,s){let r;if(s===or.STROKE||s===or.FILL){const a=t.current.getClippedPathBoundingBox(s,qi(e))||[0,0,0,0],o=Math.ceil(a[2]-a[0])||1,l=Math.ceil(a[3]-a[1])||1,c=t.cachedCanvases.getCanvas("pattern",o,l),h=c.context;h.clearRect(0,0,h.canvas.width,h.canvas.height),h.beginPath(),h.rect(0,0,h.canvas.width,h.canvas.height),h.translate(-a[0],-a[1]),i=tn.transform(i,[1,0,0,1,a[0],a[1]]),h.transform(...t.baseTransform),this.matrix&&h.transform(...this.matrix),I8(h,this._bbox),h.fillStyle=this._createGradient(h),h.fill(),r=e.createPattern(c.canvas,"no-repeat");const u=new DOMMatrix(i);r.setTransform(u)}else I8(e,this._bbox),r=this._createGradient(e);return r}}function cw(n,e,t,i,s,r,a,o){const l=e.coords,c=e.colors,h=n.data,u=n.width*4;let d;l[t+1]>l[i+1]&&(d=t,t=i,i=d,d=r,r=a,a=d),l[i+1]>l[s+1]&&(d=i,i=s,s=d,d=a,a=o,o=d),l[t+1]>l[i+1]&&(d=t,t=i,i=d,d=r,r=a,a=d);const f=(l[t]+e.offsetX)*e.scaleX,g=(l[t+1]+e.offsetY)*e.scaleY,m=(l[i]+e.offsetX)*e.scaleX,x=(l[i+1]+e.offsetY)*e.scaleY,p=(l[s]+e.offsetX)*e.scaleX,y=(l[s+1]+e.offsetY)*e.scaleY;if(g>=y)return;const w=c[r],_=c[r+1],v=c[r+2],C=c[a],k=c[a+1],I=c[a+2],S=c[o],M=c[o+1],N=c[o+2],F=Math.round(g),H=Math.round(y);let T,z,R,L,Y,j,J,G;for(let se=F;se<=H;se++){if(se<x){const P=se<g?0:(g-se)/(g-x);T=f-(f-m)*P,z=w-(w-C)*P,R=_-(_-k)*P,L=v-(v-I)*P}else{let P;se>y?P=1:x===y?P=0:P=(x-se)/(x-y),T=m-(m-p)*P,z=C-(C-S)*P,R=k-(k-M)*P,L=I-(I-N)*P}let de;se<g?de=0:se>y?de=1:de=(g-se)/(g-y),Y=f-(f-p)*de,j=w-(w-S)*de,J=_-(_-M)*de,G=v-(v-N)*de;const he=Math.round(Math.min(T,Y)),we=Math.round(Math.max(T,Y));let ye=u*se+he*4;for(let P=he;P<=we;P++)de=(T-P)/(T-Y),de<0?de=0:de>1&&(de=1),h[ye++]=z-(z-j)*de|0,h[ye++]=R-(R-J)*de|0,h[ye++]=L-(L-G)*de|0,h[ye++]=255}}function eB(n,e,t){const i=e.coords,s=e.colors;let r,a;switch(e.type){case"lattice":const o=e.verticesPerRow,l=Math.floor(i.length/o)-1,c=o-1;for(r=0;r<l;r++){let h=r*o;for(let u=0;u<c;u++,h++)cw(n,t,i[h],i[h+1],i[h+o],s[h],s[h+1],s[h+o]),cw(n,t,i[h+o+1],i[h+1],i[h+o],s[h+o+1],s[h+1],s[h+o])}break;case"triangles":for(r=0,a=i.length;r<a;r+=3)cw(n,t,i[r],i[r+1],i[r+2],s[r],s[r+1],s[r+2]);break;default:throw new Error("illegal figure")}}class tB extends g4{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,i){const o=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),c=Math.ceil(this._bounds[2])-o,h=Math.ceil(this._bounds[3])-l,u=Math.min(Math.ceil(Math.abs(c*e[0]*1.1)),3e3),d=Math.min(Math.ceil(Math.abs(h*e[1]*1.1)),3e3),f=c/u,g=h/d,m={coords:this._coords,colors:this._colors,offsetX:-o,offsetY:-l,scaleX:1/f,scaleY:1/g},x=u+2*2,p=d+2*2,y=i.getCanvas("mesh",x,p),w=y.context,_=w.createImageData(u,d);if(t){const C=_.data;for(let k=0,I=C.length;k<I;k+=4)C[k]=t[0],C[k+1]=t[1],C[k+2]=t[2],C[k+3]=255}for(const C of this._figures)eB(_,C,m);return w.putImageData(_,2,2),{canvas:y.canvas,offsetX:o-2*f,offsetY:l-2*g,scaleX:f,scaleY:g}}isModifyingCurrentTransform(){return!0}getPattern(e,t,i,s){I8(e,this._bbox);const r=new Float32Array(2);if(s===or.SHADING)tn.singularValueDecompose2dScale(qi(e),r);else if(this.matrix){tn.singularValueDecompose2dScale(this.matrix,r);const[o,l]=r;tn.singularValueDecompose2dScale(t.baseTransform,r),r[0]*=o,r[1]*=l}else tn.singularValueDecompose2dScale(t.baseTransform,r);const a=this._createMeshCanvas(r,s===or.SHADING?null:this._background,t.cachedCanvases);return s!==or.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(a.offsetX,a.offsetY),e.scale(a.scaleX,a.scaleY),e.createPattern(a.canvas,"no-repeat")}}class nB extends g4{getPattern(){return"hotpink"}}function iB(n){switch(n[0]){case"RadialAxial":return new $L(n);case"Mesh":return new tB(n);case"Dummy":return new nB}throw new Error(`Unknown IR type: ${n[0]}`)}const Sv={COLORED:1,UNCOLORED:2},w5=class w5{constructor(e,t,i,s){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=i,this.baseTransform=s}createPatternCanvas(e){const{bbox:t,operatorList:i,paintType:s,tilingType:r,color:a,canvasGraphicsFactory:o}=this;let{xstep:l,ystep:c}=this;l=Math.abs(l),c=Math.abs(c),Y5("TilingType: "+r);const h=t[0],u=t[1],d=t[2],f=t[3],g=d-h,m=f-u,x=new Float32Array(2);tn.singularValueDecompose2dScale(this.matrix,x);const[p,y]=x;tn.singularValueDecompose2dScale(this.baseTransform,x);const w=p*x[0],_=y*x[1];let v=g,C=m,k=!1,I=!1;const S=Math.ceil(l*w),M=Math.ceil(c*_),N=Math.ceil(g*w),F=Math.ceil(m*_);S>=N?v=l:k=!0,M>=F?C=c:I=!0;const H=this.getSizeAndScale(v,this.ctx.canvas.width,w),T=this.getSizeAndScale(C,this.ctx.canvas.height,_),z=e.cachedCanvases.getCanvas("pattern",H.size,T.size),R=z.context,L=o.createCanvasGraphics(R);if(L.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(L,s,a),R.translate(-H.scale*h,-T.scale*u),L.transform(H.scale,0,0,T.scale,0,0),R.save(),this.clipBbox(L,h,u,d,f),L.baseTransform=qi(L.ctx),L.executeOperatorList(i),L.endDrawing(),R.restore(),k||I){const Y=z.canvas;k&&(v=l),I&&(C=c);const j=this.getSizeAndScale(v,this.ctx.canvas.width,w),J=this.getSizeAndScale(C,this.ctx.canvas.height,_),G=j.size,se=J.size,de=e.cachedCanvases.getCanvas("pattern-workaround",G,se),he=de.context,we=k?Math.floor(g/l):0,ye=I?Math.floor(m/c):0;for(let P=0;P<=we;P++)for(let V=0;V<=ye;V++)he.drawImage(Y,G*P,se*V,G,se,0,0,G,se);return{canvas:de.canvas,scaleX:j.scale,scaleY:J.scale,offsetX:h,offsetY:u}}return{canvas:z.canvas,scaleX:H.scale,scaleY:T.scale,offsetX:h,offsetY:u}}getSizeAndScale(e,t,i){const s=Math.max(w5.MAX_PATTERN_SIZE,t);let r=Math.ceil(e*i);return r>=s?r=s:i=r/e,{scale:i,size:r}}clipBbox(e,t,i,s,r){const a=s-t,o=r-i;e.ctx.rect(t,i,a,o),tn.axialAlignedBoundingBox([t,i,s,r],qi(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,i){const s=e.ctx,r=e.current;switch(t){case Sv.COLORED:const{fillStyle:a,strokeStyle:o}=this.ctx;s.fillStyle=r.fillColor=a,s.strokeStyle=r.strokeColor=o;break;case Sv.UNCOLORED:s.fillStyle=s.strokeStyle=i,r.fillColor=r.strokeColor=i;break;default:throw new vL(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,i,s){let r=i;s!==or.SHADING&&(r=tn.transform(r,t.baseTransform),this.matrix&&(r=tn.transform(r,this.matrix)));const a=this.createPatternCanvas(t);let o=new DOMMatrix(r);o=o.translate(a.offsetX,a.offsetY),o=o.scale(1/a.scaleX,1/a.scaleY);const l=e.createPattern(a.canvas,"repeat");return l.setTransform(o),l}};He(w5,"MAX_PATTERN_SIZE",3e3);let E8=w5;function sB({src:n,srcPos:e=0,dest:t,width:i,height:s,nonBlackColor:r=4294967295,inverseDecode:a=!1}){const o=dr.isLittleEndian?4278190080:255,[l,c]=a?[r,o]:[o,r],h=i>>3,u=i&7,d=n.length;t=new Uint32Array(t.buffer);let f=0;for(let g=0;g<s;g++){for(const x=e+h;e<x;e++){const p=e<d?n[e]:255;t[f++]=p&128?c:l,t[f++]=p&64?c:l,t[f++]=p&32?c:l,t[f++]=p&16?c:l,t[f++]=p&8?c:l,t[f++]=p&4?c:l,t[f++]=p&2?c:l,t[f++]=p&1?c:l}if(u===0)continue;const m=e<d?n[e++]:255;for(let x=0;x<u;x++)t[f++]=m&1<<7-x?c:l}return{srcPos:e,destPos:f}}const Iv=16,Ev=100,rB=15,Tv=10,oa=16,hw=new DOMMatrix,La=new Float32Array(2),Ff=new Float32Array([1/0,1/0,-1/0,-1/0]);function aB(n,e){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){e.save(),this.__originalSave()},n.restore=function(){e.restore(),this.__originalRestore()},n.translate=function(t,i){e.translate(t,i),this.__originalTranslate(t,i)},n.scale=function(t,i){e.scale(t,i),this.__originalScale(t,i)},n.transform=function(t,i,s,r,a,o){e.transform(t,i,s,r,a,o),this.__originalTransform(t,i,s,r,a,o)},n.setTransform=function(t,i,s,r,a,o){e.setTransform(t,i,s,r,a,o),this.__originalSetTransform(t,i,s,r,a,o)},n.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},n.rotate=function(t){e.rotate(t),this.__originalRotate(t)},n.clip=function(t){e.clip(t),this.__originalClip(t)},n.moveTo=function(t,i){e.moveTo(t,i),this.__originalMoveTo(t,i)},n.lineTo=function(t,i){e.lineTo(t,i),this.__originalLineTo(t,i)},n.bezierCurveTo=function(t,i,s,r,a,o){e.bezierCurveTo(t,i,s,r,a,o),this.__originalBezierCurveTo(t,i,s,r,a,o)},n.rect=function(t,i,s,r){e.rect(t,i,s,r),this.__originalRect(t,i,s,r)},n.closePath=function(){e.closePath(),this.__originalClosePath()},n.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class oB{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,i){let s;return this.cache[e]!==void 0?(s=this.cache[e],this.canvasFactory.reset(s,t,i)):(s=this.canvasFactory.create(t,i),this.cache[e]=s),s}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function Dx(n,e,t,i,s,r,a,o,l,c){const[h,u,d,f,g,m]=qi(n);if(u===0&&d===0){const y=a*h+g,w=Math.round(y),_=o*f+m,v=Math.round(_),C=(a+l)*h+g,k=Math.abs(Math.round(C)-w)||1,I=(o+c)*f+m,S=Math.abs(Math.round(I)-v)||1;return n.setTransform(Math.sign(h),0,0,Math.sign(f),w,v),n.drawImage(e,t,i,s,r,0,0,k,S),n.setTransform(h,u,d,f,g,m),[k,S]}if(h===0&&f===0){const y=o*d+g,w=Math.round(y),_=a*u+m,v=Math.round(_),C=(o+c)*d+g,k=Math.abs(Math.round(C)-w)||1,I=(a+l)*u+m,S=Math.abs(Math.round(I)-v)||1;return n.setTransform(0,Math.sign(u),Math.sign(d),0,w,v),n.drawImage(e,t,i,s,r,0,0,S,k),n.setTransform(h,u,d,f,g,m),[S,k]}n.drawImage(e,t,i,s,r,a,o,l,c);const x=Math.hypot(h,u),p=Math.hypot(d,f);return[x*l,p*c]}class Rv{constructor(e,t){He(this,"alphaIsShape",!1);He(this,"fontSize",0);He(this,"fontSizeScale",1);He(this,"textMatrix",null);He(this,"textMatrixScale",1);He(this,"fontMatrix",i8);He(this,"leading",0);He(this,"x",0);He(this,"y",0);He(this,"lineX",0);He(this,"lineY",0);He(this,"charSpacing",0);He(this,"wordSpacing",0);He(this,"textHScale",1);He(this,"textRenderingMode",br.FILL);He(this,"textRise",0);He(this,"fillColor","#000000");He(this,"strokeColor","#000000");He(this,"patternFill",!1);He(this,"patternStroke",!1);He(this,"fillAlpha",1);He(this,"strokeAlpha",1);He(this,"lineWidth",1);He(this,"activeSMask",null);He(this,"transferMaps","none");this.clipBox=new Float32Array([0,0,e,t]),this.minMax=Ff.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=or.FILL,t=null){const i=this.minMax.slice();if(e===or.STROKE){t||mi("Stroke bounding box must include transform."),tn.singularValueDecompose2dScale(t,La);const s=La[0]*this.lineWidth/2,r=La[1]*this.lineWidth/2;i[0]-=s,i[1]-=r,i[2]+=s,i[3]+=r}return i}updateClipFromPath(){const e=tn.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(Ff,0)}getClippedPathBoundingBox(e=or.FILL,t=null){return tn.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function Mv(n,e){if(e instanceof ImageData){n.putImageData(e,0,0);return}const t=e.height,i=e.width,s=t%oa,r=(t-s)/oa,a=s===0?r:r+1,o=n.createImageData(i,oa);let l=0,c;const h=e.data,u=o.data;let d,f,g,m;if(e.kind===x9.GRAYSCALE_1BPP){const x=h.byteLength,p=new Uint32Array(u.buffer,0,u.byteLength>>2),y=p.length,w=i+7>>3,_=4294967295,v=dr.isLittleEndian?4278190080:255;for(d=0;d<a;d++){for(g=d<r?oa:s,c=0,f=0;f<g;f++){const C=x-l;let k=0;const I=C>w?i:C*8-7,S=I&-8;let M=0,N=0;for(;k<S;k+=8)N=h[l++],p[c++]=N&128?_:v,p[c++]=N&64?_:v,p[c++]=N&32?_:v,p[c++]=N&16?_:v,p[c++]=N&8?_:v,p[c++]=N&4?_:v,p[c++]=N&2?_:v,p[c++]=N&1?_:v;for(;k<I;k++)M===0&&(N=h[l++],M=128),p[c++]=N&M?_:v,M>>=1}for(;c<y;)p[c++]=0;n.putImageData(o,0,d*oa)}}else if(e.kind===x9.RGBA_32BPP){for(f=0,m=i*oa*4,d=0;d<r;d++)u.set(h.subarray(l,l+m)),l+=m,n.putImageData(o,0,f),f+=oa;d<a&&(m=i*s*4,u.set(h.subarray(l,l+m)),n.putImageData(o,0,f))}else if(e.kind===x9.RGB_24BPP)for(g=oa,m=i*g,d=0;d<a;d++){for(d>=r&&(g=s,m=i*g),c=0,f=m;f--;)u[c++]=h[l++],u[c++]=h[l++],u[c++]=h[l++],u[c++]=255;n.putImageData(o,0,d*oa)}else throw new Error(`bad image kind: ${e.kind}`)}function Pv(n,e){if(e.bitmap){n.drawImage(e.bitmap,0,0);return}const t=e.height,i=e.width,s=t%oa,r=(t-s)/oa,a=s===0?r:r+1,o=n.createImageData(i,oa);let l=0;const c=e.data,h=o.data;for(let u=0;u<a;u++){const d=u<r?oa:s;({srcPos:l}=sB({src:c,srcPos:l,dest:h,width:i,height:d,nonBlackColor:0})),n.putImageData(o,0,u*oa)}}function _m(n,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of t)n[i]!==void 0&&(e[i]=n[i]);n.setLineDash!==void 0&&(e.setLineDash(n.getLineDash()),e.lineDashOffset=n.lineDashOffset)}function Fx(n){n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0);const{filter:e}=n;e!=="none"&&e!==""&&(n.filter="none")}function Nv(n,e){if(e)return!0;tn.singularValueDecompose2dScale(n,La);const t=Math.fround(ic.pixelRatio*Uh.PDF_TO_CSS_UNITS);return La[0]<=t&&La[1]<=t}const lB=["butt","round","square"],cB=["miter","round","bevel"],hB={},Ov={};var al,T8,R8,M8;const W_=class W_{constructor(e,t,i,s,r,{optionalContentConfig:a,markedContentStack:o=null},l,c){B(this,al);this.ctx=e,this.current=new Rv(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=i,this.canvasFactory=s,this.filterFactory=r,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=o||[],this.optionalContentConfig=a,this.cachedCanvases=new oB(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=l,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=c,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:i=!1,background:s=null}){const r=this.ctx.canvas.width,a=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=s||"#ffffff",this.ctx.fillRect(0,0,r,a),this.ctx.fillStyle=o,i){const l=this.cachedCanvases.getCanvas("transparent",r,a);this.compositeCtx=this.ctx,this.transparentCanvas=l.canvas,this.ctx=l.context,this.ctx.save(),this.ctx.transform(...qi(this.compositeCtx))}this.ctx.save(),Fx(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=qi(this.ctx)}executeOperatorList(e,t,i,s){const r=e.argsArray,a=e.fnArray;let o=t||0;const l=r.length;if(l===o)return o;const c=l-o>Tv&&typeof i=="function",h=c?Date.now()+rB:0;let u=0;const d=this.commonObjs,f=this.objs;let g;for(;;){if(s!==void 0&&o===s.nextBreakPoint)return s.breakIt(o,i),o;if(g=a[o],g!==p3.dependency)this[g].apply(this,r[o]);else for(const m of r[o]){const x=m.startsWith("g_")?d:f;if(!x.has(m))return x.get(m,i),o}if(o++,o===l)return o;if(c&&++u>Tv){if(Date.now()>h)return i(),o;u=0}}}endDrawing(){D(this,al,T8).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),D(this,al,R8).call(this)}_scaleImage(e,t){const i=e.width??e.displayWidth,s=e.height??e.displayHeight;let r=Math.max(Math.hypot(t[0],t[1]),1),a=Math.max(Math.hypot(t[2],t[3]),1),o=i,l=s,c="prescale1",h,u;for(;r>2&&o>1||a>2&&l>1;){let d=o,f=l;r>2&&o>1&&(d=o>=16384?Math.floor(o/2)-1||1:Math.ceil(o/2),r/=o/d),a>2&&l>1&&(f=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l)/2,a/=l/f),h=this.cachedCanvases.getCanvas(c,d,f),u=h.context,u.clearRect(0,0,d,f),u.drawImage(e,0,0,o,l,0,0,d,f),e=h.canvas,o=d,l=f,c=c==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:o,paintHeight:l}}_createMaskCanvas(e){const t=this.ctx,{width:i,height:s}=e,r=this.current.fillColor,a=this.current.patternFill,o=qi(t);let l,c,h,u;if((e.bitmap||e.data)&&e.count>1){const S=e.bitmap||e.data.buffer;c=JSON.stringify(a?o:[o.slice(0,4),r]),l=this._cachedBitmapsMap.get(S),l||(l=new Map,this._cachedBitmapsMap.set(S,l));const M=l.get(c);if(M&&!a){const N=Math.round(Math.min(o[0],o[2])+o[4]),F=Math.round(Math.min(o[1],o[3])+o[5]);return{canvas:M,offsetX:N,offsetY:F}}h=M}h||(u=this.cachedCanvases.getCanvas("maskCanvas",i,s),Pv(u.context,e));let d=tn.transform(o,[1/i,0,0,-1/s,0,0]);d=tn.transform(d,[1,0,0,1,0,-s]);const f=Ff.slice();tn.axialAlignedBoundingBox([0,0,i,s],d,f);const[g,m,x,p]=f,y=Math.round(x-g)||1,w=Math.round(p-m)||1,_=this.cachedCanvases.getCanvas("fillCanvas",y,w),v=_.context,C=g,k=m;v.translate(-C,-k),v.transform(...d),h||(h=this._scaleImage(u.canvas,gl(v)),h=h.img,l&&a&&l.set(c,h)),v.imageSmoothingEnabled=Nv(qi(v),e.interpolate),Dx(v,h,0,0,h.width,h.height,0,0,i,s),v.globalCompositeOperation="source-in";const I=tn.transform(gl(v),[1,0,0,1,-C,-k]);return v.fillStyle=a?r.getPattern(t,this,I,or.FILL):r,v.fillRect(0,0,i,s),l&&!a&&(this.cachedCanvases.delete("fillCanvas"),l.set(c,_.canvas)),{canvas:_.canvas,offsetX:Math.round(C),offsetY:Math.round(k)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=lB[e]}setLineJoin(e){this.ctx.lineJoin=cB[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const i=this.ctx;i.setLineDash!==void 0&&(i.setLineDash(e),i.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,i]of e)switch(t){case"LW":this.setLineWidth(i);break;case"LC":this.setLineCap(i);break;case"LJ":this.setLineJoin(i);break;case"ML":this.setMiterLimit(i);break;case"D":this.setDash(i[0],i[1]);break;case"RI":this.setRenderingIntent(i);break;case"FL":this.setFlatness(i);break;case"Font":this.setFont(i[0],i[1]);break;case"CA":this.current.strokeAlpha=i;break;case"ca":this.ctx.globalAlpha=this.current.fillAlpha=i;break;case"BM":this.ctx.globalCompositeOperation=i;break;case"SMask":this.current.activeSMask=i?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(i);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,i="smaskGroupAt"+this.groupLevel,s=this.cachedCanvases.getCanvas(i,e,t);this.suspendedCtx=this.ctx;const r=this.ctx=s.context;r.setTransform(this.suspendedCtx.getTransform()),_m(this.suspendedCtx,r),aB(r,this.suspendedCtx),this.setGState([["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),_m(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,i=this.suspendedCtx;this.composeSMask(i,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,i,s){const r=s[0],a=s[1],o=s[2]-r,l=s[3]-a;o===0||l===0||(this.genericComposeSMask(t.context,i,o,l,t.subtype,t.backdrop,t.transferMap,r,a,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(i.canvas,0,0),e.restore())}genericComposeSMask(e,t,i,s,r,a,o,l,c,h,u){let d=e.canvas,f=l-h,g=c-u;if(a)if(f<0||g<0||f+i>d.width||g+s>d.height){const x=this.cachedCanvases.getCanvas("maskExtension",i,s),p=x.context;p.drawImage(d,-f,-g),p.globalCompositeOperation="destination-atop",p.fillStyle=a,p.fillRect(0,0,i,s),p.globalCompositeOperation="source-over",d=x.canvas,f=g=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const x=new Path2D;x.rect(f,g,i,s),e.clip(x),e.globalCompositeOperation="destination-atop",e.fillStyle=a,e.fillRect(f,g,i,s),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),r==="Alpha"&&o?t.filter=this.filterFactory.addAlphaFilter(o):r==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(o));const m=new Path2D;m.rect(l,c,i,s),t.clip(m),t.globalCompositeOperation="destination-in",t.drawImage(d,f,g,i,s,l,c,i,s),t.restore()}save(){this.inSMaskMode&&_m(this.ctx,this.suspendedCtx),this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){if(this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&_m(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,t,i,s,r,a){this.ctx.transform(e,t,i,s,r,a),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,i){let[s]=t;if(!i){s||(s=t[0]=new Path2D),this[e](s);return}if(!(s instanceof Path2D)){const r=t[0]=new Path2D;for(let a=0,o=s.length;a<o;)switch(s[a++]){case Px.moveTo:r.moveTo(s[a++],s[a++]);break;case Px.lineTo:r.lineTo(s[a++],s[a++]);break;case Px.curveTo:r.bezierCurveTo(s[a++],s[a++],s[a++],s[a++],s[a++],s[a++]);break;case Px.closePath:r.closePath();break;default:_n(`Unrecognized drawing path operator: ${s[a-1]}`);break}s=r}tn.axialAlignedBoundingBox(i,qi(this.ctx),this.current.minMax),this[e](s)}closePath(){this.ctx.closePath()}stroke(e,t=!0){const i=this.ctx,s=this.current.strokeColor;if(i.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof s=="object"&&(s!=null&&s.getPattern)){const r=s.isModifyingCurrentTransform()?i.getTransform():null;if(i.save(),i.strokeStyle=s.getPattern(i,this,gl(i),or.STROKE),r){const a=new Path2D;a.addPath(e,i.getTransform().invertSelf().multiplySelf(r)),e=a}this.rescaleAndStroke(e,!1),i.restore()}else this.rescaleAndStroke(e,!0);t&&this.consumePath(e,this.current.getClippedPathBoundingBox(or.STROKE,qi(this.ctx))),i.globalAlpha=this.current.fillAlpha}closeStroke(e){this.stroke(e)}fill(e,t=!0){const i=this.ctx,s=this.current.fillColor,r=this.current.patternFill;let a=!1;if(r){const l=s.isModifyingCurrentTransform()?i.getTransform():null;if(i.save(),i.fillStyle=s.getPattern(i,this,gl(i),or.FILL),l){const c=new Path2D;c.addPath(e,i.getTransform().invertSelf().multiplySelf(l)),e=c}a=!0}const o=this.current.getClippedPathBoundingBox();this.contentVisible&&o!==null&&(this.pendingEOFill?(i.fill(e,"evenodd"),this.pendingEOFill=!1):i.fill(e)),a&&i.restore(),t&&this.consumePath(e,o)}eoFill(e){this.pendingEOFill=!0,this.fill(e)}fillStroke(e){this.fill(e,!1),this.stroke(e,!1),this.consumePath(e)}eoFillStroke(e){this.pendingEOFill=!0,this.fillStroke(e)}closeFillStroke(e){this.fillStroke(e)}closeEOFillStroke(e){this.pendingEOFill=!0,this.fillStroke(e)}endPath(e){this.consumePath(e)}rawFillPath(e){this.ctx.fill(e)}clip(){this.pendingClip=hB}eoClip(){this.pendingClip=Ov}beginText(){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(e===void 0)return;const i=new Path2D,s=t.getTransform().invertSelf();for(const{transform:r,x:a,y:o,fontSize:l,path:c}of e)i.addPath(c,new DOMMatrix(r).preMultiplySelf(s).translate(a,o).scale(l,-l));t.clip(i),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){var h;const i=this.commonObjs.get(e),s=this.current;if(!i)throw new Error(`Can't find font for ${e}`);if(s.fontMatrix=i.fontMatrix||i8,(s.fontMatrix[0]===0||s.fontMatrix[3]===0)&&_n("Invalid font matrix for font "+e),t<0?(t=-t,s.fontDirection=-1):s.fontDirection=1,this.current.font=i,this.current.fontSize=t,i.isType3Font)return;const r=i.loadedName||"sans-serif",a=((h=i.systemFontInfo)==null?void 0:h.css)||`"${r}", ${i.fallbackName}`;let o="normal";i.black?o="900":i.bold&&(o="bold");const l=i.italic?"italic":"normal";let c=t;t<Iv?c=Iv:t>Ev&&(c=Ev),this.current.fontSizeScale=t/c,this.ctx.font=`${l} ${o} ${c}px ${a}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e){const{current:t}=this;t.textMatrix=e,t.textMatrixScale=Math.hypot(e[0],e[1]),t.x=t.lineX=0,t.y=t.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(e,t,i,s,r){const a=this.ctx,o=this.current,l=o.font,c=o.textRenderingMode,h=o.fontSize/o.fontSizeScale,u=c&br.FILL_STROKE_MASK,d=!!(c&br.ADD_TO_PATH_FLAG),f=o.patternFill&&!l.missingFile,g=o.patternStroke&&!l.missingFile;let m;if((l.disableFontFace||d||f||g)&&(m=l.getPathGenerator(this.commonObjs,e)),l.disableFontFace||f||g){a.save(),a.translate(t,i),a.scale(h,-h);let x;if((u===br.FILL||u===br.FILL_STROKE)&&(s?(x=a.getTransform(),a.setTransform(...s),a.fill(D(this,al,M8).call(this,m,x,s))):a.fill(m)),u===br.STROKE||u===br.FILL_STROKE)if(r){x||(x=a.getTransform()),a.setTransform(...r);const{a:p,b:y,c:w,d:_}=x,v=tn.inverseTransform(r),C=tn.transform([p,y,w,_,0,0],v);tn.singularValueDecompose2dScale(C,La),a.lineWidth*=Math.max(La[0],La[1])/h,a.stroke(D(this,al,M8).call(this,m,x,r))}else a.lineWidth/=h,a.stroke(m);a.restore()}else(u===br.FILL||u===br.FILL_STROKE)&&a.fillText(e,t,i),(u===br.STROKE||u===br.FILL_STROKE)&&a.strokeText(e,t,i);d&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:qi(a),x:t,y:i,fontSize:h,path:m})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let i=!1;for(let s=3;s<t.length;s+=4)if(t[s]>0&&t[s]<255){i=!0;break}return Hn(this,"isFontSubpixelAAEnabled",i)}showText(e){const t=this.current,i=t.font;if(i.isType3Font)return this.showType3Text(e);const s=t.fontSize;if(s===0)return;const r=this.ctx,a=t.fontSizeScale,o=t.charSpacing,l=t.wordSpacing,c=t.fontDirection,h=t.textHScale*c,u=e.length,d=i.vertical,f=d?1:-1,g=i.defaultVMetrics,m=s*t.fontMatrix[0],x=t.textRenderingMode===br.FILL&&!i.disableFontFace&&!t.patternFill;r.save(),t.textMatrix&&r.transform(...t.textMatrix),r.translate(t.x,t.y+t.textRise),c>0?r.scale(h,-1):r.scale(h,1);let p,y;if(t.patternFill){r.save();const k=t.fillColor.getPattern(r,this,gl(r),or.FILL);p=qi(r),r.restore(),r.fillStyle=k}if(t.patternStroke){r.save();const k=t.strokeColor.getPattern(r,this,gl(r),or.STROKE);y=qi(r),r.restore(),r.strokeStyle=k}let w=t.lineWidth;const _=t.textMatrixScale;if(_===0||w===0){const k=t.textRenderingMode&br.FILL_STROKE_MASK;(k===br.STROKE||k===br.FILL_STROKE)&&(w=this.getSinglePixelWidth())}else w/=_;if(a!==1&&(r.scale(a,a),w/=a),r.lineWidth=w,i.isInvalidPDFjsFont){const k=[];let I=0;for(const S of e)k.push(S.unicode),I+=S.width;r.fillText(k.join(""),0,0),t.x+=I*m*h,r.restore(),this.compose();return}let v=0,C;for(C=0;C<u;++C){const k=e[C];if(typeof k=="number"){v+=f*k*s/1e3;continue}let I=!1;const S=(k.isSpace?l:0)+o,M=k.fontChar,N=k.accent;let F,H,T=k.width;if(d){const R=k.vmetric||g,L=-(k.vmetric?R[1]:T*.5)*m,Y=R[2]*m;T=R?-R[0]:T,F=L/a,H=(v+Y)/a}else F=v/a,H=0;if(i.remeasure&&T>0){const R=r.measureText(M).width*1e3/s*a;if(T<R&&this.isFontSubpixelAAEnabled){const L=T/R;I=!0,r.save(),r.scale(L,1),F/=L}else T!==R&&(F+=(T-R)/2e3*s/a)}if(this.contentVisible&&(k.isInFont||i.missingFile)){if(x&&!N)r.fillText(M,F,H);else if(this.paintChar(M,F,H,p,y),N){const R=F+s*N.offset.x/a,L=H-s*N.offset.y/a;this.paintChar(N.fontChar,R,L,p,y)}}const z=d?T*m-S*c:T*m+S*c;v+=z,I&&r.restore()}d?t.y-=v:t.x+=v*h,r.restore(),this.compose()}showType3Text(e){const t=this.ctx,i=this.current,s=i.font,r=i.fontSize,a=i.fontDirection,o=s.vertical?1:-1,l=i.charSpacing,c=i.wordSpacing,h=i.textHScale*a,u=i.fontMatrix||i8,d=e.length,f=i.textRenderingMode===br.INVISIBLE;let g,m,x,p;if(!(f||r===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),i.textMatrix&&t.transform(...i.textMatrix),t.translate(i.x,i.y+i.textRise),t.scale(h,a),g=0;g<d;++g){if(m=e[g],typeof m=="number"){p=o*m*r/1e3,this.ctx.translate(p,0),i.x+=p*h;continue}const y=(m.isSpace?c:0)+l,w=s.charProcOperatorList[m.operatorListId];w?this.contentVisible&&(this.save(),t.scale(r,r),t.transform(...u),this.executeOperatorList(w),this.restore()):_n(`Type3 character "${m.operatorListId}" is not available.`);const _=[m.width,0];tn.applyTransform(_,u),x=_[0]*r+y,t.translate(x,0),i.x+=x*h}t.restore()}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,i,s,r,a){const o=new Path2D;o.rect(i,s,r-i,a-s),this.ctx.clip(o),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){const i=this.baseTransform||qi(this.ctx),s={createCanvasGraphics:r=>new W_(r,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new E8(e,this.ctx,s,i)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e){this.ctx.strokeStyle=this.current.strokeColor=e,this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e){this.ctx.fillStyle=this.current.fillColor=e,this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let i;return this.cachedPatterns.has(e)?i=this.cachedPatterns.get(e):(i=iB(this.getObject(e)),this.cachedPatterns.set(e,i)),t&&(i.matrix=t),i}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const i=this._getPattern(e);t.fillStyle=i.getPattern(t,this,gl(t),or.SHADING);const s=gl(t);if(s){const{width:r,height:a}=t.canvas,o=Ff.slice();tn.axialAlignedBoundingBox([0,0,r,a],s,o);const[l,c,h,u]=o;this.ctx.fillRect(l,c,h-l,u-c)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){mi("Should not call beginInlineImage")}beginImageData(){mi("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=qi(this.ctx),t)){tn.axialAlignedBoundingBox(t,this.baseTransform,this.current.minMax);const[i,s,r,a]=t,o=new Path2D;o.rect(i,s,r-i,a-s),this.ctx.clip(o),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||Y5("TODO: Support non-isolated groups."),e.knockout&&_n("Knockout groups not supported.");const i=qi(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let s=Ff.slice();tn.axialAlignedBoundingBox(e.bbox,qi(t),s);const r=[0,0,t.canvas.width,t.canvas.height];s=tn.intersect(s,r)||[0,0,0,0];const a=Math.floor(s[0]),o=Math.floor(s[1]),l=Math.max(Math.ceil(s[2])-a,1),c=Math.max(Math.ceil(s[3])-o,1);this.current.startNewPathAndClipBox([0,0,l,c]);let h="groupAt"+this.groupLevel;e.smask&&(h+="_smask_"+this.smaskCounter++%2);const u=this.cachedCanvases.getCanvas(h,l,c),d=u.context;d.translate(-a,-o),d.transform(...i);let f=new Path2D;const[g,m,x,p]=e.bbox;if(f.rect(g,m,x-g,p-m),e.matrix){const y=new Path2D;y.addPath(f,new DOMMatrix(e.matrix)),f=y}d.clip(f),e.smask?this.smaskStack.push({canvas:u.canvas,context:d,offsetX:a,offsetY:o,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(a,o),t.save()),_m(t,d),this.ctx=d,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,i=this.groupStack.pop();if(this.ctx=i,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const s=qi(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...s);const r=Ff.slice();tn.axialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],s,r),this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(r)}}beginAnnotation(e,t,i,s,r){if(D(this,al,T8).call(this),Fx(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){const a=t[2]-t[0],o=t[3]-t[1];if(r&&this.annotationCanvasMap){i=i.slice(),i[4]-=t[0],i[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=a,t[3]=o,tn.singularValueDecompose2dScale(qi(this.ctx),La);const{viewportScale:l}=this,c=Math.ceil(a*this.outputScaleX*l),h=Math.ceil(o*this.outputScaleY*l);this.annotationCanvas=this.canvasFactory.create(c,h);const{canvas:u,context:d}=this.annotationCanvas;this.annotationCanvasMap.set(e,u),this.annotationCanvas.savedCtx=this.ctx,this.ctx=d,this.ctx.save(),this.ctx.setTransform(La[0],0,0,-La[1],0,o*La[1]),Fx(this.ctx)}else{Fx(this.ctx),this.endPath();const l=new Path2D;l.rect(t[0],t[1],a,o),this.ctx.clip(l)}}this.current=new Rv(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...i),this.transform(...s)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),D(this,al,R8).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;e=this.getObject(e.data,e),e.count=t;const i=this.ctx,s=this._createMaskCanvas(e),r=s.canvas;i.save(),i.setTransform(1,0,0,1,0,0),i.drawImage(r,s.offsetX,s.offsetY),i.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,i=0,s=0,r,a){if(!this.contentVisible)return;e=this.getObject(e.data,e);const o=this.ctx;o.save();const l=qi(o);o.transform(t,i,s,r,0,0);const c=this._createMaskCanvas(e);o.setTransform(1,0,0,1,c.offsetX-l[4],c.offsetY-l[5]);for(let h=0,u=a.length;h<u;h+=2){const d=tn.transform(l,[t,i,s,r,a[h],a[h+1]]);o.drawImage(c.canvas,d[4],d[5])}o.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,i=this.current.fillColor,s=this.current.patternFill;for(const r of e){const{data:a,width:o,height:l,transform:c}=r,h=this.cachedCanvases.getCanvas("maskCanvas",o,l),u=h.context;u.save();const d=this.getObject(a,r);Pv(u,d),u.globalCompositeOperation="source-in",u.fillStyle=s?i.getPattern(u,this,gl(t),or.FILL):i,u.fillRect(0,0,o,l),u.restore(),t.save(),t.transform(...c),t.scale(1,-1),Dx(t,h.canvas,0,0,o,l,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);if(!t){_n("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,i,s){if(!this.contentVisible)return;const r=this.getObject(e);if(!r){_n("Dependent image isn't ready yet");return}const a=r.width,o=r.height,l=[];for(let c=0,h=s.length;c<h;c+=2)l.push({transform:[t,0,0,i,s[c],s[c+1]],x:0,y:0,w:a,h:o});this.paintInlineImageXObjectGroup(r,l)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:i,height:s}=e,r=this.cachedCanvases.getCanvas("inlineImage",i,s),a=r.context;return a.filter=this.current.transferMaps,a.drawImage(t,0,0),a.filter="none",r.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,i=e.height,s=this.ctx;this.save();const{filter:r}=s;r!=="none"&&r!==""&&(s.filter="none"),s.scale(1/t,-1/i);let a;if(e.bitmap)a=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)a=e;else{const c=this.cachedCanvases.getCanvas("inlineImage",t,i).context;Mv(c,e),a=this.applyTransferMapsToCanvas(c)}const o=this._scaleImage(a,gl(s));s.imageSmoothingEnabled=Nv(qi(s),e.interpolate),Dx(s,o.img,0,0,o.paintWidth,o.paintHeight,0,-i,t,i),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const i=this.ctx;let s;if(e.bitmap)s=e.bitmap;else{const r=e.width,a=e.height,l=this.cachedCanvases.getCanvas("inlineImage",r,a).context;Mv(l,e),s=this.applyTransferMapsToCanvas(l)}for(const r of t)i.save(),i.transform(...r.transform),i.scale(1,-1),Dx(i,s,r.x,r.y,r.w,r.h,0,-1,1,1),i.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e,t){const i=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(t);const s=this.ctx;this.pendingClip&&(i||(this.pendingClip===Ov?s.clip(e,"evenodd"):s.clip(e)),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=qi(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),i=Math.hypot(e[0],e[2]),s=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(i,s)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:i,c:s,d:r}=this.ctx.getTransform();let a,o;if(i===0&&s===0){const l=Math.abs(t),c=Math.abs(r);if(l===c)if(e===0)a=o=1/l;else{const h=l*e;a=o=h<1?1/h:1}else if(e===0)a=1/l,o=1/c;else{const h=l*e,u=c*e;a=h<1?1/h:1,o=u<1?1/u:1}}else{const l=Math.abs(t*r-i*s),c=Math.hypot(t,i),h=Math.hypot(s,r);if(e===0)a=h/l,o=c/l;else{const u=e*l;a=h>u?h/u:1,o=c>u?c/u:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=o}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:i,current:{lineWidth:s}}=this,[r,a]=this.getScaleForStroking();if(r===a){i.lineWidth=(s||1)*r,i.stroke(e);return}const o=i.getLineDash();t&&i.save(),i.scale(r,a),hw.a=1/r,hw.d=1/a;const l=new Path2D;if(l.addPath(e,hw),o.length>0){const c=Math.max(r,a);i.setLineDash(o.map(h=>h/c)),i.lineDashOffset/=c}i.lineWidth=s||1,i.stroke(l),t&&i.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};al=new WeakSet,T8=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},R8=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},M8=function(e,t,i){const s=new Path2D;return s.addPath(e,new DOMMatrix(i).invertSelf().multiplySelf(t)),s};let $f=W_;for(const n in p3)$f.prototype[n]!==void 0&&($f.prototype[p3[n]]=$f.prototype[n]);var D2,F2;class Wl{static get workerPort(){return b(this,D2)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");O(this,D2,e)}static get workerSrc(){return b(this,F2)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");O(this,F2,e)}}D2=new WeakMap,F2=new WeakMap,B(Wl,D2,null),B(Wl,F2,"");var E1,L2;class uB{constructor({parsedData:e,rawData:t}){B(this,E1);B(this,L2);O(this,E1,e),O(this,L2,t)}getRaw(){return b(this,L2)}get(e){return b(this,E1).get(e)??null}[Symbol.iterator](){return b(this,E1).entries()}}E1=new WeakMap,L2=new WeakMap;const kf=Symbol("INTERNAL");var B2,U2,H2,T1;class dB{constructor(e,{name:t,intent:i,usage:s,rbGroups:r}){B(this,B2,!1);B(this,U2,!1);B(this,H2,!1);B(this,T1,!0);O(this,B2,!!(e&Fa.DISPLAY)),O(this,U2,!!(e&Fa.PRINT)),this.name=t,this.intent=i,this.usage=s,this.rbGroups=r}get visible(){if(b(this,H2))return b(this,T1);if(!b(this,T1))return!1;const{print:e,view:t}=this.usage;return b(this,B2)?(t==null?void 0:t.viewState)!=="OFF":b(this,U2)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,i=!1){e!==kf&&mi("Internal method `_setVisible` called."),O(this,H2,i),O(this,T1,t)}}B2=new WeakMap,U2=new WeakMap,H2=new WeakMap,T1=new WeakMap;var Q0,di,R1,M1,z2,P8;class fB{constructor(e,t=Fa.DISPLAY){B(this,z2);B(this,Q0,null);B(this,di,new Map);B(this,R1,null);B(this,M1,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,O(this,M1,e.order);for(const i of e.groups)b(this,di).set(i.id,new dB(t,i));if(e.baseState==="OFF")for(const i of b(this,di).values())i._setVisible(kf,!1);for(const i of e.on)b(this,di).get(i)._setVisible(kf,!0);for(const i of e.off)b(this,di).get(i)._setVisible(kf,!1);O(this,R1,this.getHash())}}isVisible(e){if(b(this,di).size===0)return!0;if(!e)return Y5("Optional content group not defined."),!0;if(e.type==="OCG")return b(this,di).has(e.id)?b(this,di).get(e.id).visible:(_n(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return D(this,z2,P8).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!b(this,di).has(t))return _n(`Optional content group not found: ${t}`),!0;if(b(this,di).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!b(this,di).has(t))return _n(`Optional content group not found: ${t}`),!0;if(!b(this,di).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!b(this,di).has(t))return _n(`Optional content group not found: ${t}`),!0;if(!b(this,di).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!b(this,di).has(t))return _n(`Optional content group not found: ${t}`),!0;if(b(this,di).get(t).visible)return!1}return!0}return _n(`Unknown optional content policy ${e.policy}.`),!0}return _n(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,i=!0){var r;const s=b(this,di).get(e);if(!s){_n(`Optional content group not found: ${e}`);return}if(i&&t&&s.rbGroups.length)for(const a of s.rbGroups)for(const o of a)o!==e&&((r=b(this,di).get(o))==null||r._setVisible(kf,!1,!0));s._setVisible(kf,!!t,!0),O(this,Q0,null)}setOCGState({state:e,preserveRB:t}){let i;for(const s of e){switch(s){case"ON":case"OFF":case"Toggle":i=s;continue}const r=b(this,di).get(s);if(r)switch(i){case"ON":this.setVisibility(s,!0,t);break;case"OFF":this.setVisibility(s,!1,t);break;case"Toggle":this.setVisibility(s,!r.visible,t);break}}O(this,Q0,null)}get hasInitialVisibility(){return b(this,R1)===null||this.getHash()===b(this,R1)}getOrder(){return b(this,di).size?b(this,M1)?b(this,M1).slice():[...b(this,di).keys()]:null}getGroup(e){return b(this,di).get(e)||null}getHash(){if(b(this,Q0)!==null)return b(this,Q0);const e=new EE;for(const[t,i]of b(this,di))e.update(`${t}:${i.visible}`);return O(this,Q0,e.hexdigest())}[Symbol.iterator](){return b(this,di).entries()}}Q0=new WeakMap,di=new WeakMap,R1=new WeakMap,M1=new WeakMap,z2=new WeakSet,P8=function(e){const t=e.length;if(t<2)return!0;const i=e[0];for(let s=1;s<t;s++){const r=e[s];let a;if(Array.isArray(r))a=D(this,z2,P8).call(this,r);else if(b(this,di).has(r))a=b(this,di).get(r).visible;else return _n(`Optional content group not found: ${r}`),!0;switch(i){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return i==="And"};class gB{constructor(e,{disableRange:t=!1,disableStream:i=!1}){ps(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:s,initialData:r,progressiveDone:a,contentDispositionFilename:o}=e;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=o,(r==null?void 0:r.length)>0){const l=r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer;this._queuedChunks.push(l)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!i,this._isRangeSupported=!t,this._contentLength=s,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((l,c)=>{this._onReceiveData({begin:l,chunk:c})}),e.addProgressListener((l,c)=>{this._onProgress({loaded:l,total:c})}),e.addProgressiveReadListener(l=>{this._onReceiveData({chunk:l})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const i=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(i):this._queuedChunks.push(i);else{const s=this._rangeReaders.some(function(r){return r._begin!==e?!1:(r._enqueue(i),!0)});ps(s,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}_onProgress(e){var t,i,s,r;e.total===void 0?(i=(t=this._rangeReaders[0])==null?void 0:t.onProgress)==null||i.call(t,{loaded:e.loaded}):(r=(s=this._fullRequestReader)==null?void 0:s.onProgress)==null||r.call(s,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;(e=this._fullRequestReader)==null||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){ps(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new mB(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const i=new pB(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(i),i}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const i of this._rangeReaders.slice(0))i.cancel(e);this._pdfDataRangeTransport.abort()}}class mB{constructor(e,t,i=!1,s=null){this._stream=e,this._done=i||!1,this._filename=c4(s)?s:null,this._queuedChunks=t||[],this._loaded=0;for(const r of this._queuedChunks)this._loaded+=r.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class pB{constructor(e,t,i){this._stream=e,this._begin=t,this._end=i,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function bB(n){let e=!0,t=i("filename\\*","i").exec(n);if(t){t=t[1];let h=o(t);return h=unescape(h),h=l(h),h=c(h),r(h)}if(t=a(n),t){const h=c(t);return r(h)}if(t=i("filename","i").exec(n),t){t=t[1];let h=o(t);return h=c(h),r(h)}function i(h,u){return new RegExp("(?:^|;)\\s*"+h+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',u)}function s(h,u){if(h){if(!/^[\x00-\xFF]+$/.test(u))return u;try{const d=new TextDecoder(h,{fatal:!0}),f=rx(u);u=d.decode(f),e=!1}catch{}}return u}function r(h){return e&&/[\x80-\xff]/.test(h)&&(h=s("utf-8",h),e&&(h=s("iso-8859-1",h))),h}function a(h){const u=[];let d;const f=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(d=f.exec(h))!==null;){let[,m,x,p]=d;if(m=parseInt(m,10),m in u){if(m===0)break;continue}u[m]=[x,p]}const g=[];for(let m=0;m<u.length&&m in u;++m){let[x,p]=u[m];p=o(p),x&&(p=unescape(p),m===0&&(p=l(p))),g.push(p)}return g.join("")}function o(h){if(h.startsWith('"')){const u=h.slice(1).split('\\"');for(let d=0;d<u.length;++d){const f=u[d].indexOf('"');f!==-1&&(u[d]=u[d].slice(0,f),u.length=d+1),u[d]=u[d].replaceAll(/\\(.)/g,"$1")}h=u.join('"')}return h}function l(h){const u=h.indexOf("'");if(u===-1)return h;const d=h.slice(0,u),g=h.slice(u+1).replace(/^[^']*'/,"");return s(d,g)}function c(h){return!h.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(h)?h:h.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(u,d,f,g){if(f==="q"||f==="Q")return g=g.replaceAll("_"," "),g=g.replaceAll(/=([0-9a-fA-F]{2})/g,function(m,x){return String.fromCharCode(parseInt(x,16))}),s(d,g);try{g=atob(g)}catch{}return s(d,g)})}return""}function HE(n,e){const t=new Headers;if(!n||!e||typeof e!="object")return t;for(const i in e){const s=e[i];s!==void 0&&t.append(i,s)}return t}function Z5(n){var e;return((e=URL.parse(n))==null?void 0:e.origin)??null}function zE({responseHeaders:n,isHttp:e,rangeChunkSize:t,disableRange:i}){const s={allowRangeRequests:!1,suggestedLength:void 0},r=parseInt(n.get("Content-Length"),10);return!Number.isInteger(r)||(s.suggestedLength=r,r<=2*t)||i||!e||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(s.allowRangeRequests=!0),s}function jE(n){const e=n.get("Content-Disposition");if(e){let t=bB(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(c4(t))return t}return null}function cx(n,e){return new b3(`Unexpected server response (${n}) while retrieving PDF "${e}".`,n,n===404||n===0&&e.startsWith("file:"))}function GE(n){return n===200||n===206}function VE(n,e,t){return{method:"GET",headers:n,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function qE(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(_n(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class xB{constructor(e){He(this,"_responseOrigin",null);this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=HE(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return ps(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new yB(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const i=new wB(this,e,t);return this._rangeRequestReaders.push(i),i}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const i of this._rangeRequestReaders.slice(0))i.cancel(e)}}class yB{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const i=new Headers(e.headers),s=t.url;fetch(s,VE(i,this._withCredentials,this._abortController)).then(r=>{if(e._responseOrigin=Z5(r.url),!GE(r.status))throw cx(r.status,s);this._reader=r.body.getReader(),this._headersCapability.resolve();const a=r.headers,{allowRangeRequests:o,suggestedLength:l}=zE({responseHeaders:a,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=l||this._contentLength,this._filename=jE(a),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Bh("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded,total:this._contentLength}),{value:qE(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}class wB{constructor(e,t,i){this._stream=e,this._reader=null,this._loaded=0;const s=e.source;this._withCredentials=s.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!s.disableStream,this._abortController=new AbortController;const r=new Headers(e.headers);r.append("Range",`bytes=${t}-${i-1}`);const a=s.url;fetch(a,VE(r,this._withCredentials,this._abortController)).then(o=>{const l=Z5(o.url);if(l!==e._responseOrigin)throw new Error(`Expected range response-origin "${l}" to match "${e._responseOrigin}".`);if(!GE(o.status))throw cx(o.status,a);this._readCapability.resolve(),this._reader=o.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded}),{value:qE(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}const uw=200,dw=206;function _B(n){const e=n.response;return typeof e!="string"?e:rx(e).buffer}class vB{constructor({url:e,httpHeaders:t,withCredentials:i}){He(this,"_responseOrigin",null);this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=HE(this.isHttp,t),this.withCredentials=i||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,i=this.currXhrId++,s=this.pendingRequests[i]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[r,a]of this.headers)t.setRequestHeader(r,a);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),s.expectedStatus=dw):s.expectedStatus=uw,t.responseType="arraybuffer",ps(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,i),t.onprogress=this.onProgress.bind(this,i),s.onHeadersReceived=e.onHeadersReceived,s.onDone=e.onDone,s.onError=e.onError,s.onProgress=e.onProgress,t.send(null),i}onProgress(e,t){var s;const i=this.pendingRequests[e];i&&((s=i.onProgress)==null||s.call(i,t))}onStateChange(e,t){const i=this.pendingRequests[e];if(!i)return;const s=i.xhr;if(s.readyState>=2&&i.onHeadersReceived&&(i.onHeadersReceived(),delete i.onHeadersReceived),s.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],s.status===0&&this.isHttp){i.onError(s.status);return}const r=s.status||uw;if(!(r===uw&&i.expectedStatus===dw)&&r!==i.expectedStatus){i.onError(s.status);return}const o=_B(s);if(r===dw){const l=s.getResponseHeader("Content-Range"),c=/bytes (\d+)-(\d+)\/(\d+)/.exec(l);c?i.onDone({begin:parseInt(c[1],10),chunk:o}):(_n('Missing or invalid "Content-Range" header.'),i.onError(0))}else o?i.onDone({begin:0,chunk:o}):i.onError(s.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class kB{constructor(e){this._source=e,this._manager=new vB(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return ps(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new CB(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const i=new AB(this._manager,e,t);return i.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(i),i}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const i of this._rangeRequestReaders.slice(0))i.cancel(e)}}class CB{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=Z5(t.responseURL);const i=t.getAllResponseHeaders(),s=new Headers(i?i.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(o=>{const[l,...c]=o.split(": ");return[l,c.join(": ")]}):[]),{allowRangeRequests:r,suggestedLength:a}=zE({responseHeaders:s,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});r&&(this._isRangeSupported=!0),this._contentLength=a||this._contentLength,this._filename=jE(s),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=cx(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;(t=this.onProgress)==null||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class AB{constructor(e,t,i){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:i,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var t;const e=Z5((t=this._manager.getRequestXhr(this._requestId))==null?void 0:t.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var e;(e=this.onClosed)==null||e.call(this,this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??(this._storedError=cx(e,this._url));for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||(t=this.onProgress)==null||t.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const SB=/^[a-z][a-z0-9\-+.]+:/i;function IB(n){if(SB.test(n))return new URL(n);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(n))}class EB{constructor(e){this.source=e,this.url=IB(e.url),ps(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return ps(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new TB(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const i=new RB(this,e,t);return this._rangeRequestReaders.push(i),i}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const i of this._rangeRequestReaders.slice(0))i.cancel(e)}}class TB{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const i=process.getBuiltinModule("fs");i.promises.lstat(this._url).then(s=>{this._contentLength=s.size,this._setReadableStream(i.createReadStream(this._url)),this._headersCapability.resolve()},s=>{s.code==="ENOENT"&&(s=cx(0,this._url.href)),this._storedError=s,this._headersCapability.reject(s)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Bh("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class RB{constructor(e,t,i){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const s=e.source;this._isStreamingSupported=!s.disableStream;const r=process.getBuiltinModule("fs");this._setReadableStream(r.createReadStream(this._url,{start:t,end:i-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const vm=Symbol("INITIAL_DATA");var Ca,j2,N8;class WE{constructor(){B(this,j2);B(this,Ca,Object.create(null))}get(e,t=null){if(t){const s=D(this,j2,N8).call(this,e);return s.promise.then(()=>t(s.data)),null}const i=b(this,Ca)[e];if(!i||i.data===vm)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return i.data}has(e){const t=b(this,Ca)[e];return!!t&&t.data!==vm}delete(e){const t=b(this,Ca)[e];return!t||t.data===vm?!1:(delete b(this,Ca)[e],!0)}resolve(e,t=null){const i=D(this,j2,N8).call(this,e);i.data=t,i.resolve()}clear(){var e;for(const t in b(this,Ca)){const{data:i}=b(this,Ca)[t];(e=i==null?void 0:i.bitmap)==null||e.close()}O(this,Ca,Object.create(null))}*[Symbol.iterator](){for(const e in b(this,Ca)){const{data:t}=b(this,Ca)[e];t!==vm&&(yield[e,t])}}}Ca=new WeakMap,j2=new WeakSet,N8=function(e){var t;return(t=b(this,Ca))[e]||(t[e]={...Promise.withResolvers(),data:vm})};const MB=1e5,Dv=30;var EI,$0,sa,G2,V2,qu,Oc,q2,W2,Wu,P1,N1,eh,O1,K2,D1,Ku,X2,Y2,F1,Xu,J2,th,L1,v0,KE,XE,O8,Wa,T9,D8,YE,JE;const vs=class vs{constructor({textContentSource:e,container:t,viewport:i}){B(this,v0);B(this,$0,Promise.withResolvers());B(this,sa,null);B(this,G2,!1);B(this,V2,!!((EI=globalThis.FontInspector)!=null&&EI.enabled));B(this,qu,null);B(this,Oc,null);B(this,q2,0);B(this,W2,0);B(this,Wu,null);B(this,P1,null);B(this,N1,0);B(this,eh,0);B(this,O1,Object.create(null));B(this,K2,[]);B(this,D1,null);B(this,Ku,[]);B(this,X2,new WeakMap);B(this,Y2,null);var l;if(e instanceof ReadableStream)O(this,D1,e);else if(typeof e=="object")O(this,D1,new ReadableStream({start(c){c.enqueue(e),c.close()}}));else throw new Error('No "textContentSource" parameter specified.');O(this,sa,O(this,P1,t)),O(this,eh,i.scale*ic.pixelRatio),O(this,N1,i.rotation),O(this,Oc,{div:null,properties:null,ctx:null});const{pageWidth:s,pageHeight:r,pageX:a,pageY:o}=i.rawDims;O(this,Y2,[1,0,0,-1,-a,o+r]),O(this,W2,s),O(this,q2,r),D(l=vs,Wa,YE).call(l),Vd(t,i),b(this,$0).promise.finally(()=>{b(vs,L1).delete(this),O(this,Oc,null),O(this,O1,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=dr.platform;return Hn(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{b(this,Wu).read().then(({value:t,done:i})=>{if(i){b(this,$0).resolve();return}b(this,qu)??O(this,qu,t.lang),Object.assign(b(this,O1),t.styles),D(this,v0,KE).call(this,t.items),e()},b(this,$0).reject)};return O(this,Wu,b(this,D1).getReader()),b(vs,L1).add(this),e(),b(this,$0).promise}update({viewport:e,onBefore:t=null}){var r;const i=e.scale*ic.pixelRatio,s=e.rotation;if(s!==b(this,N1)&&(t==null||t(),O(this,N1,s),Vd(b(this,P1),{rotation:s})),i!==b(this,eh)){t==null||t(),O(this,eh,i);const a={div:null,properties:null,ctx:D(r=vs,Wa,T9).call(r,b(this,qu))};for(const o of b(this,Ku))a.properties=b(this,X2).get(o),a.div=o,D(this,v0,O8).call(this,a)}}cancel(){var t;const e=new Bh("TextLayer task cancelled.");(t=b(this,Wu))==null||t.cancel(e).catch(()=>{}),O(this,Wu,null),b(this,$0).reject(e)}get textDivs(){return b(this,Ku)}get textContentItemsStr(){return b(this,K2)}static cleanup(){if(!(b(this,L1).size>0)){b(this,F1).clear();for(const{canvas:e}of b(this,Xu).values())e.remove();b(this,Xu).clear()}}};$0=new WeakMap,sa=new WeakMap,G2=new WeakMap,V2=new WeakMap,qu=new WeakMap,Oc=new WeakMap,q2=new WeakMap,W2=new WeakMap,Wu=new WeakMap,P1=new WeakMap,N1=new WeakMap,eh=new WeakMap,O1=new WeakMap,K2=new WeakMap,D1=new WeakMap,Ku=new WeakMap,X2=new WeakMap,Y2=new WeakMap,F1=new WeakMap,Xu=new WeakMap,J2=new WeakMap,th=new WeakMap,L1=new WeakMap,v0=new WeakSet,KE=function(e){var s,r;if(b(this,G2))return;(r=b(this,Oc)).ctx??(r.ctx=D(s=vs,Wa,T9).call(s,b(this,qu)));const t=b(this,Ku),i=b(this,K2);for(const a of e){if(t.length>MB){_n("Ignoring additional textDivs for performance reasons."),O(this,G2,!0);return}if(a.str===void 0){if(a.type==="beginMarkedContentProps"||a.type==="beginMarkedContent"){const o=b(this,sa);O(this,sa,document.createElement("span")),b(this,sa).classList.add("markedContent"),a.id!==null&&b(this,sa).setAttribute("id",`${a.id}`),o.append(b(this,sa))}else a.type==="endMarkedContent"&&O(this,sa,b(this,sa).parentNode);continue}i.push(a.str),D(this,v0,XE).call(this,a)}},XE=function(e){var m;const t=document.createElement("span"),i={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};b(this,Ku).push(t);const s=tn.transform(b(this,Y2),e.transform);let r=Math.atan2(s[1],s[0]);const a=b(this,O1)[e.fontName];a.vertical&&(r+=Math.PI/2);let o=b(this,V2)&&a.fontSubstitution||a.fontFamily;o=vs.fontFamilyMap.get(o)||o;const l=Math.hypot(s[2],s[3]),c=l*D(m=vs,Wa,JE).call(m,o,a,b(this,qu));let h,u;r===0?(h=s[4],u=s[5]-c):(h=s[4]+c*Math.sin(r),u=s[5]-c*Math.cos(r));const d="calc(var(--total-scale-factor) *",f=t.style;b(this,sa)===b(this,P1)?(f.left=`${(100*h/b(this,W2)).toFixed(2)}%`,f.top=`${(100*u/b(this,q2)).toFixed(2)}%`):(f.left=`${d}${h.toFixed(2)}px)`,f.top=`${d}${u.toFixed(2)}px)`),f.fontSize=`${d}${(b(vs,th)*l).toFixed(2)}px)`,f.fontFamily=o,i.fontSize=l,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,b(this,V2)&&(t.dataset.fontName=a.fontSubstitutionLoadedName||e.fontName),r!==0&&(i.angle=r*(180/Math.PI));let g=!1;if(e.str.length>1)g=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const x=Math.abs(e.transform[0]),p=Math.abs(e.transform[3]);x!==p&&Math.max(x,p)/Math.min(x,p)>1.5&&(g=!0)}if(g&&(i.canvasWidth=a.vertical?e.height:e.width),b(this,X2).set(t,i),b(this,Oc).div=t,b(this,Oc).properties=i,D(this,v0,O8).call(this,b(this,Oc)),i.hasText&&b(this,sa).append(t),i.hasEOL){const x=document.createElement("br");x.setAttribute("role","presentation"),b(this,sa).append(x)}},O8=function(e){var o;const{div:t,properties:i,ctx:s}=e,{style:r}=t;let a="";if(b(vs,th)>1&&(a=`scale(${1/b(vs,th)})`),i.canvasWidth!==0&&i.hasText){const{fontFamily:l}=r,{canvasWidth:c,fontSize:h}=i;D(o=vs,Wa,D8).call(o,s,h*b(this,eh),l);const{width:u}=s.measureText(t.textContent);u>0&&(a=`scaleX(${c*b(this,eh)/u}) ${a}`)}i.angle!==0&&(a=`rotate(${i.angle}deg) ${a}`),a.length>0&&(r.transform=a)},Wa=new WeakSet,T9=function(e=null){let t=b(this,Xu).get(e||(e=""));if(!t){const i=document.createElement("canvas");i.className="hiddenCanvasElement",i.lang=e,document.body.append(i),t=i.getContext("2d",{alpha:!1,willReadFrequently:!0}),b(this,Xu).set(e,t),b(this,J2).set(t,{size:0,family:""})}return t},D8=function(e,t,i){const s=b(this,J2).get(e);t===s.size&&i===s.family||(e.font=`${t}px ${i}`,s.size=t,s.family=i)},YE=function(){if(b(this,th)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),O(this,th,e.getBoundingClientRect().height),e.remove()},JE=function(e,t,i){const s=b(this,F1).get(e);if(s)return s;const r=D(this,Wa,T9).call(this,i);r.canvas.width=r.canvas.height=Dv,D(this,Wa,D8).call(this,r,Dv,e);const a=r.measureText(""),o=a.fontBoundingBoxAscent,l=Math.abs(a.fontBoundingBoxDescent);r.canvas.width=r.canvas.height=0;let c=.8;return o?c=o/(o+l):(dr.platform.isFirefox&&_n("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?c=t.ascent:t.descent&&(c=1+t.descent)),b(this,F1).set(e,c),c},B(vs,Wa),B(vs,F1,new Map),B(vs,Xu,new Map),B(vs,J2,new WeakMap),B(vs,th,null),B(vs,L1,new Set);let Mp=vs;class Pp{static textContent(e){const t=[],i={items:t,styles:Object.create(null)};function s(r){var l;if(!r)return;let a=null;const o=r.name;if(o==="#text")a=r.value;else if(Pp.shouldBuildText(o))(l=r==null?void 0:r.attributes)!=null&&l.textContent?a=r.attributes.textContent:r.value&&(a=r.value);else return;if(a!==null&&t.push({str:a}),!!r.children)for(const c of r.children)s(c)}return s(e),i}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}const PB=100;function NB(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const e=new F8,{docId:t}=e,i=n.url?zL(n.url):null,s=n.data?jL(n.data):null,r=n.httpHeaders||null,a=n.withCredentials===!0,o=n.password??null,l=n.range instanceof ZE?n.range:null,c=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:2**16;let h=n.worker instanceof Np?n.worker:null;const u=n.verbosity,d=typeof n.docBaseUrl=="string"&&!J5(n.docBaseUrl)?n.docBaseUrl:null,f=Nx(n.cMapUrl),g=n.cMapPacked!==!1,m=n.CMapReaderFactory||(Ur?JL:kv),x=Nx(n.iccUrl),p=Nx(n.standardFontDataUrl),y=n.StandardFontDataFactory||(Ur?ZL:Cv),w=Nx(n.wasmUrl),_=n.WasmFactory||(Ur?QL:Av),v=n.stopAtErrors!==!0,C=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,k=n.isEvalSupported!==!1,I=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!Ur,S=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!Ur&&(dr.platform.isFirefox||!globalThis.chrome),M=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,N=typeof n.disableFontFace=="boolean"?n.disableFontFace:Ur,F=n.fontExtraProperties===!0,H=n.enableXfa===!0,T=n.ownerDocument||globalThis.document,z=n.disableRange===!0,R=n.disableStream===!0,L=n.disableAutoFetch===!0,Y=n.pdfBug===!0,j=n.CanvasFactory||(Ur?YL:WL),J=n.FilterFactory||(Ur?XL:KL),G=n.enableHWA===!0,se=n.useWasm!==!1,de=l?l.length:n.length??NaN,he=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!Ur&&!N,we=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:!!(m===kv&&y===Cv&&_===Av&&f&&p&&w&&zm(f,document.baseURI)&&zm(p,document.baseURI)&&zm(w,document.baseURI)),ye=null;yL(u);const P={canvasFactory:new j({ownerDocument:T,enableHWA:G}),filterFactory:new J({docId:t,ownerDocument:T}),cMapReaderFactory:we?null:new m({baseUrl:f,isCompressed:g}),standardFontDataFactory:we?null:new y({baseUrl:p}),wasmFactory:we?null:new _({baseUrl:w})};h||(h=Np.create({verbosity:u,port:Wl.workerPort}),e._worker=h);const V={docId:t,apiVersion:"5.3.93",data:s,password:o,disableAutoFetch:L,rangeChunkSize:c,length:de,docBaseUrl:d,enableXfa:H,evaluatorOptions:{maxImageSize:C,disableFontFace:N,ignoreErrors:v,isEvalSupported:k,isOffscreenCanvasSupported:I,isImageDecoderSupported:S,canvasMaxAreaInBytes:M,fontExtraProperties:F,useSystemFonts:he,useWasm:se,useWorkerFetch:we,cMapUrl:f,iccUrl:x,standardFontDataUrl:p,wasmUrl:w}},re={ownerDocument:T,pdfBug:Y,styleElement:ye,loadingParams:{disableAutoFetch:L,enableXfa:H}};return h.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const X=h.messageHandler.sendWithPromise("GetDocRequest",V,s?[s.buffer]:null);let ue;if(l)ue=new gB(l,{disableRange:z,disableStream:R});else if(!s){if(!i)throw new Error("getDocument - no `url` parameter provided.");const oe=zm(i)?xB:Ur?EB:kB;ue=new oe({url:i,length:de,httpHeaders:r,withCredentials:a,rangeChunkSize:c,disableRange:z,disableStream:R})}return X.then(oe=>{if(e.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const Q=new Wm(t,oe,h.port),ae=new FB(Q,e,ue,re,P);e._transport=ae,Q.send("Ready",null)})}).catch(e._capability.reject),e}var _5;const v5=class v5{constructor(){He(this,"_capability",Promise.withResolvers());He(this,"_transport",null);He(this,"_worker",null);He(this,"docId",`d${Mr(v5,_5)._++}`);He(this,"destroyed",!1);He(this,"onPassword",null);He(this,"onProgress",null)}get promise(){return this._capability.promise}async destroy(){var e,t,i,s;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(r){throw(i=this._worker)!=null&&i.port&&delete this._worker._pendingDestroy,r}this._transport=null,(s=this._worker)==null||s.destroy(),this._worker=null}async getData(){return this._transport.getData()}};_5=new WeakMap,B(v5,_5,0);let F8=v5;var Yu,Z2,Q2,$2,eb;class ZE{constructor(e,t,i=!1,s=null){B(this,Yu,Promise.withResolvers());B(this,Z2,[]);B(this,Q2,[]);B(this,$2,[]);B(this,eb,[]);this.length=e,this.initialData=t,this.progressiveDone=i,this.contentDispositionFilename=s}addRangeListener(e){b(this,eb).push(e)}addProgressListener(e){b(this,$2).push(e)}addProgressiveReadListener(e){b(this,Q2).push(e)}addProgressiveDoneListener(e){b(this,Z2).push(e)}onDataRange(e,t){for(const i of b(this,eb))i(e,t)}onDataProgress(e,t){b(this,Yu).promise.then(()=>{for(const i of b(this,$2))i(e,t)})}onDataProgressiveRead(e){b(this,Yu).promise.then(()=>{for(const t of b(this,Q2))t(e)})}onDataProgressiveDone(){b(this,Yu).promise.then(()=>{for(const e of b(this,Z2))e()})}transportReady(){b(this,Yu).resolve()}requestDataRange(e,t){mi("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}Yu=new WeakMap,Z2=new WeakMap,Q2=new WeakMap,$2=new WeakMap,eb=new WeakMap;class OB{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Hn(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var Dc,Ju,Zm;class DB{constructor(e,t,i,s=!1){B(this,Ju);B(this,Dc,!1);this._pageIndex=e,this._pageInfo=t,this._transport=i,this._stats=s?new wv:null,this._pdfBug=s,this.commonObjs=i.commonObjs,this.objs=new WE,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:i=0,offsetY:s=0,dontFlip:r=!1}={}){return new ox({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:i,offsetY:s,dontFlip:r})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Hn(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,viewport:t,intent:i="display",annotationMode:s=O0.ENABLE,transform:r=null,background:a=null,optionalContentConfigPromise:o=null,annotationCanvasMap:l=null,pageColors:c=null,printAnnotationStorage:h=null,isEditing:u=!1}){var _,v;(_=this._stats)==null||_.time("Overall");const d=this._transport.getRenderingIntent(i,s,h,u),{renderingIntent:f,cacheKey:g}=d;O(this,Dc,!1),o||(o=this._transport.getOptionalContentConfig(f));let m=this._intentStates.get(g);m||(m=Object.create(null),this._intentStates.set(g,m)),m.streamReaderCancelTimeout&&(clearTimeout(m.streamReaderCancelTimeout),m.streamReaderCancelTimeout=null);const x=!!(f&Fa.PRINT);m.displayReadyCapability||(m.displayReadyCapability=Promise.withResolvers(),m.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(v=this._stats)==null||v.time("Page Request"),this._pumpOperatorList(d));const p=C=>{var k;m.renderTasks.delete(y),x&&O(this,Dc,!0),D(this,Ju,Zm).call(this),C?(y.capability.reject(C),this._abortOperatorList({intentState:m,reason:C instanceof Error?C:new Error(C)})):y.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(k=globalThis.Stats)!=null&&k.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},y=new L8({callback:p,params:{canvasContext:e,viewport:t,transform:r,background:a},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:l,operatorList:m.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!x,pdfBug:this._pdfBug,pageColors:c});(m.renderTasks||(m.renderTasks=new Set)).add(y);const w=y.task;return Promise.all([m.displayReadyCapability.promise,o]).then(([C,k])=>{var I;if(this.destroyed){p();return}if((I=this._stats)==null||I.time("Rendering"),!(k.renderingIntent&f))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");y.initializeGraphics({transparency:C,optionalContentConfig:k}),y.operatorListChanged()}).catch(p),w}getOperatorList({intent:e="display",annotationMode:t=O0.ENABLE,printAnnotationStorage:i=null,isEditing:s=!1}={}){var c;function r(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(l))}const a=this._transport.getRenderingIntent(e,t,i,s,!0);let o=this._intentStates.get(a.cacheKey);o||(o=Object.create(null),this._intentStates.set(a.cacheKey,o));let l;return o.opListReadCapability||(l=Object.create(null),l.operatorListChanged=r,o.opListReadCapability=Promise.withResolvers(),(o.renderTasks||(o.renderTasks=new Set)).add(l),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(c=this._stats)==null||c.time("Page Request"),this._pumpOperatorList(a)),o.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(s){return s.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(i=>Pp.textContent(i));const t=this.streamTextContent(e);return new Promise(function(i,s){function r(){a.read().then(function({value:l,done:c}){if(c){i(o);return}o.lang??(o.lang=l.lang),Object.assign(o.styles,l.styles),o.items.push(...l.items),r()},s)}const a=t.getReader(),o={items:[],styles:Object.create(null),lang:null};r()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const i of t.renderTasks)e.push(i.completed),i.cancel();return this.objs.clear(),O(this,Dc,!1),Promise.all(e)}cleanup(e=!1){O(this,Dc,!0);const t=D(this,Ju,Zm).call(this);return e&&t&&this._stats&&(this._stats=new wv),t}_startRenderPage(e,t){var s,r;const i=this._intentStates.get(t);i&&((s=this._stats)==null||s.timeEnd("Page Request"),(r=i.displayReadyCapability)==null||r.resolve(e))}_renderPageChunk(e,t){for(let i=0,s=e.length;i<s;i++)t.operatorList.fnArray.push(e.fnArray[i]),t.operatorList.argsArray.push(e.argsArray[i]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const i of t.renderTasks)i.operatorListChanged();e.lastChunk&&D(this,Ju,Zm).call(this)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:i,modifiedIds:s}){const{map:r,transfer:a}=i,l=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:r,modifiedIds:s},a).getReader(),c=this._intentStates.get(t);c.streamReader=l;const h=()=>{l.read().then(({value:u,done:d})=>{if(d){c.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(u,c),h())},u=>{if(c.streamReader=null,!this._transport.destroyed){if(c.operatorList){c.operatorList.lastChunk=!0;for(const d of c.renderTasks)d.operatorListChanged();D(this,Ju,Zm).call(this)}if(c.displayReadyCapability)c.displayReadyCapability.reject(u);else if(c.opListReadCapability)c.opListReadCapability.reject(u);else throw u}})};h()}_abortOperatorList({intentState:e,reason:t,force:i=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!i){if(e.renderTasks.size>0)return;if(t instanceof l4){let s=PB;t.extraDelay>0&&t.extraDelay<1e3&&(s+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},s);return}}if(e.streamReader.cancel(new Bh(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[s,r]of this._intentStates)if(r===e){this._intentStates.delete(s);break}this.cleanup()}}}get stats(){return this._stats}}Dc=new WeakMap,Ju=new WeakSet,Zm=function(){if(!b(this,Dc)||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),O(this,Dc,!1),!0};var nh,Oo,Fc,Zu,k5,Qu,$u,Wr,R9,QE,$E,Qm,B1,M9;const Ti=class Ti{constructor({name:e=null,port:t=null,verbosity:i=wL()}={}){B(this,Wr);B(this,nh,Promise.withResolvers());B(this,Oo,null);B(this,Fc,null);B(this,Zu,null);if(this.name=e,this.destroyed=!1,this.verbosity=i,t){if(b(Ti,$u).has(t))throw new Error("Cannot use more than one PDFWorker per port.");b(Ti,$u).set(t,this),D(this,Wr,QE).call(this,t)}else D(this,Wr,$E).call(this)}get promise(){return b(this,nh).promise}get port(){return b(this,Fc)}get messageHandler(){return b(this,Oo)}destroy(){var e,t;this.destroyed=!0,(e=b(this,Zu))==null||e.terminate(),O(this,Zu,null),b(Ti,$u).delete(b(this,Fc)),O(this,Fc,null),(t=b(this,Oo))==null||t.destroy(),O(this,Oo,null)}static create(e){const t=b(this,$u).get(e==null?void 0:e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new Ti(e)}static get workerSrc(){if(Wl.workerSrc)return Wl.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Hn(this,"_setupFakeWorkerGlobal",(async()=>b(this,B1,M9)?b(this,B1,M9):(await import(this.workerSrc)).WorkerMessageHandler)())}};nh=new WeakMap,Oo=new WeakMap,Fc=new WeakMap,Zu=new WeakMap,k5=new WeakMap,Qu=new WeakMap,$u=new WeakMap,Wr=new WeakSet,R9=function(){b(this,nh).resolve(),b(this,Oo).send("configure",{verbosity:this.verbosity})},QE=function(e){O(this,Fc,e),O(this,Oo,new Wm("main","worker",e)),b(this,Oo).on("ready",()=>{}),D(this,Wr,R9).call(this)},$E=function(){if(b(Ti,Qu)||b(Ti,B1,M9)){D(this,Wr,Qm).call(this);return}let{workerSrc:e}=Ti;try{Ti._isSameOrigin(window.location,e)||(e=Ti._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),i=new Wm("main","worker",t),s=()=>{r.abort(),i.destroy(),t.terminate(),this.destroyed?b(this,nh).reject(new Error("Worker was destroyed")):D(this,Wr,Qm).call(this)},r=new AbortController;t.addEventListener("error",()=>{b(this,Zu)||s()},{signal:r.signal}),i.on("test",o=>{if(r.abort(),this.destroyed||!o){s();return}O(this,Oo,i),O(this,Fc,t),O(this,Zu,t),D(this,Wr,R9).call(this)}),i.on("ready",o=>{if(r.abort(),this.destroyed){s();return}try{a()}catch{D(this,Wr,Qm).call(this)}});const a=()=>{const o=new Uint8Array;i.send("test",o,[o.buffer])};a();return}catch{Y5("The worker has been disabled.")}D(this,Wr,Qm).call(this)},Qm=function(){b(Ti,Qu)||(_n("Setting up fake worker."),O(Ti,Qu,!0)),Ti._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){b(this,nh).reject(new Error("Worker was destroyed"));return}const t=new qL;O(this,Fc,t);const i=`fake${Mr(Ti,k5)._++}`,s=new Wm(i+"_worker",i,t);e.setup(s,t),O(this,Oo,new Wm(i,i+"_worker",t)),D(this,Wr,R9).call(this)}).catch(e=>{b(this,nh).reject(new Error(`Setting up fake worker failed: "${e.message}".`))})},B1=new WeakSet,M9=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},B(Ti,B1),B(Ti,k5,0),B(Ti,Qu,!1),B(Ti,$u,new WeakMap),Ur&&(O(Ti,Qu,!0),Wl.workerSrc||(Wl.workerSrc="./pdf.worker.mjs")),Ti._isSameOrigin=(e,t)=>{const i=URL.parse(e);if(!(i!=null&&i.origin)||i.origin==="null")return!1;const s=new URL(t,i);return i.origin===s.origin},Ti._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},Ti.fromPort=e=>{if(PL("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return Ti.create(e)};let Np=Ti;var Lc,Dl,U1,H1,Bc,ed,$m;class FB{constructor(e,t,i,s,r){B(this,ed);B(this,Lc,new Map);B(this,Dl,new Map);B(this,U1,new Map);B(this,H1,new Map);B(this,Bc,null);this.messageHandler=e,this.loadingTask=t,this.commonObjs=new WE,this.fontLoader=new UL({ownerDocument:s.ownerDocument,styleElement:s.styleElement}),this.loadingParams=s.loadingParams,this._params=s,this.canvasFactory=r.canvasFactory,this.filterFactory=r.filterFactory,this.cMapReaderFactory=r.cMapReaderFactory,this.standardFontDataFactory=r.standardFontDataFactory,this.wasmFactory=r.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=i,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return Hn(this,"annotationStorage",new d4)}getRenderingIntent(e,t=O0.ENABLE,i=null,s=!1,r=!1){let a=Fa.DISPLAY,o=k8;switch(e){case"any":a=Fa.ANY;break;case"display":break;case"print":a=Fa.PRINT;break;default:_n(`getRenderingIntent - invalid intent: ${e}`)}const l=a&Fa.PRINT&&i instanceof RE?i:this.annotationStorage;switch(t){case O0.DISABLE:a+=Fa.ANNOTATIONS_DISABLE;break;case O0.ENABLE:break;case O0.ENABLE_FORMS:a+=Fa.ANNOTATIONS_FORMS;break;case O0.ENABLE_STORAGE:a+=Fa.ANNOTATIONS_STORAGE,o=l.serializable;break;default:_n(`getRenderingIntent - invalid annotationMode: ${t}`)}s&&(a+=Fa.IS_EDITING),r&&(a+=Fa.OPLIST);const{ids:c,hash:h}=l.modifiedIds,u=[a,o.hash,h];return{renderingIntent:a,cacheKey:u.join("_"),annotationStorageSerializable:o,modifiedIds:c}}destroy(){var i;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(i=b(this,Bc))==null||i.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const s of b(this,Dl).values())e.push(s._destroy());b(this,Dl).clear(),b(this,U1).clear(),b(this,H1).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var s,r;this.commonObjs.clear(),this.fontLoader.clear(),b(this,Lc).clear(),this.filterFactory.destroy(),Mp.cleanup(),(s=this._networkStream)==null||s.cancelAllRequests(new Bh("Worker was terminated.")),(r=this.messageHandler)==null||r.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(i,s)=>{ps(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=r=>{this._lastProgress={loaded:r.loaded,total:r.total}},s.onPull=()=>{this._fullReader.read().then(function({value:r,done:a}){if(a){s.close();return}ps(r instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(r),1,[r])}).catch(r=>{s.error(r)})},s.onCancel=r=>{this._fullReader.cancel(r),s.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("ReaderHeadersReady",async i=>{var o;await this._fullReader.headersReady;const{isStreamingSupported:s,isRangeSupported:r,contentLength:a}=this._fullReader;return(!s||!r)&&(this._lastProgress&&((o=t.onProgress)==null||o.call(t,this._lastProgress)),this._fullReader.onProgress=l=>{var c;(c=t.onProgress)==null||c.call(t,{loaded:l.loaded,total:l.total})}),{isStreamingSupported:s,isRangeSupported:r,contentLength:a}}),e.on("GetRangeReader",(i,s)=>{ps(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const r=this._networkStream.getRangeReader(i.begin,i.end);if(!r){s.close();return}s.onPull=()=>{r.read().then(function({value:a,done:o}){if(o){s.close();return}ps(a instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{s.error(a)})},s.onCancel=a=>{r.cancel(a),s.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("GetDoc",({pdfInfo:i})=>{this._numPages=i.numPages,this._htmlForXfa=i.htmlForXfa,delete i.htmlForXfa,t._capability.resolve(new OB(i,this))}),e.on("DocException",i=>{t._capability.reject(ta(i))}),e.on("PasswordRequest",i=>{O(this,Bc,Promise.withResolvers());try{if(!t.onPassword)throw ta(i);const s=r=>{r instanceof Error?b(this,Bc).reject(r):b(this,Bc).resolve({password:r})};t.onPassword(s,i.code)}catch(s){b(this,Bc).reject(s)}return b(this,Bc).promise}),e.on("DataLoaded",i=>{var s;(s=t.onProgress)==null||s.call(t,{loaded:i.length,total:i.length}),this.downloadInfoCapability.resolve(i)}),e.on("StartRenderPage",i=>{if(this.destroyed)return;b(this,Dl).get(i.pageIndex)._startRenderPage(i.transparency,i.cacheKey)}),e.on("commonobj",([i,s,r])=>{var a;if(this.destroyed||this.commonObjs.has(i))return null;switch(s){case"Font":if("error"in r){const h=r.error;_n(`Error during font loading: ${h}`),this.commonObjs.resolve(i,h);break}const o=this._params.pdfBug&&((a=globalThis.FontInspector)!=null&&a.enabled)?(h,u)=>globalThis.FontInspector.fontAdded(h,u):null,l=new HL(r,o);this.fontLoader.bind(l).catch(()=>e.sendWithPromise("FontFallback",{id:i})).finally(()=>{!l.fontExtraProperties&&l.data&&(l.data=null),this.commonObjs.resolve(i,l)});break;case"CopyLocalImage":const{imageRef:c}=r;ps(c,"The imageRef must be defined.");for(const h of b(this,Dl).values())for(const[,u]of h.objs)if((u==null?void 0:u.ref)===c)return u.dataLen?(this.commonObjs.resolve(i,structuredClone(u)),u.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(i,r);break;default:throw new Error(`Got unknown common object type ${s}`)}return null}),e.on("obj",([i,s,r,a])=>{var l;if(this.destroyed)return;const o=b(this,Dl).get(s);if(!o.objs.has(i)){if(o._intentStates.size===0){(l=a==null?void 0:a.bitmap)==null||l.close();return}switch(r){case"Image":case"Pattern":o.objs.resolve(i,a);break;default:throw new Error(`Got unknown object type ${r}`)}}}),e.on("DocProgress",i=>{var s;this.destroyed||(s=t.onProgress)==null||s.call(t,{loaded:i.loaded,total:i.total})}),e.on("FetchBinaryData",async i=>{if(this.destroyed)throw new Error("Worker was destroyed.");const s=this[i.type];if(!s)throw new Error(`${i.type} not initialized, see the \`useWorkerFetch\` parameter.`);return s.fetch(i)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var i;this.annotationStorage.size<=0&&_n("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((i=this._fullReader)==null?void 0:i.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,i=b(this,U1).get(t);if(i)return i;const s=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(r=>{if(this.destroyed)throw new Error("Transport destroyed");r.refStr&&b(this,H1).set(r.refStr,e);const a=new DB(t,r,this,this._params.pdfBug);return b(this,Dl).set(t,a),a});return b(this,U1).set(t,s),s}getPageIndex(e){return C8(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return D(this,ed,$m).call(this,"GetFieldObjects")}hasJSActions(){return D(this,ed,$m).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return D(this,ed,$m).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return D(this,ed,$m).call(this,"GetOptionalContentConfig").then(t=>new fB(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=b(this,Lc).get(e);if(t)return t;const i=this.messageHandler.sendWithPromise(e,null).then(s=>{var r,a;return{info:s[0],metadata:s[1]?new uB(s[1]):null,contentDispositionFilename:((r=this._fullReader)==null?void 0:r.filename)??null,contentLength:((a=this._fullReader)==null?void 0:a.contentLength)??null}});return b(this,Lc).set(e,i),i}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of b(this,Dl).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),b(this,Lc).clear(),this.filterFactory.destroy(!0),Mp.cleanup()}}cachedPageNumber(e){if(!C8(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return b(this,H1).get(t)??null}}Lc=new WeakMap,Dl=new WeakMap,U1=new WeakMap,H1=new WeakMap,Bc=new WeakMap,ed=new WeakSet,$m=function(e,t=null){const i=b(this,Lc).get(e);if(i)return i;const s=this.messageHandler.sendWithPromise(e,t);return b(this,Lc).set(e,s),s};var ih;class LB{constructor(e){B(this,ih,null);He(this,"onContinue",null);He(this,"onError",null);O(this,ih,e)}get promise(){return b(this,ih).capability.promise}cancel(e=0){b(this,ih).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=b(this,ih).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=b(this,ih);return e.form||e.canvas&&(t==null?void 0:t.size)>0}}ih=new WeakMap;var sh,td;const pu=class pu{constructor({callback:e,params:t,objs:i,commonObjs:s,annotationCanvasMap:r,operatorList:a,pageIndex:o,canvasFactory:l,filterFactory:c,useRequestAnimationFrame:h=!1,pdfBug:u=!1,pageColors:d=null}){B(this,sh,null);this.callback=e,this.params=t,this.objs=i,this.commonObjs=s,this.annotationCanvasMap=r,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=o,this.canvasFactory=l,this.filterFactory=c,this._pdfBug=u,this.pageColors=d,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=h===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new LB(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var o,l;if(this.cancelled)return;if(this._canvas){if(b(pu,td).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");b(pu,td).add(this._canvas)}this._pdfBug&&((o=globalThis.StepperManager)!=null&&o.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:i,viewport:s,transform:r,background:a}=this.params;this.gfx=new $f(i,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:r,viewport:s,transparency:e,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,(l=this.graphicsReadyCallback)==null||l.call(this)}cancel(e=null,t=0){var i,s,r;this.running=!1,this.cancelled=!0,(i=this.gfx)==null||i.endDrawing(),b(this,sh)&&(window.cancelAnimationFrame(b(this,sh)),O(this,sh,null)),b(pu,td).delete(this._canvas),e||(e=new l4(`Rendering cancelled, page ${this._pageIndex+1}`,t)),this.callback(e),(r=(s=this.task).onError)==null||r.call(s,e)}operatorListChanged(){var e;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.stepper)==null||e.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?O(this,sh,window.requestAnimationFrame(()=>{O(this,sh,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),b(pu,td).delete(this._canvas),this.callback())))}};sh=new WeakMap,td=new WeakMap,B(pu,td,new WeakSet);let L8=pu;const BB="5.3.93",UB="cbeef3233";function Fv(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function km(n){return Math.max(0,Math.min(255,255*n))}class Lv{static CMYK_G([e,t,i,s]){return["G",1-Math.min(1,.3*e+.59*i+.11*t+s)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=km(e),[e,e,e]}static G_HTML([e]){const t=Fv(e);return`#${t}${t}${t}`}static RGB_G([e,t,i]){return["G",.3*e+.59*t+.11*i]}static RGB_rgb(e){return e.map(km)}static RGB_HTML(e){return`#${e.map(Fv).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,i,s]){return["RGB",1-Math.min(1,e+s),1-Math.min(1,i+s),1-Math.min(1,t+s)]}static CMYK_rgb([e,t,i,s]){return[km(1-Math.min(1,e+s)),km(1-Math.min(1,i+s)),km(1-Math.min(1,t+s))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,i]){const s=1-e,r=1-t,a=1-i,o=Math.min(s,r,a);return["CMYK",s,r,a,o]}}class HB{create(e,t,i=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const s=this._createSVG("svg:svg");return s.setAttribute("version","1.1"),i||(s.setAttribute("width",`${e}px`),s.setAttribute("height",`${t}px`)),s.setAttribute("preserveAspectRatio","none"),s.setAttribute("viewBox",`0 0 ${e} ${t}`),s}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){mi("Abstract method `_createSVG` called.")}}class w3 extends HB{_createSVG(e){return document.createElementNS(uc,e)}}class eT{static setupStorage(e,t,i,s,r){const a=s.getValue(t,{value:null});switch(i.name){case"textarea":if(a.value!==null&&(e.textContent=a.value),r==="print")break;e.addEventListener("input",o=>{s.setValue(t,{value:o.target.value})});break;case"input":if(i.attributes.type==="radio"||i.attributes.type==="checkbox"){if(a.value===i.attributes.xfaOn?e.setAttribute("checked",!0):a.value===i.attributes.xfaOff&&e.removeAttribute("checked"),r==="print")break;e.addEventListener("change",o=>{s.setValue(t,{value:o.target.checked?o.target.getAttribute("xfaOn"):o.target.getAttribute("xfaOff")})})}else{if(a.value!==null&&e.setAttribute("value",a.value),r==="print")break;e.addEventListener("input",o=>{s.setValue(t,{value:o.target.value})})}break;case"select":if(a.value!==null){e.setAttribute("value",a.value);for(const o of i.children)o.attributes.value===a.value?o.attributes.selected=!0:o.attributes.hasOwnProperty("selected")&&delete o.attributes.selected}e.addEventListener("input",o=>{const l=o.target.options,c=l.selectedIndex===-1?"":l[l.selectedIndex].value;s.setValue(t,{value:c})});break}}static setAttributes({html:e,element:t,storage:i=null,intent:s,linkService:r}){const{attributes:a}=t,o=e instanceof HTMLAnchorElement;a.type==="radio"&&(a.name=`${a.name}-${s}`);for(const[l,c]of Object.entries(a))if(c!=null)switch(l){case"class":c.length&&e.setAttribute(l,c.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",c);break;case"style":Object.assign(e.style,c);break;case"textContent":e.textContent=c;break;default:(!o||l!=="href"&&l!=="newWindow")&&e.setAttribute(l,c)}o&&r.addLinkAttributes(e,a.href,a.newWindow),i&&a.dataId&&this.setupStorage(e,a.dataId,t,i)}static render(e){var u,d;const t=e.annotationStorage,i=e.linkService,s=e.xfaHtml,r=e.intent||"display",a=document.createElement(s.name);s.attributes&&this.setAttributes({html:a,element:s,intent:r,linkService:i});const o=r!=="richText",l=e.div;if(l.append(a),e.viewport){const f=`matrix(${e.viewport.transform.join(",")})`;l.style.transform=f}o&&l.setAttribute("class","xfaLayer xfaFont");const c=[];if(s.children.length===0){if(s.value){const f=document.createTextNode(s.value);a.append(f),o&&Pp.shouldBuildText(s.name)&&c.push(f)}return{textDivs:c}}const h=[[s,-1,a]];for(;h.length>0;){const[f,g,m]=h.at(-1);if(g+1===f.children.length){h.pop();continue}const x=f.children[++h.at(-1)[1]];if(x===null)continue;const{name:p}=x;if(p==="#text"){const w=document.createTextNode(x.value);c.push(w),m.append(w);continue}const y=(u=x==null?void 0:x.attributes)!=null&&u.xmlns?document.createElementNS(x.attributes.xmlns,p):document.createElement(p);if(m.append(y),x.attributes&&this.setAttributes({html:y,element:x,storage:t,intent:r,linkService:i}),((d=x.children)==null?void 0:d.length)>0)h.push([x,-1,y]);else if(x.value){const w=document.createTextNode(x.value);o&&Pp.shouldBuildText(p)&&c.push(w),y.append(w)}}for(const f of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))f.setAttribute("readOnly",!0);return{textDivs:c}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const zB=9,Wd=new WeakSet;class Bv{static create(e){switch(e.data.annotationType){case fs.LINK:return new tT(e);case fs.TEXT:return new jB(e);case fs.WIDGET:switch(e.data.fieldType){case"Tx":return new GB(e);case"Btn":return e.data.radioButton?new sT(e):e.data.checkBox?new qB(e):new WB(e);case"Ch":return new KB(e);case"Sig":return new VB(e)}return new of(e);case fs.POPUP:return new U8(e);case fs.FREETEXT:return new cT(e);case fs.LINE:return new YB(e);case fs.SQUARE:return new JB(e);case fs.CIRCLE:return new ZB(e);case fs.POLYLINE:return new hT(e);case fs.CARET:return new $B(e);case fs.INK:return new m4(e);case fs.POLYGON:return new QB(e);case fs.HIGHLIGHT:return new uT(e);case fs.UNDERLINE:return new eU(e);case fs.SQUIGGLY:return new tU(e);case fs.STRIKEOUT:return new nU(e);case fs.STAMP:return new dT(e);case fs.FILEATTACHMENT:return new iU(e);default:return new os(e)}}}var nd,z1,j1,tb,B8;const K_=class K_{constructor(e,{isRenderable:t=!1,ignoreBorder:i=!1,createQuadrilaterals:s=!1}={}){B(this,tb);B(this,nd,null);B(this,z1,!1);B(this,j1,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(i)),s&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:e,richText:t}){return!!(e!=null&&e.str||t!=null&&t.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return K_._hasPopupData(this.data)}updateEdited(e){var i;if(!this.container)return;b(this,nd)||O(this,nd,{rect:this.data.rect.slice(0)});const{rect:t}=e;t&&D(this,tb,B8).call(this,t),(i=b(this,j1))==null||i.popup.updateEdited(e)}resetEdited(){var e;b(this,nd)&&(D(this,tb,B8).call(this,b(this,nd).rect),(e=b(this,j1))==null||e.popup.resetEdited(),O(this,nd,null))}_createContainer(e){const{data:t,parent:{page:i,viewport:s}}=this,r=document.createElement("section");r.setAttribute("data-annotation-id",t.id),this instanceof of||(r.tabIndex=0);const{style:a}=r;if(a.zIndex=this.parent.zIndex++,t.alternativeText&&(r.title=t.alternativeText),t.noRotate&&r.classList.add("norotate"),!t.rect||this instanceof U8){const{rotation:m}=t;return!t.hasOwnCanvas&&m!==0&&this.setRotation(m,r),r}const{width:o,height:l}=this;if(!e&&t.borderStyle.width>0){a.borderWidth=`${t.borderStyle.width}px`;const m=t.borderStyle.horizontalCornerRadius,x=t.borderStyle.verticalCornerRadius;if(m>0||x>0){const y=`calc(${m}px * var(--total-scale-factor)) / calc(${x}px * var(--total-scale-factor))`;a.borderRadius=y}else if(this instanceof sT){const y=`calc(${o}px * var(--total-scale-factor)) / calc(${l}px * var(--total-scale-factor))`;a.borderRadius=y}switch(t.borderStyle.style){case yf.SOLID:a.borderStyle="solid";break;case yf.DASHED:a.borderStyle="dashed";break;case yf.BEVELED:_n("Unimplemented border style: beveled");break;case yf.INSET:_n("Unimplemented border style: inset");break;case yf.UNDERLINE:a.borderBottomStyle="solid";break}const p=t.borderColor||null;p?(O(this,z1,!0),a.borderColor=tn.makeHexColor(p[0]|0,p[1]|0,p[2]|0)):a.borderWidth=0}const c=tn.normalizeRect([t.rect[0],i.view[3]-t.rect[1]+i.view[1],t.rect[2],i.view[3]-t.rect[3]+i.view[1]]),{pageWidth:h,pageHeight:u,pageX:d,pageY:f}=s.rawDims;a.left=`${100*(c[0]-d)/h}%`,a.top=`${100*(c[1]-f)/u}%`;const{rotation:g}=t;return t.hasOwnCanvas||g===0?(a.width=`${100*o/h}%`,a.height=`${100*l/u}%`):this.setRotation(g,r),r}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:i,pageHeight:s}=this.parent.viewport.rawDims;let{width:r,height:a}=this;e%180!==0&&([r,a]=[a,r]),t.style.width=`${100*r/i}%`,t.style.height=`${100*a/s}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,i,s)=>{const r=s.detail[t],a=r[0],o=r.slice(1);s.target.style[i]=Lv[`${a}_HTML`](o),this.annotationStorage.setValue(this.data.id,{[i]:Lv[`${a}_rgb`](o)})};return Hn(this,"_commonActions",{display:t=>{const{display:i}=t.detail,s=i%2===1;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:s,noPrint:i===1||i===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:i}=t.detail;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:i,noView:i})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const i=t.detail.rotation;this.setRotation(i),this.annotationStorage.setValue(this.data.id,{rotation:i})}})}_dispatchEventFromSandbox(e,t){const i=this._commonActions;for(const s of Object.keys(t.detail)){const r=e[s]||i[s];r==null||r(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const i=this._commonActions;for(const[s,r]of Object.entries(t)){const a=i[s];if(a){const o={detail:{[s]:r},target:e};a(o),delete t[s]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,i,s,r]=this.data.rect.map(m=>Math.fround(m));if(e.length===8){const[m,x,p,y]=e.subarray(2,6);if(s===m&&r===x&&t===p&&i===y)return}const{style:a}=this.container;let o;if(b(this,z1)){const{borderColor:m,borderWidth:x}=a;a.borderWidth=0,o=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${m}" stroke-width="${x}">`],this.container.classList.add("hasBorder")}const l=s-t,c=r-i,{svgFactory:h}=this,u=h.createElement("svg");u.classList.add("quadrilateralsContainer"),u.setAttribute("width",0),u.setAttribute("height",0),u.role="none";const d=h.createElement("defs");u.append(d);const f=h.createElement("clipPath"),g=`clippath_${this.data.id}`;f.setAttribute("id",g),f.setAttribute("clipPathUnits","objectBoundingBox"),d.append(f);for(let m=2,x=e.length;m<x;m+=8){const p=e[m],y=e[m+1],w=e[m+2],_=e[m+3],v=h.createElement("rect"),C=(w-t)/l,k=(r-y)/c,I=(p-w)/l,S=(y-_)/c;v.setAttribute("x",C),v.setAttribute("y",k),v.setAttribute("width",I),v.setAttribute("height",S),f.append(v),o==null||o.push(`<rect vector-effect="non-scaling-stroke" x="${C}" y="${k}" width="${I}" height="${S}"/>`)}b(this,z1)&&(o.push("</g></svg>')"),a.backgroundImage=o.join("")),this.container.append(u),this.container.style.clipPath=`url(#${g})`}_createPopup(){const{data:e}=this,t=O(this,j1,new U8({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation,noRotate:!0},parent:this.parent,elements:[this]}));this.parent.div.append(t.render())}render(){mi("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const i=[];if(this._fieldObjects){const s=this._fieldObjects[e];if(s)for(const{page:r,id:a,exportValues:o}of s){if(r===-1||a===t)continue;const l=typeof o=="string"?o:null,c=document.querySelector(`[data-element-id="${a}"]`);if(c&&!Wd.has(c)){_n(`_getElementsByName - element not allowed: ${a}`);continue}i.push({id:a,exportValue:l,domElement:c})}return i}for(const s of document.getElementsByName(e)){const{exportValue:r}=s,a=s.getAttribute("data-element-id");a!==t&&Wd.has(s)&&i.push({id:a,exportValue:r,domElement:s})}return i}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var i;(i=this.linkService.eventBus)==null||i.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}};nd=new WeakMap,z1=new WeakMap,j1=new WeakMap,tb=new WeakSet,B8=function(e){const{container:{style:t},data:{rect:i,rotation:s},parent:{viewport:{rawDims:{pageWidth:r,pageHeight:a,pageX:o,pageY:l}}}}=this;i==null||i.splice(0,4,...e),t.left=`${100*(e[0]-o)/r}%`,t.top=`${100*(a-e[3]+l)/a}%`,s===0?(t.width=`${100*(e[2]-e[0])/r}%`,t.height=`${100*(e[3]-e[1])/a}%`):this.setRotation(s)};let os=K_;var ja,su,nT,iT;class tT extends os{constructor(t,i=null){super(t,{isRenderable:!0,ignoreBorder:!!(i!=null&&i.ignoreBorder),createQuadrilaterals:!0});B(this,ja);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:i}=this,s=document.createElement("a");s.setAttribute("data-element-id",t.id);let r=!1;return t.url?(i.addLinkAttributes(s,t.url,t.newWindow),r=!0):t.action?(this._bindNamedAction(s,t.action),r=!0):t.attachment?(D(this,ja,nT).call(this,s,t.attachment,t.attachmentDest),r=!0):t.setOCGState?(D(this,ja,iT).call(this,s,t.setOCGState),r=!0):t.dest?(this._bindLink(s,t.dest),r=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(s,t),r=!0),t.resetForm?(this._bindResetFormAction(s,t.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(s,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&this.container.append(s),this.container}_bindLink(t,i){t.href=this.linkService.getDestinationHash(i),t.onclick=()=>(i&&this.linkService.goToDestination(i),!1),(i||i==="")&&D(this,ja,su).call(this)}_bindNamedAction(t,i){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(i),!1),D(this,ja,su).call(this)}_bindJSAction(t,i){t.href=this.linkService.getAnchorUrl("");const s=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(i.actions)){const a=s.get(r);a&&(t[a]=()=>{var o;return(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i.id,name:r}}),!1})}t.onclick||(t.onclick=()=>!1),D(this,ja,su).call(this)}_bindResetFormAction(t,i){const s=t.onclick;if(s||(t.href=this.linkService.getAnchorUrl("")),D(this,ja,su).call(this),!this._fieldObjects){_n('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),s||(t.onclick=()=>!1);return}t.onclick=()=>{var u;s==null||s();const{fields:r,refs:a,include:o}=i,l=[];if(r.length!==0||a.length!==0){const d=new Set(a);for(const f of r){const g=this._fieldObjects[f]||[];for(const{id:m}of g)d.add(m)}for(const f of Object.values(this._fieldObjects))for(const g of f)d.has(g.id)===o&&l.push(g)}else for(const d of Object.values(this._fieldObjects))l.push(...d);const c=this.annotationStorage,h=[];for(const d of l){const{id:f}=d;switch(h.push(f),d.type){case"text":{const m=d.defaultValue||"";c.setValue(f,{value:m});break}case"checkbox":case"radiobutton":{const m=d.defaultValue===d.exportValues;c.setValue(f,{value:m});break}case"combobox":case"listbox":{const m=d.defaultValue||"";c.setValue(f,{value:m});break}default:continue}const g=document.querySelector(`[data-element-id="${f}"]`);if(g){if(!Wd.has(g)){_n(`_bindResetFormAction - element not allowed: ${f}`);continue}}else continue;g.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((u=this.linkService.eventBus)==null||u.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:h,name:"ResetForm"}})),!1}}}ja=new WeakSet,su=function(){this.container.setAttribute("data-internal-link","")},nT=function(t,i,s=null){t.href=this.linkService.getAnchorUrl(""),i.description&&(t.title=i.description),t.onclick=()=>{var r;return(r=this.downloadManager)==null||r.openOrDownloadData(i.content,i.filename,s),!1},D(this,ja,su).call(this)},iT=function(t,i){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(i),!1),D(this,ja,su).call(this)};class jB extends os{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class of extends os{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return dr.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,i,s,r){i.includes("mouse")?e.addEventListener(i,a=>{var o;(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:r(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):e.addEventListener(i,a=>{var o;if(i==="blur"){if(!t.focused||!a.relatedTarget)return;t.focused=!1}else if(i==="focus"){if(t.focused)return;t.focused=!0}r&&((o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:r(a)}}))})}_setEventListeners(e,t,i,s){var r,a,o;for(const[l,c]of i)(c==="Action"||(r=this.data.actions)!=null&&r[c])&&((c==="Focus"||c==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,l,c,s),c==="Focus"&&!((a=this.data.actions)!=null&&a.Blur)?this._setEventListener(e,t,"blur","Blur",null):c==="Blur"&&!((o=this.data.actions)!=null&&o.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":tn.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:i}=this.data.defaultAppearanceData,s=this.data.defaultAppearanceData.fontSize||zB,r=e.style;let a;const o=2,l=c=>Math.round(10*c)/10;if(this.data.multiLine){const c=Math.abs(this.data.rect[3]-this.data.rect[1]-o),h=Math.round(c/(rw*s))||1,u=c/h;a=Math.min(s,l(u/rw))}else{const c=Math.abs(this.data.rect[3]-this.data.rect[1]-o);a=Math.min(s,l(c/rw))}r.fontSize=`calc(${a}px * var(--total-scale-factor))`,r.color=tn.makeHexColor(i[0],i[1],i[2]),this.data.textAlignment!==null&&(r.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class GB extends of{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,i,s){const r=this.annotationStorage;for(const a of this._getElementsByName(e.name,e.id))a.domElement&&(a.domElement[t]=i),r.setValue(a.id,{[s]:i})}render(){var s,r;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let i=null;if(this.renderForms){const a=e.getValue(t,{value:this.data.fieldValue});let o=a.value||"";const l=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;l&&o.length>l&&(o=o.slice(0,l));let c=a.formattedValue||((s=this.data.textContent)==null?void 0:s.join(`
`))||null;c&&this.data.comb&&(c=c.replaceAll(/\s+/g,""));const h={userValue:o,formattedValue:c,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=c??o,this.data.doNotScroll&&(i.style.overflowY="hidden")):(i=document.createElement("input"),i.type=this.data.password?"password":"text",i.setAttribute("value",c??o),this.data.doNotScroll&&(i.style.overflowX="hidden")),this.data.hasOwnCanvas&&(i.hidden=!0),Wd.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.tabIndex=0;const u=this.data.dateFormat||this.data.timeFormat;u&&(i.title=u),this._setRequired(i,this.data.required),l&&(i.maxLength=l),i.addEventListener("input",f=>{e.setValue(t,{value:f.target.value}),this.setPropertyOnSiblings(i,"value",f.target.value,"value"),h.formattedValue=null}),i.addEventListener("resetform",f=>{const g=this.data.defaultFieldValue??"";i.value=h.userValue=g,h.formattedValue=null});let d=f=>{const{formattedValue:g}=h;g!=null&&(f.target.value=g),f.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",g=>{var x;if(h.focused)return;const{target:m}=g;h.userValue&&(m.value=h.userValue),h.lastCommittedValue=m.value,h.commitKey=1,(x=this.data.actions)!=null&&x.Focus||(h.focused=!0)}),i.addEventListener("updatefromsandbox",g=>{this.showElementAndHideCanvas(g.target);const m={value(x){h.userValue=x.detail.value??"",e.setValue(t,{value:h.userValue.toString()}),x.target.value=h.userValue},formattedValue(x){const{formattedValue:p}=x.detail;h.formattedValue=p,p!=null&&x.target!==document.activeElement&&(x.target.value=p),e.setValue(t,{formattedValue:p})},selRange(x){x.target.setSelectionRange(...x.detail.selRange)},charLimit:x=>{var _;const{charLimit:p}=x.detail,{target:y}=x;if(p===0){y.removeAttribute("maxLength");return}y.setAttribute("maxLength",p);let w=h.userValue;!w||w.length<=p||(w=w.slice(0,p),y.value=h.userValue=w,e.setValue(t,{value:w}),(_=this.linkService.eventBus)==null||_.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:w,willCommit:!0,commitKey:1,selStart:y.selectionStart,selEnd:y.selectionEnd}}))}};this._dispatchEventFromSandbox(m,g)}),i.addEventListener("keydown",g=>{var p;h.commitKey=1;let m=-1;if(g.key==="Escape"?m=0:g.key==="Enter"&&!this.data.multiLine?m=2:g.key==="Tab"&&(h.commitKey=3),m===-1)return;const{value:x}=g.target;h.lastCommittedValue!==x&&(h.lastCommittedValue=x,h.userValue=x,(p=this.linkService.eventBus)==null||p.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:x,willCommit:!0,commitKey:m,selStart:g.target.selectionStart,selEnd:g.target.selectionEnd}}))});const f=d;d=null,i.addEventListener("blur",g=>{var x,p;if(!h.focused||!g.relatedTarget)return;(x=this.data.actions)!=null&&x.Blur||(h.focused=!1);const{value:m}=g.target;h.userValue=m,h.lastCommittedValue!==m&&((p=this.linkService.eventBus)==null||p.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:m,willCommit:!0,commitKey:h.commitKey,selStart:g.target.selectionStart,selEnd:g.target.selectionEnd}})),f(g)}),(r=this.data.actions)!=null&&r.Keystroke&&i.addEventListener("beforeinput",g=>{var C;h.lastCommittedValue=null;const{data:m,target:x}=g,{value:p,selectionStart:y,selectionEnd:w}=x;let _=y,v=w;switch(g.inputType){case"deleteWordBackward":{const k=p.substring(0,y).match(/\w*[^\w]*$/);k&&(_-=k[0].length);break}case"deleteWordForward":{const k=p.substring(y).match(/^[^\w]*\w*/);k&&(v+=k[0].length);break}case"deleteContentBackward":y===w&&(_-=1);break;case"deleteContentForward":y===w&&(v+=1);break}g.preventDefault(),(C=this.linkService.eventBus)==null||C.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:p,change:m||"",willCommit:!1,selStart:_,selEnd:v}})}),this._setEventListeners(i,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],g=>g.target.value)}if(d&&i.addEventListener("blur",d),this.data.comb){const g=(this.data.rect[2]-this.data.rect[0])/l;i.classList.add("comb"),i.style.letterSpacing=`calc(${g}px * var(--total-scale-factor) - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell",this.data.hasOwnCanvas&&(i.hidden=!0);return this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class VB extends of{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class qB extends of{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,i=t.id;let s=e.getValue(i,{value:t.exportValue===t.fieldValue}).value;typeof s=="string"&&(s=s!=="Off",e.setValue(i,{value:s})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const r=document.createElement("input");return Wd.add(r),r.setAttribute("data-element-id",i),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="checkbox",r.name=t.fieldName,s&&r.setAttribute("checked",!0),r.setAttribute("exportValue",t.exportValue),r.tabIndex=0,r.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const c of this._getElementsByName(o,i)){const h=l&&c.exportValue===t.exportValue;c.domElement&&(c.domElement.checked=h),e.setValue(c.id,{value:h})}e.setValue(i,{value:l})}),r.addEventListener("resetform",a=>{const o=t.defaultFieldValue||"Off";a.target.checked=o===t.exportValue}),this.enableScripting&&this.hasJSActions&&(r.addEventListener("updatefromsandbox",a=>{const o={value(l){l.target.checked=l.detail.value!=="Off",e.setValue(i,{value:l.target.checked})}};this._dispatchEventFromSandbox(o,a)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class sT extends of{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,i=t.id;let s=e.getValue(i,{value:t.fieldValue===t.buttonValue}).value;if(typeof s=="string"&&(s=s!==t.buttonValue,e.setValue(i,{value:s})),s)for(const a of this._getElementsByName(t.fieldName,i))e.setValue(a.id,{value:!1});const r=document.createElement("input");if(Wd.add(r),r.setAttribute("data-element-id",i),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="radio",r.name=t.fieldName,s&&r.setAttribute("checked",!0),r.tabIndex=0,r.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const c of this._getElementsByName(o,i))e.setValue(c.id,{value:!1});e.setValue(i,{value:l})}),r.addEventListener("resetform",a=>{const o=t.defaultFieldValue;a.target.checked=o!=null&&o===t.buttonValue}),this.enableScripting&&this.hasJSActions){const a=t.buttonValue;r.addEventListener("updatefromsandbox",o=>{const l={value:c=>{const h=a===c.detail.value;for(const u of this._getElementsByName(c.target.name)){const d=h&&u.id===i;u.domElement&&(u.domElement.checked=d),e.setValue(u.id,{value:d})}}};this._dispatchEventFromSandbox(l,o)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)}return this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class WB extends tT{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",i=>{this._dispatchEventFromSandbox({},i)})),e}}class KB extends of{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,i=e.getValue(t,{value:this.data.fieldValue}),s=document.createElement("select");Wd.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,this._setRequired(s,this.data.required),s.name=this.data.fieldName,s.tabIndex=0;let r=this.data.combo&&this.data.options.length>0;this.data.combo||(s.size=this.data.options.length,this.data.multiSelect&&(s.multiple=!0)),s.addEventListener("resetform",h=>{const u=this.data.defaultFieldValue;for(const d of s.options)d.selected=d.value===u});for(const h of this.data.options){const u=document.createElement("option");u.textContent=h.displayValue,u.value=h.exportValue,i.value.includes(h.exportValue)&&(u.setAttribute("selected",!0),r=!1),s.append(u)}let a=null;if(r){const h=document.createElement("option");h.value=" ",h.setAttribute("hidden",!0),h.setAttribute("selected",!0),s.prepend(h),a=()=>{h.remove(),s.removeEventListener("input",a),a=null},s.addEventListener("input",a)}const o=h=>{const u=h?"value":"textContent",{options:d,multiple:f}=s;return f?Array.prototype.filter.call(d,g=>g.selected).map(g=>g[u]):d.selectedIndex===-1?null:d[d.selectedIndex][u]};let l=o(!1);const c=h=>{const u=h.target.options;return Array.prototype.map.call(u,d=>({displayValue:d.textContent,exportValue:d.value}))};return this.enableScripting&&this.hasJSActions?(s.addEventListener("updatefromsandbox",h=>{const u={value(d){a==null||a();const f=d.detail.value,g=new Set(Array.isArray(f)?f:[f]);for(const m of s.options)m.selected=g.has(m.value);e.setValue(t,{value:o(!0)}),l=o(!1)},multipleSelection(d){s.multiple=!0},remove(d){const f=s.options,g=d.detail.remove;f[g].selected=!1,s.remove(g),f.length>0&&Array.prototype.findIndex.call(f,x=>x.selected)===-1&&(f[0].selected=!0),e.setValue(t,{value:o(!0),items:c(d)}),l=o(!1)},clear(d){for(;s.length!==0;)s.remove(0);e.setValue(t,{value:null,items:[]}),l=o(!1)},insert(d){const{index:f,displayValue:g,exportValue:m}=d.detail.insert,x=s.children[f],p=document.createElement("option");p.textContent=g,p.value=m,x?x.before(p):s.append(p),e.setValue(t,{value:o(!0),items:c(d)}),l=o(!1)},items(d){const{items:f}=d.detail;for(;s.length!==0;)s.remove(0);for(const g of f){const{displayValue:m,exportValue:x}=g,p=document.createElement("option");p.textContent=m,p.value=x,s.append(p)}s.options.length>0&&(s.options[0].selected=!0),e.setValue(t,{value:o(!0),items:c(d)}),l=o(!1)},indices(d){const f=new Set(d.detail.indices);for(const g of d.target.options)g.selected=f.has(g.index);e.setValue(t,{value:o(!0)}),l=o(!1)},editable(d){d.target.disabled=!d.detail.editable}};this._dispatchEventFromSandbox(u,h)}),s.addEventListener("input",h=>{var f;const u=o(!0),d=o(!1);e.setValue(t,{value:u}),h.preventDefault(),(f=this.linkService.eventBus)==null||f.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:l,change:d,changeEx:u,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(s,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],h=>h.target.value)):s.addEventListener("input",function(h){e.setValue(t,{value:o(!0)})}),this.data.combo&&this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class U8 extends os{constructor(e){const{data:t,elements:i}=e;super(e,{isRenderable:os._hasPopupData(t)}),this.elements=i,this.popup=null}render(){const{container:e}=this;e.classList.add("popupAnnotation"),e.role="comment";const t=this.popup=new XB({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),i=[];for(const s of this.elements)s.popup=t,s.container.ariaHasPopup="dialog",i.push(s.data.id),s.addHighlightArea();return this.container.setAttribute("aria-controls",i.map(s=>`${o4}${s}`).join(",")),this.container}}var G1,C5,A5,V1,q1,Ki,Uc,id,nb,ib,W1,Hc,Do,zc,sb,jc,rb,sd,rd,pi,P9,H8,rT,aT,oT,lT,N9,O9,z8;class XB{constructor({container:e,color:t,elements:i,titleObj:s,modificationDate:r,contentsObj:a,richText:o,parent:l,rect:c,parentRect:h,open:u}){B(this,pi);B(this,G1,D(this,pi,oT).bind(this));B(this,C5,D(this,pi,z8).bind(this));B(this,A5,D(this,pi,O9).bind(this));B(this,V1,D(this,pi,N9).bind(this));B(this,q1,null);B(this,Ki,null);B(this,Uc,null);B(this,id,null);B(this,nb,null);B(this,ib,null);B(this,W1,null);B(this,Hc,!1);B(this,Do,null);B(this,zc,null);B(this,sb,null);B(this,jc,null);B(this,rb,null);B(this,sd,null);B(this,rd,!1);var d;O(this,Ki,e),O(this,rb,s),O(this,Uc,a),O(this,jc,o),O(this,ib,l),O(this,q1,t),O(this,sb,c),O(this,W1,h),O(this,nb,i),O(this,id,h4.toDateObject(r)),this.trigger=i.flatMap(f=>f.getElementsToTriggerPopup());for(const f of this.trigger)f.addEventListener("click",b(this,V1)),f.addEventListener("mouseenter",b(this,A5)),f.addEventListener("mouseleave",b(this,C5)),f.classList.add("popupTriggerArea");for(const f of i)(d=f.container)==null||d.addEventListener("keydown",b(this,G1));b(this,Ki).hidden=!0,u&&D(this,pi,N9).call(this)}render(){if(b(this,Do))return;const e=O(this,Do,document.createElement("div"));if(e.className="popup",b(this,q1)){const r=e.style.outlineColor=tn.makeHexColor(...b(this,q1));e.style.backgroundColor=`color-mix(in srgb, ${r} 30%, white)`}const t=document.createElement("span");t.className="header";const i=document.createElement("h1");if(t.append(i),{dir:i.dir,str:i.textContent}=b(this,rb),e.append(t),b(this,id)){const r=document.createElement("time");r.classList.add("popupDate"),r.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),r.setAttribute("data-l10n-args",JSON.stringify({dateObj:b(this,id).valueOf()})),r.dateTime=b(this,id).toISOString(),t.append(r)}const s=b(this,pi,P9);if(s)eT.render({xfaHtml:s,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const r=this._formatContents(b(this,Uc));e.append(r)}b(this,Ki).append(e)}_formatContents({str:e,dir:t}){const i=document.createElement("p");i.classList.add("popupContent"),i.dir=t;const s=e.split(/(?:\r\n?|\n)/);for(let r=0,a=s.length;r<a;++r){const o=s[r];i.append(document.createTextNode(o)),r<a-1&&i.append(document.createElement("br"))}return i}updateEdited({rect:e,popupContent:t}){var i;b(this,sd)||O(this,sd,{contentsObj:b(this,Uc),richText:b(this,jc)}),e&&O(this,zc,null),t&&(O(this,jc,D(this,pi,aT).call(this,t)),O(this,Uc,null)),(i=b(this,Do))==null||i.remove(),O(this,Do,null)}resetEdited(){var e;b(this,sd)&&({contentsObj:Mr(this,Uc)._,richText:Mr(this,jc)._}=b(this,sd),O(this,sd,null),(e=b(this,Do))==null||e.remove(),O(this,Do,null),O(this,zc,null))}forceHide(){O(this,rd,this.isVisible),b(this,rd)&&(b(this,Ki).hidden=!0)}maybeShow(){b(this,rd)&&(b(this,Do)||D(this,pi,O9).call(this),O(this,rd,!1),b(this,Ki).hidden=!1)}get isVisible(){return b(this,Ki).hidden===!1}}G1=new WeakMap,C5=new WeakMap,A5=new WeakMap,V1=new WeakMap,q1=new WeakMap,Ki=new WeakMap,Uc=new WeakMap,id=new WeakMap,nb=new WeakMap,ib=new WeakMap,W1=new WeakMap,Hc=new WeakMap,Do=new WeakMap,zc=new WeakMap,sb=new WeakMap,jc=new WeakMap,rb=new WeakMap,sd=new WeakMap,rd=new WeakMap,pi=new WeakSet,P9=function(){const e=b(this,jc),t=b(this,Uc);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&b(this,jc).html||null},H8=function(){var e,t,i;return((i=(t=(e=b(this,pi,P9))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:i.fontSize)||0},rT=function(){var e,t,i;return((i=(t=(e=b(this,pi,P9))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:i.color)||null},aT=function(e){const t=[],i={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},s={style:{color:b(this,pi,rT),fontSize:b(this,pi,H8)?`calc(${b(this,pi,H8)}px * var(--total-scale-factor))`:""}};for(const r of e.split(`
`))t.push({name:"span",value:r,attributes:s});return i},oT=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&b(this,Hc))&&D(this,pi,N9).call(this)},lT=function(){if(b(this,zc)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:i,pageX:s,pageY:r}}}=b(this,ib);let a=!!b(this,W1),o=a?b(this,W1):b(this,sb);for(const g of b(this,nb))if(!o||tn.intersect(g.data.rect,o)!==null){o=g.data.rect,a=!0;break}const l=tn.normalizeRect([o[0],e[3]-o[1]+e[1],o[2],e[3]-o[3]+e[1]]),h=a?o[2]-o[0]+5:0,u=l[0]+h,d=l[1];O(this,zc,[100*(u-s)/t,100*(d-r)/i]);const{style:f}=b(this,Ki);f.left=`${b(this,zc)[0]}%`,f.top=`${b(this,zc)[1]}%`},N9=function(){O(this,Hc,!b(this,Hc)),b(this,Hc)?(D(this,pi,O9).call(this),b(this,Ki).addEventListener("click",b(this,V1)),b(this,Ki).addEventListener("keydown",b(this,G1))):(D(this,pi,z8).call(this),b(this,Ki).removeEventListener("click",b(this,V1)),b(this,Ki).removeEventListener("keydown",b(this,G1)))},O9=function(){b(this,Do)||this.render(),this.isVisible?b(this,Hc)&&b(this,Ki).classList.add("focused"):(D(this,pi,lT).call(this),b(this,Ki).hidden=!1,b(this,Ki).style.zIndex=parseInt(b(this,Ki).style.zIndex)+1e3)},z8=function(){b(this,Ki).classList.remove("focused"),!(b(this,Hc)||!this.isVisible)&&(b(this,Ki).hidden=!0,b(this,Ki).style.zIndex=parseInt(b(this,Ki).style.zIndex)-1e3)};class cT extends os{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=wn.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const i=document.createElement("span");i.textContent=t,e.append(i)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var ab;class YB extends os{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});B(this,ab,null)}render(){this.container.classList.add("lineAnnotation");const{data:t,width:i,height:s}=this,r=this.svgFactory.create(i,s,!0),a=O(this,ab,this.svgFactory.createElement("svg:line"));return a.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),a.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),a.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),a.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),a.setAttribute("stroke-width",t.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),r.append(a),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return b(this,ab)}addHighlightArea(){this.container.classList.add("highlightArea")}}ab=new WeakMap;var ob;class JB extends os{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});B(this,ob,null)}render(){this.container.classList.add("squareAnnotation");const{data:t,width:i,height:s}=this,r=this.svgFactory.create(i,s,!0),a=t.borderStyle.width,o=O(this,ob,this.svgFactory.createElement("svg:rect"));return o.setAttribute("x",a/2),o.setAttribute("y",a/2),o.setAttribute("width",i-a),o.setAttribute("height",s-a),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return b(this,ob)}addHighlightArea(){this.container.classList.add("highlightArea")}}ob=new WeakMap;var lb;class ZB extends os{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});B(this,lb,null)}render(){this.container.classList.add("circleAnnotation");const{data:t,width:i,height:s}=this,r=this.svgFactory.create(i,s,!0),a=t.borderStyle.width,o=O(this,lb,this.svgFactory.createElement("svg:ellipse"));return o.setAttribute("cx",i/2),o.setAttribute("cy",s/2),o.setAttribute("rx",i/2-a/2),o.setAttribute("ry",s/2-a/2),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return b(this,lb)}addHighlightArea(){this.container.classList.add("highlightArea")}}lb=new WeakMap;var cb;class hT extends os{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});B(this,cb,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:i,borderStyle:s,popupRef:r},width:a,height:o}=this;if(!i)return this.container;const l=this.svgFactory.create(a,o,!0);let c=[];for(let u=0,d=i.length;u<d;u+=2){const f=i[u]-t[0],g=t[3]-i[u+1];c.push(`${f},${g}`)}c=c.join(" ");const h=O(this,cb,this.svgFactory.createElement(this.svgElementName));return h.setAttribute("points",c),h.setAttribute("stroke-width",s.width||1),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),l.append(h),this.container.append(l),!r&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return b(this,cb)}addHighlightArea(){this.container.classList.add("highlightArea")}}cb=new WeakMap;class QB extends hT{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class $B extends os{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var hb,ad,ub,j8;class m4 extends os{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});B(this,ub);B(this,hb,null);B(this,ad,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?wn.HIGHLIGHT:wn.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:i,inkLists:s,borderStyle:r,popupRef:a}}=this,{transform:o,width:l,height:c}=D(this,ub,j8).call(this,i,t),h=this.svgFactory.create(l,c,!0),u=O(this,hb,this.svgFactory.createElement("svg:g"));h.append(u),u.setAttribute("stroke-width",r.width||1),u.setAttribute("stroke-linecap","round"),u.setAttribute("stroke-linejoin","round"),u.setAttribute("stroke-miterlimit",10),u.setAttribute("stroke","transparent"),u.setAttribute("fill","transparent"),u.setAttribute("transform",o);for(let d=0,f=s.length;d<f;d++){const g=this.svgFactory.createElement(this.svgElementName);b(this,ad).push(g),g.setAttribute("points",s[d].join(",")),u.append(g)}return!a&&this.hasPopupData&&this._createPopup(),this.container.append(h),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:i,points:s,rect:r}=t,a=b(this,hb);if(i>=0&&a.setAttribute("stroke-width",i||1),s)for(let o=0,l=b(this,ad).length;o<l;o++)b(this,ad)[o].setAttribute("points",s[o].join(","));if(r){const{transform:o,width:l,height:c}=D(this,ub,j8).call(this,this.data.rotation,r);a.parentElement.setAttribute("viewBox",`0 0 ${l} ${c}`),a.setAttribute("transform",o)}}getElementsToTriggerPopup(){return b(this,ad)}addHighlightArea(){this.container.classList.add("highlightArea")}}hb=new WeakMap,ad=new WeakMap,ub=new WeakSet,j8=function(t,i){switch(t){case 90:return{transform:`rotate(90) translate(${-i[0]},${i[1]}) scale(1,-1)`,width:i[3]-i[1],height:i[2]-i[0]};case 180:return{transform:`rotate(180) translate(${-i[2]},${i[1]}) scale(1,-1)`,width:i[2]-i[0],height:i[3]-i[1]};case 270:return{transform:`rotate(270) translate(${-i[2]},${i[3]}) scale(1,-1)`,width:i[3]-i[1],height:i[2]-i[0]};default:return{transform:`translate(${-i[0]},${i[3]}) scale(1,-1)`,width:i[2]-i[0],height:i[3]-i[1]}}};class uT extends os{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=wn.HIGHLIGHT}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){const i=document.createElement("mark");i.classList.add("overlaidText"),i.textContent=e,this.container.append(i)}return this.container}}class eU extends os{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),e){const i=document.createElement("u");i.classList.add("overlaidText"),i.textContent=e,this.container.append(i)}return this.container}}class tU extends os{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),e){const i=document.createElement("u");i.classList.add("overlaidText"),i.textContent=e,this.container.append(i)}return this.container}}class nU extends os{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),e){const i=document.createElement("s");i.classList.add("overlaidText"),i.textContent=e,this.container.append(i)}return this.container}}class dT extends os{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=wn.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var db,fb,G8;class iU extends os{constructor(t){var s;super(t,{isRenderable:!0});B(this,fb);B(this,db,null);const{file:i}=this.data;this.filename=i.filename,this.content=i.content,(s=this.linkService.eventBus)==null||s.dispatch("fileattachmentannotation",{source:this,...i})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:i}=this;let s;i.hasAppearance||i.fillAlpha===0?s=document.createElement("div"):(s=document.createElement("img"),s.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(i.name)?"paperclip":"pushpin"}.svg`,i.fillAlpha&&i.fillAlpha<1&&(s.style=`filter: opacity(${Math.round(i.fillAlpha*100)}%);`)),s.addEventListener("dblclick",D(this,fb,G8).bind(this)),O(this,db,s);const{isMac:r}=dr.platform;return t.addEventListener("keydown",a=>{a.key==="Enter"&&(r?a.metaKey:a.ctrlKey)&&D(this,fb,G8).call(this)}),!i.popupRef&&this.hasPopupData?this._createPopup():s.classList.add("popupTriggerArea"),t.append(s),t}getElementsToTriggerPopup(){return b(this,db)}addHighlightArea(){this.container.classList.add("highlightArea")}}db=new WeakMap,fb=new WeakSet,G8=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var gb,od,rh,mb,Wh,q8,W8;const X_=class X_{constructor({div:e,accessibilityManager:t,annotationCanvasMap:i,annotationEditorUIManager:s,page:r,viewport:a,structTreeLayer:o}){B(this,Wh);B(this,gb,null);B(this,od,null);B(this,rh,new Map);B(this,mb,null);this.div=e,O(this,gb,t),O(this,od,i),O(this,mb,o||null),this.page=r,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=s}hasEditableAnnotations(){return b(this,rh).size>0}async render(e){var a;const{annotations:t}=e,i=this.div;Vd(i,this.viewport);const s=new Map,r={data:null,layer:i,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new w3,annotationStorage:e.annotationStorage||new d4,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const o of t){if(o.noHTML)continue;const l=o.annotationType===fs.POPUP;if(l){const u=s.get(o.id);if(!u)continue;r.elements=u}else if(o.rect[2]===o.rect[0]||o.rect[3]===o.rect[1])continue;r.data=o;const c=Bv.create(r);if(!c.isRenderable)continue;if(!l&&o.popupRef){const u=s.get(o.popupRef);u?u.push(c):s.set(o.popupRef,[c])}const h=c.render();o.hidden&&(h.style.visibility="hidden"),await D(this,Wh,q8).call(this,h,o.id,r.elements),c._isEditable&&(b(this,rh).set(c.data.id,c),(a=this._annotationEditorUIManager)==null||a.renderAnnotationElement(c))}D(this,Wh,W8).call(this)}async addLinkAnnotations(e,t){const i={data:null,layer:this.div,linkService:t,svgFactory:new w3,parent:this};for(const s of e){s.borderStyle||(s.borderStyle=X_._defaultBorderStyle),i.data=s;const r=Bv.create(i);if(!r.isRenderable)continue;const a=r.render();await D(this,Wh,q8).call(this,a,s.id,null)}}update({viewport:e}){const t=this.div;this.viewport=e,Vd(t,{rotation:e.rotation}),D(this,Wh,W8).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(b(this,rh).values())}getEditableAnnotation(e){return b(this,rh).get(e)}static get _defaultBorderStyle(){return Hn(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:yf.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}};gb=new WeakMap,od=new WeakMap,rh=new WeakMap,mb=new WeakMap,Wh=new WeakSet,q8=async function(e,t,i){var o,l;const s=e.firstChild||e,r=s.id=`${o4}${t}`,a=await((o=b(this,mb))==null?void 0:o.getAriaAttributes(r));if(a)for(const[c,h]of a)s.setAttribute(c,h);i?i.at(-1).container.after(e):(this.div.append(e),(l=b(this,gb))==null||l.moveElementInDOM(this.div,e,s,!1))},W8=function(){var t;if(!b(this,od))return;const e=this.div;for(const[i,s]of b(this,od)){const r=e.querySelector(`[data-annotation-id="${i}"]`);if(!r)continue;s.className="annotationContent";const{firstChild:a}=r;a?a.nodeName==="CANVAS"?a.replaceWith(s):a.classList.contains("annotationContent")?a.after(s):a.before(s):r.append(s);const o=b(this,rh).get(i);o&&(o._hasNoCanvas?((t=this._annotationEditorUIManager)==null||t.setMissingCanvas(i,r.id,s),o._hasNoCanvas=!1):o.canvas=s)}b(this,od).clear()};let V8=X_;const Lx=/\r\n?|\n/g;var Fo,Aa,pb,ld,Sa,xs,fT,gT,mT,D9,m0,F9,L9,pT,X8,bT;const _i=class _i extends ki{constructor(t){super({...t,name:"freeTextEditor"});B(this,xs);B(this,Fo);B(this,Aa,"");B(this,pb,`${this.id}-editor`);B(this,ld,null);B(this,Sa);O(this,Fo,t.color||_i._defaultColor||ki._defaultLineColor),O(this,Sa,t.fontSize||_i._defaultFontSize),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert")}static get _keyboardManager(){const t=_i.prototype,i=a=>a.isEmpty(),s=qd.TRANSLATE_SMALL,r=qd.TRANSLATE_BIG;return Hn(this,"_keyboardManager",new lx([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-s,0],checker:i}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:i}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[s,0],checker:i}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[r,0],checker:i}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-s],checker:i}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:i}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,s],checker:i}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,r],checker:i}]]))}static initialize(t,i){ki.initialize(t,i);const s=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(s.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,i){switch(t){case Gn.FREETEXT_SIZE:_i._defaultFontSize=i;break;case Gn.FREETEXT_COLOR:_i._defaultColor=i;break}}updateParams(t,i){switch(t){case Gn.FREETEXT_SIZE:D(this,xs,fT).call(this,i);break;case Gn.FREETEXT_COLOR:D(this,xs,gT).call(this,i);break}}static get defaultPropertiesToUpdate(){return[[Gn.FREETEXT_SIZE,_i._defaultFontSize],[Gn.FREETEXT_COLOR,_i._defaultColor||ki._defaultLineColor]]}get propertiesToUpdate(){return[[Gn.FREETEXT_SIZE,b(this,Sa)],[Gn.FREETEXT_COLOR,b(this,Fo)]]}_translateEmpty(t,i){this._uiManager.translateSelectedEditors(t,i,!0)}getInitialTranslation(){const t=this.parentScale;return[-_i._internalPadding*t,-(_i._internalPadding+b(this,Sa))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),O(this,ld,new AbortController);const t=this._uiManager.combinedSignal(b(this,ld));return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){var t;return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",b(this,pb)),this._isDraggable=!0,(t=b(this,ld))==null||t.abort(),O(this,ld,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){var i;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),(i=this._initialOptions)!=null&&i.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=b(this,Aa),i=O(this,Aa,D(this,xs,mT).call(this).trimEnd());if(t===i)return;const s=r=>{if(O(this,Aa,r),!r){this.remove();return}D(this,xs,L9).call(this),this._uiManager.rebuild(this),D(this,xs,D9).call(this)};this.addCommands({cmd:()=>{s(i)},undo:()=>{s(t)},mustExec:!1}),D(this,xs,D9).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){_i._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,i;(this._isCopy||this.annotationElementId)&&(t=this.x,i=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",b(this,pb)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:s}=this.editorDiv;if(s.fontSize=`calc(${b(this,Sa)}px * var(--total-scale-factor))`,s.color=b(this,Fo),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[r,a]=this.parentDimensions;if(this.annotationElementId){const{position:o}=this._initialData;let[l,c]=this.getInitialTranslation();[l,c]=this.pageTranslationToScreen(l,c);const[h,u]=this.pageDimensions,[d,f]=this.pageTranslation;let g,m;switch(this.rotation){case 0:g=t+(o[0]-d)/h,m=i+this.height-(o[1]-f)/u;break;case 90:g=t+(o[0]-d)/h,m=i-(o[1]-f)/u,[l,c]=[c,-l];break;case 180:g=t-this.width+(o[0]-d)/h,m=i-(o[1]-f)/u,[l,c]=[-l,-c];break;case 270:g=t+(o[0]-d-this.height*u)/h,m=i+(o[1]-f-this.width*h)/u,[l,c]=[-c,l];break}this.setAt(g*r,m*a,l,c)}else this._moveAfterPaste(t,i);D(this,xs,L9).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var g,m,x;const i=t.clipboardData||window.clipboardData,{types:s}=i;if(s.length===1&&s[0]==="text/plain")return;t.preventDefault();const r=D(g=_i,m0,X8).call(g,i.getData("text")||"").replaceAll(Lx,`
`);if(!r)return;const a=window.getSelection();if(!a.rangeCount)return;this.editorDiv.normalize(),a.deleteFromDocument();const o=a.getRangeAt(0);if(!r.includes(`
`)){o.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),a.collapseToStart();return}const{startContainer:l,startOffset:c}=o,h=[],u=[];if(l.nodeType===Node.TEXT_NODE){const p=l.parentElement;if(u.push(l.nodeValue.slice(c).replaceAll(Lx,"")),p!==this.editorDiv){let y=h;for(const w of this.editorDiv.childNodes){if(w===p){y=u;continue}y.push(D(m=_i,m0,F9).call(m,w))}}h.push(l.nodeValue.slice(0,c).replaceAll(Lx,""))}else if(l===this.editorDiv){let p=h,y=0;for(const w of this.editorDiv.childNodes)y++===c&&(p=u),p.push(D(x=_i,m0,F9).call(x,w))}O(this,Aa,`${h.join(`
`)}${r}${u.join(`
`)}`),D(this,xs,L9).call(this);const d=new Range;let f=Math.sumPrecise(h.map(p=>p.length));for(const{firstChild:p}of this.editorDiv.childNodes)if(p.nodeType===Node.TEXT_NODE){const y=p.nodeValue.length;if(f<=y){d.setStart(p,f),d.setEnd(p,f);break}f-=y}a.removeAllRanges(),a.addRange(d)}get contentDiv(){return this.editorDiv}static async deserialize(t,i,s){var o;let r=null;if(t instanceof cT){const{data:{defaultAppearanceData:{fontSize:l,fontColor:c},rect:h,rotation:u,id:d,popupRef:f},textContent:g,textPosition:m,parent:{page:{pageNumber:x}}}=t;if(!g||g.length===0)return null;r=t={annotationType:wn.FREETEXT,color:Array.from(c),fontSize:l,value:g.join(`
`),position:m,pageIndex:x-1,rect:h.slice(0),rotation:u,annotationElementId:d,id:d,deleted:!1,popupRef:f}}const a=await super.deserialize(t,i,s);return O(a,Sa,t.fontSize),O(a,Fo,tn.makeHexColor(...t.color)),O(a,Aa,D(o=_i,m0,X8).call(o,t.value)),a._initialData=r,a}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=_i._internalPadding*this.parentScale,s=this.getRect(i,i),r=ki._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:b(this,Fo)),a={annotationType:wn.FREETEXT,color:r,fontSize:b(this,Sa),value:D(this,xs,pT).call(this),pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?(a.isCopy=!0,a):this.annotationElementId&&!D(this,xs,bT).call(this,a)?null:(a.id=this.annotationElementId,a)}renderAnnotationElement(t){const i=super.renderAnnotationElement(t);if(this.deleted)return i;const{style:s}=i;s.fontSize=`calc(${b(this,Sa)}px * var(--total-scale-factor))`,s.color=b(this,Fo),i.replaceChildren();for(const a of b(this,Aa).split(`
`)){const o=document.createElement("div");o.append(a?document.createTextNode(a):document.createElement("br")),i.append(o)}const r=_i._internalPadding*this.parentScale;return t.updateEdited({rect:this.getRect(r,r),popupContent:b(this,Aa)}),i}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};Fo=new WeakMap,Aa=new WeakMap,pb=new WeakMap,ld=new WeakMap,Sa=new WeakMap,xs=new WeakSet,fT=function(t){const i=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--total-scale-factor))`,this.translate(0,-(r-b(this,Sa))*this.parentScale),O(this,Sa,r),D(this,xs,D9).call(this)},s=b(this,Sa);this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Gn.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},gT=function(t){const i=r=>{O(this,Fo,this.editorDiv.style.color=r)},s=b(this,Fo);this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Gn.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},mT=function(){var s;const t=[];this.editorDiv.normalize();let i=null;for(const r of this.editorDiv.childNodes)(i==null?void 0:i.nodeType)===Node.TEXT_NODE&&r.nodeName==="BR"||(t.push(D(s=_i,m0,F9).call(s,r)),i=r);return t.join(`
`)},D9=function(){const[t,i]=this.parentDimensions;let s;if(this.isAttachedToDOM)s=this.div.getBoundingClientRect();else{const{currentLayer:r,div:a}=this,o=a.style.display,l=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",r.div.append(this.div),s=a.getBoundingClientRect(),a.remove(),a.style.display=o,a.classList.toggle("hidden",l)}this.rotation%180===this.parentRotation%180?(this.width=s.width/t,this.height=s.height/i):(this.width=s.height/t,this.height=s.width/i),this.fixAndSetPosition()},m0=new WeakSet,F9=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(Lx,"")},L9=function(){if(this.editorDiv.replaceChildren(),!!b(this,Aa))for(const t of b(this,Aa).split(`
`)){const i=document.createElement("div");i.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(i)}},pT=function(){return b(this,Aa).replaceAll(" "," ")},X8=function(t){return t.replaceAll(" "," ")},bT=function(t){const{value:i,fontSize:s,color:r,pageIndex:a}=this._initialData;return this._hasBeenMoved||t.value!==i||t.fontSize!==s||t.color.some((o,l)=>o!==r[l])||t.pageIndex!==a},B(_i,m0),He(_i,"_freeTextDefaultContent",""),He(_i,"_internalPadding",0),He(_i,"_defaultColor",null),He(_i,"_defaultFontSize",10),He(_i,"_type","freetext"),He(_i,"_editorType",wn.FREETEXT);let K8=_i;class Bt{toSVGPath(){mi("Abstract method `toSVGPath` must be implemented.")}get box(){mi("Abstract getter `box` must be implemented.")}serialize(e,t){mi("Abstract method `serialize` must be implemented.")}static _rescale(e,t,i,s,r,a){a||(a=new Float32Array(e.length));for(let o=0,l=e.length;o<l;o+=2)a[o]=t+e[o]*s,a[o+1]=i+e[o+1]*r;return a}static _rescaleAndSwap(e,t,i,s,r,a){a||(a=new Float32Array(e.length));for(let o=0,l=e.length;o<l;o+=2)a[o]=t+e[o+1]*s,a[o+1]=i+e[o]*r;return a}static _translate(e,t,i,s){s||(s=new Float32Array(e.length));for(let r=0,a=e.length;r<a;r+=2)s[r]=t+e[r],s[r+1]=i+e[r+1];return s}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,i,s,r){switch(r){case 90:return[1-t/i,e/s];case 180:return[1-e/i,1-t/s];case 270:return[t/i,1-e/s];default:return[e/i,t/s]}}static _normalizePagePoint(e,t,i){switch(i){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,i,s,r,a){return[(e+5*i)/6,(t+5*s)/6,(5*i+r)/6,(5*s+a)/6,(i+r)/2,(s+a)/2]}}He(Bt,"PRECISION",1e-4);var Ia,Lo,K1,X1,Fl,Mn,cd,hd,bb,xb,Y1,J1,ah,yb,S5,I5,Is,ep,xT,yT,wT,_T,vT,kT;const xc=class xc{constructor({x:e,y:t},i,s,r,a,o=0){B(this,Is);B(this,Ia);B(this,Lo,[]);B(this,K1);B(this,X1);B(this,Fl,[]);B(this,Mn,new Float32Array(18));B(this,cd);B(this,hd);B(this,bb);B(this,xb);B(this,Y1);B(this,J1);B(this,ah,[]);O(this,Ia,i),O(this,J1,r*s),O(this,X1,a),b(this,Mn).set([NaN,NaN,NaN,NaN,e,t],6),O(this,K1,o),O(this,xb,b(xc,yb)*s),O(this,bb,b(xc,I5)*s),O(this,Y1,s),b(this,ah).push(e,t)}isEmpty(){return isNaN(b(this,Mn)[8])}add({x:e,y:t}){var S;O(this,cd,e),O(this,hd,t);const[i,s,r,a]=b(this,Ia);let[o,l,c,h]=b(this,Mn).subarray(8,12);const u=e-c,d=t-h,f=Math.hypot(u,d);if(f<b(this,bb))return!1;const g=f-b(this,xb),m=g/f,x=m*u,p=m*d;let y=o,w=l;o=c,l=h,c+=x,h+=p,(S=b(this,ah))==null||S.push(e,t);const _=-p/g,v=x/g,C=_*b(this,J1),k=v*b(this,J1);return b(this,Mn).set(b(this,Mn).subarray(2,8),0),b(this,Mn).set([c+C,h+k],4),b(this,Mn).set(b(this,Mn).subarray(14,18),12),b(this,Mn).set([c-C,h-k],16),isNaN(b(this,Mn)[6])?(b(this,Fl).length===0&&(b(this,Mn).set([o+C,l+k],2),b(this,Fl).push(NaN,NaN,NaN,NaN,(o+C-i)/r,(l+k-s)/a),b(this,Mn).set([o-C,l-k],14),b(this,Lo).push(NaN,NaN,NaN,NaN,(o-C-i)/r,(l-k-s)/a)),b(this,Mn).set([y,w,o,l,c,h],6),!this.isEmpty()):(b(this,Mn).set([y,w,o,l,c,h],6),Math.abs(Math.atan2(w-l,y-o)-Math.atan2(p,x))<Math.PI/2?([o,l,c,h]=b(this,Mn).subarray(2,6),b(this,Fl).push(NaN,NaN,NaN,NaN,((o+c)/2-i)/r,((l+h)/2-s)/a),[o,l,y,w]=b(this,Mn).subarray(14,18),b(this,Lo).push(NaN,NaN,NaN,NaN,((y+o)/2-i)/r,((w+l)/2-s)/a),!0):([y,w,o,l,c,h]=b(this,Mn).subarray(0,6),b(this,Fl).push(((y+5*o)/6-i)/r,((w+5*l)/6-s)/a,((5*o+c)/6-i)/r,((5*l+h)/6-s)/a,((o+c)/2-i)/r,((l+h)/2-s)/a),[c,h,o,l,y,w]=b(this,Mn).subarray(12,18),b(this,Lo).push(((y+5*o)/6-i)/r,((w+5*l)/6-s)/a,((5*o+c)/6-i)/r,((5*l+h)/6-s)/a,((o+c)/2-i)/r,((l+h)/2-s)/a),!0))}toSVGPath(){if(this.isEmpty())return"";const e=b(this,Fl),t=b(this,Lo);if(isNaN(b(this,Mn)[6])&&!this.isEmpty())return D(this,Is,xT).call(this);const i=[];i.push(`M${e[4]} ${e[5]}`);for(let s=6;s<e.length;s+=6)isNaN(e[s])?i.push(`L${e[s+4]} ${e[s+5]}`):i.push(`C${e[s]} ${e[s+1]} ${e[s+2]} ${e[s+3]} ${e[s+4]} ${e[s+5]}`);D(this,Is,wT).call(this,i);for(let s=t.length-6;s>=6;s-=6)isNaN(t[s])?i.push(`L${t[s+4]} ${t[s+5]}`):i.push(`C${t[s]} ${t[s+1]} ${t[s+2]} ${t[s+3]} ${t[s+4]} ${t[s+5]}`);return D(this,Is,yT).call(this,i),i.join(" ")}newFreeDrawOutline(e,t,i,s,r,a){return new CT(e,t,i,s,r,a)}getOutlines(){var u;const e=b(this,Fl),t=b(this,Lo),i=b(this,Mn),[s,r,a,o]=b(this,Ia),l=new Float32Array((((u=b(this,ah))==null?void 0:u.length)??0)+2);for(let d=0,f=l.length-2;d<f;d+=2)l[d]=(b(this,ah)[d]-s)/a,l[d+1]=(b(this,ah)[d+1]-r)/o;if(l[l.length-2]=(b(this,cd)-s)/a,l[l.length-1]=(b(this,hd)-r)/o,isNaN(i[6])&&!this.isEmpty())return D(this,Is,_T).call(this,l);const c=new Float32Array(b(this,Fl).length+24+b(this,Lo).length);let h=e.length;for(let d=0;d<h;d+=2){if(isNaN(e[d])){c[d]=c[d+1]=NaN;continue}c[d]=e[d],c[d+1]=e[d+1]}h=D(this,Is,kT).call(this,c,h);for(let d=t.length-6;d>=6;d-=6)for(let f=0;f<6;f+=2){if(isNaN(t[d+f])){c[h]=c[h+1]=NaN,h+=2;continue}c[h]=t[d+f],c[h+1]=t[d+f+1],h+=2}return D(this,Is,vT).call(this,c,h),this.newFreeDrawOutline(c,l,b(this,Ia),b(this,Y1),b(this,K1),b(this,X1))}};Ia=new WeakMap,Lo=new WeakMap,K1=new WeakMap,X1=new WeakMap,Fl=new WeakMap,Mn=new WeakMap,cd=new WeakMap,hd=new WeakMap,bb=new WeakMap,xb=new WeakMap,Y1=new WeakMap,J1=new WeakMap,ah=new WeakMap,yb=new WeakMap,S5=new WeakMap,I5=new WeakMap,Is=new WeakSet,ep=function(){const e=b(this,Mn).subarray(4,6),t=b(this,Mn).subarray(16,18),[i,s,r,a]=b(this,Ia);return[(b(this,cd)+(e[0]-t[0])/2-i)/r,(b(this,hd)+(e[1]-t[1])/2-s)/a,(b(this,cd)+(t[0]-e[0])/2-i)/r,(b(this,hd)+(t[1]-e[1])/2-s)/a]},xT=function(){const[e,t,i,s]=b(this,Ia),[r,a,o,l]=D(this,Is,ep).call(this);return`M${(b(this,Mn)[2]-e)/i} ${(b(this,Mn)[3]-t)/s} L${(b(this,Mn)[4]-e)/i} ${(b(this,Mn)[5]-t)/s} L${r} ${a} L${o} ${l} L${(b(this,Mn)[16]-e)/i} ${(b(this,Mn)[17]-t)/s} L${(b(this,Mn)[14]-e)/i} ${(b(this,Mn)[15]-t)/s} Z`},yT=function(e){const t=b(this,Lo);e.push(`L${t[4]} ${t[5]} Z`)},wT=function(e){const[t,i,s,r]=b(this,Ia),a=b(this,Mn).subarray(4,6),o=b(this,Mn).subarray(16,18),[l,c,h,u]=D(this,Is,ep).call(this);e.push(`L${(a[0]-t)/s} ${(a[1]-i)/r} L${l} ${c} L${h} ${u} L${(o[0]-t)/s} ${(o[1]-i)/r}`)},_T=function(e){const t=b(this,Mn),[i,s,r,a]=b(this,Ia),[o,l,c,h]=D(this,Is,ep).call(this),u=new Float32Array(36);return u.set([NaN,NaN,NaN,NaN,(t[2]-i)/r,(t[3]-s)/a,NaN,NaN,NaN,NaN,(t[4]-i)/r,(t[5]-s)/a,NaN,NaN,NaN,NaN,o,l,NaN,NaN,NaN,NaN,c,h,NaN,NaN,NaN,NaN,(t[16]-i)/r,(t[17]-s)/a,NaN,NaN,NaN,NaN,(t[14]-i)/r,(t[15]-s)/a],0),this.newFreeDrawOutline(u,e,b(this,Ia),b(this,Y1),b(this,K1),b(this,X1))},vT=function(e,t){const i=b(this,Lo);return e.set([NaN,NaN,NaN,NaN,i[4],i[5]],t),t+=6},kT=function(e,t){const i=b(this,Mn).subarray(4,6),s=b(this,Mn).subarray(16,18),[r,a,o,l]=b(this,Ia),[c,h,u,d]=D(this,Is,ep).call(this);return e.set([NaN,NaN,NaN,NaN,(i[0]-r)/o,(i[1]-a)/l,NaN,NaN,NaN,NaN,c,h,NaN,NaN,NaN,NaN,u,d,NaN,NaN,NaN,NaN,(s[0]-r)/o,(s[1]-a)/l],t),t+=24},B(xc,yb,8),B(xc,S5,2),B(xc,I5,b(xc,yb)+b(xc,S5));let _3=xc;var Z1,ud,Gc,wb,Ea,_b,is,E5,AT;class CT extends Bt{constructor(t,i,s,r,a,o){super();B(this,E5);B(this,Z1);B(this,ud,new Float32Array(4));B(this,Gc);B(this,wb);B(this,Ea);B(this,_b);B(this,is);O(this,is,t),O(this,Ea,i),O(this,Z1,s),O(this,_b,r),O(this,Gc,a),O(this,wb,o),this.lastPoint=[NaN,NaN],D(this,E5,AT).call(this,o);const[l,c,h,u]=b(this,ud);for(let d=0,f=t.length;d<f;d+=2)t[d]=(t[d]-l)/h,t[d+1]=(t[d+1]-c)/u;for(let d=0,f=i.length;d<f;d+=2)i[d]=(i[d]-l)/h,i[d+1]=(i[d+1]-c)/u}toSVGPath(){const t=[`M${b(this,is)[4]} ${b(this,is)[5]}`];for(let i=6,s=b(this,is).length;i<s;i+=6){if(isNaN(b(this,is)[i])){t.push(`L${b(this,is)[i+4]} ${b(this,is)[i+5]}`);continue}t.push(`C${b(this,is)[i]} ${b(this,is)[i+1]} ${b(this,is)[i+2]} ${b(this,is)[i+3]} ${b(this,is)[i+4]} ${b(this,is)[i+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,i,s,r],a){const o=s-t,l=r-i;let c,h;switch(a){case 0:c=Bt._rescale(b(this,is),t,r,o,-l),h=Bt._rescale(b(this,Ea),t,r,o,-l);break;case 90:c=Bt._rescaleAndSwap(b(this,is),t,i,o,l),h=Bt._rescaleAndSwap(b(this,Ea),t,i,o,l);break;case 180:c=Bt._rescale(b(this,is),s,i,-o,l),h=Bt._rescale(b(this,Ea),s,i,-o,l);break;case 270:c=Bt._rescaleAndSwap(b(this,is),s,r,-o,-l),h=Bt._rescaleAndSwap(b(this,Ea),s,r,-o,-l);break}return{outline:Array.from(c),points:[Array.from(h)]}}get box(){return b(this,ud)}newOutliner(t,i,s,r,a,o=0){return new _3(t,i,s,r,a,o)}getNewOutline(t,i){const[s,r,a,o]=b(this,ud),[l,c,h,u]=b(this,Z1),d=a*h,f=o*u,g=s*h+l,m=r*u+c,x=this.newOutliner({x:b(this,Ea)[0]*d+g,y:b(this,Ea)[1]*f+m},b(this,Z1),b(this,_b),t,b(this,wb),i??b(this,Gc));for(let p=2;p<b(this,Ea).length;p+=2)x.add({x:b(this,Ea)[p]*d+g,y:b(this,Ea)[p+1]*f+m});return x.getOutlines()}}Z1=new WeakMap,ud=new WeakMap,Gc=new WeakMap,wb=new WeakMap,Ea=new WeakMap,_b=new WeakMap,is=new WeakMap,E5=new WeakSet,AT=function(t){const i=b(this,is);let s=i[4],r=i[5];const a=[s,r,s,r];let o=s,l=r;const c=t?Math.max:Math.min;for(let u=6,d=i.length;u<d;u+=6){const f=i[u+4],g=i[u+5];if(isNaN(i[u]))tn.pointBoundingBox(f,g,a),l<g?(o=f,l=g):l===g&&(o=c(o,f));else{const m=[1/0,1/0,-1/0,-1/0];tn.bezierBoundingBox(s,r,...i.slice(u,u+6),m),tn.rectBoundingBox(...m,a),l<m[3]?(o=m[2],l=m[3]):l===m[3]&&(o=c(o,m[2]))}s=f,r=g}const h=b(this,ud);h[0]=a[0]-b(this,Gc),h[1]=a[1]-b(this,Gc),h[2]=a[2]-a[0]+2*b(this,Gc),h[3]=a[3]-a[1]+2*b(this,Gc),this.lastPoint=[o,l]};var vb,kb,oh,Bo,Yr,ST,B9,IT,ET,J8;class Y8{constructor(e,t=0,i=0,s=!0){B(this,Yr);B(this,vb);B(this,kb);B(this,oh,[]);B(this,Bo,[]);const r=[1/0,1/0,-1/0,-1/0],o=10**-4;for(const{x:g,y:m,width:x,height:p}of e){const y=Math.floor((g-t)/o)*o,w=Math.ceil((g+x+t)/o)*o,_=Math.floor((m-t)/o)*o,v=Math.ceil((m+p+t)/o)*o,C=[y,_,v,!0],k=[w,_,v,!1];b(this,oh).push(C,k),tn.rectBoundingBox(y,_,w,v,r)}const l=r[2]-r[0]+2*i,c=r[3]-r[1]+2*i,h=r[0]-i,u=r[1]-i,d=b(this,oh).at(s?-1:-2),f=[d[0],d[2]];for(const g of b(this,oh)){const[m,x,p]=g;g[0]=(m-h)/l,g[1]=(x-u)/c,g[2]=(p-u)/c}O(this,vb,new Float32Array([h,u,l,c])),O(this,kb,f)}getOutlines(){b(this,oh).sort((t,i)=>t[0]-i[0]||t[1]-i[1]||t[2]-i[2]);const e=[];for(const t of b(this,oh))t[3]?(e.push(...D(this,Yr,J8).call(this,t)),D(this,Yr,IT).call(this,t)):(D(this,Yr,ET).call(this,t),e.push(...D(this,Yr,J8).call(this,t)));return D(this,Yr,ST).call(this,e)}}vb=new WeakMap,kb=new WeakMap,oh=new WeakMap,Bo=new WeakMap,Yr=new WeakSet,ST=function(e){const t=[],i=new Set;for(const a of e){const[o,l,c]=a;t.push([o,l,a],[o,c,a])}t.sort((a,o)=>a[1]-o[1]||a[0]-o[0]);for(let a=0,o=t.length;a<o;a+=2){const l=t[a][2],c=t[a+1][2];l.push(c),c.push(l),i.add(l),i.add(c)}const s=[];let r;for(;i.size>0;){const a=i.values().next().value;let[o,l,c,h,u]=a;i.delete(a);let d=o,f=l;for(r=[o,c],s.push(r);;){let g;if(i.has(h))g=h;else if(i.has(u))g=u;else break;i.delete(g),[o,l,c,h,u]=g,d!==o&&(r.push(d,f,o,f===l?l:c),d=o),f=f===l?c:l}r.push(d,f)}return new sU(s,b(this,vb),b(this,kb))},B9=function(e){const t=b(this,Bo);let i=0,s=t.length-1;for(;i<=s;){const r=i+s>>1,a=t[r][0];if(a===e)return r;a<e?i=r+1:s=r-1}return s+1},IT=function([,e,t]){const i=D(this,Yr,B9).call(this,e);b(this,Bo).splice(i,0,[e,t])},ET=function([,e,t]){const i=D(this,Yr,B9).call(this,e);for(let s=i;s<b(this,Bo).length;s++){const[r,a]=b(this,Bo)[s];if(r!==e)break;if(r===e&&a===t){b(this,Bo).splice(s,1);return}}for(let s=i-1;s>=0;s--){const[r,a]=b(this,Bo)[s];if(r!==e)break;if(r===e&&a===t){b(this,Bo).splice(s,1);return}}},J8=function(e){const[t,i,s]=e,r=[[t,i,s]],a=D(this,Yr,B9).call(this,s);for(let o=0;o<a;o++){const[l,c]=b(this,Bo)[o];for(let h=0,u=r.length;h<u;h++){const[,d,f]=r[h];if(!(c<=d||f<=l)){if(d>=l){if(f>c)r[h][1]=c;else{if(u===1)return[];r.splice(h,1),h--,u--}continue}r[h][2]=l,f>c&&r.push([t,c,f])}}}return r};var Cb,Q1;class sU extends Bt{constructor(t,i,s){super();B(this,Cb);B(this,Q1);O(this,Q1,t),O(this,Cb,i),this.lastPoint=s}toSVGPath(){const t=[];for(const i of b(this,Q1)){let[s,r]=i;t.push(`M${s} ${r}`);for(let a=2;a<i.length;a+=2){const o=i[a],l=i[a+1];o===s?(t.push(`V${l}`),r=l):l===r&&(t.push(`H${o}`),s=o)}t.push("Z")}return t.join(" ")}serialize([t,i,s,r],a){const o=[],l=s-t,c=r-i;for(const h of b(this,Q1)){const u=new Array(h.length);for(let d=0;d<h.length;d+=2)u[d]=t+h[d]*l,u[d+1]=r-h[d+1]*c;o.push(u)}return o}get box(){return b(this,Cb)}get classNamesForOutlining(){return["highlightOutline"]}}Cb=new WeakMap,Q1=new WeakMap;class Z8 extends _3{newFreeDrawOutline(e,t,i,s,r,a){return new rU(e,t,i,s,r,a)}}class rU extends CT{newOutliner(e,t,i,s,r,a=0){return new Z8(e,t,i,s,r,a)}}var Ta,dd,$1,As,Ab,eg,Vc,Sb,lh,Uo,tg,Ib,fi,Q8,$8,e7,ru,TT,E0;const na=class na{constructor({editor:e=null,uiManager:t=null}){B(this,fi);B(this,Ta,null);B(this,dd,null);B(this,$1);B(this,As,null);B(this,Ab,!1);B(this,eg,!1);B(this,Vc,null);B(this,Sb);B(this,lh,null);B(this,Uo,null);B(this,tg);var i,s;e?(O(this,eg,!1),O(this,tg,Gn.HIGHLIGHT_COLOR),O(this,Vc,e)):(O(this,eg,!0),O(this,tg,Gn.HIGHLIGHT_DEFAULT_COLOR)),O(this,Uo,(e==null?void 0:e._uiManager)||t),O(this,Sb,b(this,Uo)._eventBus),O(this,$1,((i=e==null?void 0:e.color)==null?void 0:i.toUpperCase())||((s=b(this,Uo))==null?void 0:s.highlightColors.values().next().value)||"#FFFF98"),b(na,Ib)||O(na,Ib,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return Hn(this,"_keyboardManager",new lx([[["Escape","mac+Escape"],na.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],na.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],na.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],na.prototype._moveToPrevious],[["Home","mac+Home"],na.prototype._moveToBeginning],[["End","mac+End"],na.prototype._moveToEnd]]))}renderButton(){const e=O(this,Ta,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.ariaHasPopup="true",b(this,Vc)&&(e.ariaControls=`${b(this,Vc).id}_colorpicker_dropdown`);const t=b(this,Uo)._signal;e.addEventListener("click",D(this,fi,ru).bind(this),{signal:t}),e.addEventListener("keydown",D(this,fi,e7).bind(this),{signal:t});const i=O(this,dd,document.createElement("span"));return i.className="swatch",i.ariaHidden="true",i.style.backgroundColor=b(this,$1),e.append(i),e}renderMainDropdown(){const e=O(this,As,D(this,fi,Q8).call(this));return e.ariaOrientation="horizontal",e.ariaLabelledBy="highlightColorPickerLabel",e}_colorSelectFromKeyboard(e){if(e.target===b(this,Ta)){D(this,fi,ru).call(this,e);return}const t=e.target.getAttribute("data-color");t&&D(this,fi,$8).call(this,t,e)}_moveToNext(e){var t,i;if(!b(this,fi,E0)){D(this,fi,ru).call(this,e);return}if(e.target===b(this,Ta)){(t=b(this,As).firstChild)==null||t.focus();return}(i=e.target.nextSibling)==null||i.focus()}_moveToPrevious(e){var t,i;if(e.target===((t=b(this,As))==null?void 0:t.firstChild)||e.target===b(this,Ta)){b(this,fi,E0)&&this._hideDropdownFromKeyboard();return}b(this,fi,E0)||D(this,fi,ru).call(this,e),(i=e.target.previousSibling)==null||i.focus()}_moveToBeginning(e){var t;if(!b(this,fi,E0)){D(this,fi,ru).call(this,e);return}(t=b(this,As).firstChild)==null||t.focus()}_moveToEnd(e){var t;if(!b(this,fi,E0)){D(this,fi,ru).call(this,e);return}(t=b(this,As).lastChild)==null||t.focus()}hideDropdown(){var e,t;(e=b(this,As))==null||e.classList.add("hidden"),b(this,Ta).ariaExpanded="false",(t=b(this,lh))==null||t.abort(),O(this,lh,null)}_hideDropdownFromKeyboard(){var e;if(!b(this,eg)){if(!b(this,fi,E0)){(e=b(this,Vc))==null||e.unselect();return}this.hideDropdown(),b(this,Ta).focus({preventScroll:!0,focusVisible:b(this,Ab)})}}updateColor(e){if(b(this,dd)&&(b(this,dd).style.backgroundColor=e),!b(this,As))return;const t=b(this,Uo).highlightColors.values();for(const i of b(this,As).children)i.ariaSelected=t.next().value===e.toUpperCase()}destroy(){var e,t;(e=b(this,Ta))==null||e.remove(),O(this,Ta,null),O(this,dd,null),(t=b(this,As))==null||t.remove(),O(this,As,null)}};Ta=new WeakMap,dd=new WeakMap,$1=new WeakMap,As=new WeakMap,Ab=new WeakMap,eg=new WeakMap,Vc=new WeakMap,Sb=new WeakMap,lh=new WeakMap,Uo=new WeakMap,tg=new WeakMap,Ib=new WeakMap,fi=new WeakSet,Q8=function(){const e=document.createElement("div"),t=b(this,Uo)._signal;e.addEventListener("contextmenu",nl,{signal:t}),e.className="dropdown",e.role="listbox",e.ariaMultiSelectable="false",e.ariaOrientation="vertical",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),b(this,Vc)&&(e.id=`${b(this,Vc).id}_colorpicker_dropdown`);for(const[i,s]of b(this,Uo).highlightColors){const r=document.createElement("button");r.tabIndex="0",r.role="option",r.setAttribute("data-color",s),r.title=i,r.setAttribute("data-l10n-id",b(na,Ib)[i]);const a=document.createElement("span");r.append(a),a.className="swatch",a.style.backgroundColor=s,r.ariaSelected=s===b(this,$1),r.addEventListener("click",D(this,fi,$8).bind(this,s),{signal:t}),e.append(r)}return e.addEventListener("keydown",D(this,fi,e7).bind(this),{signal:t}),e},$8=function(e,t){t.stopPropagation(),b(this,Sb).dispatch("switchannotationeditorparams",{source:this,type:b(this,tg),value:e})},e7=function(e){na._keyboardManager.exec(this,e)},ru=function(e){if(b(this,fi,E0)){this.hideDropdown();return}if(O(this,Ab,e.detail===0),b(this,lh)||(O(this,lh,new AbortController),window.addEventListener("pointerdown",D(this,fi,TT).bind(this),{signal:b(this,Uo).combinedSignal(b(this,lh))})),b(this,Ta).ariaExpanded="true",b(this,As)){b(this,As).classList.remove("hidden");return}const t=O(this,As,D(this,fi,Q8).call(this));b(this,Ta).append(t)},TT=function(e){var t;(t=b(this,As))!=null&&t.contains(e.target)||this.hideDropdown()},E0=function(){return b(this,As)&&!b(this,As).classList.contains("hidden")},B(na,Ib,null);let v3=na;var ng,Eb,qc,fd,Tb,ra,Rb,Mb,gd,io,Ra,ir,ig,Wc,_r,sg,so,Pb,Sn,t7,U9,RT,MT,PT,n7,au,po,Cf,NT,H9,tp,OT,DT,FT,LT,BT;const si=class si extends ki{constructor(t){super({...t,name:"highlightEditor"});B(this,Sn);B(this,ng,null);B(this,Eb,0);B(this,qc);B(this,fd,null);B(this,Tb,null);B(this,ra,null);B(this,Rb,null);B(this,Mb,0);B(this,gd,null);B(this,io,null);B(this,Ra,null);B(this,ir,!1);B(this,ig,null);B(this,Wc);B(this,_r,null);B(this,sg,"");B(this,so);B(this,Pb,"");this.color=t.color||si._defaultColor,O(this,so,t.thickness||si._defaultThickness),O(this,Wc,t.opacity||si._defaultOpacity),O(this,qc,t.boxes||null),O(this,Pb,t.methodOfCreation||""),O(this,sg,t.text||""),this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(O(this,ir,!0),D(this,Sn,U9).call(this,t),D(this,Sn,au).call(this)):b(this,qc)&&(O(this,ng,t.anchorNode),O(this,Eb,t.anchorOffset),O(this,Rb,t.focusNode),O(this,Mb,t.focusOffset),D(this,Sn,t7).call(this),D(this,Sn,au).call(this),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}static get _keyboardManager(){const t=si.prototype;return Hn(this,"_keyboardManager",new lx([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:b(this,ir)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:b(this,so),methodOfCreation:b(this,Pb)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,i){var s;ki.initialize(t,i),si._defaultColor||(si._defaultColor=((s=i.highlightColors)==null?void 0:s.values().next().value)||"#fff066")}static updateDefaultParams(t,i){switch(t){case Gn.HIGHLIGHT_DEFAULT_COLOR:si._defaultColor=i;break;case Gn.HIGHLIGHT_THICKNESS:si._defaultThickness=i;break}}translateInPage(t,i){}get toolbarPosition(){return b(this,ig)}updateParams(t,i){switch(t){case Gn.HIGHLIGHT_COLOR:D(this,Sn,RT).call(this,i);break;case Gn.HIGHLIGHT_THICKNESS:D(this,Sn,MT).call(this,i);break}}static get defaultPropertiesToUpdate(){return[[Gn.HIGHLIGHT_DEFAULT_COLOR,si._defaultColor],[Gn.HIGHLIGHT_THICKNESS,si._defaultThickness]]}get propertiesToUpdate(){return[[Gn.HIGHLIGHT_COLOR,this.color||si._defaultColor],[Gn.HIGHLIGHT_THICKNESS,b(this,so)||si._defaultThickness],[Gn.HIGHLIGHT_FREE,b(this,ir)]]}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",O(this,Tb,new v3({editor:this}))]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(D(this,Sn,tp).call(this))}getBaseTranslation(){return[0,0]}getRect(t,i){return super.getRect(t,i,D(this,Sn,tp).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){D(this,Sn,n7).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(D(this,Sn,au).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var s;let i=!1;this.parent&&!t?D(this,Sn,n7).call(this):t&&(D(this,Sn,au).call(this,t),i=!this.parent&&((s=this.div)==null?void 0:s.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),i&&this.select()}rotate(t){var r,a,o;const{drawLayer:i}=this.parent;let s;b(this,ir)?(t=(t-this.rotation+360)%360,s=D(r=si,po,Cf).call(r,b(this,io).box,t)):s=D(a=si,po,Cf).call(a,[this.x,this.y,this.width,this.height],t),i.updateProperties(b(this,Ra),{bbox:s,root:{"data-main-rotation":t}}),i.updateProperties(b(this,_r),{bbox:D(o=si,po,Cf).call(o,b(this,ra).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();b(this,sg)&&(t.setAttribute("aria-label",b(this,sg)),t.setAttribute("role","mark")),b(this,ir)?t.classList.add("free"):this.div.addEventListener("keydown",D(this,Sn,NT).bind(this),{signal:this._uiManager._signal});const i=O(this,gd,document.createElement("div"));t.append(i),i.setAttribute("aria-hidden","true"),i.className="internal",i.style.clipPath=b(this,fd);const[s,r]=this.parentDimensions;return this.setDims(this.width*s,this.height*r),sE(this,b(this,gd),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(b(this,_r),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(b(this,_r),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:D(this,Sn,H9).call(this,!0);break;case 1:case 3:D(this,Sn,H9).call(this,!1);break}}select(){var t;super.select(),b(this,_r)&&((t=this.parent)==null||t.drawLayer.updateProperties(b(this,_r),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),b(this,_r)&&((t=this.parent)==null||t.drawLayer.updateProperties(b(this,_r),{rootClass:{selected:!1}}),b(this,ir)||D(this,Sn,H9).call(this,!1))}get _mustFixPosition(){return!b(this,ir)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(b(this,Ra),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(b(this,_r),{rootClass:{hidden:!t}}))}static startHighlighting(t,i,{target:s,x:r,y:a}){const{x:o,y:l,width:c,height:h}=s.getBoundingClientRect(),u=new AbortController,d=t.combinedSignal(u),f=g=>{u.abort(),D(this,po,LT).call(this,t,g)};window.addEventListener("blur",f,{signal:d}),window.addEventListener("pointerup",f,{signal:d}),window.addEventListener("pointerdown",ms,{capture:!0,passive:!1,signal:d}),window.addEventListener("contextmenu",nl,{signal:d}),s.addEventListener("pointermove",D(this,po,FT).bind(this,t),{signal:d}),this._freeHighlight=new Z8({x:r,y:a},[o,l,c,h],t.scale,this._defaultThickness/2,i,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,i,s){var m,x,p,y;let r=null;if(t instanceof uT){const{data:{quadPoints:w,rect:_,rotation:v,id:C,color:k,opacity:I,popupRef:S},parent:{page:{pageNumber:M}}}=t;r=t={annotationType:wn.HIGHLIGHT,color:Array.from(k),opacity:I,quadPoints:w,boxes:null,pageIndex:M-1,rect:_.slice(0),rotation:v,annotationElementId:C,id:C,deleted:!1,popupRef:S}}else if(t instanceof m4){const{data:{inkLists:w,rect:_,rotation:v,id:C,color:k,borderStyle:{rawWidth:I},popupRef:S},parent:{page:{pageNumber:M}}}=t;r=t={annotationType:wn.HIGHLIGHT,color:Array.from(k),thickness:I,inkLists:w,boxes:null,pageIndex:M-1,rect:_.slice(0),rotation:v,annotationElementId:C,id:C,deleted:!1,popupRef:S}}const{color:a,quadPoints:o,inkLists:l,opacity:c}=t,h=await super.deserialize(t,i,s);h.color=tn.makeHexColor(...a),O(h,Wc,c||1),l&&O(h,so,t.thickness),h._initialData=r;const[u,d]=h.pageDimensions,[f,g]=h.pageTranslation;if(o){const w=O(h,qc,[]);for(let _=0;_<o.length;_+=8)w.push({x:(o[_]-f)/u,y:1-(o[_+1]-g)/d,width:(o[_+2]-o[_])/u,height:(o[_+1]-o[_+5])/d});D(m=h,Sn,t7).call(m),D(x=h,Sn,au).call(x),h.rotate(h.rotation)}else if(l){O(h,ir,!0);const w=l[0],_={x:w[0]-f,y:d-(w[1]-g)},v=new Z8(_,[0,0,u,d],1,b(h,so)/2,!0,.001);for(let I=0,S=w.length;I<S;I+=2)_.x=w[I]-f,_.y=d-(w[I+1]-g),v.add(_);const{id:C,clipPathId:k}=i.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:h.color,"fill-opacity":h._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:v.toSVGPath()}},!0,!0);D(p=h,Sn,U9).call(p,{highlightOutlines:v.getOutlines(),highlightId:C,clipPathId:k}),D(y=h,Sn,au).call(y),h.rotate(h.parentRotation)}return h}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const i=this.getRect(0,0),s=ki._colorManager.convert(this.color),r={annotationType:wn.HIGHLIGHT,color:s,opacity:b(this,Wc),thickness:b(this,so),quadPoints:D(this,Sn,OT).call(this),outlines:D(this,Sn,DT).call(this,i),pageIndex:this.pageIndex,rect:i,rotation:D(this,Sn,tp).call(this),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!D(this,Sn,BT).call(this,r)?null:(r.id=this.annotationElementId,r)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};ng=new WeakMap,Eb=new WeakMap,qc=new WeakMap,fd=new WeakMap,Tb=new WeakMap,ra=new WeakMap,Rb=new WeakMap,Mb=new WeakMap,gd=new WeakMap,io=new WeakMap,Ra=new WeakMap,ir=new WeakMap,ig=new WeakMap,Wc=new WeakMap,_r=new WeakMap,sg=new WeakMap,so=new WeakMap,Pb=new WeakMap,Sn=new WeakSet,t7=function(){const t=new Y8(b(this,qc),.001);O(this,io,t.getOutlines()),[this.x,this.y,this.width,this.height]=b(this,io).box;const i=new Y8(b(this,qc),.0025,.001,this._uiManager.direction==="ltr");O(this,ra,i.getOutlines());const{lastPoint:s}=b(this,ra);O(this,ig,[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height])},U9=function({highlightOutlines:t,highlightId:i,clipPathId:s}){var u,d;if(O(this,io,t),O(this,ra,t.getNewOutline(b(this,so)/2+1.5,.0025)),i>=0)O(this,Ra,i),O(this,fd,s),this.parent.drawLayer.finalizeDraw(i,{bbox:t.box,path:{d:t.toSVGPath()}}),O(this,_r,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:b(this,ra).box,path:{d:b(this,ra).toSVGPath()}},!0));else if(this.parent){const f=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(b(this,Ra),{bbox:D(u=si,po,Cf).call(u,b(this,io).box,(f-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(b(this,_r),{bbox:D(d=si,po,Cf).call(d,b(this,ra).box,f),path:{d:b(this,ra).toSVGPath()}})}const[a,o,l,c]=t.box;switch(this.rotation){case 0:this.x=a,this.y=o,this.width=l,this.height=c;break;case 90:{const[f,g]=this.parentDimensions;this.x=o,this.y=1-a,this.width=l*g/f,this.height=c*f/g;break}case 180:this.x=1-a,this.y=1-o,this.width=l,this.height=c;break;case 270:{const[f,g]=this.parentDimensions;this.x=1-o,this.y=a,this.width=l*g/f,this.height=c*f/g;break}}const{lastPoint:h}=b(this,ra);O(this,ig,[(h[0]-a)/l,(h[1]-o)/c])},RT=function(t){const i=(a,o)=>{var l,c;this.color=a,O(this,Wc,o),(l=this.parent)==null||l.drawLayer.updateProperties(b(this,Ra),{root:{fill:a,"fill-opacity":o}}),(c=b(this,Tb))==null||c.updateColor(a)},s=this.color,r=b(this,Wc);this.addCommands({cmd:i.bind(this,t,si._defaultOpacity),undo:i.bind(this,s,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Gn.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(t)},!0)},MT=function(t){const i=b(this,so),s=r=>{O(this,so,r),D(this,Sn,PT).call(this,r)};this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Gn.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},PT=function(t){if(!b(this,ir))return;D(this,Sn,U9).call(this,{highlightOutlines:b(this,io).getNewOutline(t/2)}),this.fixAndSetPosition();const[i,s]=this.parentDimensions;this.setDims(this.width*i,this.height*s)},n7=function(){b(this,Ra)===null||!this.parent||(this.parent.drawLayer.remove(b(this,Ra)),O(this,Ra,null),this.parent.drawLayer.remove(b(this,_r)),O(this,_r,null))},au=function(t=this.parent){b(this,Ra)===null&&({id:Mr(this,Ra)._,clipPathId:Mr(this,fd)._}=t.drawLayer.draw({bbox:b(this,io).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":b(this,Wc)},rootClass:{highlight:!0,free:b(this,ir)},path:{d:b(this,io).toSVGPath()}},!1,!0),O(this,_r,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:b(this,ir)},bbox:b(this,ra).box,path:{d:b(this,ra).toSVGPath()}},b(this,ir))),b(this,gd)&&(b(this,gd).style.clipPath=b(this,fd)))},po=new WeakSet,Cf=function([t,i,s,r],a){switch(a){case 90:return[1-i-r,t,r,s];case 180:return[1-t-s,1-i-r,s,r];case 270:return[i,1-t-s,r,s]}return[t,i,s,r]},NT=function(t){si._keyboardManager.exec(this,t)},H9=function(t){if(!b(this,ng))return;const i=window.getSelection();t?i.setPosition(b(this,ng),b(this,Eb)):i.setPosition(b(this,Rb),b(this,Mb))},tp=function(){return b(this,ir)?this.rotation:0},OT=function(){if(b(this,ir))return null;const[t,i]=this.pageDimensions,[s,r]=this.pageTranslation,a=b(this,qc),o=new Float32Array(a.length*8);let l=0;for(const{x:c,y:h,width:u,height:d}of a){const f=c*t+s,g=(1-h)*i+r;o[l]=o[l+4]=f,o[l+1]=o[l+3]=g,o[l+2]=o[l+6]=f+u*t,o[l+5]=o[l+7]=g-d*i,l+=8}return o},DT=function(t){return b(this,io).serialize(t,D(this,Sn,tp).call(this))},FT=function(t,i){this._freeHighlight.add(i)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},LT=function(t,i){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(i,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},BT=function(t){const{color:i}=this._initialData;return t.color.some((s,r)=>s!==i[r])},B(si,po),He(si,"_defaultColor",null),He(si,"_defaultOpacity",1),He(si,"_defaultThickness",12),He(si,"_type","highlight"),He(si,"_editorType",wn.HIGHLIGHT),He(si,"_freeHighlightId",-1),He(si,"_freeHighlight",null),He(si,"_freeHighlightClipId","");let k3=si;var md;class UT{constructor(){B(this,md,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,i]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,i)}updateSVGProperty(e,t){b(this,md)[e]=t}toSVGProperties(){const e=b(this,md);return O(this,md,Object.create(null)),{root:e}}reset(){O(this,md,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){mi("Not implemented")}}md=new WeakMap;var Ma,rg,Ms,pd,bd,ch,hh,uh,xd,Qn,i7,s7,r7,np,HT,z9,ip,Af;const Gt=class Gt extends ki{constructor(t){super(t);B(this,Qn);B(this,Ma,null);B(this,rg);He(this,"_drawId",null);O(this,rg,t.mustBeCommitted||!1),this._addOutlines(t)}_addOutlines(t){t.drawOutlines&&(D(this,Qn,i7).call(this,t),D(this,Qn,np).call(this))}static _mergeSVGProperties(t,i){const s=new Set(Object.keys(t));for(const[r,a]of Object.entries(i))s.has(r)?Object.assign(t[r],a):t[r]=a;return t}static getDefaultDrawingOptions(t){mi("Not implemented")}static get typesMap(){mi("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,i){const s=this.typesMap.get(t);s&&this._defaultDrawingOptions.updateProperty(s,i),this._currentParent&&(b(Gt,Ms).updateProperty(s,i),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,i){const s=this.constructor.typesMap.get(t);s&&this._updateProperty(t,s,i)}static get defaultPropertiesToUpdate(){const t=[],i=this._defaultDrawingOptions;for(const[s,r]of this.typesMap)t.push([s,i[r]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:i}=this;for(const[s,r]of this.constructor.typesMap)t.push([s,i[r]]);return t}_updateProperty(t,i,s){const r=this._drawingOptions,a=r[i],o=l=>{var h;r.updateProperty(i,l);const c=b(this,Ma).updateProperty(i,l);c&&D(this,Qn,ip).call(this,c),(h=this.parent)==null||h.drawLayer.updateProperties(this._drawId,r.toSVGProperties())};this.addCommands({cmd:o.bind(this,s),undo:o.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,Gt._mergeSVGProperties(b(this,Ma).getPathResizingSVGProperties(D(this,Qn,z9).call(this)),{bbox:D(this,Qn,Af).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,Gt._mergeSVGProperties(b(this,Ma).getPathResizedSVGProperties(D(this,Qn,z9).call(this)),{bbox:D(this,Qn,Af).call(this)}))}_onTranslating(t,i){var s;(s=this.parent)==null||s.drawLayer.updateProperties(this._drawId,{bbox:D(this,Qn,Af).call(this)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,Gt._mergeSVGProperties(b(this,Ma).getPathTranslatedSVGProperties(D(this,Qn,z9).call(this),this.parentDimensions),{bbox:D(this,Qn,Af).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,b(this,rg)&&(O(this,rg,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){D(this,Qn,r7).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(D(this,Qn,np).call(this),D(this,Qn,ip).call(this,b(this,Ma).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var s;let i=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),D(this,Qn,r7).call(this)):t&&(this._uiManager.addShouldRescale(this),D(this,Qn,np).call(this,t),i=!this.parent&&((s=this.div)==null?void 0:s.classList.contains("selectedEditor"))),super.setParent(t),i&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Gt._mergeSVGProperties({bbox:D(this,Qn,Af).call(this)},b(this,Ma).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&D(this,Qn,ip).call(this,b(this,Ma).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,i;this._isCopy&&(t=this.x,i=this.y);const s=super.render();s.classList.add("draw");const r=document.createElement("div");s.append(r),r.setAttribute("aria-hidden","true"),r.className="internal";const[a,o]=this.parentDimensions;return this.setDims(this.width*a,this.height*o),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,i),s}static createDrawerInstance(t,i,s,r,a){mi("Not implemented")}static startDrawing(t,i,s,r){var x;const{target:a,offsetX:o,offsetY:l,pointerId:c,pointerType:h}=r;if(b(Gt,hh)&&b(Gt,hh)!==h)return;const{viewport:{rotation:u}}=t,{width:d,height:f}=a.getBoundingClientRect(),g=O(Gt,pd,new AbortController),m=t.combinedSignal(g);if(b(Gt,ch)||O(Gt,ch,c),b(Gt,hh)??O(Gt,hh,h),window.addEventListener("pointerup",p=>{var y;b(Gt,ch)===p.pointerId?this._endDraw(p):(y=b(Gt,uh))==null||y.delete(p.pointerId)},{signal:m}),window.addEventListener("pointercancel",p=>{var y;b(Gt,ch)===p.pointerId?this._currentParent.endDrawingSession():(y=b(Gt,uh))==null||y.delete(p.pointerId)},{signal:m}),window.addEventListener("pointerdown",p=>{b(Gt,hh)===p.pointerType&&((b(Gt,uh)||O(Gt,uh,new Set)).add(p.pointerId),b(Gt,Ms).isCancellable()&&(b(Gt,Ms).removeLastElement(),b(Gt,Ms).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:m}),window.addEventListener("contextmenu",nl,{signal:m}),a.addEventListener("pointermove",this._drawMove.bind(this),{signal:m}),a.addEventListener("touchmove",p=>{p.timeStamp===b(Gt,xd)&&ms(p)},{signal:m}),t.toggleDrawing(),(x=i._editorUndoBar)==null||x.hide(),b(Gt,Ms)){t.drawLayer.updateProperties(this._currentDrawId,b(Gt,Ms).startNew(o,l,d,f,u));return}i.updateUIForDefaultProperties(this),O(Gt,Ms,this.createDrawerInstance(o,l,d,f,u)),O(Gt,bd,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(b(Gt,bd).toSVGProperties(),b(Gt,Ms).defaultSVGProperties),!0,!1)}static _drawMove(t){var a;if(O(Gt,xd,-1),!b(Gt,Ms))return;const{offsetX:i,offsetY:s,pointerId:r}=t;if(b(Gt,ch)===r){if(((a=b(Gt,uh))==null?void 0:a.size)>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,b(Gt,Ms).add(i,s)),O(Gt,xd,t.timeStamp),ms(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,O(Gt,Ms,null),O(Gt,bd,null),O(Gt,hh,null),O(Gt,xd,NaN)),b(Gt,pd)&&(b(Gt,pd).abort(),O(Gt,pd,null),O(Gt,ch,NaN),O(Gt,uh,null))}static _endDraw(t){const i=this._currentParent;if(i){if(i.toggleDrawing(!0),this._cleanup(!1),(t==null?void 0:t.target)===i.div&&i.drawLayer.updateProperties(this._currentDrawId,b(Gt,Ms).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const s=b(Gt,Ms),r=this._currentDrawId,a=s.getLastElement();i.addCommands({cmd:()=>{i.drawLayer.updateProperties(r,s.setLastElement(a))},undo:()=>{i.drawLayer.updateProperties(r,s.removeLastElement())},mustExec:!1,type:Gn.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const i=this._currentParent;if(!i)return null;if(i.toggleDrawing(!0),i.cleanUndoStack(Gn.DRAW_STEP),!b(Gt,Ms).isEmpty()){const{pageDimensions:[s,r],scale:a}=i,o=i.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:b(Gt,Ms).getOutlines(s*a,r*a,a,this._INNER_MARGIN),drawingOptions:b(Gt,bd),mustBeCommitted:!t});return this._cleanup(!0),o}return i.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,i,s,r,a,o){mi("Not implemented")}static async deserialize(t,i,s){var u,d;const{rawDims:{pageWidth:r,pageHeight:a,pageX:o,pageY:l}}=i.viewport,c=this.deserializeDraw(o,l,r,a,this._INNER_MARGIN,t),h=await super.deserialize(t,i,s);return h.createDrawingOptions(t),D(u=h,Qn,i7).call(u,{drawOutlines:c}),D(d=h,Qn,np).call(d),h.onScaleChanging(),h.rotate(),h}serializeDraw(t){const[i,s]=this.pageTranslation,[r,a]=this.pageDimensions;return b(this,Ma).serialize([i,s,r,a],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};Ma=new WeakMap,rg=new WeakMap,Ms=new WeakMap,pd=new WeakMap,bd=new WeakMap,ch=new WeakMap,hh=new WeakMap,uh=new WeakMap,xd=new WeakMap,Qn=new WeakSet,i7=function({drawOutlines:t,drawId:i,drawingOptions:s}){O(this,Ma,t),this._drawingOptions||(this._drawingOptions=s),this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),i>=0?(this._drawId=i,this.parent.drawLayer.finalizeDraw(i,t.defaultProperties)):this._drawId=D(this,Qn,s7).call(this,t,this.parent),D(this,Qn,ip).call(this,t.box)},s7=function(t,i){const{id:s}=i.drawLayer.draw(Gt._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return s},r7=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},np=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=D(this,Qn,s7).call(this,b(this,Ma),t)}},HT=function([t,i,s,r]){const{parentDimensions:[a,o],rotation:l}=this;switch(l){case 90:return[i,1-t,s*(o/a),r*(a/o)];case 180:return[1-t,1-i,s,r];case 270:return[1-i,t,s*(o/a),r*(a/o)];default:return[t,i,s,r]}},z9=function(){const{x:t,y:i,width:s,height:r,parentDimensions:[a,o],rotation:l}=this;switch(l){case 90:return[1-i,t,s*(a/o),r*(o/a)];case 180:return[1-t,1-i,s,r];case 270:return[i,1-t,s*(a/o),r*(o/a)];default:return[t,i,s,r]}},ip=function(t){if([this.x,this.y,this.width,this.height]=D(this,Qn,HT).call(this,t),this.div){this.fixAndSetPosition();const[i,s]=this.parentDimensions;this.setDims(this.width*i,this.height*s)}this._onResized()},Af=function(){const{x:t,y:i,width:s,height:r,rotation:a,parentRotation:o,parentDimensions:[l,c]}=this;switch((a*4+o)/90){case 1:return[1-i-r,t,r,s];case 2:return[1-t-s,1-i-r,s,r];case 3:return[i,1-t-s,r,s];case 4:return[t,i-s*(l/c),r*(c/l),s*(l/c)];case 5:return[1-i,t,s*(l/c),r*(c/l)];case 6:return[1-t-r*(c/l),1-i,r*(c/l),s*(l/c)];case 7:return[i-s*(l/c),1-t-r*(c/l),s*(l/c),r*(c/l)];case 8:return[t-s,i-r,s,r];case 9:return[1-i,t-s,r,s];case 10:return[1-t,1-i,s,r];case 11:return[i-r,1-t,r,s];case 12:return[t-r*(c/l),i,r*(c/l),s*(l/c)];case 13:return[1-i-s*(l/c),t-r*(c/l),s*(l/c),r*(c/l)];case 14:return[1-t,1-i-s*(l/c),r*(c/l),s*(l/c)];case 15:return[i,1-t,s*(l/c),r*(c/l)];default:return[t,i,s,r]}},He(Gt,"_currentDrawId",-1),He(Gt,"_currentParent",null),B(Gt,Ms,null),B(Gt,pd,null),B(Gt,bd,null),B(Gt,ch,NaN),B(Gt,hh,null),B(Gt,uh,null),B(Gt,xd,NaN),He(Gt,"_INNER_MARGIN",3);let C3=Gt;var Ll,Ps,Ns,yd,ag,Fr,sr,ro,wd,_d,vd,og,j9;class aU{constructor(e,t,i,s,r,a){B(this,og);B(this,Ll,new Float64Array(6));B(this,Ps);B(this,Ns);B(this,yd);B(this,ag);B(this,Fr);B(this,sr,"");B(this,ro,0);B(this,wd,new hx);B(this,_d);B(this,vd);O(this,_d,i),O(this,vd,s),O(this,yd,r),O(this,ag,a),[e,t]=D(this,og,j9).call(this,e,t);const o=O(this,Ps,[NaN,NaN,NaN,NaN,e,t]);O(this,Fr,[e,t]),O(this,Ns,[{line:o,points:b(this,Fr)}]),b(this,Ll).set(o,0)}updateProperty(e,t){e==="stroke-width"&&O(this,ag,t)}isEmpty(){return!b(this,Ns)||b(this,Ns).length===0}isCancellable(){return b(this,Fr).length<=10}add(e,t){[e,t]=D(this,og,j9).call(this,e,t);const[i,s,r,a]=b(this,Ll).subarray(2,6),o=e-r,l=t-a;return Math.hypot(b(this,_d)*o,b(this,vd)*l)<=2?null:(b(this,Fr).push(e,t),isNaN(i)?(b(this,Ll).set([r,a,e,t],2),b(this,Ps).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(b(this,Ll)[0])&&b(this,Ps).splice(6,6),b(this,Ll).set([i,s,r,a,e,t],0),b(this,Ps).push(...Bt.createBezierPoints(i,s,r,a,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const i=this.add(e,t);return i||(b(this,Fr).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,i,s,r){O(this,_d,i),O(this,vd,s),O(this,yd,r),[e,t]=D(this,og,j9).call(this,e,t);const a=O(this,Ps,[NaN,NaN,NaN,NaN,e,t]);O(this,Fr,[e,t]);const o=b(this,Ns).at(-1);return o&&(o.line=new Float32Array(o.line),o.points=new Float32Array(o.points)),b(this,Ns).push({line:a,points:b(this,Fr)}),b(this,Ll).set(a,0),O(this,ro,0),this.toSVGPath(),null}getLastElement(){return b(this,Ns).at(-1)}setLastElement(e){return b(this,Ns)?(b(this,Ns).push(e),O(this,Ps,e.line),O(this,Fr,e.points),O(this,ro,0),{path:{d:this.toSVGPath()}}):b(this,wd).setLastElement(e)}removeLastElement(){if(!b(this,Ns))return b(this,wd).removeLastElement();b(this,Ns).pop(),O(this,sr,"");for(let e=0,t=b(this,Ns).length;e<t;e++){const{line:i,points:s}=b(this,Ns)[e];O(this,Ps,i),O(this,Fr,s),O(this,ro,0),this.toSVGPath()}return{path:{d:b(this,sr)}}}toSVGPath(){const e=Bt.svgRound(b(this,Ps)[4]),t=Bt.svgRound(b(this,Ps)[5]);if(b(this,Fr).length===2)return O(this,sr,`${b(this,sr)} M ${e} ${t} Z`),b(this,sr);if(b(this,Fr).length<=6){const s=b(this,sr).lastIndexOf("M");O(this,sr,`${b(this,sr).slice(0,s)} M ${e} ${t}`),O(this,ro,6)}if(b(this,Fr).length===4){const s=Bt.svgRound(b(this,Ps)[10]),r=Bt.svgRound(b(this,Ps)[11]);return O(this,sr,`${b(this,sr)} L ${s} ${r}`),O(this,ro,12),b(this,sr)}const i=[];b(this,ro)===0&&(i.push(`M ${e} ${t}`),O(this,ro,6));for(let s=b(this,ro),r=b(this,Ps).length;s<r;s+=6){const[a,o,l,c,h,u]=b(this,Ps).slice(s,s+6).map(Bt.svgRound);i.push(`C${a} ${o} ${l} ${c} ${h} ${u}`)}return O(this,sr,b(this,sr)+i.join(" ")),O(this,ro,b(this,Ps).length),b(this,sr)}getOutlines(e,t,i,s){const r=b(this,Ns).at(-1);return r.line=new Float32Array(r.line),r.points=new Float32Array(r.points),b(this,wd).build(b(this,Ns),e,t,i,b(this,yd),b(this,ag),s),O(this,Ll,null),O(this,Ps,null),O(this,Ns,null),O(this,sr,null),b(this,wd)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}Ll=new WeakMap,Ps=new WeakMap,Ns=new WeakMap,yd=new WeakMap,ag=new WeakMap,Fr=new WeakMap,sr=new WeakMap,ro=new WeakMap,wd=new WeakMap,_d=new WeakMap,vd=new WeakMap,og=new WeakSet,j9=function(e,t){return Bt._normalizePoint(e,t,b(this,_d),b(this,vd),b(this,yd))};var Lr,Nb,Ob,Pa,Bl,Ul,lg,cg,kd,lr,fc,zT,jT,GT;class hx extends Bt{constructor(){super(...arguments);B(this,lr);B(this,Lr);B(this,Nb,0);B(this,Ob);B(this,Pa);B(this,Bl);B(this,Ul);B(this,lg);B(this,cg);B(this,kd)}build(t,i,s,r,a,o,l){O(this,Bl,i),O(this,Ul,s),O(this,lg,r),O(this,cg,a),O(this,kd,o),O(this,Ob,l??0),O(this,Pa,t),D(this,lr,jT).call(this)}get thickness(){return b(this,kd)}setLastElement(t){return b(this,Pa).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return b(this,Pa).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:i}of b(this,Pa)){if(t.push(`M${Bt.svgRound(i[4])} ${Bt.svgRound(i[5])}`),i.length===6){t.push("Z");continue}if(i.length===12&&isNaN(i[6])){t.push(`L${Bt.svgRound(i[10])} ${Bt.svgRound(i[11])}`);continue}for(let s=6,r=i.length;s<r;s+=6){const[a,o,l,c,h,u]=i.subarray(s,s+6).map(Bt.svgRound);t.push(`C${a} ${o} ${l} ${c} ${h} ${u}`)}}return t.join("")}serialize([t,i,s,r],a){const o=[],l=[],[c,h,u,d]=D(this,lr,zT).call(this);let f,g,m,x,p,y,w,_,v;switch(b(this,cg)){case 0:v=Bt._rescale,f=t,g=i+r,m=s,x=-r,p=t+c*s,y=i+(1-h-d)*r,w=t+(c+u)*s,_=i+(1-h)*r;break;case 90:v=Bt._rescaleAndSwap,f=t,g=i,m=s,x=r,p=t+h*s,y=i+c*r,w=t+(h+d)*s,_=i+(c+u)*r;break;case 180:v=Bt._rescale,f=t+s,g=i,m=-s,x=r,p=t+(1-c-u)*s,y=i+h*r,w=t+(1-c)*s,_=i+(h+d)*r;break;case 270:v=Bt._rescaleAndSwap,f=t+s,g=i+r,m=-s,x=-r,p=t+(1-h-d)*s,y=i+(1-c-u)*r,w=t+(1-h)*s,_=i+(1-c)*r;break}for(const{line:C,points:k}of b(this,Pa))o.push(v(C,f,g,m,x,a?new Array(C.length):null)),l.push(v(k,f,g,m,x,a?new Array(k.length):null));return{lines:o,points:l,rect:[p,y,w,_]}}static deserialize(t,i,s,r,a,{paths:{lines:o,points:l},rotation:c,thickness:h}){const u=[];let d,f,g,m,x;switch(c){case 0:x=Bt._rescale,d=-t/s,f=i/r+1,g=1/s,m=-1/r;break;case 90:x=Bt._rescaleAndSwap,d=-i/r,f=-t/s,g=1/r,m=1/s;break;case 180:x=Bt._rescale,d=t/s+1,f=-i/r,g=-1/s,m=1/r;break;case 270:x=Bt._rescaleAndSwap,d=i/r+1,f=t/s+1,g=-1/r,m=-1/s;break}if(!o){o=[];for(const y of l){const w=y.length;if(w===2){o.push(new Float32Array([NaN,NaN,NaN,NaN,y[0],y[1]]));continue}if(w===4){o.push(new Float32Array([NaN,NaN,NaN,NaN,y[0],y[1],NaN,NaN,NaN,NaN,y[2],y[3]]));continue}const _=new Float32Array(3*(w-2));o.push(_);let[v,C,k,I]=y.subarray(0,4);_.set([NaN,NaN,NaN,NaN,v,C],0);for(let S=4;S<w;S+=2){const M=y[S],N=y[S+1];_.set(Bt.createBezierPoints(v,C,k,I,M,N),(S-2)*3),[v,C,k,I]=[k,I,M,N]}}}for(let y=0,w=o.length;y<w;y++)u.push({line:x(o[y].map(_=>_??NaN),d,f,g,m),points:x(l[y].map(_=>_??NaN),d,f,g,m)});const p=new this.prototype.constructor;return p.build(u,s,r,1,c,h,a),p}get box(){return b(this,Lr)}updateProperty(t,i){return t==="stroke-width"?D(this,lr,GT).call(this,i):null}updateParentDimensions([t,i],s){const[r,a]=D(this,lr,fc).call(this);O(this,Bl,t),O(this,Ul,i),O(this,lg,s);const[o,l]=D(this,lr,fc).call(this),c=o-r,h=l-a,u=b(this,Lr);return u[0]-=c,u[1]-=h,u[2]+=2*c,u[3]+=2*h,u}updateRotation(t){return O(this,Nb,t),{path:{transform:this.rotationTransform}}}get viewBox(){return b(this,Lr).map(Bt.svgRound).join(" ")}get defaultProperties(){const[t,i]=b(this,Lr);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Bt.svgRound(t)} ${Bt.svgRound(i)}`}}}get rotationTransform(){const[,,t,i]=b(this,Lr);let s=0,r=0,a=0,o=0,l=0,c=0;switch(b(this,Nb)){case 90:r=i/t,a=-t/i,l=t;break;case 180:s=-1,o=-1,l=t,c=i;break;case 270:r=-i/t,a=t/i,c=i;break;default:return""}return`matrix(${s} ${r} ${a} ${o} ${Bt.svgRound(l)} ${Bt.svgRound(c)})`}getPathResizingSVGProperties([t,i,s,r]){const[a,o]=D(this,lr,fc).call(this),[l,c,h,u]=b(this,Lr);if(Math.abs(h-a)<=Bt.PRECISION||Math.abs(u-o)<=Bt.PRECISION){const x=t+s/2-(l+h/2),p=i+r/2-(c+u/2);return{path:{"transform-origin":`${Bt.svgRound(t)} ${Bt.svgRound(i)}`,transform:`${this.rotationTransform} translate(${x} ${p})`}}}const d=(s-2*a)/(h-2*a),f=(r-2*o)/(u-2*o),g=h/s,m=u/r;return{path:{"transform-origin":`${Bt.svgRound(l)} ${Bt.svgRound(c)}`,transform:`${this.rotationTransform} scale(${g} ${m}) translate(${Bt.svgRound(a)} ${Bt.svgRound(o)}) scale(${d} ${f}) translate(${Bt.svgRound(-a)} ${Bt.svgRound(-o)})`}}}getPathResizedSVGProperties([t,i,s,r]){const[a,o]=D(this,lr,fc).call(this),l=b(this,Lr),[c,h,u,d]=l;if(l[0]=t,l[1]=i,l[2]=s,l[3]=r,Math.abs(u-a)<=Bt.PRECISION||Math.abs(d-o)<=Bt.PRECISION){const p=t+s/2-(c+u/2),y=i+r/2-(h+d/2);for(const{line:w,points:_}of b(this,Pa))Bt._translate(w,p,y,w),Bt._translate(_,p,y,_);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Bt.svgRound(t)} ${Bt.svgRound(i)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const f=(s-2*a)/(u-2*a),g=(r-2*o)/(d-2*o),m=-f*(c+a)+t+a,x=-g*(h+o)+i+o;if(f!==1||g!==1||m!==0||x!==0)for(const{line:p,points:y}of b(this,Pa))Bt._rescale(p,m,x,f,g,p),Bt._rescale(y,m,x,f,g,y);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Bt.svgRound(t)} ${Bt.svgRound(i)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,i],s){const[r,a]=s,o=b(this,Lr),l=t-o[0],c=i-o[1];if(b(this,Bl)===r&&b(this,Ul)===a)for(const{line:h,points:u}of b(this,Pa))Bt._translate(h,l,c,h),Bt._translate(u,l,c,u);else{const h=b(this,Bl)/r,u=b(this,Ul)/a;O(this,Bl,r),O(this,Ul,a);for(const{line:d,points:f}of b(this,Pa))Bt._rescale(d,l,c,h,u,d),Bt._rescale(f,l,c,h,u,f);o[2]*=h,o[3]*=u}return o[0]=t,o[1]=i,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${Bt.svgRound(t)} ${Bt.svgRound(i)}`}}}get defaultSVGProperties(){const t=b(this,Lr);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${Bt.svgRound(t[0])} ${Bt.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}Lr=new WeakMap,Nb=new WeakMap,Ob=new WeakMap,Pa=new WeakMap,Bl=new WeakMap,Ul=new WeakMap,lg=new WeakMap,cg=new WeakMap,kd=new WeakMap,lr=new WeakSet,fc=function(t=b(this,kd)){const i=b(this,Ob)+t/2*b(this,lg);return b(this,cg)%180===0?[i/b(this,Bl),i/b(this,Ul)]:[i/b(this,Ul),i/b(this,Bl)]},zT=function(){const[t,i,s,r]=b(this,Lr),[a,o]=D(this,lr,fc).call(this,0);return[t+a,i+o,s-2*a,r-2*o]},jT=function(){const t=O(this,Lr,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:r}of b(this,Pa)){if(r.length<=12){for(let l=4,c=r.length;l<c;l+=6)tn.pointBoundingBox(r[l],r[l+1],t);continue}let a=r[4],o=r[5];for(let l=6,c=r.length;l<c;l+=6){const[h,u,d,f,g,m]=r.subarray(l,l+6);tn.bezierBoundingBox(a,o,h,u,d,f,g,m,t),a=g,o=m}}const[i,s]=D(this,lr,fc).call(this);t[0]=Hr(t[0]-i,0,1),t[1]=Hr(t[1]-s,0,1),t[2]=Hr(t[2]+i,0,1),t[3]=Hr(t[3]+s,0,1),t[2]-=t[0],t[3]-=t[1]},GT=function(t){const[i,s]=D(this,lr,fc).call(this);O(this,kd,t);const[r,a]=D(this,lr,fc).call(this),[o,l]=[r-i,a-s],c=b(this,Lr);return c[0]-=o,c[1]-=l,c[2]+=2*o,c[3]+=2*l,c};class Q5 extends UT{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:ki._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??(t=this["stroke-width"]),t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new Q5(this._viewParameters);return e.updateAll(this),e}}var T5,VT;const Gf=class Gf extends C3{constructor(t){super({...t,name:"inkEditor"});B(this,T5);this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,i){ki.initialize(t,i),this._defaultDrawingOptions=new Q5(i.viewParameters)}static getDefaultDrawingOptions(t){const i=this._defaultDrawingOptions.clone();return i.updateProperties(t),i}static get supportMultipleDrawings(){return!0}static get typesMap(){return Hn(this,"typesMap",new Map([[Gn.INK_THICKNESS,"stroke-width"],[Gn.INK_COLOR,"stroke"],[Gn.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,i,s,r,a){return new aU(t,i,s,r,a,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,i,s,r,a,o){return hx.deserialize(t,i,s,r,a,o)}static async deserialize(t,i,s){let r=null;if(t instanceof m4){const{data:{inkLists:o,rect:l,rotation:c,id:h,color:u,opacity:d,borderStyle:{rawWidth:f},popupRef:g},parent:{page:{pageNumber:m}}}=t;r=t={annotationType:wn.INK,color:Array.from(u),thickness:f,opacity:d,paths:{points:o},boxes:null,pageIndex:m-1,rect:l.slice(0),rotation:c,annotationElementId:h,id:h,deleted:!1,popupRef:g}}const a=await super.deserialize(t,i,s);return a._initialData=r,a}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:i,parent:s}=this;i.updateSVGProperty("stroke-width"),s.drawLayer.updateProperties(t,i.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:i,opacity:s}){this._drawingOptions=Gf.getDefaultDrawingOptions({stroke:tn.makeHexColor(...t),"stroke-width":i,"stroke-opacity":s})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:i,points:s,rect:r}=this.serializeDraw(t),{_drawingOptions:{stroke:a,"stroke-opacity":o,"stroke-width":l}}=this,c={annotationType:wn.INK,color:ki._colorManager.convert(a),opacity:o,thickness:l,paths:{lines:i,points:s},pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?(c.isCopy=!0,c):this.annotationElementId&&!D(this,T5,VT).call(this,c)?null:(c.id=this.annotationElementId,c)}renderAnnotationElement(t){const{points:i,rect:s}=this.serializeDraw(!1);return t.updateEdited({rect:s,thickness:this._drawingOptions["stroke-width"],points:i}),null}};T5=new WeakSet,VT=function(t){const{color:i,thickness:s,opacity:r,pageIndex:a}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||t.color.some((o,l)=>o!==i[l])||t.thickness!==s||t.opacity!==r||t.pageIndex!==a},He(Gf,"_type","ink"),He(Gf,"_editorType",wn.INK),He(Gf,"_defaultDrawingOptions",null);let a7=Gf;class o7 extends hx{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const Bx=8,Cm=3;var Cd,ai,l7,Ho,qT,WT,c7,G9,KT,XT,YT,h7,u7,JT;class $c{static extractContoursFromText(e,{fontFamily:t,fontStyle:i,fontWeight:s},r,a,o,l){let c=new OffscreenCanvas(1,1),h=c.getContext("2d",{alpha:!1});const u=200,d=h.font=`${i} ${s} ${u}px ${t}`,{actualBoundingBoxLeft:f,actualBoundingBoxRight:g,actualBoundingBoxAscent:m,actualBoundingBoxDescent:x,fontBoundingBoxAscent:p,fontBoundingBoxDescent:y,width:w}=h.measureText(e),_=1.5,v=Math.ceil(Math.max(Math.abs(f)+Math.abs(g)||0,w)*_),C=Math.ceil(Math.max(Math.abs(m)+Math.abs(x)||u,Math.abs(p)+Math.abs(y)||u)*_);c=new OffscreenCanvas(v,C),h=c.getContext("2d",{alpha:!0,willReadFrequently:!0}),h.font=d,h.filter="grayscale(1)",h.fillStyle="white",h.fillRect(0,0,v,C),h.fillStyle="black",h.fillText(e,v*(_-1)/2,C*(3-_)/2);const k=D(this,ai,h7).call(this,h.getImageData(0,0,v,C).data),I=D(this,ai,YT).call(this,k),S=D(this,ai,u7).call(this,I),M=D(this,ai,c7).call(this,k,v,C,S);return this.processDrawnLines({lines:{curves:M,width:v,height:C},pageWidth:r,pageHeight:a,rotation:o,innerMargin:l,mustSmooth:!0,areContours:!0})}static process(e,t,i,s,r){const[a,o,l]=D(this,ai,JT).call(this,e),[c,h]=D(this,ai,XT).call(this,a,o,l,Math.hypot(o,l)*b(this,Cd).sigmaSFactor,b(this,Cd).sigmaR,b(this,Cd).kernelSize),u=D(this,ai,u7).call(this,h),d=D(this,ai,c7).call(this,c,o,l,u);return this.processDrawnLines({lines:{curves:d,width:o,height:l},pageWidth:t,pageHeight:i,rotation:s,innerMargin:r,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:i,rotation:s,innerMargin:r,mustSmooth:a,areContours:o}){s%180!==0&&([t,i]=[i,t]);const{curves:l,width:c,height:h}=e,u=e.thickness??0,d=[],f=Math.min(t/c,i/h),g=f/t,m=f/i,x=[];for(const{points:y}of l){const w=a?D(this,ai,KT).call(this,y):y;if(!w)continue;x.push(w);const _=w.length,v=new Float32Array(_),C=new Float32Array(3*(_===2?2:_-2));if(d.push({line:C,points:v}),_===2){v[0]=w[0]*g,v[1]=w[1]*m,C.set([NaN,NaN,NaN,NaN,v[0],v[1]],0);continue}let[k,I,S,M]=w;k*=g,I*=m,S*=g,M*=m,v.set([k,I,S,M],0),C.set([NaN,NaN,NaN,NaN,k,I],0);for(let N=4;N<_;N+=2){const F=v[N]=w[N]*g,H=v[N+1]=w[N+1]*m;C.set(Bt.createBezierPoints(k,I,S,M,F,H),(N-2)*3),[k,I,S,M]=[S,M,F,H]}}if(d.length===0)return null;const p=o?new o7:new hx;return p.build(d,t,i,1,s,o?0:u,r),{outline:p,newCurves:x,areContours:o,thickness:u,width:c,height:h}}static async compressSignature({outlines:e,areContours:t,thickness:i,width:s,height:r}){let a=1/0,o=-1/0,l=0;for(const w of e){l+=w.length;for(let _=2,v=w.length;_<v;_++){const C=w[_]-w[_-2];a=Math.min(a,C),o=Math.max(o,C)}}let c;a>=-128&&o<=127?c=Int8Array:a>=-32768&&o<=32767?c=Int16Array:c=Int32Array;const h=e.length,u=Bx+Cm*h,d=new Uint32Array(u);let f=0;d[f++]=u*Uint32Array.BYTES_PER_ELEMENT+(l-2*h)*c.BYTES_PER_ELEMENT,d[f++]=0,d[f++]=s,d[f++]=r,d[f++]=t?0:1,d[f++]=Math.max(0,Math.floor(i??0)),d[f++]=h,d[f++]=c.BYTES_PER_ELEMENT;for(const w of e)d[f++]=w.length-2,d[f++]=w[0],d[f++]=w[1];const g=new CompressionStream("deflate-raw"),m=g.writable.getWriter();await m.ready,m.write(d);const x=c.prototype.constructor;for(const w of e){const _=new x(w.length-2);for(let v=2,C=w.length;v<C;v++)_[v-2]=w[v]-w[v-2];m.write(_)}m.close();const p=await new Response(g.readable).arrayBuffer(),y=new Uint8Array(p);return ZI(y)}static async decompressSignature(e){try{const t=TL(e),{readable:i,writable:s}=new DecompressionStream("deflate-raw"),r=s.getWriter();await r.ready,r.write(t).then(async()=>{await r.ready,await r.close()}).catch(()=>{});let a=null,o=0;for await(const w of i)a||(a=new Uint8Array(new Uint32Array(w.buffer,0,4)[0])),a.set(w,o),o+=w.length;const l=new Uint32Array(a.buffer,0,a.length>>2),c=l[1];if(c!==0)throw new Error(`Invalid version: ${c}`);const h=l[2],u=l[3],d=l[4]===0,f=l[5],g=l[6],m=l[7],x=[],p=(Bx+Cm*g)*Uint32Array.BYTES_PER_ELEMENT;let y;switch(m){case Int8Array.BYTES_PER_ELEMENT:y=new Int8Array(a.buffer,p);break;case Int16Array.BYTES_PER_ELEMENT:y=new Int16Array(a.buffer,p);break;case Int32Array.BYTES_PER_ELEMENT:y=new Int32Array(a.buffer,p);break}o=0;for(let w=0;w<g;w++){const _=l[Cm*w+Bx],v=new Float32Array(_+2);x.push(v);for(let C=0;C<Cm-1;C++)v[C]=l[Cm*w+Bx+C+1];for(let C=0;C<_;C++)v[C+2]=v[C]+y[o++]}return{areContours:d,thickness:f,outlines:x,width:h,height:u}}catch(t){return _n(`decompressSignature: ${t}`),null}}}Cd=new WeakMap,ai=new WeakSet,l7=function(e,t,i,s){return i-=e,s-=t,i===0?s>0?0:4:i===1?s+6:2-s},Ho=new WeakMap,qT=function(e,t,i,s,r,a,o){const l=D(this,ai,l7).call(this,i,s,r,a);for(let c=0;c<8;c++){const h=(-c+l-o+16)%8,u=b(this,Ho)[2*h],d=b(this,Ho)[2*h+1];if(e[(i+u)*t+(s+d)]!==0)return h}return-1},WT=function(e,t,i,s,r,a,o){const l=D(this,ai,l7).call(this,i,s,r,a);for(let c=0;c<8;c++){const h=(c+l+o+16)%8,u=b(this,Ho)[2*h],d=b(this,Ho)[2*h+1];if(e[(i+u)*t+(s+d)]!==0)return h}return-1},c7=function(e,t,i,s){const r=e.length,a=new Int32Array(r);for(let h=0;h<r;h++)a[h]=e[h]<=s?1:0;for(let h=1;h<i-1;h++)a[h*t]=a[h*t+t-1]=0;for(let h=0;h<t;h++)a[h]=a[t*i-1-h]=0;let o=1,l;const c=[];for(let h=1;h<i-1;h++){l=1;for(let u=1;u<t-1;u++){const d=h*t+u,f=a[d];if(f===0)continue;let g=h,m=u;if(f===1&&a[d-1]===0)o+=1,m-=1;else if(f>=1&&a[d+1]===0)o+=1,m+=1,f>1&&(l=f);else{f!==1&&(l=Math.abs(f));continue}const x=[u,h],p=m===u+1,y={isHole:p,points:x,id:o,parent:0};c.push(y);let w;for(const N of c)if(N.id===l){w=N;break}w?w.isHole?y.parent=p?w.parent:l:y.parent=p?l:w.parent:y.parent=p?l:0;const _=D(this,ai,qT).call(this,a,t,h,u,g,m,0);if(_===-1){a[d]=-o,a[d]!==1&&(l=Math.abs(a[d]));continue}let v=b(this,Ho)[2*_],C=b(this,Ho)[2*_+1];const k=h+v,I=u+C;g=k,m=I;let S=h,M=u;for(;;){const N=D(this,ai,WT).call(this,a,t,S,M,g,m,1);v=b(this,Ho)[2*N],C=b(this,Ho)[2*N+1];const F=S+v,H=M+C;x.push(H,F);const T=S*t+M;if(a[T+1]===0?a[T]=-o:a[T]===1&&(a[T]=o),F===h&&H===u&&S===k&&M===I){a[d]!==1&&(l=Math.abs(a[d]));break}else g=S,m=M,S=F,M=H}}}return c},G9=function(e,t,i,s){if(i-t<=4){for(let k=t;k<i-2;k+=2)s.push(e[k],e[k+1]);return}const r=e[t],a=e[t+1],o=e[i-4]-r,l=e[i-3]-a,c=Math.hypot(o,l),h=o/c,u=l/c,d=h*a-u*r,f=l/o,g=1/c,m=Math.atan(f),x=Math.cos(m),p=Math.sin(m),y=g*(Math.abs(x)+Math.abs(p)),w=g*(1-y+y**2),_=Math.max(Math.atan(Math.abs(p+x)*w),Math.atan(Math.abs(p-x)*w));let v=0,C=t;for(let k=t+2;k<i-2;k+=2){const I=Math.abs(d-h*e[k+1]+u*e[k]);I>v&&(C=k,v=I)}v>(c*_)**2?(D(this,ai,G9).call(this,e,t,C+2,s),D(this,ai,G9).call(this,e,C,i,s)):s.push(r,a)},KT=function(e){const t=[],i=e.length;return D(this,ai,G9).call(this,e,0,i,t),t.push(e[i-2],e[i-1]),t.length<=4?null:t},XT=function(e,t,i,s,r,a){const o=new Float32Array(a**2),l=-2*s**2,c=a>>1;for(let m=0;m<a;m++){const x=(m-c)**2;for(let p=0;p<a;p++)o[m*a+p]=Math.exp((x+(p-c)**2)/l)}const h=new Float32Array(256),u=-2*r**2;for(let m=0;m<256;m++)h[m]=Math.exp(m**2/u);const d=e.length,f=new Uint8Array(d),g=new Uint32Array(256);for(let m=0;m<i;m++)for(let x=0;x<t;x++){const p=m*t+x,y=e[p];let w=0,_=0;for(let C=0;C<a;C++){const k=m+C-c;if(!(k<0||k>=i))for(let I=0;I<a;I++){const S=x+I-c;if(S<0||S>=t)continue;const M=e[k*t+S],N=o[C*a+I]*h[Math.abs(M-y)];w+=M*N,_+=N}}const v=f[p]=Math.round(w/_);g[v]++}return[f,g]},YT=function(e){const t=new Uint32Array(256);for(const i of e)t[i]++;return t},h7=function(e){const t=e.length,i=new Uint8ClampedArray(t>>2);let s=-1/0,r=1/0;for(let o=0,l=i.length;o<l;o++){if(e[(o<<2)+3]===0){s=i[o]=255;continue}const h=i[o]=e[o<<2];h>s&&(s=h),h<r&&(r=h)}const a=255/(s-r);for(let o=0;o<t;o++)i[o]=(i[o]-r)*a;return i},u7=function(e){let t,i=-1/0,s=-1/0;const r=e.findIndex(l=>l!==0);let a=r,o=r;for(t=r;t<256;t++){const l=e[t];l>i&&(t-a>s&&(s=t-a,o=t-1),i=l,a=t)}for(t=o-1;t>=0&&!(e[t]>e[t+1]);t--);return t},JT=function(e){const t=e,{width:i,height:s}=e,{maxDim:r}=b(this,Cd);let a=i,o=s;if(i>r||s>r){let d=i,f=s,g=Math.log2(Math.max(i,s)/r);const m=Math.floor(g);g=g===m?m-1:m;for(let p=0;p<g;p++){a=Math.ceil(d/2),o=Math.ceil(f/2);const y=new OffscreenCanvas(a,o);y.getContext("2d").drawImage(e,0,0,d,f,0,0,a,o),d=a,f=o,e!==t&&e.close(),e=y.transferToImageBitmap()}const x=Math.min(r/a,r/o);a=Math.round(a*x),o=Math.round(o*x)}const c=new OffscreenCanvas(a,o).getContext("2d",{willReadFrequently:!0});c.filter="grayscale(1)",c.drawImage(e,0,0,e.width,e.height,0,0,a,o);const h=c.getImageData(0,0,a,o).data;return[D(this,ai,h7).call(this,h),a,o]},B($c,ai),B($c,Cd,{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}),B($c,Ho,new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]));class p4 extends UT{constructor(){super(),super.updateProperties({fill:ki._defaultLineColor,"stroke-width":0})}clone(){const e=new p4;return e.updateAll(this),e}}class b4 extends Q5{constructor(e){super(e),super.updateProperties({stroke:ki._defaultLineColor,"stroke-width":1})}clone(){const e=new b4(this._viewParameters);return e.updateAll(this),e}}var dh,Hl,fh,Ad;const ya=class ya extends C3{constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"});B(this,dh,!1);B(this,Hl,null);B(this,fh,null);B(this,Ad,null);this._willKeepAspectRatio=!0,O(this,fh,t.signatureData||null),O(this,Hl,null),this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,i){ki.initialize(t,i),this._defaultDrawingOptions=new p4,this._defaultDrawnSignatureOptions=new b4(i.viewParameters)}static getDefaultDrawingOptions(t){const i=this._defaultDrawingOptions.clone();return i.updateProperties(t),i}static get supportMultipleDrawings(){return!1}static get typesMap(){return Hn(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!b(this,Hl)}}static computeTelemetryFinalData(t){const i=t.get("hasDescription");return{hasAltText:i.get(!0)??0,hasNoAltText:i.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,i;const{_isCopy:s}=this;if(s&&(this._isCopy=!1,t=this.x,i=this.y),super.render(),this._drawId===null)if(b(this,fh)){const{lines:r,mustSmooth:a,areContours:o,description:l,uuid:c,heightInPage:h}=b(this,fh),{rawDims:{pageWidth:u,pageHeight:d},rotation:f}=this.parent.viewport,g=$c.processDrawnLines({lines:r,pageWidth:u,pageHeight:d,rotation:f,innerMargin:ya._INNER_MARGIN,mustSmooth:a,areContours:o});this.addSignature(g,h,l,c)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);return s&&(this._isCopy=!0,this._moveAfterPaste(t,i)),this.div}setUuid(t){O(this,Ad,t),this.addEditToolbar()}getUuid(){return b(this,Ad)}get description(){return b(this,Hl)}set description(t){O(this,Hl,t),super.addEditToolbar().then(i=>{i==null||i.updateEditSignatureButton(t)})}getSignaturePreview(){const{newCurves:t,areContours:i,thickness:s,width:r,height:a}=b(this,fh),o=Math.max(r,a),l=$c.processDrawnLines({lines:{curves:t.map(c=>({points:c})),thickness:s,width:r,height:a},pageWidth:o,pageHeight:o,rotation:0,innerMargin:0,mustSmooth:!1,areContours:i});return{areContours:i,outline:l.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,i,s,r){const{x:a,y:o}=this,{outline:l}=O(this,fh,t);O(this,dh,l instanceof o7),this.description=s,this.div.setAttribute("data-l10n-args",JSON.stringify({description:s}));let c;b(this,dh)?c=ya.getDefaultDrawingOptions():(c=ya._defaultDrawnSignatureOptions.clone(),c.updateProperties({"stroke-width":l.thickness})),this._addOutlines({drawOutlines:l,drawingOptions:c});const[h,u]=this.parentDimensions,[,d]=this.pageDimensions;let f=i/d;f=f>=1?.5:f,this.width*=f/this.height,this.width>=1&&(f*=.9/this.width,this.width=.9),this.height=f,this.setDims(h*this.width,u*this.height),this.x=a,this.y=o,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(r),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!r,hasDescription:!!s}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:i,pageHeight:s},rotation:r}=this.parent.viewport;return $c.process(t,i,s,r,ya._INNER_MARGIN)}getFromText(t,i){const{rawDims:{pageWidth:s,pageHeight:r},rotation:a}=this.parent.viewport;return $c.extractContoursFromText(t,i,s,r,a,ya._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:i,pageHeight:s},rotation:r}=this.parent.viewport;return $c.processDrawnLines({lines:t,pageWidth:i,pageHeight:s,rotation:r,innerMargin:ya._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:i}){t?this._drawingOptions=ya.getDefaultDrawingOptions():(this._drawingOptions=ya._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":i}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:i,points:s,rect:r}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":a}}=this,o={annotationType:wn.SIGNATURE,isSignature:!0,areContours:b(this,dh),color:[0,0,0],thickness:b(this,dh)?0:a,pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?(o.paths={lines:i,points:s},o.uuid=b(this,Ad),o.isCopy=!0):o.lines=i,b(this,Hl)&&(o.accessibilityData={type:"Figure",alt:b(this,Hl)}),o}static deserializeDraw(t,i,s,r,a,o){return o.areContours?o7.deserialize(t,i,s,r,a,o):hx.deserialize(t,i,s,r,a,o)}static async deserialize(t,i,s){var a;const r=await super.deserialize(t,i,s);return O(r,dh,t.areContours),O(r,Hl,((a=t.accessibilityData)==null?void 0:a.alt)||""),O(r,Ad,t.uuid),r}};dh=new WeakMap,Hl=new WeakMap,fh=new WeakMap,Ad=new WeakMap,He(ya,"_type","signature"),He(ya,"_editorType",wn.SIGNATURE),He(ya,"_defaultDrawingOptions",null);let d7=ya;var Pi,Os,gh,Kc,mh,hg,Xc,Sd,zl,Na,ug,$n,sp,rp,V9,q9,W9,g7,K9,ZT;class f7 extends ki{constructor(t){super({...t,name:"stampEditor"});B(this,$n);B(this,Pi,null);B(this,Os,null);B(this,gh,null);B(this,Kc,null);B(this,mh,null);B(this,hg,"");B(this,Xc,null);B(this,Sd,!1);B(this,zl,null);B(this,Na,!1);B(this,ug,!1);O(this,Kc,t.bitmapUrl),O(this,mh,t.bitmapFile),this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,i){ki.initialize(t,i)}static isHandlingMimeForPasting(t){return a8.includes(t)}static paste(t,i){i.pasteEditor({mode:wn.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const i=t.get("hasAltText");return{hasAltText:i.get(!0)??0,hasNoAltText:i.get(!1)??0}}async mlGuessAltText(t=null,i=!0){if(this.hasAltTextData())return null;const{mlManager:s}=this._uiManager;if(!s)throw new Error("No ML.");if(!await s.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:r,width:a,height:o}=t||this.copyCanvas(null,null,!0).imageData,l=await s.guess({name:"altText",request:{data:r,width:a,height:o,channels:r.length/(a*o)}});if(!l)throw new Error("No response from the AI service.");if(l.error)throw new Error("Error from the AI service.");if(l.cancel)return null;if(!l.output)throw new Error("No valid response from the AI service.");const c=l.output;return await this.setGuessedAltText(c),i&&!this.hasAltTextData()&&(this.altTextData={alt:c,decorative:!1}),c}remove(){var t;b(this,Os)&&(O(this,Pi,null),this._uiManager.imageManager.deleteId(b(this,Os)),(t=b(this,Xc))==null||t.remove(),O(this,Xc,null),b(this,zl)&&(clearTimeout(b(this,zl)),O(this,zl,null))),super.remove()}rebuild(){if(!this.parent){b(this,Os)&&D(this,$n,V9).call(this);return}super.rebuild(),this.div!==null&&(b(this,Os)&&b(this,Xc)===null&&D(this,$n,V9).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(b(this,gh)||b(this,Pi)||b(this,Kc)||b(this,mh)||b(this,Os)||b(this,Sd))}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,i;return this._isCopy&&(t=this.x,i=this.y),super.render(),this.div.hidden=!0,this.createAltText(),b(this,Sd)||(b(this,Pi)?D(this,$n,q9).call(this):D(this,$n,V9).call(this)),this._isCopy&&this._moveAfterPaste(t,i),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,i){const{id:s,bitmap:r}=this._uiManager.imageManager.getFromCanvas(t,i);i.remove(),s&&this._uiManager.imageManager.isValidId(s)&&(O(this,Os,s),r&&O(this,Pi,r),O(this,Sd,!1),D(this,$n,q9).call(this))}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;b(this,zl)!==null&&clearTimeout(b(this,zl)),O(this,zl,setTimeout(()=>{O(this,zl,null),D(this,$n,g7).call(this)},200))}copyCanvas(t,i,s=!1){var f;t||(t=224);const{width:r,height:a}=b(this,Pi),o=new ic;let l=b(this,Pi),c=r,h=a,u=null;if(i){if(r>i||a>i){const I=Math.min(i/r,i/a);c=Math.floor(r*I),h=Math.floor(a*I)}u=document.createElement("canvas");const g=u.width=Math.ceil(c*o.sx),m=u.height=Math.ceil(h*o.sy);b(this,Na)||(l=D(this,$n,W9).call(this,g,m));const x=u.getContext("2d");x.filter=this._uiManager.hcmFilter;let p="white",y="#cfcfd8";this._uiManager.hcmFilter!=="none"?y="black":(f=window.matchMedia)!=null&&f.call(window,"(prefers-color-scheme: dark)").matches&&(p="#8f8f9d",y="#42414d");const w=15,_=w*o.sx,v=w*o.sy,C=new OffscreenCanvas(_*2,v*2),k=C.getContext("2d");k.fillStyle=p,k.fillRect(0,0,_*2,v*2),k.fillStyle=y,k.fillRect(0,0,_,v),k.fillRect(_,v,_,v),x.fillStyle=x.createPattern(C,"repeat"),x.fillRect(0,0,g,m),x.drawImage(l,0,0,l.width,l.height,0,0,g,m)}let d=null;if(s){let g,m;if(o.symmetric&&l.width<t&&l.height<t)g=l.width,m=l.height;else if(l=b(this,Pi),r>t||a>t){const y=Math.min(t/r,t/a);g=Math.floor(r*y),m=Math.floor(a*y),b(this,Na)||(l=D(this,$n,W9).call(this,g,m))}const p=new OffscreenCanvas(g,m).getContext("2d",{willReadFrequently:!0});p.drawImage(l,0,0,l.width,l.height,0,0,g,m),d={width:g,height:m,data:p.getImageData(0,0,g,m).data}}return{canvas:u,width:c,height:h,imageData:d}}static async deserialize(t,i,s){var x;let r=null,a=!1;if(t instanceof dT){const{data:{rect:p,rotation:y,id:w,structParent:_,popupRef:v},container:C,parent:{page:{pageNumber:k}},canvas:I}=t;let S,M;I?(delete t.canvas,{id:S,bitmap:M}=s.imageManager.getFromCanvas(C.id,I),I.remove()):(a=!0,t._hasNoCanvas=!0);const N=((x=await i._structTree.getAriaAttributes(`${o4}${w}`))==null?void 0:x.get("aria-label"))||"";r=t={annotationType:wn.STAMP,bitmapId:S,bitmap:M,pageIndex:k-1,rect:p.slice(0),rotation:y,annotationElementId:w,id:w,deleted:!1,accessibilityData:{decorative:!1,altText:N},isSvg:!1,structParent:_,popupRef:v}}const o=await super.deserialize(t,i,s),{rect:l,bitmap:c,bitmapUrl:h,bitmapId:u,isSvg:d,accessibilityData:f}=t;a?(s.addMissingCanvas(t.id,o),O(o,Sd,!0)):u&&s.imageManager.isValidId(u)?(O(o,Os,u),c&&O(o,Pi,c)):O(o,Kc,h),O(o,Na,d);const[g,m]=o.pageDimensions;return o.width=(l[2]-l[0])/g,o.height=(l[3]-l[1])/m,f&&(o.altTextData=f),o._initialData=r,O(o,ug,!!r),o}serialize(t=!1,i=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s={annotationType:wn.STAMP,bitmapId:b(this,Os),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:b(this,Na),structTreeParentId:this._structTreeParentId};if(t)return s.bitmapUrl=D(this,$n,K9).call(this,!0),s.accessibilityData=this.serializeAltText(!0),s.isCopy=!0,s;const{decorative:r,altText:a}=this.serializeAltText(!1);if(!r&&a&&(s.accessibilityData={type:"Figure",alt:a}),this.annotationElementId){const l=D(this,$n,ZT).call(this,s);if(l.isSame)return null;l.isSameAltText?delete s.accessibilityData:s.accessibilityData.structParent=this._initialData.structParent??-1}if(s.id=this.annotationElementId,i===null)return s;i.stamps||(i.stamps=new Map);const o=b(this,Na)?(s.rect[2]-s.rect[0])*(s.rect[3]-s.rect[1]):null;if(!i.stamps.has(b(this,Os)))i.stamps.set(b(this,Os),{area:o,serialized:s}),s.bitmap=D(this,$n,K9).call(this,!1);else if(b(this,Na)){const l=i.stamps.get(b(this,Os));o>l.area&&(l.area=o,l.serialized.bitmap.close(),l.serialized.bitmap=D(this,$n,K9).call(this,!1))}return s}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}}Pi=new WeakMap,Os=new WeakMap,gh=new WeakMap,Kc=new WeakMap,mh=new WeakMap,hg=new WeakMap,Xc=new WeakMap,Sd=new WeakMap,zl=new WeakMap,Na=new WeakMap,ug=new WeakMap,$n=new WeakSet,sp=function(t,i=!1){if(!t){this.remove();return}O(this,Pi,t.bitmap),i||(O(this,Os,t.id),O(this,Na,t.isSvg)),t.file&&O(this,hg,t.file.name),D(this,$n,q9).call(this)},rp=function(){if(O(this,gh,null),this._uiManager.enableWaiting(!1),!!b(this,Xc)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&b(this,Pi)){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&b(this,Pi)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},V9=function(){if(b(this,Os)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(b(this,Os)).then(s=>D(this,$n,sp).call(this,s,!0)).finally(()=>D(this,$n,rp).call(this));return}if(b(this,Kc)){const s=b(this,Kc);O(this,Kc,null),this._uiManager.enableWaiting(!0),O(this,gh,this._uiManager.imageManager.getFromUrl(s).then(r=>D(this,$n,sp).call(this,r)).finally(()=>D(this,$n,rp).call(this)));return}if(b(this,mh)){const s=b(this,mh);O(this,mh,null),this._uiManager.enableWaiting(!0),O(this,gh,this._uiManager.imageManager.getFromFile(s).then(r=>D(this,$n,sp).call(this,r)).finally(()=>D(this,$n,rp).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=a8.join(",");const i=this._uiManager._signal;O(this,gh,new Promise(s=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),D(this,$n,sp).call(this,r)}s()},{signal:i}),t.addEventListener("cancel",()=>{this.remove(),s()},{signal:i})}).finally(()=>D(this,$n,rp).call(this))),t.click()},q9=function(){var u;const{div:t}=this;let{width:i,height:s}=b(this,Pi);const[r,a]=this.pageDimensions,o=.75;if(this.width)i=this.width*r,s=this.height*a;else if(i>o*r||s>o*a){const d=Math.min(o*r/i,o*a/s);i*=d,s*=d}const[l,c]=this.parentDimensions;this.setDims(i*l/r,s*c/a),this._uiManager.enableWaiting(!1);const h=O(this,Xc,document.createElement("canvas"));h.setAttribute("role","img"),this.addContainer(h),this.width=i/r,this.height=s/a,(u=this._initialOptions)!=null&&u.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),D(this,$n,g7).call(this),b(this,ug)||(this.parent.addUndoableEditor(this),O(this,ug,!0)),this._reportTelemetry({action:"inserted_image"}),b(this,hg)&&this.div.setAttribute("aria-description",b(this,hg)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")},W9=function(t,i){const{width:s,height:r}=b(this,Pi);let a=s,o=r,l=b(this,Pi);for(;a>2*t||o>2*i;){const c=a,h=o;a>2*t&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),o>2*i&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const u=new OffscreenCanvas(a,o);u.getContext("2d").drawImage(l,0,0,c,h,0,0,a,o),l=u.transferToImageBitmap()}return l},g7=function(){const[t,i]=this.parentDimensions,{width:s,height:r}=this,a=new ic,o=Math.ceil(s*t*a.sx),l=Math.ceil(r*i*a.sy),c=b(this,Xc);if(!c||c.width===o&&c.height===l)return;c.width=o,c.height=l;const h=b(this,Na)?b(this,Pi):D(this,$n,W9).call(this,o,l),u=c.getContext("2d");u.filter=this._uiManager.hcmFilter,u.drawImage(h,0,0,h.width,h.height,0,0,o,l)},K9=function(t){if(t){if(b(this,Na)){const r=this._uiManager.imageManager.getSvgUrl(b(this,Os));if(r)return r}const i=document.createElement("canvas");return{width:i.width,height:i.height}=b(this,Pi),i.getContext("2d").drawImage(b(this,Pi),0,0),i.toDataURL()}if(b(this,Na)){const[i,s]=this.pageDimensions,r=Math.round(this.width*i*Uh.PDF_TO_CSS_UNITS),a=Math.round(this.height*s*Uh.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(r,a);return o.getContext("2d").drawImage(b(this,Pi),0,0,b(this,Pi).width,b(this,Pi).height,0,0,r,a),o.transferToImageBitmap()}return structuredClone(b(this,Pi))},ZT=function(t){var o;const{pageIndex:i,accessibilityData:{altText:s}}=this._initialData,r=t.pageIndex===i,a=(((o=t.accessibilityData)==null?void 0:o.alt)||"")===s;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&r&&a,isSameAltText:a}},He(f7,"_type","stamp"),He(f7,"_editorType",wn.STAMP);var Id,dg,jl,ph,Yc,Oa,bh,fg,Ed,zo,Jc,Ds,Zc,xh,gg,Yt,yh,Oi,QT,wl,p7,b7,X9;const Eo=class Eo{constructor({uiManager:e,pageIndex:t,div:i,structTreeLayer:s,accessibilityManager:r,annotationLayer:a,drawLayer:o,textLayer:l,viewport:c,l10n:h}){B(this,Oi);B(this,Id);B(this,dg,!1);B(this,jl,null);B(this,ph,null);B(this,Yc,null);B(this,Oa,new Map);B(this,bh,!1);B(this,fg,!1);B(this,Ed,!1);B(this,zo,null);B(this,Jc,null);B(this,Ds,null);B(this,Zc,null);B(this,xh,null);B(this,gg,-1);B(this,Yt);const u=[...b(Eo,yh).values()];if(!Eo._initialized){Eo._initialized=!0;for(const d of u)d.initialize(h,e)}e.registerEditorTypes(u),O(this,Yt,e),this.pageIndex=t,this.div=i,O(this,Id,r),O(this,jl,a),this.viewport=c,O(this,Ds,l),this.drawLayer=o,this._structTree=s,b(this,Yt).addLayer(this)}get isEmpty(){return b(this,Oa).size===0}get isInvisible(){return this.isEmpty&&b(this,Yt).getMode()===wn.NONE}updateToolbar(e){b(this,Yt).updateToolbar(e)}updateMode(e=b(this,Yt).getMode()){switch(D(this,Oi,X9).call(this),e){case wn.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case wn.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case wn.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;for(const i of b(Eo,yh).values())t.toggle(`${i._type}Editing`,e===i._editorType);this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=b(this,Ds))==null?void 0:t.div)}setEditingState(e){b(this,Yt).setEditingState(e)}addCommands(e){b(this,Yt).addCommands(e)}cleanUndoStack(e){b(this,Yt).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=b(this,jl))==null||t.div.classList.toggle("disabled",!e)}async enable(){var i;O(this,Ed,!0),this.div.tabIndex=0,this.togglePointerEvents(!0),(i=b(this,xh))==null||i.abort(),O(this,xh,null);const e=new Set;for(const s of b(this,Oa).values())s.enableEditing(),s.show(!0),s.annotationElementId&&(b(this,Yt).removeChangedExistingAnnotation(s),e.add(s.annotationElementId));if(!b(this,jl)){O(this,Ed,!1);return}const t=b(this,jl).getEditableAnnotations();for(const s of t){if(s.hide(),b(this,Yt).isDeletedAnnotationElement(s.data.id)||e.has(s.data.id))continue;const r=await this.deserialize(s);r&&(this.addOrRebuild(r),r.enableEditing())}O(this,Ed,!1)}disable(){var s;if(O(this,fg,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1),b(this,Ds)&&!b(this,xh)){O(this,xh,new AbortController);const r=b(this,Yt).combinedSignal(b(this,xh));b(this,Ds).div.addEventListener("pointerdown",a=>{const{clientX:l,clientY:c,timeStamp:h}=a,u=b(this,gg);if(h-u>500){O(this,gg,h);return}O(this,gg,-1);const{classList:d}=this.div;d.toggle("getElements",!0);const f=document.elementsFromPoint(l,c);if(d.toggle("getElements",!1),!this.div.contains(f[0]))return;let g;const m=new RegExp(`^${WI}[0-9]+$`);for(const p of f)if(m.test(p.id)){g=p.id;break}if(!g)return;const x=b(this,Oa).get(g);(x==null?void 0:x.annotationElementId)===null&&(a.stopPropagation(),a.preventDefault(),x.dblclick())},{signal:r,capture:!0})}const e=new Map,t=new Map;for(const r of b(this,Oa).values())if(r.disableEditing(),!!r.annotationElementId){if(r.serialize()!==null){e.set(r.annotationElementId,r);continue}else t.set(r.annotationElementId,r);(s=this.getEditableAnnotation(r.annotationElementId))==null||s.show(),r.remove()}if(b(this,jl)){const r=b(this,jl).getEditableAnnotations();for(const a of r){const{id:o}=a.data;if(b(this,Yt).isDeletedAnnotationElement(o))continue;let l=t.get(o);if(l){l.resetAnnotationElement(a),l.show(!1),a.show();continue}l=e.get(o),l&&(b(this,Yt).addChangedExistingAnnotation(l),l.renderAnnotationElement(a)&&l.show(!1)),a.show()}}D(this,Oi,X9).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:i}=this.div;for(const r of b(Eo,yh).values())i.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),O(this,fg,!1)}getEditableAnnotation(e){var t;return((t=b(this,jl))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){b(this,Yt).getActive()!==e&&b(this,Yt).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=b(this,Ds))!=null&&e.div&&!b(this,Zc)){O(this,Zc,new AbortController);const t=b(this,Yt).combinedSignal(b(this,Zc));b(this,Ds).div.addEventListener("pointerdown",D(this,Oi,QT).bind(this),{signal:t}),b(this,Ds).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=b(this,Ds))!=null&&e.div&&b(this,Zc)&&(b(this,Zc).abort(),O(this,Zc,null),b(this,Ds).div.classList.remove("highlighting"))}enableClick(){if(b(this,ph))return;O(this,ph,new AbortController);const e=b(this,Yt).combinedSignal(b(this,ph));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;(e=b(this,ph))==null||e.abort(),O(this,ph,null)}attach(e){b(this,Oa).set(e.id,e);const{annotationElementId:t}=e;t&&b(this,Yt).isDeletedAnnotationElement(t)&&b(this,Yt).removeDeletedAnnotationElement(e)}detach(e){var t;b(this,Oa).delete(e.id),(t=b(this,Id))==null||t.removePointerInTextLayer(e.contentDiv),!b(this,fg)&&e.annotationElementId&&b(this,Yt).addDeletedAnnotationElement(e)}remove(e){this.detach(e),b(this,Yt).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(b(this,Yt).addDeletedAnnotationElement(e.annotationElementId),ki.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),b(this,Yt).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!b(this,Ed)),b(this,Yt).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var i;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!b(this,Yc)&&(e._focusEventsAllowed=!1,O(this,Yc,setTimeout(()=>{O(this,Yc,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:b(this,Yt)._signal}),t.focus())},0))),e._structTreeParentId=(i=b(this,Id))==null?void 0:i.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),i=()=>{e.remove()};this.addCommands({cmd:t,undo:i,mustExec:!1})}getNextId(){return b(this,Yt).getId()}combinedSignal(e){return b(this,Yt).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=b(this,Oi,wl))==null?void 0:e.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await b(this,Yt).updateMode(e.mode);const{offsetX:i,offsetY:s}=D(this,Oi,b7).call(this),r=this.getNextId(),a=D(this,Oi,p7).call(this,{parent:this,id:r,x:i,y:s,uiManager:b(this,Yt),isCentered:!0,...t});a&&this.add(a)}async deserialize(e){var t;return await((t=b(Eo,yh).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,b(this,Yt)))||null}createAndAddNewEditor(e,t,i={}){const s=this.getNextId(),r=D(this,Oi,p7).call(this,{parent:this,id:s,x:e.offsetX,y:e.offsetY,uiManager:b(this,Yt),isCentered:t,...i});return r&&this.add(r),r}addNewEditor(e={}){this.createAndAddNewEditor(D(this,Oi,b7).call(this),!0,e)}setSelected(e){b(this,Yt).setSelected(e)}toggleSelected(e){b(this,Yt).toggleSelected(e)}unselect(e){b(this,Yt).unselect(e)}pointerup(e){var s;const{isMac:t}=dr.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!b(this,bh)||(O(this,bh,!1),(s=b(this,Oi,wl))!=null&&s.isDrawer&&b(this,Oi,wl).supportMultipleDrawings))return;if(!b(this,dg)){O(this,dg,!0);return}const i=b(this,Yt).getMode();if(i===wn.STAMP||i===wn.SIGNATURE){b(this,Yt).unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){var s;if(b(this,Yt).getMode()===wn.HIGHLIGHT&&this.enableTextSelection(),b(this,bh)){O(this,bh,!1);return}const{isMac:t}=dr.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(O(this,bh,!0),(s=b(this,Oi,wl))!=null&&s.isDrawer){this.startDrawingSession(e);return}const i=b(this,Yt).getActive();O(this,dg,!i||i.isEmpty())}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),b(this,zo)){b(this,Oi,wl).startDrawing(this,b(this,Yt),!1,e);return}b(this,Yt).setCurrentDrawingSession(this),O(this,zo,new AbortController);const t=b(this,Yt).combinedSignal(b(this,zo));this.div.addEventListener("blur",({relatedTarget:i})=>{i&&!this.div.contains(i)&&(O(this,Jc,null),this.commitOrRemove())},{signal:t}),b(this,Oi,wl).startDrawing(this,b(this,Yt),!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&O(this,Jc,t);return}b(this,Jc)&&setTimeout(()=>{var t;(t=b(this,Jc))==null||t.focus(),O(this,Jc,null)},0)}endDrawingSession(e=!1){return b(this,zo)?(b(this,Yt).setCurrentDrawingSession(null),b(this,zo).abort(),O(this,zo,null),O(this,Jc,null),b(this,Oi,wl).endDrawing(e)):null}findNewParent(e,t,i){const s=b(this,Yt).findParent(t,i);return s===null||s===this?!1:(s.changeParent(e),!0)}commitOrRemove(){return b(this,zo)?(this.endDrawingSession(),!0):!1}onScaleChanging(){b(this,zo)&&b(this,Oi,wl).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),((e=b(this,Yt).getActive())==null?void 0:e.parent)===this&&(b(this,Yt).commitOrRemove(),b(this,Yt).setActiveEditor(null)),b(this,Yc)&&(clearTimeout(b(this,Yc)),O(this,Yc,null));for(const i of b(this,Oa).values())(t=b(this,Id))==null||t.removePointerInTextLayer(i.contentDiv),i.setParent(null),i.isAttachedToDOM=!1,i.div.remove();this.div=null,b(this,Oa).clear(),b(this,Yt).removeLayer(this)}render({viewport:e}){this.viewport=e,Vd(this.div,e);for(const t of b(this,Yt).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){b(this,Yt).commitOrRemove(),D(this,Oi,X9).call(this);const t=this.viewport.rotation,i=e.rotation;if(this.viewport=e,Vd(this.div,{rotation:i}),t!==i)for(const s of b(this,Oa).values())s.rotate(i)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return b(this,Yt).viewParameters.realScale}};Id=new WeakMap,dg=new WeakMap,jl=new WeakMap,ph=new WeakMap,Yc=new WeakMap,Oa=new WeakMap,bh=new WeakMap,fg=new WeakMap,Ed=new WeakMap,zo=new WeakMap,Jc=new WeakMap,Ds=new WeakMap,Zc=new WeakMap,xh=new WeakMap,gg=new WeakMap,Yt=new WeakMap,yh=new WeakMap,Oi=new WeakSet,QT=function(e){b(this,Yt).unselectAll();const{target:t}=e;if(t===b(this,Ds).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&b(this,Ds).div.contains(t)){const{isMac:i}=dr.platform;if(e.button!==0||e.ctrlKey&&i)return;b(this,Yt).showAllEditors("highlight",!0,!0),b(this,Ds).div.classList.add("free"),this.toggleDrawing(),k3.startHighlighting(this,b(this,Yt).direction==="ltr",{target:b(this,Ds).div,x:e.x,y:e.y}),b(this,Ds).div.addEventListener("pointerup",()=>{b(this,Ds).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:b(this,Yt)._signal}),e.preventDefault()}},wl=function(){return b(Eo,yh).get(b(this,Yt).getMode())},p7=function(e){const t=b(this,Oi,wl);return t?new t.prototype.constructor(e):null},b7=function(){const{x:e,y:t,width:i,height:s}=this.div.getBoundingClientRect(),r=Math.max(0,e),a=Math.max(0,t),o=Math.min(window.innerWidth,e+i),l=Math.min(window.innerHeight,t+s),c=(r+o)/2-e,h=(a+l)/2-t,[u,d]=this.viewport.rotation%180===0?[c,h]:[h,c];return{offsetX:u,offsetY:d}},X9=function(){for(const e of b(this,Oa).values())e.isEmpty()&&e.remove()},He(Eo,"_initialized",!1),B(Eo,yh,new Map([K8,a7,f7,k3,d7].map(e=>[e._editorType,e])));let m7=Eo;var jo,Br,Td,Db,R5,$T,oc,y7,eR,w7;const ks=class ks{constructor({pageIndex:e}){B(this,oc);B(this,jo,null);B(this,Br,new Map);B(this,Td,new Map);this.pageIndex=e}setParent(e){if(!b(this,jo)){O(this,jo,e);return}if(b(this,jo)!==e){if(b(this,Br).size>0)for(const t of b(this,Br).values())t.remove(),e.append(t);O(this,jo,e)}}static get _svgFactory(){return Hn(this,"_svgFactory",new w3)}draw(e,t=!1,i=!1){const s=Mr(ks,Db)._++,r=D(this,oc,y7).call(this),a=ks._svgFactory.createElement("defs");r.append(a);const o=ks._svgFactory.createElement("path");a.append(o);const l=`path_p${this.pageIndex}_${s}`;o.setAttribute("id",l),o.setAttribute("vector-effect","non-scaling-stroke"),t&&b(this,Td).set(s,o);const c=i?D(this,oc,eR).call(this,a,l):null,h=ks._svgFactory.createElement("use");return r.append(h),h.setAttribute("href",`#${l}`),this.updateProperties(r,e),b(this,Br).set(s,r),{id:s,clipPathId:`url(#${c})`}}drawOutline(e,t){const i=Mr(ks,Db)._++,s=D(this,oc,y7).call(this),r=ks._svgFactory.createElement("defs");s.append(r);const a=ks._svgFactory.createElement("path");r.append(a);const o=`path_p${this.pageIndex}_${i}`;a.setAttribute("id",o),a.setAttribute("vector-effect","non-scaling-stroke");let l;if(t){const u=ks._svgFactory.createElement("mask");r.append(u),l=`mask_p${this.pageIndex}_${i}`,u.setAttribute("id",l),u.setAttribute("maskUnits","objectBoundingBox");const d=ks._svgFactory.createElement("rect");u.append(d),d.setAttribute("width","1"),d.setAttribute("height","1"),d.setAttribute("fill","white");const f=ks._svgFactory.createElement("use");u.append(f),f.setAttribute("href",`#${o}`),f.setAttribute("stroke","none"),f.setAttribute("fill","black"),f.setAttribute("fill-rule","nonzero"),f.classList.add("mask")}const c=ks._svgFactory.createElement("use");s.append(c),c.setAttribute("href",`#${o}`),l&&c.setAttribute("mask",`url(#${l})`);const h=c.cloneNode();return s.append(h),c.classList.add("mainOutline"),h.classList.add("secondaryOutline"),this.updateProperties(s,e),b(this,Br).set(i,s),i}finalizeDraw(e,t){b(this,Td).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var l;if(!t)return;const{root:i,bbox:s,rootClass:r,path:a}=t,o=typeof e=="number"?b(this,Br).get(e):e;if(o){if(i&&D(this,oc,w7).call(this,o,i),s&&D(l=ks,R5,$T).call(l,o,s),r){const{classList:c}=o;for(const[h,u]of Object.entries(r))c.toggle(h,u)}if(a){const h=o.firstChild.firstChild;D(this,oc,w7).call(this,h,a)}}}updateParent(e,t){if(t===this)return;const i=b(this,Br).get(e);i&&(b(t,jo).append(i),b(this,Br).delete(e),b(t,Br).set(e,i))}remove(e){b(this,Td).delete(e),b(this,jo)!==null&&(b(this,Br).get(e).remove(),b(this,Br).delete(e))}destroy(){O(this,jo,null);for(const e of b(this,Br).values())e.remove();b(this,Br).clear(),b(this,Td).clear()}};jo=new WeakMap,Br=new WeakMap,Td=new WeakMap,Db=new WeakMap,R5=new WeakSet,$T=function(e,[t,i,s,r]){const{style:a}=e;a.top=`${100*i}%`,a.left=`${100*t}%`,a.width=`${100*s}%`,a.height=`${100*r}%`},oc=new WeakSet,y7=function(){const e=ks._svgFactory.create(1,1,!0);return b(this,jo).append(e),e.setAttribute("aria-hidden",!0),e},eR=function(e,t){const i=ks._svgFactory.createElement("clipPath");e.append(i);const s=`clip_${t}`;i.setAttribute("id",s),i.setAttribute("clipPathUnits","objectBoundingBox");const r=ks._svgFactory.createElement("use");return i.append(r),r.setAttribute("href",`#${t}`),r.classList.add("clip"),s},w7=function(e,t){for(const[i,s]of Object.entries(t))s===null?e.removeAttribute(i):e.setAttribute(i,s)},B(ks,R5),B(ks,Db,0);let x7=ks;globalThis._pdfjsTestingUtils={HighlightOutliner:Y8};globalThis.pdfjsLib={AbortException:Bh,AnnotationEditorLayer:m7,AnnotationEditorParamsType:Gn,AnnotationEditorType:wn,AnnotationEditorUIManager:qd,AnnotationLayer:V8,AnnotationMode:O0,AnnotationType:fs,build:UB,ColorPicker:v3,createValidAbsoluteUrl:KI,DOMSVGFactory:w3,DrawLayer:x7,FeatureTest:dr,fetchData:ax,getDocument:NB,getFilenameFromUrl:RL,getPdfFilenameFromUrl:ML,getUuid:JI,getXfaPageViewport:NL,GlobalWorkerOptions:Wl,ImageKind:x9,InvalidPDFException:s8,isDataScheme:J5,isPdfFile:c4,isValidExplicitDest:VL,MathClamp:Hr,noContextMenu:nl,normalizeUnicode:IL,OPS:p3,OutputScale:ic,PasswordResponses:xL,PDFDataRangeTransport:ZE,PDFDateString:h4,PDFWorker:Np,PermissionFlag:bL,PixelsPerInch:Uh,RenderingCancelledException:l4,ResponseException:b3,setLayerDimensions:Vd,shadow:Hn,SignatureExtractor:$c,stopEvent:ms,SupportedImageMimeTypes:a8,TextLayer:Mp,TouchManager:y3,updateUrlHash:XI,Util:tn,VerbosityLevel:K5,version:BB,XfaLayer:eT};const oU=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),Ld=[.001,0,0,.001,0,0],a0=1.35,A3=.35,Uv=A3/a0,zr={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},tR="pdfjs_internal_editor_",pl={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,SIGNATURE:101},Hv={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},nR={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Fs={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Ks={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},_7={GROUP:"Group",REPLY:"R"},bi={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512},Jo={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864},uf={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},iR={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"},lU={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"},cU={O:"PageOpen",C:"PageClose"},Op={ERRORS:0,WARNINGS:1,INFOS:5},ie={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},gs={moveTo:0,lineTo:1,curveTo:2,closePath:3},zv={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let $5=Op.WARNINGS;function hU(n){Number.isInteger(n)&&($5=n)}function uU(){return $5}function gn(n){$5>=Op.INFOS&&`${n}`}function ce(n){$5>=Op.WARNINGS&&`${n}`}function kn(n){throw new Error(n)}function Hs(n,e){n||kn(e)}function dU(n){switch(n==null?void 0:n.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function S3(n,e=null,t=null){if(!n)return null;if(t&&typeof n=="string"){if(t.addDefaultProtocol&&n.startsWith("www.")){const s=n.match(/\./g);(s==null?void 0:s.length)>=2&&(n=`http://${n}`)}if(t.tryConvertEncoding)try{n=Lp(n)}catch{}}const i=e?URL.parse(n,e):URL.parse(n);return dU(i)?i:null}function Ze(n,e,t,i=!1){return Object.defineProperty(n,e,{value:t,enumerable:!i,configurable:!0,writable:!1}),t}const $r=function(){function e(t,i){this.message=t,this.name=i}return e.prototype=new Error,e.constructor=e,e}();class Dp extends $r{constructor(e,t){super(e,"PasswordException"),this.code=t}}class fw extends $r{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class Fp extends $r{constructor(e){super(e,"InvalidPDFException")}}class jv extends $r{constructor(e,t,i){super(e,"ResponseException"),this.status=t,this.missing=i}}class Te extends $r{constructor(e){super(e,"FormatError")}}class rr extends $r{constructor(e){super(e,"AbortException")}}function da(n){(typeof n!="object"||(n==null?void 0:n.length)===void 0)&&kn("Invalid argument for bytesToString");const e=n.length,t=8192;if(e<t)return String.fromCharCode.apply(null,n);const i=[];for(let s=0;s<e;s+=t){const r=Math.min(s+t,e),a=n.subarray(s,r);i.push(String.fromCharCode.apply(null,a))}return i.join("")}function cr(n){typeof n!="string"&&kn("Invalid argument for stringToBytes");const e=n.length,t=new Uint8Array(e);for(let i=0;i<e;++i)t[i]=n.charCodeAt(i)&255;return t}function ar(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function x4(n){return Object.keys(n).length}function fU(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function gU(){try{return new Function(""),!0}catch{return!1}}class fa{static get isLittleEndian(){return Ze(this,"isLittleEndian",fU())}static get isEvalSupported(){return Ze(this,"isEvalSupported",gU())}static get isOffscreenCanvasSupported(){return Ze(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Ze(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return Ze(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){var e,t;return Ze(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const e1=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));var p0,Y9,v7;class Dn{static makeHexColor(e,t,i){return`#${e1[e]}${e1[t]}${e1[i]}`}static scaleMinMax(e,t){let i;e[0]?(e[0]<0&&(i=t[0],t[0]=t[2],t[2]=i),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(i=t[1],t[1]=t[3],t[3]=i),t[1]*=e[3],t[3]*=e[3]):(i=t[0],t[0]=t[1],t[1]=i,i=t[2],t[2]=t[3],t[3]=i,e[1]<0&&(i=t[1],t[1]=t[3],t[3]=i),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(i=t[0],t[0]=t[2],t[2]=i),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t,i=0){const s=e[i],r=e[i+1];e[i]=s*t[0]+r*t[2]+t[4],e[i+1]=s*t[1]+r*t[3]+t[5]}static applyTransformToBezier(e,t,i=0){const s=t[0],r=t[1],a=t[2],o=t[3],l=t[4],c=t[5];for(let h=0;h<6;h+=2){const u=e[i+h],d=e[i+h+1];e[i+h]=u*s+d*a+l,e[i+h+1]=u*r+d*o+c}}static applyInverseTransform(e,t){const i=e[0],s=e[1],r=t[0]*t[3]-t[1]*t[2];e[0]=(i*t[3]-s*t[2]+t[2]*t[5]-t[4]*t[3])/r,e[1]=(-i*t[1]+s*t[0]+t[4]*t[1]-t[5]*t[0])/r}static axialAlignedBoundingBox(e,t,i){const s=t[0],r=t[1],a=t[2],o=t[3],l=t[4],c=t[5],h=e[0],u=e[1],d=e[2],f=e[3];let g=s*h+l,m=g,x=s*d+l,p=x,y=o*u+c,w=y,_=o*f+c,v=_;if(r!==0||a!==0){const C=r*h,k=r*d,I=a*u,S=a*f;g+=I,p+=I,x+=S,m+=S,y+=C,v+=C,_+=k,w+=k}i[0]=Math.min(i[0],g,x,m,p),i[1]=Math.min(i[1],y,_,w,v),i[2]=Math.max(i[2],g,x,m,p),i[3]=Math.max(i[3],y,_,w,v)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const i=e[0],s=e[1],r=e[2],a=e[3],o=i**2+s**2,l=i*r+s*a,c=r**2+a**2,h=(o+c)/2,u=Math.sqrt(h**2-(o*c-l**2));t[0]=Math.sqrt(h+u||1),t[1]=Math.sqrt(h-u||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const i=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),s=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(i>s)return null;const r=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),a=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return r>a?null:[i,r,s,a]}static pointBoundingBox(e,t,i){i[0]=Math.min(i[0],e),i[1]=Math.min(i[1],t),i[2]=Math.max(i[2],e),i[3]=Math.max(i[3],t)}static rectBoundingBox(e,t,i,s,r){r[0]=Math.min(r[0],e,i),r[1]=Math.min(r[1],t,s),r[2]=Math.max(r[2],e,i),r[3]=Math.max(r[3],t,s)}static bezierBoundingBox(e,t,i,s,r,a,o,l,c){c[0]=Math.min(c[0],e,o),c[1]=Math.min(c[1],t,l),c[2]=Math.max(c[2],e,o),c[3]=Math.max(c[3],t,l),D(this,p0,v7).call(this,e,i,r,o,t,s,a,l,3*(-e+3*(i-r)+o),6*(e-2*i+r),3*(i-e),c),D(this,p0,v7).call(this,e,i,r,o,t,s,a,l,3*(-t+3*(s-a)+l),6*(t-2*s+a),3*(s-t),c)}}p0=new WeakSet,Y9=function(e,t,i,s,r,a,o,l,c,h){if(c<=0||c>=1)return;const u=1-c,d=c*c,f=d*c,g=u*(u*(u*e+3*c*t)+3*d*i)+f*s,m=u*(u*(u*r+3*c*a)+3*d*o)+f*l;h[0]=Math.min(h[0],g),h[1]=Math.min(h[1],m),h[2]=Math.max(h[2],g),h[3]=Math.max(h[3],m)},v7=function(e,t,i,s,r,a,o,l,c,h,u,d){if(Math.abs(c)<1e-12){Math.abs(h)>=1e-12&&D(this,p0,Y9).call(this,e,t,i,s,r,a,o,l,-u/h,d);return}const f=h**2-4*u*c;if(f<0)return;const g=Math.sqrt(f),m=2*c;D(this,p0,Y9).call(this,e,t,i,s,r,a,o,l,(-h+g)/m,d),D(this,p0,Y9).call(this,e,t,i,s,r,a,o,l,(-h-g)/m,d)},B(Dn,p0);const mU=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function Tn(n,e=!1){if(n[0]>="ï"){let i;if(n[0]==="þ"&&n[1]==="ÿ"?(i="utf-16be",n.length%2===1&&(n=n.slice(0,-1))):n[0]==="ÿ"&&n[1]==="þ"?(i="utf-16le",n.length%2===1&&(n=n.slice(0,-1))):n[0]==="ï"&&n[1]==="»"&&n[2]==="¿"&&(i="utf-8"),i)try{const s=new TextDecoder(i,{fatal:!0}),r=cr(n),a=s.decode(r);return e||!a.includes("\x1B")?a:a.replaceAll(/\x1b[^\x1b]*(?:\x1b|$)/g,"")}catch(s){ce(`stringToPDFString: "${s}".`)}}const t=[];for(let i=0,s=n.length;i<s;i++){const r=n.charCodeAt(i);if(!e&&r===27){for(;++i<s&&n.charCodeAt(i)!==27;);continue}const a=mU[r];t.push(a?String.fromCharCode(a):n.charAt(i))}return t.join("")}function Lp(n){return decodeURIComponent(escape(n))}function k7(n){return unescape(encodeURIComponent(n))}function Bp(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function x0(n=new Date){return[n.getUTCFullYear().toString(),(n.getUTCMonth()+1).toString().padStart(2,"0"),n.getUTCDate().toString().padStart(2,"0"),n.getUTCHours().toString().padStart(2,"0"),n.getUTCMinutes().toString().padStart(2,"0"),n.getUTCSeconds().toString().padStart(2,"0")].join("")}let gw=null,Gv=null;function pU(n){return gw||(gw=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Gv=new Map([["ﬅ","ſt"]])),n.replaceAll(gw,(e,t,i)=>t?t.normalize("NFKC"):Gv.get(i))}const bU="pdfjs_internal_id_";function xU(n,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[i,s,...r]=t;if(!n(i)&&!Number.isInteger(i)||!e(s))return!1;const a=r.length;let o=!0;switch(s.name){case"XYZ":if(a<2||a>3)return!1;break;case"Fit":case"FitB":return a===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(a>1)return!1;break;case"FitR":if(a!==4)return!1;o=!1;break;default:return!1}for(const l of r)if(!(typeof l=="number"||o&&l===null))return!1;return!0}function zs(n,e,t){return Math.min(Math.max(n,e),t)}function Vv(n){return Uint8Array.prototype.toHex?n.toHex():Array.from(n,e=>e1[e]).join("")}function yU(n){return Uint8Array.fromBase64?Uint8Array.fromBase64(n):cr(atob(n))}typeof Promise.try!="function"&&(Promise.try=function(n,...e){return new Promise(t=>{t(n(...e))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(n){return n.reduce((e,t)=>e+t,0)});const wU=Symbol("CIRCULAR_REF"),Bs=Symbol("EOF");let J9=Object.create(null),Z9=Object.create(null),Sf=Object.create(null);function _U(){J9=Object.create(null),Z9=Object.create(null),Sf=Object.create(null)}class ve{constructor(e){this.name=e}static get(e){return Z9[e]||(Z9[e]=new ve(e))}}class ss{constructor(e){this.cmd=e}static get(e){return J9[e]||(J9[e]=new ss(e))}}const sR=function(){return sR};class fe{constructor(e=null){this._map=new Map,this.xref=e,this.objId=null,this.suppressEncryption=!1,this.__nonSerializable__=sR}assignXref(e){this.xref=e}get size(){return this._map.size}get(e,t,i){let s=this._map.get(e);return s===void 0&&t!==void 0&&(s=this._map.get(t),s===void 0&&i!==void 0&&(s=this._map.get(i))),s instanceof st&&this.xref?this.xref.fetch(s,this.suppressEncryption):s}async getAsync(e,t,i){let s=this._map.get(e);return s===void 0&&t!==void 0&&(s=this._map.get(t),s===void 0&&i!==void 0&&(s=this._map.get(i))),s instanceof st&&this.xref?this.xref.fetchAsync(s,this.suppressEncryption):s}getArray(e,t,i){let s=this._map.get(e);if(s===void 0&&t!==void 0&&(s=this._map.get(t),s===void 0&&i!==void 0&&(s=this._map.get(i))),s instanceof st&&this.xref&&(s=this.xref.fetch(s,this.suppressEncryption)),Array.isArray(s)){s=s.slice();for(let r=0,a=s.length;r<a;r++)s[r]instanceof st&&this.xref&&(s[r]=this.xref.fetch(s[r],this.suppressEncryption))}return s}getRaw(e){return this._map.get(e)}getKeys(){return[...this._map.keys()]}getRawValues(){return[...this._map.values()]}set(e,t){this._map.set(e,t)}has(e){return this._map.has(e)}*[Symbol.iterator](){for(const[e,t]of this._map)yield[e,t instanceof st&&this.xref?this.xref.fetch(t,this.suppressEncryption):t]}static get empty(){const e=new fe(null);return e.set=(t,i)=>{kn("Should not call `set` on the empty dictionary.")},Ze(this,"empty",e)}static merge({xref:e,dictArray:t,mergeSubDicts:i=!1}){const s=new fe(e),r=new Map;for(const a of t)if(a instanceof fe)for(const[o,l]of a._map){let c=r.get(o);if(c===void 0)c=[],r.set(o,c);else if(!i||!(l instanceof fe))continue;c.push(l)}for(const[a,o]of r){if(o.length===1||!(o[0]instanceof fe)){s._map.set(a,o[0]);continue}const l=new fe(e);for(const c of o)for(const[h,u]of c._map)l._map.has(h)||l._map.set(h,u);l.size>0&&s._map.set(a,l)}return r.clear(),s.size>0?s:fe.empty}clone(){const e=new fe(this.xref);for(const t of this.getKeys())e.set(t,this.getRaw(t));return e}delete(e){delete this._map[e]}}class st{constructor(e,t){this.num=e,this.gen=t}toString(){return this.gen===0?`${this.num}R`:`${this.num}R${this.gen}`}static fromString(e){const t=Sf[e];if(t)return t;const i=/^(\d+)R(\d*)$/.exec(e);return!i||i[1]==="0"?null:Sf[e]=new st(parseInt(i[1]),i[2]?parseInt(i[2]):0)}static get(e,t){const i=t===0?`${e}R`:`${e}R${t}`;return Sf[i]||(Sf[i]=new st(e,t))}}class Zi{constructor(e=null){this._set=new Set(e==null?void 0:e._set)}has(e){return this._set.has(e.toString())}put(e){this._set.add(e.toString())}remove(e){this._set.delete(e.toString())}[Symbol.iterator](){return this._set.values()}clear(){this._set.clear()}}class ca{constructor(){this._map=new Map}get size(){return this._map.size}get(e){return this._map.get(e.toString())}has(e){return this._map.has(e.toString())}put(e,t){this._map.set(e.toString(),t)}putAlias(e,t){this._map.set(e.toString(),this.get(t))}[Symbol.iterator](){return this._map.values()}clear(){this._map.clear()}*values(){yield*this._map.values()}*items(){for(const[e,t]of this._map)yield[st.fromString(e),t]}}function Di(n,e){return n instanceof ve&&(e===void 0||n.name===e)}function Ss(n,e){return n instanceof ss&&(e===void 0||n.cmd===e)}function rR(n,e){return n instanceof fe&&(e===void 0||Di(n.get("Type"),e))}function I3(n,e){return n.num===e.num&&n.gen===e.gen}class un{get length(){kn("Abstract getter `length` accessed")}get isEmpty(){kn("Abstract getter `isEmpty` accessed")}get isDataLoaded(){return Ze(this,"isDataLoaded",!0)}getByte(){kn("Abstract method `getByte` called")}getBytes(e){kn("Abstract method `getBytes` called")}async getImageData(e,t){return this.getBytes(e,t)}async asyncGetBytes(){kn("Abstract method `asyncGetBytes` called")}get isAsync(){return!1}get isAsyncDecoder(){return!1}get canAsyncDecodeImageFromBuffer(){return!1}async getTransferableImage(){return null}peekByte(){const e=this.getByte();return e!==-1&&this.pos--,e}peekBytes(e){const t=this.getBytes(e);return this.pos-=t.length,t}getUint16(){const e=this.getByte(),t=this.getByte();return e===-1||t===-1?-1:(e<<8)+t}getInt32(){const e=this.getByte(),t=this.getByte(),i=this.getByte(),s=this.getByte();return(e<<24)+(t<<16)+(i<<8)+s}getByteRange(e,t){kn("Abstract method `getByteRange` called")}getString(e){return da(this.getBytes(e))}skip(e){this.pos+=e||1}reset(){kn("Abstract method `reset` called")}moveStart(){kn("Abstract method `moveStart` called")}makeSubStream(e,t,i=null){kn("Abstract method `makeSubStream` called")}getBaseStreams(){return null}}const aR=/^[1-9]\.\d$/,C7=2**31-1,vU=-(2**31),el=[1,0,0,1,0,0],A7=["ColorSpace","ExtGState","Font","Pattern","Properties","Shading","XObject"],S7=["ExtGState","Font","Properties","XObject"];function Si(n){let e;return function(){return n&&(e=Object.create(null),n(e),n=null),e}}class xi extends $r{constructor(e,t){super(`Missing data [${e}, ${t})`,"MissingDataException"),this.begin=e,this.end=t}}class I7 extends $r{constructor(e){super(e,"ParserEOFException")}}class Eh extends $r{constructor(e){super(e,"XRefEntryException")}}class t1 extends $r{constructor(e){super(e,"XRefParseException")}}function oR(n){const e=n.length;if(e===0)return new Uint8Array(0);if(e===1)return new Uint8Array(n[0]);let t=0;for(let r=0;r<e;r++)t+=n[r].byteLength;const i=new Uint8Array(t);let s=0;for(let r=0;r<e;r++){const a=new Uint8Array(n[r]);i.set(a,s),s+=a.byteLength}return i}async function E7(n){const e=await fetch(n);if(!e.ok)throw new Error(`Failed to fetch file "${n}" with "${e.statusText}".`);return new Uint8Array(await e.arrayBuffer())}function fo({dict:n,key:e,getArray:t=!1,stopWhenFound:i=!0}){let s;const r=new Zi;for(;n instanceof fe&&!(n.objId&&r.has(n.objId));){n.objId&&r.put(n.objId);const a=t?n.getArray(e):n.get(e);if(a!==void 0){if(i)return a;(s||(s=[])).push(a)}n=n.get("Parent")}return s}function kU(n,e,t){const i=new Zi,s=n,r={dict:null,ref:null};for(;n instanceof fe&&!i.has(e)&&(i.put(e),!n.has("T"));){if(e=n.getRaw("Parent"),!(e instanceof st))return r;n=t.fetch(e)}return n instanceof fe&&n!==s&&(r.dict=n,r.ref=e),r}const mw=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];function CU(n,e=!1){Hs(Number.isInteger(n)&&n>0,"The number should be a positive integer.");const t="M".repeat(n/1e3|0)+mw[n%1e3/100|0]+mw[10+(n%100/10|0)]+mw[20+n%10];return e?t.toLowerCase():t}function y4(n){return n>0?Math.ceil(Math.log2(n)):0}function _l(n,e){return n[e]<<24>>24}function e0(n,e){return(n[e]<<24|n[e+1]<<16)>>16}function yn(n,e){return n[e]<<8|n[e+1]}function Yn(n,e){return(n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3])>>>0}function qa(n){return n===32||n===9||n===13||n===10}function AU(n,e){return Array.isArray(n)&&n.length===e&&n.every(t=>typeof t=="boolean")}function Vr(n,e){return Array.isArray(n)?(e===null||n.length===e)&&n.every(t=>typeof t=="number"):ArrayBuffer.isView(n)&&!(n instanceof BigInt64Array||n instanceof BigUint64Array)&&(e===null||n.length===e)}function Th(n,e){return Vr(n,6)?n:e}function T7(n,e){return Vr(n,4)?n:e}function y0(n,e){return Vr(n,4)?Dn.normalizeRect(n):e}function lR(n){const e=/(.+)\[(\d+)\]$/;return n.split(".").map(t=>{const i=t.match(e);return i?{name:i[1],pos:parseInt(i[2],10)}:{name:t,pos:0}})}function w4(n){const e=[];let t=0;for(let i=0,s=n.length;i<s;i++){const r=n.charCodeAt(i);(r<33||r>126||r===35||r===40||r===41||r===60||r===62||r===91||r===93||r===123||r===125||r===47||r===37)&&(t<i&&e.push(n.substring(t,i)),e.push(`#${r.toString(16)}`),t=i+1)}return e.length===0?n:(t<n.length&&e.push(n.substring(t,n.length)),e.join(""))}function Ig(n){return n.replaceAll(/([()\\\n\r])/g,e=>e===`
`?"\\n":e==="\r"?"\\r":`\\${e}`)}function E3(n,e,t,i){if(!n)return;let s=null;if(n instanceof st){if(i.has(n))return;s=n,i.put(s),n=e.fetch(n)}if(Array.isArray(n))for(const r of n)E3(r,e,t,i);else if(n instanceof fe){if(Di(n.get("S"),"JavaScript")){const r=n.get("JS");let a;r instanceof un?a=r.getString():typeof r=="string"&&(a=r),a&&(a=Tn(a,!0).replaceAll("\0","")),a&&t.push(a)}E3(n.getRaw("Next"),e,t,i)}s&&i.remove(s)}function ey(n,e,t){const i=Object.create(null),s=fo({dict:e,key:"AA",stopWhenFound:!1});if(s)for(let r=s.length-1;r>=0;r--){const a=s[r];if(a instanceof fe)for(const o of a.getKeys()){const l=t[o];if(!l)continue;const c=a.getRaw(o),h=new Zi,u=[];E3(c,n,u,h),u.length>0&&(i[l]=u)}}if(e.has("A")){const r=e.get("A"),a=new Zi,o=[];E3(r,n,o,a),o.length>0&&(i.Action=o)}return x4(i)>0?i:null}const SU={60:"&lt;",62:"&gt;",38:"&amp;",34:"&quot;",39:"&apos;"};function*IU(n){for(let e=0,t=n.length;e<t;e++){const i=n.codePointAt(e);i>55295&&(i<57344||i>65533)&&e++,yield i}}function n1(n){const e=[];let t=0;for(let i=0,s=n.length;i<s;i++){const r=n.codePointAt(i);if(32<=r&&r<=126){const a=SU[r];a&&(t<i&&e.push(n.substring(t,i)),e.push(a),t=i+1)}else t<i&&e.push(n.substring(t,i)),e.push(`&#x${r.toString(16).toUpperCase()};`),r>55295&&(r<57344||r>65533)&&i++,t=i+1}return e.length===0?n:(t<n.length&&e.push(n.substring(t,n.length)),e.join(""))}function R7(n,e=!1){const t=/^("|').*("|')$/.exec(n);if(t&&t[1]===t[2]){if(new RegExp(`[^\\\\]${t[1]}`).test(n.slice(1,-1)))return e&&ce(`FontFamily contains unescaped ${t[1]}: ${n}.`),!1}else for(const i of n.split(/[ \t]+/))if(/^(\d|(-(\d|-)))/.test(i)||!/^[\w-\\]+$/.test(i))return e&&ce(`FontFamily contains invalid <custom-ident>: ${n}.`),!1;return!0}function EU(n){const e="14",t="400",i=new Set(["100","200","300","400","500","600","700","800","900","1000","normal","bold","bolder","lighter"]),{fontFamily:s,fontWeight:r,italicAngle:a}=n;if(!R7(s,!0))return!1;const o=r?r.toString():"";n.fontWeight=i.has(o)?o:t;const l=parseFloat(a);return n.italicAngle=isNaN(l)||l<-90||l>90?e:a.toString(),!0}function cR(n){const e=["app.launchURL","window.open","xfa.host.gotoURL"],i=new RegExp("^\\s*("+e.join("|").replaceAll(".","\\.")+`)\\((?:'|")([^'"]*)(?:'|")(?:,\\s*(\\w+)\\)|\\))`,"i").exec(n);return i!=null&&i[2]?{url:i[2],newWindow:i[1]==="app.launchURL"&&i[3]==="true"}:null}function vn(n){if(Number.isInteger(n))return n.toString();const e=Math.round(n*100);return e%100===0?(e/100).toString():e%10===0?n.toFixed(1):n.toFixed(2)}function hR(n){if(!n)return null;const e=new Map;for(const[t,i]of n){if(!t.startsWith(tR))continue;let s=e.get(i.pageIndex);s||(s=[],e.set(i.pageIndex,s)),s.push(i)}return e.size>0?e:null}function go(n){return TU(n)?n:uR(n,!0)}function TU(n){return/^[\x00-\x7F]*$/.test(n)}function RU(n){const e=[];for(let t=0,i=n.length;t<i;t++){const s=n.charCodeAt(t);e.push(e1[s>>8&255],e1[s&255])}return e.join("")}function uR(n,e=!1){const t=[];e&&t.push("þÿ");for(let i=0,s=n.length;i<s;i++){const r=n.charCodeAt(i);t.push(String.fromCharCode(r>>8&255),String.fromCharCode(r&255))}return t.join("")}function T3(n,e,t){switch(n){case 90:return[0,1,-1,0,e,0];case 180:return[-1,0,0,-1,e,t];case 270:return[0,-1,1,0,0,t];default:throw new Error("Invalid rotation")}}function qv(n){return Math.ceil(Math.ceil(Math.log2(1+n))/8)}var Fb;class vi{static get _memoryArray(){const e=b(this,Fb);return e!=null&&e.byteLength?e:O(this,Fb,new Uint8Array(this._memory.buffer))}}Fb=new WeakMap,B(vi,Fb,null),He(vi,"_memory",null),He(vi,"_mustAddAlpha",!1),He(vi,"_destBuffer",null),He(vi,"_destOffset",0),He(vi,"_destLength",0),He(vi,"_cssColor",""),He(vi,"_makeHexColor",null);function MU(n,e){const{_mustAddAlpha:t,_destBuffer:i,_destOffset:s,_destLength:r,_memoryArray:a}=vi;if(e===r){i.set(a.subarray(n,n+e),s);return}if(t)for(let o=n,l=n+e,c=s;o<l;o+=3,c+=4)i[c]=a[o],i[c+1]=a[o+1],i[c+2]=a[o+2],i[c+3]=255;else for(let o=n,l=n+e,c=s;o<l;o+=3,c+=4)i[c]=a[o],i[c+1]=a[o+1],i[c+2]=a[o+2]}function PU(n){const{_destBuffer:e,_destOffset:t,_memoryArray:i}=vi;e[t]=i[n],e[t+1]=i[n+1],e[t+2]=i[n+2]}function NU(n){const{_memoryArray:e}=vi;vi._cssColor=vi._makeHexColor(e[n],e[n+1],e[n+2])}let Kr;const dR=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&dR.decode();let ap=null;function fR(){return(ap===null||ap.byteLength===0)&&(ap=new Uint8Array(Kr.memory.buffer)),ap}function OU(n,e){return n=n>>>0,dR.decode(fR().subarray(n,n+e))}let _4=0;function gR(n,e){const t=e(n.length*1,1)>>>0;return fR().set(n,t/1),_4=n.length,t}function DU(n,e){const t=gR(e,Kr.__wbindgen_malloc),i=_4;Kr.qcms_convert_array(n,t,i)}function FU(n,e,t){Kr.qcms_convert_one(n,e,t)}function LU(n,e,t,i,s){Kr.qcms_convert_three(n,e,t,i,s)}function BU(n,e,t,i,s,r){Kr.qcms_convert_four(n,e,t,i,s,r)}function UU(n,e,t){const i=gR(n,Kr.__wbindgen_malloc),s=_4;return Kr.qcms_transformer_from_memory(i,s,e,t)>>>0}function HU(n){Kr.qcms_drop_transformer(n)}const pw=Object.freeze({RGB8:0,0:"RGB8",RGBA8:1,1:"RGBA8",BGRA8:2,2:"BGRA8",Gray8:3,3:"Gray8",GrayA8:4,4:"GrayA8",CMYK:5,5:"CMYK"}),zU=Object.freeze({Perceptual:0,0:"Perceptual",RelativeColorimetric:1,1:"RelativeColorimetric",Saturation:2,2:"Saturation",AbsoluteColorimetric:3,3:"AbsoluteColorimetric"});function jU(){const n={};return n.wbg={},n.wbg.__wbg_copyresult_b08ee7d273f295dd=function(e,t){MU(e>>>0,t>>>0)},n.wbg.__wbg_copyrgb_d60ce17bb05d9b67=function(e){PU(e>>>0)},n.wbg.__wbg_makecssRGB_893bf0cd9fdb302d=function(e){NU(e>>>0)},n.wbg.__wbindgen_init_externref_table=function(){const e=Kr.__wbindgen_export_0,t=e.grow(4);e.set(0,void 0),e.set(t+0,void 0),e.set(t+1,null),e.set(t+2,!0),e.set(t+3,!1)},n.wbg.__wbindgen_throw=function(e,t){throw new Error(OU(e,t))},n}function GU(n,e){return Kr=n.exports,ap=null,Kr.__wbindgen_start(),Kr}function VU(n){if(Kr!==void 0)return Kr;typeof n<"u"&&(Object.getPrototypeOf(n)===Object.prototype?{module:n}=n:console.warn("using deprecated parameters for `initSync()`; pass a single object instead"));const e=jU();n instanceof WebAssembly.Module||(n=new WebAssembly.Module(n));const t=new WebAssembly.Instance(n,e);return GU(t)}function qU(n,e,t,i,s,r,a){a=a!==1?0:a;const l=t/s,c=i/r;let h=0,u;const d=new Uint16Array(s),f=t*3;for(let g=0;g<s;g++)d[g]=Math.floor(g*l)*3;for(let g=0;g<r;g++){const m=Math.floor(g*c)*f;for(let x=0;x<s;x++)u=m+d[x],e[h++]=n[u++],e[h++]=n[u++],e[h++]=n[u++],h+=a}}function WU(n,e,t,i,s,r,a){const o=t/s,l=i/r;let c=0;const h=new Uint16Array(s);if(a===1){for(let g=0;g<s;g++)h[g]=Math.floor(g*o);const u=new Uint32Array(n.buffer),d=new Uint32Array(e.buffer),f=fa.isLittleEndian?16777215:4294967040;for(let g=0;g<r;g++){const m=u.subarray(Math.floor(g*l)*t);for(let x=0;x<s;x++)d[c++]|=m[h[x]]&f}}else{const d=t*4;for(let f=0;f<s;f++)h[f]=Math.floor(f*o)*4;for(let f=0;f<r;f++){const g=n.subarray(Math.floor(f*l)*d);for(let m=0;m<s;m++){const x=h[m];e[c++]=g[x],e[c++]=g[x+1],e[c++]=g[x+2]}}}}function KU(n,e,t){if(t===1){const i=new Uint32Array(n.buffer),s=new Uint32Array(e.buffer),r=fa.isLittleEndian?16777215:4294967040;for(let a=0,o=i.length;a<o;a++)s[a]|=i[a]&r}else{let i=0;for(let s=0,r=n.length;s<r;s+=4)e[i++]=n[s],e[i++]=n[s+1],e[i++]=n[s+2]}}var M5;const Sp=class Sp{constructor(e,t){this.name=e,this.numComps=t}getRgb(e,t,i=new Uint8ClampedArray(3)){return this.getRgbItem(e,t,i,0),i}getRgbHex(e,t){const i=this.getRgb(e,t,b(Sp,M5));return Dn.makeHexColor(i[0],i[1],i[2])}getRgbItem(e,t,i,s){kn("Should not call ColorSpace.getRgbItem")}getRgbBuffer(e,t,i,s,r,a,o){kn("Should not call ColorSpace.getRgbBuffer")}getOutputLength(e,t){kn("Should not call ColorSpace.getOutputLength")}isPassthrough(e){return!1}isDefaultDecode(e,t){return Sp.isDefaultDecode(e,this.numComps)}fillRgb(e,t,i,s,r,a,o,l,c){const h=t*i;let u=null;const d=1<<o,f=i!==r||t!==s;if(this.isPassthrough(o))u=l;else if(this.numComps===1&&h>d&&this.name!=="DeviceGray"&&this.name!=="DeviceRGB"){const g=o<=8?new Uint8Array(d):new Uint16Array(d);for(let x=0;x<d;x++)g[x]=x;const m=new Uint8ClampedArray(d*3);if(this.getRgbBuffer(g,0,d,m,0,o,0),f){u=new Uint8Array(h*3);let x=0;for(let p=0;p<h;++p){const y=l[p]*3;u[x++]=m[y],u[x++]=m[y+1],u[x++]=m[y+2]}}else{let x=0;for(let p=0;p<h;++p){const y=l[p]*3;e[x++]=m[y],e[x++]=m[y+1],e[x++]=m[y+2],x+=c}}}else f?(u=new Uint8ClampedArray(h*3),this.getRgbBuffer(l,0,h,u,0,o,0)):this.getRgbBuffer(l,0,s*a,e,0,o,c);if(u)if(f)qU(u,e,t,i,s,r,c);else{let g=0,m=0;for(let x=0,p=s*a;x<p;x++)e[g++]=u[m++],e[g++]=u[m++],e[g++]=u[m++],g+=c}}get usesZeroToOneRange(){return Ze(this,"usesZeroToOneRange",!0)}static isDefaultDecode(e,t){if(!Array.isArray(e))return!0;if(t*2!==e.length)return ce("The decode map is not the correct length"),!0;for(let i=0,s=e.length;i<s;i+=2)if(e[i]!==0||e[i+1]!==1)return!1;return!0}};M5=new WeakMap,B(Sp,M5,new Uint8ClampedArray(3));let fr=Sp;class XU extends fr{constructor(e,t,i){super("Alternate",e),this.base=t,this.tintFn=i,this.tmpBuf=new Float32Array(t.numComps)}getRgbItem(e,t,i,s){const r=this.tmpBuf;this.tintFn(e,t,r,0),this.base.getRgbItem(r,0,i,s)}getRgbBuffer(e,t,i,s,r,a,o){const l=this.tintFn,c=this.base,h=1/((1<<a)-1),u=c.numComps,d=c.usesZeroToOneRange,f=(c.isPassthrough(8)||!d)&&o===0;let g=f?r:0;const m=f?s:new Uint8ClampedArray(u*i),x=this.numComps,p=new Float32Array(x),y=new Float32Array(u);let w,_;for(w=0;w<i;w++){for(_=0;_<x;_++)p[_]=e[t++]*h;if(l(p,0,y,0),d)for(_=0;_<u;_++)m[g++]=y[_]*255;else c.getRgbItem(y,0,m,g),g+=u}f||c.getRgbBuffer(m,0,i,s,r,8,o)}getOutputLength(e,t){return this.base.getOutputLength(e*this.base.numComps/this.numComps,t)}}class Wv extends fr{constructor(e){super("Pattern",null),this.base=e}isDefaultDecode(e,t){kn("Should not call PatternCS.isDefaultDecode")}}class YU extends fr{constructor(e,t,i){super("Indexed",1),this.base=e,this.highVal=t;const s=e.numComps*(t+1);if(this.lookup=new Uint8Array(s),i instanceof un){const r=i.getBytes(s);this.lookup.set(r)}else if(typeof i=="string")for(let r=0;r<s;++r)this.lookup[r]=i.charCodeAt(r)&255;else throw new Te(`IndexedCS - unrecognized lookup table: ${i}`)}getRgbItem(e,t,i,s){const{base:r,highVal:a,lookup:o}=this,l=zs(Math.round(e[t]),0,a)*r.numComps;r.getRgbBuffer(o,l,1,i,s,8,0)}getRgbBuffer(e,t,i,s,r,a,o){const{base:l,highVal:c,lookup:h}=this,{numComps:u}=l,d=l.getOutputLength(u,o);for(let f=0;f<i;++f){const g=zs(Math.round(e[t++]),0,c)*u;l.getRgbBuffer(h,g,1,s,r,8,o),r+=d}}getOutputLength(e,t){return this.base.getOutputLength(e*this.base.numComps,t)}isDefaultDecode(e,t){return Array.isArray(e)?e.length!==2?(ce("Decode map length is not correct"),!0):!Number.isInteger(t)||t<1?(ce("Bits per component is not correct"),!0):e[0]===0&&e[1]===(1<<t)-1:!0}}class JU extends fr{constructor(){super("DeviceGray",1)}getRgbItem(e,t,i,s){const r=e[t]*255;i[s]=i[s+1]=i[s+2]=r}getRgbBuffer(e,t,i,s,r,a,o){const l=255/((1<<a)-1);let c=t,h=r;for(let u=0;u<i;++u){const d=l*e[c++];s[h++]=d,s[h++]=d,s[h++]=d,h+=o}}getOutputLength(e,t){return e*(3+t)}}class ZU extends fr{constructor(){super("DeviceRGB",3)}getRgbItem(e,t,i,s){i[s]=e[t]*255,i[s+1]=e[t+1]*255,i[s+2]=e[t+2]*255}getRgbBuffer(e,t,i,s,r,a,o){if(a===8&&o===0){s.set(e.subarray(t,t+i*3),r);return}const l=255/((1<<a)-1);let c=t,h=r;for(let u=0;u<i;++u)s[h++]=l*e[c++],s[h++]=l*e[c++],s[h++]=l*e[c++],h+=o}getOutputLength(e,t){return e*(3+t)/3|0}isPassthrough(e){return e===8}}class QU extends fr{constructor(){super("DeviceRGBA",4)}getOutputLength(e,t){return e*4}isPassthrough(e){return e===8}fillRgb(e,t,i,s,r,a,o,l,c){i!==r||t!==s?WU(l,e,t,i,s,r,c):KU(l,e,c)}}var Lb,M7;class mR extends fr{constructor(){super("DeviceCMYK",4);B(this,Lb)}getRgbItem(t,i,s,r){D(this,Lb,M7).call(this,t,i,1,s,r)}getRgbBuffer(t,i,s,r,a,o,l){const c=1/((1<<o)-1);for(let h=0;h<s;h++)D(this,Lb,M7).call(this,t,i,c,r,a),i+=4,a+=3+l}getOutputLength(t,i){return t/4*(3+i)|0}}Lb=new WeakSet,M7=function(t,i,s,r,a){const o=t[i]*s,l=t[i+1]*s,c=t[i+2]*s,h=t[i+3]*s;r[a]=255+o*(-4.387332384609988*o+54.48615194189176*l+18.82290502165302*c+212.25662451639585*h+-285.2331026137004)+l*(1.7149763477362134*l-5.6096736904047315*c+-17.873870861415444*h-5.497006427196366)+c*(-2.5217340131683033*c-21.248923337353073*h+17.5119270841813)+h*(-21.86122147463605*h-189.48180835922747),r[a+1]=255+o*(8.841041422036149*o+60.118027045597366*l+6.871425592049007*c+31.159100130055922*h+-79.2970844816548)+l*(-15.310361306967817*l+17.575251261109482*c+131.35250912493976*h-190.9453302588951)+c*(4.444339102852739*c+9.8632861493405*h-24.86741582555878)+h*(-20.737325471181034*h-187.80453709719578),r[a+2]=255+o*(.8842522430003296*o+8.078677503112928*l+30.89978309703729*c-.23883238689178934*h+-14.183576799673286)+l*(10.49593273432072*l+63.02378494754052*c+50.606957656360734*h-112.23884253719248)+c*(.03296041114873217*c+115.60384449646641*h+-193.58209356861505)+h*(-22.33816807309886*h-180.12613974708367)};var Bb,P7;class $U extends fr{constructor(t,i,s){super("CalGray",1);B(this,Bb);if(!t)throw new Te("WhitePoint missing - required for color space CalGray");if([this.XW,this.YW,this.ZW]=t,[this.XB,this.YB,this.ZB]=i||[0,0,0],this.G=s||1,this.XW<0||this.ZW<0||this.YW!==1)throw new Te(`Invalid WhitePoint components for ${this.name}, no fallback available`);(this.XB<0||this.YB<0||this.ZB<0)&&(gn(`Invalid BlackPoint for ${this.name}, falling back to default.`),this.XB=this.YB=this.ZB=0),(this.XB!==0||this.YB!==0||this.ZB!==0)&&ce(`${this.name}, BlackPoint: XB: ${this.XB}, YB: ${this.YB}, ZB: ${this.ZB}, only default values are supported.`),this.G<1&&(gn(`Invalid Gamma: ${this.G} for ${this.name}, falling back to default.`),this.G=1)}getRgbItem(t,i,s,r){D(this,Bb,P7).call(this,t,i,s,r,1)}getRgbBuffer(t,i,s,r,a,o,l){const c=1/((1<<o)-1);for(let h=0;h<s;++h)D(this,Bb,P7).call(this,t,i,r,a,c),i+=1,a+=3+l}getOutputLength(t,i){return t*(3+i)}}Bb=new WeakSet,P7=function(t,i,s,r,a){const l=(t[i]*a)**this.G,c=this.YW*l,h=Math.max(295.8*c**.3333333333333333-40.8,0);s[r]=h,s[r+1]=h,s[r+2]=h};var Ub,Hb,P5,N5,zb,mg,jb,O5,ri,If,pR,bR,Q9,Ef,xR,yR,wR,O7;const Ri=class Ri extends fr{constructor(t,i,s,r){super("CalRGB",3);B(this,ri);if(!t)throw new Te("WhitePoint missing - required for color space CalRGB");const[a,o,l]=this.whitePoint=t,[c,h,u]=this.blackPoint=i||new Float32Array(3);if([this.GR,this.GG,this.GB]=s||new Float32Array([1,1,1]),[this.MXA,this.MYA,this.MZA,this.MXB,this.MYB,this.MZB,this.MXC,this.MYC,this.MZC]=r||new Float32Array([1,0,0,0,1,0,0,0,1]),a<0||l<0||o!==1)throw new Te(`Invalid WhitePoint components for ${this.name}, no fallback available`);(c<0||h<0||u<0)&&(gn(`Invalid BlackPoint for ${this.name} [${c}, ${h}, ${u}], falling back to default.`),this.blackPoint=new Float32Array(3)),(this.GR<0||this.GG<0||this.GB<0)&&(gn(`Invalid Gamma [${this.GR}, ${this.GG}, ${this.GB}] for ${this.name}, falling back to default.`),this.GR=this.GG=this.GB=1)}getRgbItem(t,i,s,r){D(this,ri,O7).call(this,t,i,s,r,1)}getRgbBuffer(t,i,s,r,a,o,l){const c=1/((1<<o)-1);for(let h=0;h<s;++h)D(this,ri,O7).call(this,t,i,r,a,c),i+=3,a+=3+l}getOutputLength(t,i){return t*(3+i)/3|0}};Ub=new WeakMap,Hb=new WeakMap,P5=new WeakMap,N5=new WeakMap,zb=new WeakMap,mg=new WeakMap,jb=new WeakMap,O5=new WeakMap,ri=new WeakSet,If=function(t,i,s){s[0]=t[0]*i[0]+t[1]*i[1]+t[2]*i[2],s[1]=t[3]*i[0]+t[4]*i[1]+t[5]*i[2],s[2]=t[6]*i[0]+t[7]*i[1]+t[8]*i[2]},pR=function(t,i,s){s[0]=i[0]*1/t[0],s[1]=i[1]*1/t[1],s[2]=i[2]*1/t[2]},bR=function(t,i,s){s[0]=i[0]*.95047/t[0],s[1]=i[1]*1/t[1],s[2]=i[2]*1.08883/t[2]},Q9=function(t){return t<=.0031308?zs(12.92*t,0,1):t>=.99554525?1:zs((1+.055)*t**(1/2.4)-.055,0,1)},Ef=function(t){return t<0?-D(this,ri,Ef).call(this,-t):t>8?((t+16)/116)**3:t*b(Ri,O5)},xR=function(t,i,s){if(t[0]===0&&t[1]===0&&t[2]===0){s[0]=i[0],s[1]=i[1],s[2]=i[2];return}const r=D(this,ri,Ef).call(this,0),a=r,o=D(this,ri,Ef).call(this,t[0]),l=r,c=D(this,ri,Ef).call(this,t[1]),h=r,u=D(this,ri,Ef).call(this,t[2]),d=(1-a)/(1-o),f=1-d,g=(1-l)/(1-c),m=1-g,x=(1-h)/(1-u),p=1-x;s[0]=i[0]*d+f,s[1]=i[1]*g+m,s[2]=i[2]*x+p},yR=function(t,i,s){if(t[0]===1&&t[2]===1){s[0]=i[0],s[1]=i[1],s[2]=i[2];return}const r=s;D(this,ri,If).call(this,b(Ri,Ub),i,r);const a=b(Ri,zb);D(this,ri,pR).call(this,t,r,a),D(this,ri,If).call(this,b(Ri,Hb),a,s)},wR=function(t,i,s){const r=s;D(this,ri,If).call(this,b(Ri,Ub),i,r);const a=b(Ri,zb);D(this,ri,bR).call(this,t,r,a),D(this,ri,If).call(this,b(Ri,Hb),a,s)},O7=function(t,i,s,r,a){const o=zs(t[i]*a,0,1),l=zs(t[i+1]*a,0,1),c=zs(t[i+2]*a,0,1),h=o===1?1:o**this.GR,u=l===1?1:l**this.GG,d=c===1?1:c**this.GB,f=this.MXA*h+this.MXB*u+this.MXC*d,g=this.MYA*h+this.MYB*u+this.MYC*d,m=this.MZA*h+this.MZB*u+this.MZC*d,x=b(Ri,mg);x[0]=f,x[1]=g,x[2]=m;const p=b(Ri,jb);D(this,ri,yR).call(this,this.whitePoint,x,p);const y=b(Ri,mg);D(this,ri,xR).call(this,this.blackPoint,p,y);const w=b(Ri,jb);D(this,ri,wR).call(this,b(Ri,N5),y,w);const _=b(Ri,mg);D(this,ri,If).call(this,b(Ri,P5),w,_),s[r]=D(this,ri,Q9).call(this,_[0])*255,s[r+1]=D(this,ri,Q9).call(this,_[1])*255,s[r+2]=D(this,ri,Q9).call(this,_[2])*255},B(Ri,Ub,new Float32Array([.8951,.2664,-.1614,-.7502,1.7135,.0367,.0389,-.0685,1.0296])),B(Ri,Hb,new Float32Array([.9869929,-.1470543,.1599627,.4323053,.5183603,.0492912,-.0085287,.0400428,.9684867])),B(Ri,P5,new Float32Array([3.2404542,-1.5371385,-.4985314,-.969266,1.8760108,.041556,.0556434,-.2040259,1.0572252])),B(Ri,N5,new Float32Array([1,1,1])),B(Ri,zb,new Float32Array(3)),B(Ri,mg,new Float32Array(3)),B(Ri,jb,new Float32Array(3)),B(Ri,O5,(24/116)**3/8);let N7=Ri;var Ka,$9,e3,D7;class eH extends fr{constructor(t,i,s){super("Lab",3);B(this,Ka);if(!t)throw new Te("WhitePoint missing - required for color space Lab");if([this.XW,this.YW,this.ZW]=t,[this.amin,this.amax,this.bmin,this.bmax]=s||[-100,100,-100,100],[this.XB,this.YB,this.ZB]=i||[0,0,0],this.XW<0||this.ZW<0||this.YW!==1)throw new Te("Invalid WhitePoint components, no fallback available");(this.XB<0||this.YB<0||this.ZB<0)&&(gn("Invalid BlackPoint, falling back to default"),this.XB=this.YB=this.ZB=0),(this.amin>this.amax||this.bmin>this.bmax)&&(gn("Invalid Range, falling back to defaults"),this.amin=-100,this.amax=100,this.bmin=-100,this.bmax=100)}getRgbItem(t,i,s,r){D(this,Ka,D7).call(this,t,i,!1,s,r)}getRgbBuffer(t,i,s,r,a,o,l){const c=(1<<o)-1;for(let h=0;h<s;h++)D(this,Ka,D7).call(this,t,i,c,r,a),i+=3,a+=3+l}getOutputLength(t,i){return t*(3+i)/3|0}isDefaultDecode(t,i){return!0}get usesZeroToOneRange(){return Ze(this,"usesZeroToOneRange",!1)}}Ka=new WeakSet,$9=function(t){return t>=6/29?t**3:108/841*(t-4/29)},e3=function(t,i,s,r){return s+t*(r-s)/i},D7=function(t,i,s,r,a){let o=t[i],l=t[i+1],c=t[i+2];s!==!1&&(o=D(this,Ka,e3).call(this,o,s,0,100),l=D(this,Ka,e3).call(this,l,s,this.amin,this.amax),c=D(this,Ka,e3).call(this,c,s,this.bmin,this.bmax)),l>this.amax?l=this.amax:l<this.amin&&(l=this.amin),c>this.bmax?c=this.bmax:c<this.bmin&&(c=this.bmin);const h=(o+16)/116,u=h+l/500,d=h-c/200,f=this.XW*D(this,Ka,$9).call(this,u),g=this.YW*D(this,Ka,$9).call(this,h),m=this.ZW*D(this,Ka,$9).call(this,d);let x,p,y;this.ZW<1?(x=f*3.1339+g*-1.617+m*-.4906,p=f*-.9785+g*1.916+m*.0333,y=f*.072+g*-.229+m*1.4057):(x=f*3.2406+g*-1.5372+m*-.4986,p=f*-.9689+g*1.8758+m*.0415,y=f*.0557+g*-.204+m*1.057),r[a]=Math.sqrt(x)*255,r[a+1]=Math.sqrt(p)*255,r[a+2]=Math.sqrt(y)*255};function _R(n){const e=new XMLHttpRequest;return e.open("GET",n,!1),e.responseType="arraybuffer",e.send(null),e.response}var Gl,wh,pg,bg,D5;const bu=class bu extends fr{constructor(t,i,s){if(!bu.isUsable)throw new Error("No ICC color space support");super(i,s);B(this,Gl);B(this,wh);let r;switch(s){case 1:r=pw.Gray8,O(this,wh,(a,o,l)=>FU(b(this,Gl),a[o]*255,l));break;case 3:r=pw.RGB8,O(this,wh,(a,o,l)=>LU(b(this,Gl),a[o]*255,a[o+1]*255,a[o+2]*255,l));break;case 4:r=pw.CMYK,O(this,wh,(a,o,l)=>BU(b(this,Gl),a[o]*255,a[o+1]*255,a[o+2]*255,a[o+3]*255,l));break;default:throw new Error(`Unsupported number of components: ${s}`)}if(O(this,Gl,UU(t,r,zU.Perceptual)),!b(this,Gl))throw new Error("Failed to create ICC color space");b(bu,D5).register(this,b(this,Gl))}getRgbHex(t,i){return b(this,wh).call(this,t,i,!0),vi._cssColor}getRgbItem(t,i,s,r){vi._destBuffer=s,vi._destOffset=r,vi._destLength=3,b(this,wh).call(this,t,i,!1),vi._destBuffer=null}getRgbBuffer(t,i,s,r,a,o,l){if(t=t.subarray(i,i+s*this.numComps),o!==8){const c=255/((1<<o)-1);for(let h=0,u=t.length;h<u;h++)t[h]*=c}vi._mustAddAlpha=l&&r.buffer===t.buffer,vi._destBuffer=r,vi._destOffset=a,vi._destLength=s*(3+l),DU(b(this,Gl),t),vi._mustAddAlpha=!1,vi._destBuffer=null}getOutputLength(t,i){return t/this.numComps*(3+i)|0}static setOptions({useWasm:t,useWorkerFetch:i,wasmUrl:s}){if(!i){O(this,pg,!1);return}O(this,pg,t),O(this,bg,s)}static get isUsable(){let t=!1;if(b(this,pg))if(b(this,bg))try{this._module=VU({module:_R(`${b(this,bg)}qcms_bg.wasm`)}),t=!!this._module,vi._memory=this._module.memory,vi._makeHexColor=Dn.makeHexColor}catch(i){ce(`ICCBased color space: "${i}".`)}else ce("No ICC color space support due to missing `wasmUrl` API option");return Ze(this,"isUsable",t)}};Gl=new WeakMap,wh=new WeakMap,pg=new WeakMap,bg=new WeakMap,D5=new WeakMap,B(bu,pg,!0),B(bu,bg,null),B(bu,D5,new FinalizationRegistry(t=>{HU(t)}));let Kd=bu;var xg;const F5=class F5 extends Kd{constructor(){const e=new Uint8Array(_R(`${b(F5,xg)}CGATS001Compat-v2-micro.icc`));super(e,"DeviceCMYK",4)}static setOptions({iccUrl:e}){O(this,xg,e)}static get isUsable(){let e=!1;return Kd.isUsable&&(b(this,xg)?e=!0:ce("No CMYK ICC profile support due to missing `iccUrl` API option")),Ze(this,"isUsable",e)}};xg=new WeakMap,B(F5,xg);let Up=F5;class Hi extends un{constructor(e,t,i,s){super(),this.bytes=e instanceof Uint8Array?e:new Uint8Array(e),this.start=t||0,this.pos=this.start,this.end=t+i||this.bytes.length,this.dict=s}get length(){return this.end-this.start}get isEmpty(){return this.length===0}getByte(){return this.pos>=this.end?-1:this.bytes[this.pos++]}getBytes(e){const t=this.bytes,i=this.pos,s=this.end;if(!e)return t.subarray(i,s);let r=i+e;return r>s&&(r=s),this.pos=r,t.subarray(i,r)}getByteRange(e,t){return e<0&&(e=0),t>this.end&&(t=this.end),this.bytes.subarray(e,t)}reset(){this.pos=this.start}moveStart(){this.start=this.pos}makeSubStream(e,t,i=null){return new Hi(this.bytes.buffer,e,t,i)}}class Jr extends Hi{constructor(e){super(cr(e))}}class F7 extends Hi{constructor(){super(new Uint8Array(0))}}class tH extends Hi{constructor(e,t,i){super(new Uint8Array(e),0,e,null),this.chunkSize=t,this._loadedChunks=new Set,this.numChunks=Math.ceil(e/t),this.manager=i,this.progressiveDataLength=0,this.lastSuccessfulEnsureByteChunk=-1}getMissingChunks(){const e=[];for(let t=0,i=this.numChunks;t<i;++t)this._loadedChunks.has(t)||e.push(t);return e}get numChunksLoaded(){return this._loadedChunks.size}get isDataLoaded(){return this.numChunksLoaded===this.numChunks}onReceiveData(e,t){const i=this.chunkSize;if(e%i!==0)throw new Error(`Bad begin offset: ${e}`);const s=e+t.byteLength;if(s%i!==0&&s!==this.bytes.length)throw new Error(`Bad end offset: ${s}`);this.bytes.set(new Uint8Array(t),e);const r=Math.floor(e/i),a=Math.floor((s-1)/i)+1;for(let o=r;o<a;++o)this._loadedChunks.add(o)}onReceiveProgressiveData(e){let t=this.progressiveDataLength;const i=Math.floor(t/this.chunkSize);this.bytes.set(new Uint8Array(e),t),t+=e.byteLength,this.progressiveDataLength=t;const s=t>=this.end?this.numChunks:Math.floor(t/this.chunkSize);for(let r=i;r<s;++r)this._loadedChunks.add(r)}ensureByte(e){if(e<this.progressiveDataLength)return;const t=Math.floor(e/this.chunkSize);if(!(t>this.numChunks)&&t!==this.lastSuccessfulEnsureByteChunk){if(!this._loadedChunks.has(t))throw new xi(e,e+1);this.lastSuccessfulEnsureByteChunk=t}}ensureRange(e,t){if(e>=t||t<=this.progressiveDataLength)return;const i=Math.floor(e/this.chunkSize);if(i>this.numChunks)return;const s=Math.min(Math.floor((t-1)/this.chunkSize)+1,this.numChunks);for(let r=i;r<s;++r)if(!this._loadedChunks.has(r))throw new xi(e,t)}nextEmptyChunk(e){const t=this.numChunks;for(let i=0;i<t;++i){const s=(e+i)%t;if(!this._loadedChunks.has(s))return s}return null}hasChunk(e){return this._loadedChunks.has(e)}getByte(){const e=this.pos;return e>=this.end?-1:(e>=this.progressiveDataLength&&this.ensureByte(e),this.bytes[this.pos++])}getBytes(e){const t=this.bytes,i=this.pos,s=this.end;if(!e)return s>this.progressiveDataLength&&this.ensureRange(i,s),t.subarray(i,s);let r=i+e;return r>s&&(r=s),r>this.progressiveDataLength&&this.ensureRange(i,r),this.pos=r,t.subarray(i,r)}getByteRange(e,t){return e<0&&(e=0),t>this.end&&(t=this.end),t>this.progressiveDataLength&&this.ensureRange(e,t),this.bytes.subarray(e,t)}makeSubStream(e,t,i=null){t?e+t>this.progressiveDataLength&&this.ensureRange(e,e+t):e>=this.progressiveDataLength&&this.ensureByte(e);function s(){}s.prototype=Object.create(this),s.prototype.getMissingChunks=function(){const a=this.chunkSize,o=Math.floor(this.start/a),l=Math.floor((this.end-1)/a)+1,c=[];for(let h=o;h<l;++h)this._loadedChunks.has(h)||c.push(h);return c},Object.defineProperty(s.prototype,"isDataLoaded",{get(){return this.numChunksLoaded===this.numChunks?!0:this.getMissingChunks().length===0},configurable:!0});const r=new s;return r.pos=r.start=e,r.end=e+t||this.end,r.dict=i,r}getBaseStreams(){return[this]}}class nH{constructor(e,t){this.length=t.length,this.chunkSize=t.rangeChunkSize,this.stream=new tH(this.length,this.chunkSize,this),this.pdfNetworkStream=e,this.disableAutoFetch=t.disableAutoFetch,this.msgHandler=t.msgHandler,this.currRequestId=0,this._chunksNeededByRequest=new Map,this._requestsByChunk=new Map,this._promisesByRequest=new Map,this.progressiveDataLength=0,this.aborted=!1,this._loadedStreamCapability=Promise.withResolvers()}sendRequest(e,t){const i=this.pdfNetworkStream.getRangeReader(e,t);i.isStreamingSupported||(i.onProgress=this.onProgress.bind(this));let s=[],r=0;return new Promise((a,o)=>{const l=({value:c,done:h})=>{try{if(h){const u=oR(s);s=null,a(u);return}r+=c.byteLength,i.isStreamingSupported&&this.onProgress({loaded:r}),s.push(c),i.read().then(l,o)}catch(u){o(u)}};i.read().then(l,o)}).then(a=>{this.aborted||this.onReceiveData({chunk:a,begin:e})})}requestAllChunks(e=!1){if(!e){const t=this.stream.getMissingChunks();this._requestChunks(t)}return this._loadedStreamCapability.promise}_requestChunks(e){const t=this.currRequestId++,i=new Set;this._chunksNeededByRequest.set(t,i);for(const a of e)this.stream.hasChunk(a)||i.add(a);if(i.size===0)return Promise.resolve();const s=Promise.withResolvers();this._promisesByRequest.set(t,s);const r=[];for(const a of i){let o=this._requestsByChunk.get(a);o||(o=[],this._requestsByChunk.set(a,o),r.push(a)),o.push(t)}if(r.length>0){const a=this.groupChunks(r);for(const o of a){const l=o.beginChunk*this.chunkSize,c=Math.min(o.endChunk*this.chunkSize,this.length);this.sendRequest(l,c).catch(s.reject)}}return s.promise.catch(a=>{if(!this.aborted)throw a})}getStream(){return this.stream}requestRange(e,t){t=Math.min(t,this.length);const i=this.getBeginChunk(e),s=this.getEndChunk(t),r=[];for(let a=i;a<s;++a)r.push(a);return this._requestChunks(r)}requestRanges(e=[]){const t=[];for(const i of e){const s=this.getBeginChunk(i.begin),r=this.getEndChunk(i.end);for(let a=s;a<r;++a)t.includes(a)||t.push(a)}return t.sort((i,s)=>i-s),this._requestChunks(t)}groupChunks(e){const t=[];let i=-1,s=-1;for(let r=0,a=e.length;r<a;++r){const o=e[r];i<0&&(i=o),s>=0&&s+1!==o&&(t.push({beginChunk:i,endChunk:s+1}),i=o),r+1===e.length&&t.push({beginChunk:i,endChunk:o+1}),s=o}return t}onProgress(e){this.msgHandler.send("DocProgress",{loaded:this.stream.numChunksLoaded*this.chunkSize+e.loaded,total:this.length})}onReceiveData(e){const t=e.chunk,i=e.begin===void 0,s=i?this.progressiveDataLength:e.begin,r=s+t.byteLength,a=Math.floor(s/this.chunkSize),o=r<this.length?Math.floor(r/this.chunkSize):Math.ceil(r/this.chunkSize);i?(this.stream.onReceiveProgressiveData(t),this.progressiveDataLength=r):this.stream.onReceiveData(s,t),this.stream.isDataLoaded&&this._loadedStreamCapability.resolve(this.stream);const l=[];for(let c=a;c<o;++c){const h=this._requestsByChunk.get(c);if(h){this._requestsByChunk.delete(c);for(const u of h){const d=this._chunksNeededByRequest.get(u);d.has(c)&&d.delete(c),!(d.size>0)&&l.push(u)}}}if(!this.disableAutoFetch&&this._requestsByChunk.size===0){let c;if(this.stream.numChunksLoaded===1){const h=this.stream.numChunks-1;this.stream.hasChunk(h)||(c=h)}else c=this.stream.nextEmptyChunk(o);Number.isInteger(c)&&this._requestChunks([c])}for(const c of l){const h=this._promisesByRequest.get(c);this._promisesByRequest.delete(c),h.resolve()}this.msgHandler.send("DocProgress",{loaded:this.stream.numChunksLoaded*this.chunkSize,total:this.length})}onError(e){this._loadedStreamCapability.reject(e)}getBeginChunk(e){return Math.floor(e/this.chunkSize)}getEndChunk(e){return Math.floor((e-1)/this.chunkSize)+1}abort(e){var t;this.aborted=!0,(t=this.pdfNetworkStream)==null||t.cancelAllRequests(e);for(const i of this._promisesByRequest.values())i.reject(e)}}function vR(n){switch(n.kind){case Fs.GRAYSCALE_1BPP:return L7(n);case Fs.RGB_24BPP:return iH(n)}return null}function L7({src:n,srcPos:e=0,dest:t,width:i,height:s,nonBlackColor:r=4294967295,inverseDecode:a=!1}){const o=fa.isLittleEndian?4278190080:255,[l,c]=a?[r,o]:[o,r],h=i>>3,u=i&7,d=n.length;t=new Uint32Array(t.buffer);let f=0;for(let g=0;g<s;g++){for(const x=e+h;e<x;e++){const p=e<d?n[e]:255;t[f++]=p&128?c:l,t[f++]=p&64?c:l,t[f++]=p&32?c:l,t[f++]=p&16?c:l,t[f++]=p&8?c:l,t[f++]=p&4?c:l,t[f++]=p&2?c:l,t[f++]=p&1?c:l}if(u===0)continue;const m=e<d?n[e++]:255;for(let x=0;x<u;x++)t[f++]=m&1<<7-x?c:l}return{srcPos:e,destPos:f}}function iH({src:n,srcPos:e=0,dest:t,destPos:i=0,width:s,height:r}){let a=0;const o=s*r*3,l=o>>2,c=new Uint32Array(n.buffer,e,l);if(fa.isLittleEndian){for(;a<l-2;a+=3,i+=4){const h=c[a],u=c[a+1],d=c[a+2];t[i]=h|4278190080,t[i+1]=h>>>24|u<<8|4278190080,t[i+2]=u>>>16|d<<16|4278190080,t[i+3]=d>>>8|4278190080}for(let h=a*4,u=e+o;h<u;h+=3)t[i++]=n[h]|n[h+1]<<8|n[h+2]<<16|4278190080}else{for(;a<l-2;a+=3,i+=4){const h=c[a],u=c[a+1],d=c[a+2];t[i]=h|255,t[i+1]=h<<24|u>>>8|255,t[i+2]=u<<16|d>>>16|255,t[i+3]=d<<8|255}for(let h=a*4,u=e+o;h<u;h+=3)t[i++]=n[h]<<24|n[h+1]<<16|n[h+2]<<8|255}return{srcPos:e+o,destPos:i}}function sH(n,e){if(fa.isLittleEndian)for(let t=0,i=n.length;t<i;t++)e[t]=n[t]*65793|4278190080;else for(let t=0,i=n.length;t<i;t++)e[t]=n[t]*16843008|255}const Kv=2048,rH=65537,Xv=128;var ao,Gb,L5,kR;const N0=class N0{constructor(e,t){B(this,L5);this._imgData=e,this._isMask=t}static get canUseImageDecoder(){return Ze(this,"canUseImageDecoder",b(this,Gb)?ImageDecoder.isTypeSupported("image/bmp"):Promise.resolve(!1))}static needsToBeResized(e,t){if(e<=b(this,ao)&&t<=b(this,ao))return!1;const{MAX_DIM:i}=this;if(e>i||t>i)return!0;const s=e*t;if(this._hasMaxArea)return s>this.MAX_AREA;if(s<b(this,ao)**2)return!1;if(this._areGoodDims(e,t))return O(this,ao,Math.max(b(this,ao),Math.floor(Math.sqrt(e*t)))),!1;O(this,ao,this._guessMax(b(this,ao),i,Xv,0));const r=this.MAX_AREA=b(this,ao)**2;return s>r}static getReducePowerForJPX(e,t,i){const s=e*t,r=2**30/(i*4);if(!this.needsToBeResized(e,t))return s>r?Math.ceil(Math.log2(s/r)):0;const{MAX_DIM:a,MAX_AREA:o}=this,l=Math.max(e/a,t/a,Math.sqrt(s/Math.min(r,o)));return Math.ceil(Math.log2(l))}static get MAX_DIM(){return Ze(this,"MAX_DIM",this._guessMax(Kv,rH,0,1))}static get MAX_AREA(){return this._hasMaxArea=!0,Ze(this,"MAX_AREA",this._guessMax(b(this,ao),this.MAX_DIM,Xv,0)**2)}static set MAX_AREA(e){e>=0&&(this._hasMaxArea=!0,Ze(this,"MAX_AREA",e))}static setOptions({canvasMaxAreaInBytes:e=-1,isImageDecoderSupported:t=!1}){this._hasMaxArea||(this.MAX_AREA=e>>2),O(this,Gb,t)}static _areGoodDims(e,t){try{const i=new OffscreenCanvas(e,t),s=i.getContext("2d");s.fillRect(0,0,1,1);const r=s.getImageData(0,0,1,1).data[3];return i.width=i.height=1,r!==0}catch{return!1}}static _guessMax(e,t,i,s){for(;e+i+1<t;){const r=Math.floor((e+t)/2),a=s||r;this._areGoodDims(r,a)?e=r:t=r}return e}static async createImage(e,t=!1){return new N0(e,t)._createImage()}async _createImage(){const{_imgData:e}=this,{width:t,height:i}=e;if(t*i*4>C7){const y=D(this,L5,kR).call(this);if(y)return y}const s=this._encodeBMP();let r,a;await N0.canUseImageDecoder?(r=new ImageDecoder({data:s,type:"image/bmp",preferAnimation:!1,transfer:[s.buffer]}),a=r.decode().catch(y=>(ce(`BMP image decoding failed: ${y}`),createImageBitmap(new Blob([this._encodeBMP().buffer],{type:"image/bmp"})))).finally(()=>{r.close()})):a=createImageBitmap(new Blob([s.buffer],{type:"image/bmp"}));const{MAX_AREA:o,MAX_DIM:l}=N0,c=Math.max(t/l,i/l,Math.sqrt(t*i/o)),h=Math.max(c,2),u=Math.round(10*(c+1.25))/10/h,d=Math.floor(Math.log2(u)),f=new Array(d+2).fill(2);f[0]=h,f.splice(-1,1,u/(1<<d));let g=t,m=i;const x=await a;let p=x.image||x;for(const y of f){const w=g,_=m;g=Math.floor(g/y)-1,m=Math.floor(m/y)-1;const v=new OffscreenCanvas(g,m);v.getContext("2d").drawImage(p,0,0,w,_,0,0,g,m),p.close(),p=v.transferToImageBitmap()}return e.data=null,e.bitmap=p,e.width=g,e.height=m,e}_encodeBMP(){const{width:e,height:t,kind:i}=this._imgData;let s=this._imgData.data,r,a=new Uint8Array(0),o=a,l=0;switch(i){case Fs.GRAYSCALE_1BPP:{r=1,a=new Uint8Array(this._isMask?[255,255,255,255,0,0,0,0]:[0,0,0,0,255,255,255,255]);const m=e+7>>3,x=m+3&-4;if(m!==x){const p=new Uint8Array(x*t);let y=0;for(let w=0,_=t*m;w<_;w+=m,y+=x)p.set(s.subarray(w,w+m),y);s=p}break}case Fs.RGB_24BPP:{if(r=24,e&3){const m=3*e,x=m+3&-4,p=x-m,y=new Uint8Array(x*t);let w=0;for(let _=0,v=t*m;_<v;_+=m){const C=s.subarray(_,_+m);for(let k=0;k<m;k+=3)y[w++]=C[k+2],y[w++]=C[k+1],y[w++]=C[k];w+=p}s=y}else for(let m=0,x=s.length;m<x;m+=3){const p=s[m];s[m]=s[m+2],s[m+2]=p}break}case Fs.RGBA_32BPP:r=32,l=3,o=new Uint8Array(68);const g=new DataView(o.buffer);fa.isLittleEndian?(g.setUint32(0,255,!0),g.setUint32(4,65280,!0),g.setUint32(8,16711680,!0),g.setUint32(12,4278190080,!0)):(g.setUint32(0,4278190080,!0),g.setUint32(4,16711680,!0),g.setUint32(8,65280,!0),g.setUint32(12,255,!0));break;default:throw new Error("invalid format")}let c=0;const h=40+o.length,u=14+h+a.length+s.length,d=new Uint8Array(u),f=new DataView(d.buffer);return f.setUint16(c,19778,!0),c+=2,f.setUint32(c,u,!0),c+=4,f.setUint32(c,0,!0),c+=4,f.setUint32(c,14+h+a.length,!0),c+=4,f.setUint32(c,h,!0),c+=4,f.setInt32(c,e,!0),c+=4,f.setInt32(c,-t,!0),c+=4,f.setUint16(c,1,!0),c+=2,f.setUint16(c,r,!0),c+=2,f.setUint32(c,l,!0),c+=4,f.setUint32(c,0,!0),c+=4,f.setInt32(c,0,!0),c+=4,f.setInt32(c,0,!0),c+=4,f.setUint32(c,a.length/4,!0),c+=4,f.setUint32(c,0,!0),c+=4,d.set(o,c),c+=o.length,d.set(a,c),c+=a.length,d.set(s,c),d}};ao=new WeakMap,Gb=new WeakMap,L5=new WeakSet,kR=function(){const{_imgData:e}=this,{data:t,width:i,height:s,kind:r}=e,a=i*s*4,o=Math.ceil(Math.log2(a/C7)),l=i>>o,c=s>>o;let h,u=s;try{h=new Uint8Array(a)}catch{let _=Math.floor(Math.log2(a+1));for(;;)try{h=new Uint8Array(2**_-1);break}catch{_-=1}u=Math.floor((2**_-1)/(i*4));const v=i*u*4;v<h.length&&(h=new Uint8Array(v))}const d=new Uint32Array(h.buffer),f=new Uint32Array(l*c);let g=0,m=0;const x=Math.ceil(s/u),p=s%u===0?s:s%u;for(let _=0;_<x;_++){const v=_<x-1?u:p;({srcPos:g}=vR({kind:r,src:t,dest:d,width:i,height:v,inverseDecode:this._isMask,srcPos:g}));for(let C=0,k=v>>o;C<k;C++){const I=d.subarray((C<<o)*i);for(let S=0;S<l;S++)f[m++]=I[S<<o]}}if(N0.needsToBeResized(l,c))return e.data=f,e.width=l,e.height=c,e.kind=Fs.RGBA_32BPP,null;const y=new OffscreenCanvas(l,c);return y.getContext("2d",{willReadFrequently:!0}).putImageData(new ImageData(new Uint8ClampedArray(f.buffer),l,c),0,0),e.data=null,e.bitmap=y.transferToImageBitmap(),e.width=l,e.height=c,e},B(N0,ao,Kv),B(N0,Gb,fa.isImageDecoderSupported);let Ro=N0;const aH=new Uint8Array(0);class Zr extends un{constructor(e){if(super(),this._rawMinBufferLength=e||0,this.pos=0,this.bufferLength=0,this.eof=!1,this.buffer=aH,this.minBufferLength=512,e)for(;this.minBufferLength<e;)this.minBufferLength*=2}get isEmpty(){for(;!this.eof&&this.bufferLength===0;)this.readBlock();return this.bufferLength===0}ensureBuffer(e){const t=this.buffer;if(e<=t.byteLength)return t;let i=this.minBufferLength;for(;i<e;)i*=2;const s=new Uint8Array(i);return s.set(t),this.buffer=s}getByte(){const e=this.pos;for(;this.bufferLength<=e;){if(this.eof)return-1;this.readBlock()}return this.buffer[this.pos++]}getBytes(e,t=null){const i=this.pos;let s;if(e){for(this.ensureBuffer(i+e),s=i+e;!this.eof&&this.bufferLength<s;)this.readBlock(t);const r=this.bufferLength;s>r&&(s=r)}else{for(;!this.eof;)this.readBlock(t);s=this.bufferLength}return this.pos=s,this.buffer.subarray(i,s)}async getImageData(e,t){if(!this.canAsyncDecodeImageFromBuffer)return this.isAsyncDecoder?this.decodeImage(null,t):this.getBytes(e,t);const i=await this.stream.asyncGetBytes();return this.decodeImage(i,t)}reset(){this.pos=0}makeSubStream(e,t,i=null){if(t===void 0)for(;!this.eof;)this.readBlock();else{const s=e+t;for(;this.bufferLength<=s&&!this.eof;)this.readBlock()}return new Hi(this.buffer,e,t,i)}getBaseStreams(){return this.str?this.str.getBaseStreams():null}}class oH extends Zr{constructor(e,t=null){e=e.filter(s=>s instanceof un);let i=0;for(const s of e)i+=s instanceof Zr?s._rawMinBufferLength:s.length;super(i),this.streams=e,this._onError=t}readBlock(){var o;const e=this.streams;if(e.length===0){this.eof=!0;return}const t=e.shift();let i;try{i=t.getBytes()}catch(l){if(this._onError){this._onError(l,(o=t.dict)==null?void 0:o.objId);return}throw l}const s=this.bufferLength,r=s+i.length;this.ensureBuffer(r).set(i,s),this.bufferLength=r}getBaseStreams(){const e=[];for(const t of this.streams){const i=t.getBaseStreams();i&&e.push(...i)}return e.length>0?e:null}}var $o,op,t3;class Nn{static parse({cs:e,xref:t,resources:i=null,pdfFunctionFactory:s,globalColorSpaceCache:r,localColorSpaceCache:a,asyncIfNotCached:o=!1}){const l={xref:t,resources:i,pdfFunctionFactory:s,globalColorSpaceCache:r,localColorSpaceCache:a};let c,h,u;if(e instanceof st){h=e;const d=r.getByRef(h)||a.getByRef(h);if(d)return d;e=t.fetch(e)}if(e instanceof ve){c=e.name;const d=a.getByName(c);if(d)return d}try{u=D(this,$o,t3).call(this,e,l)}catch(d){if(o&&!(d instanceof xi))return Promise.reject(d);throw d}return(c||h)&&(a.set(c,h,u),h&&r.set(null,h,u)),o?Promise.resolve(u):u}static get gray(){return Ze(this,"gray",new JU)}static get rgb(){return Ze(this,"rgb",new ZU)}static get rgba(){return Ze(this,"rgba",new QU)}static get cmyk(){if(Up.isUsable)try{return Ze(this,"cmyk",new Up)}catch{ce("CMYK fallback: DeviceCMYK")}return Ze(this,"cmyk",new mR)}}$o=new WeakSet,op=function(e,t){const{globalColorSpaceCache:i}=t;let s;if(e instanceof st){s=e;const a=i.getByRef(s);if(a)return a}const r=D(this,$o,t3).call(this,e,t);return s&&i.set(null,s,r),r},t3=function(e,t){const{xref:i,resources:s,pdfFunctionFactory:r,globalColorSpaceCache:a}=t;if(e=i.fetchIfRef(e),e instanceof ve)switch(e.name){case"G":case"DeviceGray":return this.gray;case"RGB":case"DeviceRGB":return this.rgb;case"DeviceRGBA":return this.rgba;case"CMYK":case"DeviceCMYK":return this.cmyk;case"Pattern":return new Wv(null);default:if(s instanceof fe){const o=s.get("ColorSpace");if(o instanceof fe){const l=o.get(e.name);if(l){if(l instanceof ve)return D(this,$o,t3).call(this,l,t);e=l;break}}}return ce(`Unrecognized ColorSpace: ${e.name}`),this.gray}if(Array.isArray(e)){const o=i.fetchIfRef(e[0]).name;let l,c,h,u,d,f;switch(o){case"G":case"DeviceGray":return this.gray;case"RGB":case"DeviceRGB":return this.rgb;case"CMYK":case"DeviceCMYK":return this.cmyk;case"CalGray":return l=i.fetchIfRef(e[1]),u=l.getArray("WhitePoint"),d=l.getArray("BlackPoint"),f=l.get("Gamma"),new $U(u,d,f);case"CalRGB":l=i.fetchIfRef(e[1]),u=l.getArray("WhitePoint"),d=l.getArray("BlackPoint"),f=l.getArray("Gamma");const g=l.getArray("Matrix");return new N7(u,d,f,g);case"ICCBased":const m=e[1]instanceof st;if(m){const I=a.getByRef(e[1]);if(I)return I}const x=i.fetchIfRef(e[1]),p=x.dict;if(c=p.get("N"),Kd.isUsable)try{const I=new Kd(x.getBytes(),"ICCBased",c);return m&&a.set(null,e[1],I),I}catch(I){if(I instanceof xi)throw I;ce(`ICCBased color space (${e[1]}): "${I}".`)}const y=p.getRaw("Alternate");if(y){const I=D(this,$o,op).call(this,y,t);if(I.numComps===c)return I;ce("ICCBased color space: Ignoring incorrect /Alternate entry.")}if(c===1)return this.gray;if(c===3)return this.rgb;if(c===4)return this.cmyk;break;case"Pattern":return h=e[1]||null,h&&(h=D(this,$o,op).call(this,h,t)),new Wv(h);case"I":case"Indexed":h=D(this,$o,op).call(this,e[1],t);const w=zs(i.fetchIfRef(e[2]),0,255),_=i.fetchIfRef(e[3]);return new YU(h,w,_);case"Separation":case"DeviceN":const v=i.fetchIfRef(e[1]);c=Array.isArray(v)?v.length:1,h=D(this,$o,op).call(this,e[2],t);const C=r.create(e[3]);return new XU(c,h,C);case"Lab":l=i.fetchIfRef(e[1]),u=l.getArray("WhitePoint"),d=l.getArray("BlackPoint");const k=l.getArray("Range");return new eH(u,d,k);default:return ce(`Unimplemented ColorSpace object: ${o}`),this.gray}}return ce(`Unrecognized ColorSpace object: ${e}`),this.gray},B(Nn,$o);class oo extends $r{constructor(e){super(e,"JpegError")}}class B7 extends $r{constructor(e,t){super(e,"DNLMarkerError"),this.scanLines=t}}class CR extends $r{constructor(e){super(e,"EOIMarkerError")}}const gp=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),Ux=4017,Hx=799,zx=3406,jx=2276,Gx=1567,Vx=3784,df=5793,qx=2896;function lH(n,e){let t=0,i,s,r=16;for(;r>0&&!n[r-1];)r--;const a=[{children:[],index:0}];let o=a[0],l;for(i=0;i<r;i++){for(s=0;s<n[i];s++){for(o=a.pop(),o.children[o.index]=e[t];o.index>0;)o=a.pop();for(o.index++,a.push(o);a.length<=i;)a.push(l={children:[],index:0}),o.children[o.index]=l.children,o=l;t++}i+1<r&&(a.push(l={children:[],index:0}),o.children[o.index]=l.children,o=l)}return a[0].children}function U7(n,e,t){return 64*((n.blocksPerLine+1)*e+t)}function cH(n,e,t,i,s,r,a,o,l,c=!1){const h=t.mcusPerLine,u=t.progressive,d=e;let f=0,g=0;function m(){if(g>0)return g--,f>>g&1;if(f=n[e++],f===255){const ye=n[e++];if(ye){if(ye===220&&c){e+=2;const P=yn(n,e);if(e+=2,P>0&&P!==t.scanLines)throw new B7("Found DNL marker (0xFFDC) while parsing scan data",P)}else if(ye===217){if(c){const P=N*(t.precision===8?8:0);if(P>0&&Math.round(t.scanLines/P)>=5)throw new B7("Found EOI marker (0xFFD9) while parsing scan data, possibly caused by incorrect `scanLines` parameter",P)}throw new CR("Found EOI marker (0xFFD9) while parsing scan data")}throw new oo(`unexpected marker ${(f<<8|ye).toString(16)}`)}}return g=7,f>>>7}function x(ye){let P=ye;for(;;){switch(P=P[m()],typeof P){case"number":return P;case"object":continue}throw new oo("invalid huffman sequence")}}function p(ye){let P=0;for(;ye>0;)P=P<<1|m(),ye--;return P}function y(ye){if(ye===1)return m()===1?1:-1;const P=p(ye);return P>=1<<ye-1?P:P+(-1<<ye)+1}function w(ye,P){const V=x(ye.huffmanTableDC),re=V===0?0:y(V);ye.blockData[P]=ye.pred+=re;let X=1;for(;X<64;){const ue=x(ye.huffmanTableAC),oe=ue&15,Q=ue>>4;if(oe===0){if(Q<15)break;X+=16;continue}X+=Q;const ae=gp[X];ye.blockData[P+ae]=y(oe),X++}}function _(ye,P){const V=x(ye.huffmanTableDC),re=V===0?0:y(V)<<l;ye.blockData[P]=ye.pred+=re}function v(ye,P){ye.blockData[P]|=m()<<l}let C=0;function k(ye,P){if(C>0){C--;return}let V=r;const re=a;for(;V<=re;){const X=x(ye.huffmanTableAC),ue=X&15,oe=X>>4;if(ue===0){if(oe<15){C=p(oe)+(1<<oe)-1;break}V+=16;continue}V+=oe;const Q=gp[V];ye.blockData[P+Q]=y(ue)*(1<<l),V++}}let I=0,S;function M(ye,P){let V=r;const re=a;let X=0,ue,oe;for(;V<=re;){const Q=P+gp[V],ae=ye.blockData[Q]<0?-1:1;switch(I){case 0:if(oe=x(ye.huffmanTableAC),ue=oe&15,X=oe>>4,ue===0)X<15?(C=p(X)+(1<<X),I=4):(X=16,I=1);else{if(ue!==1)throw new oo("invalid ACn encoding");S=y(ue),I=X?2:3}continue;case 1:case 2:ye.blockData[Q]?ye.blockData[Q]+=ae*(m()<<l):(X--,X===0&&(I=I===2?3:0));break;case 3:ye.blockData[Q]?ye.blockData[Q]+=ae*(m()<<l):(ye.blockData[Q]=S<<l,I=0);break;case 4:ye.blockData[Q]&&(ye.blockData[Q]+=ae*(m()<<l));break}V++}I===4&&(C--,C===0&&(I=0))}let N=0;function F(ye,P,V,re,X){const ue=V/h|0,oe=V%h;N=ue*ye.v+re;const Q=oe*ye.h+X,ae=U7(ye,N,Q);P(ye,ae)}function H(ye,P,V){N=V/ye.blocksPerLine|0;const re=V%ye.blocksPerLine,X=U7(ye,N,re);P(ye,X)}const T=i.length;let z,R,L,Y,j,J;u?r===0?J=o===0?_:v:J=o===0?k:M:J=w;let G=0,se;const de=T===1?i[0].blocksPerLine*i[0].blocksPerColumn:h*t.mcusPerColumn;let he,we;for(;G<=de;){const ye=s?Math.min(de-G,s):de;if(ye>0){for(R=0;R<T;R++)i[R].pred=0;if(C=0,T===1)for(z=i[0],j=0;j<ye;j++)H(z,J,G),G++;else for(j=0;j<ye;j++){for(R=0;R<T;R++)for(z=i[R],he=z.h,we=z.v,L=0;L<we;L++)for(Y=0;Y<he;Y++)F(z,J,G,L,Y);G++}}if(g=0,se=ty(n,e),!se)break;if(se.invalid){const P=ye>0?"unexpected":"excessive";ce(`decodeScan - ${P} MCU data, current marker is: ${se.invalid}`),e=se.offset}if(se.marker>=65488&&se.marker<=65495)e+=2;else break}return e-d}function hH(n,e,t){const i=n.quantizationTable,s=n.blockData;let r,a,o,l,c,h,u,d,f,g,m,x,p,y,w,_,v;if(!i)throw new oo("missing required Quantization Table.");for(let C=0;C<64;C+=8){if(f=s[e+C],g=s[e+C+1],m=s[e+C+2],x=s[e+C+3],p=s[e+C+4],y=s[e+C+5],w=s[e+C+6],_=s[e+C+7],f*=i[C],!(g|m|x|p|y|w|_)){v=df*f+512>>10,t[C]=v,t[C+1]=v,t[C+2]=v,t[C+3]=v,t[C+4]=v,t[C+5]=v,t[C+6]=v,t[C+7]=v;continue}g*=i[C+1],m*=i[C+2],x*=i[C+3],p*=i[C+4],y*=i[C+5],w*=i[C+6],_*=i[C+7],r=df*f+128>>8,a=df*p+128>>8,o=m,l=w,c=qx*(g-_)+128>>8,d=qx*(g+_)+128>>8,h=x<<4,u=y<<4,r=r+a+1>>1,a=r-a,v=o*Vx+l*Gx+128>>8,o=o*Gx-l*Vx+128>>8,l=v,c=c+u+1>>1,u=c-u,d=d+h+1>>1,h=d-h,r=r+l+1>>1,l=r-l,a=a+o+1>>1,o=a-o,v=c*jx+d*zx+2048>>12,c=c*zx-d*jx+2048>>12,d=v,v=h*Hx+u*Ux+2048>>12,h=h*Ux-u*Hx+2048>>12,u=v,t[C]=r+d,t[C+7]=r-d,t[C+1]=a+u,t[C+6]=a-u,t[C+2]=o+h,t[C+5]=o-h,t[C+3]=l+c,t[C+4]=l-c}for(let C=0;C<8;++C){if(f=t[C],g=t[C+8],m=t[C+16],x=t[C+24],p=t[C+32],y=t[C+40],w=t[C+48],_=t[C+56],!(g|m|x|p|y|w|_)){v=df*f+8192>>14,v<-2040?v=0:v>=2024?v=255:v=v+2056>>4,s[e+C]=v,s[e+C+8]=v,s[e+C+16]=v,s[e+C+24]=v,s[e+C+32]=v,s[e+C+40]=v,s[e+C+48]=v,s[e+C+56]=v;continue}r=df*f+2048>>12,a=df*p+2048>>12,o=m,l=w,c=qx*(g-_)+2048>>12,d=qx*(g+_)+2048>>12,h=x,u=y,r=(r+a+1>>1)+4112,a=r-a,v=o*Vx+l*Gx+2048>>12,o=o*Gx-l*Vx+2048>>12,l=v,c=c+u+1>>1,u=c-u,d=d+h+1>>1,h=d-h,r=r+l+1>>1,l=r-l,a=a+o+1>>1,o=a-o,v=c*jx+d*zx+2048>>12,c=c*zx-d*jx+2048>>12,d=v,v=h*Hx+u*Ux+2048>>12,h=h*Ux-u*Hx+2048>>12,u=v,f=r+d,_=r-d,g=a+u,w=a-u,m=o+h,y=o-h,x=l+c,p=l-c,f<16?f=0:f>=4080?f=255:f>>=4,g<16?g=0:g>=4080?g=255:g>>=4,m<16?m=0:m>=4080?m=255:m>>=4,x<16?x=0:x>=4080?x=255:x>>=4,p<16?p=0:p>=4080?p=255:p>>=4,y<16?y=0:y>=4080?y=255:y>>=4,w<16?w=0:w>=4080?w=255:w>>=4,_<16?_=0:_>=4080?_=255:_>>=4,s[e+C]=f,s[e+C+8]=g,s[e+C+16]=m,s[e+C+24]=x,s[e+C+32]=p,s[e+C+40]=y,s[e+C+48]=w,s[e+C+56]=_}}function uH(n,e){const t=e.blocksPerLine,i=e.blocksPerColumn,s=new Int16Array(64);for(let r=0;r<i;r++)for(let a=0;a<t;a++){const o=U7(e,r,a);hH(e,o,s)}return e.blockData}function ty(n,e,t=e){const i=n.length-1;let s=t<e?t:e;if(e>=i)return null;const r=yn(n,e);if(r>=65472&&r<=65534)return{invalid:null,marker:r,offset:e};let a=yn(n,s);for(;!(a>=65472&&a<=65534);){if(++s>=i)return null;a=yn(n,s)}return{invalid:r.toString(16),marker:a,offset:s}}function dH(n){const e=Math.ceil(n.samplesPerLine/8/n.maxH),t=Math.ceil(n.scanLines/8/n.maxV);for(const i of n.components){const s=Math.ceil(Math.ceil(n.samplesPerLine/8)*i.h/n.maxH),r=Math.ceil(Math.ceil(n.scanLines/8)*i.v/n.maxV),a=e*i.h,l=64*(t*i.v)*(a+1);i.blockData=new Int16Array(l),i.blocksPerLine=s,i.blocksPerColumn=r}n.mcusPerLine=e,n.mcusPerColumn=t}function Yv(n,e){const t=yn(n,e);e+=2;let i=e+t-2;const s=ty(n,i,e);s!=null&&s.invalid&&(ce("readDataBlock - incorrect length, current marker is: "+s.invalid),i=s.offset);const r=n.subarray(e,i);return{appData:r,oldOffset:e,newOffset:e+r.length}}function fH(n,e){const t=yn(n,e);e+=2;const i=e+t-2,s=ty(n,i,e);return s!=null&&s.invalid?s.offset:i}class Jv{constructor({decodeTransform:e=null,colorTransform:t=-1}={}){this._decodeTransform=e,this._colorTransform=t}static canUseImageDecoder(e,t=-1){let i=null,s=0,r=null,a=yn(e,s);if(s+=2,a!==65496)throw new oo("SOI not found");a=yn(e,s),s+=2;e:for(;a!==65497;){switch(a){case 65505:const{appData:o,oldOffset:l,newOffset:c}=Yv(e,s);if(s=c,o[0]===69&&o[1]===120&&o[2]===105&&o[3]===102&&o[4]===0&&o[5]===0){if(i)throw new oo("Duplicate EXIF-blocks found.");i={exifStart:l+6,exifEnd:c}}a=yn(e,s),s+=2;continue;case 65472:case 65473:case 65474:r=e[s+7];break e;case 65535:e[s]!==255&&s--;break}s=fH(e,s),a=yn(e,s),s+=2}return r===4||r===3&&t===0?null:i||{}}parse(e,{dnlScanLines:t=null}={}){let i=0,s=null,r=null,a,o,l=0;const c=[],h=[],u=[];let d=yn(e,i);if(i+=2,d!==65496)throw new oo("SOI not found");d=yn(e,i),i+=2;e:for(;d!==65497;){let f,g,m;switch(d){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:const{appData:x,newOffset:p}=Yv(e,i);i=p,d===65504&&x[0]===74&&x[1]===70&&x[2]===73&&x[3]===70&&x[4]===0&&(s={version:{major:x[5],minor:x[6]},densityUnits:x[7],xDensity:x[8]<<8|x[9],yDensity:x[10]<<8|x[11],thumbWidth:x[12],thumbHeight:x[13],thumbData:x.subarray(14,14+3*x[12]*x[13])}),d===65518&&x[0]===65&&x[1]===100&&x[2]===111&&x[3]===98&&x[4]===101&&(r={version:x[5]<<8|x[6],flags0:x[7]<<8|x[8],flags1:x[9]<<8|x[10],transformCode:x[11]});break;case 65499:const y=yn(e,i);i+=2;const w=y+i-2;let _;for(;i<w;){const L=e[i++],Y=new Uint16Array(64);if(L>>4)if(L>>4===1)for(g=0;g<64;g++)_=gp[g],Y[_]=yn(e,i),i+=2;else throw new oo("DQT - invalid table spec");else for(g=0;g<64;g++)_=gp[g],Y[_]=e[i++];c[L&15]=Y}break;case 65472:case 65473:case 65474:if(a)throw new oo("Only single frame JPEGs supported");i+=2,a={},a.extended=d===65473,a.progressive=d===65474,a.precision=e[i++];const v=yn(e,i);i+=2,a.scanLines=t||v,a.samplesPerLine=yn(e,i),i+=2,a.components=[],a.componentIds={};const C=e[i++];let k=0,I=0;for(f=0;f<C;f++){const L=e[i],Y=e[i+1]>>4,j=e[i+1]&15;k<Y&&(k=Y),I<j&&(I=j);const J=e[i+2];m=a.components.push({h:Y,v:j,quantizationId:J,quantizationTable:null}),a.componentIds[L]=m-1,i+=3}a.maxH=k,a.maxV=I,dH(a);break;case 65476:const S=yn(e,i);for(i+=2,f=2;f<S;){const L=e[i++],Y=new Uint8Array(16);let j=0;for(g=0;g<16;g++,i++)j+=Y[g]=e[i];const J=new Uint8Array(j);for(g=0;g<j;g++,i++)J[g]=e[i];f+=17+j,(L>>4?h:u)[L&15]=lH(Y,J)}break;case 65501:i+=2,o=yn(e,i),i+=2;break;case 65498:const M=++l===1&&!t;i+=2;const N=e[i++],F=[];for(f=0;f<N;f++){const L=e[i++],Y=a.componentIds[L],j=a.components[Y];j.index=L;const J=e[i++];j.huffmanTableDC=u[J>>4],j.huffmanTableAC=h[J&15],F.push(j)}const H=e[i++],T=e[i++],z=e[i++];try{const L=cH(e,i,a,F,o,H,T,z>>4,z&15,M);i+=L}catch(L){if(L instanceof B7)return ce(`${L.message} -- attempting to re-parse the JPEG image.`),this.parse(e,{dnlScanLines:L.scanLines});if(L instanceof CR){ce(`${L.message} -- ignoring the rest of the image data.`);break e}throw L}break;case 65500:i+=4;break;case 65535:e[i]!==255&&i--;break;default:const R=ty(e,i-2,i-3);if(R!=null&&R.invalid){ce("JpegImage.parse - unexpected data, current marker is: "+R.invalid),i=R.offset;break}if(!R||i>=e.length-1){ce("JpegImage.parse - reached the end of the image data without finding an EOI marker (0xFFD9).");break e}throw new oo("JpegImage.parse - unknown marker: "+d.toString(16))}d=yn(e,i),i+=2}if(!a)throw new oo("JpegImage.parse - no frame data found.");this.width=a.samplesPerLine,this.height=a.scanLines,this.jfif=s,this.adobe=r,this.components=[];for(const f of a.components){const g=c[f.quantizationId];g&&(f.quantizationTable=g),this.components.push({index:f.index,output:uH(a,f),scaleX:f.h/a.maxH,scaleY:f.v/a.maxV,blocksPerLine:f.blocksPerLine,blocksPerColumn:f.blocksPerColumn})}this.numComponents=this.components.length}_getLinearizedBlockData(e,t,i=!1){const s=this.width/e,r=this.height/t;let a,o,l,c,h,u,d,f,g,m,x=0,p;const y=this.components.length,w=e*t*y,_=new Uint8ClampedArray(w),v=new Uint32Array(e),C=4294967288;let k;for(d=0;d<y;d++){if(a=this.components[d],o=a.scaleX*s,l=a.scaleY*r,x=d,p=a.output,c=a.blocksPerLine+1<<3,o!==k){for(h=0;h<e;h++)f=0|h*o,v[h]=(f&C)<<3|f&7;k=o}for(u=0;u<t;u++)for(f=0|u*l,m=c*(f&C)|(f&7)<<3,h=0;h<e;h++)_[x]=p[m+v[h]],x+=y}let I=this._decodeTransform;if(!i&&y===4&&!I&&(I=new Int32Array([-256,255,-256,255,-256,255,-256,255])),I)for(d=0;d<w;)for(f=0,g=0;f<y;f++,d++,g+=2)_[d]=(_[d]*I[g]>>8)+I[g+1];return _}get _isColorConversionNeeded(){return this.adobe?!!this.adobe.transformCode:this.numComponents===3?this._colorTransform===0?!1:!(this.components[0].index===82&&this.components[1].index===71&&this.components[2].index===66):this._colorTransform===1}_convertYccToRgb(e){let t,i,s;for(let r=0,a=e.length;r<a;r+=3)t=e[r],i=e[r+1],s=e[r+2],e[r]=t-179.456+1.402*s,e[r+1]=t+135.459-.344*i-.714*s,e[r+2]=t-226.816+1.772*i;return e}_convertYccToRgba(e,t){for(let i=0,s=0,r=e.length;i<r;i+=3,s+=4){const a=e[i],o=e[i+1],l=e[i+2];t[s]=a-179.456+1.402*l,t[s+1]=a+135.459-.344*o-.714*l,t[s+2]=a-226.816+1.772*o,t[s+3]=255}return t}_convertYcckToRgb(e){return this._convertYcckToCmyk(e),this._convertCmykToRgb(e)}_convertYcckToRgba(e){return this._convertYcckToCmyk(e),this._convertCmykToRgba(e)}_convertYcckToCmyk(e){let t,i,s;for(let r=0,a=e.length;r<a;r+=4)t=e[r],i=e[r+1],s=e[r+2],e[r]=434.456-t-1.402*s,e[r+1]=119.541-t+.344*i+.714*s,e[r+2]=481.816-t-1.772*i;return e}_convertCmykToRgb(e){const t=e.length/4;return Nn.cmyk.getRgbBuffer(e,0,t,e,0,8,0),e.subarray(0,t*3)}_convertCmykToRgba(e){if(Nn.cmyk.getRgbBuffer(e,0,e.length/4,e,0,8,1),Nn.cmyk instanceof mR)for(let t=3,i=e.length;t<i;t+=4)e[t]=255;return e}getData({width:e,height:t,forceRGBA:i=!1,forceRGB:s=!1,isSourcePDF:r=!1}){if(this.numComponents>4)throw new oo("Unsupported color mode");const a=this._getLinearizedBlockData(e,t,r);if(this.numComponents===1&&(i||s)){const o=a.length*(i?4:3),l=new Uint8ClampedArray(o);let c=0;if(i)sH(a,new Uint32Array(l.buffer));else for(const h of a)l[c++]=h,l[c++]=h,l[c++]=h;return l}else if(this.numComponents===3&&this._isColorConversionNeeded){if(i){const o=new Uint8ClampedArray(a.length/3*4);return this._convertYccToRgba(a,o)}return this._convertYccToRgb(a)}else if(this.numComponents===4){if(this._isColorConversionNeeded)return i?this._convertYcckToRgba(a):s?this._convertYcckToRgb(a):this._convertYcckToCmyk(a);if(i)return this._convertCmykToRgba(a);if(s)return this._convertCmykToRgb(a)}return a}}var Vb,qb,H7;const B5=class B5 extends Zr{constructor(t,i,s){super(i);B(this,qb);this.stream=t,this.dict=t.dict,this.maybeLength=i,this.params=s}static get canUseImageDecoder(){return Ze(this,"canUseImageDecoder",b(this,Vb)?ImageDecoder.isTypeSupported("image/jpeg"):Promise.resolve(!1))}static setOptions({isImageDecoderSupported:t=!1}){O(this,Vb,t)}get bytes(){return Ze(this,"bytes",this.stream.getBytes(this.maybeLength))}ensureBuffer(t){}readBlock(){this.decodeImage()}get jpegOptions(){const t={decodeTransform:void 0,colorTransform:void 0},i=this.dict.getArray("D","Decode");if((this.forceRGBA||this.forceRGB)&&Array.isArray(i)){const s=this.dict.get("BPC","BitsPerComponent")||8,r=i.length,a=new Int32Array(r);let o=!1;const l=(1<<s)-1;for(let c=0;c<r;c+=2)a[c]=(i[c+1]-i[c])*256|0,a[c+1]=i[c]*l|0,(a[c]!==256||a[c+1]!==0)&&(o=!0);o&&(t.decodeTransform=a)}if(this.params instanceof fe){const s=this.params.get("ColorTransform");Number.isInteger(s)&&(t.colorTransform=s)}return Ze(this,"jpegOptions",t)}decodeImage(t){if(this.eof)return this.buffer;t=D(this,qb,H7).call(this,t||this.bytes);const i=new Jv(this.jpegOptions);i.parse(t);const s=i.getData({width:this.drawWidth,height:this.drawHeight,forceRGBA:this.forceRGBA,forceRGB:this.forceRGB,isSourcePDF:!0});return this.buffer=s,this.bufferLength=s.length,this.eof=!0,this.buffer}get canAsyncDecodeImageFromBuffer(){return this.stream.isAsync}async getTransferableImage(){if(!await B5.canUseImageDecoder)return null;const t=this.jpegOptions;if(t.decodeTransform)return null;let i;try{const s=this.canAsyncDecodeImageFromBuffer&&await this.stream.asyncGetBytes()||this.bytes;if(!s)return null;let r=D(this,qb,H7).call(this,s);const a=Jv.canUseImageDecoder(r,t.colorTransform);return a?(a.exifStart&&(r=r.slice(),r.fill(0,a.exifStart,a.exifEnd)),i=new ImageDecoder({data:r,type:"image/jpeg",preferAnimation:!1}),(await i.decode()).image):null}catch(s){return ce(`getTransferableImage - failed: "${s}".`),null}finally{i==null||i.close()}}};Vb=new WeakMap,qb=new WeakSet,H7=function(t){for(let i=0,s=t.length-1;i<s;i++)if(t[i]===255&&t[i+1]===216){i>0&&(t=t.subarray(i));break}return t},B(B5,Vb,fa.isImageDecoderSupported);let Eg=B5;var gH=async function(n={}){var e,t=n,i,s,r=new Promise((Ne,Ve)=>{i=Ne,s=Ve}),a="./this.program",o=(Ne,Ve)=>{throw Ve},l=import.meta.url,c="";try{c=new URL(".",l).href}catch{}var h=console.log.bind(console),u=console.error.bind(console),d,f=!1,g,m,x,p,y;function w(){var Ne=d.buffer;m=new Int8Array(Ne),x=new Uint8Array(Ne),p=new Int32Array(Ne),y=new Uint32Array(Ne),new BigInt64Array(Ne),new BigUint64Array(Ne)}function _(){if(t.preRun)for(typeof t.preRun=="function"&&(t.preRun=[t.preRun]);t.preRun.length;)j(t.preRun.shift());z(Y)}function v(){Ci.t()}function C(){if(t.postRun)for(typeof t.postRun=="function"&&(t.postRun=[t.postRun]);t.postRun.length;)L(t.postRun.shift());z(R)}var k=0,I=null;function S(Ne){var Ve;k++,(Ve=t.monitorRunDependencies)==null||Ve.call(t,k)}function M(Ne){var ht;if(k--,(ht=t.monitorRunDependencies)==null||ht.call(t,k),k==0&&I){var Ve=I;I=null,Ve()}}function N(Ne){var ht;(ht=t.onAbort)==null||ht.call(t,Ne),Ne="Aborted("+Ne+")",u(Ne),f=!0,Ne+=". Build with -sASSERTIONS for more info.";var Ve=new WebAssembly.RuntimeError(Ne);throw s(Ve),Ve}function F(){return{a:_s}}async function H(){function Ne(ht,Xt){return Ci=ht.exports,d=Ci.s,w(),M(),Ci}S();var Ve=F();return new Promise((ht,Xt)=>{t.instantiateWasm(Ve,(an,Bn)=>{ht(Ne(an))})})}class T{constructor(Ve){He(this,"name","ExitStatus");this.message=`Program terminated with exit(${Ve})`,this.status=Ve}}var z=Ne=>{for(;Ne.length>0;)Ne.shift()(t)},R=[],L=Ne=>R.push(Ne),Y=[],j=Ne=>Y.push(Ne),J=!0,G=()=>N(""),se=0,de=()=>{J=!1,se=0},he={},we=Ne=>{if(Ne instanceof T||Ne=="unwind")return g;o(1,Ne)},ye=()=>J||se>0,P=Ne=>{var Ve;g=Ne,ye()||((Ve=t.onExit)==null||Ve.call(t,Ne),f=!0),o(Ne,new T(Ne))},V=(Ne,Ve)=>{g=Ne,P(Ne)},re=V,X=()=>{if(!ye())try{re(g)}catch(Ne){we(Ne)}},ue=Ne=>{if(!f)try{Ne(),X()}catch(Ve){we(Ve)}},oe=()=>performance.now(),Q=(Ne,Ve)=>{if(he[Ne]&&(clearTimeout(he[Ne].id),delete he[Ne]),!Ve)return 0;var ht=setTimeout(()=>{delete he[Ne],ue(()=>Rr(Ne,oe()))},Ve);return he[Ne]={id:ht,timeout_ms:Ve},0};function ae(Ne,Ve){Ne>>=2;const ht=t.imageData=new Uint8ClampedArray(Ve),Xt=p.subarray(Ne,Ne+Ve);ht.set(Xt)}function Ke(Ne,Ve,ht,Xt){Ne>>=2,Ve>>=2,ht>>=2;const an=t.imageData=new Uint8ClampedArray(Xt*3),Bn=p.subarray(Ne,Ne+Xt),Cn=p.subarray(Ve,Ve+Xt),Un=p.subarray(ht,ht+Xt);for(let zn=0;zn<Xt;zn++)an[3*zn]=Bn[zn],an[3*zn+1]=Cn[zn],an[3*zn+2]=Un[zn]}function Ue(Ne,Ve,ht,Xt,an){Ne>>=2,Ve>>=2,ht>>=2,Xt>>=2;const Bn=t.imageData=new Uint8ClampedArray(an*4),Cn=p.subarray(Ne,Ne+an),Un=p.subarray(Ve,Ve+an),zn=p.subarray(ht,ht+an),dl=p.subarray(Xt,Xt+an);for(let gr=0;gr<an;gr++)Bn[4*gr]=Cn[gr],Bn[4*gr+1]=Un[gr],Bn[4*gr+2]=zn[gr],Bn[4*gr+3]=dl[gr]}var De=()=>2147483648,je=(Ne,Ve)=>Math.ceil(Ne/Ve)*Ve,ze=Ne=>{var Ve=d.buffer,ht=(Ne-Ve.byteLength+65535)/65536|0;try{return d.grow(ht),w(),1}catch{}},Qe=Ne=>{var Ve=x.length;Ne>>>=0;var ht=De();if(Ne>ht)return!1;for(var Xt=1;Xt<=4;Xt*=2){var an=Ve*(1+.2/Xt);an=Math.min(an,Ne+100663296);var Bn=Math.min(ht,je(Math.max(Ne,an),65536)),Cn=ze(Bn);if(Cn)return!0}return!1},ft={},ut=()=>a||"./this.program",Je=()=>{if(!Je.strings){var Ne=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",Ve={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:Ne,_:ut()};for(var ht in ft)ft[ht]===void 0?delete Ve[ht]:Ve[ht]=ft[ht];var Xt=[];for(var ht in Ve)Xt.push(`${ht}=${Ve[ht]}`);Je.strings=Xt}return Je.strings},rt=(Ne,Ve,ht,Xt)=>{if(!(Xt>0))return 0;for(var an=ht,Bn=ht+Xt-1,Cn=0;Cn<Ne.length;++Cn){var Un=Ne.charCodeAt(Cn);if(Un>=55296&&Un<=57343){var zn=Ne.charCodeAt(++Cn);Un=65536+((Un&1023)<<10)|zn&1023}if(Un<=127){if(ht>=Bn)break;Ve[ht++]=Un}else if(Un<=2047){if(ht+1>=Bn)break;Ve[ht++]=192|Un>>6,Ve[ht++]=128|Un&63}else if(Un<=65535){if(ht+2>=Bn)break;Ve[ht++]=224|Un>>12,Ve[ht++]=128|Un>>6&63,Ve[ht++]=128|Un&63}else{if(ht+3>=Bn)break;Ve[ht++]=240|Un>>18,Ve[ht++]=128|Un>>12&63,Ve[ht++]=128|Un>>6&63,Ve[ht++]=128|Un&63}}return Ve[ht]=0,ht-an},ge=(Ne,Ve,ht)=>rt(Ne,x,Ve,ht),Pt=(Ne,Ve)=>{var ht=0,Xt=0;for(var an of Je()){var Bn=Ve+ht;y[Ne+Xt>>2]=Bn,ht+=ge(an,Bn,1/0)+1,Xt+=4}return 0},lt=Ne=>{for(var Ve=0,ht=0;ht<Ne.length;++ht){var Xt=Ne.charCodeAt(ht);Xt<=127?Ve++:Xt<=2047?Ve+=2:Xt>=55296&&Xt<=57343?(Ve+=4,++ht):Ve+=3}return Ve},ct=(Ne,Ve)=>{var ht=Je();y[Ne>>2]=ht.length;var Xt=0;for(var an of ht)Xt+=lt(an)+1;return y[Ve>>2]=Xt,0},Ge=Ne=>52;function Ft(Ne,Ve,ht,Xt){return 70}var sn=[null,[],[]],Me=typeof TextDecoder<"u"?new TextDecoder:void 0,Lt=(Ne,Ve=0,ht=NaN)=>{for(var Xt=Ve+ht,an=Ve;Ne[an]&&!(an>=Xt);)++an;if(an-Ve>16&&Ne.buffer&&Me)return Me.decode(Ne.subarray(Ve,an));for(var Bn="";Ve<an;){var Cn=Ne[Ve++];if(!(Cn&128)){Bn+=String.fromCharCode(Cn);continue}var Un=Ne[Ve++]&63;if((Cn&224)==192){Bn+=String.fromCharCode((Cn&31)<<6|Un);continue}var zn=Ne[Ve++]&63;if((Cn&240)==224?Cn=(Cn&15)<<12|Un<<6|zn:Cn=(Cn&7)<<18|Un<<12|zn<<6|Ne[Ve++]&63,Cn<65536)Bn+=String.fromCharCode(Cn);else{var dl=Cn-65536;Bn+=String.fromCharCode(55296|dl>>10,56320|dl&1023)}}return Bn},dt=(Ne,Ve)=>{var ht=sn[Ne];Ve===0||Ve===10?((Ne===1?h:u)(Lt(ht)),ht.length=0):ht.push(Ve)},Vt=(Ne,Ve)=>Ne?Lt(x,Ne,Ve):"",Ln=(Ne,Ve,ht,Xt)=>{for(var an=0,Bn=0;Bn<ht;Bn++){var Cn=y[Ve>>2],Un=y[Ve+4>>2];Ve+=8;for(var zn=0;zn<Un;zn++)dt(Ne,x[Cn+zn]);an+=Un}return y[Xt>>2]=an,0};function Wn(Ne,Ve){Ne>>=2;const ht=t.imageData=new Uint8ClampedArray(Ve*4),Xt=p.subarray(Ne,Ne+Ve);for(let an=0;an<Ve;an++)ht[4*an]=ht[4*an+1]=ht[4*an+2]=Xt[an],ht[4*an+3]=255}function hi(Ne,Ve,ht){Ne>>=2,Ve>>=2;const Xt=t.imageData=new Uint8ClampedArray(ht*4),an=p.subarray(Ne,Ne+ht),Bn=p.subarray(Ve,Ve+ht);for(let Cn=0;Cn<ht;Cn++)Xt[4*Cn]=Xt[4*Cn+1]=Xt[4*Cn+2]=an[Cn],Xt[4*Cn+3]=Bn[Cn]}function Gi(Ne){const Ve=Vt(Ne);(t.warn||console.warn)(`OpenJPEG: ${Ve}`)}function ws(Ne,Ve,ht,Xt){Ne>>=2,Ve>>=2,ht>>=2;const an=t.imageData=new Uint8ClampedArray(Xt*4),Bn=p.subarray(Ne,Ne+Xt),Cn=p.subarray(Ve,Ve+Xt),Un=p.subarray(ht,ht+Xt);for(let zn=0;zn<Xt;zn++)an[4*zn]=Bn[zn],an[4*zn+1]=Cn[zn],an[4*zn+2]=Un[zn],an[4*zn+3]=255}function ui(Ne){const Ve=Vt(Ne);t.errorMessages?t.errorMessages+=`
`+Ve:t.errorMessages=Ve}var Wi=(Ne,Ve)=>{m.set(Ne,Ve)};t.noExitRuntime&&(J=t.noExitRuntime),t.print&&(h=t.print),t.printErr&&(u=t.printErr),t.wasmBinary&&t.wasmBinary,t.arguments&&t.arguments,t.thisProgram&&(a=t.thisProgram),t.writeArrayToMemory=Wi;var _s={l:G,k:de,m:Q,g:ae,f:Ke,e:Ue,n:Qe,p:Pt,q:ct,b:Ge,o:Ft,c:Ln,r:Wn,i:hi,d:Gi,j:P,h:ws,a:ui},Ci=await H();Ci.t,t._malloc=Ci.u,t._free=Ci.v,t._jp2_decode=Ci.w;var Rr=Ci.x;function Xs(){if(k>0){I=Xs;return}if(_(),k>0){I=Xs;return}function Ne(){var Ve;t.calledRun=!0,!f&&(v(),i(t),(Ve=t.onRuntimeInitialized)==null||Ve.call(t),C())}t.setStatus?(t.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>t.setStatus(""),1),Ne()},1)):Ne()}function Es(){if(t.preInit)for(typeof t.preInit=="function"&&(t.preInit=[t.preInit]);t.preInit.length>0;)t.preInit.shift()()}return Es(),Xs(),e=r,e};const mH=gH;class Wx extends $r{constructor(e){super(e,"JpxError")}}var Rd,yg,Md,Wb,Kb,wg,sf,z7,AR;class Go{static setOptions({handler:e,useWasm:t,useWorkerFetch:i,wasmUrl:s}){O(this,Wb,t),O(this,Kb,i),O(this,wg,s),i||O(this,yg,e)}static async decode(e,{numComponents:t=4,isIndexedColormap:i=!1,smaskInData:s=!1,reducePower:r=0}={}){if(!b(this,Md)){const{promise:l,resolve:c}=Promise.withResolvers(),h=[l];b(this,Wb)?h.push(mH({warn:ce,instantiateWasm:D(this,sf,AR).bind(this,c)})):D(this,sf,z7).call(this,c),O(this,Md,Promise.race(h))}const a=await b(this,Md);if(!a)throw new Wx("OpenJPEG failed to initialize");let o;try{const l=e.length;if(o=a._malloc(l),a.writeArrayToMemory(e,o),a._jp2_decode(o,l,t>0?t:0,!!i,!!s,r)){const{errorMessages:u}=a;throw u?(delete a.errorMessages,new Wx(u)):new Wx("Unknown error")}const{imageData:h}=a;return a.imageData=null,h}finally{o&&a._free(o)}}static cleanup(){O(this,Md,null)}static parseImageProperties(e){let t=e.getByte();for(;t>=0;){const i=t;if(t=e.getByte(),(i<<8|t)===65361){e.skip(4);const r=e.getInt32()>>>0,a=e.getInt32()>>>0,o=e.getInt32()>>>0,l=e.getInt32()>>>0;e.skip(16);const c=e.getUint16();return{width:r-o,height:a-l,bitsPerComponent:8,componentsCount:c}}}throw new Wx("No size marker found in JPX stream")}}Rd=new WeakMap,yg=new WeakMap,Md=new WeakMap,Wb=new WeakMap,Kb=new WeakMap,wg=new WeakMap,sf=new WeakSet,z7=async function(e){const t=`${b(this,wg)}openjpeg_nowasm_fallback.js`;let i=null;try{i=(await import(t)).default()}catch(s){ce(`JpxImage#getJsModule: ${s}`)}e(i)},AR=async function(e,t,i){const s="openjpeg.wasm";try{b(this,Rd)||(b(this,Kb)?O(this,Rd,await E7(`${b(this,wg)}${s}`)):O(this,Rd,await b(this,yg).sendWithPromise("FetchBinaryData",{type:"wasmFactory",filename:s})));const r=await WebAssembly.instantiate(b(this,Rd),t);return i(r.instance)}catch(r){return ce(`JpxImage#instantiateWasm: ${r}`),D(this,sf,z7).call(this,e),null}finally{O(this,yg,null)}},B(Go,sf),B(Go,Rd,null),B(Go,yg,null),B(Go,Md,null),B(Go,Wb,!0),B(Go,Kb,!0),B(Go,wg,null);function ux(n,e,t,i,s){let r=n;for(let a=0,o=e.length-1;a<o;a++){const l=e[a];r=r[l]||(r[l]=[])}r[e.at(-1)]={checkFn:t,iterateFn:i,processFn:s}}const Xd=[];ux(Xd,[ie.save,ie.transform,ie.paintInlineImageXObject,ie.restore],null,function(e,t){const i=e.fnArray,s=e.iCurr-3,r=(t-s)%4;switch(r){case 0:return i[t]===ie.save;case 1:return i[t]===ie.transform;case 2:return i[t]===ie.paintInlineImageXObject;case 3:return i[t]===ie.restore}throw new Error(`iterateInlineImageGroup - invalid pos: ${r}`)},function(e,t){const o=e.fnArray,l=e.argsArray,c=e.iCurr,h=c-3,u=c-2,d=c-1,f=Math.min(Math.floor((t-h)/4),200);if(f<10)return t-(t-h)%4;let g=0;const m=[];let x=0,p=1,y=1;for(let I=0;I<f;I++){const S=l[u+(I<<2)],M=l[d+(I<<2)][0];p+M.width>1e3&&(g=Math.max(g,p),y+=x+2*1,p=0,x=0),m.push({transform:S,x:p,y,w:M.width,h:M.height}),p+=M.width+2*1,x=Math.max(x,M.height)}const w=Math.max(g,p)+1,_=y+x+1,v=new Uint8Array(w*_*4),C=w<<2;for(let I=0;I<f;I++){const S=l[d+(I<<2)][0].data,M=m[I].w<<2;let N=0,F=m[I].x+m[I].y*w<<2;v.set(S.subarray(0,M),F-C);for(let H=0,T=m[I].h;H<T;H++)v.set(S.subarray(N,N+M),F),N+=M,F+=C;for(v.set(S.subarray(N-M,N),F);F>=0;)S[F-4]=S[F],S[F-3]=S[F+1],S[F-2]=S[F+2],S[F-1]=S[F+3],S[F+M]=S[F+M-4],S[F+M+1]=S[F+M-3],S[F+M+2]=S[F+M-2],S[F+M+3]=S[F+M-1],F-=C}const k={width:w,height:_};if(e.isOffscreenCanvasSupported){const I=new OffscreenCanvas(w,_);I.getContext("2d").putImageData(new ImageData(new Uint8ClampedArray(v.buffer),w,_),0,0),k.bitmap=I.transferToImageBitmap(),k.data=null}else k.kind=Fs.RGBA_32BPP,k.data=v;return o.splice(h,f*4,ie.paintInlineImageXObjectGroup),l.splice(h,f*4,[k,m]),h+1});ux(Xd,[ie.save,ie.transform,ie.paintImageMaskXObject,ie.restore],null,function(e,t){const i=e.fnArray,s=e.iCurr-3,r=(t-s)%4;switch(r){case 0:return i[t]===ie.save;case 1:return i[t]===ie.transform;case 2:return i[t]===ie.paintImageMaskXObject;case 3:return i[t]===ie.restore}throw new Error(`iterateImageMaskGroup - invalid pos: ${r}`)},function(e,t){const a=e.fnArray,o=e.argsArray,l=e.iCurr,c=l-3,h=l-2,u=l-1;let d=Math.floor((t-c)/4);if(d<10)return t-(t-c)%4;let f=!1,g,m;const x=o[u][0],p=o[h][0],y=o[h][1],w=o[h][2],_=o[h][3];if(y===w){f=!0,g=h+4;let v=u+4;for(let C=1;C<d;C++,g+=4,v+=4)if(m=o[g],o[v][0]!==x||m[0]!==p||m[1]!==y||m[2]!==w||m[3]!==_){C<10?f=!1:d=C;break}}if(f){d=Math.min(d,1e3);const v=new Float32Array(d*2);g=h;for(let C=0;C<d;C++,g+=4)m=o[g],v[C<<1]=m[4],v[(C<<1)+1]=m[5];a.splice(c,d*4,ie.paintImageMaskXObjectRepeat),o.splice(c,d*4,[x,p,y,w,_,v])}else{d=Math.min(d,100);const v=[];for(let C=0;C<d;C++){m=o[h+(C<<2)];const k=o[u+(C<<2)][0];v.push({data:k.data,width:k.width,height:k.height,interpolate:k.interpolate,count:k.count,transform:m})}a.splice(c,d*4,ie.paintImageMaskXObjectGroup),o.splice(c,d*4,[v])}return c+1});ux(Xd,[ie.save,ie.transform,ie.paintImageXObject,ie.restore],function(n){const e=n.argsArray,t=n.iCurr-2;return e[t][1]===0&&e[t][2]===0},function(e,t){const i=e.fnArray,s=e.argsArray,r=e.iCurr-3,a=(t-r)%4;switch(a){case 0:return i[t]===ie.save;case 1:if(i[t]!==ie.transform)return!1;const o=e.iCurr-2,l=s[o][0],c=s[o][3];return!(s[t][0]!==l||s[t][1]!==0||s[t][2]!==0||s[t][3]!==c);case 2:if(i[t]!==ie.paintImageXObject)return!1;const h=e.iCurr-1,u=s[h][0];return s[t][0]===u;case 3:return i[t]===ie.restore}throw new Error(`iterateImageGroup - invalid pos: ${a}`)},function(n,e){const s=n.fnArray,r=n.argsArray,a=n.iCurr,o=a-3,l=a-2,c=a-1,h=r[c][0],u=r[l][0],d=r[l][3],f=Math.min(Math.floor((e-o)/4),1e3);if(f<3)return e-(e-o)%4;const g=new Float32Array(f*2);let m=l;for(let p=0;p<f;p++,m+=4){const y=r[m];g[p<<1]=y[4],g[(p<<1)+1]=y[5]}const x=[h,u,d,g];return s.splice(o,f*4,ie.paintImageXObjectRepeat),r.splice(o,f*4,x),o+1});ux(Xd,[ie.beginText,ie.setFont,ie.setTextMatrix,ie.showText,ie.endText],null,function(e,t){const i=e.fnArray,s=e.argsArray,r=e.iCurr-4,a=(t-r)%5;switch(a){case 0:return i[t]===ie.beginText;case 1:return i[t]===ie.setFont;case 2:return i[t]===ie.setTextMatrix;case 3:if(i[t]!==ie.showText)return!1;const o=e.iCurr-3,l=s[o][0],c=s[o][1];return!(s[t][0]!==l||s[t][1]!==c);case 4:return i[t]===ie.endText}throw new Error(`iterateShowTextGroup - invalid pos: ${a}`)},function(n,e){const s=n.fnArray,r=n.argsArray,a=n.iCurr,o=a-4,l=a-3,c=a-2,h=a-1,u=a,d=r[l][0],f=r[l][1];let g=Math.min(Math.floor((e-o)/5),1e3);if(g<3)return e-(e-o)%5;let m=o;o>=4&&s[o-4]===s[l]&&s[o-3]===s[c]&&s[o-2]===s[h]&&s[o-1]===s[u]&&r[o-4][0]===d&&r[o-4][1]===f&&(g++,m-=5);let x=m+4;for(let p=1;p<g;p++)s.splice(x,3),r.splice(x,3),x+=2;return x+1});ux(Xd,[ie.save,ie.transform,ie.constructPath,ie.restore],n=>{const e=n.argsArray,t=n.iCurr-1,i=e[t][0];if(i!==ie.stroke&&i!==ie.closeStroke&&i!==ie.fillStroke&&i!==ie.eoFillStroke&&i!==ie.closeFillStroke&&i!==ie.closeEOFillStroke)return!0;const s=n.iCurr-2,r=e[s];return r[0]===1&&r[1]===0&&r[2]===0&&r[3]===1},()=>!1,(n,e)=>{const{fnArray:t,argsArray:i}=n,s=n.iCurr,r=s-3,a=s-2,o=s-1,l=i[o],c=i[a],[,[h],u]=l;if(u){Dn.scaleMinMax(c,u);for(let d=0,f=h.length;d<f;)switch(h[d++]){case gs.moveTo:case gs.lineTo:Dn.applyTransform(h,c,d),d+=2;break;case gs.curveTo:Dn.applyTransformToBezier(h,c,d),d+=6;break}}return t.splice(r,4,ie.constructPath),i.splice(r,4,l),r+1});class SR{constructor(e){this.queue=e}_optimize(){}push(e,t){this.queue.fnArray.push(e),this.queue.argsArray.push(t),this._optimize()}flush(){}reset(){}}class pH extends SR{constructor(e){super(e),this.state=null,this.context={iCurr:0,fnArray:e.fnArray,argsArray:e.argsArray,isOffscreenCanvasSupported:Sr.isOffscreenCanvasSupported},this.match=null,this.lastProcessed=0}_optimize(){const e=this.queue.fnArray;let t=this.lastProcessed,i=e.length,s=this.state,r=this.match;if(!s&&!r&&t+1===i&&!Xd[e[t]]){this.lastProcessed=i;return}const a=this.context;for(;t<i;){if(r){if((0,r.iterateFn)(a,t)){t++;continue}if(t=(0,r.processFn)(a,t+1),i=e.length,r=null,s=null,t>=i)break}if(s=(s||Xd)[e[t]],!s||Array.isArray(s)){t++;continue}if(a.iCurr=t,t++,s.checkFn&&!(0,s.checkFn)(a)){s=null;continue}r=s,s=null}this.state=s,this.match=r,this.lastProcessed=t}flush(){for(;this.match;){const e=this.queue.fnArray.length;this.lastProcessed=(0,this.match.processFn)(this.context,e),this.match=null,this.state=null,this._optimize()}}reset(){this.state=null,this.match=null,this.lastProcessed=0}}const yc=class yc{constructor(e=0,t){this._streamSink=t,this.fnArray=[],this.argsArray=[],this.optimizer=t&&!(e&zr.OPLIST)?new pH(this):new SR(this),this.dependencies=new Set,this._totalLength=0,this.weight=0,this._resolved=t?null:Promise.resolve()}static setOptions({isOffscreenCanvasSupported:e}){this.isOffscreenCanvasSupported=e}get length(){return this.argsArray.length}get ready(){return this._resolved||this._streamSink.ready}get totalLength(){return this._totalLength+this.length}addOp(e,t){this.optimizer.push(e,t),this.weight++,this._streamSink&&(this.weight>=yc.CHUNK_SIZE?this.flush():this.weight>=yc.CHUNK_SIZE_ABOUT&&(e===ie.restore||e===ie.endText)&&this.flush())}addImageOps(e,t,i,s=!1){s&&(this.addOp(ie.save),this.addOp(ie.setGState,[[["SMask",!1]]])),i!==void 0&&this.addOp(ie.beginMarkedContentProps,["OC",i]),this.addOp(e,t),i!==void 0&&this.addOp(ie.endMarkedContent,[]),s&&this.addOp(ie.restore)}addDependency(e){this.dependencies.has(e)||(this.dependencies.add(e),this.addOp(ie.dependency,[e]))}addDependencies(e){for(const t of e)this.addDependency(t)}addOpList(e){if(!(e instanceof yc)){ce('addOpList - ignoring invalid "opList" parameter.');return}for(const t of e.dependencies)this.dependencies.add(t);for(let t=0,i=e.length;t<i;t++)this.addOp(e.fnArray[t],e.argsArray[t])}getIR(){return{fnArray:this.fnArray,argsArray:this.argsArray,length:this.length}}get _transfers(){const e=[],{fnArray:t,argsArray:i,length:s}=this;for(let r=0;r<s;r++)switch(t[r]){case ie.paintInlineImageXObject:case ie.paintInlineImageXObjectGroup:case ie.paintImageMaskXObject:{const{bitmap:l,data:c}=i[r][0];(l||c!=null&&c.buffer)&&e.push(l||c.buffer);break}case ie.constructPath:{const[,[l],c]=i[r];l&&e.push(l.buffer,c.buffer);break}case ie.paintFormXObjectBegin:const[a,o]=i[r];a&&e.push(a.buffer),o&&e.push(o.buffer);break;case ie.setTextMatrix:e.push(i[r][0].buffer);break}return e}flush(e=!1,t=null){this.optimizer.flush();const i=this.length;this._totalLength+=i,this._streamSink.enqueue({fnArray:this.fnArray,argsArray:this.argsArray,lastChunk:e,separateAnnots:t,length:i},1,this._transfers),this.dependencies.clear(),this.fnArray.length=0,this.argsArray.length=0,this.weight=0,this.optimizer.reset()}};He(yc,"CHUNK_SIZE",1e3),He(yc,"CHUNK_SIZE_ABOUT",yc.CHUNK_SIZE-5),He(yc,"isOffscreenCanvasSupported",!1);let Sr=yc;function pr(n,e){let t=0;for(let i=0;i<=e;i++)t=t<<8|n[i];return t>>>0}function Kx(n,e){return e===1?String.fromCharCode(n[0],n[1]):e===3?String.fromCharCode(n[0],n[1],n[2],n[3]):String.fromCharCode(...n.subarray(0,e+1))}function Pr(n,e,t){let i=0;for(let s=t;s>=0;s--)i+=n[s]+e[s],n[s]=i&255,i>>=8}function Zh(n,e){let t=1;for(let i=e;i>=0&&t>0;i--)t+=n[i],n[i]=t&255,t>>=8}const ff=16,bH=19;class xH{constructor(e){this.buffer=e,this.pos=0,this.end=e.length,this.tmpBuf=new Uint8Array(bH)}readByte(){return this.pos>=this.end?-1:this.buffer[this.pos++]}readNumber(){let e=0,t;do{const i=this.readByte();if(i<0)throw new Te("unexpected EOF in bcmap");t=!(i&128),e=e<<7|i&127}while(!t);return e}readSigned(){const e=this.readNumber();return e&1?~(e>>>1):e>>>1}readHex(e,t){e.set(this.buffer.subarray(this.pos,this.pos+t+1)),this.pos+=t+1}readHexNumber(e,t){let i;const s=this.tmpBuf;let r=0;do{const c=this.readByte();if(c<0)throw new Te("unexpected EOF in bcmap");i=!(c&128),s[r++]=c&127}while(!i);let a=t,o=0,l=0;for(;a>=0;){for(;l<8&&s.length>0;)o|=s[--r]<<l,l+=7;e[a]=o&255,a--,o>>=8,l-=8}}readHexSigned(e,t){this.readHexNumber(e,t);const i=e[t]&1?255:0;let s=0;for(let r=0;r<=t;r++)s=(s&1)<<8|e[r],e[r]=s>>1^i}readString(){const e=this.readNumber(),t=new Array(e);for(let i=0;i<e;i++)t[i]=this.readNumber();return String.fromCharCode(...t)}}class yH{async process(e,t,i){const s=new xH(e),r=s.readByte();t.vertical=!!(r&1);let a=null;const o=new Uint8Array(ff),l=new Uint8Array(ff),c=new Uint8Array(ff),h=new Uint8Array(ff),u=new Uint8Array(ff);let d,f;for(;(f=s.readByte())>=0;){const g=f>>5;if(g===7){switch(f&31){case 0:s.readString();break;case 1:a=s.readString();break}continue}const m=!!(f&16),x=f&15;if(x+1>ff)throw new Error("BinaryCMapReader.process: Invalid dataSize.");const p=1,y=s.readNumber();switch(g){case 0:s.readHex(o,x),s.readHexNumber(l,x),Pr(l,o,x),t.addCodespaceRange(x+1,pr(o,x),pr(l,x));for(let w=1;w<y;w++)Zh(l,x),s.readHexNumber(o,x),Pr(o,l,x),s.readHexNumber(l,x),Pr(l,o,x),t.addCodespaceRange(x+1,pr(o,x),pr(l,x));break;case 1:s.readHex(o,x),s.readHexNumber(l,x),Pr(l,o,x),s.readNumber();for(let w=1;w<y;w++)Zh(l,x),s.readHexNumber(o,x),Pr(o,l,x),s.readHexNumber(l,x),Pr(l,o,x),s.readNumber();break;case 2:s.readHex(c,x),d=s.readNumber(),t.mapOne(pr(c,x),d);for(let w=1;w<y;w++)Zh(c,x),m||(s.readHexNumber(u,x),Pr(c,u,x)),d=s.readSigned()+(d+1),t.mapOne(pr(c,x),d);break;case 3:s.readHex(o,x),s.readHexNumber(l,x),Pr(l,o,x),d=s.readNumber(),t.mapCidRange(pr(o,x),pr(l,x),d);for(let w=1;w<y;w++)Zh(l,x),m?o.set(l):(s.readHexNumber(o,x),Pr(o,l,x)),s.readHexNumber(l,x),Pr(l,o,x),d=s.readNumber(),t.mapCidRange(pr(o,x),pr(l,x),d);break;case 4:s.readHex(c,p),s.readHex(h,x),t.mapOne(pr(c,p),Kx(h,x));for(let w=1;w<y;w++)Zh(c,p),m||(s.readHexNumber(u,p),Pr(c,u,p)),Zh(h,x),s.readHexSigned(u,x),Pr(h,u,x),t.mapOne(pr(c,p),Kx(h,x));break;case 5:s.readHex(o,p),s.readHexNumber(l,p),Pr(l,o,p),s.readHex(h,x),t.mapBfRange(pr(o,p),pr(l,p),Kx(h,x));for(let w=1;w<y;w++)Zh(l,p),m?o.set(l):(s.readHexNumber(o,p),Pr(o,l,p)),s.readHexNumber(l,p),Pr(l,o,p),s.readHex(h,x),t.mapBfRange(pr(o,p),pr(l,p),Kx(h,x));break;default:throw new Error(`BinaryCMapReader.process - unknown type: ${g}`)}}return a?i(a):t}}class wH extends Zr{constructor(e,t){t&&(t*=.8),super(t),this.str=e,this.dict=e.dict,this.input=new Uint8Array(5)}readBlock(){const s=this.str;let r=s.getByte();for(;qa(r);)r=s.getByte();if(r===-1||r===126){this.eof=!0;return}const a=this.bufferLength;let o,l;if(r===122){for(o=this.ensureBuffer(a+4),l=0;l<4;++l)o[a+l]=0;this.bufferLength+=4}else{const c=this.input;for(c[0]=r,l=1;l<5;++l){for(r=s.getByte();qa(r);)r=s.getByte();if(c[l]=r,r===-1||r===126)break}if(o=this.ensureBuffer(a+l-1),this.bufferLength+=l-1,l<5){for(;l<5;++l)c[l]=117;this.eof=!0}let h=0;for(l=0;l<5;++l)h=h*85+(c[l]-33);for(l=3;l>=0;--l)o[a+l]=h&255,h>>=8}}}class _H extends Zr{constructor(e,t){t&&(t*=.5),super(t),this.str=e,this.dict=e.dict,this.firstDigit=-1}readBlock(){const t=this.str.getBytes(8e3);if(!t.length){this.eof=!0;return}const i=t.length+1>>1,s=this.ensureBuffer(this.bufferLength+i);let r=this.bufferLength,a=this.firstDigit;for(const o of t){let l;if(o>=48&&o<=57)l=o&15;else if(o>=65&&o<=70||o>=97&&o<=102)l=(o&15)+9;else if(o===62){this.eof=!0;break}else continue;a<0?a=l:(s[r++]=a<<4|l,a=-1)}a>=0&&this.eof&&(s[r++]=a<<4,a=-1),this.firstDigit=a,this.bufferLength=r}}const j7=-2,lc=-1,gc=0,Js=1,jt=2,Zs=3,Qs=4,G7=5,V7=6,IR=7,ER=8,Zv=[[-1,-1],[-1,-1],[7,ER],[7,IR],[6,V7],[6,V7],[6,G7],[6,G7],[4,gc],[4,gc],[4,gc],[4,gc],[4,gc],[4,gc],[4,gc],[4,gc],[3,Js],[3,Js],[3,Js],[3,Js],[3,Js],[3,Js],[3,Js],[3,Js],[3,Js],[3,Js],[3,Js],[3,Js],[3,Js],[3,Js],[3,Js],[3,Js],[3,Qs],[3,Qs],[3,Qs],[3,Qs],[3,Qs],[3,Qs],[3,Qs],[3,Qs],[3,Qs],[3,Qs],[3,Qs],[3,Qs],[3,Qs],[3,Qs],[3,Qs],[3,Qs],[3,Zs],[3,Zs],[3,Zs],[3,Zs],[3,Zs],[3,Zs],[3,Zs],[3,Zs],[3,Zs],[3,Zs],[3,Zs],[3,Zs],[3,Zs],[3,Zs],[3,Zs],[3,Zs],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt],[1,jt]],Qv=[[-1,-1],[12,j7],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[11,1792],[11,1792],[12,1984],[12,2048],[12,2112],[12,2176],[12,2240],[12,2304],[11,1856],[11,1856],[11,1920],[11,1920],[12,2368],[12,2432],[12,2496],[12,2560]],$v=[[-1,-1],[-1,-1],[-1,-1],[-1,-1],[8,29],[8,29],[8,30],[8,30],[8,45],[8,45],[8,46],[8,46],[7,22],[7,22],[7,22],[7,22],[7,23],[7,23],[7,23],[7,23],[8,47],[8,47],[8,48],[8,48],[6,13],[6,13],[6,13],[6,13],[6,13],[6,13],[6,13],[6,13],[7,20],[7,20],[7,20],[7,20],[8,33],[8,33],[8,34],[8,34],[8,35],[8,35],[8,36],[8,36],[8,37],[8,37],[8,38],[8,38],[7,19],[7,19],[7,19],[7,19],[8,31],[8,31],[8,32],[8,32],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,12],[6,12],[6,12],[6,12],[6,12],[6,12],[6,12],[6,12],[8,53],[8,53],[8,54],[8,54],[7,26],[7,26],[7,26],[7,26],[8,39],[8,39],[8,40],[8,40],[8,41],[8,41],[8,42],[8,42],[8,43],[8,43],[8,44],[8,44],[7,21],[7,21],[7,21],[7,21],[7,28],[7,28],[7,28],[7,28],[8,61],[8,61],[8,62],[8,62],[8,63],[8,63],[8,0],[8,0],[8,320],[8,320],[8,384],[8,384],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[7,27],[7,27],[7,27],[7,27],[8,59],[8,59],[8,60],[8,60],[9,1472],[9,1536],[9,1600],[9,1728],[7,18],[7,18],[7,18],[7,18],[7,24],[7,24],[7,24],[7,24],[8,49],[8,49],[8,50],[8,50],[8,51],[8,51],[8,52],[8,52],[7,25],[7,25],[7,25],[7,25],[8,55],[8,55],[8,56],[8,56],[8,57],[8,57],[8,58],[8,58],[6,192],[6,192],[6,192],[6,192],[6,192],[6,192],[6,192],[6,192],[6,1664],[6,1664],[6,1664],[6,1664],[6,1664],[6,1664],[6,1664],[6,1664],[8,448],[8,448],[8,512],[8,512],[9,704],[9,768],[8,640],[8,640],[8,576],[8,576],[9,832],[9,896],[9,960],[9,1024],[9,1088],[9,1152],[9,1216],[9,1280],[9,1344],[9,1408],[7,256],[7,256],[7,256],[7,256],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[6,16],[6,16],[6,16],[6,16],[6,16],[6,16],[6,16],[6,16],[6,17],[6,17],[6,17],[6,17],[6,17],[6,17],[6,17],[6,17],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[6,14],[6,14],[6,14],[6,14],[6,14],[6,14],[6,14],[6,14],[6,15],[6,15],[6,15],[6,15],[6,15],[6,15],[6,15],[6,15],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7]],ek=[[-1,-1],[-1,-1],[12,j7],[12,j7],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[11,1792],[11,1792],[11,1792],[11,1792],[12,1984],[12,1984],[12,2048],[12,2048],[12,2112],[12,2112],[12,2176],[12,2176],[12,2240],[12,2240],[12,2304],[12,2304],[11,1856],[11,1856],[11,1856],[11,1856],[11,1920],[11,1920],[11,1920],[11,1920],[12,2368],[12,2368],[12,2432],[12,2432],[12,2496],[12,2496],[12,2560],[12,2560],[10,18],[10,18],[10,18],[10,18],[10,18],[10,18],[10,18],[10,18],[12,52],[12,52],[13,640],[13,704],[13,768],[13,832],[12,55],[12,55],[12,56],[12,56],[13,1280],[13,1344],[13,1408],[13,1472],[12,59],[12,59],[12,60],[12,60],[13,1536],[13,1600],[11,24],[11,24],[11,24],[11,24],[11,25],[11,25],[11,25],[11,25],[13,1664],[13,1728],[12,320],[12,320],[12,384],[12,384],[12,448],[12,448],[13,512],[13,576],[12,53],[12,53],[12,54],[12,54],[13,896],[13,960],[13,1024],[13,1088],[13,1152],[13,1216],[10,64],[10,64],[10,64],[10,64],[10,64],[10,64],[10,64],[10,64]],tk=[[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[11,23],[11,23],[12,50],[12,51],[12,44],[12,45],[12,46],[12,47],[12,57],[12,58],[12,61],[12,256],[10,16],[10,16],[10,16],[10,16],[10,17],[10,17],[10,17],[10,17],[12,48],[12,49],[12,62],[12,63],[12,30],[12,31],[12,32],[12,33],[12,40],[12,41],[11,22],[11,22],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[9,15],[9,15],[9,15],[9,15],[9,15],[9,15],[9,15],[9,15],[12,128],[12,192],[12,26],[12,27],[12,28],[12,29],[11,19],[11,19],[11,20],[11,20],[12,34],[12,35],[12,36],[12,37],[12,38],[12,39],[11,21],[11,21],[12,42],[12,43],[10,0],[10,0],[10,0],[10,0],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12]],nk=[[-1,-1],[-1,-1],[-1,-1],[-1,-1],[6,9],[6,8],[5,7],[5,7],[4,6],[4,6],[4,6],[4,6],[4,5],[4,5],[4,5],[4,5],[3,1],[3,1],[3,1],[3,1],[3,1],[3,1],[3,1],[3,1],[3,4],[3,4],[3,4],[3,4],[3,4],[3,4],[3,4],[3,4],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2]];class TR{constructor(e,t={}){if(typeof(e==null?void 0:e.next)!="function")throw new Error('CCITTFaxDecoder - invalid "source" parameter.');this.source=e,this.eof=!1,this.encoding=t.K||0,this.eoline=t.EndOfLine||!1,this.byteAlign=t.EncodedByteAlign||!1,this.columns=t.Columns||1728,this.rows=t.Rows||0,this.eoblock=t.EndOfBlock??!0,this.black=t.BlackIs1||!1,this.codingLine=new Uint32Array(this.columns+1),this.refLine=new Uint32Array(this.columns+2),this.codingLine[0]=this.columns,this.codingPos=0,this.row=0,this.nextLine2D=this.encoding<0,this.inputBits=0,this.inputBuf=0,this.outputBits=0,this.rowsDone=!1;let i;for(;(i=this._lookBits(12))===0;)this._eatBits(1);i===1&&this._eatBits(12),this.encoding>0&&(this.nextLine2D=!this._lookBits(1),this._eatBits(1))}readNextChar(){if(this.eof)return-1;const e=this.refLine,t=this.codingLine,i=this.columns;let s,r,a,o;if(this.outputBits===0){if(this.rowsDone&&(this.eof=!0),this.eof)return-1;this.err=!1;let c,h,u;if(this.nextLine2D){for(o=0;t[o]<i;++o)e[o]=t[o];for(e[o++]=i,e[o]=i,t[0]=0,this.codingPos=0,s=0,r=0;t[this.codingPos]<i;)switch(c=this._getTwoDimCode(),c){case gc:this._addPixels(e[s+1],r),e[s+1]<i&&(s+=2);break;case Js:if(c=h=0,r){do c+=u=this._getBlackCode();while(u>=64);do h+=u=this._getWhiteCode();while(u>=64)}else{do c+=u=this._getWhiteCode();while(u>=64);do h+=u=this._getBlackCode();while(u>=64)}for(this._addPixels(t[this.codingPos]+c,r),t[this.codingPos]<i&&this._addPixels(t[this.codingPos]+h,r^1);e[s]<=t[this.codingPos]&&e[s]<i;)s+=2;break;case IR:if(this._addPixels(e[s]+3,r),r^=1,t[this.codingPos]<i)for(++s;e[s]<=t[this.codingPos]&&e[s]<i;)s+=2;break;case G7:if(this._addPixels(e[s]+2,r),r^=1,t[this.codingPos]<i)for(++s;e[s]<=t[this.codingPos]&&e[s]<i;)s+=2;break;case Zs:if(this._addPixels(e[s]+1,r),r^=1,t[this.codingPos]<i)for(++s;e[s]<=t[this.codingPos]&&e[s]<i;)s+=2;break;case jt:if(this._addPixels(e[s],r),r^=1,t[this.codingPos]<i)for(++s;e[s]<=t[this.codingPos]&&e[s]<i;)s+=2;break;case ER:if(this._addPixelsNeg(e[s]-3,r),r^=1,t[this.codingPos]<i)for(s>0?--s:++s;e[s]<=t[this.codingPos]&&e[s]<i;)s+=2;break;case V7:if(this._addPixelsNeg(e[s]-2,r),r^=1,t[this.codingPos]<i)for(s>0?--s:++s;e[s]<=t[this.codingPos]&&e[s]<i;)s+=2;break;case Qs:if(this._addPixelsNeg(e[s]-1,r),r^=1,t[this.codingPos]<i)for(s>0?--s:++s;e[s]<=t[this.codingPos]&&e[s]<i;)s+=2;break;case lc:this._addPixels(i,0),this.eof=!0;break;default:gn("bad 2d code"),this._addPixels(i,0),this.err=!0}}else for(t[0]=0,this.codingPos=0,r=0;t[this.codingPos]<i;){if(c=0,r)do c+=u=this._getBlackCode();while(u>=64);else do c+=u=this._getWhiteCode();while(u>=64);this._addPixels(t[this.codingPos]+c,r),r^=1}let d=!1;if(this.byteAlign&&(this.inputBits&=-8),!this.eoblock&&this.row===this.rows-1)this.rowsDone=!0;else{if(c=this._lookBits(12),this.eoline)for(;c!==lc&&c!==1;)this._eatBits(1),c=this._lookBits(12);else for(;c===0;)this._eatBits(1),c=this._lookBits(12);c===1?(this._eatBits(12),d=!0):c===lc&&(this.eof=!0)}if(!this.eof&&this.encoding>0&&!this.rowsDone&&(this.nextLine2D=!this._lookBits(1),this._eatBits(1)),this.eoblock&&d&&this.byteAlign){if(c=this._lookBits(12),c===1){if(this._eatBits(12),this.encoding>0&&(this._lookBits(1),this._eatBits(1)),this.encoding>=0)for(o=0;o<4;++o)c=this._lookBits(12),c!==1&&gn("bad rtc code: "+c),this._eatBits(12),this.encoding>0&&(this._lookBits(1),this._eatBits(1));this.eof=!0}}else if(this.err&&this.eoline){for(;;){if(c=this._lookBits(13),c===lc)return this.eof=!0,-1;if(c>>1===1)break;this._eatBits(1)}this._eatBits(12),this.encoding>0&&(this._eatBits(1),this.nextLine2D=!(c&1))}this.outputBits=t[0]>0?t[this.codingPos=0]:t[this.codingPos=1],this.row++}let l;if(this.outputBits>=8)l=this.codingPos&1?0:255,this.outputBits-=8,this.outputBits===0&&t[this.codingPos]<i&&(this.codingPos++,this.outputBits=t[this.codingPos]-t[this.codingPos-1]);else{a=8,l=0;do{if(typeof this.outputBits!="number")throw new Te('Invalid /CCITTFaxDecode data, "outputBits" must be a number.');this.outputBits>a?(l<<=a,this.codingPos&1||(l|=255>>8-a),this.outputBits-=a,a=0):(l<<=this.outputBits,this.codingPos&1||(l|=255>>8-this.outputBits),a-=this.outputBits,this.outputBits=0,t[this.codingPos]<i?(this.codingPos++,this.outputBits=t[this.codingPos]-t[this.codingPos-1]):a>0&&(l<<=a,a=0))}while(a)}return this.black&&(l^=255),l}_addPixels(e,t){const i=this.codingLine;let s=this.codingPos;e>i[s]&&(e>this.columns&&(gn("row is wrong length"),this.err=!0,e=this.columns),s&1^t&&++s,i[s]=e),this.codingPos=s}_addPixelsNeg(e,t){const i=this.codingLine;let s=this.codingPos;if(e>i[s])e>this.columns&&(gn("row is wrong length"),this.err=!0,e=this.columns),s&1^t&&++s,i[s]=e;else if(e<i[s]){for(e<0&&(gn("invalid code"),this.err=!0,e=0);s>0&&e<i[s-1];)--s;i[s]=e}this.codingPos=s}_findTableCode(e,t,i,s){const r=s||0;for(let a=e;a<=t;++a){let o=this._lookBits(a);if(o===lc)return[!0,1,!1];if(a<t&&(o<<=t-a),!r||o>=r){const l=i[o-r];if(l[0]===a)return this._eatBits(a),[!0,l[1],!0]}}return[!1,0,!1]}_getTwoDimCode(){let e=0,t;if(this.eoblock){if(e=this._lookBits(7),t=Zv[e],(t==null?void 0:t[0])>0)return this._eatBits(t[0]),t[1]}else{const i=this._findTableCode(1,7,Zv);if(i[0]&&i[2])return i[1]}return gn("Bad two dim code"),lc}_getWhiteCode(){let e=0,t;if(this.eoblock){if(e=this._lookBits(12),e===lc)return 1;if(t=e>>5?$v[e>>3]:Qv[e],t[0]>0)return this._eatBits(t[0]),t[1]}else{let i=this._findTableCode(1,9,$v);if(i[0]||(i=this._findTableCode(11,12,Qv),i[0]))return i[1]}return gn("bad white code"),this._eatBits(1),1}_getBlackCode(){let e,t;if(this.eoblock){if(e=this._lookBits(13),e===lc)return 1;if(e>>7?!(e>>9)&&e>>7?t=tk[(e>>1)-64]:t=nk[e>>7]:t=ek[e],t[0]>0)return this._eatBits(t[0]),t[1]}else{let i=this._findTableCode(2,6,nk);if(i[0]||(i=this._findTableCode(7,12,tk,64),i[0])||(i=this._findTableCode(10,13,ek),i[0]))return i[1]}return gn("bad black code"),this._eatBits(1),1}_lookBits(e){let t;for(;this.inputBits<e;){if((t=this.source.next())===-1)return this.inputBits===0?lc:this.inputBuf<<e-this.inputBits&65535>>16-e;this.inputBuf=this.inputBuf<<8|t,this.inputBits+=8}return this.inputBuf>>this.inputBits-e&65535>>16-e}_eatBits(e){(this.inputBits-=e)<0&&(this.inputBits=0)}}class vH extends Zr{constructor(e,t,i){super(t),this.str=e,this.dict=e.dict,i instanceof fe||(i=fe.empty);const s={next(){return e.getByte()}};this.ccittFaxDecoder=new TR(s,{K:i.get("K"),EndOfLine:i.get("EndOfLine"),EncodedByteAlign:i.get("EncodedByteAlign"),Columns:i.get("Columns"),Rows:i.get("Rows"),EndOfBlock:i.get("EndOfBlock"),BlackIs1:i.get("BlackIs1")})}readBlock(){for(;!this.eof;){const e=this.ccittFaxDecoder.readNextChar();if(e===-1){this.eof=!0;return}this.ensureBuffer(this.bufferLength+1),this.buffer[this.bufferLength++]=e}}}const ik=new Int32Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),kH=new Int32Array([3,4,5,6,7,8,9,10,65547,65549,65551,65553,131091,131095,131099,131103,196643,196651,196659,196667,262211,262227,262243,262259,327811,327843,327875,327907,258,258,258]),CH=new Int32Array([1,2,3,4,65541,65543,131081,131085,196625,196633,262177,262193,327745,327777,393345,393409,459009,459137,524801,525057,590849,591361,657409,658433,724993,727041,794625,798721,868353,876545]),AH=[new Int32Array([459008,524368,524304,524568,459024,524400,524336,590016,459016,524384,524320,589984,524288,524416,524352,590048,459012,524376,524312,589968,459028,524408,524344,590032,459020,524392,524328,59e4,524296,524424,524360,590064,459010,524372,524308,524572,459026,524404,524340,590024,459018,524388,524324,589992,524292,524420,524356,590056,459014,524380,524316,589976,459030,524412,524348,590040,459022,524396,524332,590008,524300,524428,524364,590072,459009,524370,524306,524570,459025,524402,524338,590020,459017,524386,524322,589988,524290,524418,524354,590052,459013,524378,524314,589972,459029,524410,524346,590036,459021,524394,524330,590004,524298,524426,524362,590068,459011,524374,524310,524574,459027,524406,524342,590028,459019,524390,524326,589996,524294,524422,524358,590060,459015,524382,524318,589980,459031,524414,524350,590044,459023,524398,524334,590012,524302,524430,524366,590076,459008,524369,524305,524569,459024,524401,524337,590018,459016,524385,524321,589986,524289,524417,524353,590050,459012,524377,524313,589970,459028,524409,524345,590034,459020,524393,524329,590002,524297,524425,524361,590066,459010,524373,524309,524573,459026,524405,524341,590026,459018,524389,524325,589994,524293,524421,524357,590058,459014,524381,524317,589978,459030,524413,524349,590042,459022,524397,524333,590010,524301,524429,524365,590074,459009,524371,524307,524571,459025,524403,524339,590022,459017,524387,524323,589990,524291,524419,524355,590054,459013,524379,524315,589974,459029,524411,524347,590038,459021,524395,524331,590006,524299,524427,524363,590070,459011,524375,524311,524575,459027,524407,524343,590030,459019,524391,524327,589998,524295,524423,524359,590062,459015,524383,524319,589982,459031,524415,524351,590046,459023,524399,524335,590014,524303,524431,524367,590078,459008,524368,524304,524568,459024,524400,524336,590017,459016,524384,524320,589985,524288,524416,524352,590049,459012,524376,524312,589969,459028,524408,524344,590033,459020,524392,524328,590001,524296,524424,524360,590065,459010,524372,524308,524572,459026,524404,524340,590025,459018,524388,524324,589993,524292,524420,524356,590057,459014,524380,524316,589977,459030,524412,524348,590041,459022,524396,524332,590009,524300,524428,524364,590073,459009,524370,524306,524570,459025,524402,524338,590021,459017,524386,524322,589989,524290,524418,524354,590053,459013,524378,524314,589973,459029,524410,524346,590037,459021,524394,524330,590005,524298,524426,524362,590069,459011,524374,524310,524574,459027,524406,524342,590029,459019,524390,524326,589997,524294,524422,524358,590061,459015,524382,524318,589981,459031,524414,524350,590045,459023,524398,524334,590013,524302,524430,524366,590077,459008,524369,524305,524569,459024,524401,524337,590019,459016,524385,524321,589987,524289,524417,524353,590051,459012,524377,524313,589971,459028,524409,524345,590035,459020,524393,524329,590003,524297,524425,524361,590067,459010,524373,524309,524573,459026,524405,524341,590027,459018,524389,524325,589995,524293,524421,524357,590059,459014,524381,524317,589979,459030,524413,524349,590043,459022,524397,524333,590011,524301,524429,524365,590075,459009,524371,524307,524571,459025,524403,524339,590023,459017,524387,524323,589991,524291,524419,524355,590055,459013,524379,524315,589975,459029,524411,524347,590039,459021,524395,524331,590007,524299,524427,524363,590071,459011,524375,524311,524575,459027,524407,524343,590031,459019,524391,524327,589999,524295,524423,524359,590063,459015,524383,524319,589983,459031,524415,524351,590047,459023,524399,524335,590015,524303,524431,524367,590079]),9],SH=[new Int32Array([327680,327696,327688,327704,327684,327700,327692,327708,327682,327698,327690,327706,327686,327702,327694,0,327681,327697,327689,327705,327685,327701,327693,327709,327683,327699,327691,327707,327687,327703,327695,0]),5];var _h,Tf;class sk extends Zr{constructor(t,i){super(i);B(this,_h);this.str=t,this.dict=t.dict;const s=t.getByte(),r=t.getByte();if(s===-1||r===-1)throw new Te(`Invalid header in flate stream: ${s}, ${r}`);if((s&15)!==8)throw new Te(`Unknown compression method in flate stream: ${s}, ${r}`);if(((s<<8)+r)%31!==0)throw new Te(`Bad FCHECK in flate stream: ${s}, ${r}`);if(r&32)throw new Te(`FDICT bit set in flate stream: ${s}, ${r}`);this.codeSize=0,this.codeBuf=0}async getImageData(t,i){const s=await this.asyncGetBytes();return s?s.length<=t?s:s.subarray(0,t):this.getBytes(t)}async asyncGetBytes(){this.str.reset();const t=this.str.getBytes();try{const{readable:i,writable:s}=new DecompressionStream("deflate"),r=s.getWriter();await r.ready,r.write(t).then(async()=>{await r.ready,await r.close()}).catch(()=>{});const a=[];let o=0;for await(const h of i)a.push(h),o+=h.byteLength;const l=new Uint8Array(o);let c=0;for(const h of a)l.set(h,c),c+=h.byteLength;return l}catch{return this.str=new Hi(t,2,t.length,this.str.dict),this.reset(),null}}get isAsync(){return!0}getBits(t){const i=this.str;let s=this.codeSize,r=this.codeBuf,a;for(;s<t;){if((a=i.getByte())===-1)throw new Te("Bad encoding in flate stream");r|=a<<s,s+=8}return a=r&(1<<t)-1,this.codeBuf=r>>t,this.codeSize=s-=t,a}getCode(t){const i=this.str,s=t[0],r=t[1];let a=this.codeSize,o=this.codeBuf,l;for(;a<r&&(l=i.getByte())!==-1;)o|=l<<a,a+=8;const c=s[o&(1<<r)-1],h=c>>16,u=c&65535;if(h<1||a<h)throw new Te("Bad encoding in flate stream");return this.codeBuf=o>>h,this.codeSize=a-h,u}generateHuffmanTable(t){const i=t.length;let s=0,r;for(r=0;r<i;++r)t[r]>s&&(s=t[r]);const a=1<<s,o=new Int32Array(a);for(let l=1,c=0,h=2;l<=s;++l,c<<=1,h<<=1)for(let u=0;u<i;++u)if(t[u]===l){let d=0,f=c;for(r=0;r<l;++r)d=d<<1|f&1,f>>=1;for(r=d;r<a;r+=h)o[r]=l<<16|u;++c}return[o,s]}readBlock(){let t,i,s;const r=this.str;try{i=this.getBits(3)}catch(h){D(this,_h,Tf).call(this,h.message);return}if(i&1&&(this.eof=!0),i>>=1,i===0){let h;if((h=r.getByte())===-1){D(this,_h,Tf).call(this,"Bad block header in flate stream");return}let u=h;if((h=r.getByte())===-1){D(this,_h,Tf).call(this,"Bad block header in flate stream");return}if(u|=h<<8,(h=r.getByte())===-1){D(this,_h,Tf).call(this,"Bad block header in flate stream");return}let d=h;if((h=r.getByte())===-1){D(this,_h,Tf).call(this,"Bad block header in flate stream");return}if(d|=h<<8,d!==(~u&65535)&&(u!==0||d!==0))throw new Te("Bad uncompressed block length in flate stream");this.codeBuf=0,this.codeSize=0;const f=this.bufferLength,g=f+u;if(t=this.ensureBuffer(g),this.bufferLength=g,u===0)r.peekByte()===-1&&(this.eof=!0);else{const m=r.getBytes(u);t.set(m,f),m.length<u&&(this.eof=!0)}return}let a,o;if(i===1)a=AH,o=SH;else if(i===2){const h=this.getBits(5)+257,u=this.getBits(5)+1,d=this.getBits(4)+4,f=new Uint8Array(ik.length);let g;for(g=0;g<d;++g)f[ik[g]]=this.getBits(3);const m=this.generateHuffmanTable(f);s=0,g=0;const x=h+u,p=new Uint8Array(x);let y,w,_;for(;g<x;){const v=this.getCode(m);if(v===16)y=2,w=3,_=s;else if(v===17)y=3,w=3,_=s=0;else if(v===18)y=7,w=11,_=s=0;else{p[g++]=s=v;continue}let C=this.getBits(y)+w;for(;C-- >0;)p[g++]=_}a=this.generateHuffmanTable(p.subarray(0,h)),o=this.generateHuffmanTable(p.subarray(h,x))}else throw new Te("Unknown block type in flate stream");t=this.buffer;let l=t?t.length:0,c=this.bufferLength;for(;;){let h=this.getCode(a);if(h<256){c+1>=l&&(t=this.ensureBuffer(c+1),l=t.length),t[c++]=h;continue}if(h===256){this.bufferLength=c;return}h-=257,h=kH[h];let u=h>>16;u>0&&(u=this.getBits(u)),s=(h&65535)+u,h=this.getCode(o),h=CH[h],u=h>>16,u>0&&(u=this.getBits(u));const d=(h&65535)+u;c+s>=l&&(t=this.ensureBuffer(c+s),l=t.length);for(let f=0;f<s;++f,++c)t[c]=t[c-d]}}}_h=new WeakSet,Tf=function(t){gn(t),this.eof=!0};const IH=[{qe:22017,nmps:1,nlps:1,switchFlag:1},{qe:13313,nmps:2,nlps:6,switchFlag:0},{qe:6145,nmps:3,nlps:9,switchFlag:0},{qe:2753,nmps:4,nlps:12,switchFlag:0},{qe:1313,nmps:5,nlps:29,switchFlag:0},{qe:545,nmps:38,nlps:33,switchFlag:0},{qe:22017,nmps:7,nlps:6,switchFlag:1},{qe:21505,nmps:8,nlps:14,switchFlag:0},{qe:18433,nmps:9,nlps:14,switchFlag:0},{qe:14337,nmps:10,nlps:14,switchFlag:0},{qe:12289,nmps:11,nlps:17,switchFlag:0},{qe:9217,nmps:12,nlps:18,switchFlag:0},{qe:7169,nmps:13,nlps:20,switchFlag:0},{qe:5633,nmps:29,nlps:21,switchFlag:0},{qe:22017,nmps:15,nlps:14,switchFlag:1},{qe:21505,nmps:16,nlps:14,switchFlag:0},{qe:20737,nmps:17,nlps:15,switchFlag:0},{qe:18433,nmps:18,nlps:16,switchFlag:0},{qe:14337,nmps:19,nlps:17,switchFlag:0},{qe:13313,nmps:20,nlps:18,switchFlag:0},{qe:12289,nmps:21,nlps:19,switchFlag:0},{qe:10241,nmps:22,nlps:19,switchFlag:0},{qe:9217,nmps:23,nlps:20,switchFlag:0},{qe:8705,nmps:24,nlps:21,switchFlag:0},{qe:7169,nmps:25,nlps:22,switchFlag:0},{qe:6145,nmps:26,nlps:23,switchFlag:0},{qe:5633,nmps:27,nlps:24,switchFlag:0},{qe:5121,nmps:28,nlps:25,switchFlag:0},{qe:4609,nmps:29,nlps:26,switchFlag:0},{qe:4353,nmps:30,nlps:27,switchFlag:0},{qe:2753,nmps:31,nlps:28,switchFlag:0},{qe:2497,nmps:32,nlps:29,switchFlag:0},{qe:2209,nmps:33,nlps:30,switchFlag:0},{qe:1313,nmps:34,nlps:31,switchFlag:0},{qe:1089,nmps:35,nlps:32,switchFlag:0},{qe:673,nmps:36,nlps:33,switchFlag:0},{qe:545,nmps:37,nlps:34,switchFlag:0},{qe:321,nmps:38,nlps:35,switchFlag:0},{qe:273,nmps:39,nlps:36,switchFlag:0},{qe:133,nmps:40,nlps:37,switchFlag:0},{qe:73,nmps:41,nlps:38,switchFlag:0},{qe:37,nmps:42,nlps:39,switchFlag:0},{qe:21,nmps:43,nlps:40,switchFlag:0},{qe:9,nmps:44,nlps:41,switchFlag:0},{qe:5,nmps:45,nlps:42,switchFlag:0},{qe:1,nmps:45,nlps:43,switchFlag:0},{qe:22017,nmps:46,nlps:46,switchFlag:0}];class EH{constructor(e,t,i){this.data=e,this.bp=t,this.dataEnd=i,this.chigh=e[t],this.clow=0,this.byteIn(),this.chigh=this.chigh<<7&65535|this.clow>>9&127,this.clow=this.clow<<7&65535,this.ct-=7,this.a=32768}byteIn(){const e=this.data;let t=this.bp;e[t]===255?e[t+1]>143?(this.clow+=65280,this.ct=8):(t++,this.clow+=e[t]<<9,this.ct=7,this.bp=t):(t++,this.clow+=t<this.dataEnd?e[t]<<8:65280,this.ct=8,this.bp=t),this.clow>65535&&(this.chigh+=this.clow>>16,this.clow&=65535)}readBit(e,t){let i=e[t]>>1,s=e[t]&1;const r=IH[i],a=r.qe;let o,l=this.a-a;if(this.chigh<a)l<a?(l=a,o=s,i=r.nmps):(l=a,o=1^s,r.switchFlag===1&&(s=o),i=r.nlps);else{if(this.chigh-=a,l&32768)return this.a=l,s;l<a?(o=1^s,r.switchFlag===1&&(s=o),i=r.nlps):(o=s,i=r.nmps)}do this.ct===0&&this.byteIn(),l<<=1,this.chigh=this.chigh<<1&65535|this.clow>>15&1,this.clow=this.clow<<1&65535,this.ct--;while(!(l&32768));return this.a=l,e[t]=i<<1|s,o}}class Fi extends $r{constructor(e){super(e,"Jbig2Error")}}class TH{getContexts(e){return e in this?this[e]:this[e]=new Int8Array(65536)}}class Am{constructor(e,t,i){this.data=e,this.start=t,this.end=i}get decoder(){const e=new EH(this.data,this.start,this.end);return Ze(this,"decoder",e)}get contextCache(){const e=new TH;return Ze(this,"contextCache",e)}}function vr(n,e,t){const i=n.getContexts(e);let s=1;function r(c){let h=0;for(let u=0;u<c;u++){const d=t.readBit(i,s);s=s<256?s<<1|d:(s<<1|d)&511|256,h=h<<1|d}return h>>>0}const a=r(1),o=r(1)?r(1)?r(1)?r(1)?r(1)?r(32)+4436:r(12)+340:r(8)+84:r(6)+20:r(4)+4:r(2);let l;return a===0?l=o:o>0&&(l=-o),l>=vU&&l<=C7?l:null}function RR(n,e,t){const i=n.getContexts("IAID");let s=1;for(let r=0;r<t;r++){const a=e.readBit(i,s);s=s<<1|a}return t<31?s&(1<<t)-1:s&2147483647}const rk=["SymbolDictionary",null,null,null,"IntermediateTextRegion",null,"ImmediateTextRegion","ImmediateLosslessTextRegion",null,null,null,null,null,null,null,null,"PatternDictionary",null,null,null,"IntermediateHalftoneRegion",null,"ImmediateHalftoneRegion","ImmediateLosslessHalftoneRegion",null,null,null,null,null,null,null,null,null,null,null,null,"IntermediateGenericRegion",null,"ImmediateGenericRegion","ImmediateLosslessGenericRegion","IntermediateGenericRefinementRegion",null,"ImmediateGenericRefinementRegion","ImmediateLosslessGenericRefinementRegion",null,null,null,null,"PageInformation","EndOfPage","EndOfStripe","EndOfFile","Profiles","Tables",null,null,null,null,null,null,null,null,"Extension"],RH=[[{x:-1,y:-2},{x:0,y:-2},{x:1,y:-2},{x:-2,y:-1},{x:-1,y:-1},{x:0,y:-1},{x:1,y:-1},{x:2,y:-1},{x:-4,y:0},{x:-3,y:0},{x:-2,y:0},{x:-1,y:0}],[{x:-1,y:-2},{x:0,y:-2},{x:1,y:-2},{x:2,y:-2},{x:-2,y:-1},{x:-1,y:-1},{x:0,y:-1},{x:1,y:-1},{x:2,y:-1},{x:-3,y:0},{x:-2,y:0},{x:-1,y:0}],[{x:-1,y:-2},{x:0,y:-2},{x:1,y:-2},{x:-2,y:-1},{x:-1,y:-1},{x:0,y:-1},{x:1,y:-1},{x:-2,y:0},{x:-1,y:0}],[{x:-3,y:-1},{x:-2,y:-1},{x:-1,y:-1},{x:0,y:-1},{x:1,y:-1},{x:-4,y:0},{x:-3,y:0},{x:-2,y:0},{x:-1,y:0}]],ak=[{coding:[{x:0,y:-1},{x:1,y:-1},{x:-1,y:0}],reference:[{x:0,y:-1},{x:1,y:-1},{x:-1,y:0},{x:0,y:0},{x:1,y:0},{x:-1,y:1},{x:0,y:1},{x:1,y:1}]},{coding:[{x:-1,y:-1},{x:0,y:-1},{x:1,y:-1},{x:-1,y:0}],reference:[{x:0,y:-1},{x:-1,y:0},{x:0,y:0},{x:1,y:0},{x:0,y:1},{x:1,y:1}]}],MH=[39717,1941,229,405];function PH(n,e,t){const i=t.decoder,s=t.contextCache.getContexts("GB"),r=[];let a,o,l,c,h,u,d;const f=31735;for(o=0;o<e;o++)for(h=r[o]=new Uint8Array(n),u=o<1?h:r[o-1],d=o<2?h:r[o-2],a=d[0]<<13|d[1]<<12|d[2]<<11|u[0]<<7|u[1]<<6|u[2]<<5|u[3]<<4,l=0;l<n;l++)h[l]=c=i.readBit(s,a),a=(a&f)<<1|(l+3<n?d[l+3]<<11:0)|(l+4<n?u[l+4]<<4:0)|c;return r}function ny(n,e,t,i,s,r,a,o){if(n){const se=new Hp(o.data,o.start,o.end);return v4(se,e,t,!1)}if(i===0&&!r&&!s&&a.length===4&&a[0].x===3&&a[0].y===-1&&a[1].x===-3&&a[1].y===-1&&a[2].x===2&&a[2].y===-2&&a[3].x===-2&&a[3].y===-2)return PH(e,t,o);const l=RH[i].concat(a);l.sort((se,de)=>se.y-de.y||se.x-de.x);const c=l.length,h=new Int8Array(c),u=new Int8Array(c),d=[];let f=0,g=0,m=0,x=0,p,y;for(y=0;y<c;y++)h[y]=l[y].x,u[y]=l[y].y,g=Math.min(g,l[y].x),m=Math.max(m,l[y].x),x=Math.min(x,l[y].y),y<c-1&&l[y].y===l[y+1].y&&l[y].x===l[y+1].x-1?f|=1<<c-1-y:d.push(y);const w=d.length,_=new Int8Array(w),v=new Int8Array(w),C=new Uint16Array(w);for(p=0;p<w;p++)y=d[p],_[p]=l[y].x,v[p]=l[y].y,C[p]=1<<c-1-y;const k=-g,I=-x,S=e-m,M=MH[i];let N=new Uint8Array(e);const F=[],H=o.decoder,T=o.contextCache.getContexts("GB");let z=0,R,L,Y,j=0,J,G;for(let se=0;se<t;se++){if(s){const de=H.readBit(T,M);if(z^=de,z){F.push(N);continue}}for(N=new Uint8Array(N),F.push(N),R=0;R<e;R++){if(R>=k&&R<S&&se>=I)for(j=j<<1&f,y=0;y<w;y++)L=se+v[y],Y=R+_[y],J=F[L][Y],J&&(J=C[y],j|=J);else for(j=0,G=c-1,y=0;y<c;y++,G--)Y=R+h[y],Y>=0&&Y<e&&(L=se+u[y],L>=0&&(J=F[L][Y],J&&(j|=J<<G)));const de=H.readBit(T,j);N[R]=de}}return F}function MR(n,e,t,i,s,r,a,o,l){let c=ak[t].coding;t===0&&(c=c.concat([o[0]]));const h=c.length,u=new Int32Array(h),d=new Int32Array(h);let f;for(f=0;f<h;f++)u[f]=c[f].x,d[f]=c[f].y;let g=ak[t].reference;t===0&&(g=g.concat([o[1]]));const m=g.length,x=new Int32Array(m),p=new Int32Array(m);for(f=0;f<m;f++)x[f]=g[f].x,p[f]=g[f].y;const y=i[0].length,w=i.length,_=[],v=l.decoder,C=l.contextCache.getContexts("GR");for(let k=0;k<e;k++){const I=new Uint8Array(n);_.push(I);for(let S=0;S<n;S++){let M,N,F=0;for(f=0;f<h;f++)M=k+d[f],N=S+u[f],M<0||N<0||N>=n?F<<=1:F=F<<1|_[M][N];for(f=0;f<m;f++)M=k+p[f]-r,N=S+x[f]-s,M<0||M>=w||N<0||N>=y?F<<=1:F=F<<1|i[M][N];const H=v.readBit(C,F);I[S]=H}}return _}function NH(n,e,t,i,s,r,a,o,l,c,h,u){if(n&&e)throw new Fi("symbol refinement with Huffman is not supported");const d=[];let f=0,g=y4(t.length+i);const m=h.decoder,x=h.contextCache;let p,y;for(n&&(p=Mh(1),y=[],g=Math.max(g,1));d.length<i;){const S=n?r.tableDeltaHeight.decode(u):vr(x,"IADH",m);f+=S;let M=0,N=0;const F=n?y.length:0;for(;;){const H=n?r.tableDeltaWidth.decode(u):vr(x,"IADW",m);if(H===null)break;M+=H,N+=M;let T;if(e){const z=vr(x,"IAAI",m);if(z>1)T=PR(n,e,M,f,0,z,1,t.concat(d),g,0,0,1,0,r,l,c,h,0,u);else{const R=RR(x,m,g),L=vr(x,"IARDX",m),Y=vr(x,"IARDY",m),j=R<t.length?t[R]:d[R-t.length];T=MR(M,f,l,j,L,Y,!1,c,h)}d.push(T)}else n?y.push(M):(T=ny(!1,M,f,a,!1,null,o,h),d.push(T))}if(n&&!e){const H=r.tableBitmapSize.decode(u);u.byteAlign();let T;if(H===0)T=qH(u,N,f);else{const R=u.end,L=u.position+H;u.end=L,T=v4(u,N,f,!1),u.end=R,u.position=L}const z=y.length;if(F===z-1)d.push(T);else{let R,L,Y=0,j,J,G;for(R=F;R<z;R++){for(J=y[R],j=Y+J,G=[],L=0;L<f;L++)G.push(T[L].subarray(Y,j));d.push(G),Y=j}}}}const w=[],_=[];let v=!1,C,k;const I=t.length+i;for(;_.length<I;){let S=n?p.decode(u):vr(x,"IAEX",m);for(;S--;)_.push(v);v=!v}for(C=0,k=t.length;C<k;C++)_[C]&&w.push(t[C]);for(let S=0;S<i;C++,S++)_[C]&&w.push(d[S]);return w}function PR(n,e,t,i,s,r,a,o,l,c,h,u,d,f,g,m,x,p,y){if(n&&e)throw new Fi("refinement with Huffman is not supported");const w=[];let _,v;for(_=0;_<i;_++)v=new Uint8Array(t),s&&v.fill(s),w.push(v);const C=x.decoder,k=x.contextCache;let I=n?-f.tableDeltaT.decode(y):-vr(k,"IADT",C),S=0;for(_=0;_<r;){const M=n?f.tableDeltaT.decode(y):vr(k,"IADT",C);I+=M;const N=n?f.tableFirstS.decode(y):vr(k,"IAFS",C);S+=N;let F=S;do{let H=0;a>1&&(H=n?y.readBits(p):vr(k,"IAIT",C));const T=a*I+H,z=n?f.symbolIDTable.decode(y):RR(k,C,l),R=e&&(n?y.readBit():vr(k,"IARI",C));let L=o[z],Y=L[0].length,j=L.length;if(R){const P=vr(k,"IARDW",C),V=vr(k,"IARDH",C),re=vr(k,"IARDX",C),X=vr(k,"IARDY",C);Y+=P,j+=V,L=MR(Y,j,g,L,(P>>1)+re,(V>>1)+X,!1,m,x)}let J=0;c?u&1?J=j-1:F+=j-1:u>1?F+=Y-1:J=Y-1;const G=T-(u&1?0:j-1),se=F-(u&2?Y-1:0);let de,he,we;if(c)for(de=0;de<j;de++){if(v=w[se+de],!v)continue;we=L[de];const P=Math.min(t-G,Y);switch(d){case 0:for(he=0;he<P;he++)v[G+he]|=we[he];break;case 2:for(he=0;he<P;he++)v[G+he]^=we[he];break;default:throw new Fi(`operator ${d} is not supported`)}}else for(he=0;he<j;he++)if(v=w[G+he],!!v)switch(we=L[he],d){case 0:for(de=0;de<Y;de++)v[se+de]|=we[de];break;case 2:for(de=0;de<Y;de++)v[se+de]^=we[de];break;default:throw new Fi(`operator ${d} is not supported`)}_++;const ye=n?f.tableDeltaS.decode(y):vr(k,"IADS",C);if(ye===null)break;F+=J+ye+h}while(!0)}return w}function OH(n,e,t,i,s,r){const a=[];n||(a.push({x:-e,y:0}),s===0&&a.push({x:-3,y:-1},{x:2,y:-2},{x:-2,y:-2}));const o=(i+1)*e,l=ny(n,o,t,s,!1,null,a,r),c=[];for(let h=0;h<=i;h++){const u=[],d=e*h,f=d+e;for(let g=0;g<t;g++)u.push(l[g].subarray(d,f));c.push(u)}return c}function DH(n,e,t,i,s,r,a,o,l,c,h,u,d,f,g){if(a)throw new Fi("skip is not supported");if(o!==0)throw new Fi(`operator "${o}" is not supported in halftone region`);const x=[];let p,y,w;for(p=0;p<s;p++)w=new Uint8Array(i),r&&w.fill(r),x.push(w);const _=e.length,v=e[0],C=v[0].length,k=v.length,I=y4(_),S=[];n||(S.push({x:t<=1?3:2,y:-1}),t===0&&S.push({x:-3,y:-1},{x:2,y:-2},{x:-2,y:-2}));const M=[];let N,F;for(n&&(N=new Hp(g.data,g.start,g.end)),p=I-1;p>=0;p--)n?F=v4(N,l,c,!0):F=ny(!1,l,c,t,!1,null,S,g),M[p]=F;let H,T,z,R,L,Y,j,J,G;for(H=0;H<c;H++)for(T=0;T<l;T++){for(z=0,R=0,y=I-1;y>=0;y--)z^=M[y][H][T],R|=z<<y;if(L=e[R],Y=h+H*f+T*d>>8,j=u+H*d-T*f>>8,Y>=0&&Y+C<=i&&j>=0&&j+k<=s)for(p=0;p<k;p++)for(G=x[j+p],J=L[p],y=0;y<C;y++)G[Y+y]|=J[y];else{let se,de;for(p=0;p<k;p++)if(de=j+p,!(de<0||de>=s))for(G=x[de],J=L[p],y=0;y<C;y++)se=Y+y,se>=0&&se<i&&(G[se]|=J[y])}}return x}function FH(n,e){const t={};t.number=Yn(n,e);const i=n[e+4],s=i&63;if(!rk[s])throw new Fi("invalid segment type: "+s);t.type=s,t.typeName=rk[s],t.deferredNonRetain=!!(i&128);const r=!!(i&64),a=n[e+5];let o=a>>5&7;const l=[a&31];let c=e+6;if(a===7){o=Yn(n,c-1)&536870911,c+=3;let g=o+7>>3;for(l[0]=n[c++];--g>0;)l.push(n[c++])}else if(a===5||a===6)throw new Fi("invalid referred-to flags");t.retainBits=l;let h=4;t.number<=256?h=1:t.number<=65536&&(h=2);const u=[];let d,f;for(d=0;d<o;d++){let g;h===1?g=n[c]:h===2?g=yn(n,c):g=Yn(n,c),u.push(g),c+=h}if(t.referredTo=u,r?(t.pageAssociation=Yn(n,c),c+=4):t.pageAssociation=n[c++],t.length=Yn(n,c),c+=4,t.length===4294967295)if(s===38){const g=n3(n,c),x=!!(n[c+i3]&1),p=6,y=new Uint8Array(p);for(x||(y[0]=255,y[1]=172),y[2]=g.height>>>24&255,y[3]=g.height>>16&255,y[4]=g.height>>8&255,y[5]=g.height&255,d=c,f=n.length;d<f;d++){let w=0;for(;w<p&&y[w]===n[d+w];)w++;if(w===p){t.length=d+p;break}}if(t.length===4294967295)throw new Fi("segment end was not found")}else throw new Fi("invalid unknown segment length");return t.headerEnd=c,t}function LH(n,e,t,i){const s=[];let r=t;for(;r<i;){const a=FH(e,r);r=a.headerEnd;const o={header:a,data:e};if(n.randomAccess||(o.start=r,r+=a.length,o.end=r),s.push(o),a.type===51)break}if(n.randomAccess)for(let a=0,o=s.length;a<o;a++)s[a].start=r,r+=s[a].header.length,s[a].end=r;return s}function n3(n,e){return{width:Yn(n,e),height:Yn(n,e+4),x:Yn(n,e+8),y:Yn(n,e+12),combinationOperator:n[e+16]&7}}const i3=17;function BH(n,e){const t=n.header,i=n.data,s=n.end;let r=n.start,a,o,l,c;switch(t.type){case 0:const u={},d=yn(i,r);if(u.huffman=!!(d&1),u.refinement=!!(d&2),u.huffmanDHSelector=d>>2&3,u.huffmanDWSelector=d>>4&3,u.bitmapSizeSelector=d>>6&1,u.aggregationInstancesSelector=d>>7&1,u.bitmapCodingContextUsed=!!(d&256),u.bitmapCodingContextRetained=!!(d&512),u.template=d>>10&3,u.refinementTemplate=d>>12&1,r+=2,!u.huffman){for(c=u.template===0?4:1,o=[],l=0;l<c;l++)o.push({x:_l(i,r),y:_l(i,r+1)}),r+=2;u.at=o}if(u.refinement&&!u.refinementTemplate){for(o=[],l=0;l<2;l++)o.push({x:_l(i,r),y:_l(i,r+1)}),r+=2;u.refinementAt=o}u.numberOfExportedSymbols=Yn(i,r),r+=4,u.numberOfNewSymbols=Yn(i,r),r+=4,a=[u,t.number,t.referredTo,i,r,s];break;case 6:case 7:const f={};f.info=n3(i,r),r+=i3;const g=yn(i,r);if(r+=2,f.huffman=!!(g&1),f.refinement=!!(g&2),f.logStripSize=g>>2&3,f.stripSize=1<<f.logStripSize,f.referenceCorner=g>>4&3,f.transposed=!!(g&64),f.combinationOperator=g>>7&3,f.defaultPixelValue=g>>9&1,f.dsOffset=g<<17>>27,f.refinementTemplate=g>>15&1,f.huffman){const k=yn(i,r);r+=2,f.huffmanFS=k&3,f.huffmanDS=k>>2&3,f.huffmanDT=k>>4&3,f.huffmanRefinementDW=k>>6&3,f.huffmanRefinementDH=k>>8&3,f.huffmanRefinementDX=k>>10&3,f.huffmanRefinementDY=k>>12&3,f.huffmanRefinementSizeSelector=!!(k&16384)}if(f.refinement&&!f.refinementTemplate){for(o=[],l=0;l<2;l++)o.push({x:_l(i,r),y:_l(i,r+1)}),r+=2;f.refinementAt=o}f.numberOfSymbolInstances=Yn(i,r),r+=4,a=[f,t.referredTo,i,r,s];break;case 16:const m={},x=i[r++];m.mmr=!!(x&1),m.template=x>>1&3,m.patternWidth=i[r++],m.patternHeight=i[r++],m.maxPatternIndex=Yn(i,r),r+=4,a=[m,t.number,i,r,s];break;case 22:case 23:const p={};p.info=n3(i,r),r+=i3;const y=i[r++];p.mmr=!!(y&1),p.template=y>>1&3,p.enableSkip=!!(y&8),p.combinationOperator=y>>4&7,p.defaultPixelValue=y>>7&1,p.gridWidth=Yn(i,r),r+=4,p.gridHeight=Yn(i,r),r+=4,p.gridOffsetX=Yn(i,r)&4294967295,r+=4,p.gridOffsetY=Yn(i,r)&4294967295,r+=4,p.gridVectorX=yn(i,r),r+=2,p.gridVectorY=yn(i,r),r+=2,a=[p,t.referredTo,i,r,s];break;case 38:case 39:const w={};w.info=n3(i,r),r+=i3;const _=i[r++];if(w.mmr=!!(_&1),w.template=_>>1&3,w.prediction=!!(_&8),!w.mmr){for(c=w.template===0?4:1,o=[],l=0;l<c;l++)o.push({x:_l(i,r),y:_l(i,r+1)}),r+=2;w.at=o}a=[w,i,r,s];break;case 48:const v={width:Yn(i,r),height:Yn(i,r+4),resolutionX:Yn(i,r+8),resolutionY:Yn(i,r+12)};v.height===4294967295&&delete v.height;const C=i[r+16];yn(i,r+17),v.lossless=!!(C&1),v.refinement=!!(C&2),v.defaultPixelValue=C>>2&1,v.combinationOperator=C>>3&3,v.requiresBuffer=!!(C&32),v.combinationOperatorOverride=!!(C&64),a=[v];break;case 49:break;case 50:break;case 51:break;case 53:a=[t.number,i,r,s];break;case 62:break;default:throw new Fi(`segment type ${t.typeName}(${t.type}) is not implemented`)}const h="on"+t.typeName;h in e&&e[h].apply(e,a)}function UH(n,e){for(let t=0,i=n.length;t<i;t++)BH(n[t],e)}function HH(n){const e=new zH;for(let t=0,i=n.length;t<i;t++){const s=n[t],r=LH({},s.data,s.start,s.end);UH(r,e)}return e.buffer}class zH{onPageInformation(e){this.currentPageInfo=e;const t=e.width+7>>3,i=new Uint8ClampedArray(t*e.height);e.defaultPixelValue&&i.fill(255),this.buffer=i}drawBitmap(e,t){const i=this.currentPageInfo,s=e.width,r=e.height,a=i.width+7>>3,o=i.combinationOperatorOverride?e.combinationOperator:i.combinationOperator,l=this.buffer,c=128>>(e.x&7);let h=e.y*a+(e.x>>3),u,d,f,g;switch(o){case 0:for(u=0;u<r;u++){for(f=c,g=h,d=0;d<s;d++)t[u][d]&&(l[g]|=f),f>>=1,f||(f=128,g++);h+=a}break;case 2:for(u=0;u<r;u++){for(f=c,g=h,d=0;d<s;d++)t[u][d]&&(l[g]^=f),f>>=1,f||(f=128,g++);h+=a}break;default:throw new Fi(`operator ${o} is not supported`)}}onImmediateGenericRegion(e,t,i,s){const r=e.info,a=new Am(t,i,s),o=ny(e.mmr,r.width,r.height,e.template,e.prediction,null,e.at,a);this.drawBitmap(r,o)}onImmediateLosslessGenericRegion(){this.onImmediateGenericRegion(...arguments)}onSymbolDictionary(e,t,i,s,r,a){let o,l;e.huffman&&(o=VH(e,i,this.customTables),l=new Hp(s,r,a));let c=this.symbols;c||(this.symbols=c={});const h=[];for(const d of i){const f=c[d];f&&h.push(...f)}const u=new Am(s,r,a);c[t]=NH(e.huffman,e.refinement,h,e.numberOfNewSymbols,e.numberOfExportedSymbols,o,e.template,e.at,e.refinementTemplate,e.refinementAt,u,l)}onImmediateTextRegion(e,t,i,s,r){const a=e.info;let o,l;const c=this.symbols,h=[];for(const g of t){const m=c[g];m&&h.push(...m)}const u=y4(h.length);e.huffman&&(l=new Hp(i,s,r),o=GH(e,t,this.customTables,h.length,l));const d=new Am(i,s,r),f=PR(e.huffman,e.refinement,a.width,a.height,e.defaultPixelValue,e.numberOfSymbolInstances,e.stripSize,h,u,e.transposed,e.dsOffset,e.referenceCorner,e.combinationOperator,o,e.refinementTemplate,e.refinementAt,d,e.logStripSize,l);this.drawBitmap(a,f)}onImmediateLosslessTextRegion(){this.onImmediateTextRegion(...arguments)}onPatternDictionary(e,t,i,s,r){let a=this.patterns;a||(this.patterns=a={});const o=new Am(i,s,r);a[t]=OH(e.mmr,e.patternWidth,e.patternHeight,e.maxPatternIndex,e.template,o)}onImmediateHalftoneRegion(e,t,i,s,r){const a=this.patterns[t[0]],o=e.info,l=new Am(i,s,r),c=DH(e.mmr,a,e.template,o.width,o.height,e.defaultPixelValue,e.enableSkip,e.combinationOperator,e.gridWidth,e.gridHeight,e.gridOffsetX,e.gridOffsetY,e.gridVectorX,e.gridVectorY,l);this.drawBitmap(o,c)}onImmediateLosslessHalftoneRegion(){this.onImmediateHalftoneRegion(...arguments)}onTables(e,t,i,s){let r=this.customTables;r||(this.customTables=r={}),r[e]=jH(t,i,s)}}class Rh{constructor(e){e.length===2?(this.isOOB=!0,this.rangeLow=0,this.prefixLength=e[0],this.rangeLength=0,this.prefixCode=e[1],this.isLowerRange=!1):(this.isOOB=!1,this.rangeLow=e[0],this.prefixLength=e[1],this.rangeLength=e[2],this.prefixCode=e[3],this.isLowerRange=e[4]==="lower")}}class R3{constructor(e){this.children=[],e?(this.isLeaf=!0,this.rangeLength=e.rangeLength,this.rangeLow=e.rangeLow,this.isLowerRange=e.isLowerRange,this.isOOB=e.isOOB):this.isLeaf=!1}buildTree(e,t){const i=e.prefixCode>>t&1;if(t<=0)this.children[i]=new R3(e);else{let s=this.children[i];s||(this.children[i]=s=new R3(null)),s.buildTree(e,t-1)}}decodeNode(e){if(this.isLeaf){if(this.isOOB)return null;const i=e.readBits(this.rangeLength);return this.rangeLow+(this.isLowerRange?-i:i)}const t=this.children[e.readBit()];if(!t)throw new Fi("invalid Huffman data");return t.decodeNode(e)}}class M3{constructor(e,t){t||this.assignPrefixCodes(e),this.rootNode=new R3(null);for(let i=0,s=e.length;i<s;i++){const r=e[i];r.prefixLength>0&&this.rootNode.buildTree(r,r.prefixLength-1)}}decode(e){return this.rootNode.decodeNode(e)}assignPrefixCodes(e){const t=e.length;let i=0;for(let h=0;h<t;h++)i=Math.max(i,e[h].prefixLength);const s=new Uint32Array(i+1);for(let h=0;h<t;h++)s[e[h].prefixLength]++;let r=1,a=0,o,l,c;for(s[0]=0;r<=i;){for(a=a+s[r-1]<<1,o=a,l=0;l<t;)c=e[l],c.prefixLength===r&&(c.prefixCode=o,o++),l++;r++}}}function jH(n,e,t){const i=n[e],s=Yn(n,e+1)&4294967295,r=Yn(n,e+5)&4294967295,a=new Hp(n,e+9,t),o=(i>>1&7)+1,l=(i>>4&7)+1,c=[];let h,u,d=s;do h=a.readBits(o),u=a.readBits(l),c.push(new Rh([d,h,u,0])),d+=1<<u;while(d<r);return h=a.readBits(o),c.push(new Rh([s-1,h,32,0,"lower"])),h=a.readBits(o),c.push(new Rh([r,h,32,0])),i&1&&(h=a.readBits(o),c.push(new Rh([h,0]))),new M3(c,!1)}const ok={};function Mh(n){let e=ok[n];if(e)return e;let t;switch(n){case 1:t=[[0,1,4,0],[16,2,8,2],[272,3,16,6],[65808,3,32,7]];break;case 2:t=[[0,1,0,0],[1,2,0,2],[2,3,0,6],[3,4,3,14],[11,5,6,30],[75,6,32,62],[6,63]];break;case 3:t=[[-256,8,8,254],[0,1,0,0],[1,2,0,2],[2,3,0,6],[3,4,3,14],[11,5,6,30],[-257,8,32,255,"lower"],[75,7,32,126],[6,62]];break;case 4:t=[[1,1,0,0],[2,2,0,2],[3,3,0,6],[4,4,3,14],[12,5,6,30],[76,5,32,31]];break;case 5:t=[[-255,7,8,126],[1,1,0,0],[2,2,0,2],[3,3,0,6],[4,4,3,14],[12,5,6,30],[-256,7,32,127,"lower"],[76,6,32,62]];break;case 6:t=[[-2048,5,10,28],[-1024,4,9,8],[-512,4,8,9],[-256,4,7,10],[-128,5,6,29],[-64,5,5,30],[-32,4,5,11],[0,2,7,0],[128,3,7,2],[256,3,8,3],[512,4,9,12],[1024,4,10,13],[-2049,6,32,62,"lower"],[2048,6,32,63]];break;case 7:t=[[-1024,4,9,8],[-512,3,8,0],[-256,4,7,9],[-128,5,6,26],[-64,5,5,27],[-32,4,5,10],[0,4,5,11],[32,5,5,28],[64,5,6,29],[128,4,7,12],[256,3,8,1],[512,3,9,2],[1024,3,10,3],[-1025,5,32,30,"lower"],[2048,5,32,31]];break;case 8:t=[[-15,8,3,252],[-7,9,1,508],[-5,8,1,253],[-3,9,0,509],[-2,7,0,124],[-1,4,0,10],[0,2,1,0],[2,5,0,26],[3,6,0,58],[4,3,4,4],[20,6,1,59],[22,4,4,11],[38,4,5,12],[70,5,6,27],[134,5,7,28],[262,6,7,60],[390,7,8,125],[646,6,10,61],[-16,9,32,510,"lower"],[1670,9,32,511],[2,1]];break;case 9:t=[[-31,8,4,252],[-15,9,2,508],[-11,8,2,253],[-7,9,1,509],[-5,7,1,124],[-3,4,1,10],[-1,3,1,2],[1,3,1,3],[3,5,1,26],[5,6,1,58],[7,3,5,4],[39,6,2,59],[43,4,5,11],[75,4,6,12],[139,5,7,27],[267,5,8,28],[523,6,8,60],[779,7,9,125],[1291,6,11,61],[-32,9,32,510,"lower"],[3339,9,32,511],[2,0]];break;case 10:t=[[-21,7,4,122],[-5,8,0,252],[-4,7,0,123],[-3,5,0,24],[-2,2,2,0],[2,5,0,25],[3,6,0,54],[4,7,0,124],[5,8,0,253],[6,2,6,1],[70,5,5,26],[102,6,5,55],[134,6,6,56],[198,6,7,57],[326,6,8,58],[582,6,9,59],[1094,6,10,60],[2118,7,11,125],[-22,8,32,254,"lower"],[4166,8,32,255],[2,2]];break;case 11:t=[[1,1,0,0],[2,2,1,2],[4,4,0,12],[5,4,1,13],[7,5,1,28],[9,5,2,29],[13,6,2,60],[17,7,2,122],[21,7,3,123],[29,7,4,124],[45,7,5,125],[77,7,6,126],[141,7,32,127]];break;case 12:t=[[1,1,0,0],[2,2,0,2],[3,3,1,6],[5,5,0,28],[6,5,1,29],[8,6,1,60],[10,7,0,122],[11,7,1,123],[13,7,2,124],[17,7,3,125],[25,7,4,126],[41,8,5,254],[73,8,32,255]];break;case 13:t=[[1,1,0,0],[2,3,0,4],[3,4,0,12],[4,5,0,28],[5,4,1,13],[7,3,3,5],[15,6,1,58],[17,6,2,59],[21,6,3,60],[29,6,4,61],[45,6,5,62],[77,7,6,126],[141,7,32,127]];break;case 14:t=[[-2,3,0,4],[-1,3,0,5],[0,1,0,0],[1,3,0,6],[2,3,0,7]];break;case 15:t=[[-24,7,4,124],[-8,6,2,60],[-4,5,1,28],[-2,4,0,12],[-1,3,0,4],[0,1,0,0],[1,3,0,5],[2,4,0,13],[3,5,1,29],[5,6,2,61],[9,7,4,125],[-25,7,32,126,"lower"],[25,7,32,127]];break;default:throw new Fi(`standard table B.${n} does not exist`)}for(let i=0,s=t.length;i<s;i++)t[i]=new Rh(t[i]);return e=new M3(t,!0),ok[n]=e,e}class Hp{constructor(e,t,i){this.data=e,this.start=t,this.end=i,this.position=t,this.shift=-1,this.currentByte=0}readBit(){if(this.shift<0){if(this.position>=this.end)throw new Fi("end of data while reading bit");this.currentByte=this.data[this.position++],this.shift=7}const e=this.currentByte>>this.shift&1;return this.shift--,e}readBits(e){let t=0,i;for(i=e-1;i>=0;i--)t|=this.readBit()<<i;return t}byteAlign(){this.shift=-1}next(){return this.position>=this.end?-1:this.data[this.position++]}}function wu(n,e,t){let i=0;for(let s=0,r=e.length;s<r;s++){const a=t[e[s]];if(a){if(n===i)return a;i++}}throw new Fi("can't find custom Huffman table")}function GH(n,e,t,i,s){const r=[];for(let d=0;d<=34;d++){const f=s.readBits(4);r.push(new Rh([d,f,0,0]))}const a=new M3(r,!1);r.length=0;for(let d=0;d<i;){const f=a.decode(s);if(f>=32){let g,m,x;switch(f){case 32:if(d===0)throw new Fi("no previous value in symbol ID table");m=s.readBits(2)+3,g=r[d-1].prefixLength;break;case 33:m=s.readBits(3)+3,g=0;break;case 34:m=s.readBits(7)+11,g=0;break;default:throw new Fi("invalid code length in symbol ID table")}for(x=0;x<m;x++)r.push(new Rh([d,g,0,0])),d++}else r.push(new Rh([d,f,0,0])),d++}s.byteAlign();const o=new M3(r,!1);let l=0,c,h,u;switch(n.huffmanFS){case 0:case 1:c=Mh(n.huffmanFS+6);break;case 3:c=wu(l,e,t),l++;break;default:throw new Fi("invalid Huffman FS selector")}switch(n.huffmanDS){case 0:case 1:case 2:h=Mh(n.huffmanDS+8);break;case 3:h=wu(l,e,t),l++;break;default:throw new Fi("invalid Huffman DS selector")}switch(n.huffmanDT){case 0:case 1:case 2:u=Mh(n.huffmanDT+11);break;case 3:u=wu(l,e,t),l++;break;default:throw new Fi("invalid Huffman DT selector")}if(n.refinement)throw new Fi("refinement with Huffman is not supported");return{symbolIDTable:o,tableFirstS:c,tableDeltaS:h,tableDeltaT:u}}function VH(n,e,t){let i=0,s,r;switch(n.huffmanDHSelector){case 0:case 1:s=Mh(n.huffmanDHSelector+4);break;case 3:s=wu(i,e,t),i++;break;default:throw new Fi("invalid Huffman DH selector")}switch(n.huffmanDWSelector){case 0:case 1:r=Mh(n.huffmanDWSelector+2);break;case 3:r=wu(i,e,t),i++;break;default:throw new Fi("invalid Huffman DW selector")}let a,o;return n.bitmapSizeSelector?(a=wu(i,e,t),i++):a=Mh(1),n.aggregationInstancesSelector?o=wu(i,e,t):o=Mh(1),{tableDeltaHeight:s,tableDeltaWidth:r,tableBitmapSize:a,tableAggregateInstances:o}}function qH(n,e,t){const i=[];for(let s=0;s<t;s++){const r=new Uint8Array(e);i.push(r);for(let a=0;a<e;a++)r[a]=n.readBit();n.byteAlign()}return i}function v4(n,e,t,i){const s={K:-1,Columns:e,Rows:t,BlackIs1:!0,EndOfBlock:i},r=new TR(n,s),a=[];let o,l=!1;for(let c=0;c<t;c++){const h=new Uint8Array(e);a.push(h);let u=-1;for(let d=0;d<e;d++)u<0&&(o=r.readNextChar(),o===-1&&(o=0,l=!0),u=7),h[d]=o>>u&1,u--}if(i&&!l)for(let h=0;h<5&&r.readNextChar()!==-1;h++);return a}class WH{parseChunks(e){return HH(e)}parse(e){throw new Error("Not implemented: Jbig2Image.parse")}}class KH extends Zr{constructor(e,t,i){super(t),this.stream=e,this.dict=e.dict,this.maybeLength=t,this.params=i}get bytes(){return Ze(this,"bytes",this.stream.getBytes(this.maybeLength))}ensureBuffer(e){}readBlock(){this.decodeImage()}decodeImage(e){if(this.eof)return this.buffer;e||(e=this.bytes);const t=new WH,i=[];if(this.params instanceof fe){const a=this.params.get("JBIG2Globals");if(a instanceof un){const o=a.getBytes();i.push({data:o,start:0,end:o.length})}}i.push({data:e,start:0,end:e.length});const s=t.parseChunks(i),r=s.length;for(let a=0;a<r;a++)s[a]^=255;return this.buffer=s,this.bufferLength=r,this.eof=!0,this.buffer}get canAsyncDecodeImageFromBuffer(){return this.stream.isAsync}}class XH extends Zr{constructor(e,t,i){super(t),this.stream=e,this.dict=e.dict,this.maybeLength=t,this.params=i}get bytes(){return Ze(this,"bytes",this.stream.getBytes(this.maybeLength))}ensureBuffer(e){}readBlock(e){kn("JpxStream.readBlock")}get isAsyncDecoder(){return!0}async decodeImage(e,t){return this.eof?this.buffer:(e||(e=this.bytes),this.buffer=await Go.decode(e,t),this.bufferLength=this.buffer.length,this.eof=!0,this.buffer)}get canAsyncDecodeImageFromBuffer(){return this.stream.isAsync}}class lk extends Zr{constructor(e,t,i){super(t),this.str=e,this.dict=e.dict,this.cachedData=0,this.bitsCached=0;const s=4096,r={earlyChange:i,codeLength:9,nextCode:258,dictionaryValues:new Uint8Array(s),dictionaryLengths:new Uint16Array(s),dictionaryPrevCodes:new Uint16Array(s),currentSequence:new Uint8Array(s),currentSequenceLength:0};for(let a=0;a<256;++a)r.dictionaryValues[a]=a,r.dictionaryLengths[a]=1;this.lzwState=r}readBits(e){let t=this.bitsCached,i=this.cachedData;for(;t<e;){const s=this.str.getByte();if(s===-1)return this.eof=!0,null;i=i<<8|s,t+=8}return this.bitsCached=t-=e,this.cachedData=i,this.lastCode=null,i>>>t&(1<<e)-1}readBlock(){let i=1024,s,r,a;const o=this.lzwState;if(!o)return;const l=o.earlyChange;let c=o.nextCode;const h=o.dictionaryValues,u=o.dictionaryLengths,d=o.dictionaryPrevCodes;let f=o.codeLength,g=o.prevCode;const m=o.currentSequence;let x=o.currentSequenceLength,p=0,y=this.bufferLength,w=this.ensureBuffer(this.bufferLength+i);for(s=0;s<512;s++){const _=this.readBits(f),v=x>0;if(_<256)m[0]=_,x=1;else if(_>=258)if(_<c)for(x=u[_],r=x-1,a=_;r>=0;r--)m[r]=h[a],a=d[a];else m[x++]=m[0];else if(_===256){f=9,c=258,x=0;continue}else{this.eof=!0,delete this.lzwState;break}if(v&&(d[c]=g,u[c]=u[g]+1,h[c]=m[0],c++,f=c+l&c+l-1?f:Math.min(Math.log(c+l)/.6931471805599453+1,12)|0),g=_,p+=x,i<p){do i+=512;while(i<p);w=this.ensureBuffer(this.bufferLength+i)}for(r=0;r<x;r++)w[y++]=m[r]}o.nextCode=c,o.codeLength=f,o.prevCode=g,o.currentSequenceLength=x,this.bufferLength=y}}class ck extends Zr{constructor(e,t,i){if(super(t),!(i instanceof fe))return e;const s=this.predictor=i.get("Predictor")||1;if(s<=1)return e;if(s!==2&&(s<10||s>15))throw new Te(`Unsupported predictor: ${s}`);this.readBlock=s===2?this.readBlockTiff:this.readBlockPng,this.str=e,this.dict=e.dict;const r=this.colors=i.get("Colors")||1,a=this.bits=i.get("BPC","BitsPerComponent")||8,o=this.columns=i.get("Columns")||1;return this.pixBytes=r*a+7>>3,this.rowBytes=o*r*a+7>>3,this}readBlockTiff(){const e=this.rowBytes,t=this.bufferLength,i=this.ensureBuffer(t+e),s=this.bits,r=this.colors,a=this.str.getBytes(e);if(this.eof=!a.length,this.eof)return;let o=0,l=0,c=0,h=0,u=t,d;if(s===1&&r===1)for(d=0;d<e;++d){let f=a[d]^o;f^=f>>1,f^=f>>2,f^=f>>4,o=(f&1)<<7,i[u++]=f}else if(s===8){for(d=0;d<r;++d)i[u++]=a[d];for(;d<e;++d)i[u]=i[u-r]+a[d],u++}else if(s===16){const f=r*2;for(d=0;d<f;++d)i[u++]=a[d];for(;d<e;d+=2){const g=((a[d]&255)<<8)+(a[d+1]&255)+((i[u-f]&255)<<8)+(i[u-f+1]&255);i[u++]=g>>8&255,i[u++]=g&255}}else{const f=new Uint8Array(r+1),g=(1<<s)-1;let m=0,x=t;const p=this.columns;for(d=0;d<p;++d)for(let y=0;y<r;++y)c<s&&(o=o<<8|a[m++]&255,c+=8),f[y]=f[y]+(o>>c-s)&g,c-=s,l=l<<s|f[y],h+=s,h>=8&&(i[x++]=l>>h-8&255,h-=8);h>0&&(i[x++]=(l<<8-h)+(o&(1<<8-h)-1))}this.bufferLength+=e}readBlockPng(){const e=this.rowBytes,t=this.pixBytes,i=this.str.getByte(),s=this.str.getBytes(e);if(this.eof=!s.length,this.eof)return;const r=this.bufferLength,a=this.ensureBuffer(r+e);let o=a.subarray(r-e,r);o.length===0&&(o=new Uint8Array(e));let l,c=r,h,u;switch(i){case 0:for(l=0;l<e;++l)a[c++]=s[l];break;case 1:for(l=0;l<t;++l)a[c++]=s[l];for(;l<e;++l)a[c]=a[c-t]+s[l]&255,c++;break;case 2:for(l=0;l<e;++l)a[c++]=o[l]+s[l]&255;break;case 3:for(l=0;l<t;++l)a[c++]=(o[l]>>1)+s[l];for(;l<e;++l)a[c]=(o[l]+a[c-t]>>1)+s[l]&255,c++;break;case 4:for(l=0;l<t;++l)h=o[l],u=s[l],a[c++]=h+u;for(;l<e;++l){h=o[l];const d=o[l-t],f=a[c-t],g=f+h-d;let m=g-f;m<0&&(m=-m);let x=g-h;x<0&&(x=-x);let p=g-d;p<0&&(p=-p),u=s[l],m<=x&&m<=p?a[c++]=f+u:x<=p?a[c++]=h+u:a[c++]=d+u}break;default:throw new Te(`Unsupported predictor: ${i}`)}this.bufferLength+=e}}class YH extends Zr{constructor(e,t){super(t),this.str=e,this.dict=e.dict}readBlock(){const e=this.str.getBytes(2);if(!e||e.length<2||e[0]===128){this.eof=!0;return}let t,i=this.bufferLength,s=e[0];if(s<128){if(t=this.ensureBuffer(i+s+1),t[i++]=e[1],s>0){const r=this.str.getBytes(s);t.set(r,i),i+=s}}else s=257-s,t=this.ensureBuffer(i+s+1),t.fill(e[1],i,i+s),i+=s;this.bufferLength=i}}const JH=1e3;function ZH(n){const e=[],t=n.length;let i=0;for(;i<t-1;)e.push(n[i++]<<8|n[i++]);return i<t&&e.push(n[i]),t+"_"+String.fromCharCode.apply(null,e)}var U5,NR;class R0{constructor({lexer:e,xref:t,allowStreams:i=!1,recoveryMode:s=!1}){B(this,U5);this.lexer=e,this.xref=t,this.allowStreams=i,this.recoveryMode=s,this.imageCache=Object.create(null),this._imageId=0,this.refill()}refill(){this.buf1=this.lexer.getObj(),this.buf2=this.lexer.getObj()}shift(){this.buf2 instanceof ss&&this.buf2.cmd==="ID"?(this.buf1=this.buf2,this.buf2=null):(this.buf1=this.buf2,this.buf2=this.lexer.getObj())}tryShift(){try{return this.shift(),!0}catch(e){if(e instanceof xi)throw e;return!1}}getObj(e=null){const t=this.buf1;if(this.shift(),t instanceof ss)switch(t.cmd){case"BI":return this.makeInlineImage(e);case"[":const i=[];for(;!Ss(this.buf1,"]")&&this.buf1!==Bs;)i.push(this.getObj(e));if(this.buf1===Bs){if(this.recoveryMode)return i;throw new I7("End of file inside array.")}return this.shift(),i;case"<<":const s=new fe(this.xref);for(;!Ss(this.buf1,">>")&&this.buf1!==Bs;){if(!(this.buf1 instanceof ve)){gn("Malformed dictionary: key must be a name object"),this.shift();continue}const r=this.buf1.name;if(this.shift(),this.buf1===Bs)break;s.set(r,this.getObj(e))}if(this.buf1===Bs){if(this.recoveryMode)return s;throw new I7("End of file inside dictionary.")}return Ss(this.buf2,"stream")?this.allowStreams?this.makeStream(s,e):s:(this.shift(),s);default:return t}if(Number.isInteger(t)){if(Number.isInteger(this.buf1)&&Ss(this.buf2,"R")){const i=st.get(t,this.buf1);return this.shift(),this.shift(),i}return t}return typeof t=="string"&&e?e.decryptString(t):t}findDefaultInlineStreamEnd(e){const{knownCommands:l}=this.lexer,c=e.pos,h=15;let u=0,d,f;for(;(d=e.getByte())!==-1;)if(u===0)u=d===69?1:0;else if(u===1)u=d===73?2:0;else if(d===32||d===10||d===13){f=e.pos;const m=e.peekBytes(h),x=m.length;if(x===0)break;for(let w=0;w<x;w++)if(d=m[w],!(d===0&&m[w+1]!==0)&&d!==10&&d!==13&&(d<32||d>127)){u=0;break}if(u!==2)continue;if(!l){ce("findDefaultInlineStreamEnd - `lexer.knownCommands` is undefined.");continue}const p=new Wo(new Hi(e.peekBytes(5*h)),l);p._hexStringWarn=()=>{};let y=0;for(;;){const w=p.getObj();if(w===Bs){u=0;break}if(w instanceof ss){const _=l[w.cmd];if(_){if(_.variableArgs?y<=_.numArgs:y===_.numArgs)break}else{u=0;break}y=0;continue}y++}if(u===2)break}else u=0;d===-1&&(ce("findDefaultInlineStreamEnd: Reached the end of the stream without finding a valid EI marker"),f&&(ce('... trying to recover by using the last "EI" occurrence.'),e.skip(-(e.pos-f))));let g=4;return e.skip(-g),d=e.peekByte(),e.skip(g),qa(d)||g--,e.pos-g-c}findDCTDecodeInlineStreamEnd(e){const t=e.pos;let i=!1,s,r;for(;(s=e.getByte())!==-1;)if(s===255){switch(e.getByte()){case 0:break;case 255:e.skip(-1);break;case 217:i=!0;break;case 192:case 193:case 194:case 195:case 197:case 198:case 199:case 201:case 202:case 203:case 205:case 206:case 207:case 196:case 204:case 218:case 219:case 220:case 221:case 222:case 223:case 224:case 225:case 226:case 227:case 228:case 229:case 230:case 231:case 232:case 233:case 234:case 235:case 236:case 237:case 238:case 239:case 254:r=e.getUint16(),r>2?e.skip(r-2):e.skip(-2);break}if(i)break}const a=e.pos-t;return s===-1?(ce("Inline DCTDecode image stream: EOI marker not found, searching for /EI/ instead."),e.skip(-a),this.findDefaultInlineStreamEnd(e)):(this.inlineStreamSkipEI(e),a)}findASCII85DecodeInlineStreamEnd(e){const s=e.pos;let r;for(;(r=e.getByte())!==-1;)if(r===126){const o=e.pos;for(r=e.peekByte();qa(r);)e.skip(),r=e.peekByte();if(r===62){e.skip();break}if(e.pos>o){const l=e.peekBytes(2);if(l[0]===69&&l[1]===73)break}}const a=e.pos-s;return r===-1?(ce("Inline ASCII85Decode image stream: EOD marker not found, searching for /EI/ instead."),e.skip(-a),this.findDefaultInlineStreamEnd(e)):(this.inlineStreamSkipEI(e),a)}findASCIIHexDecodeInlineStreamEnd(e){const i=e.pos;let s;for(;(s=e.getByte())!==-1&&s!==62;);const r=e.pos-i;return s===-1?(ce("Inline ASCIIHexDecode image stream: EOD marker not found, searching for /EI/ instead."),e.skip(-r),this.findDefaultInlineStreamEnd(e)):(this.inlineStreamSkipEI(e),r)}inlineStreamSkipEI(e){let s=0,r;for(;(r=e.getByte())!==-1;)if(s===0)s=r===69?1:0;else if(s===1)s=r===73?2:0;else if(s===2)break}makeInlineImage(e){const t=this.lexer,i=t.stream,s=Object.create(null);let r;for(;!Ss(this.buf1,"ID")&&this.buf1!==Bs;){if(!(this.buf1 instanceof ve))throw new Te("Dictionary key must be a name object");const f=this.buf1.name;if(this.shift(),this.buf1===Bs)break;s[f]=this.getObj(e)}t.beginInlineImagePos!==-1&&(r=i.pos-t.beginInlineImagePos);const a=this.xref.fetchIfRef(s.F||s.Filter);let o;if(a instanceof ve)o=a.name;else if(Array.isArray(a)){const f=this.xref.fetchIfRef(a[0]);f instanceof ve&&(o=f.name)}const l=i.pos;let c;switch(o){case"DCT":case"DCTDecode":c=this.findDCTDecodeInlineStreamEnd(i);break;case"A85":case"ASCII85Decode":c=this.findASCII85DecodeInlineStreamEnd(i);break;case"AHx":case"ASCIIHexDecode":c=this.findASCIIHexDecodeInlineStreamEnd(i);break;default:c=this.findDefaultInlineStreamEnd(i)}let h;if(c<JH&&r>0){const f=i.pos;i.pos=t.beginInlineImagePos,h=ZH(i.getBytes(r+c)),i.pos=f;const g=this.imageCache[h];if(g!==void 0)return this.buf2=ss.get("EI"),this.shift(),g.reset(),g}const u=new fe(this.xref);for(const f in s)u.set(f,s[f]);let d=i.makeSubStream(l,c,u);return e&&(d=e.createStream(d,c)),d=this.filter(d,u,c),d.dict=u,h!==void 0&&(d.cacheKey=`inline_img_${++this._imageId}`,this.imageCache[h]=d),this.buf2=ss.get("EI"),this.shift(),d}makeStream(e,t){const i=this.lexer;let s=i.stream;i.skipToNextLine();const r=s.pos-1;let a=e.get("Length");if(Number.isInteger(a)||(gn(`Bad length "${a&&a.toString()}" in stream.`),a=0),s.pos=r+a,i.nextChar(),this.tryShift()&&Ss(this.buf2,"endstream"))this.shift();else{if(a=D(this,U5,NR).call(this,r),a<0)throw new Te("Missing endstream command.");i.nextChar(),this.shift(),this.shift()}return this.shift(),s=s.makeSubStream(r,a,e),t&&(s=t.createStream(s,a)),s=this.filter(s,e,a),s.dict=e,s}filter(e,t,i){let s=t.get("F","Filter"),r=t.get("DP","DecodeParms");if(s instanceof ve)return Array.isArray(r)&&ce("/DecodeParms should not be an Array, when /Filter is a Name."),this.makeFilter(e,s.name,i,r);let a=i;if(Array.isArray(s)){const o=s,l=r;for(let c=0,h=o.length;c<h;++c){if(s=this.xref.fetchIfRef(o[c]),!(s instanceof ve))throw new Te(`Bad filter name "${s}"`);r=null,Array.isArray(l)&&c in l&&(r=this.xref.fetchIfRef(l[c])),e=this.makeFilter(e,s.name,a,r),a=null}}return e}makeFilter(e,t,i,s){if(i===0)return ce(`Empty "${t}" stream.`),new F7;try{switch(t){case"Fl":case"FlateDecode":return s?new ck(new sk(e,i),i,s):new sk(e,i);case"LZW":case"LZWDecode":let r=1;return s?(s.has("EarlyChange")&&(r=s.get("EarlyChange")),new ck(new lk(e,i,r),i,s)):new lk(e,i,r);case"DCT":case"DCTDecode":return new Eg(e,i,s);case"JPX":case"JPXDecode":return new XH(e,i,s);case"A85":case"ASCII85Decode":return new wH(e,i);case"AHx":case"ASCIIHexDecode":return new _H(e,i);case"CCF":case"CCITTFaxDecode":return new vH(e,i,s);case"RL":case"RunLengthDecode":return new YH(e,i);case"JBIG2Decode":return new KH(e,i,s)}return ce(`Filter "${t}" is not supported.`),e}catch(r){if(r instanceof xi)throw r;return ce(`Invalid stream: "${r}"`),new F7}}}U5=new WeakSet,NR=function(e){const{stream:t}=this.lexer;t.pos=e;const i=2048,s=9,r=new Uint8Array([101,110,100]),a=r.length,o=[new Uint8Array([115,116,114,101,97,109]),new Uint8Array([115,116,101,97,109]),new Uint8Array([115,116,114,101,97])],l=s-a;for(;t.pos<t.end;){const c=t.peekBytes(i),h=c.length-s;if(h<=0)break;let u=0;for(;u<h;){let d=0;for(;d<a&&c[u+d]===r[d];)d++;if(d>=a){let f=!1;for(const g of o){const m=g.length;let x=0;for(;x<m&&c[u+d+x]===g[x];)x++;if(x>=l){f=!0;break}if(x>=m){const p=c[u+d+x];qa(p)&&(gn(`Found "${da([...r,...g])}" when searching for endstream command.`),f=!0);break}}if(f)return t.pos+=u,t.pos-e}u++}t.pos+=h}return-1};const gf=[1,0,0,0,0,0,0,0,0,1,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,2,0,0,2,2,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];function bw(n){return n>=48&&n<=57?n&15:n>=65&&n<=70||n>=97&&n<=102?(n&15)+9:-1}class Wo{constructor(e,t=null){this.stream=e,this.nextChar(),this.strBuf=[],this.knownCommands=t,this._hexStringNumWarn=0,this.beginInlineImagePos=-1}nextChar(){return this.currentChar=this.stream.getByte()}peekChar(){return this.stream.peekByte()}getNumber(){let e=this.currentChar,t=!1,i=0,s=1;if(e===45?(s=-1,e=this.nextChar(),e===45&&(e=this.nextChar())):e===43&&(e=this.nextChar()),e===10||e===13)do e=this.nextChar();while(e===10||e===13);if(e===46&&(i=10,e=this.nextChar()),e<48||e>57){const l=`Invalid number: ${String.fromCharCode(e)} (charCode ${e})`;if(qa(e)||e===40||e===60||e===-1)return gn(`Lexer.getNumber - "${l}".`),0;throw new Te(l)}let r=e-48,a=0,o=1;for(;(e=this.nextChar())>=0;)if(e>=48&&e<=57){const l=e-48;t?a=a*10+l:(i!==0&&(i*=10),r=r*10+l)}else if(e===46)if(i===0)i=1;else break;else if(e===45)ce("Badly formatted number: minus sign in the middle");else if(e===69||e===101){if(e=this.peekChar(),e===43||e===45)o=e===45?-1:1,this.nextChar();else if(e<48||e>57)break;t=!0}else break;return i!==0&&(r/=i),t&&(r*=10**(o*a)),s*r}getString(){let e=1,t=!1;const i=this.strBuf;i.length=0;let s=this.nextChar();for(;;){let r=!1;switch(s|0){case-1:ce("Unterminated string"),t=!0;break;case 40:++e,i.push("(");break;case 41:--e===0?(this.nextChar(),t=!0):i.push(")");break;case 92:switch(s=this.nextChar(),s){case-1:ce("Unterminated string"),t=!0;break;case 110:i.push(`
`);break;case 114:i.push("\r");break;case 116:i.push("	");break;case 98:i.push("\b");break;case 102:i.push("\f");break;case 92:case 40:case 41:i.push(String.fromCharCode(s));break;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:let a=s&15;s=this.nextChar(),r=!0,s>=48&&s<=55&&(a=(a<<3)+(s&15),s=this.nextChar(),s>=48&&s<=55&&(r=!1,a=(a<<3)+(s&15))),i.push(String.fromCharCode(a));break;case 13:this.peekChar()===10&&this.nextChar();break;case 10:break;default:i.push(String.fromCharCode(s));break}break;default:i.push(String.fromCharCode(s));break}if(t)break;r||(s=this.nextChar())}return i.join("")}getName(){let e,t;const i=this.strBuf;for(i.length=0;(e=this.nextChar())>=0&&!gf[e];)if(e===35){if(e=this.nextChar(),gf[e]){ce("Lexer_getName: NUMBER SIGN (#) should be followed by a hexadecimal number."),i.push("#");break}const s=bw(e);if(s!==-1){t=e,e=this.nextChar();const r=bw(e);if(r===-1){if(ce(`Lexer_getName: Illegal digit (${String.fromCharCode(e)}) in hexadecimal number.`),i.push("#",String.fromCharCode(t)),gf[e])break;i.push(String.fromCharCode(e));continue}i.push(String.fromCharCode(s<<4|r))}else i.push("#",String.fromCharCode(e))}else i.push(String.fromCharCode(e));return i.length>127&&ce(`Name token is longer than allowed by the spec: ${i.length}`),ve.get(i.join(""))}_hexStringWarn(e){if(this._hexStringNumWarn++===5){ce("getHexString - ignoring additional invalid characters.");return}this._hexStringNumWarn>5||ce(`getHexString - ignoring invalid character: ${e}`)}getHexString(){const e=this.strBuf;e.length=0;let t=this.currentChar,i=-1,s=-1;for(this._hexStringNumWarn=0;;)if(t<0){ce("Unterminated hex string");break}else if(t===62){this.nextChar();break}else if(gf[t]===1){t=this.nextChar();continue}else s=bw(t),s===-1?this._hexStringWarn(t):i===-1?i=s:(e.push(String.fromCharCode(i<<4|s)),i=-1),t=this.nextChar();return i!==-1&&e.push(String.fromCharCode(i<<4)),e.join("")}getObj(){let e=!1,t=this.currentChar;for(;;){if(t<0)return Bs;if(e)(t===10||t===13)&&(e=!1);else if(t===37)e=!0;else if(gf[t]!==1)break;t=this.nextChar()}switch(t|0){case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 43:case 45:case 46:return this.getNumber();case 40:return this.getString();case 47:return this.getName();case 91:return this.nextChar(),ss.get("[");case 93:return this.nextChar(),ss.get("]");case 60:return t=this.nextChar(),t===60?(this.nextChar(),ss.get("<<")):this.getHexString();case 62:return t=this.nextChar(),t===62?(this.nextChar(),ss.get(">>")):ss.get(">");case 123:return this.nextChar(),ss.get("{");case 125:return this.nextChar(),ss.get("}");case 41:throw this.nextChar(),new Te(`Illegal character: ${t}`)}let i=String.fromCharCode(t);if(t<32||t>127){const a=this.peekChar();if(a>=32&&a<=127)return this.nextChar(),ss.get(i)}const s=this.knownCommands;let r=(s==null?void 0:s[i])!==void 0;for(;(t=this.nextChar())>=0&&!gf[t];){const a=i+String.fromCharCode(t);if(r&&s[a]===void 0)break;if(i.length===128)throw new Te(`Command token too long: ${i.length}`);i=a,r=(s==null?void 0:s[i])!==void 0}return i==="true"?!0:i==="false"?!1:i==="null"?null:(i==="BI"&&(this.beginInlineImagePos=this.stream.pos),ss.get(i))}skipToNextLine(){let e=this.currentChar;for(;e>=0;){if(e===13){e=this.nextChar(),e===10&&this.nextChar();break}else if(e===10){this.nextChar();break}e=this.nextChar()}}}class QH{static create(e){function t(u,d,f=!1){const g=u.get(d);if(Number.isInteger(g)&&(f?g>=0:g>0))return g;throw new Error(`The "${d}" parameter in the linearization dictionary is invalid.`)}function i(u){const d=u.get("H");let f;if(Array.isArray(d)&&((f=d.length)===2||f===4)){for(let g=0;g<f;g++){const m=d[g];if(!(Number.isInteger(m)&&m>0))throw new Error(`Hint (${g}) in the linearization dictionary is invalid.`)}return d}throw new Error("Hint array in the linearization dictionary is invalid.")}const s=new R0({lexer:new Wo(e),xref:null}),r=s.getObj(),a=s.getObj(),o=s.getObj(),l=s.getObj();let c,h;if(Number.isInteger(r)&&Number.isInteger(a)&&Ss(o,"obj")&&l instanceof fe&&typeof(c=l.get("Linearized"))=="number"&&c>0){if((h=t(l,"L"))!==e.length)throw new Error('The "L" parameter in the linearization dictionary does not equal the stream length.')}else return null;return{length:h,hints:i(l),objectNumberFirst:t(l,"O"),endFirst:t(l,"E"),numPages:t(l,"N"),mainXRefEntriesOffset:t(l,"T"),pageFirst:l.has("P")?t(l,"P",!0):0}}}const $H=["Adobe-GB1-UCS2","Adobe-CNS1-UCS2","Adobe-Japan1-UCS2","Adobe-Korea1-UCS2","78-EUC-H","78-EUC-V","78-H","78-RKSJ-H","78-RKSJ-V","78-V","78ms-RKSJ-H","78ms-RKSJ-V","83pv-RKSJ-H","90ms-RKSJ-H","90ms-RKSJ-V","90msp-RKSJ-H","90msp-RKSJ-V","90pv-RKSJ-H","90pv-RKSJ-V","Add-H","Add-RKSJ-H","Add-RKSJ-V","Add-V","Adobe-CNS1-0","Adobe-CNS1-1","Adobe-CNS1-2","Adobe-CNS1-3","Adobe-CNS1-4","Adobe-CNS1-5","Adobe-CNS1-6","Adobe-GB1-0","Adobe-GB1-1","Adobe-GB1-2","Adobe-GB1-3","Adobe-GB1-4","Adobe-GB1-5","Adobe-Japan1-0","Adobe-Japan1-1","Adobe-Japan1-2","Adobe-Japan1-3","Adobe-Japan1-4","Adobe-Japan1-5","Adobe-Japan1-6","Adobe-Korea1-0","Adobe-Korea1-1","Adobe-Korea1-2","B5-H","B5-V","B5pc-H","B5pc-V","CNS-EUC-H","CNS-EUC-V","CNS1-H","CNS1-V","CNS2-H","CNS2-V","ETHK-B5-H","ETHK-B5-V","ETen-B5-H","ETen-B5-V","ETenms-B5-H","ETenms-B5-V","EUC-H","EUC-V","Ext-H","Ext-RKSJ-H","Ext-RKSJ-V","Ext-V","GB-EUC-H","GB-EUC-V","GB-H","GB-V","GBK-EUC-H","GBK-EUC-V","GBK2K-H","GBK2K-V","GBKp-EUC-H","GBKp-EUC-V","GBT-EUC-H","GBT-EUC-V","GBT-H","GBT-V","GBTpc-EUC-H","GBTpc-EUC-V","GBpc-EUC-H","GBpc-EUC-V","H","HKdla-B5-H","HKdla-B5-V","HKdlb-B5-H","HKdlb-B5-V","HKgccs-B5-H","HKgccs-B5-V","HKm314-B5-H","HKm314-B5-V","HKm471-B5-H","HKm471-B5-V","HKscs-B5-H","HKscs-B5-V","Hankaku","Hiragana","KSC-EUC-H","KSC-EUC-V","KSC-H","KSC-Johab-H","KSC-Johab-V","KSC-V","KSCms-UHC-H","KSCms-UHC-HW-H","KSCms-UHC-HW-V","KSCms-UHC-V","KSCpc-EUC-H","KSCpc-EUC-V","Katakana","NWP-H","NWP-V","RKSJ-H","RKSJ-V","Roman","UniCNS-UCS2-H","UniCNS-UCS2-V","UniCNS-UTF16-H","UniCNS-UTF16-V","UniCNS-UTF32-H","UniCNS-UTF32-V","UniCNS-UTF8-H","UniCNS-UTF8-V","UniGB-UCS2-H","UniGB-UCS2-V","UniGB-UTF16-H","UniGB-UTF16-V","UniGB-UTF32-H","UniGB-UTF32-V","UniGB-UTF8-H","UniGB-UTF8-V","UniJIS-UCS2-H","UniJIS-UCS2-HW-H","UniJIS-UCS2-HW-V","UniJIS-UCS2-V","UniJIS-UTF16-H","UniJIS-UTF16-V","UniJIS-UTF32-H","UniJIS-UTF32-V","UniJIS-UTF8-H","UniJIS-UTF8-V","UniJIS2004-UTF16-H","UniJIS2004-UTF16-V","UniJIS2004-UTF32-H","UniJIS2004-UTF32-V","UniJIS2004-UTF8-H","UniJIS2004-UTF8-V","UniJISPro-UCS2-HW-V","UniJISPro-UCS2-V","UniJISPro-UTF8-V","UniJISX0213-UTF32-H","UniJISX0213-UTF32-V","UniJISX02132004-UTF32-H","UniJISX02132004-UTF32-V","UniKS-UCS2-H","UniKS-UCS2-V","UniKS-UTF16-H","UniKS-UTF16-V","UniKS-UTF32-H","UniKS-UTF32-V","UniKS-UTF8-H","UniKS-UTF8-V","V","WP-Symbol"],xw=2**24-1;class k4{constructor(e=!1){this.codespaceRanges=[[],[],[],[]],this.numCodespaceRanges=0,this._map=[],this.name="",this.vertical=!1,this.useCMap=null,this.builtInCMap=e}addCodespaceRange(e,t,i){this.codespaceRanges[e-1].push(t,i),this.numCodespaceRanges++}mapCidRange(e,t,i){if(t-e>xw)throw new Error("mapCidRange - ignoring data above MAX_MAP_RANGE.");for(;e<=t;)this._map[e++]=i++}mapBfRange(e,t,i){if(t-e>xw)throw new Error("mapBfRange - ignoring data above MAX_MAP_RANGE.");const s=i.length-1;for(;e<=t;){this._map[e++]=i;const r=i.charCodeAt(s)+1;if(r>255){i=i.substring(0,s-1)+String.fromCharCode(i.charCodeAt(s-1)+1)+"\0";continue}i=i.substring(0,s)+String.fromCharCode(r)}}mapBfRangeToArray(e,t,i){if(t-e>xw)throw new Error("mapBfRangeToArray - ignoring data above MAX_MAP_RANGE.");const s=i.length;let r=0;for(;e<=t&&r<s;)this._map[e]=i[r++],++e}mapOne(e,t){this._map[e]=t}lookup(e){return this._map[e]}contains(e){return this._map[e]!==void 0}forEach(e){const t=this._map,i=t.length;if(i<=65536)for(let s=0;s<i;s++)t[s]!==void 0&&e(s,t[s]);else for(const s in t)e(s,t[s])}charCodeOf(e){const t=this._map;if(t.length<=65536)return t.indexOf(e);for(const i in t)if(t[i]===e)return i|0;return-1}getMap(){return this._map}readCharCode(e,t,i){let s=0;const r=this.codespaceRanges;for(let a=0,o=r.length;a<o;a++){s=(s<<8|e.charCodeAt(t+a))>>>0;const l=r[a];for(let c=0,h=l.length;c<h;){const u=l[c++],d=l[c++];if(s>=u&&s<=d){i.charcode=s,i.length=a+1;return}}}i.charcode=0,i.length=1}getCharCodeLength(e){const t=this.codespaceRanges;for(let i=0,s=t.length;i<s;i++){const r=t[i];for(let a=0,o=r.length;a<o;){const l=r[a++],c=r[a++];if(e>=l&&e<=c)return i+1}}return 1}get length(){return this._map.length}get isIdentityCMap(){if(!(this.name==="Identity-H"||this.name==="Identity-V")||this._map.length!==65536)return!1;for(let e=0;e<65536;e++)if(this._map[e]!==e)return!1;return!0}}class i1 extends k4{constructor(e,t){super(),this.vertical=e,this.addCodespaceRange(t,0,65535)}mapCidRange(e,t,i){kn("should not call mapCidRange")}mapBfRange(e,t,i){kn("should not call mapBfRange")}mapBfRangeToArray(e,t,i){kn("should not call mapBfRangeToArray")}mapOne(e,t){kn("should not call mapCidOne")}lookup(e){return Number.isInteger(e)&&e<=65535?e:void 0}contains(e){return Number.isInteger(e)&&e<=65535}forEach(e){for(let t=0;t<=65535;t++)e(t,t)}charCodeOf(e){return Number.isInteger(e)&&e<=65535?e:-1}getMap(){const e=new Array(65536);for(let t=0;t<=65535;t++)e[t]=t;return e}get length(){return 65536}get isIdentityCMap(){kn("should not access .isIdentityCMap")}}function Hh(n){let e=0;for(let t=0;t<n.length;t++)e=e<<8|n.charCodeAt(t);return e>>>0}function Yd(n){if(typeof n!="string")throw new Te("Malformed CMap: expected string.")}function OR(n){if(!Number.isInteger(n))throw new Te("Malformed CMap: expected int.")}function ez(n,e){for(;;){let t=e.getObj();if(t===Bs)break;if(Ss(t,"endbfchar"))return;Yd(t);const i=Hh(t);t=e.getObj(),Yd(t);const s=t;n.mapOne(i,s)}}function tz(n,e){for(;;){let t=e.getObj();if(t===Bs)break;if(Ss(t,"endbfrange"))return;Yd(t);const i=Hh(t);t=e.getObj(),Yd(t);const s=Hh(t);if(t=e.getObj(),Number.isInteger(t)||typeof t=="string"){const r=Number.isInteger(t)?String.fromCharCode(t):t;n.mapBfRange(i,s,r)}else if(Ss(t,"[")){t=e.getObj();const r=[];for(;!Ss(t,"]")&&t!==Bs;)r.push(t),t=e.getObj();n.mapBfRangeToArray(i,s,r)}else break}throw new Te("Invalid bf range.")}function nz(n,e){for(;;){let t=e.getObj();if(t===Bs)break;if(Ss(t,"endcidchar"))return;Yd(t);const i=Hh(t);t=e.getObj(),OR(t);const s=t;n.mapOne(i,s)}}function iz(n,e){for(;;){let t=e.getObj();if(t===Bs)break;if(Ss(t,"endcidrange"))return;Yd(t);const i=Hh(t);t=e.getObj(),Yd(t);const s=Hh(t);t=e.getObj(),OR(t);const r=t;n.mapCidRange(i,s,r)}}function sz(n,e){for(;;){let t=e.getObj();if(t===Bs)break;if(Ss(t,"endcodespacerange"))return;if(typeof t!="string")break;const i=Hh(t);if(t=e.getObj(),typeof t!="string")break;const s=Hh(t);n.addCodespaceRange(t.length,i,s)}throw new Te("Invalid codespace range.")}function rz(n,e){const t=e.getObj();Number.isInteger(t)&&(n.vertical=!!t)}function az(n,e){const t=e.getObj();t instanceof ve&&(n.name=t.name)}async function DR(n,e,t,i){let s,r;e:for(;;)try{const a=e.getObj();if(a===Bs)break;if(a instanceof ve)a.name==="WMode"?rz(n,e):a.name==="CMapName"&&az(n,e),s=a;else if(a instanceof ss)switch(a.cmd){case"endcmap":break e;case"usecmap":s instanceof ve&&(r=s.name);break;case"begincodespacerange":sz(n,e);break;case"beginbfchar":ez(n,e);break;case"begincidchar":nz(n,e);break;case"beginbfrange":tz(n,e);break;case"begincidrange":iz(n,e);break}}catch(a){if(a instanceof xi)throw a;ce("Invalid cMap data: "+a);continue}return!i&&r&&(i=r),i?FR(n,t,i):n}async function FR(n,e,t){if(n.useCMap=await q7(t,e),n.numCodespaceRanges===0){const i=n.useCMap.codespaceRanges;for(let s=0;s<i.length;s++)n.codespaceRanges[s]=i[s].slice();n.numCodespaceRanges=n.useCMap.numCodespaceRanges}return n.useCMap.forEach(function(i,s){n.contains(i)||n.mapOne(i,s)}),n}async function q7(n,e){if(n==="Identity-H")return new i1(!1,2);if(n==="Identity-V")return new i1(!0,2);if(!$H.includes(n))throw new Error("Unknown CMap name: "+n);if(!e)throw new Error("Built-in CMap parameters are not provided.");const{cMapData:t,isCompressed:i}=await e(n),s=new k4(!0);if(i)return new yH().process(t,s,a=>FR(s,e,a));const r=new Wo(new Hi(t));return DR(s,r,e,null)}class Xx{static async create({encoding:e,fetchBuiltInCMap:t,useCMap:i}){if(e instanceof ve)return q7(e.name,t);if(e instanceof un){const s=await DR(new k4,new Wo(e),t,i);return s.isIdentityCMap?q7(s.name,t):s}throw new Error("Encoding required.")}}const LR=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","","asuperior","bsuperior","centsuperior","dsuperior","esuperior","","","","isuperior","","","lsuperior","msuperior","nsuperior","osuperior","","","rsuperior","ssuperior","tsuperior","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdownsmall","centoldstyle","Lslashsmall","","","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","","Dotaccentsmall","","","Macronsmall","","","figuredash","hypheninferior","","","Ogoneksmall","Ringsmall","Cedillasmall","","","","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"],oz=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","centoldstyle","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","","threequartersemdash","","questionsmall","","","","","Ethsmall","","","onequarter","onehalf","threequarters","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","","","","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hypheninferior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","asuperior","centsuperior","","","","","Aacutesmall","Agravesmall","Acircumflexsmall","Adieresissmall","Atildesmall","Aringsmall","Ccedillasmall","Eacutesmall","Egravesmall","Ecircumflexsmall","Edieresissmall","Iacutesmall","Igravesmall","Icircumflexsmall","Idieresissmall","Ntildesmall","Oacutesmall","Ogravesmall","Ocircumflexsmall","Odieresissmall","Otildesmall","Uacutesmall","Ugravesmall","Ucircumflexsmall","Udieresissmall","","eightsuperior","fourinferior","threeinferior","sixinferior","eightinferior","seveninferior","Scaronsmall","","centinferior","twoinferior","","Dieresissmall","","Caronsmall","osuperior","fiveinferior","","commainferior","periodinferior","Yacutesmall","","dollarinferior","","","Thornsmall","","nineinferior","zeroinferior","Zcaronsmall","AEsmall","Oslashsmall","questiondownsmall","oneinferior","Lslashsmall","","","","","","","Cedillasmall","","","","","","OEsmall","figuredash","hyphensuperior","","","","","exclamdownsmall","","Ydieresissmall","","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","ninesuperior","zerosuperior","","esuperior","rsuperior","tsuperior","","","isuperior","ssuperior","dsuperior","","","","","","lsuperior","Ogoneksmall","Brevesmall","Macronsmall","bsuperior","nsuperior","msuperior","commasuperior","periodsuperior","Dotaccentsmall","Ringsmall","","","",""],C4=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","space","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron"],o0=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","","endash","dagger","daggerdbl","periodcentered","","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","","questiondown","","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","","ring","cedilla","","hungarumlaut","ogonek","caron","emdash","","","","","","","","","","","","","","","","","AE","","ordfeminine","","","","","Lslash","Oslash","OE","ordmasculine","","","","","","ae","","","","dotlessi","","","lslash","oslash","oe","germandbls","","","",""],zp=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","bullet","Euro","bullet","quotesinglbase","florin","quotedblbase","ellipsis","dagger","daggerdbl","circumflex","perthousand","Scaron","guilsinglleft","OE","bullet","Zcaron","bullet","bullet","quoteleft","quoteright","quotedblleft","quotedblright","bullet","endash","emdash","tilde","trademark","scaron","guilsinglright","oe","bullet","zcaron","Ydieresis","space","exclamdown","cent","sterling","currency","yen","brokenbar","section","dieresis","copyright","ordfeminine","guillemotleft","logicalnot","hyphen","registered","macron","degree","plusminus","twosuperior","threesuperior","acute","mu","paragraph","periodcentered","cedilla","onesuperior","ordmasculine","guillemotright","onequarter","onehalf","threequarters","questiondown","Agrave","Aacute","Acircumflex","Atilde","Adieresis","Aring","AE","Ccedilla","Egrave","Eacute","Ecircumflex","Edieresis","Igrave","Iacute","Icircumflex","Idieresis","Eth","Ntilde","Ograve","Oacute","Ocircumflex","Otilde","Odieresis","multiply","Oslash","Ugrave","Uacute","Ucircumflex","Udieresis","Yacute","Thorn","germandbls","agrave","aacute","acircumflex","atilde","adieresis","aring","ae","ccedilla","egrave","eacute","ecircumflex","edieresis","igrave","iacute","icircumflex","idieresis","eth","ntilde","ograve","oacute","ocircumflex","otilde","odieresis","divide","oslash","ugrave","uacute","ucircumflex","udieresis","yacute","thorn","ydieresis"],A4=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","universal","numbersign","existential","percent","ampersand","suchthat","parenleft","parenright","asteriskmath","plus","comma","minus","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","congruent","Alpha","Beta","Chi","Delta","Epsilon","Phi","Gamma","Eta","Iota","theta1","Kappa","Lambda","Mu","Nu","Omicron","Pi","Theta","Rho","Sigma","Tau","Upsilon","sigma1","Omega","Xi","Psi","Zeta","bracketleft","therefore","bracketright","perpendicular","underscore","radicalex","alpha","beta","chi","delta","epsilon","phi","gamma","eta","iota","phi1","kappa","lambda","mu","nu","omicron","pi","theta","rho","sigma","tau","upsilon","omega1","omega","xi","psi","zeta","braceleft","bar","braceright","similar","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","Euro","Upsilon1","minute","lessequal","fraction","infinity","florin","club","diamond","heart","spade","arrowboth","arrowleft","arrowup","arrowright","arrowdown","degree","plusminus","second","greaterequal","multiply","proportional","partialdiff","bullet","divide","notequal","equivalence","approxequal","ellipsis","arrowvertex","arrowhorizex","carriagereturn","aleph","Ifraktur","Rfraktur","weierstrass","circlemultiply","circleplus","emptyset","intersection","union","propersuperset","reflexsuperset","notsubset","propersubset","reflexsubset","element","notelement","angle","gradient","registerserif","copyrightserif","trademarkserif","product","radical","dotmath","logicalnot","logicaland","logicalor","arrowdblboth","arrowdblleft","arrowdblup","arrowdblright","arrowdbldown","lozenge","angleleft","registersans","copyrightsans","trademarksans","summation","parenlefttp","parenleftex","parenleftbt","bracketlefttp","bracketleftex","bracketleftbt","bracelefttp","braceleftmid","braceleftbt","braceex","","angleright","integral","integraltp","integralex","integralbt","parenrighttp","parenrightex","parenrightbt","bracketrighttp","bracketrightex","bracketrightbt","bracerighttp","bracerightmid","bracerightbt",""],S4=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","a1","a2","a202","a3","a4","a5","a119","a118","a117","a11","a12","a13","a14","a15","a16","a105","a17","a18","a19","a20","a21","a22","a23","a24","a25","a26","a27","a28","a6","a7","a8","a9","a10","a29","a30","a31","a32","a33","a34","a35","a36","a37","a38","a39","a40","a41","a42","a43","a44","a45","a46","a47","a48","a49","a50","a51","a52","a53","a54","a55","a56","a57","a58","a59","a60","a61","a62","a63","a64","a65","a66","a67","a68","a69","a70","a71","a72","a73","a74","a203","a75","a204","a76","a77","a78","a79","a81","a82","a83","a84","a97","a98","a99","a100","","a89","a90","a93","a94","a91","a92","a205","a85","a206","a86","a87","a88","a95","a96","","","","","","","","","","","","","","","","","","","","a101","a102","a103","a104","a106","a107","a108","a112","a111","a110","a109","a120","a121","a122","a123","a124","a125","a126","a127","a128","a129","a130","a131","a132","a133","a134","a135","a136","a137","a138","a139","a140","a141","a142","a143","a144","a145","a146","a147","a148","a149","a150","a151","a152","a153","a154","a155","a156","a157","a158","a159","a160","a161","a163","a164","a196","a165","a192","a166","a167","a168","a169","a170","a171","a172","a173","a162","a174","a175","a176","a177","a178","a179","a193","a180","a199","a181","a200","a182","","a201","a183","a184","a197","a185","a194","a198","a186","a195","a187","a188","a189","a190","a191",""];function jp(n){switch(n){case"WinAnsiEncoding":return zp;case"StandardEncoding":return o0;case"MacRomanEncoding":return C4;case"SymbolSetEncoding":return A4;case"ZapfDingbatsEncoding":return S4;case"ExpertEncoding":return LR;case"MacExpertEncoding":return oz;default:return null}}const Kl=Si(function(n){n.A=65,n.AE=198,n.AEacute=508,n.AEmacron=482,n.AEsmall=63462,n.Aacute=193,n.Aacutesmall=63457,n.Abreve=258,n.Abreveacute=7854,n.Abrevecyrillic=1232,n.Abrevedotbelow=7862,n.Abrevegrave=7856,n.Abrevehookabove=7858,n.Abrevetilde=7860,n.Acaron=461,n.Acircle=9398,n.Acircumflex=194,n.Acircumflexacute=7844,n.Acircumflexdotbelow=7852,n.Acircumflexgrave=7846,n.Acircumflexhookabove=7848,n.Acircumflexsmall=63458,n.Acircumflextilde=7850,n.Acute=63177,n.Acutesmall=63412,n.Acyrillic=1040,n.Adblgrave=512,n.Adieresis=196,n.Adieresiscyrillic=1234,n.Adieresismacron=478,n.Adieresissmall=63460,n.Adotbelow=7840,n.Adotmacron=480,n.Agrave=192,n.Agravesmall=63456,n.Ahookabove=7842,n.Aiecyrillic=1236,n.Ainvertedbreve=514,n.Alpha=913,n.Alphatonos=902,n.Amacron=256,n.Amonospace=65313,n.Aogonek=260,n.Aring=197,n.Aringacute=506,n.Aringbelow=7680,n.Aringsmall=63461,n.Asmall=63329,n.Atilde=195,n.Atildesmall=63459,n.Aybarmenian=1329,n.B=66,n.Bcircle=9399,n.Bdotaccent=7682,n.Bdotbelow=7684,n.Becyrillic=1041,n.Benarmenian=1330,n.Beta=914,n.Bhook=385,n.Blinebelow=7686,n.Bmonospace=65314,n.Brevesmall=63220,n.Bsmall=63330,n.Btopbar=386,n.C=67,n.Caarmenian=1342,n.Cacute=262,n.Caron=63178,n.Caronsmall=63221,n.Ccaron=268,n.Ccedilla=199,n.Ccedillaacute=7688,n.Ccedillasmall=63463,n.Ccircle=9400,n.Ccircumflex=264,n.Cdot=266,n.Cdotaccent=266,n.Cedillasmall=63416,n.Chaarmenian=1353,n.Cheabkhasiancyrillic=1212,n.Checyrillic=1063,n.Chedescenderabkhasiancyrillic=1214,n.Chedescendercyrillic=1206,n.Chedieresiscyrillic=1268,n.Cheharmenian=1347,n.Chekhakassiancyrillic=1227,n.Cheverticalstrokecyrillic=1208,n.Chi=935,n.Chook=391,n.Circumflexsmall=63222,n.Cmonospace=65315,n.Coarmenian=1361,n.Csmall=63331,n.D=68,n.DZ=497,n.DZcaron=452,n.Daarmenian=1332,n.Dafrican=393,n.Dcaron=270,n.Dcedilla=7696,n.Dcircle=9401,n.Dcircumflexbelow=7698,n.Dcroat=272,n.Ddotaccent=7690,n.Ddotbelow=7692,n.Decyrillic=1044,n.Deicoptic=1006,n.Delta=8710,n.Deltagreek=916,n.Dhook=394,n.Dieresis=63179,n.DieresisAcute=63180,n.DieresisGrave=63181,n.Dieresissmall=63400,n.Digammagreek=988,n.Djecyrillic=1026,n.Dlinebelow=7694,n.Dmonospace=65316,n.Dotaccentsmall=63223,n.Dslash=272,n.Dsmall=63332,n.Dtopbar=395,n.Dz=498,n.Dzcaron=453,n.Dzeabkhasiancyrillic=1248,n.Dzecyrillic=1029,n.Dzhecyrillic=1039,n.E=69,n.Eacute=201,n.Eacutesmall=63465,n.Ebreve=276,n.Ecaron=282,n.Ecedillabreve=7708,n.Echarmenian=1333,n.Ecircle=9402,n.Ecircumflex=202,n.Ecircumflexacute=7870,n.Ecircumflexbelow=7704,n.Ecircumflexdotbelow=7878,n.Ecircumflexgrave=7872,n.Ecircumflexhookabove=7874,n.Ecircumflexsmall=63466,n.Ecircumflextilde=7876,n.Ecyrillic=1028,n.Edblgrave=516,n.Edieresis=203,n.Edieresissmall=63467,n.Edot=278,n.Edotaccent=278,n.Edotbelow=7864,n.Efcyrillic=1060,n.Egrave=200,n.Egravesmall=63464,n.Eharmenian=1335,n.Ehookabove=7866,n.Eightroman=8551,n.Einvertedbreve=518,n.Eiotifiedcyrillic=1124,n.Elcyrillic=1051,n.Elevenroman=8554,n.Emacron=274,n.Emacronacute=7702,n.Emacrongrave=7700,n.Emcyrillic=1052,n.Emonospace=65317,n.Encyrillic=1053,n.Endescendercyrillic=1186,n.Eng=330,n.Enghecyrillic=1188,n.Enhookcyrillic=1223,n.Eogonek=280,n.Eopen=400,n.Epsilon=917,n.Epsilontonos=904,n.Ercyrillic=1056,n.Ereversed=398,n.Ereversedcyrillic=1069,n.Escyrillic=1057,n.Esdescendercyrillic=1194,n.Esh=425,n.Esmall=63333,n.Eta=919,n.Etarmenian=1336,n.Etatonos=905,n.Eth=208,n.Ethsmall=63472,n.Etilde=7868,n.Etildebelow=7706,n.Euro=8364,n.Ezh=439,n.Ezhcaron=494,n.Ezhreversed=440,n.F=70,n.Fcircle=9403,n.Fdotaccent=7710,n.Feharmenian=1366,n.Feicoptic=996,n.Fhook=401,n.Fitacyrillic=1138,n.Fiveroman=8548,n.Fmonospace=65318,n.Fourroman=8547,n.Fsmall=63334,n.G=71,n.GBsquare=13191,n.Gacute=500,n.Gamma=915,n.Gammaafrican=404,n.Gangiacoptic=1002,n.Gbreve=286,n.Gcaron=486,n.Gcedilla=290,n.Gcircle=9404,n.Gcircumflex=284,n.Gcommaaccent=290,n.Gdot=288,n.Gdotaccent=288,n.Gecyrillic=1043,n.Ghadarmenian=1346,n.Ghemiddlehookcyrillic=1172,n.Ghestrokecyrillic=1170,n.Gheupturncyrillic=1168,n.Ghook=403,n.Gimarmenian=1331,n.Gjecyrillic=1027,n.Gmacron=7712,n.Gmonospace=65319,n.Grave=63182,n.Gravesmall=63328,n.Gsmall=63335,n.Gsmallhook=667,n.Gstroke=484,n.H=72,n.H18533=9679,n.H18543=9642,n.H18551=9643,n.H22073=9633,n.HPsquare=13259,n.Haabkhasiancyrillic=1192,n.Hadescendercyrillic=1202,n.Hardsigncyrillic=1066,n.Hbar=294,n.Hbrevebelow=7722,n.Hcedilla=7720,n.Hcircle=9405,n.Hcircumflex=292,n.Hdieresis=7718,n.Hdotaccent=7714,n.Hdotbelow=7716,n.Hmonospace=65320,n.Hoarmenian=1344,n.Horicoptic=1e3,n.Hsmall=63336,n.Hungarumlaut=63183,n.Hungarumlautsmall=63224,n.Hzsquare=13200,n.I=73,n.IAcyrillic=1071,n.IJ=306,n.IUcyrillic=1070,n.Iacute=205,n.Iacutesmall=63469,n.Ibreve=300,n.Icaron=463,n.Icircle=9406,n.Icircumflex=206,n.Icircumflexsmall=63470,n.Icyrillic=1030,n.Idblgrave=520,n.Idieresis=207,n.Idieresisacute=7726,n.Idieresiscyrillic=1252,n.Idieresissmall=63471,n.Idot=304,n.Idotaccent=304,n.Idotbelow=7882,n.Iebrevecyrillic=1238,n.Iecyrillic=1045,n.Ifraktur=8465,n.Igrave=204,n.Igravesmall=63468,n.Ihookabove=7880,n.Iicyrillic=1048,n.Iinvertedbreve=522,n.Iishortcyrillic=1049,n.Imacron=298,n.Imacroncyrillic=1250,n.Imonospace=65321,n.Iniarmenian=1339,n.Iocyrillic=1025,n.Iogonek=302,n.Iota=921,n.Iotaafrican=406,n.Iotadieresis=938,n.Iotatonos=906,n.Ismall=63337,n.Istroke=407,n.Itilde=296,n.Itildebelow=7724,n.Izhitsacyrillic=1140,n.Izhitsadblgravecyrillic=1142,n.J=74,n.Jaarmenian=1345,n.Jcircle=9407,n.Jcircumflex=308,n.Jecyrillic=1032,n.Jheharmenian=1355,n.Jmonospace=65322,n.Jsmall=63338,n.K=75,n.KBsquare=13189,n.KKsquare=13261,n.Kabashkircyrillic=1184,n.Kacute=7728,n.Kacyrillic=1050,n.Kadescendercyrillic=1178,n.Kahookcyrillic=1219,n.Kappa=922,n.Kastrokecyrillic=1182,n.Kaverticalstrokecyrillic=1180,n.Kcaron=488,n.Kcedilla=310,n.Kcircle=9408,n.Kcommaaccent=310,n.Kdotbelow=7730,n.Keharmenian=1364,n.Kenarmenian=1343,n.Khacyrillic=1061,n.Kheicoptic=998,n.Khook=408,n.Kjecyrillic=1036,n.Klinebelow=7732,n.Kmonospace=65323,n.Koppacyrillic=1152,n.Koppagreek=990,n.Ksicyrillic=1134,n.Ksmall=63339,n.L=76,n.LJ=455,n.LL=63167,n.Lacute=313,n.Lambda=923,n.Lcaron=317,n.Lcedilla=315,n.Lcircle=9409,n.Lcircumflexbelow=7740,n.Lcommaaccent=315,n.Ldot=319,n.Ldotaccent=319,n.Ldotbelow=7734,n.Ldotbelowmacron=7736,n.Liwnarmenian=1340,n.Lj=456,n.Ljecyrillic=1033,n.Llinebelow=7738,n.Lmonospace=65324,n.Lslash=321,n.Lslashsmall=63225,n.Lsmall=63340,n.M=77,n.MBsquare=13190,n.Macron=63184,n.Macronsmall=63407,n.Macute=7742,n.Mcircle=9410,n.Mdotaccent=7744,n.Mdotbelow=7746,n.Menarmenian=1348,n.Mmonospace=65325,n.Msmall=63341,n.Mturned=412,n.Mu=924,n.N=78,n.NJ=458,n.Nacute=323,n.Ncaron=327,n.Ncedilla=325,n.Ncircle=9411,n.Ncircumflexbelow=7754,n.Ncommaaccent=325,n.Ndotaccent=7748,n.Ndotbelow=7750,n.Nhookleft=413,n.Nineroman=8552,n.Nj=459,n.Njecyrillic=1034,n.Nlinebelow=7752,n.Nmonospace=65326,n.Nowarmenian=1350,n.Nsmall=63342,n.Ntilde=209,n.Ntildesmall=63473,n.Nu=925,n.O=79,n.OE=338,n.OEsmall=63226,n.Oacute=211,n.Oacutesmall=63475,n.Obarredcyrillic=1256,n.Obarreddieresiscyrillic=1258,n.Obreve=334,n.Ocaron=465,n.Ocenteredtilde=415,n.Ocircle=9412,n.Ocircumflex=212,n.Ocircumflexacute=7888,n.Ocircumflexdotbelow=7896,n.Ocircumflexgrave=7890,n.Ocircumflexhookabove=7892,n.Ocircumflexsmall=63476,n.Ocircumflextilde=7894,n.Ocyrillic=1054,n.Odblacute=336,n.Odblgrave=524,n.Odieresis=214,n.Odieresiscyrillic=1254,n.Odieresissmall=63478,n.Odotbelow=7884,n.Ogoneksmall=63227,n.Ograve=210,n.Ogravesmall=63474,n.Oharmenian=1365,n.Ohm=8486,n.Ohookabove=7886,n.Ohorn=416,n.Ohornacute=7898,n.Ohorndotbelow=7906,n.Ohorngrave=7900,n.Ohornhookabove=7902,n.Ohorntilde=7904,n.Ohungarumlaut=336,n.Oi=418,n.Oinvertedbreve=526,n.Omacron=332,n.Omacronacute=7762,n.Omacrongrave=7760,n.Omega=8486,n.Omegacyrillic=1120,n.Omegagreek=937,n.Omegaroundcyrillic=1146,n.Omegatitlocyrillic=1148,n.Omegatonos=911,n.Omicron=927,n.Omicrontonos=908,n.Omonospace=65327,n.Oneroman=8544,n.Oogonek=490,n.Oogonekmacron=492,n.Oopen=390,n.Oslash=216,n.Oslashacute=510,n.Oslashsmall=63480,n.Osmall=63343,n.Ostrokeacute=510,n.Otcyrillic=1150,n.Otilde=213,n.Otildeacute=7756,n.Otildedieresis=7758,n.Otildesmall=63477,n.P=80,n.Pacute=7764,n.Pcircle=9413,n.Pdotaccent=7766,n.Pecyrillic=1055,n.Peharmenian=1354,n.Pemiddlehookcyrillic=1190,n.Phi=934,n.Phook=420,n.Pi=928,n.Piwrarmenian=1363,n.Pmonospace=65328,n.Psi=936,n.Psicyrillic=1136,n.Psmall=63344,n.Q=81,n.Qcircle=9414,n.Qmonospace=65329,n.Qsmall=63345,n.R=82,n.Raarmenian=1356,n.Racute=340,n.Rcaron=344,n.Rcedilla=342,n.Rcircle=9415,n.Rcommaaccent=342,n.Rdblgrave=528,n.Rdotaccent=7768,n.Rdotbelow=7770,n.Rdotbelowmacron=7772,n.Reharmenian=1360,n.Rfraktur=8476,n.Rho=929,n.Ringsmall=63228,n.Rinvertedbreve=530,n.Rlinebelow=7774,n.Rmonospace=65330,n.Rsmall=63346,n.Rsmallinverted=641,n.Rsmallinvertedsuperior=694,n.S=83,n.SF010000=9484,n.SF020000=9492,n.SF030000=9488,n.SF040000=9496,n.SF050000=9532,n.SF060000=9516,n.SF070000=9524,n.SF080000=9500,n.SF090000=9508,n.SF100000=9472,n.SF110000=9474,n.SF190000=9569,n.SF200000=9570,n.SF210000=9558,n.SF220000=9557,n.SF230000=9571,n.SF240000=9553,n.SF250000=9559,n.SF260000=9565,n.SF270000=9564,n.SF280000=9563,n.SF360000=9566,n.SF370000=9567,n.SF380000=9562,n.SF390000=9556,n.SF400000=9577,n.SF410000=9574,n.SF420000=9568,n.SF430000=9552,n.SF440000=9580,n.SF450000=9575,n.SF460000=9576,n.SF470000=9572,n.SF480000=9573,n.SF490000=9561,n.SF500000=9560,n.SF510000=9554,n.SF520000=9555,n.SF530000=9579,n.SF540000=9578,n.Sacute=346,n.Sacutedotaccent=7780,n.Sampigreek=992,n.Scaron=352,n.Scarondotaccent=7782,n.Scaronsmall=63229,n.Scedilla=350,n.Schwa=399,n.Schwacyrillic=1240,n.Schwadieresiscyrillic=1242,n.Scircle=9416,n.Scircumflex=348,n.Scommaaccent=536,n.Sdotaccent=7776,n.Sdotbelow=7778,n.Sdotbelowdotaccent=7784,n.Seharmenian=1357,n.Sevenroman=8550,n.Shaarmenian=1351,n.Shacyrillic=1064,n.Shchacyrillic=1065,n.Sheicoptic=994,n.Shhacyrillic=1210,n.Shimacoptic=1004,n.Sigma=931,n.Sixroman=8549,n.Smonospace=65331,n.Softsigncyrillic=1068,n.Ssmall=63347,n.Stigmagreek=986,n.T=84,n.Tau=932,n.Tbar=358,n.Tcaron=356,n.Tcedilla=354,n.Tcircle=9417,n.Tcircumflexbelow=7792,n.Tcommaaccent=354,n.Tdotaccent=7786,n.Tdotbelow=7788,n.Tecyrillic=1058,n.Tedescendercyrillic=1196,n.Tenroman=8553,n.Tetsecyrillic=1204,n.Theta=920,n.Thook=428,n.Thorn=222,n.Thornsmall=63486,n.Threeroman=8546,n.Tildesmall=63230,n.Tiwnarmenian=1359,n.Tlinebelow=7790,n.Tmonospace=65332,n.Toarmenian=1337,n.Tonefive=444,n.Tonesix=388,n.Tonetwo=423,n.Tretroflexhook=430,n.Tsecyrillic=1062,n.Tshecyrillic=1035,n.Tsmall=63348,n.Twelveroman=8555,n.Tworoman=8545,n.U=85,n.Uacute=218,n.Uacutesmall=63482,n.Ubreve=364,n.Ucaron=467,n.Ucircle=9418,n.Ucircumflex=219,n.Ucircumflexbelow=7798,n.Ucircumflexsmall=63483,n.Ucyrillic=1059,n.Udblacute=368,n.Udblgrave=532,n.Udieresis=220,n.Udieresisacute=471,n.Udieresisbelow=7794,n.Udieresiscaron=473,n.Udieresiscyrillic=1264,n.Udieresisgrave=475,n.Udieresismacron=469,n.Udieresissmall=63484,n.Udotbelow=7908,n.Ugrave=217,n.Ugravesmall=63481,n.Uhookabove=7910,n.Uhorn=431,n.Uhornacute=7912,n.Uhorndotbelow=7920,n.Uhorngrave=7914,n.Uhornhookabove=7916,n.Uhorntilde=7918,n.Uhungarumlaut=368,n.Uhungarumlautcyrillic=1266,n.Uinvertedbreve=534,n.Ukcyrillic=1144,n.Umacron=362,n.Umacroncyrillic=1262,n.Umacrondieresis=7802,n.Umonospace=65333,n.Uogonek=370,n.Upsilon=933,n.Upsilon1=978,n.Upsilonacutehooksymbolgreek=979,n.Upsilonafrican=433,n.Upsilondieresis=939,n.Upsilondieresishooksymbolgreek=980,n.Upsilonhooksymbol=978,n.Upsilontonos=910,n.Uring=366,n.Ushortcyrillic=1038,n.Usmall=63349,n.Ustraightcyrillic=1198,n.Ustraightstrokecyrillic=1200,n.Utilde=360,n.Utildeacute=7800,n.Utildebelow=7796,n.V=86,n.Vcircle=9419,n.Vdotbelow=7806,n.Vecyrillic=1042,n.Vewarmenian=1358,n.Vhook=434,n.Vmonospace=65334,n.Voarmenian=1352,n.Vsmall=63350,n.Vtilde=7804,n.W=87,n.Wacute=7810,n.Wcircle=9420,n.Wcircumflex=372,n.Wdieresis=7812,n.Wdotaccent=7814,n.Wdotbelow=7816,n.Wgrave=7808,n.Wmonospace=65335,n.Wsmall=63351,n.X=88,n.Xcircle=9421,n.Xdieresis=7820,n.Xdotaccent=7818,n.Xeharmenian=1341,n.Xi=926,n.Xmonospace=65336,n.Xsmall=63352,n.Y=89,n.Yacute=221,n.Yacutesmall=63485,n.Yatcyrillic=1122,n.Ycircle=9422,n.Ycircumflex=374,n.Ydieresis=376,n.Ydieresissmall=63487,n.Ydotaccent=7822,n.Ydotbelow=7924,n.Yericyrillic=1067,n.Yerudieresiscyrillic=1272,n.Ygrave=7922,n.Yhook=435,n.Yhookabove=7926,n.Yiarmenian=1349,n.Yicyrillic=1031,n.Yiwnarmenian=1362,n.Ymonospace=65337,n.Ysmall=63353,n.Ytilde=7928,n.Yusbigcyrillic=1130,n.Yusbigiotifiedcyrillic=1132,n.Yuslittlecyrillic=1126,n.Yuslittleiotifiedcyrillic=1128,n.Z=90,n.Zaarmenian=1334,n.Zacute=377,n.Zcaron=381,n.Zcaronsmall=63231,n.Zcircle=9423,n.Zcircumflex=7824,n.Zdot=379,n.Zdotaccent=379,n.Zdotbelow=7826,n.Zecyrillic=1047,n.Zedescendercyrillic=1176,n.Zedieresiscyrillic=1246,n.Zeta=918,n.Zhearmenian=1338,n.Zhebrevecyrillic=1217,n.Zhecyrillic=1046,n.Zhedescendercyrillic=1174,n.Zhedieresiscyrillic=1244,n.Zlinebelow=7828,n.Zmonospace=65338,n.Zsmall=63354,n.Zstroke=437,n.a=97,n.aabengali=2438,n.aacute=225,n.aadeva=2310,n.aagujarati=2694,n.aagurmukhi=2566,n.aamatragurmukhi=2622,n.aarusquare=13059,n.aavowelsignbengali=2494,n.aavowelsigndeva=2366,n.aavowelsigngujarati=2750,n.abbreviationmarkarmenian=1375,n.abbreviationsigndeva=2416,n.abengali=2437,n.abopomofo=12570,n.abreve=259,n.abreveacute=7855,n.abrevecyrillic=1233,n.abrevedotbelow=7863,n.abrevegrave=7857,n.abrevehookabove=7859,n.abrevetilde=7861,n.acaron=462,n.acircle=9424,n.acircumflex=226,n.acircumflexacute=7845,n.acircumflexdotbelow=7853,n.acircumflexgrave=7847,n.acircumflexhookabove=7849,n.acircumflextilde=7851,n.acute=180,n.acutebelowcmb=791,n.acutecmb=769,n.acutecomb=769,n.acutedeva=2388,n.acutelowmod=719,n.acutetonecmb=833,n.acyrillic=1072,n.adblgrave=513,n.addakgurmukhi=2673,n.adeva=2309,n.adieresis=228,n.adieresiscyrillic=1235,n.adieresismacron=479,n.adotbelow=7841,n.adotmacron=481,n.ae=230,n.aeacute=509,n.aekorean=12624,n.aemacron=483,n.afii00208=8213,n.afii08941=8356,n.afii10017=1040,n.afii10018=1041,n.afii10019=1042,n.afii10020=1043,n.afii10021=1044,n.afii10022=1045,n.afii10023=1025,n.afii10024=1046,n.afii10025=1047,n.afii10026=1048,n.afii10027=1049,n.afii10028=1050,n.afii10029=1051,n.afii10030=1052,n.afii10031=1053,n.afii10032=1054,n.afii10033=1055,n.afii10034=1056,n.afii10035=1057,n.afii10036=1058,n.afii10037=1059,n.afii10038=1060,n.afii10039=1061,n.afii10040=1062,n.afii10041=1063,n.afii10042=1064,n.afii10043=1065,n.afii10044=1066,n.afii10045=1067,n.afii10046=1068,n.afii10047=1069,n.afii10048=1070,n.afii10049=1071,n.afii10050=1168,n.afii10051=1026,n.afii10052=1027,n.afii10053=1028,n.afii10054=1029,n.afii10055=1030,n.afii10056=1031,n.afii10057=1032,n.afii10058=1033,n.afii10059=1034,n.afii10060=1035,n.afii10061=1036,n.afii10062=1038,n.afii10063=63172,n.afii10064=63173,n.afii10065=1072,n.afii10066=1073,n.afii10067=1074,n.afii10068=1075,n.afii10069=1076,n.afii10070=1077,n.afii10071=1105,n.afii10072=1078,n.afii10073=1079,n.afii10074=1080,n.afii10075=1081,n.afii10076=1082,n.afii10077=1083,n.afii10078=1084,n.afii10079=1085,n.afii10080=1086,n.afii10081=1087,n.afii10082=1088,n.afii10083=1089,n.afii10084=1090,n.afii10085=1091,n.afii10086=1092,n.afii10087=1093,n.afii10088=1094,n.afii10089=1095,n.afii10090=1096,n.afii10091=1097,n.afii10092=1098,n.afii10093=1099,n.afii10094=1100,n.afii10095=1101,n.afii10096=1102,n.afii10097=1103,n.afii10098=1169,n.afii10099=1106,n.afii10100=1107,n.afii10101=1108,n.afii10102=1109,n.afii10103=1110,n.afii10104=1111,n.afii10105=1112,n.afii10106=1113,n.afii10107=1114,n.afii10108=1115,n.afii10109=1116,n.afii10110=1118,n.afii10145=1039,n.afii10146=1122,n.afii10147=1138,n.afii10148=1140,n.afii10192=63174,n.afii10193=1119,n.afii10194=1123,n.afii10195=1139,n.afii10196=1141,n.afii10831=63175,n.afii10832=63176,n.afii10846=1241,n.afii299=8206,n.afii300=8207,n.afii301=8205,n.afii57381=1642,n.afii57388=1548,n.afii57392=1632,n.afii57393=1633,n.afii57394=1634,n.afii57395=1635,n.afii57396=1636,n.afii57397=1637,n.afii57398=1638,n.afii57399=1639,n.afii57400=1640,n.afii57401=1641,n.afii57403=1563,n.afii57407=1567,n.afii57409=1569,n.afii57410=1570,n.afii57411=1571,n.afii57412=1572,n.afii57413=1573,n.afii57414=1574,n.afii57415=1575,n.afii57416=1576,n.afii57417=1577,n.afii57418=1578,n.afii57419=1579,n.afii57420=1580,n.afii57421=1581,n.afii57422=1582,n.afii57423=1583,n.afii57424=1584,n.afii57425=1585,n.afii57426=1586,n.afii57427=1587,n.afii57428=1588,n.afii57429=1589,n.afii57430=1590,n.afii57431=1591,n.afii57432=1592,n.afii57433=1593,n.afii57434=1594,n.afii57440=1600,n.afii57441=1601,n.afii57442=1602,n.afii57443=1603,n.afii57444=1604,n.afii57445=1605,n.afii57446=1606,n.afii57448=1608,n.afii57449=1609,n.afii57450=1610,n.afii57451=1611,n.afii57452=1612,n.afii57453=1613,n.afii57454=1614,n.afii57455=1615,n.afii57456=1616,n.afii57457=1617,n.afii57458=1618,n.afii57470=1607,n.afii57505=1700,n.afii57506=1662,n.afii57507=1670,n.afii57508=1688,n.afii57509=1711,n.afii57511=1657,n.afii57512=1672,n.afii57513=1681,n.afii57514=1722,n.afii57519=1746,n.afii57534=1749,n.afii57636=8362,n.afii57645=1470,n.afii57658=1475,n.afii57664=1488,n.afii57665=1489,n.afii57666=1490,n.afii57667=1491,n.afii57668=1492,n.afii57669=1493,n.afii57670=1494,n.afii57671=1495,n.afii57672=1496,n.afii57673=1497,n.afii57674=1498,n.afii57675=1499,n.afii57676=1500,n.afii57677=1501,n.afii57678=1502,n.afii57679=1503,n.afii57680=1504,n.afii57681=1505,n.afii57682=1506,n.afii57683=1507,n.afii57684=1508,n.afii57685=1509,n.afii57686=1510,n.afii57687=1511,n.afii57688=1512,n.afii57689=1513,n.afii57690=1514,n.afii57694=64298,n.afii57695=64299,n.afii57700=64331,n.afii57705=64287,n.afii57716=1520,n.afii57717=1521,n.afii57718=1522,n.afii57723=64309,n.afii57793=1460,n.afii57794=1461,n.afii57795=1462,n.afii57796=1467,n.afii57797=1464,n.afii57798=1463,n.afii57799=1456,n.afii57800=1458,n.afii57801=1457,n.afii57802=1459,n.afii57803=1474,n.afii57804=1473,n.afii57806=1465,n.afii57807=1468,n.afii57839=1469,n.afii57841=1471,n.afii57842=1472,n.afii57929=700,n.afii61248=8453,n.afii61289=8467,n.afii61352=8470,n.afii61573=8236,n.afii61574=8237,n.afii61575=8238,n.afii61664=8204,n.afii63167=1645,n.afii64937=701,n.agrave=224,n.agujarati=2693,n.agurmukhi=2565,n.ahiragana=12354,n.ahookabove=7843,n.aibengali=2448,n.aibopomofo=12574,n.aideva=2320,n.aiecyrillic=1237,n.aigujarati=2704,n.aigurmukhi=2576,n.aimatragurmukhi=2632,n.ainarabic=1593,n.ainfinalarabic=65226,n.aininitialarabic=65227,n.ainmedialarabic=65228,n.ainvertedbreve=515,n.aivowelsignbengali=2504,n.aivowelsigndeva=2376,n.aivowelsigngujarati=2760,n.akatakana=12450,n.akatakanahalfwidth=65393,n.akorean=12623,n.alef=1488,n.alefarabic=1575,n.alefdageshhebrew=64304,n.aleffinalarabic=65166,n.alefhamzaabovearabic=1571,n.alefhamzaabovefinalarabic=65156,n.alefhamzabelowarabic=1573,n.alefhamzabelowfinalarabic=65160,n.alefhebrew=1488,n.aleflamedhebrew=64335,n.alefmaddaabovearabic=1570,n.alefmaddaabovefinalarabic=65154,n.alefmaksuraarabic=1609,n.alefmaksurafinalarabic=65264,n.alefmaksurainitialarabic=65267,n.alefmaksuramedialarabic=65268,n.alefpatahhebrew=64302,n.alefqamatshebrew=64303,n.aleph=8501,n.allequal=8780,n.alpha=945,n.alphatonos=940,n.amacron=257,n.amonospace=65345,n.ampersand=38,n.ampersandmonospace=65286,n.ampersandsmall=63270,n.amsquare=13250,n.anbopomofo=12578,n.angbopomofo=12580,n.angbracketleft=12296,n.angbracketright=12297,n.angkhankhuthai=3674,n.angle=8736,n.anglebracketleft=12296,n.anglebracketleftvertical=65087,n.anglebracketright=12297,n.anglebracketrightvertical=65088,n.angleleft=9001,n.angleright=9002,n.angstrom=8491,n.anoteleia=903,n.anudattadeva=2386,n.anusvarabengali=2434,n.anusvaradeva=2306,n.anusvaragujarati=2690,n.aogonek=261,n.apaatosquare=13056,n.aparen=9372,n.apostrophearmenian=1370,n.apostrophemod=700,n.apple=63743,n.approaches=8784,n.approxequal=8776,n.approxequalorimage=8786,n.approximatelyequal=8773,n.araeaekorean=12686,n.araeakorean=12685,n.arc=8978,n.arighthalfring=7834,n.aring=229,n.aringacute=507,n.aringbelow=7681,n.arrowboth=8596,n.arrowdashdown=8675,n.arrowdashleft=8672,n.arrowdashright=8674,n.arrowdashup=8673,n.arrowdblboth=8660,n.arrowdbldown=8659,n.arrowdblleft=8656,n.arrowdblright=8658,n.arrowdblup=8657,n.arrowdown=8595,n.arrowdownleft=8601,n.arrowdownright=8600,n.arrowdownwhite=8681,n.arrowheaddownmod=709,n.arrowheadleftmod=706,n.arrowheadrightmod=707,n.arrowheadupmod=708,n.arrowhorizex=63719,n.arrowleft=8592,n.arrowleftdbl=8656,n.arrowleftdblstroke=8653,n.arrowleftoverright=8646,n.arrowleftwhite=8678,n.arrowright=8594,n.arrowrightdblstroke=8655,n.arrowrightheavy=10142,n.arrowrightoverleft=8644,n.arrowrightwhite=8680,n.arrowtableft=8676,n.arrowtabright=8677,n.arrowup=8593,n.arrowupdn=8597,n.arrowupdnbse=8616,n.arrowupdownbase=8616,n.arrowupleft=8598,n.arrowupleftofdown=8645,n.arrowupright=8599,n.arrowupwhite=8679,n.arrowvertex=63718,n.asciicircum=94,n.asciicircummonospace=65342,n.asciitilde=126,n.asciitildemonospace=65374,n.ascript=593,n.ascriptturned=594,n.asmallhiragana=12353,n.asmallkatakana=12449,n.asmallkatakanahalfwidth=65383,n.asterisk=42,n.asteriskaltonearabic=1645,n.asteriskarabic=1645,n.asteriskmath=8727,n.asteriskmonospace=65290,n.asterisksmall=65121,n.asterism=8258,n.asuperior=63209,n.asymptoticallyequal=8771,n.at=64,n.atilde=227,n.atmonospace=65312,n.atsmall=65131,n.aturned=592,n.aubengali=2452,n.aubopomofo=12576,n.audeva=2324,n.augujarati=2708,n.augurmukhi=2580,n.aulengthmarkbengali=2519,n.aumatragurmukhi=2636,n.auvowelsignbengali=2508,n.auvowelsigndeva=2380,n.auvowelsigngujarati=2764,n.avagrahadeva=2365,n.aybarmenian=1377,n.ayin=1506,n.ayinaltonehebrew=64288,n.ayinhebrew=1506,n.b=98,n.babengali=2476,n.backslash=92,n.backslashmonospace=65340,n.badeva=2348,n.bagujarati=2732,n.bagurmukhi=2604,n.bahiragana=12400,n.bahtthai=3647,n.bakatakana=12496,n.bar=124,n.barmonospace=65372,n.bbopomofo=12549,n.bcircle=9425,n.bdotaccent=7683,n.bdotbelow=7685,n.beamedsixteenthnotes=9836,n.because=8757,n.becyrillic=1073,n.beharabic=1576,n.behfinalarabic=65168,n.behinitialarabic=65169,n.behiragana=12409,n.behmedialarabic=65170,n.behmeeminitialarabic=64671,n.behmeemisolatedarabic=64520,n.behnoonfinalarabic=64621,n.bekatakana=12505,n.benarmenian=1378,n.bet=1489,n.beta=946,n.betasymbolgreek=976,n.betdagesh=64305,n.betdageshhebrew=64305,n.bethebrew=1489,n.betrafehebrew=64332,n.bhabengali=2477,n.bhadeva=2349,n.bhagujarati=2733,n.bhagurmukhi=2605,n.bhook=595,n.bihiragana=12403,n.bikatakana=12499,n.bilabialclick=664,n.bindigurmukhi=2562,n.birusquare=13105,n.blackcircle=9679,n.blackdiamond=9670,n.blackdownpointingtriangle=9660,n.blackleftpointingpointer=9668,n.blackleftpointingtriangle=9664,n.blacklenticularbracketleft=12304,n.blacklenticularbracketleftvertical=65083,n.blacklenticularbracketright=12305,n.blacklenticularbracketrightvertical=65084,n.blacklowerlefttriangle=9699,n.blacklowerrighttriangle=9698,n.blackrectangle=9644,n.blackrightpointingpointer=9658,n.blackrightpointingtriangle=9654,n.blacksmallsquare=9642,n.blacksmilingface=9787,n.blacksquare=9632,n.blackstar=9733,n.blackupperlefttriangle=9700,n.blackupperrighttriangle=9701,n.blackuppointingsmalltriangle=9652,n.blackuppointingtriangle=9650,n.blank=9251,n.blinebelow=7687,n.block=9608,n.bmonospace=65346,n.bobaimaithai=3610,n.bohiragana=12412,n.bokatakana=12508,n.bparen=9373,n.bqsquare=13251,n.braceex=63732,n.braceleft=123,n.braceleftbt=63731,n.braceleftmid=63730,n.braceleftmonospace=65371,n.braceleftsmall=65115,n.bracelefttp=63729,n.braceleftvertical=65079,n.braceright=125,n.bracerightbt=63742,n.bracerightmid=63741,n.bracerightmonospace=65373,n.bracerightsmall=65116,n.bracerighttp=63740,n.bracerightvertical=65080,n.bracketleft=91,n.bracketleftbt=63728,n.bracketleftex=63727,n.bracketleftmonospace=65339,n.bracketlefttp=63726,n.bracketright=93,n.bracketrightbt=63739,n.bracketrightex=63738,n.bracketrightmonospace=65341,n.bracketrighttp=63737,n.breve=728,n.brevebelowcmb=814,n.brevecmb=774,n.breveinvertedbelowcmb=815,n.breveinvertedcmb=785,n.breveinverteddoublecmb=865,n.bridgebelowcmb=810,n.bridgeinvertedbelowcmb=826,n.brokenbar=166,n.bstroke=384,n.bsuperior=63210,n.btopbar=387,n.buhiragana=12406,n.bukatakana=12502,n.bullet=8226,n.bulletinverse=9688,n.bulletoperator=8729,n.bullseye=9678,n.c=99,n.caarmenian=1390,n.cabengali=2458,n.cacute=263,n.cadeva=2330,n.cagujarati=2714,n.cagurmukhi=2586,n.calsquare=13192,n.candrabindubengali=2433,n.candrabinducmb=784,n.candrabindudeva=2305,n.candrabindugujarati=2689,n.capslock=8682,n.careof=8453,n.caron=711,n.caronbelowcmb=812,n.caroncmb=780,n.carriagereturn=8629,n.cbopomofo=12568,n.ccaron=269,n.ccedilla=231,n.ccedillaacute=7689,n.ccircle=9426,n.ccircumflex=265,n.ccurl=597,n.cdot=267,n.cdotaccent=267,n.cdsquare=13253,n.cedilla=184,n.cedillacmb=807,n.cent=162,n.centigrade=8451,n.centinferior=63199,n.centmonospace=65504,n.centoldstyle=63394,n.centsuperior=63200,n.chaarmenian=1401,n.chabengali=2459,n.chadeva=2331,n.chagujarati=2715,n.chagurmukhi=2587,n.chbopomofo=12564,n.cheabkhasiancyrillic=1213,n.checkmark=10003,n.checyrillic=1095,n.chedescenderabkhasiancyrillic=1215,n.chedescendercyrillic=1207,n.chedieresiscyrillic=1269,n.cheharmenian=1395,n.chekhakassiancyrillic=1228,n.cheverticalstrokecyrillic=1209,n.chi=967,n.chieuchacirclekorean=12919,n.chieuchaparenkorean=12823,n.chieuchcirclekorean=12905,n.chieuchkorean=12618,n.chieuchparenkorean=12809,n.chochangthai=3594,n.chochanthai=3592,n.chochingthai=3593,n.chochoethai=3596,n.chook=392,n.cieucacirclekorean=12918,n.cieucaparenkorean=12822,n.cieuccirclekorean=12904,n.cieuckorean=12616,n.cieucparenkorean=12808,n.cieucuparenkorean=12828,n.circle=9675,n.circlecopyrt=169,n.circlemultiply=8855,n.circleot=8857,n.circleplus=8853,n.circlepostalmark=12342,n.circlewithlefthalfblack=9680,n.circlewithrighthalfblack=9681,n.circumflex=710,n.circumflexbelowcmb=813,n.circumflexcmb=770,n.clear=8999,n.clickalveolar=450,n.clickdental=448,n.clicklateral=449,n.clickretroflex=451,n.club=9827,n.clubsuitblack=9827,n.clubsuitwhite=9831,n.cmcubedsquare=13220,n.cmonospace=65347,n.cmsquaredsquare=13216,n.coarmenian=1409,n.colon=58,n.colonmonetary=8353,n.colonmonospace=65306,n.colonsign=8353,n.colonsmall=65109,n.colontriangularhalfmod=721,n.colontriangularmod=720,n.comma=44,n.commaabovecmb=787,n.commaaboverightcmb=789,n.commaaccent=63171,n.commaarabic=1548,n.commaarmenian=1373,n.commainferior=63201,n.commamonospace=65292,n.commareversedabovecmb=788,n.commareversedmod=701,n.commasmall=65104,n.commasuperior=63202,n.commaturnedabovecmb=786,n.commaturnedmod=699,n.compass=9788,n.congruent=8773,n.contourintegral=8750,n.control=8963,n.controlACK=6,n.controlBEL=7,n.controlBS=8,n.controlCAN=24,n.controlCR=13,n.controlDC1=17,n.controlDC2=18,n.controlDC3=19,n.controlDC4=20,n.controlDEL=127,n.controlDLE=16,n.controlEM=25,n.controlENQ=5,n.controlEOT=4,n.controlESC=27,n.controlETB=23,n.controlETX=3,n.controlFF=12,n.controlFS=28,n.controlGS=29,n.controlHT=9,n.controlLF=10,n.controlNAK=21,n.controlNULL=0,n.controlRS=30,n.controlSI=15,n.controlSO=14,n.controlSOT=2,n.controlSTX=1,n.controlSUB=26,n.controlSYN=22,n.controlUS=31,n.controlVT=11,n.copyright=169,n.copyrightsans=63721,n.copyrightserif=63193,n.cornerbracketleft=12300,n.cornerbracketlefthalfwidth=65378,n.cornerbracketleftvertical=65089,n.cornerbracketright=12301,n.cornerbracketrighthalfwidth=65379,n.cornerbracketrightvertical=65090,n.corporationsquare=13183,n.cosquare=13255,n.coverkgsquare=13254,n.cparen=9374,n.cruzeiro=8354,n.cstretched=663,n.curlyand=8911,n.curlyor=8910,n.currency=164,n.cyrBreve=63185,n.cyrFlex=63186,n.cyrbreve=63188,n.cyrflex=63189,n.d=100,n.daarmenian=1380,n.dabengali=2470,n.dadarabic=1590,n.dadeva=2342,n.dadfinalarabic=65214,n.dadinitialarabic=65215,n.dadmedialarabic=65216,n.dagesh=1468,n.dageshhebrew=1468,n.dagger=8224,n.daggerdbl=8225,n.dagujarati=2726,n.dagurmukhi=2598,n.dahiragana=12384,n.dakatakana=12480,n.dalarabic=1583,n.dalet=1491,n.daletdagesh=64307,n.daletdageshhebrew=64307,n.dalethebrew=1491,n.dalfinalarabic=65194,n.dammaarabic=1615,n.dammalowarabic=1615,n.dammatanaltonearabic=1612,n.dammatanarabic=1612,n.danda=2404,n.dargahebrew=1447,n.dargalefthebrew=1447,n.dasiapneumatacyrilliccmb=1157,n.dblGrave=63187,n.dblanglebracketleft=12298,n.dblanglebracketleftvertical=65085,n.dblanglebracketright=12299,n.dblanglebracketrightvertical=65086,n.dblarchinvertedbelowcmb=811,n.dblarrowleft=8660,n.dblarrowright=8658,n.dbldanda=2405,n.dblgrave=63190,n.dblgravecmb=783,n.dblintegral=8748,n.dbllowline=8215,n.dbllowlinecmb=819,n.dbloverlinecmb=831,n.dblprimemod=698,n.dblverticalbar=8214,n.dblverticallineabovecmb=782,n.dbopomofo=12553,n.dbsquare=13256,n.dcaron=271,n.dcedilla=7697,n.dcircle=9427,n.dcircumflexbelow=7699,n.dcroat=273,n.ddabengali=2465,n.ddadeva=2337,n.ddagujarati=2721,n.ddagurmukhi=2593,n.ddalarabic=1672,n.ddalfinalarabic=64393,n.dddhadeva=2396,n.ddhabengali=2466,n.ddhadeva=2338,n.ddhagujarati=2722,n.ddhagurmukhi=2594,n.ddotaccent=7691,n.ddotbelow=7693,n.decimalseparatorarabic=1643,n.decimalseparatorpersian=1643,n.decyrillic=1076,n.degree=176,n.dehihebrew=1453,n.dehiragana=12391,n.deicoptic=1007,n.dekatakana=12487,n.deleteleft=9003,n.deleteright=8998,n.delta=948,n.deltaturned=397,n.denominatorminusonenumeratorbengali=2552,n.dezh=676,n.dhabengali=2471,n.dhadeva=2343,n.dhagujarati=2727,n.dhagurmukhi=2599,n.dhook=599,n.dialytikatonos=901,n.dialytikatonoscmb=836,n.diamond=9830,n.diamondsuitwhite=9826,n.dieresis=168,n.dieresisacute=63191,n.dieresisbelowcmb=804,n.dieresiscmb=776,n.dieresisgrave=63192,n.dieresistonos=901,n.dihiragana=12386,n.dikatakana=12482,n.dittomark=12291,n.divide=247,n.divides=8739,n.divisionslash=8725,n.djecyrillic=1106,n.dkshade=9619,n.dlinebelow=7695,n.dlsquare=13207,n.dmacron=273,n.dmonospace=65348,n.dnblock=9604,n.dochadathai=3598,n.dodekthai=3604,n.dohiragana=12393,n.dokatakana=12489,n.dollar=36,n.dollarinferior=63203,n.dollarmonospace=65284,n.dollaroldstyle=63268,n.dollarsmall=65129,n.dollarsuperior=63204,n.dong=8363,n.dorusquare=13094,n.dotaccent=729,n.dotaccentcmb=775,n.dotbelowcmb=803,n.dotbelowcomb=803,n.dotkatakana=12539,n.dotlessi=305,n.dotlessj=63166,n.dotlessjstrokehook=644,n.dotmath=8901,n.dottedcircle=9676,n.doubleyodpatah=64287,n.doubleyodpatahhebrew=64287,n.downtackbelowcmb=798,n.downtackmod=725,n.dparen=9375,n.dsuperior=63211,n.dtail=598,n.dtopbar=396,n.duhiragana=12389,n.dukatakana=12485,n.dz=499,n.dzaltone=675,n.dzcaron=454,n.dzcurl=677,n.dzeabkhasiancyrillic=1249,n.dzecyrillic=1109,n.dzhecyrillic=1119,n.e=101,n.eacute=233,n.earth=9793,n.ebengali=2447,n.ebopomofo=12572,n.ebreve=277,n.ecandradeva=2317,n.ecandragujarati=2701,n.ecandravowelsigndeva=2373,n.ecandravowelsigngujarati=2757,n.ecaron=283,n.ecedillabreve=7709,n.echarmenian=1381,n.echyiwnarmenian=1415,n.ecircle=9428,n.ecircumflex=234,n.ecircumflexacute=7871,n.ecircumflexbelow=7705,n.ecircumflexdotbelow=7879,n.ecircumflexgrave=7873,n.ecircumflexhookabove=7875,n.ecircumflextilde=7877,n.ecyrillic=1108,n.edblgrave=517,n.edeva=2319,n.edieresis=235,n.edot=279,n.edotaccent=279,n.edotbelow=7865,n.eegurmukhi=2575,n.eematragurmukhi=2631,n.efcyrillic=1092,n.egrave=232,n.egujarati=2703,n.eharmenian=1383,n.ehbopomofo=12573,n.ehiragana=12360,n.ehookabove=7867,n.eibopomofo=12575,n.eight=56,n.eightarabic=1640,n.eightbengali=2542,n.eightcircle=9319,n.eightcircleinversesansserif=10129,n.eightdeva=2414,n.eighteencircle=9329,n.eighteenparen=9349,n.eighteenperiod=9369,n.eightgujarati=2798,n.eightgurmukhi=2670,n.eighthackarabic=1640,n.eighthangzhou=12328,n.eighthnotebeamed=9835,n.eightideographicparen=12839,n.eightinferior=8328,n.eightmonospace=65304,n.eightoldstyle=63288,n.eightparen=9339,n.eightperiod=9359,n.eightpersian=1784,n.eightroman=8567,n.eightsuperior=8312,n.eightthai=3672,n.einvertedbreve=519,n.eiotifiedcyrillic=1125,n.ekatakana=12456,n.ekatakanahalfwidth=65396,n.ekonkargurmukhi=2676,n.ekorean=12628,n.elcyrillic=1083,n.element=8712,n.elevencircle=9322,n.elevenparen=9342,n.elevenperiod=9362,n.elevenroman=8570,n.ellipsis=8230,n.ellipsisvertical=8942,n.emacron=275,n.emacronacute=7703,n.emacrongrave=7701,n.emcyrillic=1084,n.emdash=8212,n.emdashvertical=65073,n.emonospace=65349,n.emphasismarkarmenian=1371,n.emptyset=8709,n.enbopomofo=12579,n.encyrillic=1085,n.endash=8211,n.endashvertical=65074,n.endescendercyrillic=1187,n.eng=331,n.engbopomofo=12581,n.enghecyrillic=1189,n.enhookcyrillic=1224,n.enspace=8194,n.eogonek=281,n.eokorean=12627,n.eopen=603,n.eopenclosed=666,n.eopenreversed=604,n.eopenreversedclosed=606,n.eopenreversedhook=605,n.eparen=9376,n.epsilon=949,n.epsilontonos=941,n.equal=61,n.equalmonospace=65309,n.equalsmall=65126,n.equalsuperior=8316,n.equivalence=8801,n.erbopomofo=12582,n.ercyrillic=1088,n.ereversed=600,n.ereversedcyrillic=1101,n.escyrillic=1089,n.esdescendercyrillic=1195,n.esh=643,n.eshcurl=646,n.eshortdeva=2318,n.eshortvowelsigndeva=2374,n.eshreversedloop=426,n.eshsquatreversed=645,n.esmallhiragana=12359,n.esmallkatakana=12455,n.esmallkatakanahalfwidth=65386,n.estimated=8494,n.esuperior=63212,n.eta=951,n.etarmenian=1384,n.etatonos=942,n.eth=240,n.etilde=7869,n.etildebelow=7707,n.etnahtafoukhhebrew=1425,n.etnahtafoukhlefthebrew=1425,n.etnahtahebrew=1425,n.etnahtalefthebrew=1425,n.eturned=477,n.eukorean=12641,n.euro=8364,n.evowelsignbengali=2503,n.evowelsigndeva=2375,n.evowelsigngujarati=2759,n.exclam=33,n.exclamarmenian=1372,n.exclamdbl=8252,n.exclamdown=161,n.exclamdownsmall=63393,n.exclammonospace=65281,n.exclamsmall=63265,n.existential=8707,n.ezh=658,n.ezhcaron=495,n.ezhcurl=659,n.ezhreversed=441,n.ezhtail=442,n.f=102,n.fadeva=2398,n.fagurmukhi=2654,n.fahrenheit=8457,n.fathaarabic=1614,n.fathalowarabic=1614,n.fathatanarabic=1611,n.fbopomofo=12552,n.fcircle=9429,n.fdotaccent=7711,n.feharabic=1601,n.feharmenian=1414,n.fehfinalarabic=65234,n.fehinitialarabic=65235,n.fehmedialarabic=65236,n.feicoptic=997,n.female=9792,n.ff=64256,n.f_f=64256,n.ffi=64259,n.f_f_i=64259,n.ffl=64260,n.f_f_l=64260,n.fi=64257,n.f_i=64257,n.fifteencircle=9326,n.fifteenparen=9346,n.fifteenperiod=9366,n.figuredash=8210,n.filledbox=9632,n.filledrect=9644,n.finalkaf=1498,n.finalkafdagesh=64314,n.finalkafdageshhebrew=64314,n.finalkafhebrew=1498,n.finalmem=1501,n.finalmemhebrew=1501,n.finalnun=1503,n.finalnunhebrew=1503,n.finalpe=1507,n.finalpehebrew=1507,n.finaltsadi=1509,n.finaltsadihebrew=1509,n.firsttonechinese=713,n.fisheye=9673,n.fitacyrillic=1139,n.five=53,n.fivearabic=1637,n.fivebengali=2539,n.fivecircle=9316,n.fivecircleinversesansserif=10126,n.fivedeva=2411,n.fiveeighths=8541,n.fivegujarati=2795,n.fivegurmukhi=2667,n.fivehackarabic=1637,n.fivehangzhou=12325,n.fiveideographicparen=12836,n.fiveinferior=8325,n.fivemonospace=65301,n.fiveoldstyle=63285,n.fiveparen=9336,n.fiveperiod=9356,n.fivepersian=1781,n.fiveroman=8564,n.fivesuperior=8309,n.fivethai=3669,n.fl=64258,n.f_l=64258,n.florin=402,n.fmonospace=65350,n.fmsquare=13209,n.fofanthai=3615,n.fofathai=3613,n.fongmanthai=3663,n.forall=8704,n.four=52,n.fourarabic=1636,n.fourbengali=2538,n.fourcircle=9315,n.fourcircleinversesansserif=10125,n.fourdeva=2410,n.fourgujarati=2794,n.fourgurmukhi=2666,n.fourhackarabic=1636,n.fourhangzhou=12324,n.fourideographicparen=12835,n.fourinferior=8324,n.fourmonospace=65300,n.fournumeratorbengali=2551,n.fouroldstyle=63284,n.fourparen=9335,n.fourperiod=9355,n.fourpersian=1780,n.fourroman=8563,n.foursuperior=8308,n.fourteencircle=9325,n.fourteenparen=9345,n.fourteenperiod=9365,n.fourthai=3668,n.fourthtonechinese=715,n.fparen=9377,n.fraction=8260,n.franc=8355,n.g=103,n.gabengali=2455,n.gacute=501,n.gadeva=2327,n.gafarabic=1711,n.gaffinalarabic=64403,n.gafinitialarabic=64404,n.gafmedialarabic=64405,n.gagujarati=2711,n.gagurmukhi=2583,n.gahiragana=12364,n.gakatakana=12460,n.gamma=947,n.gammalatinsmall=611,n.gammasuperior=736,n.gangiacoptic=1003,n.gbopomofo=12557,n.gbreve=287,n.gcaron=487,n.gcedilla=291,n.gcircle=9430,n.gcircumflex=285,n.gcommaaccent=291,n.gdot=289,n.gdotaccent=289,n.gecyrillic=1075,n.gehiragana=12370,n.gekatakana=12466,n.geometricallyequal=8785,n.gereshaccenthebrew=1436,n.gereshhebrew=1523,n.gereshmuqdamhebrew=1437,n.germandbls=223,n.gershayimaccenthebrew=1438,n.gershayimhebrew=1524,n.getamark=12307,n.ghabengali=2456,n.ghadarmenian=1394,n.ghadeva=2328,n.ghagujarati=2712,n.ghagurmukhi=2584,n.ghainarabic=1594,n.ghainfinalarabic=65230,n.ghaininitialarabic=65231,n.ghainmedialarabic=65232,n.ghemiddlehookcyrillic=1173,n.ghestrokecyrillic=1171,n.gheupturncyrillic=1169,n.ghhadeva=2394,n.ghhagurmukhi=2650,n.ghook=608,n.ghzsquare=13203,n.gihiragana=12366,n.gikatakana=12462,n.gimarmenian=1379,n.gimel=1490,n.gimeldagesh=64306,n.gimeldageshhebrew=64306,n.gimelhebrew=1490,n.gjecyrillic=1107,n.glottalinvertedstroke=446,n.glottalstop=660,n.glottalstopinverted=662,n.glottalstopmod=704,n.glottalstopreversed=661,n.glottalstopreversedmod=705,n.glottalstopreversedsuperior=740,n.glottalstopstroke=673,n.glottalstopstrokereversed=674,n.gmacron=7713,n.gmonospace=65351,n.gohiragana=12372,n.gokatakana=12468,n.gparen=9378,n.gpasquare=13228,n.gradient=8711,n.grave=96,n.gravebelowcmb=790,n.gravecmb=768,n.gravecomb=768,n.gravedeva=2387,n.gravelowmod=718,n.gravemonospace=65344,n.gravetonecmb=832,n.greater=62,n.greaterequal=8805,n.greaterequalorless=8923,n.greatermonospace=65310,n.greaterorequivalent=8819,n.greaterorless=8823,n.greateroverequal=8807,n.greatersmall=65125,n.gscript=609,n.gstroke=485,n.guhiragana=12368,n.guillemotleft=171,n.guillemotright=187,n.guilsinglleft=8249,n.guilsinglright=8250,n.gukatakana=12464,n.guramusquare=13080,n.gysquare=13257,n.h=104,n.haabkhasiancyrillic=1193,n.haaltonearabic=1729,n.habengali=2489,n.hadescendercyrillic=1203,n.hadeva=2361,n.hagujarati=2745,n.hagurmukhi=2617,n.haharabic=1581,n.hahfinalarabic=65186,n.hahinitialarabic=65187,n.hahiragana=12399,n.hahmedialarabic=65188,n.haitusquare=13098,n.hakatakana=12495,n.hakatakanahalfwidth=65418,n.halantgurmukhi=2637,n.hamzaarabic=1569,n.hamzalowarabic=1569,n.hangulfiller=12644,n.hardsigncyrillic=1098,n.harpoonleftbarbup=8636,n.harpoonrightbarbup=8640,n.hasquare=13258,n.hatafpatah=1458,n.hatafpatah16=1458,n.hatafpatah23=1458,n.hatafpatah2f=1458,n.hatafpatahhebrew=1458,n.hatafpatahnarrowhebrew=1458,n.hatafpatahquarterhebrew=1458,n.hatafpatahwidehebrew=1458,n.hatafqamats=1459,n.hatafqamats1b=1459,n.hatafqamats28=1459,n.hatafqamats34=1459,n.hatafqamatshebrew=1459,n.hatafqamatsnarrowhebrew=1459,n.hatafqamatsquarterhebrew=1459,n.hatafqamatswidehebrew=1459,n.hatafsegol=1457,n.hatafsegol17=1457,n.hatafsegol24=1457,n.hatafsegol30=1457,n.hatafsegolhebrew=1457,n.hatafsegolnarrowhebrew=1457,n.hatafsegolquarterhebrew=1457,n.hatafsegolwidehebrew=1457,n.hbar=295,n.hbopomofo=12559,n.hbrevebelow=7723,n.hcedilla=7721,n.hcircle=9431,n.hcircumflex=293,n.hdieresis=7719,n.hdotaccent=7715,n.hdotbelow=7717,n.he=1492,n.heart=9829,n.heartsuitblack=9829,n.heartsuitwhite=9825,n.hedagesh=64308,n.hedageshhebrew=64308,n.hehaltonearabic=1729,n.heharabic=1607,n.hehebrew=1492,n.hehfinalaltonearabic=64423,n.hehfinalalttwoarabic=65258,n.hehfinalarabic=65258,n.hehhamzaabovefinalarabic=64421,n.hehhamzaaboveisolatedarabic=64420,n.hehinitialaltonearabic=64424,n.hehinitialarabic=65259,n.hehiragana=12408,n.hehmedialaltonearabic=64425,n.hehmedialarabic=65260,n.heiseierasquare=13179,n.hekatakana=12504,n.hekatakanahalfwidth=65421,n.hekutaarusquare=13110,n.henghook=615,n.herutusquare=13113,n.het=1495,n.hethebrew=1495,n.hhook=614,n.hhooksuperior=689,n.hieuhacirclekorean=12923,n.hieuhaparenkorean=12827,n.hieuhcirclekorean=12909,n.hieuhkorean=12622,n.hieuhparenkorean=12813,n.hihiragana=12402,n.hikatakana=12498,n.hikatakanahalfwidth=65419,n.hiriq=1460,n.hiriq14=1460,n.hiriq21=1460,n.hiriq2d=1460,n.hiriqhebrew=1460,n.hiriqnarrowhebrew=1460,n.hiriqquarterhebrew=1460,n.hiriqwidehebrew=1460,n.hlinebelow=7830,n.hmonospace=65352,n.hoarmenian=1392,n.hohipthai=3627,n.hohiragana=12411,n.hokatakana=12507,n.hokatakanahalfwidth=65422,n.holam=1465,n.holam19=1465,n.holam26=1465,n.holam32=1465,n.holamhebrew=1465,n.holamnarrowhebrew=1465,n.holamquarterhebrew=1465,n.holamwidehebrew=1465,n.honokhukthai=3630,n.hookabovecomb=777,n.hookcmb=777,n.hookpalatalizedbelowcmb=801,n.hookretroflexbelowcmb=802,n.hoonsquare=13122,n.horicoptic=1001,n.horizontalbar=8213,n.horncmb=795,n.hotsprings=9832,n.house=8962,n.hparen=9379,n.hsuperior=688,n.hturned=613,n.huhiragana=12405,n.huiitosquare=13107,n.hukatakana=12501,n.hukatakanahalfwidth=65420,n.hungarumlaut=733,n.hungarumlautcmb=779,n.hv=405,n.hyphen=45,n.hypheninferior=63205,n.hyphenmonospace=65293,n.hyphensmall=65123,n.hyphensuperior=63206,n.hyphentwo=8208,n.i=105,n.iacute=237,n.iacyrillic=1103,n.ibengali=2439,n.ibopomofo=12583,n.ibreve=301,n.icaron=464,n.icircle=9432,n.icircumflex=238,n.icyrillic=1110,n.idblgrave=521,n.ideographearthcircle=12943,n.ideographfirecircle=12939,n.ideographicallianceparen=12863,n.ideographiccallparen=12858,n.ideographiccentrecircle=12965,n.ideographicclose=12294,n.ideographiccomma=12289,n.ideographiccommaleft=65380,n.ideographiccongratulationparen=12855,n.ideographiccorrectcircle=12963,n.ideographicearthparen=12847,n.ideographicenterpriseparen=12861,n.ideographicexcellentcircle=12957,n.ideographicfestivalparen=12864,n.ideographicfinancialcircle=12950,n.ideographicfinancialparen=12854,n.ideographicfireparen=12843,n.ideographichaveparen=12850,n.ideographichighcircle=12964,n.ideographiciterationmark=12293,n.ideographiclaborcircle=12952,n.ideographiclaborparen=12856,n.ideographicleftcircle=12967,n.ideographiclowcircle=12966,n.ideographicmedicinecircle=12969,n.ideographicmetalparen=12846,n.ideographicmoonparen=12842,n.ideographicnameparen=12852,n.ideographicperiod=12290,n.ideographicprintcircle=12958,n.ideographicreachparen=12867,n.ideographicrepresentparen=12857,n.ideographicresourceparen=12862,n.ideographicrightcircle=12968,n.ideographicsecretcircle=12953,n.ideographicselfparen=12866,n.ideographicsocietyparen=12851,n.ideographicspace=12288,n.ideographicspecialparen=12853,n.ideographicstockparen=12849,n.ideographicstudyparen=12859,n.ideographicsunparen=12848,n.ideographicsuperviseparen=12860,n.ideographicwaterparen=12844,n.ideographicwoodparen=12845,n.ideographiczero=12295,n.ideographmetalcircle=12942,n.ideographmooncircle=12938,n.ideographnamecircle=12948,n.ideographsuncircle=12944,n.ideographwatercircle=12940,n.ideographwoodcircle=12941,n.ideva=2311,n.idieresis=239,n.idieresisacute=7727,n.idieresiscyrillic=1253,n.idotbelow=7883,n.iebrevecyrillic=1239,n.iecyrillic=1077,n.ieungacirclekorean=12917,n.ieungaparenkorean=12821,n.ieungcirclekorean=12903,n.ieungkorean=12615,n.ieungparenkorean=12807,n.igrave=236,n.igujarati=2695,n.igurmukhi=2567,n.ihiragana=12356,n.ihookabove=7881,n.iibengali=2440,n.iicyrillic=1080,n.iideva=2312,n.iigujarati=2696,n.iigurmukhi=2568,n.iimatragurmukhi=2624,n.iinvertedbreve=523,n.iishortcyrillic=1081,n.iivowelsignbengali=2496,n.iivowelsigndeva=2368,n.iivowelsigngujarati=2752,n.ij=307,n.ikatakana=12452,n.ikatakanahalfwidth=65394,n.ikorean=12643,n.ilde=732,n.iluyhebrew=1452,n.imacron=299,n.imacroncyrillic=1251,n.imageorapproximatelyequal=8787,n.imatragurmukhi=2623,n.imonospace=65353,n.increment=8710,n.infinity=8734,n.iniarmenian=1387,n.integral=8747,n.integralbottom=8993,n.integralbt=8993,n.integralex=63733,n.integraltop=8992,n.integraltp=8992,n.intersection=8745,n.intisquare=13061,n.invbullet=9688,n.invcircle=9689,n.invsmileface=9787,n.iocyrillic=1105,n.iogonek=303,n.iota=953,n.iotadieresis=970,n.iotadieresistonos=912,n.iotalatin=617,n.iotatonos=943,n.iparen=9380,n.irigurmukhi=2674,n.ismallhiragana=12355,n.ismallkatakana=12451,n.ismallkatakanahalfwidth=65384,n.issharbengali=2554,n.istroke=616,n.isuperior=63213,n.iterationhiragana=12445,n.iterationkatakana=12541,n.itilde=297,n.itildebelow=7725,n.iubopomofo=12585,n.iucyrillic=1102,n.ivowelsignbengali=2495,n.ivowelsigndeva=2367,n.ivowelsigngujarati=2751,n.izhitsacyrillic=1141,n.izhitsadblgravecyrillic=1143,n.j=106,n.jaarmenian=1393,n.jabengali=2460,n.jadeva=2332,n.jagujarati=2716,n.jagurmukhi=2588,n.jbopomofo=12560,n.jcaron=496,n.jcircle=9433,n.jcircumflex=309,n.jcrossedtail=669,n.jdotlessstroke=607,n.jecyrillic=1112,n.jeemarabic=1580,n.jeemfinalarabic=65182,n.jeeminitialarabic=65183,n.jeemmedialarabic=65184,n.jeharabic=1688,n.jehfinalarabic=64395,n.jhabengali=2461,n.jhadeva=2333,n.jhagujarati=2717,n.jhagurmukhi=2589,n.jheharmenian=1403,n.jis=12292,n.jmonospace=65354,n.jparen=9381,n.jsuperior=690,n.k=107,n.kabashkircyrillic=1185,n.kabengali=2453,n.kacute=7729,n.kacyrillic=1082,n.kadescendercyrillic=1179,n.kadeva=2325,n.kaf=1499,n.kafarabic=1603,n.kafdagesh=64315,n.kafdageshhebrew=64315,n.kaffinalarabic=65242,n.kafhebrew=1499,n.kafinitialarabic=65243,n.kafmedialarabic=65244,n.kafrafehebrew=64333,n.kagujarati=2709,n.kagurmukhi=2581,n.kahiragana=12363,n.kahookcyrillic=1220,n.kakatakana=12459,n.kakatakanahalfwidth=65398,n.kappa=954,n.kappasymbolgreek=1008,n.kapyeounmieumkorean=12657,n.kapyeounphieuphkorean=12676,n.kapyeounpieupkorean=12664,n.kapyeounssangpieupkorean=12665,n.karoriisquare=13069,n.kashidaautoarabic=1600,n.kashidaautonosidebearingarabic=1600,n.kasmallkatakana=12533,n.kasquare=13188,n.kasraarabic=1616,n.kasratanarabic=1613,n.kastrokecyrillic=1183,n.katahiraprolongmarkhalfwidth=65392,n.kaverticalstrokecyrillic=1181,n.kbopomofo=12558,n.kcalsquare=13193,n.kcaron=489,n.kcedilla=311,n.kcircle=9434,n.kcommaaccent=311,n.kdotbelow=7731,n.keharmenian=1412,n.kehiragana=12369,n.kekatakana=12465,n.kekatakanahalfwidth=65401,n.kenarmenian=1391,n.kesmallkatakana=12534,n.kgreenlandic=312,n.khabengali=2454,n.khacyrillic=1093,n.khadeva=2326,n.khagujarati=2710,n.khagurmukhi=2582,n.khaharabic=1582,n.khahfinalarabic=65190,n.khahinitialarabic=65191,n.khahmedialarabic=65192,n.kheicoptic=999,n.khhadeva=2393,n.khhagurmukhi=2649,n.khieukhacirclekorean=12920,n.khieukhaparenkorean=12824,n.khieukhcirclekorean=12906,n.khieukhkorean=12619,n.khieukhparenkorean=12810,n.khokhaithai=3586,n.khokhonthai=3589,n.khokhuatthai=3587,n.khokhwaithai=3588,n.khomutthai=3675,n.khook=409,n.khorakhangthai=3590,n.khzsquare=13201,n.kihiragana=12365,n.kikatakana=12461,n.kikatakanahalfwidth=65399,n.kiroguramusquare=13077,n.kiromeetorusquare=13078,n.kirosquare=13076,n.kiyeokacirclekorean=12910,n.kiyeokaparenkorean=12814,n.kiyeokcirclekorean=12896,n.kiyeokkorean=12593,n.kiyeokparenkorean=12800,n.kiyeoksioskorean=12595,n.kjecyrillic=1116,n.klinebelow=7733,n.klsquare=13208,n.kmcubedsquare=13222,n.kmonospace=65355,n.kmsquaredsquare=13218,n.kohiragana=12371,n.kohmsquare=13248,n.kokaithai=3585,n.kokatakana=12467,n.kokatakanahalfwidth=65402,n.kooposquare=13086,n.koppacyrillic=1153,n.koreanstandardsymbol=12927,n.koroniscmb=835,n.kparen=9382,n.kpasquare=13226,n.ksicyrillic=1135,n.ktsquare=13263,n.kturned=670,n.kuhiragana=12367,n.kukatakana=12463,n.kukatakanahalfwidth=65400,n.kvsquare=13240,n.kwsquare=13246,n.l=108,n.labengali=2482,n.lacute=314,n.ladeva=2354,n.lagujarati=2738,n.lagurmukhi=2610,n.lakkhangyaothai=3653,n.lamaleffinalarabic=65276,n.lamalefhamzaabovefinalarabic=65272,n.lamalefhamzaaboveisolatedarabic=65271,n.lamalefhamzabelowfinalarabic=65274,n.lamalefhamzabelowisolatedarabic=65273,n.lamalefisolatedarabic=65275,n.lamalefmaddaabovefinalarabic=65270,n.lamalefmaddaaboveisolatedarabic=65269,n.lamarabic=1604,n.lambda=955,n.lambdastroke=411,n.lamed=1500,n.lameddagesh=64316,n.lameddageshhebrew=64316,n.lamedhebrew=1500,n.lamfinalarabic=65246,n.lamhahinitialarabic=64714,n.laminitialarabic=65247,n.lamjeeminitialarabic=64713,n.lamkhahinitialarabic=64715,n.lamlamhehisolatedarabic=65010,n.lammedialarabic=65248,n.lammeemhahinitialarabic=64904,n.lammeeminitialarabic=64716,n.largecircle=9711,n.lbar=410,n.lbelt=620,n.lbopomofo=12556,n.lcaron=318,n.lcedilla=316,n.lcircle=9435,n.lcircumflexbelow=7741,n.lcommaaccent=316,n.ldot=320,n.ldotaccent=320,n.ldotbelow=7735,n.ldotbelowmacron=7737,n.leftangleabovecmb=794,n.lefttackbelowcmb=792,n.less=60,n.lessequal=8804,n.lessequalorgreater=8922,n.lessmonospace=65308,n.lessorequivalent=8818,n.lessorgreater=8822,n.lessoverequal=8806,n.lesssmall=65124,n.lezh=622,n.lfblock=9612,n.lhookretroflex=621,n.lira=8356,n.liwnarmenian=1388,n.lj=457,n.ljecyrillic=1113,n.ll=63168,n.lladeva=2355,n.llagujarati=2739,n.llinebelow=7739,n.llladeva=2356,n.llvocalicbengali=2529,n.llvocalicdeva=2401,n.llvocalicvowelsignbengali=2531,n.llvocalicvowelsigndeva=2403,n.lmiddletilde=619,n.lmonospace=65356,n.lmsquare=13264,n.lochulathai=3628,n.logicaland=8743,n.logicalnot=172,n.logicalnotreversed=8976,n.logicalor=8744,n.lolingthai=3621,n.longs=383,n.lowlinecenterline=65102,n.lowlinecmb=818,n.lowlinedashed=65101,n.lozenge=9674,n.lparen=9383,n.lslash=322,n.lsquare=8467,n.lsuperior=63214,n.ltshade=9617,n.luthai=3622,n.lvocalicbengali=2444,n.lvocalicdeva=2316,n.lvocalicvowelsignbengali=2530,n.lvocalicvowelsigndeva=2402,n.lxsquare=13267,n.m=109,n.mabengali=2478,n.macron=175,n.macronbelowcmb=817,n.macroncmb=772,n.macronlowmod=717,n.macronmonospace=65507,n.macute=7743,n.madeva=2350,n.magujarati=2734,n.magurmukhi=2606,n.mahapakhhebrew=1444,n.mahapakhlefthebrew=1444,n.mahiragana=12414,n.maichattawalowleftthai=63637,n.maichattawalowrightthai=63636,n.maichattawathai=3659,n.maichattawaupperleftthai=63635,n.maieklowleftthai=63628,n.maieklowrightthai=63627,n.maiekthai=3656,n.maiekupperleftthai=63626,n.maihanakatleftthai=63620,n.maihanakatthai=3633,n.maitaikhuleftthai=63625,n.maitaikhuthai=3655,n.maitholowleftthai=63631,n.maitholowrightthai=63630,n.maithothai=3657,n.maithoupperleftthai=63629,n.maitrilowleftthai=63634,n.maitrilowrightthai=63633,n.maitrithai=3658,n.maitriupperleftthai=63632,n.maiyamokthai=3654,n.makatakana=12510,n.makatakanahalfwidth=65423,n.male=9794,n.mansyonsquare=13127,n.maqafhebrew=1470,n.mars=9794,n.masoracirclehebrew=1455,n.masquare=13187,n.mbopomofo=12551,n.mbsquare=13268,n.mcircle=9436,n.mcubedsquare=13221,n.mdotaccent=7745,n.mdotbelow=7747,n.meemarabic=1605,n.meemfinalarabic=65250,n.meeminitialarabic=65251,n.meemmedialarabic=65252,n.meemmeeminitialarabic=64721,n.meemmeemisolatedarabic=64584,n.meetorusquare=13133,n.mehiragana=12417,n.meizierasquare=13182,n.mekatakana=12513,n.mekatakanahalfwidth=65426,n.mem=1502,n.memdagesh=64318,n.memdageshhebrew=64318,n.memhebrew=1502,n.menarmenian=1396,n.merkhahebrew=1445,n.merkhakefulahebrew=1446,n.merkhakefulalefthebrew=1446,n.merkhalefthebrew=1445,n.mhook=625,n.mhzsquare=13202,n.middledotkatakanahalfwidth=65381,n.middot=183,n.mieumacirclekorean=12914,n.mieumaparenkorean=12818,n.mieumcirclekorean=12900,n.mieumkorean=12609,n.mieumpansioskorean=12656,n.mieumparenkorean=12804,n.mieumpieupkorean=12654,n.mieumsioskorean=12655,n.mihiragana=12415,n.mikatakana=12511,n.mikatakanahalfwidth=65424,n.minus=8722,n.minusbelowcmb=800,n.minuscircle=8854,n.minusmod=727,n.minusplus=8723,n.minute=8242,n.miribaarusquare=13130,n.mirisquare=13129,n.mlonglegturned=624,n.mlsquare=13206,n.mmcubedsquare=13219,n.mmonospace=65357,n.mmsquaredsquare=13215,n.mohiragana=12418,n.mohmsquare=13249,n.mokatakana=12514,n.mokatakanahalfwidth=65427,n.molsquare=13270,n.momathai=3617,n.moverssquare=13223,n.moverssquaredsquare=13224,n.mparen=9384,n.mpasquare=13227,n.mssquare=13235,n.msuperior=63215,n.mturned=623,n.mu=181,n.mu1=181,n.muasquare=13186,n.muchgreater=8811,n.muchless=8810,n.mufsquare=13196,n.mugreek=956,n.mugsquare=13197,n.muhiragana=12416,n.mukatakana=12512,n.mukatakanahalfwidth=65425,n.mulsquare=13205,n.multiply=215,n.mumsquare=13211,n.munahhebrew=1443,n.munahlefthebrew=1443,n.musicalnote=9834,n.musicalnotedbl=9835,n.musicflatsign=9837,n.musicsharpsign=9839,n.mussquare=13234,n.muvsquare=13238,n.muwsquare=13244,n.mvmegasquare=13241,n.mvsquare=13239,n.mwmegasquare=13247,n.mwsquare=13245,n.n=110,n.nabengali=2472,n.nabla=8711,n.nacute=324,n.nadeva=2344,n.nagujarati=2728,n.nagurmukhi=2600,n.nahiragana=12394,n.nakatakana=12490,n.nakatakanahalfwidth=65413,n.napostrophe=329,n.nasquare=13185,n.nbopomofo=12555,n.nbspace=160,n.ncaron=328,n.ncedilla=326,n.ncircle=9437,n.ncircumflexbelow=7755,n.ncommaaccent=326,n.ndotaccent=7749,n.ndotbelow=7751,n.nehiragana=12397,n.nekatakana=12493,n.nekatakanahalfwidth=65416,n.newsheqelsign=8362,n.nfsquare=13195,n.ngabengali=2457,n.ngadeva=2329,n.ngagujarati=2713,n.ngagurmukhi=2585,n.ngonguthai=3591,n.nhiragana=12435,n.nhookleft=626,n.nhookretroflex=627,n.nieunacirclekorean=12911,n.nieunaparenkorean=12815,n.nieuncieuckorean=12597,n.nieuncirclekorean=12897,n.nieunhieuhkorean=12598,n.nieunkorean=12596,n.nieunpansioskorean=12648,n.nieunparenkorean=12801,n.nieunsioskorean=12647,n.nieuntikeutkorean=12646,n.nihiragana=12395,n.nikatakana=12491,n.nikatakanahalfwidth=65414,n.nikhahitleftthai=63641,n.nikhahitthai=3661,n.nine=57,n.ninearabic=1641,n.ninebengali=2543,n.ninecircle=9320,n.ninecircleinversesansserif=10130,n.ninedeva=2415,n.ninegujarati=2799,n.ninegurmukhi=2671,n.ninehackarabic=1641,n.ninehangzhou=12329,n.nineideographicparen=12840,n.nineinferior=8329,n.ninemonospace=65305,n.nineoldstyle=63289,n.nineparen=9340,n.nineperiod=9360,n.ninepersian=1785,n.nineroman=8568,n.ninesuperior=8313,n.nineteencircle=9330,n.nineteenparen=9350,n.nineteenperiod=9370,n.ninethai=3673,n.nj=460,n.njecyrillic=1114,n.nkatakana=12531,n.nkatakanahalfwidth=65437,n.nlegrightlong=414,n.nlinebelow=7753,n.nmonospace=65358,n.nmsquare=13210,n.nnabengali=2467,n.nnadeva=2339,n.nnagujarati=2723,n.nnagurmukhi=2595,n.nnnadeva=2345,n.nohiragana=12398,n.nokatakana=12494,n.nokatakanahalfwidth=65417,n.nonbreakingspace=160,n.nonenthai=3603,n.nonuthai=3609,n.noonarabic=1606,n.noonfinalarabic=65254,n.noonghunnaarabic=1722,n.noonghunnafinalarabic=64415,n.nooninitialarabic=65255,n.noonjeeminitialarabic=64722,n.noonjeemisolatedarabic=64587,n.noonmedialarabic=65256,n.noonmeeminitialarabic=64725,n.noonmeemisolatedarabic=64590,n.noonnoonfinalarabic=64653,n.notcontains=8716,n.notelement=8713,n.notelementof=8713,n.notequal=8800,n.notgreater=8815,n.notgreaternorequal=8817,n.notgreaternorless=8825,n.notidentical=8802,n.notless=8814,n.notlessnorequal=8816,n.notparallel=8742,n.notprecedes=8832,n.notsubset=8836,n.notsucceeds=8833,n.notsuperset=8837,n.nowarmenian=1398,n.nparen=9385,n.nssquare=13233,n.nsuperior=8319,n.ntilde=241,n.nu=957,n.nuhiragana=12396,n.nukatakana=12492,n.nukatakanahalfwidth=65415,n.nuktabengali=2492,n.nuktadeva=2364,n.nuktagujarati=2748,n.nuktagurmukhi=2620,n.numbersign=35,n.numbersignmonospace=65283,n.numbersignsmall=65119,n.numeralsigngreek=884,n.numeralsignlowergreek=885,n.numero=8470,n.nun=1504,n.nundagesh=64320,n.nundageshhebrew=64320,n.nunhebrew=1504,n.nvsquare=13237,n.nwsquare=13243,n.nyabengali=2462,n.nyadeva=2334,n.nyagujarati=2718,n.nyagurmukhi=2590,n.o=111,n.oacute=243,n.oangthai=3629,n.obarred=629,n.obarredcyrillic=1257,n.obarreddieresiscyrillic=1259,n.obengali=2451,n.obopomofo=12571,n.obreve=335,n.ocandradeva=2321,n.ocandragujarati=2705,n.ocandravowelsigndeva=2377,n.ocandravowelsigngujarati=2761,n.ocaron=466,n.ocircle=9438,n.ocircumflex=244,n.ocircumflexacute=7889,n.ocircumflexdotbelow=7897,n.ocircumflexgrave=7891,n.ocircumflexhookabove=7893,n.ocircumflextilde=7895,n.ocyrillic=1086,n.odblacute=337,n.odblgrave=525,n.odeva=2323,n.odieresis=246,n.odieresiscyrillic=1255,n.odotbelow=7885,n.oe=339,n.oekorean=12634,n.ogonek=731,n.ogonekcmb=808,n.ograve=242,n.ogujarati=2707,n.oharmenian=1413,n.ohiragana=12362,n.ohookabove=7887,n.ohorn=417,n.ohornacute=7899,n.ohorndotbelow=7907,n.ohorngrave=7901,n.ohornhookabove=7903,n.ohorntilde=7905,n.ohungarumlaut=337,n.oi=419,n.oinvertedbreve=527,n.okatakana=12458,n.okatakanahalfwidth=65397,n.okorean=12631,n.olehebrew=1451,n.omacron=333,n.omacronacute=7763,n.omacrongrave=7761,n.omdeva=2384,n.omega=969,n.omega1=982,n.omegacyrillic=1121,n.omegalatinclosed=631,n.omegaroundcyrillic=1147,n.omegatitlocyrillic=1149,n.omegatonos=974,n.omgujarati=2768,n.omicron=959,n.omicrontonos=972,n.omonospace=65359,n.one=49,n.onearabic=1633,n.onebengali=2535,n.onecircle=9312,n.onecircleinversesansserif=10122,n.onedeva=2407,n.onedotenleader=8228,n.oneeighth=8539,n.onefitted=63196,n.onegujarati=2791,n.onegurmukhi=2663,n.onehackarabic=1633,n.onehalf=189,n.onehangzhou=12321,n.oneideographicparen=12832,n.oneinferior=8321,n.onemonospace=65297,n.onenumeratorbengali=2548,n.oneoldstyle=63281,n.oneparen=9332,n.oneperiod=9352,n.onepersian=1777,n.onequarter=188,n.oneroman=8560,n.onesuperior=185,n.onethai=3665,n.onethird=8531,n.oogonek=491,n.oogonekmacron=493,n.oogurmukhi=2579,n.oomatragurmukhi=2635,n.oopen=596,n.oparen=9386,n.openbullet=9702,n.option=8997,n.ordfeminine=170,n.ordmasculine=186,n.orthogonal=8735,n.oshortdeva=2322,n.oshortvowelsigndeva=2378,n.oslash=248,n.oslashacute=511,n.osmallhiragana=12361,n.osmallkatakana=12457,n.osmallkatakanahalfwidth=65387,n.ostrokeacute=511,n.osuperior=63216,n.otcyrillic=1151,n.otilde=245,n.otildeacute=7757,n.otildedieresis=7759,n.oubopomofo=12577,n.overline=8254,n.overlinecenterline=65098,n.overlinecmb=773,n.overlinedashed=65097,n.overlinedblwavy=65100,n.overlinewavy=65099,n.overscore=175,n.ovowelsignbengali=2507,n.ovowelsigndeva=2379,n.ovowelsigngujarati=2763,n.p=112,n.paampssquare=13184,n.paasentosquare=13099,n.pabengali=2474,n.pacute=7765,n.padeva=2346,n.pagedown=8671,n.pageup=8670,n.pagujarati=2730,n.pagurmukhi=2602,n.pahiragana=12401,n.paiyannoithai=3631,n.pakatakana=12497,n.palatalizationcyrilliccmb=1156,n.palochkacyrillic=1216,n.pansioskorean=12671,n.paragraph=182,n.parallel=8741,n.parenleft=40,n.parenleftaltonearabic=64830,n.parenleftbt=63725,n.parenleftex=63724,n.parenleftinferior=8333,n.parenleftmonospace=65288,n.parenleftsmall=65113,n.parenleftsuperior=8317,n.parenlefttp=63723,n.parenleftvertical=65077,n.parenright=41,n.parenrightaltonearabic=64831,n.parenrightbt=63736,n.parenrightex=63735,n.parenrightinferior=8334,n.parenrightmonospace=65289,n.parenrightsmall=65114,n.parenrightsuperior=8318,n.parenrighttp=63734,n.parenrightvertical=65078,n.partialdiff=8706,n.paseqhebrew=1472,n.pashtahebrew=1433,n.pasquare=13225,n.patah=1463,n.patah11=1463,n.patah1d=1463,n.patah2a=1463,n.patahhebrew=1463,n.patahnarrowhebrew=1463,n.patahquarterhebrew=1463,n.patahwidehebrew=1463,n.pazerhebrew=1441,n.pbopomofo=12550,n.pcircle=9439,n.pdotaccent=7767,n.pe=1508,n.pecyrillic=1087,n.pedagesh=64324,n.pedageshhebrew=64324,n.peezisquare=13115,n.pefinaldageshhebrew=64323,n.peharabic=1662,n.peharmenian=1402,n.pehebrew=1508,n.pehfinalarabic=64343,n.pehinitialarabic=64344,n.pehiragana=12410,n.pehmedialarabic=64345,n.pekatakana=12506,n.pemiddlehookcyrillic=1191,n.perafehebrew=64334,n.percent=37,n.percentarabic=1642,n.percentmonospace=65285,n.percentsmall=65130,n.period=46,n.periodarmenian=1417,n.periodcentered=183,n.periodhalfwidth=65377,n.periodinferior=63207,n.periodmonospace=65294,n.periodsmall=65106,n.periodsuperior=63208,n.perispomenigreekcmb=834,n.perpendicular=8869,n.perthousand=8240,n.peseta=8359,n.pfsquare=13194,n.phabengali=2475,n.phadeva=2347,n.phagujarati=2731,n.phagurmukhi=2603,n.phi=966,n.phi1=981,n.phieuphacirclekorean=12922,n.phieuphaparenkorean=12826,n.phieuphcirclekorean=12908,n.phieuphkorean=12621,n.phieuphparenkorean=12812,n.philatin=632,n.phinthuthai=3642,n.phisymbolgreek=981,n.phook=421,n.phophanthai=3614,n.phophungthai=3612,n.phosamphaothai=3616,n.pi=960,n.pieupacirclekorean=12915,n.pieupaparenkorean=12819,n.pieupcieuckorean=12662,n.pieupcirclekorean=12901,n.pieupkiyeokkorean=12658,n.pieupkorean=12610,n.pieupparenkorean=12805,n.pieupsioskiyeokkorean=12660,n.pieupsioskorean=12612,n.pieupsiostikeutkorean=12661,n.pieupthieuthkorean=12663,n.pieuptikeutkorean=12659,n.pihiragana=12404,n.pikatakana=12500,n.pisymbolgreek=982,n.piwrarmenian=1411,n.planckover2pi=8463,n.planckover2pi1=8463,n.plus=43,n.plusbelowcmb=799,n.pluscircle=8853,n.plusminus=177,n.plusmod=726,n.plusmonospace=65291,n.plussmall=65122,n.plussuperior=8314,n.pmonospace=65360,n.pmsquare=13272,n.pohiragana=12413,n.pointingindexdownwhite=9759,n.pointingindexleftwhite=9756,n.pointingindexrightwhite=9758,n.pointingindexupwhite=9757,n.pokatakana=12509,n.poplathai=3611,n.postalmark=12306,n.postalmarkface=12320,n.pparen=9387,n.precedes=8826,n.prescription=8478,n.primemod=697,n.primereversed=8245,n.product=8719,n.projective=8965,n.prolongedkana=12540,n.propellor=8984,n.propersubset=8834,n.propersuperset=8835,n.proportion=8759,n.proportional=8733,n.psi=968,n.psicyrillic=1137,n.psilipneumatacyrilliccmb=1158,n.pssquare=13232,n.puhiragana=12407,n.pukatakana=12503,n.pvsquare=13236,n.pwsquare=13242,n.q=113,n.qadeva=2392,n.qadmahebrew=1448,n.qafarabic=1602,n.qaffinalarabic=65238,n.qafinitialarabic=65239,n.qafmedialarabic=65240,n.qamats=1464,n.qamats10=1464,n.qamats1a=1464,n.qamats1c=1464,n.qamats27=1464,n.qamats29=1464,n.qamats33=1464,n.qamatsde=1464,n.qamatshebrew=1464,n.qamatsnarrowhebrew=1464,n.qamatsqatanhebrew=1464,n.qamatsqatannarrowhebrew=1464,n.qamatsqatanquarterhebrew=1464,n.qamatsqatanwidehebrew=1464,n.qamatsquarterhebrew=1464,n.qamatswidehebrew=1464,n.qarneyparahebrew=1439,n.qbopomofo=12561,n.qcircle=9440,n.qhook=672,n.qmonospace=65361,n.qof=1511,n.qofdagesh=64327,n.qofdageshhebrew=64327,n.qofhebrew=1511,n.qparen=9388,n.quarternote=9833,n.qubuts=1467,n.qubuts18=1467,n.qubuts25=1467,n.qubuts31=1467,n.qubutshebrew=1467,n.qubutsnarrowhebrew=1467,n.qubutsquarterhebrew=1467,n.qubutswidehebrew=1467,n.question=63,n.questionarabic=1567,n.questionarmenian=1374,n.questiondown=191,n.questiondownsmall=63423,n.questiongreek=894,n.questionmonospace=65311,n.questionsmall=63295,n.quotedbl=34,n.quotedblbase=8222,n.quotedblleft=8220,n.quotedblmonospace=65282,n.quotedblprime=12318,n.quotedblprimereversed=12317,n.quotedblright=8221,n.quoteleft=8216,n.quoteleftreversed=8219,n.quotereversed=8219,n.quoteright=8217,n.quoterightn=329,n.quotesinglbase=8218,n.quotesingle=39,n.quotesinglemonospace=65287,n.r=114,n.raarmenian=1404,n.rabengali=2480,n.racute=341,n.radeva=2352,n.radical=8730,n.radicalex=63717,n.radoverssquare=13230,n.radoverssquaredsquare=13231,n.radsquare=13229,n.rafe=1471,n.rafehebrew=1471,n.ragujarati=2736,n.ragurmukhi=2608,n.rahiragana=12425,n.rakatakana=12521,n.rakatakanahalfwidth=65431,n.ralowerdiagonalbengali=2545,n.ramiddlediagonalbengali=2544,n.ramshorn=612,n.ratio=8758,n.rbopomofo=12566,n.rcaron=345,n.rcedilla=343,n.rcircle=9441,n.rcommaaccent=343,n.rdblgrave=529,n.rdotaccent=7769,n.rdotbelow=7771,n.rdotbelowmacron=7773,n.referencemark=8251,n.reflexsubset=8838,n.reflexsuperset=8839,n.registered=174,n.registersans=63720,n.registerserif=63194,n.reharabic=1585,n.reharmenian=1408,n.rehfinalarabic=65198,n.rehiragana=12428,n.rekatakana=12524,n.rekatakanahalfwidth=65434,n.resh=1512,n.reshdageshhebrew=64328,n.reshhebrew=1512,n.reversedtilde=8765,n.reviahebrew=1431,n.reviamugrashhebrew=1431,n.revlogicalnot=8976,n.rfishhook=638,n.rfishhookreversed=639,n.rhabengali=2525,n.rhadeva=2397,n.rho=961,n.rhook=637,n.rhookturned=635,n.rhookturnedsuperior=693,n.rhosymbolgreek=1009,n.rhotichookmod=734,n.rieulacirclekorean=12913,n.rieulaparenkorean=12817,n.rieulcirclekorean=12899,n.rieulhieuhkorean=12608,n.rieulkiyeokkorean=12602,n.rieulkiyeoksioskorean=12649,n.rieulkorean=12601,n.rieulmieumkorean=12603,n.rieulpansioskorean=12652,n.rieulparenkorean=12803,n.rieulphieuphkorean=12607,n.rieulpieupkorean=12604,n.rieulpieupsioskorean=12651,n.rieulsioskorean=12605,n.rieulthieuthkorean=12606,n.rieultikeutkorean=12650,n.rieulyeorinhieuhkorean=12653,n.rightangle=8735,n.righttackbelowcmb=793,n.righttriangle=8895,n.rihiragana=12426,n.rikatakana=12522,n.rikatakanahalfwidth=65432,n.ring=730,n.ringbelowcmb=805,n.ringcmb=778,n.ringhalfleft=703,n.ringhalfleftarmenian=1369,n.ringhalfleftbelowcmb=796,n.ringhalfleftcentered=723,n.ringhalfright=702,n.ringhalfrightbelowcmb=825,n.ringhalfrightcentered=722,n.rinvertedbreve=531,n.rittorusquare=13137,n.rlinebelow=7775,n.rlongleg=636,n.rlonglegturned=634,n.rmonospace=65362,n.rohiragana=12429,n.rokatakana=12525,n.rokatakanahalfwidth=65435,n.roruathai=3619,n.rparen=9389,n.rrabengali=2524,n.rradeva=2353,n.rragurmukhi=2652,n.rreharabic=1681,n.rrehfinalarabic=64397,n.rrvocalicbengali=2528,n.rrvocalicdeva=2400,n.rrvocalicgujarati=2784,n.rrvocalicvowelsignbengali=2500,n.rrvocalicvowelsigndeva=2372,n.rrvocalicvowelsigngujarati=2756,n.rsuperior=63217,n.rtblock=9616,n.rturned=633,n.rturnedsuperior=692,n.ruhiragana=12427,n.rukatakana=12523,n.rukatakanahalfwidth=65433,n.rupeemarkbengali=2546,n.rupeesignbengali=2547,n.rupiah=63197,n.ruthai=3620,n.rvocalicbengali=2443,n.rvocalicdeva=2315,n.rvocalicgujarati=2699,n.rvocalicvowelsignbengali=2499,n.rvocalicvowelsigndeva=2371,n.rvocalicvowelsigngujarati=2755,n.s=115,n.sabengali=2488,n.sacute=347,n.sacutedotaccent=7781,n.sadarabic=1589,n.sadeva=2360,n.sadfinalarabic=65210,n.sadinitialarabic=65211,n.sadmedialarabic=65212,n.sagujarati=2744,n.sagurmukhi=2616,n.sahiragana=12373,n.sakatakana=12469,n.sakatakanahalfwidth=65403,n.sallallahoualayhewasallamarabic=65018,n.samekh=1505,n.samekhdagesh=64321,n.samekhdageshhebrew=64321,n.samekhhebrew=1505,n.saraaathai=3634,n.saraaethai=3649,n.saraaimaimalaithai=3652,n.saraaimaimuanthai=3651,n.saraamthai=3635,n.saraathai=3632,n.saraethai=3648,n.saraiileftthai=63622,n.saraiithai=3637,n.saraileftthai=63621,n.saraithai=3636,n.saraothai=3650,n.saraueeleftthai=63624,n.saraueethai=3639,n.saraueleftthai=63623,n.sarauethai=3638,n.sarauthai=3640,n.sarauuthai=3641,n.sbopomofo=12569,n.scaron=353,n.scarondotaccent=7783,n.scedilla=351,n.schwa=601,n.schwacyrillic=1241,n.schwadieresiscyrillic=1243,n.schwahook=602,n.scircle=9442,n.scircumflex=349,n.scommaaccent=537,n.sdotaccent=7777,n.sdotbelow=7779,n.sdotbelowdotaccent=7785,n.seagullbelowcmb=828,n.second=8243,n.secondtonechinese=714,n.section=167,n.seenarabic=1587,n.seenfinalarabic=65202,n.seeninitialarabic=65203,n.seenmedialarabic=65204,n.segol=1462,n.segol13=1462,n.segol1f=1462,n.segol2c=1462,n.segolhebrew=1462,n.segolnarrowhebrew=1462,n.segolquarterhebrew=1462,n.segoltahebrew=1426,n.segolwidehebrew=1462,n.seharmenian=1405,n.sehiragana=12379,n.sekatakana=12475,n.sekatakanahalfwidth=65406,n.semicolon=59,n.semicolonarabic=1563,n.semicolonmonospace=65307,n.semicolonsmall=65108,n.semivoicedmarkkana=12444,n.semivoicedmarkkanahalfwidth=65439,n.sentisquare=13090,n.sentosquare=13091,n.seven=55,n.sevenarabic=1639,n.sevenbengali=2541,n.sevencircle=9318,n.sevencircleinversesansserif=10128,n.sevendeva=2413,n.seveneighths=8542,n.sevengujarati=2797,n.sevengurmukhi=2669,n.sevenhackarabic=1639,n.sevenhangzhou=12327,n.sevenideographicparen=12838,n.seveninferior=8327,n.sevenmonospace=65303,n.sevenoldstyle=63287,n.sevenparen=9338,n.sevenperiod=9358,n.sevenpersian=1783,n.sevenroman=8566,n.sevensuperior=8311,n.seventeencircle=9328,n.seventeenparen=9348,n.seventeenperiod=9368,n.seventhai=3671,n.sfthyphen=173,n.shaarmenian=1399,n.shabengali=2486,n.shacyrillic=1096,n.shaddaarabic=1617,n.shaddadammaarabic=64609,n.shaddadammatanarabic=64606,n.shaddafathaarabic=64608,n.shaddakasraarabic=64610,n.shaddakasratanarabic=64607,n.shade=9618,n.shadedark=9619,n.shadelight=9617,n.shademedium=9618,n.shadeva=2358,n.shagujarati=2742,n.shagurmukhi=2614,n.shalshelethebrew=1427,n.shbopomofo=12565,n.shchacyrillic=1097,n.sheenarabic=1588,n.sheenfinalarabic=65206,n.sheeninitialarabic=65207,n.sheenmedialarabic=65208,n.sheicoptic=995,n.sheqel=8362,n.sheqelhebrew=8362,n.sheva=1456,n.sheva115=1456,n.sheva15=1456,n.sheva22=1456,n.sheva2e=1456,n.shevahebrew=1456,n.shevanarrowhebrew=1456,n.shevaquarterhebrew=1456,n.shevawidehebrew=1456,n.shhacyrillic=1211,n.shimacoptic=1005,n.shin=1513,n.shindagesh=64329,n.shindageshhebrew=64329,n.shindageshshindot=64300,n.shindageshshindothebrew=64300,n.shindageshsindot=64301,n.shindageshsindothebrew=64301,n.shindothebrew=1473,n.shinhebrew=1513,n.shinshindot=64298,n.shinshindothebrew=64298,n.shinsindot=64299,n.shinsindothebrew=64299,n.shook=642,n.sigma=963,n.sigma1=962,n.sigmafinal=962,n.sigmalunatesymbolgreek=1010,n.sihiragana=12375,n.sikatakana=12471,n.sikatakanahalfwidth=65404,n.siluqhebrew=1469,n.siluqlefthebrew=1469,n.similar=8764,n.sindothebrew=1474,n.siosacirclekorean=12916,n.siosaparenkorean=12820,n.sioscieuckorean=12670,n.sioscirclekorean=12902,n.sioskiyeokkorean=12666,n.sioskorean=12613,n.siosnieunkorean=12667,n.siosparenkorean=12806,n.siospieupkorean=12669,n.siostikeutkorean=12668,n.six=54,n.sixarabic=1638,n.sixbengali=2540,n.sixcircle=9317,n.sixcircleinversesansserif=10127,n.sixdeva=2412,n.sixgujarati=2796,n.sixgurmukhi=2668,n.sixhackarabic=1638,n.sixhangzhou=12326,n.sixideographicparen=12837,n.sixinferior=8326,n.sixmonospace=65302,n.sixoldstyle=63286,n.sixparen=9337,n.sixperiod=9357,n.sixpersian=1782,n.sixroman=8565,n.sixsuperior=8310,n.sixteencircle=9327,n.sixteencurrencydenominatorbengali=2553,n.sixteenparen=9347,n.sixteenperiod=9367,n.sixthai=3670,n.slash=47,n.slashmonospace=65295,n.slong=383,n.slongdotaccent=7835,n.smileface=9786,n.smonospace=65363,n.sofpasuqhebrew=1475,n.softhyphen=173,n.softsigncyrillic=1100,n.sohiragana=12381,n.sokatakana=12477,n.sokatakanahalfwidth=65407,n.soliduslongoverlaycmb=824,n.solidusshortoverlaycmb=823,n.sorusithai=3625,n.sosalathai=3624,n.sosothai=3595,n.sosuathai=3626,n.space=32,n.spacehackarabic=32,n.spade=9824,n.spadesuitblack=9824,n.spadesuitwhite=9828,n.sparen=9390,n.squarebelowcmb=827,n.squarecc=13252,n.squarecm=13213,n.squarediagonalcrosshatchfill=9641,n.squarehorizontalfill=9636,n.squarekg=13199,n.squarekm=13214,n.squarekmcapital=13262,n.squareln=13265,n.squarelog=13266,n.squaremg=13198,n.squaremil=13269,n.squaremm=13212,n.squaremsquared=13217,n.squareorthogonalcrosshatchfill=9638,n.squareupperlefttolowerrightfill=9639,n.squareupperrighttolowerleftfill=9640,n.squareverticalfill=9637,n.squarewhitewithsmallblack=9635,n.srsquare=13275,n.ssabengali=2487,n.ssadeva=2359,n.ssagujarati=2743,n.ssangcieuckorean=12617,n.ssanghieuhkorean=12677,n.ssangieungkorean=12672,n.ssangkiyeokkorean=12594,n.ssangnieunkorean=12645,n.ssangpieupkorean=12611,n.ssangsioskorean=12614,n.ssangtikeutkorean=12600,n.ssuperior=63218,n.sterling=163,n.sterlingmonospace=65505,n.strokelongoverlaycmb=822,n.strokeshortoverlaycmb=821,n.subset=8834,n.subsetnotequal=8842,n.subsetorequal=8838,n.succeeds=8827,n.suchthat=8715,n.suhiragana=12377,n.sukatakana=12473,n.sukatakanahalfwidth=65405,n.sukunarabic=1618,n.summation=8721,n.sun=9788,n.superset=8835,n.supersetnotequal=8843,n.supersetorequal=8839,n.svsquare=13276,n.syouwaerasquare=13180,n.t=116,n.tabengali=2468,n.tackdown=8868,n.tackleft=8867,n.tadeva=2340,n.tagujarati=2724,n.tagurmukhi=2596,n.taharabic=1591,n.tahfinalarabic=65218,n.tahinitialarabic=65219,n.tahiragana=12383,n.tahmedialarabic=65220,n.taisyouerasquare=13181,n.takatakana=12479,n.takatakanahalfwidth=65408,n.tatweelarabic=1600,n.tau=964,n.tav=1514,n.tavdages=64330,n.tavdagesh=64330,n.tavdageshhebrew=64330,n.tavhebrew=1514,n.tbar=359,n.tbopomofo=12554,n.tcaron=357,n.tccurl=680,n.tcedilla=355,n.tcheharabic=1670,n.tchehfinalarabic=64379,n.tchehinitialarabic=64380,n.tchehmedialarabic=64381,n.tcircle=9443,n.tcircumflexbelow=7793,n.tcommaaccent=355,n.tdieresis=7831,n.tdotaccent=7787,n.tdotbelow=7789,n.tecyrillic=1090,n.tedescendercyrillic=1197,n.teharabic=1578,n.tehfinalarabic=65174,n.tehhahinitialarabic=64674,n.tehhahisolatedarabic=64524,n.tehinitialarabic=65175,n.tehiragana=12390,n.tehjeeminitialarabic=64673,n.tehjeemisolatedarabic=64523,n.tehmarbutaarabic=1577,n.tehmarbutafinalarabic=65172,n.tehmedialarabic=65176,n.tehmeeminitialarabic=64676,n.tehmeemisolatedarabic=64526,n.tehnoonfinalarabic=64627,n.tekatakana=12486,n.tekatakanahalfwidth=65411,n.telephone=8481,n.telephoneblack=9742,n.telishagedolahebrew=1440,n.telishaqetanahebrew=1449,n.tencircle=9321,n.tenideographicparen=12841,n.tenparen=9341,n.tenperiod=9361,n.tenroman=8569,n.tesh=679,n.tet=1496,n.tetdagesh=64312,n.tetdageshhebrew=64312,n.tethebrew=1496,n.tetsecyrillic=1205,n.tevirhebrew=1435,n.tevirlefthebrew=1435,n.thabengali=2469,n.thadeva=2341,n.thagujarati=2725,n.thagurmukhi=2597,n.thalarabic=1584,n.thalfinalarabic=65196,n.thanthakhatlowleftthai=63640,n.thanthakhatlowrightthai=63639,n.thanthakhatthai=3660,n.thanthakhatupperleftthai=63638,n.theharabic=1579,n.thehfinalarabic=65178,n.thehinitialarabic=65179,n.thehmedialarabic=65180,n.thereexists=8707,n.therefore=8756,n.theta=952,n.theta1=977,n.thetasymbolgreek=977,n.thieuthacirclekorean=12921,n.thieuthaparenkorean=12825,n.thieuthcirclekorean=12907,n.thieuthkorean=12620,n.thieuthparenkorean=12811,n.thirteencircle=9324,n.thirteenparen=9344,n.thirteenperiod=9364,n.thonangmonthothai=3601,n.thook=429,n.thophuthaothai=3602,n.thorn=254,n.thothahanthai=3607,n.thothanthai=3600,n.thothongthai=3608,n.thothungthai=3606,n.thousandcyrillic=1154,n.thousandsseparatorarabic=1644,n.thousandsseparatorpersian=1644,n.three=51,n.threearabic=1635,n.threebengali=2537,n.threecircle=9314,n.threecircleinversesansserif=10124,n.threedeva=2409,n.threeeighths=8540,n.threegujarati=2793,n.threegurmukhi=2665,n.threehackarabic=1635,n.threehangzhou=12323,n.threeideographicparen=12834,n.threeinferior=8323,n.threemonospace=65299,n.threenumeratorbengali=2550,n.threeoldstyle=63283,n.threeparen=9334,n.threeperiod=9354,n.threepersian=1779,n.threequarters=190,n.threequartersemdash=63198,n.threeroman=8562,n.threesuperior=179,n.threethai=3667,n.thzsquare=13204,n.tihiragana=12385,n.tikatakana=12481,n.tikatakanahalfwidth=65409,n.tikeutacirclekorean=12912,n.tikeutaparenkorean=12816,n.tikeutcirclekorean=12898,n.tikeutkorean=12599,n.tikeutparenkorean=12802,n.tilde=732,n.tildebelowcmb=816,n.tildecmb=771,n.tildecomb=771,n.tildedoublecmb=864,n.tildeoperator=8764,n.tildeoverlaycmb=820,n.tildeverticalcmb=830,n.timescircle=8855,n.tipehahebrew=1430,n.tipehalefthebrew=1430,n.tippigurmukhi=2672,n.titlocyrilliccmb=1155,n.tiwnarmenian=1407,n.tlinebelow=7791,n.tmonospace=65364,n.toarmenian=1385,n.tohiragana=12392,n.tokatakana=12488,n.tokatakanahalfwidth=65412,n.tonebarextrahighmod=741,n.tonebarextralowmod=745,n.tonebarhighmod=742,n.tonebarlowmod=744,n.tonebarmidmod=743,n.tonefive=445,n.tonesix=389,n.tonetwo=424,n.tonos=900,n.tonsquare=13095,n.topatakthai=3599,n.tortoiseshellbracketleft=12308,n.tortoiseshellbracketleftsmall=65117,n.tortoiseshellbracketleftvertical=65081,n.tortoiseshellbracketright=12309,n.tortoiseshellbracketrightsmall=65118,n.tortoiseshellbracketrightvertical=65082,n.totaothai=3605,n.tpalatalhook=427,n.tparen=9391,n.trademark=8482,n.trademarksans=63722,n.trademarkserif=63195,n.tretroflexhook=648,n.triagdn=9660,n.triaglf=9668,n.triagrt=9658,n.triagup=9650,n.ts=678,n.tsadi=1510,n.tsadidagesh=64326,n.tsadidageshhebrew=64326,n.tsadihebrew=1510,n.tsecyrillic=1094,n.tsere=1461,n.tsere12=1461,n.tsere1e=1461,n.tsere2b=1461,n.tserehebrew=1461,n.tserenarrowhebrew=1461,n.tserequarterhebrew=1461,n.tserewidehebrew=1461,n.tshecyrillic=1115,n.tsuperior=63219,n.ttabengali=2463,n.ttadeva=2335,n.ttagujarati=2719,n.ttagurmukhi=2591,n.tteharabic=1657,n.ttehfinalarabic=64359,n.ttehinitialarabic=64360,n.ttehmedialarabic=64361,n.tthabengali=2464,n.tthadeva=2336,n.tthagujarati=2720,n.tthagurmukhi=2592,n.tturned=647,n.tuhiragana=12388,n.tukatakana=12484,n.tukatakanahalfwidth=65410,n.tusmallhiragana=12387,n.tusmallkatakana=12483,n.tusmallkatakanahalfwidth=65391,n.twelvecircle=9323,n.twelveparen=9343,n.twelveperiod=9363,n.twelveroman=8571,n.twentycircle=9331,n.twentyhangzhou=21316,n.twentyparen=9351,n.twentyperiod=9371,n.two=50,n.twoarabic=1634,n.twobengali=2536,n.twocircle=9313,n.twocircleinversesansserif=10123,n.twodeva=2408,n.twodotenleader=8229,n.twodotleader=8229,n.twodotleadervertical=65072,n.twogujarati=2792,n.twogurmukhi=2664,n.twohackarabic=1634,n.twohangzhou=12322,n.twoideographicparen=12833,n.twoinferior=8322,n.twomonospace=65298,n.twonumeratorbengali=2549,n.twooldstyle=63282,n.twoparen=9333,n.twoperiod=9353,n.twopersian=1778,n.tworoman=8561,n.twostroke=443,n.twosuperior=178,n.twothai=3666,n.twothirds=8532,n.u=117,n.uacute=250,n.ubar=649,n.ubengali=2441,n.ubopomofo=12584,n.ubreve=365,n.ucaron=468,n.ucircle=9444,n.ucircumflex=251,n.ucircumflexbelow=7799,n.ucyrillic=1091,n.udattadeva=2385,n.udblacute=369,n.udblgrave=533,n.udeva=2313,n.udieresis=252,n.udieresisacute=472,n.udieresisbelow=7795,n.udieresiscaron=474,n.udieresiscyrillic=1265,n.udieresisgrave=476,n.udieresismacron=470,n.udotbelow=7909,n.ugrave=249,n.ugujarati=2697,n.ugurmukhi=2569,n.uhiragana=12358,n.uhookabove=7911,n.uhorn=432,n.uhornacute=7913,n.uhorndotbelow=7921,n.uhorngrave=7915,n.uhornhookabove=7917,n.uhorntilde=7919,n.uhungarumlaut=369,n.uhungarumlautcyrillic=1267,n.uinvertedbreve=535,n.ukatakana=12454,n.ukatakanahalfwidth=65395,n.ukcyrillic=1145,n.ukorean=12636,n.umacron=363,n.umacroncyrillic=1263,n.umacrondieresis=7803,n.umatragurmukhi=2625,n.umonospace=65365,n.underscore=95,n.underscoredbl=8215,n.underscoremonospace=65343,n.underscorevertical=65075,n.underscorewavy=65103,n.union=8746,n.universal=8704,n.uogonek=371,n.uparen=9392,n.upblock=9600,n.upperdothebrew=1476,n.upsilon=965,n.upsilondieresis=971,n.upsilondieresistonos=944,n.upsilonlatin=650,n.upsilontonos=973,n.uptackbelowcmb=797,n.uptackmod=724,n.uragurmukhi=2675,n.uring=367,n.ushortcyrillic=1118,n.usmallhiragana=12357,n.usmallkatakana=12453,n.usmallkatakanahalfwidth=65385,n.ustraightcyrillic=1199,n.ustraightstrokecyrillic=1201,n.utilde=361,n.utildeacute=7801,n.utildebelow=7797,n.uubengali=2442,n.uudeva=2314,n.uugujarati=2698,n.uugurmukhi=2570,n.uumatragurmukhi=2626,n.uuvowelsignbengali=2498,n.uuvowelsigndeva=2370,n.uuvowelsigngujarati=2754,n.uvowelsignbengali=2497,n.uvowelsigndeva=2369,n.uvowelsigngujarati=2753,n.v=118,n.vadeva=2357,n.vagujarati=2741,n.vagurmukhi=2613,n.vakatakana=12535,n.vav=1493,n.vavdagesh=64309,n.vavdagesh65=64309,n.vavdageshhebrew=64309,n.vavhebrew=1493,n.vavholam=64331,n.vavholamhebrew=64331,n.vavvavhebrew=1520,n.vavyodhebrew=1521,n.vcircle=9445,n.vdotbelow=7807,n.vecyrillic=1074,n.veharabic=1700,n.vehfinalarabic=64363,n.vehinitialarabic=64364,n.vehmedialarabic=64365,n.vekatakana=12537,n.venus=9792,n.verticalbar=124,n.verticallineabovecmb=781,n.verticallinebelowcmb=809,n.verticallinelowmod=716,n.verticallinemod=712,n.vewarmenian=1406,n.vhook=651,n.vikatakana=12536,n.viramabengali=2509,n.viramadeva=2381,n.viramagujarati=2765,n.visargabengali=2435,n.visargadeva=2307,n.visargagujarati=2691,n.vmonospace=65366,n.voarmenian=1400,n.voicediterationhiragana=12446,n.voicediterationkatakana=12542,n.voicedmarkkana=12443,n.voicedmarkkanahalfwidth=65438,n.vokatakana=12538,n.vparen=9393,n.vtilde=7805,n.vturned=652,n.vuhiragana=12436,n.vukatakana=12532,n.w=119,n.wacute=7811,n.waekorean=12633,n.wahiragana=12431,n.wakatakana=12527,n.wakatakanahalfwidth=65436,n.wakorean=12632,n.wasmallhiragana=12430,n.wasmallkatakana=12526,n.wattosquare=13143,n.wavedash=12316,n.wavyunderscorevertical=65076,n.wawarabic=1608,n.wawfinalarabic=65262,n.wawhamzaabovearabic=1572,n.wawhamzaabovefinalarabic=65158,n.wbsquare=13277,n.wcircle=9446,n.wcircumflex=373,n.wdieresis=7813,n.wdotaccent=7815,n.wdotbelow=7817,n.wehiragana=12433,n.weierstrass=8472,n.wekatakana=12529,n.wekorean=12638,n.weokorean=12637,n.wgrave=7809,n.whitebullet=9702,n.whitecircle=9675,n.whitecircleinverse=9689,n.whitecornerbracketleft=12302,n.whitecornerbracketleftvertical=65091,n.whitecornerbracketright=12303,n.whitecornerbracketrightvertical=65092,n.whitediamond=9671,n.whitediamondcontainingblacksmalldiamond=9672,n.whitedownpointingsmalltriangle=9663,n.whitedownpointingtriangle=9661,n.whiteleftpointingsmalltriangle=9667,n.whiteleftpointingtriangle=9665,n.whitelenticularbracketleft=12310,n.whitelenticularbracketright=12311,n.whiterightpointingsmalltriangle=9657,n.whiterightpointingtriangle=9655,n.whitesmallsquare=9643,n.whitesmilingface=9786,n.whitesquare=9633,n.whitestar=9734,n.whitetelephone=9743,n.whitetortoiseshellbracketleft=12312,n.whitetortoiseshellbracketright=12313,n.whiteuppointingsmalltriangle=9653,n.whiteuppointingtriangle=9651,n.wihiragana=12432,n.wikatakana=12528,n.wikorean=12639,n.wmonospace=65367,n.wohiragana=12434,n.wokatakana=12530,n.wokatakanahalfwidth=65382,n.won=8361,n.wonmonospace=65510,n.wowaenthai=3623,n.wparen=9394,n.wring=7832,n.wsuperior=695,n.wturned=653,n.wynn=447,n.x=120,n.xabovecmb=829,n.xbopomofo=12562,n.xcircle=9447,n.xdieresis=7821,n.xdotaccent=7819,n.xeharmenian=1389,n.xi=958,n.xmonospace=65368,n.xparen=9395,n.xsuperior=739,n.y=121,n.yaadosquare=13134,n.yabengali=2479,n.yacute=253,n.yadeva=2351,n.yaekorean=12626,n.yagujarati=2735,n.yagurmukhi=2607,n.yahiragana=12420,n.yakatakana=12516,n.yakatakanahalfwidth=65428,n.yakorean=12625,n.yamakkanthai=3662,n.yasmallhiragana=12419,n.yasmallkatakana=12515,n.yasmallkatakanahalfwidth=65388,n.yatcyrillic=1123,n.ycircle=9448,n.ycircumflex=375,n.ydieresis=255,n.ydotaccent=7823,n.ydotbelow=7925,n.yeharabic=1610,n.yehbarreearabic=1746,n.yehbarreefinalarabic=64431,n.yehfinalarabic=65266,n.yehhamzaabovearabic=1574,n.yehhamzaabovefinalarabic=65162,n.yehhamzaaboveinitialarabic=65163,n.yehhamzaabovemedialarabic=65164,n.yehinitialarabic=65267,n.yehmedialarabic=65268,n.yehmeeminitialarabic=64733,n.yehmeemisolatedarabic=64600,n.yehnoonfinalarabic=64660,n.yehthreedotsbelowarabic=1745,n.yekorean=12630,n.yen=165,n.yenmonospace=65509,n.yeokorean=12629,n.yeorinhieuhkorean=12678,n.yerahbenyomohebrew=1450,n.yerahbenyomolefthebrew=1450,n.yericyrillic=1099,n.yerudieresiscyrillic=1273,n.yesieungkorean=12673,n.yesieungpansioskorean=12675,n.yesieungsioskorean=12674,n.yetivhebrew=1434,n.ygrave=7923,n.yhook=436,n.yhookabove=7927,n.yiarmenian=1397,n.yicyrillic=1111,n.yikorean=12642,n.yinyang=9775,n.yiwnarmenian=1410,n.ymonospace=65369,n.yod=1497,n.yoddagesh=64313,n.yoddageshhebrew=64313,n.yodhebrew=1497,n.yodyodhebrew=1522,n.yodyodpatahhebrew=64287,n.yohiragana=12424,n.yoikorean=12681,n.yokatakana=12520,n.yokatakanahalfwidth=65430,n.yokorean=12635,n.yosmallhiragana=12423,n.yosmallkatakana=12519,n.yosmallkatakanahalfwidth=65390,n.yotgreek=1011,n.yoyaekorean=12680,n.yoyakorean=12679,n.yoyakthai=3618,n.yoyingthai=3597,n.yparen=9396,n.ypogegrammeni=890,n.ypogegrammenigreekcmb=837,n.yr=422,n.yring=7833,n.ysuperior=696,n.ytilde=7929,n.yturned=654,n.yuhiragana=12422,n.yuikorean=12684,n.yukatakana=12518,n.yukatakanahalfwidth=65429,n.yukorean=12640,n.yusbigcyrillic=1131,n.yusbigiotifiedcyrillic=1133,n.yuslittlecyrillic=1127,n.yuslittleiotifiedcyrillic=1129,n.yusmallhiragana=12421,n.yusmallkatakana=12517,n.yusmallkatakanahalfwidth=65389,n.yuyekorean=12683,n.yuyeokorean=12682,n.yyabengali=2527,n.yyadeva=2399,n.z=122,n.zaarmenian=1382,n.zacute=378,n.zadeva=2395,n.zagurmukhi=2651,n.zaharabic=1592,n.zahfinalarabic=65222,n.zahinitialarabic=65223,n.zahiragana=12374,n.zahmedialarabic=65224,n.zainarabic=1586,n.zainfinalarabic=65200,n.zakatakana=12470,n.zaqefgadolhebrew=1429,n.zaqefqatanhebrew=1428,n.zarqahebrew=1432,n.zayin=1494,n.zayindagesh=64310,n.zayindageshhebrew=64310,n.zayinhebrew=1494,n.zbopomofo=12567,n.zcaron=382,n.zcircle=9449,n.zcircumflex=7825,n.zcurl=657,n.zdot=380,n.zdotaccent=380,n.zdotbelow=7827,n.zecyrillic=1079,n.zedescendercyrillic=1177,n.zedieresiscyrillic=1247,n.zehiragana=12380,n.zekatakana=12476,n.zero=48,n.zeroarabic=1632,n.zerobengali=2534,n.zerodeva=2406,n.zerogujarati=2790,n.zerogurmukhi=2662,n.zerohackarabic=1632,n.zeroinferior=8320,n.zeromonospace=65296,n.zerooldstyle=63280,n.zeropersian=1776,n.zerosuperior=8304,n.zerothai=3664,n.zerowidthjoiner=65279,n.zerowidthnonjoiner=8204,n.zerowidthspace=8203,n.zeta=950,n.zhbopomofo=12563,n.zhearmenian=1386,n.zhebrevecyrillic=1218,n.zhecyrillic=1078,n.zhedescendercyrillic=1175,n.zhedieresiscyrillic=1245,n.zihiragana=12376,n.zikatakana=12472,n.zinorhebrew=1454,n.zlinebelow=7829,n.zmonospace=65370,n.zohiragana=12382,n.zokatakana=12478,n.zparen=9397,n.zretroflexhook=656,n.zstroke=438,n.zuhiragana=12378,n.zukatakana=12474,n[".notdef"]=0,n.angbracketleftbig=9001,n.angbracketleftBig=9001,n.angbracketleftbigg=9001,n.angbracketleftBigg=9001,n.angbracketrightBig=9002,n.angbracketrightbig=9002,n.angbracketrightBigg=9002,n.angbracketrightbigg=9002,n.arrowhookleft=8618,n.arrowhookright=8617,n.arrowlefttophalf=8636,n.arrowleftbothalf=8637,n.arrownortheast=8599,n.arrownorthwest=8598,n.arrowrighttophalf=8640,n.arrowrightbothalf=8641,n.arrowsoutheast=8600,n.arrowsouthwest=8601,n.backslashbig=8726,n.backslashBig=8726,n.backslashBigg=8726,n.backslashbigg=8726,n.bardbl=8214,n.bracehtipdownleft=65079,n.bracehtipdownright=65079,n.bracehtipupleft=65080,n.bracehtipupright=65080,n.braceleftBig=123,n.braceleftbig=123,n.braceleftbigg=123,n.braceleftBigg=123,n.bracerightBig=125,n.bracerightbig=125,n.bracerightbigg=125,n.bracerightBigg=125,n.bracketleftbig=91,n.bracketleftBig=91,n.bracketleftbigg=91,n.bracketleftBigg=91,n.bracketrightBig=93,n.bracketrightbig=93,n.bracketrightbigg=93,n.bracketrightBigg=93,n.ceilingleftbig=8968,n.ceilingleftBig=8968,n.ceilingleftBigg=8968,n.ceilingleftbigg=8968,n.ceilingrightbig=8969,n.ceilingrightBig=8969,n.ceilingrightbigg=8969,n.ceilingrightBigg=8969,n.circledotdisplay=8857,n.circledottext=8857,n.circlemultiplydisplay=8855,n.circlemultiplytext=8855,n.circleplusdisplay=8853,n.circleplustext=8853,n.contintegraldisplay=8750,n.contintegraltext=8750,n.coproductdisplay=8720,n.coproducttext=8720,n.floorleftBig=8970,n.floorleftbig=8970,n.floorleftbigg=8970,n.floorleftBigg=8970,n.floorrightbig=8971,n.floorrightBig=8971,n.floorrightBigg=8971,n.floorrightbigg=8971,n.hatwide=770,n.hatwider=770,n.hatwidest=770,n.intercal=7488,n.integraldisplay=8747,n.integraltext=8747,n.intersectiondisplay=8898,n.intersectiontext=8898,n.logicalanddisplay=8743,n.logicalandtext=8743,n.logicalordisplay=8744,n.logicalortext=8744,n.parenleftBig=40,n.parenleftbig=40,n.parenleftBigg=40,n.parenleftbigg=40,n.parenrightBig=41,n.parenrightbig=41,n.parenrightBigg=41,n.parenrightbigg=41,n.prime=8242,n.productdisplay=8719,n.producttext=8719,n.radicalbig=8730,n.radicalBig=8730,n.radicalBigg=8730,n.radicalbigg=8730,n.radicalbt=8730,n.radicaltp=8730,n.radicalvertex=8730,n.slashbig=47,n.slashBig=47,n.slashBigg=47,n.slashbigg=47,n.summationdisplay=8721,n.summationtext=8721,n.tildewide=732,n.tildewider=732,n.tildewidest=732,n.uniondisplay=8899,n.unionmultidisplay=8846,n.unionmultitext=8846,n.unionsqdisplay=8852,n.unionsqtext=8852,n.uniontext=8899,n.vextenddouble=8741,n.vextendsingle=8739}),lz=Si(function(n){n.space=32,n.a1=9985,n.a2=9986,n.a202=9987,n.a3=9988,n.a4=9742,n.a5=9990,n.a119=9991,n.a118=9992,n.a117=9993,n.a11=9755,n.a12=9758,n.a13=9996,n.a14=9997,n.a15=9998,n.a16=9999,n.a105=1e4,n.a17=10001,n.a18=10002,n.a19=10003,n.a20=10004,n.a21=10005,n.a22=10006,n.a23=10007,n.a24=10008,n.a25=10009,n.a26=10010,n.a27=10011,n.a28=10012,n.a6=10013,n.a7=10014,n.a8=10015,n.a9=10016,n.a10=10017,n.a29=10018,n.a30=10019,n.a31=10020,n.a32=10021,n.a33=10022,n.a34=10023,n.a35=9733,n.a36=10025,n.a37=10026,n.a38=10027,n.a39=10028,n.a40=10029,n.a41=10030,n.a42=10031,n.a43=10032,n.a44=10033,n.a45=10034,n.a46=10035,n.a47=10036,n.a48=10037,n.a49=10038,n.a50=10039,n.a51=10040,n.a52=10041,n.a53=10042,n.a54=10043,n.a55=10044,n.a56=10045,n.a57=10046,n.a58=10047,n.a59=10048,n.a60=10049,n.a61=10050,n.a62=10051,n.a63=10052,n.a64=10053,n.a65=10054,n.a66=10055,n.a67=10056,n.a68=10057,n.a69=10058,n.a70=10059,n.a71=9679,n.a72=10061,n.a73=9632,n.a74=10063,n.a203=10064,n.a75=10065,n.a204=10066,n.a76=9650,n.a77=9660,n.a78=9670,n.a79=10070,n.a81=9687,n.a82=10072,n.a83=10073,n.a84=10074,n.a97=10075,n.a98=10076,n.a99=10077,n.a100=10078,n.a101=10081,n.a102=10082,n.a103=10083,n.a104=10084,n.a106=10085,n.a107=10086,n.a108=10087,n.a112=9827,n.a111=9830,n.a110=9829,n.a109=9824,n.a120=9312,n.a121=9313,n.a122=9314,n.a123=9315,n.a124=9316,n.a125=9317,n.a126=9318,n.a127=9319,n.a128=9320,n.a129=9321,n.a130=10102,n.a131=10103,n.a132=10104,n.a133=10105,n.a134=10106,n.a135=10107,n.a136=10108,n.a137=10109,n.a138=10110,n.a139=10111,n.a140=10112,n.a141=10113,n.a142=10114,n.a143=10115,n.a144=10116,n.a145=10117,n.a146=10118,n.a147=10119,n.a148=10120,n.a149=10121,n.a150=10122,n.a151=10123,n.a152=10124,n.a153=10125,n.a154=10126,n.a155=10127,n.a156=10128,n.a157=10129,n.a158=10130,n.a159=10131,n.a160=10132,n.a161=8594,n.a163=8596,n.a164=8597,n.a196=10136,n.a165=10137,n.a192=10138,n.a166=10139,n.a167=10140,n.a168=10141,n.a169=10142,n.a170=10143,n.a171=10144,n.a172=10145,n.a173=10146,n.a162=10147,n.a174=10148,n.a175=10149,n.a176=10150,n.a177=10151,n.a178=10152,n.a179=10153,n.a193=10154,n.a180=10155,n.a199=10156,n.a181=10157,n.a200=10158,n.a182=10159,n.a201=10161,n.a183=10162,n.a184=10163,n.a197=10164,n.a185=10165,n.a194=10166,n.a198=10167,n.a186=10168,n.a195=10169,n.a187=10170,n.a188=10171,n.a189=10172,n.a190=10173,n.a191=10174,n.a89=10088,n.a90=10089,n.a93=10090,n.a94=10091,n.a91=10092,n.a92=10093,n.a205=10094,n.a85=10095,n.a206=10096,n.a86=10097,n.a87=10098,n.a88=10099,n.a95=10100,n.a96=10101,n[".notdef"]=0}),cz=Si(function(n){n[63721]=169,n[63193]=169,n[63720]=174,n[63194]=174,n[63722]=8482,n[63195]=8482,n[63729]=9127,n[63730]=9128,n[63731]=9129,n[63740]=9131,n[63741]=9132,n[63742]=9133,n[63726]=9121,n[63727]=9122,n[63728]=9123,n[63737]=9124,n[63738]=9125,n[63739]=9126,n[63723]=9115,n[63724]=9116,n[63725]=9117,n[63734]=9118,n[63735]=9119,n[63736]=9120});function hz(n){return n>=65520&&n<=65535?0:n>=62976&&n<=63743?cz()[n]||n:n===173?45:n}function Tg(n,e){let t=e[n];if(t!==void 0)return t;if(!n)return-1;if(n[0]==="u"){const i=n.length;let s;if(i===7&&n[1]==="n"&&n[2]==="i")s=n.substring(3);else if(i>=5&&i<=7)s=n.substring(1);else return-1;if(s===s.toUpperCase()&&(t=parseInt(s,16),t>=0))return t}return-1}const yw=[[0,127],[128,255],[256,383],[384,591],[592,687,7424,7551,7552,7615],[688,767,42752,42783],[768,879,7616,7679],[880,1023],[11392,11519],[1024,1279,1280,1327,11744,11775,42560,42655],[1328,1423],[1424,1535],[42240,42559],[1536,1791,1872,1919],[1984,2047],[2304,2431],[2432,2559],[2560,2687],[2688,2815],[2816,2943],[2944,3071],[3072,3199],[3200,3327],[3328,3455],[3584,3711],[3712,3839],[4256,4351,11520,11567],[6912,7039],[4352,4607],[7680,7935,11360,11391,42784,43007],[7936,8191],[8192,8303,11776,11903],[8304,8351],[8352,8399],[8400,8447],[8448,8527],[8528,8591],[8592,8703,10224,10239,10496,10623,11008,11263],[8704,8959,10752,11007,10176,10223,10624,10751],[8960,9215],[9216,9279],[9280,9311],[9312,9471],[9472,9599],[9600,9631],[9632,9727],[9728,9983],[9984,10175],[12288,12351],[12352,12447],[12448,12543,12784,12799],[12544,12591,12704,12735],[12592,12687],[43072,43135],[12800,13055],[13056,13311],[44032,55215],[55296,57343],[67840,67871],[19968,40959,11904,12031,12032,12255,12272,12287,13312,19903,131072,173791,12688,12703],[57344,63743],[12736,12783,63744,64255,194560,195103],[64256,64335],[64336,65023],[65056,65071],[65040,65055],[65104,65135],[65136,65279],[65280,65519],[65520,65535],[3840,4095],[1792,1871],[1920,1983],[3456,3583],[4096,4255],[4608,4991,4992,5023,11648,11743],[5024,5119],[5120,5759],[5760,5791],[5792,5887],[6016,6143],[6144,6319],[10240,10495],[40960,42127],[5888,5919,5920,5951,5952,5983,5984,6015],[66304,66351],[66352,66383],[66560,66639],[118784,119039,119040,119295,119296,119375],[119808,120831],[1044480,1048573],[65024,65039,917760,917999],[917504,917631],[6400,6479],[6480,6527],[6528,6623],[6656,6687],[11264,11359],[11568,11647],[19904,19967],[43008,43055],[65536,65663,65664,65791,65792,65855],[65856,65935],[66432,66463],[66464,66527],[66640,66687],[66688,66735],[67584,67647],[68096,68191],[119552,119647],[73728,74751,74752,74879],[119648,119679],[7040,7103],[7168,7247],[7248,7295],[43136,43231],[43264,43311],[43312,43359],[43520,43615],[65936,65999],[66e3,66047],[66208,66271,66176,66207,67872,67903],[127024,127135,126976,127023]];function uz(n,e=-1){if(e!==-1){const t=yw[e];for(let i=0,s=t.length;i<s;i+=2)if(n>=t[i]&&n<=t[i+1])return e}for(let t=0,i=yw.length;t<i;t++){const s=yw[t];for(let r=0,a=s.length;r<a;r+=2)if(n>=s[r]&&n<=s[r+1])return t}return-1}const dz=new RegExp("^(\\s)|(\\p{Mn})|(\\p{Cf})$","u"),W7=new Map;function fz(n){const e=W7.get(n);if(e)return e;const t=n.match(dz),i={isWhitespace:!!(t!=null&&t[1]),isZeroWidthDiacritic:!!(t!=null&&t[2]),isInvisibleFormatMark:!!(t!=null&&t[3])};return W7.set(n,i),i}function gz(){W7.clear()}const s1=!0,lo={FixedPitch:1,Serif:2,Symbolic:4,Script:8,Nonsymbolic:32,Italic:64,AllCap:65536,SmallCap:131072,ForceBold:262144},hk=[".notdef",".null","nonmarkingreturn","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","nonbreakingspace","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron","Lslash","lslash","Scaron","scaron","Zcaron","zcaron","brokenbar","Eth","eth","Yacute","yacute","Thorn","thorn","minus","multiply","onesuperior","twosuperior","threesuperior","onehalf","onequarter","threequarters","franc","Gbreve","gbreve","Idotaccent","Scedilla","scedilla","Cacute","cacute","Ccaron","ccaron","dcroat"];function BR(n,e){if(e[n]!==void 0)return n;const t=Tg(n,e);if(t!==-1){for(const i in e)if(e[i]===t)return i}return gn("Unable to recover a standard glyph name for: "+n),n}function UR(n,e,t){const i=Object.create(null);let s,r,a;const o=!!(n.flags&lo.Symbolic);if(n.isInternalFont)for(a=e,r=0;r<a.length;r++)s=t.indexOf(a[r]),i[r]=s>=0?s:0;else if(n.baseEncodingName)for(a=jp(n.baseEncodingName),r=0;r<a.length;r++)s=t.indexOf(a[r]),i[r]=s>=0?s:0;else if(o)for(r in e)i[r]=e[r];else for(a=o0,r=0;r<a.length;r++)s=t.indexOf(a[r]),i[r]=s>=0?s:0;const l=n.differences;let c;if(l)for(r in l){const h=l[r];if(s=t.indexOf(h),s===-1){c||(c=Kl());const u=BR(h,c);u!==h&&(s=t.indexOf(u))}i[r]=s>=0?s:0}return i}function dx(n){return n.replaceAll(/[,_]/g,"-").replaceAll(/\s/g,"")}const mz=Si(n=>{n[8211]=65074,n[8212]=65073,n[8229]=65072,n[8230]=65049,n[12289]=65041,n[12290]=65042,n[12296]=65087,n[12297]=65088,n[12298]=65085,n[12299]=65086,n[12300]=65089,n[12301]=65090,n[12302]=65091,n[12303]=65092,n[12304]=65083,n[12305]=65084,n[12308]=65081,n[12309]=65082,n[12310]=65047,n[12311]=65048,n[65103]=65076,n[65281]=65045,n[65288]=65077,n[65289]=65078,n[65292]=65040,n[65306]=65043,n[65307]=65044,n[65311]=65046,n[65339]=65095,n[65341]=65096,n[65343]=65075,n[65371]=65079,n[65373]=65080}),uk=1e3;function pz({data:n,width:e,height:t}){if(e>uk||t>uk)return null;const i=1e3,s=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),r=e+1,a=new Uint8Array(r*(t+1));let o,l,c;const h=e+7&-8,u=new Uint8Array(h*t);let d=0;for(const C of n){let k=128;for(;k>0;)u[d++]=C&k?0:255,k>>=1}let f=0;for(d=0,u[d]!==0&&(a[0]=1,++f),l=1;l<e;l++)u[d]!==u[d+1]&&(a[l]=u[d]?2:1,++f),d++;for(u[d]!==0&&(a[l]=2,++f),o=1;o<t;o++){d=o*h,c=o*r,u[d-h]!==u[d]&&(a[c]=u[d]?1:8,++f);let C=(u[d]?4:0)+(u[d-h]?8:0);for(l=1;l<e;l++)C=(C>>2)+(u[d+1]?4:0)+(u[d-h+1]?8:0),s[C]&&(a[c+l]=s[C],++f),d++;if(u[d-h]!==u[d]&&(a[c+l]=u[d]?2:4,++f),f>i)return null}for(d=h*(t-1),c=o*r,u[d]!==0&&(a[c]=8,++f),l=1;l<e;l++)u[d]!==u[d+1]&&(a[c+l]=u[d]?4:8,++f),d++;if(u[d]!==0&&(a[c+l]=4,++f),f>i)return null;const g=new Int32Array([0,r,-1,0,-r,0,0,0,1]),m=[],{a:x,b:p,c:y,d:w,e:_,f:v}=new DOMMatrix().scaleSelf(1/e,-1/t).translateSelf(0,-t);for(o=0;f&&o<=t;o++){let C=o*r;const k=C+e;for(;C<k&&!a[C];)C++;if(C===k)continue;let I=C%r,S=o;m.push(gs.moveTo,x*I+y*S+_,p*I+w*S+v);const M=C;let N=a[C];do{const F=g[N];do C+=F;while(!a[C]);const H=a[C];H!==5&&H!==10?(N=H,a[C]=0):(N=H&51*N>>4,a[C]&=N>>2|N<<2),I=C%r,S=C/r|0,m.push(gs.lineTo,x*I+y*S+_,p*I+w*S+v),a[C]||--f}while(M!==C);--o}return[ie.rawFillPath,[new Float32Array(m)],new Float32Array([0,0,e,t])]}const bz=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron"],xz=[".notdef","space","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","fi","fl","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"],yz=[".notdef","space","dollaroldstyle","dollarsuperior","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","fi","fl","ffi","ffl","parenleftinferior","parenrightinferior","hyphensuperior","colonmonetary","onefitted","rupiah","centoldstyle","figuredash","hypheninferior","onequarter","onehalf","threequarters","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior"],wz=10,s3=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall","001.000","001.001","001.002","001.003","Black","Bold","Book","Light","Medium","Regular","Roman","Semibold"],Yx=391,mf=[null,{id:"hstem",min:2,stackClearing:!0,stem:!0},null,{id:"vstem",min:2,stackClearing:!0,stem:!0},{id:"vmoveto",min:1,stackClearing:!0},{id:"rlineto",min:2,resetStack:!0},{id:"hlineto",min:1,resetStack:!0},{id:"vlineto",min:1,resetStack:!0},{id:"rrcurveto",min:6,resetStack:!0},null,{id:"callsubr",min:1,undefStack:!0},{id:"return",min:0,undefStack:!0},null,null,{id:"endchar",min:0,stackClearing:!0},null,null,null,{id:"hstemhm",min:2,stackClearing:!0,stem:!0},{id:"hintmask",min:0,stackClearing:!0},{id:"cntrmask",min:0,stackClearing:!0},{id:"rmoveto",min:2,stackClearing:!0},{id:"hmoveto",min:1,stackClearing:!0},{id:"vstemhm",min:2,stackClearing:!0,stem:!0},{id:"rcurveline",min:8,resetStack:!0},{id:"rlinecurve",min:8,resetStack:!0},{id:"vvcurveto",min:4,resetStack:!0},{id:"hhcurveto",min:4,resetStack:!0},null,{id:"callgsubr",min:1,undefStack:!0},{id:"vhcurveto",min:4,resetStack:!0},{id:"hvcurveto",min:4,resetStack:!0}],_z=[null,null,null,{id:"and",min:2,stackDelta:-1},{id:"or",min:2,stackDelta:-1},{id:"not",min:1,stackDelta:0},null,null,null,{id:"abs",min:1,stackDelta:0},{id:"add",min:2,stackDelta:-1,stackFn(n,e){n[e-2]=n[e-2]+n[e-1]}},{id:"sub",min:2,stackDelta:-1,stackFn(n,e){n[e-2]=n[e-2]-n[e-1]}},{id:"div",min:2,stackDelta:-1,stackFn(n,e){n[e-2]=n[e-2]/n[e-1]}},null,{id:"neg",min:1,stackDelta:0,stackFn(n,e){n[e-1]=-n[e-1]}},{id:"eq",min:2,stackDelta:-1},null,null,{id:"drop",min:1,stackDelta:-1},null,{id:"put",min:2,stackDelta:-2},{id:"get",min:1,stackDelta:0},{id:"ifelse",min:4,stackDelta:-3},{id:"random",min:0,stackDelta:1},{id:"mul",min:2,stackDelta:-1,stackFn(n,e){n[e-2]=n[e-2]*n[e-1]}},null,{id:"sqrt",min:1,stackDelta:0},{id:"dup",min:1,stackDelta:1},{id:"exch",min:2,stackDelta:0},{id:"index",min:2,stackDelta:0},{id:"roll",min:3,stackDelta:-2},null,null,null,{id:"hflex",min:7,resetStack:!0},{id:"flex",min:13,resetStack:!0},{id:"hflex1",min:9,resetStack:!0},{id:"flex1",min:11,resetStack:!0}];class I4{constructor(e,t,i){this.bytes=e.getBytes(),this.properties=t,this.seacAnalysisEnabled=!!i}parse(){const e=this.properties,t=new HR;this.cff=t;const i=this.parseHeader(),s=this.parseIndex(i.endPos),r=this.parseIndex(s.endPos),a=this.parseIndex(r.endPos),o=this.parseIndex(a.endPos),l=this.parseDict(r.obj.get(0)),c=this.createDict(Gp,l,t.strings);t.header=i.obj,t.names=this.parseNameIndex(s.obj),t.strings=this.parseStringIndex(a.obj),t.topDict=c,t.globalSubrIndex=o.obj,this.parsePrivateDict(t.topDict),t.isCIDFont=c.hasName("ROS");const h=c.getByName("CharStrings"),u=this.parseIndex(h).obj,d=c.getByName("FontMatrix");d&&(e.fontMatrix=d);const f=c.getByName("FontBBox");f&&(e.ascent=Math.max(f[3],f[1]),e.descent=Math.min(f[1],f[3]),e.ascentScaled=!0);let g,m;if(t.isCIDFont){const p=this.parseIndex(c.getByName("FDArray")).obj;for(let y=0,w=p.count;y<w;++y){const _=p.get(y),v=this.createDict(Gp,this.parseDict(_),t.strings);this.parsePrivateDict(v),t.fdArray.push(v)}m=null,g=this.parseCharsets(c.getByName("charset"),u.count,t.strings,!0),t.fdSelect=this.parseFDSelect(c.getByName("FDSelect"),u.count)}else g=this.parseCharsets(c.getByName("charset"),u.count,t.strings,!1),m=this.parseEncoding(c.getByName("Encoding"),e,t.strings,g.charset);t.charset=g,t.encoding=m;const x=this.parseCharStrings({charStrings:u,localSubrIndex:c.privateDict.subrsIndex,globalSubrIndex:o.obj,fdSelect:t.fdSelect,fdArray:t.fdArray,privateDict:c.privateDict});return t.charStrings=x.charStrings,t.seacs=x.seacs,t.widths=x.widths,t}parseHeader(){let e=this.bytes;const t=e.length;let i=0;for(;i<t&&e[i]!==1;)++i;if(i>=t)throw new Te("Invalid CFF header");i!==0&&(gn("cff data is shifted"),e=e.subarray(i),this.bytes=e);const s=e[0],r=e[1],a=e[2],o=e[3];return{obj:new zR(s,r,a,o),endPos:a}}parseDict(e){let t=0;function i(){let l=e[t++];return l===30?s():l===28?(l=e0(e,t),t+=2,l):l===29?(l=e[t++],l=l<<8|e[t++],l=l<<8|e[t++],l=l<<8|e[t++],l):l>=32&&l<=246?l-139:l>=247&&l<=250?(l-247)*256+e[t++]+108:l>=251&&l<=254?-((l-251)*256)-e[t++]-108:(ce('CFFParser_parseDict: "'+l+'" is a reserved command.'),NaN)}function s(){let l="";const h=["0","1","2","3","4","5","6","7","8","9",".","E","E-",null,"-"],u=e.length;for(;t<u;){const d=e[t++],f=d>>4,g=d&15;if(f===15||(l+=h[f],g===15))break;l+=h[g]}return parseFloat(l)}let r=[];const a=[];t=0;const o=e.length;for(;t<o;){let l=e[t];l<=21?(l===12&&(l=l<<8|e[++t]),a.push([l,r]),r=[],++t):r.push(i())}return a}parseIndex(e){const t=new Ph,i=this.bytes,s=i[e++]<<8|i[e++],r=[];let a=e,o,l;if(s!==0){const c=i[e++],h=e+(s+1)*c-1;for(o=0,l=s+1;o<l;++o){let u=0;for(let d=0;d<c;++d)u<<=8,u+=i[e++];r.push(h+u)}a=r[s]}for(o=0,l=r.length-1;o<l;++o){const c=r[o],h=r[o+1];t.add(i.subarray(c,h))}return{obj:t,endPos:a}}parseNameIndex(e){const t=[];for(let i=0,s=e.count;i<s;++i){const r=e.get(i);t.push(da(r))}return t}parseStringIndex(e){const t=new E4;for(let i=0,s=e.count;i<s;++i){const r=e.get(i);t.add(da(r))}return t}createDict(e,t,i){const s=new e(i);for(const[r,a]of t)s.setByKey(r,a);return s}parseCharString(e,t,i,s){if(!t||e.callDepth>wz)return!1;let r=e.stackSize;const a=e.stack;let o=t.length;for(let l=0;l<o;){const c=t[l++];let h=null;if(c===12){const u=t[l++];u===0?(t[l-2]=139,t[l-1]=22,r=0):h=_z[u]}else if(c===28)a[r]=e0(t,l),l+=2,r++;else if(c===14){if(r>=4&&(r-=4,this.seacAnalysisEnabled))return e.seac=a.slice(r,r+4),!1;h=mf[c]}else if(c>=32&&c<=246)a[r]=c-139,r++;else if(c>=247&&c<=254)a[r]=c<251?(c-247<<8)+t[l]+108:-(c-251<<8)-t[l]-108,l++,r++;else if(c===255)a[r]=(t[l]<<24|t[l+1]<<16|t[l+2]<<8|t[l+3])/65536,l+=4,r++;else if(c===19||c===20){if(e.hints+=r>>1,e.hints===0){t.copyWithin(l-1,l,-1),l-=1,o-=1;continue}l+=e.hints+7>>3,r%=2,h=mf[c]}else if(c===10||c===29){const u=c===10?i:s;if(!u)return h=mf[c],ce("Missing subrsIndex for "+h.id),!1;let d=32768;u.count<1240?d=107:u.count<33900&&(d=1131);const f=a[--r]+d;if(f<0||f>=u.count||isNaN(f))return h=mf[c],ce("Out of bounds subrIndex for "+h.id),!1;if(e.stackSize=r,e.callDepth++,!this.parseCharString(e,u.get(f),i,s))return!1;e.callDepth--,r=e.stackSize;continue}else{if(c===11)return e.stackSize=r,!0;if(c===0&&l===t.length)t[l-1]=14,h=mf[14];else if(c===9){t.copyWithin(l-1,l,-1),l-=1,o-=1;continue}else h=mf[c]}if(h){if(h.stem&&(e.hints+=r>>1,c===3||c===23?e.hasVStems=!0:e.hasVStems&&(c===1||c===18)&&(ce("CFF stem hints are in wrong order"),t[l-1]=c===1?3:23)),"min"in h&&!e.undefStack&&r<h.min)return ce("Not enough parameters for "+h.id+"; actual: "+r+", expected: "+h.min),r===0?(t[l-1]=14,!0):!1;e.firstStackClearing&&h.stackClearing&&(e.firstStackClearing=!1,r-=h.min,r>=2&&h.stem?r%=2:r>1&&ce("Found too many parameters for stack-clearing command"),r>0&&(e.width=a[r-1])),"stackDelta"in h?("stackFn"in h&&h.stackFn(a,r),r+=h.stackDelta):h.stackClearing?r=0:h.resetStack?(r=0,e.undefStack=!1):h.undefStack&&(r=0,e.undefStack=!0,e.firstStackClearing=!1)}}return o<t.length&&t.fill(14,o),e.stackSize=r,!0}parseCharStrings({charStrings:e,localSubrIndex:t,globalSubrIndex:i,fdSelect:s,fdArray:r,privateDict:a}){const o=[],l=[],c=e.count;for(let h=0;h<c;h++){const u=e.get(h),d={callDepth:0,stackSize:0,stack:[],undefStack:!0,hints:0,firstStackClearing:!0,seac:null,width:null,hasVStems:!1};let f=!0,g=null,m=a;if(s&&r.length){const x=s.getFDIndex(h);x===-1&&(ce("Glyph index is not in fd select."),f=!1),x>=r.length&&(ce("Invalid fd index for glyph index."),f=!1),f&&(m=r[x].privateDict,g=m.subrsIndex)}else t&&(g=t);if(f&&(f=this.parseCharString(d,u,g,i)),d.width!==null){const x=m.getByName("nominalWidthX");l[h]=x+d.width}else{const x=m.getByName("defaultWidthX");l[h]=x}d.seac!==null&&(o[h]=d.seac),f||e.set(h,new Uint8Array([14]))}return{charStrings:e,seacs:o,widths:l}}emptyPrivateDictionary(e){const t=this.createDict(Vp,[],e.strings);e.setByKey(18,[0,0]),e.privateDict=t}parsePrivateDict(e){if(!e.hasName("Private")){this.emptyPrivateDictionary(e);return}const t=e.getByName("Private");if(!Array.isArray(t)||t.length!==2){e.removeByName("Private");return}const i=t[0],s=t[1];if(i===0||s>=this.bytes.length){this.emptyPrivateDictionary(e);return}const r=s+i,a=this.bytes.subarray(s,r),o=this.parseDict(a),l=this.createDict(Vp,o,e.strings);if(e.privateDict=l,l.getByName("ExpansionFactor")===0&&l.setByName("ExpansionFactor",.06),!l.getByName("Subrs"))return;const c=l.getByName("Subrs"),h=s+c;if(c===0||h>=this.bytes.length){this.emptyPrivateDictionary(e);return}const u=this.parseIndex(h);l.subrsIndex=u.obj}parseCharsets(e,t,i,s){if(e===0)return new lp(!0,ww.ISO_ADOBE,bz);if(e===1)return new lp(!0,ww.EXPERT,xz);if(e===2)return new lp(!0,ww.EXPERT_SUBSET,yz);const r=this.bytes,a=e,o=r[e++],l=[s?0:".notdef"];let c,h,u;switch(t-=1,o){case 0:for(u=0;u<t;u++)c=r[e++]<<8|r[e++],l.push(s?c:i.get(c));break;case 1:for(;l.length<=t;)for(c=r[e++]<<8|r[e++],h=r[e++],u=0;u<=h;u++)l.push(s?c++:i.get(c++));break;case 2:for(;l.length<=t;)for(c=r[e++]<<8|r[e++],h=r[e++]<<8|r[e++],u=0;u<=h;u++)l.push(s?c++:i.get(c++));break;default:throw new Te("Unknown charset format")}const d=e,f=r.subarray(a,d);return new lp(!1,o,l,f)}parseEncoding(e,t,i,s){const r=Object.create(null),a=this.bytes;let o=!1,l,c,h,u=null;function d(){const f=a[e++];for(c=0;c<f;c++){const g=a[e++],m=(a[e++]<<8)+(a[e++]&255);r[g]=s.indexOf(i.get(m))}}if(e===0||e===1){o=!0,l=e;const f=e?LR:o0;for(c=0,h=s.length;c<h;c++){const g=f.indexOf(s[c]);g!==-1&&(r[g]=c)}}else{const f=e;switch(l=a[e++],l&127){case 0:const m=a[e++];for(c=1;c<=m;c++)r[a[e++]]=c;break;case 1:const x=a[e++];let p=1;for(c=0;c<x;c++){const y=a[e++],w=a[e++];for(let _=y;_<=y+w;_++)r[_]=p++}break;default:throw new Te(`Unknown encoding format: ${l} in CFF`)}const g=e;l&128&&(a[f]&=127,d()),u=a.subarray(f,g)}return l&=127,new Cz(o,l,r,u)}parseFDSelect(e,t){const i=this.bytes,s=i[e++],r=[];let a;switch(s){case 0:for(a=0;a<t;++a){const l=i[e++];r.push(l)}break;case 3:const o=i[e++]<<8|i[e++];for(a=0;a<o;++a){let l=i[e++]<<8|i[e++];a===0&&l!==0&&(ce("parseFDSelect: The first range must have a first GID of 0 -- trying to recover."),l=0);const c=i[e++],h=i[e]<<8|i[e+1];for(let u=l;u<h;++u)r.push(c)}e+=2;break;default:throw new Te(`parseFDSelect: Unknown format "${s}".`)}if(r.length!==t)throw new Te("parseFDSelect: Invalid font data.");return new Az(s,r)}}class HR{constructor(){this.header=null,this.names=[],this.topDict=null,this.strings=new E4,this.globalSubrIndex=null,this.encoding=null,this.charset=null,this.charStrings=null,this.fdArray=[],this.fdSelect=null,this.isCIDFont=!1}duplicateFirstGlyph(){if(this.charStrings.count>=65535){ce("Not enough space in charstrings to duplicate first glyph.");return}const e=this.charStrings.get(0);this.charStrings.add(e),this.isCIDFont&&this.fdSelect.fdSelect.push(this.fdSelect.fdSelect[0])}hasGlyphId(e){return e<0||e>=this.charStrings.count?!1:this.charStrings.get(e).length>0}}class zR{constructor(e,t,i,s){this.major=e,this.minor=t,this.hdrSize=i,this.offSize=s}}class E4{constructor(){this.strings=[]}get(e){return e>=0&&e<=Yx-1?s3[e]:e-Yx<=this.strings.length?this.strings[e-Yx]:s3[0]}getSID(e){let t=s3.indexOf(e);return t!==-1?t:(t=this.strings.indexOf(e),t!==-1?t+Yx:-1)}add(e){this.strings.push(e)}get count(){return this.strings.length}}class Ph{constructor(){this.objects=[],this.length=0}add(e){this.length+=e.length,this.objects.push(e)}set(e,t){this.length+=t.length-this.objects[e].length,this.objects[e]=t}get(e){return this.objects[e]}get count(){return this.objects.length}}class jR{constructor(e,t){this.keyToNameMap=e.keyToNameMap,this.nameToKeyMap=e.nameToKeyMap,this.defaults=e.defaults,this.types=e.types,this.opcodes=e.opcodes,this.order=e.order,this.strings=t,this.values=Object.create(null)}setByKey(e,t){if(!(e in this.keyToNameMap))return!1;if(t.length===0)return!0;for(const s of t)if(isNaN(s))return ce(`Invalid CFFDict value: "${t}" for key "${e}".`),!0;const i=this.types[e];return(i==="num"||i==="sid"||i==="offset")&&(t=t[0]),this.values[e]=t,!0}setByName(e,t){if(!(e in this.nameToKeyMap))throw new Te(`Invalid dictionary name "${e}"`);this.values[this.nameToKeyMap[e]]=t}hasName(e){return this.nameToKeyMap[e]in this.values}getByName(e){if(!(e in this.nameToKeyMap))throw new Te(`Invalid dictionary name ${e}"`);const t=this.nameToKeyMap[e];return t in this.values?this.values[t]:this.defaults[t]}removeByName(e){delete this.values[this.nameToKeyMap[e]]}static createTables(e){const t={keyToNameMap:{},nameToKeyMap:{},defaults:{},types:{},opcodes:{},order:[]};for(const i of e){const s=Array.isArray(i[0])?(i[0][0]<<8)+i[0][1]:i[0];t.keyToNameMap[s]=i[1],t.nameToKeyMap[i[1]]=s,t.types[s]=i[2],t.defaults[s]=i[3],t.opcodes[s]=Array.isArray(i[0])?i[0]:[i[0]],t.order.push(s)}return t}}const vz=[[[12,30],"ROS",["sid","sid","num"],null],[[12,20],"SyntheticBase","num",null],[0,"version","sid",null],[1,"Notice","sid",null],[[12,0],"Copyright","sid",null],[2,"FullName","sid",null],[3,"FamilyName","sid",null],[4,"Weight","sid",null],[[12,1],"isFixedPitch","num",0],[[12,2],"ItalicAngle","num",0],[[12,3],"UnderlinePosition","num",-100],[[12,4],"UnderlineThickness","num",50],[[12,5],"PaintType","num",0],[[12,6],"CharstringType","num",2],[[12,7],"FontMatrix",["num","num","num","num","num","num"],[.001,0,0,.001,0,0]],[13,"UniqueID","num",null],[5,"FontBBox",["num","num","num","num"],[0,0,0,0]],[[12,8],"StrokeWidth","num",0],[14,"XUID","array",null],[15,"charset","offset",0],[16,"Encoding","offset",0],[17,"CharStrings","offset",0],[18,"Private",["offset","offset"],null],[[12,21],"PostScript","sid",null],[[12,22],"BaseFontName","sid",null],[[12,23],"BaseFontBlend","delta",null],[[12,31],"CIDFontVersion","num",0],[[12,32],"CIDFontRevision","num",0],[[12,33],"CIDFontType","num",0],[[12,34],"CIDCount","num",8720],[[12,35],"UIDBase","num",null],[[12,37],"FDSelect","offset",null],[[12,36],"FDArray","offset",null],[[12,38],"FontName","sid",null]];class Gp extends jR{static get tables(){return Ze(this,"tables",this.createTables(vz))}constructor(e){super(Gp.tables,e),this.privateDict=null}}const kz=[[6,"BlueValues","delta",null],[7,"OtherBlues","delta",null],[8,"FamilyBlues","delta",null],[9,"FamilyOtherBlues","delta",null],[[12,9],"BlueScale","num",.039625],[[12,10],"BlueShift","num",7],[[12,11],"BlueFuzz","num",1],[10,"StdHW","num",null],[11,"StdVW","num",null],[[12,12],"StemSnapH","delta",null],[[12,13],"StemSnapV","delta",null],[[12,14],"ForceBold","num",0],[[12,17],"LanguageGroup","num",0],[[12,18],"ExpansionFactor","num",.06],[[12,19],"initialRandomSeed","num",0],[20,"defaultWidthX","num",0],[21,"nominalWidthX","num",0],[19,"Subrs","offset",null]];class Vp extends jR{static get tables(){return Ze(this,"tables",this.createTables(kz))}constructor(e){super(Vp.tables,e),this.subrsIndex=null}}const ww={ISO_ADOBE:0,EXPERT:1,EXPERT_SUBSET:2};class lp{constructor(e,t,i,s){this.predefined=e,this.format=t,this.charset=i,this.raw=s}}class Cz{constructor(e,t,i,s){this.predefined=e,this.format=t,this.encoding=i,this.raw=s}}class Az{constructor(e,t){this.format=e,this.fdSelect=t}getFDIndex(e){return e<0||e>=this.fdSelect.length?-1:this.fdSelect[e]}}class dk{constructor(){this.offsets=Object.create(null)}isTracking(e){return e in this.offsets}track(e,t){if(e in this.offsets)throw new Te(`Already tracking location of ${e}`);this.offsets[e]=t}offset(e){for(const t in this.offsets)this.offsets[t]+=e}setEntryLocation(e,t,i){if(!(e in this.offsets))throw new Te(`Not tracking location of ${e}`);const s=i.data,r=this.offsets[e],a=5;for(let o=0,l=t.length;o<l;++o){const c=o*a+r,h=c+1,u=c+2,d=c+3,f=c+4;if(s[c]!==29||s[h]!==0||s[u]!==0||s[d]!==0||s[f]!==0)throw new Te("writing to an offset that is not empty");const g=t[o];s[c]=29,s[h]=g>>24&255,s[u]=g>>16&255,s[d]=g>>8&255,s[f]=g&255}}}class fx{constructor(e){this.cff=e}compile(){const e=this.cff,t={data:[],length:0,add(d){try{this.data.push(...d)}catch{this.data=this.data.concat(d)}this.length=this.data.length}},i=this.compileHeader(e.header);t.add(i);const s=this.compileNameIndex(e.names);if(t.add(s),e.isCIDFont&&e.topDict.hasName("FontMatrix")){const d=e.topDict.getByName("FontMatrix");e.topDict.removeByName("FontMatrix");for(const f of e.fdArray){let g=d.slice(0);f.hasName("FontMatrix")&&(g=Dn.transform(g,f.getByName("FontMatrix"))),f.setByName("FontMatrix",g)}}const r=e.topDict.getByName("XUID");(r==null?void 0:r.length)>16&&e.topDict.removeByName("XUID"),e.topDict.setByName("charset",0);let a=this.compileTopDicts([e.topDict],t.length,e.isCIDFont);t.add(a.output);const o=a.trackers[0],l=this.compileStringIndex(e.strings.strings);t.add(l);const c=this.compileIndex(e.globalSubrIndex);if(t.add(c),e.encoding&&e.topDict.hasName("Encoding"))if(e.encoding.predefined)o.setEntryLocation("Encoding",[e.encoding.format],t);else{const d=this.compileEncoding(e.encoding);o.setEntryLocation("Encoding",[t.length],t),t.add(d)}const h=this.compileCharset(e.charset,e.charStrings.count,e.strings,e.isCIDFont);o.setEntryLocation("charset",[t.length],t),t.add(h);const u=this.compileCharStrings(e.charStrings);if(o.setEntryLocation("CharStrings",[t.length],t),t.add(u),e.isCIDFont){o.setEntryLocation("FDSelect",[t.length],t);const d=this.compileFDSelect(e.fdSelect);t.add(d),a=this.compileTopDicts(e.fdArray,t.length,!0),o.setEntryLocation("FDArray",[t.length],t),t.add(a.output);const f=a.trackers;this.compilePrivateDicts(e.fdArray,f,t)}return this.compilePrivateDicts([e.topDict],[o],t),t.add([0]),t.data}encodeNumber(e){return Number.isInteger(e)?this.encodeInteger(e):this.encodeFloat(e)}static get EncodeFloatRegExp(){return Ze(this,"EncodeFloatRegExp",/\.(\d*?)(?:9{5,20}|0{5,20})\d{0,2}(?:e(.+)|$)/)}encodeFloat(e){let t=e.toString();const i=fx.EncodeFloatRegExp.exec(t);if(i){const l=parseFloat("1e"+((i[2]?+i[2]:0)+i[1].length));t=(Math.round(e*l)/l).toString()}let s="",r,a;for(r=0,a=t.length;r<a;++r){const l=t[r];l==="e"?s+=t[++r]==="-"?"c":"b":l==="."?s+="a":l==="-"?s+="e":s+=l}s+=s.length&1?"f":"ff";const o=[30];for(r=0,a=s.length;r<a;r+=2)o.push(parseInt(s.substring(r,r+2),16));return o}encodeInteger(e){let t;return e>=-107&&e<=107?t=[e+139]:e>=108&&e<=1131?(e-=108,t=[(e>>8)+247,e&255]):e>=-1131&&e<=-108?(e=-e-108,t=[(e>>8)+251,e&255]):e>=-32768&&e<=32767?t=[28,e>>8&255,e&255]:t=[29,e>>24&255,e>>16&255,e>>8&255,e&255],t}compileHeader(e){return[e.major,e.minor,4,e.offSize]}compileNameIndex(e){const t=new Ph;for(const i of e){const s=Math.min(i.length,127);let r=new Array(s);for(let a=0;a<s;a++){let o=i[a];(o<"!"||o>"~"||o==="["||o==="]"||o==="("||o===")"||o==="{"||o==="}"||o==="<"||o===">"||o==="/"||o==="%")&&(o="_"),r[a]=o}r=r.join(""),r===""&&(r="Bad_Font_Name"),t.add(cr(r))}return this.compileIndex(t)}compileTopDicts(e,t,i){const s=[];let r=new Ph;for(const a of e){i&&(a.removeByName("CIDFontVersion"),a.removeByName("CIDFontRevision"),a.removeByName("CIDFontType"),a.removeByName("CIDCount"),a.removeByName("UIDBase"));const o=new dk,l=this.compileDict(a,o);s.push(o),r.add(l),o.offset(t)}return r=this.compileIndex(r,s),{trackers:s,output:r}}compilePrivateDicts(e,t,i){for(let s=0,r=e.length;s<r;++s){const a=e[s],o=a.privateDict;if(!o||!a.hasName("Private"))throw new Te("There must be a private dictionary.");const l=new dk,c=this.compileDict(o,l);let h=i.length;if(l.offset(h),c.length||(h=0),t[s].setEntryLocation("Private",[c.length,h],i),i.add(c),o.subrsIndex&&o.hasName("Subrs")){const u=this.compileIndex(o.subrsIndex);l.setEntryLocation("Subrs",[c.length],i),i.add(u)}}}compileDict(e,t){const i=[];for(const s of e.order){if(!(s in e.values))continue;let r=e.values[s],a=e.types[s];if(Array.isArray(a)||(a=[a]),Array.isArray(r)||(r=[r]),r.length!==0){for(let o=0,l=a.length;o<l;++o){const c=a[o],h=r[o];switch(c){case"num":case"sid":i.push(...this.encodeNumber(h));break;case"offset":const u=e.keyToNameMap[s];t.isTracking(u)||t.track(u,i.length),i.push(29,0,0,0,0);break;case"array":case"delta":i.push(...this.encodeNumber(h));for(let d=1,f=r.length;d<f;++d)i.push(...this.encodeNumber(r[d]));break;default:throw new Te(`Unknown data type of ${c}`)}}i.push(...e.opcodes[s])}}return i}compileStringIndex(e){const t=new Ph;for(const i of e)t.add(cr(i));return this.compileIndex(t)}compileCharStrings(e){const t=new Ph;for(let i=0;i<e.count;i++){const s=e.get(i);if(s.length===0){t.add(new Uint8Array([139,14]));continue}t.add(s)}return this.compileIndex(t)}compileCharset(e,t,i,s){let r;const a=t-1;if(s){const o=a-1;r=new Uint8Array([2,0,1,o>>8&255,o&255])}else{const o=1+a*2;r=new Uint8Array(o),r[0]=0;let l=0;const c=e.charset.length;let h=!1;for(let u=1;u<r.length;u+=2){let d=0;if(l<c){const f=e.charset[l++];d=i.getSID(f),d===-1&&(d=0,h||(h=!0,ce(`Couldn't find ${f} in CFF strings`)))}r[u]=d>>8&255,r[u+1]=d&255}}return this.compileTypedArray(r)}compileEncoding(e){return this.compileTypedArray(e.raw)}compileFDSelect(e){const t=e.format;let i,s;switch(t){case 0:for(i=new Uint8Array(1+e.fdSelect.length),i[0]=t,s=0;s<e.fdSelect.length;s++)i[s+1]=e.fdSelect[s];break;case 3:const r=0;let a=e.fdSelect[0];const o=[t,0,0,r>>8&255,r&255,a];for(s=1;s<e.fdSelect.length;s++){const c=e.fdSelect[s];c!==a&&(o.push(s>>8&255,s&255,c),a=c)}const l=(o.length-3)/3;o[1]=l>>8&255,o[2]=l&255,o.push(s>>8&255,s&255),i=new Uint8Array(o);break}return this.compileTypedArray(i)}compileTypedArray(e){return Array.from(e)}compileIndex(e,t=[]){const i=e.objects,s=i.length;if(s===0)return[0,0];const r=[s>>8&255,s&255];let a=1,o;for(o=0;o<s;++o)a+=i[o].length;let l;a<256?l=1:a<65536?l=2:a<16777216?l=3:l=4,r.push(l);let c=1;for(o=0;o<s+1;o++)l===1?r.push(c&255):l===2?r.push(c>>8&255,c&255):l===3?r.push(c>>16&255,c>>8&255,c&255):r.push(c>>>24&255,c>>16&255,c>>8&255,c&255),i[o]&&(c+=i[o].length);for(o=0;o<s;o++)t[o]&&t[o].offset(r.length),r.push(...i[o]);return r}}const iy=Si(function(n){n["Times-Roman"]="Times-Roman",n.Helvetica="Helvetica",n.Courier="Courier",n.Symbol="Symbol",n["Times-Bold"]="Times-Bold",n["Helvetica-Bold"]="Helvetica-Bold",n["Courier-Bold"]="Courier-Bold",n.ZapfDingbats="ZapfDingbats",n["Times-Italic"]="Times-Italic",n["Helvetica-Oblique"]="Helvetica-Oblique",n["Courier-Oblique"]="Courier-Oblique",n["Times-BoldItalic"]="Times-BoldItalic",n["Helvetica-BoldOblique"]="Helvetica-BoldOblique",n["Courier-BoldOblique"]="Courier-BoldOblique",n.ArialNarrow="Helvetica",n["ArialNarrow-Bold"]="Helvetica-Bold",n["ArialNarrow-BoldItalic"]="Helvetica-BoldOblique",n["ArialNarrow-Italic"]="Helvetica-Oblique",n.ArialBlack="Helvetica",n["ArialBlack-Bold"]="Helvetica-Bold",n["ArialBlack-BoldItalic"]="Helvetica-BoldOblique",n["ArialBlack-Italic"]="Helvetica-Oblique",n["Arial-Black"]="Helvetica",n["Arial-Black-Bold"]="Helvetica-Bold",n["Arial-Black-BoldItalic"]="Helvetica-BoldOblique",n["Arial-Black-Italic"]="Helvetica-Oblique",n.Arial="Helvetica",n["Arial-Bold"]="Helvetica-Bold",n["Arial-BoldItalic"]="Helvetica-BoldOblique",n["Arial-Italic"]="Helvetica-Oblique",n.ArialMT="Helvetica",n["Arial-BoldItalicMT"]="Helvetica-BoldOblique",n["Arial-BoldMT"]="Helvetica-Bold",n["Arial-ItalicMT"]="Helvetica-Oblique",n["Arial-BoldItalicMT-BoldItalic"]="Helvetica-BoldOblique",n["Arial-BoldMT-Bold"]="Helvetica-Bold",n["Arial-ItalicMT-Italic"]="Helvetica-Oblique",n.ArialUnicodeMS="Helvetica",n["ArialUnicodeMS-Bold"]="Helvetica-Bold",n["ArialUnicodeMS-BoldItalic"]="Helvetica-BoldOblique",n["ArialUnicodeMS-Italic"]="Helvetica-Oblique",n["Courier-BoldItalic"]="Courier-BoldOblique",n["Courier-Italic"]="Courier-Oblique",n.CourierNew="Courier",n["CourierNew-Bold"]="Courier-Bold",n["CourierNew-BoldItalic"]="Courier-BoldOblique",n["CourierNew-Italic"]="Courier-Oblique",n["CourierNewPS-BoldItalicMT"]="Courier-BoldOblique",n["CourierNewPS-BoldMT"]="Courier-Bold",n["CourierNewPS-ItalicMT"]="Courier-Oblique",n.CourierNewPSMT="Courier",n["Helvetica-BoldItalic"]="Helvetica-BoldOblique",n["Helvetica-Italic"]="Helvetica-Oblique",n["HelveticaLTStd-Bold"]="Helvetica-Bold",n["Symbol-Bold"]="Symbol",n["Symbol-BoldItalic"]="Symbol",n["Symbol-Italic"]="Symbol",n.TimesNewRoman="Times-Roman",n["TimesNewRoman-Bold"]="Times-Bold",n["TimesNewRoman-BoldItalic"]="Times-BoldItalic",n["TimesNewRoman-Italic"]="Times-Italic",n.TimesNewRomanPS="Times-Roman",n["TimesNewRomanPS-Bold"]="Times-Bold",n["TimesNewRomanPS-BoldItalic"]="Times-BoldItalic",n["TimesNewRomanPS-BoldItalicMT"]="Times-BoldItalic",n["TimesNewRomanPS-BoldMT"]="Times-Bold",n["TimesNewRomanPS-Italic"]="Times-Italic",n["TimesNewRomanPS-ItalicMT"]="Times-Italic",n.TimesNewRomanPSMT="Times-Roman",n["TimesNewRomanPSMT-Bold"]="Times-Bold",n["TimesNewRomanPSMT-BoldItalic"]="Times-BoldItalic",n["TimesNewRomanPSMT-Italic"]="Times-Italic"}),Sz=Si(function(n){n.Courier="FoxitFixed.pfb",n["Courier-Bold"]="FoxitFixedBold.pfb",n["Courier-BoldOblique"]="FoxitFixedBoldItalic.pfb",n["Courier-Oblique"]="FoxitFixedItalic.pfb",n.Helvetica="LiberationSans-Regular.ttf",n["Helvetica-Bold"]="LiberationSans-Bold.ttf",n["Helvetica-BoldOblique"]="LiberationSans-BoldItalic.ttf",n["Helvetica-Oblique"]="LiberationSans-Italic.ttf",n["Times-Roman"]="FoxitSerif.pfb",n["Times-Bold"]="FoxitSerifBold.pfb",n["Times-BoldItalic"]="FoxitSerifBoldItalic.pfb",n["Times-Italic"]="FoxitSerifItalic.pfb",n.Symbol="FoxitSymbol.pfb",n.ZapfDingbats="FoxitDingbats.pfb",n["LiberationSans-Regular"]="LiberationSans-Regular.ttf",n["LiberationSans-Bold"]="LiberationSans-Bold.ttf",n["LiberationSans-Italic"]="LiberationSans-Italic.ttf",n["LiberationSans-BoldItalic"]="LiberationSans-BoldItalic.ttf"}),GR=Si(function(n){n.Calibri="Helvetica",n["Calibri-Bold"]="Helvetica-Bold",n["Calibri-BoldItalic"]="Helvetica-BoldOblique",n["Calibri-Italic"]="Helvetica-Oblique",n.CenturyGothic="Helvetica",n["CenturyGothic-Bold"]="Helvetica-Bold",n["CenturyGothic-BoldItalic"]="Helvetica-BoldOblique",n["CenturyGothic-Italic"]="Helvetica-Oblique",n.ComicSansMS="Comic Sans MS",n["ComicSansMS-Bold"]="Comic Sans MS-Bold",n["ComicSansMS-BoldItalic"]="Comic Sans MS-BoldItalic",n["ComicSansMS-Italic"]="Comic Sans MS-Italic",n.GillSansMT="Helvetica",n["GillSansMT-Bold"]="Helvetica-Bold",n["GillSansMT-BoldItalic"]="Helvetica-BoldOblique",n["GillSansMT-Italic"]="Helvetica-Oblique",n.Impact="Helvetica",n["ItcSymbol-Bold"]="Helvetica-Bold",n["ItcSymbol-BoldItalic"]="Helvetica-BoldOblique",n["ItcSymbol-Book"]="Helvetica",n["ItcSymbol-BookItalic"]="Helvetica-Oblique",n["ItcSymbol-Medium"]="Helvetica",n["ItcSymbol-MediumItalic"]="Helvetica-Oblique",n.LucidaConsole="Courier",n["LucidaConsole-Bold"]="Courier-Bold",n["LucidaConsole-BoldItalic"]="Courier-BoldOblique",n["LucidaConsole-Italic"]="Courier-Oblique",n["LucidaSans-Demi"]="Helvetica-Bold",n["MS-Gothic"]="MS Gothic",n["MS-Gothic-Bold"]="MS Gothic-Bold",n["MS-Gothic-BoldItalic"]="MS Gothic-BoldItalic",n["MS-Gothic-Italic"]="MS Gothic-Italic",n["MS-Mincho"]="MS Mincho",n["MS-Mincho-Bold"]="MS Mincho-Bold",n["MS-Mincho-BoldItalic"]="MS Mincho-BoldItalic",n["MS-Mincho-Italic"]="MS Mincho-Italic",n["MS-PGothic"]="MS PGothic",n["MS-PGothic-Bold"]="MS PGothic-Bold",n["MS-PGothic-BoldItalic"]="MS PGothic-BoldItalic",n["MS-PGothic-Italic"]="MS PGothic-Italic",n["MS-PMincho"]="MS PMincho",n["MS-PMincho-Bold"]="MS PMincho-Bold",n["MS-PMincho-BoldItalic"]="MS PMincho-BoldItalic",n["MS-PMincho-Italic"]="MS PMincho-Italic",n.NuptialScript="Times-Italic",n.SegoeUISymbol="Helvetica"}),T4=Si(function(n){n["Adobe Jenson"]=!0,n["Adobe Text"]=!0,n.Albertus=!0,n.Aldus=!0,n.Alexandria=!0,n.Algerian=!0,n["American Typewriter"]=!0,n.Antiqua=!0,n.Apex=!0,n.Arno=!0,n.Aster=!0,n.Aurora=!0,n.Baskerville=!0,n.Bell=!0,n.Bembo=!0,n["Bembo Schoolbook"]=!0,n.Benguiat=!0,n["Berkeley Old Style"]=!0,n["Bernhard Modern"]=!0,n["Berthold City"]=!0,n.Bodoni=!0,n["Bauer Bodoni"]=!0,n["Book Antiqua"]=!0,n.Bookman=!0,n["Bordeaux Roman"]=!0,n["Californian FB"]=!0,n.Calisto=!0,n.Calvert=!0,n.Capitals=!0,n.Cambria=!0,n.Cartier=!0,n.Caslon=!0,n.Catull=!0,n.Centaur=!0,n["Century Old Style"]=!0,n["Century Schoolbook"]=!0,n.Chaparral=!0,n["Charis SIL"]=!0,n.Cheltenham=!0,n["Cholla Slab"]=!0,n.Clarendon=!0,n.Clearface=!0,n.Cochin=!0,n.Colonna=!0,n["Computer Modern"]=!0,n["Concrete Roman"]=!0,n.Constantia=!0,n["Cooper Black"]=!0,n.Corona=!0,n.Ecotype=!0,n.Egyptienne=!0,n.Elephant=!0,n.Excelsior=!0,n.Fairfield=!0,n["FF Scala"]=!0,n.Folkard=!0,n.Footlight=!0,n.FreeSerif=!0,n["Friz Quadrata"]=!0,n.Garamond=!0,n.Gentium=!0,n.Georgia=!0,n.Gloucester=!0,n["Goudy Old Style"]=!0,n["Goudy Schoolbook"]=!0,n["Goudy Pro Font"]=!0,n.Granjon=!0,n["Guardian Egyptian"]=!0,n.Heather=!0,n.Hercules=!0,n["High Tower Text"]=!0,n.Hiroshige=!0,n["Hoefler Text"]=!0,n["Humana Serif"]=!0,n.Imprint=!0,n["Ionic No. 5"]=!0,n.Janson=!0,n.Joanna=!0,n.Korinna=!0,n.Lexicon=!0,n.LiberationSerif=!0,n["Liberation Serif"]=!0,n["Linux Libertine"]=!0,n.Literaturnaya=!0,n.Lucida=!0,n["Lucida Bright"]=!0,n.Melior=!0,n.Memphis=!0,n.Miller=!0,n.Minion=!0,n.Modern=!0,n["Mona Lisa"]=!0,n["Mrs Eaves"]=!0,n["MS Serif"]=!0,n["Museo Slab"]=!0,n["New York"]=!0,n["Nimbus Roman"]=!0,n["NPS Rawlinson Roadway"]=!0,n.NuptialScript=!0,n.Palatino=!0,n.Perpetua=!0,n.Plantin=!0,n["Plantin Schoolbook"]=!0,n.Playbill=!0,n["Poor Richard"]=!0,n["Rawlinson Roadway"]=!0,n.Renault=!0,n.Requiem=!0,n.Rockwell=!0,n.Roman=!0,n["Rotis Serif"]=!0,n.Sabon=!0,n.Scala=!0,n.Seagull=!0,n.Sistina=!0,n.Souvenir=!0,n.STIX=!0,n["Stone Informal"]=!0,n["Stone Serif"]=!0,n.Sylfaen=!0,n.Times=!0,n.Trajan=!0,n.Trinité=!0,n["Trump Mediaeval"]=!0,n.Utopia=!0,n["Vale Type"]=!0,n["Bitstream Vera"]=!0,n["Vera Serif"]=!0,n.Versailles=!0,n.Wanted=!0,n.Weiss=!0,n["Wide Latin"]=!0,n.Windsor=!0,n.XITS=!0}),K7=Si(function(n){n.Dingbats=!0,n.Symbol=!0,n.ZapfDingbats=!0,n.Wingdings=!0,n["Wingdings-Bold"]=!0,n["Wingdings-Regular"]=!0}),fk=Si(function(n){n[2]=10,n[3]=32,n[4]=33,n[5]=34,n[6]=35,n[7]=36,n[8]=37,n[9]=38,n[10]=39,n[11]=40,n[12]=41,n[13]=42,n[14]=43,n[15]=44,n[16]=45,n[17]=46,n[18]=47,n[19]=48,n[20]=49,n[21]=50,n[22]=51,n[23]=52,n[24]=53,n[25]=54,n[26]=55,n[27]=56,n[28]=57,n[29]=58,n[30]=894,n[31]=60,n[32]=61,n[33]=62,n[34]=63,n[35]=64,n[36]=65,n[37]=66,n[38]=67,n[39]=68,n[40]=69,n[41]=70,n[42]=71,n[43]=72,n[44]=73,n[45]=74,n[46]=75,n[47]=76,n[48]=77,n[49]=78,n[50]=79,n[51]=80,n[52]=81,n[53]=82,n[54]=83,n[55]=84,n[56]=85,n[57]=86,n[58]=87,n[59]=88,n[60]=89,n[61]=90,n[62]=91,n[63]=92,n[64]=93,n[65]=94,n[66]=95,n[67]=96,n[68]=97,n[69]=98,n[70]=99,n[71]=100,n[72]=101,n[73]=102,n[74]=103,n[75]=104,n[76]=105,n[77]=106,n[78]=107,n[79]=108,n[80]=109,n[81]=110,n[82]=111,n[83]=112,n[84]=113,n[85]=114,n[86]=115,n[87]=116,n[88]=117,n[89]=118,n[90]=119,n[91]=120,n[92]=121,n[93]=122,n[94]=123,n[95]=124,n[96]=125,n[97]=126,n[98]=196,n[99]=197,n[100]=199,n[101]=201,n[102]=209,n[103]=214,n[104]=220,n[105]=225,n[106]=224,n[107]=226,n[108]=228,n[109]=227,n[110]=229,n[111]=231,n[112]=233,n[113]=232,n[114]=234,n[115]=235,n[116]=237,n[117]=236,n[118]=238,n[119]=239,n[120]=241,n[121]=243,n[122]=242,n[123]=244,n[124]=246,n[125]=245,n[126]=250,n[127]=249,n[128]=251,n[129]=252,n[130]=8224,n[131]=176,n[132]=162,n[133]=163,n[134]=167,n[135]=8226,n[136]=182,n[137]=223,n[138]=174,n[139]=169,n[140]=8482,n[141]=180,n[142]=168,n[143]=8800,n[144]=198,n[145]=216,n[146]=8734,n[147]=177,n[148]=8804,n[149]=8805,n[150]=165,n[151]=181,n[152]=8706,n[153]=8721,n[154]=8719,n[156]=8747,n[157]=170,n[158]=186,n[159]=8486,n[160]=230,n[161]=248,n[162]=191,n[163]=161,n[164]=172,n[165]=8730,n[166]=402,n[167]=8776,n[168]=8710,n[169]=171,n[170]=187,n[171]=8230,n[179]=8220,n[180]=8221,n[181]=8216,n[182]=8217,n[200]=193,n[203]=205,n[207]=211,n[210]=218,n[223]=711,n[224]=321,n[225]=322,n[226]=352,n[227]=353,n[228]=381,n[229]=382,n[233]=221,n[234]=253,n[252]=263,n[253]=268,n[254]=269,n[258]=258,n[260]=260,n[261]=261,n[265]=280,n[266]=281,n[267]=282,n[268]=283,n[269]=313,n[275]=323,n[276]=324,n[278]=328,n[283]=344,n[284]=345,n[285]=346,n[286]=347,n[292]=367,n[295]=377,n[296]=378,n[298]=380,n[305]=963,n[306]=964,n[307]=966,n[308]=8215,n[309]=8252,n[310]=8319,n[311]=8359,n[312]=8592,n[313]=8593,n[337]=9552,n[493]=1039,n[494]=1040,n[570]=1040,n[571]=1041,n[572]=1042,n[573]=1043,n[574]=1044,n[575]=1045,n[576]=1046,n[577]=1047,n[578]=1048,n[579]=1049,n[580]=1050,n[581]=1051,n[582]=1052,n[583]=1053,n[584]=1054,n[585]=1055,n[586]=1056,n[587]=1057,n[588]=1058,n[589]=1059,n[590]=1060,n[591]=1061,n[592]=1062,n[593]=1063,n[594]=1064,n[595]=1065,n[596]=1066,n[597]=1067,n[598]=1068,n[599]=1069,n[600]=1070,n[672]=1488,n[673]=1489,n[674]=1490,n[675]=1491,n[676]=1492,n[677]=1493,n[678]=1494,n[679]=1495,n[680]=1496,n[681]=1497,n[682]=1498,n[683]=1499,n[684]=1500,n[685]=1501,n[686]=1502,n[687]=1503,n[688]=1504,n[689]=1505,n[690]=1506,n[691]=1507,n[692]=1508,n[693]=1509,n[694]=1510,n[695]=1511,n[696]=1512,n[697]=1513,n[698]=1514,n[705]=1524,n[706]=8362,n[710]=64288,n[711]=64298,n[759]=1617,n[761]=1776,n[763]=1778,n[775]=1652,n[777]=1764,n[778]=1780,n[779]=1781,n[780]=1782,n[782]=771,n[783]=64726,n[786]=8363,n[788]=8532,n[790]=768,n[791]=769,n[792]=768,n[795]=803,n[797]=64336,n[798]=64337,n[799]=64342,n[800]=64343,n[801]=64344,n[802]=64345,n[803]=64362,n[804]=64363,n[805]=64364,n[2424]=7821,n[2425]=7822,n[2426]=7823,n[2427]=7824,n[2428]=7825,n[2429]=7826,n[2430]=7827,n[2433]=7682,n[2678]=8045,n[2679]=8046,n[2830]=1552,n[2838]=686,n[2840]=751,n[2842]=753,n[2843]=754,n[2844]=755,n[2846]=757,n[2856]=767,n[2857]=848,n[2858]=849,n[2862]=853,n[2863]=854,n[2864]=855,n[2865]=861,n[2866]=862,n[2906]=7460,n[2908]=7462,n[2909]=7463,n[2910]=7464,n[2912]=7466,n[2913]=7467,n[2914]=7468,n[2916]=7470,n[2917]=7471,n[2918]=7472,n[2920]=7474,n[2921]=7475,n[2922]=7476,n[2924]=7478,n[2925]=7479,n[2926]=7480,n[2928]=7482,n[2929]=7483,n[2930]=7484,n[2932]=7486,n[2933]=7487,n[2934]=7488,n[2936]=7490,n[2937]=7491,n[2938]=7492,n[2940]=7494,n[2941]=7495,n[2942]=7496,n[2944]=7498,n[2946]=7500,n[2948]=7502,n[2950]=7504,n[2951]=7505,n[2952]=7506,n[2954]=7508,n[2955]=7509,n[2956]=7510,n[2958]=7512,n[2959]=7513,n[2960]=7514,n[2962]=7516,n[2963]=7517,n[2964]=7518,n[2966]=7520,n[2967]=7521,n[2968]=7522,n[2970]=7524,n[2971]=7525,n[2972]=7526,n[2974]=7528,n[2975]=7529,n[2976]=7530,n[2978]=1537,n[2979]=1538,n[2980]=1539,n[2982]=1549,n[2983]=1551,n[2984]=1552,n[2986]=1554,n[2987]=1555,n[2988]=1556,n[2990]=1623,n[2991]=1624,n[2995]=1775,n[2999]=1791,n[3002]=64290,n[3003]=64291,n[3004]=64292,n[3006]=64294,n[3007]=64295,n[3008]=64296,n[3011]=1900,n[3014]=8223,n[3015]=8244,n[3017]=7532,n[3018]=7533,n[3019]=7534,n[3075]=7590,n[3076]=7591,n[3079]=7594,n[3080]=7595,n[3083]=7598,n[3084]=7599,n[3087]=7602,n[3088]=7603,n[3091]=7606,n[3092]=7607,n[3095]=7610,n[3096]=7611,n[3099]=7614,n[3100]=7615,n[3103]=7618,n[3104]=7619,n[3107]=8337,n[3108]=8338,n[3116]=1884,n[3119]=1885,n[3120]=1885,n[3123]=1886,n[3124]=1886,n[3127]=1887,n[3128]=1887,n[3131]=1888,n[3132]=1888,n[3135]=1889,n[3136]=1889,n[3139]=1890,n[3140]=1890,n[3143]=1891,n[3144]=1891,n[3147]=1892,n[3148]=1892,n[3153]=580,n[3154]=581,n[3157]=584,n[3158]=585,n[3161]=588,n[3162]=589,n[3165]=891,n[3166]=892,n[3169]=1274,n[3170]=1275,n[3173]=1278,n[3174]=1279,n[3181]=7622,n[3182]=7623,n[3282]=11799,n[3316]=578,n[3379]=42785,n[3393]=1159,n[3416]=8377}),Iz=Si(function(n){n[227]=322,n[264]=261,n[291]=346}),Ez=Si(function(n){n[1]=32,n[4]=65,n[5]=192,n[6]=193,n[9]=196,n[17]=66,n[18]=67,n[21]=268,n[24]=68,n[28]=69,n[29]=200,n[30]=201,n[32]=282,n[38]=70,n[39]=71,n[44]=72,n[47]=73,n[48]=204,n[49]=205,n[58]=74,n[60]=75,n[62]=76,n[68]=77,n[69]=78,n[75]=79,n[76]=210,n[80]=214,n[87]=80,n[89]=81,n[90]=82,n[92]=344,n[94]=83,n[97]=352,n[100]=84,n[104]=85,n[109]=220,n[115]=86,n[116]=87,n[121]=88,n[122]=89,n[124]=221,n[127]=90,n[129]=381,n[258]=97,n[259]=224,n[260]=225,n[263]=228,n[268]=261,n[271]=98,n[272]=99,n[273]=263,n[275]=269,n[282]=100,n[286]=101,n[287]=232,n[288]=233,n[290]=283,n[295]=281,n[296]=102,n[336]=103,n[346]=104,n[349]=105,n[350]=236,n[351]=237,n[361]=106,n[364]=107,n[367]=108,n[371]=322,n[373]=109,n[374]=110,n[381]=111,n[382]=242,n[383]=243,n[386]=246,n[393]=112,n[395]=113,n[396]=114,n[398]=345,n[400]=115,n[401]=347,n[403]=353,n[410]=116,n[437]=117,n[442]=252,n[448]=118,n[449]=119,n[454]=120,n[455]=121,n[457]=253,n[460]=122,n[462]=382,n[463]=380,n[853]=44,n[855]=58,n[856]=46,n[876]=47,n[878]=45,n[882]=45,n[894]=40,n[895]=41,n[896]=91,n[897]=93,n[923]=64,n[940]=163,n[1004]=48,n[1005]=49,n[1006]=50,n[1007]=51,n[1008]=52,n[1009]=53,n[1010]=54,n[1011]=55,n[1012]=56,n[1013]=57,n[1081]=37,n[1085]=43,n[1086]=45});function gk(n){const e=dx(n);return iy()[e]}function mk(n){const e=dx(n);return!!(iy()[e]||GR()[e]||T4()[e]||K7()[e])}class cp{constructor(e=[]){this._map=e}get length(){return this._map.length}forEach(e){for(const t in this._map)e(t,this._map[t].codePointAt(0))}has(e){return this._map[e]!==void 0}get(e){return this._map[e]}charCodeOf(e){const t=this._map;if(t.length<=65536)return t.indexOf(e);for(const i in t)if(t[i]===e)return i|0;return-1}amend(e){for(const t in e)this._map[t]=e[t]}}class uo{constructor(e,t){this.firstChar=e,this.lastChar=t}get length(){return this.lastChar+1-this.firstChar}forEach(e){for(let t=this.firstChar,i=this.lastChar;t<=i;t++)e(t,t)}has(e){return this.firstChar<=e&&e<=this.lastChar}get(e){if(this.firstChar<=e&&e<=this.lastChar)return String.fromCharCode(e)}charCodeOf(e){return Number.isInteger(e)&&e>=this.firstChar&&e<=this.lastChar?e:-1}amend(e){kn("Should not call amend()")}}class _w{constructor(e,t){this.properties=t;const i=new I4(e,t,s1);this.cff=i.parse(),this.cff.duplicateFirstGlyph();const s=new fx(this.cff);this.seacs=this.cff.seacs;try{this.data=s.compile()}catch{ce("Failed to compile font "+t.loadedName),this.data=e}this._createBuiltInEncoding()}get numGlyphs(){return this.cff.charStrings.count}getCharset(){return this.cff.charset.charset}getGlyphMapping(){const e=this.cff,t=this.properties,{cidToGidMap:i,cMap:s}=t,r=e.charset.charset;let a,o;if(t.composite){let c;if((i==null?void 0:i.length)>0){c=Object.create(null);for(let u=0,d=i.length;u<d;u++){const f=i[u];f!==void 0&&(c[f]=u)}}a=Object.create(null);let h;if(e.isCIDFont)for(o=0;o<r.length;o++){const u=r[o];h=s.charCodeOf(u),(c==null?void 0:c[h])!==void 0&&(h=c[h]),a[h]=o}else for(o=0;o<e.charStrings.count;o++)h=s.charCodeOf(o),a[h]=o;return a}let l=e.encoding?e.encoding.encoding:null;return t.isInternalFont&&(l=t.defaultEncoding),a=UR(t,l,r),a}hasGlyphId(e){return this.cff.hasGlyphId(e)}_createBuiltInEncoding(){const{charset:e,encoding:t}=this.cff;if(!e||!t)return;const i=e.charset,s=t.encoding,r=[];for(const a in s){const o=s[a];if(o>=0){const l=i[o];l&&(r[a]=l)}}r.length>0&&(this.properties.builtInEncoding=r)}}function Qh(n,e){return e0(n,e)/16384}function X7(n){const e=n.length;let t=32768;return e<1240?t=107:e<33900&&(t=1131),t}function Tz(n,e,t){const i=yn(n,e+2)===1?Yn(n,e+8):Yn(n,e+16),s=yn(n,e+i);let r,a,o;if(s===4){yn(n,e+i+2);const l=yn(n,e+i+6)>>1;for(a=e+i+14,r=[],o=0;o<l;o++,a+=2)r[o]={end:yn(n,a)};for(a+=2,o=0;o<l;o++,a+=2)r[o].start=yn(n,a);for(o=0;o<l;o++,a+=2)r[o].idDelta=yn(n,a);for(o=0;o<l;o++,a+=2){let c=yn(n,a);if(c!==0){r[o].ids=[];for(let h=0,u=r[o].end-r[o].start+1;h<u;h++)r[o].ids[h]=yn(n,a+c),c+=2}}return r}else if(s===12){const l=Yn(n,e+i+12);for(a=e+i+16,r=[],o=0;o<l;o++)e=Yn(n,a),r.push({start:e,end:Yn(n,a+4),idDelta:Yn(n,a+8)-e}),a+=12;return r}throw new Te(`unsupported cmap: ${s}`)}function Rz(n,e,t,i){var o,l,c;const s={},a=new I4(new Hi(n,e,t-e),s,i).parse();return{glyphs:a.charStrings.objects,subrs:(l=(o=a.topDict.privateDict)==null?void 0:o.subrsIndex)==null?void 0:l.objects,gsubrs:(c=a.globalSubrIndex)==null?void 0:c.objects,isCFFCIDFont:a.isCIDFont,fdSelect:a.fdSelect,fdArray:a.fdArray}}function Mz(n,e,t){let i,s;t?(i=4,s=Yn):(i=2,s=(o,l)=>2*yn(o,l));const r=[];let a=s(e,0);for(let o=i;o<e.length;o+=i){const l=s(e,o);r.push(n.subarray(a,l)),a=l}return r}function P3(n,e){const t=e.codePointAt(0);let i=0,s=0,r=n.length-1;for(;s<r;){const a=s+r+1>>1;t<n[a].start?r=a-1:s=a}return n[s].start<=t&&t<=n[s].end&&(i=n[s].idDelta+(n[s].ids?n[s].ids[t-n[s].start]:t)&65535),{charCode:t,glyphId:i}}function VR(n,e,t){function i(d,f){c&&e.add("L",c),c=[d,f],e.add("M",[d,f])}function s(d,f){e.add("L",[d,f])}function r(d,f,g,m){e.add("Q",[d,f,g,m])}let a=0;const o=e0(n,a);let l,c=null,h=0,u=0;if(a+=10,o<0)do{l=yn(n,a);const d=yn(n,a+2);a+=4;let f,g;l&1?(l&2?(f=e0(n,a),g=e0(n,a+2)):(f=yn(n,a),g=yn(n,a+2)),a+=4):l&2?(f=_l(n,a++),g=_l(n,a++)):(f=n[a++],g=n[a++]),l&2?(h=f,u=g):(h=0,u=0);let m=1,x=1,p=0,y=0;l&8?(m=x=Qh(n,a),a+=2):l&64?(m=Qh(n,a),x=Qh(n,a+2),a+=4):l&128&&(m=Qh(n,a),p=Qh(n,a+2),y=Qh(n,a+4),x=Qh(n,a+6),a+=8);const w=t.glyphs[d];w&&(e.save(),e.transform([m,p,y,x,h,u]),VR(w,e,t),e.restore())}while(l&32);else{const d=[];let f,g;for(f=0;f<o;f++)d.push(yn(n,a)),a+=2;const m=yn(n,a);a+=2+m;const x=d.at(-1)+1,p=[];for(;p.length<x;){l=n[a++];let w=1;for(l&8&&(w+=n[a++]);w-- >0;)p.push({flags:l})}for(f=0;f<x;f++){switch(p[f].flags&18){case 0:h+=e0(n,a),a+=2;break;case 2:h-=n[a++];break;case 18:h+=n[a++];break}p[f].x=h}for(f=0;f<x;f++){switch(p[f].flags&36){case 0:u+=e0(n,a),a+=2;break;case 4:u-=n[a++];break;case 36:u+=n[a++];break}p[f].y=u}let y=0;for(a=0;a<o;a++){const w=d[a],_=p.slice(y,w+1);if(_[0].flags&1)_.push(_[0]);else if(_.at(-1).flags&1)_.unshift(_.at(-1));else{const v={flags:1,x:(_[0].x+_.at(-1).x)/2,y:(_[0].y+_.at(-1).y)/2};_.unshift(v),_.push(v)}for(i(_[0].x,_[0].y),f=1,g=_.length;f<g;f++)_[f].flags&1?s(_[f].x,_[f].y):_[f+1].flags&1?(r(_[f].x,_[f].y,_[f+1].x,_[f+1].y),f++):r(_[f].x,_[f].y,(_[f].x+_[f+1].x)/2,(_[f].y+_[f+1].y)/2);y=w+1}}}function Y7(n,e,t,i){function s(f,g){u&&e.add("L",u),u=[f,g],e.add("M",[f,g])}function r(f,g){e.add("L",[f,g])}function a(f,g,m,x,p,y){e.add("C",[f,g,m,x,p,y])}const o=[];let l=0,c=0,h=0,u=null;function d(f){var m;let g=0;for(;g<f.length;){let x=!1,p=f[g++],y,w,_,v,C,k,I,S,M;switch(p){case 1:h+=o.length>>1,x=!0;break;case 3:h+=o.length>>1,x=!0;break;case 4:c+=o.pop(),s(l,c),x=!0;break;case 5:for(;o.length>0;)l+=o.shift(),c+=o.shift(),r(l,c);break;case 6:for(;o.length>0&&(l+=o.shift(),r(l,c),o.length!==0);)c+=o.shift(),r(l,c);break;case 7:for(;o.length>0&&(c+=o.shift(),r(l,c),o.length!==0);)l+=o.shift(),r(l,c);break;case 8:for(;o.length>0;)y=l+o.shift(),_=c+o.shift(),w=y+o.shift(),v=_+o.shift(),l=w+o.shift(),c=v+o.shift(),a(y,_,w,v,l,c);break;case 10:if(S=o.pop(),M=null,t.isCFFCIDFont){const N=t.fdSelect.getFDIndex(i);if(N>=0&&N<t.fdArray.length){const F=t.fdArray[N];let H;(m=F.privateDict)!=null&&m.subrsIndex&&(H=F.privateDict.subrsIndex.objects),H&&(S+=X7(H),M=H[S])}else ce("Invalid fd index for glyph index.")}else M=t.subrs[S+t.subrsBias];M&&d(M);break;case 11:return;case 12:switch(p=f[g++],p){case 34:y=l+o.shift(),w=y+o.shift(),C=c+o.shift(),l=w+o.shift(),a(y,c,w,C,l,C),y=l+o.shift(),w=y+o.shift(),l=w+o.shift(),a(y,C,w,c,l,c);break;case 35:y=l+o.shift(),_=c+o.shift(),w=y+o.shift(),v=_+o.shift(),l=w+o.shift(),c=v+o.shift(),a(y,_,w,v,l,c),y=l+o.shift(),_=c+o.shift(),w=y+o.shift(),v=_+o.shift(),l=w+o.shift(),c=v+o.shift(),a(y,_,w,v,l,c),o.pop();break;case 36:y=l+o.shift(),C=c+o.shift(),w=y+o.shift(),k=C+o.shift(),l=w+o.shift(),a(y,C,w,k,l,k),y=l+o.shift(),w=y+o.shift(),I=k+o.shift(),l=w+o.shift(),a(y,k,w,I,l,c);break;case 37:const N=l,F=c;y=l+o.shift(),_=c+o.shift(),w=y+o.shift(),v=_+o.shift(),l=w+o.shift(),c=v+o.shift(),a(y,_,w,v,l,c),y=l+o.shift(),_=c+o.shift(),w=y+o.shift(),v=_+o.shift(),l=w,c=v,Math.abs(l-N)>Math.abs(c-F)?l+=o.shift():c+=o.shift(),a(y,_,w,v,l,c);break;default:throw new Te(`unknown operator: 12 ${p}`)}break;case 14:if(o.length>=4){const N=o.pop(),F=o.pop();c=o.pop(),l=o.pop(),e.save(),e.translate(l,c);let H=P3(t.cmap,String.fromCharCode(t.glyphNameMap[o0[N]]));Y7(t.glyphs[H.glyphId],e,t,H.glyphId),e.restore(),H=P3(t.cmap,String.fromCharCode(t.glyphNameMap[o0[F]])),Y7(t.glyphs[H.glyphId],e,t,H.glyphId)}return;case 18:h+=o.length>>1,x=!0;break;case 19:h+=o.length>>1,g+=h+7>>3,x=!0;break;case 20:h+=o.length>>1,g+=h+7>>3,x=!0;break;case 21:c+=o.pop(),l+=o.pop(),s(l,c),x=!0;break;case 22:l+=o.pop(),s(l,c),x=!0;break;case 23:h+=o.length>>1,x=!0;break;case 24:for(;o.length>2;)y=l+o.shift(),_=c+o.shift(),w=y+o.shift(),v=_+o.shift(),l=w+o.shift(),c=v+o.shift(),a(y,_,w,v,l,c);l+=o.shift(),c+=o.shift(),r(l,c);break;case 25:for(;o.length>6;)l+=o.shift(),c+=o.shift(),r(l,c);y=l+o.shift(),_=c+o.shift(),w=y+o.shift(),v=_+o.shift(),l=w+o.shift(),c=v+o.shift(),a(y,_,w,v,l,c);break;case 26:for(o.length%2&&(l+=o.shift());o.length>0;)y=l,_=c+o.shift(),w=y+o.shift(),v=_+o.shift(),l=w,c=v+o.shift(),a(y,_,w,v,l,c);break;case 27:for(o.length%2&&(c+=o.shift());o.length>0;)y=l+o.shift(),_=c,w=y+o.shift(),v=_+o.shift(),l=w+o.shift(),c=v,a(y,_,w,v,l,c);break;case 28:o.push(e0(f,g)),g+=2;break;case 29:S=o.pop()+t.gsubrsBias,M=t.gsubrs[S],M&&d(M);break;case 30:for(;o.length>0&&(y=l,_=c+o.shift(),w=y+o.shift(),v=_+o.shift(),l=w+o.shift(),c=v+(o.length===1?o.shift():0),a(y,_,w,v,l,c),o.length!==0);)y=l+o.shift(),_=c,w=y+o.shift(),v=_+o.shift(),c=v+o.shift(),l=w+(o.length===1?o.shift():0),a(y,_,w,v,l,c);break;case 31:for(;o.length>0&&(y=l+o.shift(),_=c,w=y+o.shift(),v=_+o.shift(),c=v+o.shift(),l=w+(o.length===1?o.shift():0),a(y,_,w,v,l,c),o.length!==0);)y=l,_=c+o.shift(),w=y+o.shift(),v=_+o.shift(),l=w+o.shift(),c=v+(o.length===1?o.shift():0),a(y,_,w,v,l,c);break;default:if(p<32)throw new Te(`unknown operator: ${p}`);p<247?o.push(p-139):p<251?o.push((p-247)*256+f[g++]+108):p<255?o.push(-(p-251)*256-f[g++]-108):(o.push((f[g]<<24|f[g+1]<<16|f[g+2]<<8|f[g+3])/65536),g+=4);break}x&&(o.length=0)}}d(n)}const pk="";class Pz{constructor(){He(this,"cmds",[]);He(this,"transformStack",[]);He(this,"currentTransform",[1,0,0,1,0,0])}add(e,t){if(t){const{currentTransform:i}=this;for(let s=0,r=t.length;s<r;s+=2)Dn.applyTransform(t,i,s);this.cmds.push(`${e}${t.join(" ")}`)}else this.cmds.push(e)}transform(e){this.currentTransform=Dn.transform(this.currentTransform,e)}translate(e,t){this.transform([1,0,0,1,e,t])}save(){this.transformStack.push(this.currentTransform.slice())}restore(){this.currentTransform=this.transformStack.pop()||[1,0,0,1,0,0]}getSVG(){return this.cmds.join("")}}class qR{constructor(e){this.fontMatrix=e,this.compiledGlyphs=Object.create(null),this.compiledCharCodeToGlyphId=Object.create(null)}getPathJs(e){var a;const{charCode:t,glyphId:i}=P3(this.cmap,e);let s=this.compiledGlyphs[i],r;if(s===void 0){try{s=this.compileGlyph(this.glyphs[i],i)}catch(o){s=pk,r=o}this.compiledGlyphs[i]=s}if((a=this.compiledCharCodeToGlyphId)[t]??(a[t]=i),r)throw r;return s}compileGlyph(e,t){if(!(e!=null&&e.length)||e[0]===14)return pk;let i=this.fontMatrix;if(this.isCFFCIDFont){const r=this.fdSelect.getFDIndex(t);r>=0&&r<this.fdArray.length?i=this.fdArray[r].getByName("FontMatrix")||Ld:ce("Invalid fd index for glyph index.")}Hs(Vr(i,6),"Expected a valid fontMatrix.");const s=new Pz;return s.transform(i.slice()),this.compileGlyphImpl(e,s,t),s.add("Z"),s.getSVG()}compileGlyphImpl(){kn("Children classes should implement this.")}hasBuiltPath(e){const{charCode:t,glyphId:i}=P3(this.cmap,e);return this.compiledGlyphs[i]!==void 0&&this.compiledCharCodeToGlyphId[t]!==void 0}}class Nz extends qR{constructor(e,t,i){super(i||[488e-6,0,0,488e-6,0,0]),this.glyphs=e,this.cmap=t}compileGlyphImpl(e,t){VR(e,t,this)}}class Oz extends qR{constructor(e,t,i){super(i||[.001,0,0,.001,0,0]),this.glyphs=e.glyphs,this.gsubrs=e.gsubrs||[],this.subrs=e.subrs||[],this.cmap=t,this.glyphNameMap=Kl(),this.gsubrsBias=X7(this.gsubrs),this.subrsBias=X7(this.subrs),this.isCFFCIDFont=e.isCFFCIDFont,this.fdSelect=e.fdSelect,this.fdArray=e.fdArray}compileGlyphImpl(e,t,i){Y7(e,t,this,i)}}class Dz{static create(e,t){const i=new Uint8Array(e.data);let s,r,a,o,l,c;const h=yn(i,4);for(let u=0,d=12;u<h;u++,d+=16){const f=da(i.subarray(d,d+4)),g=Yn(i,d+8),m=Yn(i,d+12);switch(f){case"cmap":s=Tz(i,g);break;case"glyf":r=i.subarray(g,g+m);break;case"loca":a=i.subarray(g,g+m);break;case"head":c=yn(i,g+18),l=yn(i,g+50);break;case"CFF ":o=Rz(i,g,g+m,t);break}}if(r){const u=c?[1/c,0,0,1/c,0,0]:e.fontMatrix;return new Nz(Mz(r,a,l),s,u)}return new Oz(o,s,e.fontMatrix)}}const Fz=Si(function(n){n.Courier=600,n["Courier-Bold"]=600,n["Courier-BoldOblique"]=600,n["Courier-Oblique"]=600,n.Helvetica=Si(function(e){e.space=278,e.exclam=278,e.quotedbl=355,e.numbersign=556,e.dollar=556,e.percent=889,e.ampersand=667,e.quoteright=222,e.parenleft=333,e.parenright=333,e.asterisk=389,e.plus=584,e.comma=278,e.hyphen=333,e.period=278,e.slash=278,e.zero=556,e.one=556,e.two=556,e.three=556,e.four=556,e.five=556,e.six=556,e.seven=556,e.eight=556,e.nine=556,e.colon=278,e.semicolon=278,e.less=584,e.equal=584,e.greater=584,e.question=556,e.at=1015,e.A=667,e.B=667,e.C=722,e.D=722,e.E=667,e.F=611,e.G=778,e.H=722,e.I=278,e.J=500,e.K=667,e.L=556,e.M=833,e.N=722,e.O=778,e.P=667,e.Q=778,e.R=722,e.S=667,e.T=611,e.U=722,e.V=667,e.W=944,e.X=667,e.Y=667,e.Z=611,e.bracketleft=278,e.backslash=278,e.bracketright=278,e.asciicircum=469,e.underscore=556,e.quoteleft=222,e.a=556,e.b=556,e.c=500,e.d=556,e.e=556,e.f=278,e.g=556,e.h=556,e.i=222,e.j=222,e.k=500,e.l=222,e.m=833,e.n=556,e.o=556,e.p=556,e.q=556,e.r=333,e.s=500,e.t=278,e.u=556,e.v=500,e.w=722,e.x=500,e.y=500,e.z=500,e.braceleft=334,e.bar=260,e.braceright=334,e.asciitilde=584,e.exclamdown=333,e.cent=556,e.sterling=556,e.fraction=167,e.yen=556,e.florin=556,e.section=556,e.currency=556,e.quotesingle=191,e.quotedblleft=333,e.guillemotleft=556,e.guilsinglleft=333,e.guilsinglright=333,e.fi=500,e.fl=500,e.endash=556,e.dagger=556,e.daggerdbl=556,e.periodcentered=278,e.paragraph=537,e.bullet=350,e.quotesinglbase=222,e.quotedblbase=333,e.quotedblright=333,e.guillemotright=556,e.ellipsis=1e3,e.perthousand=1e3,e.questiondown=611,e.grave=333,e.acute=333,e.circumflex=333,e.tilde=333,e.macron=333,e.breve=333,e.dotaccent=333,e.dieresis=333,e.ring=333,e.cedilla=333,e.hungarumlaut=333,e.ogonek=333,e.caron=333,e.emdash=1e3,e.AE=1e3,e.ordfeminine=370,e.Lslash=556,e.Oslash=778,e.OE=1e3,e.ordmasculine=365,e.ae=889,e.dotlessi=278,e.lslash=222,e.oslash=611,e.oe=944,e.germandbls=611,e.Idieresis=278,e.eacute=556,e.abreve=556,e.uhungarumlaut=556,e.ecaron=556,e.Ydieresis=667,e.divide=584,e.Yacute=667,e.Acircumflex=667,e.aacute=556,e.Ucircumflex=722,e.yacute=500,e.scommaaccent=500,e.ecircumflex=556,e.Uring=722,e.Udieresis=722,e.aogonek=556,e.Uacute=722,e.uogonek=556,e.Edieresis=667,e.Dcroat=722,e.commaaccent=250,e.copyright=737,e.Emacron=667,e.ccaron=500,e.aring=556,e.Ncommaaccent=722,e.lacute=222,e.agrave=556,e.Tcommaaccent=611,e.Cacute=722,e.atilde=556,e.Edotaccent=667,e.scaron=500,e.scedilla=500,e.iacute=278,e.lozenge=471,e.Rcaron=722,e.Gcommaaccent=778,e.ucircumflex=556,e.acircumflex=556,e.Amacron=667,e.rcaron=333,e.ccedilla=500,e.Zdotaccent=611,e.Thorn=667,e.Omacron=778,e.Racute=722,e.Sacute=667,e.dcaron=643,e.Umacron=722,e.uring=556,e.threesuperior=333,e.Ograve=778,e.Agrave=667,e.Abreve=667,e.multiply=584,e.uacute=556,e.Tcaron=611,e.partialdiff=476,e.ydieresis=500,e.Nacute=722,e.icircumflex=278,e.Ecircumflex=667,e.adieresis=556,e.edieresis=556,e.cacute=500,e.nacute=556,e.umacron=556,e.Ncaron=722,e.Iacute=278,e.plusminus=584,e.brokenbar=260,e.registered=737,e.Gbreve=778,e.Idotaccent=278,e.summation=600,e.Egrave=667,e.racute=333,e.omacron=556,e.Zacute=611,e.Zcaron=611,e.greaterequal=549,e.Eth=722,e.Ccedilla=722,e.lcommaaccent=222,e.tcaron=317,e.eogonek=556,e.Uogonek=722,e.Aacute=667,e.Adieresis=667,e.egrave=556,e.zacute=500,e.iogonek=222,e.Oacute=778,e.oacute=556,e.amacron=556,e.sacute=500,e.idieresis=278,e.Ocircumflex=778,e.Ugrave=722,e.Delta=612,e.thorn=556,e.twosuperior=333,e.Odieresis=778,e.mu=556,e.igrave=278,e.ohungarumlaut=556,e.Eogonek=667,e.dcroat=556,e.threequarters=834,e.Scedilla=667,e.lcaron=299,e.Kcommaaccent=667,e.Lacute=556,e.trademark=1e3,e.edotaccent=556,e.Igrave=278,e.Imacron=278,e.Lcaron=556,e.onehalf=834,e.lessequal=549,e.ocircumflex=556,e.ntilde=556,e.Uhungarumlaut=722,e.Eacute=667,e.emacron=556,e.gbreve=556,e.onequarter=834,e.Scaron=667,e.Scommaaccent=667,e.Ohungarumlaut=778,e.degree=400,e.ograve=556,e.Ccaron=722,e.ugrave=556,e.radical=453,e.Dcaron=722,e.rcommaaccent=333,e.Ntilde=722,e.otilde=556,e.Rcommaaccent=722,e.Lcommaaccent=556,e.Atilde=667,e.Aogonek=667,e.Aring=667,e.Otilde=778,e.zdotaccent=500,e.Ecaron=667,e.Iogonek=278,e.kcommaaccent=500,e.minus=584,e.Icircumflex=278,e.ncaron=556,e.tcommaaccent=278,e.logicalnot=584,e.odieresis=556,e.udieresis=556,e.notequal=549,e.gcommaaccent=556,e.eth=556,e.zcaron=500,e.ncommaaccent=556,e.onesuperior=333,e.imacron=278,e.Euro=556}),n["Helvetica-Bold"]=Si(function(e){e.space=278,e.exclam=333,e.quotedbl=474,e.numbersign=556,e.dollar=556,e.percent=889,e.ampersand=722,e.quoteright=278,e.parenleft=333,e.parenright=333,e.asterisk=389,e.plus=584,e.comma=278,e.hyphen=333,e.period=278,e.slash=278,e.zero=556,e.one=556,e.two=556,e.three=556,e.four=556,e.five=556,e.six=556,e.seven=556,e.eight=556,e.nine=556,e.colon=333,e.semicolon=333,e.less=584,e.equal=584,e.greater=584,e.question=611,e.at=975,e.A=722,e.B=722,e.C=722,e.D=722,e.E=667,e.F=611,e.G=778,e.H=722,e.I=278,e.J=556,e.K=722,e.L=611,e.M=833,e.N=722,e.O=778,e.P=667,e.Q=778,e.R=722,e.S=667,e.T=611,e.U=722,e.V=667,e.W=944,e.X=667,e.Y=667,e.Z=611,e.bracketleft=333,e.backslash=278,e.bracketright=333,e.asciicircum=584,e.underscore=556,e.quoteleft=278,e.a=556,e.b=611,e.c=556,e.d=611,e.e=556,e.f=333,e.g=611,e.h=611,e.i=278,e.j=278,e.k=556,e.l=278,e.m=889,e.n=611,e.o=611,e.p=611,e.q=611,e.r=389,e.s=556,e.t=333,e.u=611,e.v=556,e.w=778,e.x=556,e.y=556,e.z=500,e.braceleft=389,e.bar=280,e.braceright=389,e.asciitilde=584,e.exclamdown=333,e.cent=556,e.sterling=556,e.fraction=167,e.yen=556,e.florin=556,e.section=556,e.currency=556,e.quotesingle=238,e.quotedblleft=500,e.guillemotleft=556,e.guilsinglleft=333,e.guilsinglright=333,e.fi=611,e.fl=611,e.endash=556,e.dagger=556,e.daggerdbl=556,e.periodcentered=278,e.paragraph=556,e.bullet=350,e.quotesinglbase=278,e.quotedblbase=500,e.quotedblright=500,e.guillemotright=556,e.ellipsis=1e3,e.perthousand=1e3,e.questiondown=611,e.grave=333,e.acute=333,e.circumflex=333,e.tilde=333,e.macron=333,e.breve=333,e.dotaccent=333,e.dieresis=333,e.ring=333,e.cedilla=333,e.hungarumlaut=333,e.ogonek=333,e.caron=333,e.emdash=1e3,e.AE=1e3,e.ordfeminine=370,e.Lslash=611,e.Oslash=778,e.OE=1e3,e.ordmasculine=365,e.ae=889,e.dotlessi=278,e.lslash=278,e.oslash=611,e.oe=944,e.germandbls=611,e.Idieresis=278,e.eacute=556,e.abreve=556,e.uhungarumlaut=611,e.ecaron=556,e.Ydieresis=667,e.divide=584,e.Yacute=667,e.Acircumflex=722,e.aacute=556,e.Ucircumflex=722,e.yacute=556,e.scommaaccent=556,e.ecircumflex=556,e.Uring=722,e.Udieresis=722,e.aogonek=556,e.Uacute=722,e.uogonek=611,e.Edieresis=667,e.Dcroat=722,e.commaaccent=250,e.copyright=737,e.Emacron=667,e.ccaron=556,e.aring=556,e.Ncommaaccent=722,e.lacute=278,e.agrave=556,e.Tcommaaccent=611,e.Cacute=722,e.atilde=556,e.Edotaccent=667,e.scaron=556,e.scedilla=556,e.iacute=278,e.lozenge=494,e.Rcaron=722,e.Gcommaaccent=778,e.ucircumflex=611,e.acircumflex=556,e.Amacron=722,e.rcaron=389,e.ccedilla=556,e.Zdotaccent=611,e.Thorn=667,e.Omacron=778,e.Racute=722,e.Sacute=667,e.dcaron=743,e.Umacron=722,e.uring=611,e.threesuperior=333,e.Ograve=778,e.Agrave=722,e.Abreve=722,e.multiply=584,e.uacute=611,e.Tcaron=611,e.partialdiff=494,e.ydieresis=556,e.Nacute=722,e.icircumflex=278,e.Ecircumflex=667,e.adieresis=556,e.edieresis=556,e.cacute=556,e.nacute=611,e.umacron=611,e.Ncaron=722,e.Iacute=278,e.plusminus=584,e.brokenbar=280,e.registered=737,e.Gbreve=778,e.Idotaccent=278,e.summation=600,e.Egrave=667,e.racute=389,e.omacron=611,e.Zacute=611,e.Zcaron=611,e.greaterequal=549,e.Eth=722,e.Ccedilla=722,e.lcommaaccent=278,e.tcaron=389,e.eogonek=556,e.Uogonek=722,e.Aacute=722,e.Adieresis=722,e.egrave=556,e.zacute=500,e.iogonek=278,e.Oacute=778,e.oacute=611,e.amacron=556,e.sacute=556,e.idieresis=278,e.Ocircumflex=778,e.Ugrave=722,e.Delta=612,e.thorn=611,e.twosuperior=333,e.Odieresis=778,e.mu=611,e.igrave=278,e.ohungarumlaut=611,e.Eogonek=667,e.dcroat=611,e.threequarters=834,e.Scedilla=667,e.lcaron=400,e.Kcommaaccent=722,e.Lacute=611,e.trademark=1e3,e.edotaccent=556,e.Igrave=278,e.Imacron=278,e.Lcaron=611,e.onehalf=834,e.lessequal=549,e.ocircumflex=611,e.ntilde=611,e.Uhungarumlaut=722,e.Eacute=667,e.emacron=556,e.gbreve=611,e.onequarter=834,e.Scaron=667,e.Scommaaccent=667,e.Ohungarumlaut=778,e.degree=400,e.ograve=611,e.Ccaron=722,e.ugrave=611,e.radical=549,e.Dcaron=722,e.rcommaaccent=389,e.Ntilde=722,e.otilde=611,e.Rcommaaccent=722,e.Lcommaaccent=611,e.Atilde=722,e.Aogonek=722,e.Aring=722,e.Otilde=778,e.zdotaccent=500,e.Ecaron=667,e.Iogonek=278,e.kcommaaccent=556,e.minus=584,e.Icircumflex=278,e.ncaron=611,e.tcommaaccent=333,e.logicalnot=584,e.odieresis=611,e.udieresis=611,e.notequal=549,e.gcommaaccent=611,e.eth=611,e.zcaron=500,e.ncommaaccent=611,e.onesuperior=333,e.imacron=278,e.Euro=556}),n["Helvetica-BoldOblique"]=Si(function(e){e.space=278,e.exclam=333,e.quotedbl=474,e.numbersign=556,e.dollar=556,e.percent=889,e.ampersand=722,e.quoteright=278,e.parenleft=333,e.parenright=333,e.asterisk=389,e.plus=584,e.comma=278,e.hyphen=333,e.period=278,e.slash=278,e.zero=556,e.one=556,e.two=556,e.three=556,e.four=556,e.five=556,e.six=556,e.seven=556,e.eight=556,e.nine=556,e.colon=333,e.semicolon=333,e.less=584,e.equal=584,e.greater=584,e.question=611,e.at=975,e.A=722,e.B=722,e.C=722,e.D=722,e.E=667,e.F=611,e.G=778,e.H=722,e.I=278,e.J=556,e.K=722,e.L=611,e.M=833,e.N=722,e.O=778,e.P=667,e.Q=778,e.R=722,e.S=667,e.T=611,e.U=722,e.V=667,e.W=944,e.X=667,e.Y=667,e.Z=611,e.bracketleft=333,e.backslash=278,e.bracketright=333,e.asciicircum=584,e.underscore=556,e.quoteleft=278,e.a=556,e.b=611,e.c=556,e.d=611,e.e=556,e.f=333,e.g=611,e.h=611,e.i=278,e.j=278,e.k=556,e.l=278,e.m=889,e.n=611,e.o=611,e.p=611,e.q=611,e.r=389,e.s=556,e.t=333,e.u=611,e.v=556,e.w=778,e.x=556,e.y=556,e.z=500,e.braceleft=389,e.bar=280,e.braceright=389,e.asciitilde=584,e.exclamdown=333,e.cent=556,e.sterling=556,e.fraction=167,e.yen=556,e.florin=556,e.section=556,e.currency=556,e.quotesingle=238,e.quotedblleft=500,e.guillemotleft=556,e.guilsinglleft=333,e.guilsinglright=333,e.fi=611,e.fl=611,e.endash=556,e.dagger=556,e.daggerdbl=556,e.periodcentered=278,e.paragraph=556,e.bullet=350,e.quotesinglbase=278,e.quotedblbase=500,e.quotedblright=500,e.guillemotright=556,e.ellipsis=1e3,e.perthousand=1e3,e.questiondown=611,e.grave=333,e.acute=333,e.circumflex=333,e.tilde=333,e.macron=333,e.breve=333,e.dotaccent=333,e.dieresis=333,e.ring=333,e.cedilla=333,e.hungarumlaut=333,e.ogonek=333,e.caron=333,e.emdash=1e3,e.AE=1e3,e.ordfeminine=370,e.Lslash=611,e.Oslash=778,e.OE=1e3,e.ordmasculine=365,e.ae=889,e.dotlessi=278,e.lslash=278,e.oslash=611,e.oe=944,e.germandbls=611,e.Idieresis=278,e.eacute=556,e.abreve=556,e.uhungarumlaut=611,e.ecaron=556,e.Ydieresis=667,e.divide=584,e.Yacute=667,e.Acircumflex=722,e.aacute=556,e.Ucircumflex=722,e.yacute=556,e.scommaaccent=556,e.ecircumflex=556,e.Uring=722,e.Udieresis=722,e.aogonek=556,e.Uacute=722,e.uogonek=611,e.Edieresis=667,e.Dcroat=722,e.commaaccent=250,e.copyright=737,e.Emacron=667,e.ccaron=556,e.aring=556,e.Ncommaaccent=722,e.lacute=278,e.agrave=556,e.Tcommaaccent=611,e.Cacute=722,e.atilde=556,e.Edotaccent=667,e.scaron=556,e.scedilla=556,e.iacute=278,e.lozenge=494,e.Rcaron=722,e.Gcommaaccent=778,e.ucircumflex=611,e.acircumflex=556,e.Amacron=722,e.rcaron=389,e.ccedilla=556,e.Zdotaccent=611,e.Thorn=667,e.Omacron=778,e.Racute=722,e.Sacute=667,e.dcaron=743,e.Umacron=722,e.uring=611,e.threesuperior=333,e.Ograve=778,e.Agrave=722,e.Abreve=722,e.multiply=584,e.uacute=611,e.Tcaron=611,e.partialdiff=494,e.ydieresis=556,e.Nacute=722,e.icircumflex=278,e.Ecircumflex=667,e.adieresis=556,e.edieresis=556,e.cacute=556,e.nacute=611,e.umacron=611,e.Ncaron=722,e.Iacute=278,e.plusminus=584,e.brokenbar=280,e.registered=737,e.Gbreve=778,e.Idotaccent=278,e.summation=600,e.Egrave=667,e.racute=389,e.omacron=611,e.Zacute=611,e.Zcaron=611,e.greaterequal=549,e.Eth=722,e.Ccedilla=722,e.lcommaaccent=278,e.tcaron=389,e.eogonek=556,e.Uogonek=722,e.Aacute=722,e.Adieresis=722,e.egrave=556,e.zacute=500,e.iogonek=278,e.Oacute=778,e.oacute=611,e.amacron=556,e.sacute=556,e.idieresis=278,e.Ocircumflex=778,e.Ugrave=722,e.Delta=612,e.thorn=611,e.twosuperior=333,e.Odieresis=778,e.mu=611,e.igrave=278,e.ohungarumlaut=611,e.Eogonek=667,e.dcroat=611,e.threequarters=834,e.Scedilla=667,e.lcaron=400,e.Kcommaaccent=722,e.Lacute=611,e.trademark=1e3,e.edotaccent=556,e.Igrave=278,e.Imacron=278,e.Lcaron=611,e.onehalf=834,e.lessequal=549,e.ocircumflex=611,e.ntilde=611,e.Uhungarumlaut=722,e.Eacute=667,e.emacron=556,e.gbreve=611,e.onequarter=834,e.Scaron=667,e.Scommaaccent=667,e.Ohungarumlaut=778,e.degree=400,e.ograve=611,e.Ccaron=722,e.ugrave=611,e.radical=549,e.Dcaron=722,e.rcommaaccent=389,e.Ntilde=722,e.otilde=611,e.Rcommaaccent=722,e.Lcommaaccent=611,e.Atilde=722,e.Aogonek=722,e.Aring=722,e.Otilde=778,e.zdotaccent=500,e.Ecaron=667,e.Iogonek=278,e.kcommaaccent=556,e.minus=584,e.Icircumflex=278,e.ncaron=611,e.tcommaaccent=333,e.logicalnot=584,e.odieresis=611,e.udieresis=611,e.notequal=549,e.gcommaaccent=611,e.eth=611,e.zcaron=500,e.ncommaaccent=611,e.onesuperior=333,e.imacron=278,e.Euro=556}),n["Helvetica-Oblique"]=Si(function(e){e.space=278,e.exclam=278,e.quotedbl=355,e.numbersign=556,e.dollar=556,e.percent=889,e.ampersand=667,e.quoteright=222,e.parenleft=333,e.parenright=333,e.asterisk=389,e.plus=584,e.comma=278,e.hyphen=333,e.period=278,e.slash=278,e.zero=556,e.one=556,e.two=556,e.three=556,e.four=556,e.five=556,e.six=556,e.seven=556,e.eight=556,e.nine=556,e.colon=278,e.semicolon=278,e.less=584,e.equal=584,e.greater=584,e.question=556,e.at=1015,e.A=667,e.B=667,e.C=722,e.D=722,e.E=667,e.F=611,e.G=778,e.H=722,e.I=278,e.J=500,e.K=667,e.L=556,e.M=833,e.N=722,e.O=778,e.P=667,e.Q=778,e.R=722,e.S=667,e.T=611,e.U=722,e.V=667,e.W=944,e.X=667,e.Y=667,e.Z=611,e.bracketleft=278,e.backslash=278,e.bracketright=278,e.asciicircum=469,e.underscore=556,e.quoteleft=222,e.a=556,e.b=556,e.c=500,e.d=556,e.e=556,e.f=278,e.g=556,e.h=556,e.i=222,e.j=222,e.k=500,e.l=222,e.m=833,e.n=556,e.o=556,e.p=556,e.q=556,e.r=333,e.s=500,e.t=278,e.u=556,e.v=500,e.w=722,e.x=500,e.y=500,e.z=500,e.braceleft=334,e.bar=260,e.braceright=334,e.asciitilde=584,e.exclamdown=333,e.cent=556,e.sterling=556,e.fraction=167,e.yen=556,e.florin=556,e.section=556,e.currency=556,e.quotesingle=191,e.quotedblleft=333,e.guillemotleft=556,e.guilsinglleft=333,e.guilsinglright=333,e.fi=500,e.fl=500,e.endash=556,e.dagger=556,e.daggerdbl=556,e.periodcentered=278,e.paragraph=537,e.bullet=350,e.quotesinglbase=222,e.quotedblbase=333,e.quotedblright=333,e.guillemotright=556,e.ellipsis=1e3,e.perthousand=1e3,e.questiondown=611,e.grave=333,e.acute=333,e.circumflex=333,e.tilde=333,e.macron=333,e.breve=333,e.dotaccent=333,e.dieresis=333,e.ring=333,e.cedilla=333,e.hungarumlaut=333,e.ogonek=333,e.caron=333,e.emdash=1e3,e.AE=1e3,e.ordfeminine=370,e.Lslash=556,e.Oslash=778,e.OE=1e3,e.ordmasculine=365,e.ae=889,e.dotlessi=278,e.lslash=222,e.oslash=611,e.oe=944,e.germandbls=611,e.Idieresis=278,e.eacute=556,e.abreve=556,e.uhungarumlaut=556,e.ecaron=556,e.Ydieresis=667,e.divide=584,e.Yacute=667,e.Acircumflex=667,e.aacute=556,e.Ucircumflex=722,e.yacute=500,e.scommaaccent=500,e.ecircumflex=556,e.Uring=722,e.Udieresis=722,e.aogonek=556,e.Uacute=722,e.uogonek=556,e.Edieresis=667,e.Dcroat=722,e.commaaccent=250,e.copyright=737,e.Emacron=667,e.ccaron=500,e.aring=556,e.Ncommaaccent=722,e.lacute=222,e.agrave=556,e.Tcommaaccent=611,e.Cacute=722,e.atilde=556,e.Edotaccent=667,e.scaron=500,e.scedilla=500,e.iacute=278,e.lozenge=471,e.Rcaron=722,e.Gcommaaccent=778,e.ucircumflex=556,e.acircumflex=556,e.Amacron=667,e.rcaron=333,e.ccedilla=500,e.Zdotaccent=611,e.Thorn=667,e.Omacron=778,e.Racute=722,e.Sacute=667,e.dcaron=643,e.Umacron=722,e.uring=556,e.threesuperior=333,e.Ograve=778,e.Agrave=667,e.Abreve=667,e.multiply=584,e.uacute=556,e.Tcaron=611,e.partialdiff=476,e.ydieresis=500,e.Nacute=722,e.icircumflex=278,e.Ecircumflex=667,e.adieresis=556,e.edieresis=556,e.cacute=500,e.nacute=556,e.umacron=556,e.Ncaron=722,e.Iacute=278,e.plusminus=584,e.brokenbar=260,e.registered=737,e.Gbreve=778,e.Idotaccent=278,e.summation=600,e.Egrave=667,e.racute=333,e.omacron=556,e.Zacute=611,e.Zcaron=611,e.greaterequal=549,e.Eth=722,e.Ccedilla=722,e.lcommaaccent=222,e.tcaron=317,e.eogonek=556,e.Uogonek=722,e.Aacute=667,e.Adieresis=667,e.egrave=556,e.zacute=500,e.iogonek=222,e.Oacute=778,e.oacute=556,e.amacron=556,e.sacute=500,e.idieresis=278,e.Ocircumflex=778,e.Ugrave=722,e.Delta=612,e.thorn=556,e.twosuperior=333,e.Odieresis=778,e.mu=556,e.igrave=278,e.ohungarumlaut=556,e.Eogonek=667,e.dcroat=556,e.threequarters=834,e.Scedilla=667,e.lcaron=299,e.Kcommaaccent=667,e.Lacute=556,e.trademark=1e3,e.edotaccent=556,e.Igrave=278,e.Imacron=278,e.Lcaron=556,e.onehalf=834,e.lessequal=549,e.ocircumflex=556,e.ntilde=556,e.Uhungarumlaut=722,e.Eacute=667,e.emacron=556,e.gbreve=556,e.onequarter=834,e.Scaron=667,e.Scommaaccent=667,e.Ohungarumlaut=778,e.degree=400,e.ograve=556,e.Ccaron=722,e.ugrave=556,e.radical=453,e.Dcaron=722,e.rcommaaccent=333,e.Ntilde=722,e.otilde=556,e.Rcommaaccent=722,e.Lcommaaccent=556,e.Atilde=667,e.Aogonek=667,e.Aring=667,e.Otilde=778,e.zdotaccent=500,e.Ecaron=667,e.Iogonek=278,e.kcommaaccent=500,e.minus=584,e.Icircumflex=278,e.ncaron=556,e.tcommaaccent=278,e.logicalnot=584,e.odieresis=556,e.udieresis=556,e.notequal=549,e.gcommaaccent=556,e.eth=556,e.zcaron=500,e.ncommaaccent=556,e.onesuperior=333,e.imacron=278,e.Euro=556}),n.Symbol=Si(function(e){e.space=250,e.exclam=333,e.universal=713,e.numbersign=500,e.existential=549,e.percent=833,e.ampersand=778,e.suchthat=439,e.parenleft=333,e.parenright=333,e.asteriskmath=500,e.plus=549,e.comma=250,e.minus=549,e.period=250,e.slash=278,e.zero=500,e.one=500,e.two=500,e.three=500,e.four=500,e.five=500,e.six=500,e.seven=500,e.eight=500,e.nine=500,e.colon=278,e.semicolon=278,e.less=549,e.equal=549,e.greater=549,e.question=444,e.congruent=549,e.Alpha=722,e.Beta=667,e.Chi=722,e.Delta=612,e.Epsilon=611,e.Phi=763,e.Gamma=603,e.Eta=722,e.Iota=333,e.theta1=631,e.Kappa=722,e.Lambda=686,e.Mu=889,e.Nu=722,e.Omicron=722,e.Pi=768,e.Theta=741,e.Rho=556,e.Sigma=592,e.Tau=611,e.Upsilon=690,e.sigma1=439,e.Omega=768,e.Xi=645,e.Psi=795,e.Zeta=611,e.bracketleft=333,e.therefore=863,e.bracketright=333,e.perpendicular=658,e.underscore=500,e.radicalex=500,e.alpha=631,e.beta=549,e.chi=549,e.delta=494,e.epsilon=439,e.phi=521,e.gamma=411,e.eta=603,e.iota=329,e.phi1=603,e.kappa=549,e.lambda=549,e.mu=576,e.nu=521,e.omicron=549,e.pi=549,e.theta=521,e.rho=549,e.sigma=603,e.tau=439,e.upsilon=576,e.omega1=713,e.omega=686,e.xi=493,e.psi=686,e.zeta=494,e.braceleft=480,e.bar=200,e.braceright=480,e.similar=549,e.Euro=750,e.Upsilon1=620,e.minute=247,e.lessequal=549,e.fraction=167,e.infinity=713,e.florin=500,e.club=753,e.diamond=753,e.heart=753,e.spade=753,e.arrowboth=1042,e.arrowleft=987,e.arrowup=603,e.arrowright=987,e.arrowdown=603,e.degree=400,e.plusminus=549,e.second=411,e.greaterequal=549,e.multiply=549,e.proportional=713,e.partialdiff=494,e.bullet=460,e.divide=549,e.notequal=549,e.equivalence=549,e.approxequal=549,e.ellipsis=1e3,e.arrowvertex=603,e.arrowhorizex=1e3,e.carriagereturn=658,e.aleph=823,e.Ifraktur=686,e.Rfraktur=795,e.weierstrass=987,e.circlemultiply=768,e.circleplus=768,e.emptyset=823,e.intersection=768,e.union=768,e.propersuperset=713,e.reflexsuperset=713,e.notsubset=713,e.propersubset=713,e.reflexsubset=713,e.element=713,e.notelement=713,e.angle=768,e.gradient=713,e.registerserif=790,e.copyrightserif=790,e.trademarkserif=890,e.product=823,e.radical=549,e.dotmath=250,e.logicalnot=713,e.logicaland=603,e.logicalor=603,e.arrowdblboth=1042,e.arrowdblleft=987,e.arrowdblup=603,e.arrowdblright=987,e.arrowdbldown=603,e.lozenge=494,e.angleleft=329,e.registersans=790,e.copyrightsans=790,e.trademarksans=786,e.summation=713,e.parenlefttp=384,e.parenleftex=384,e.parenleftbt=384,e.bracketlefttp=384,e.bracketleftex=384,e.bracketleftbt=384,e.bracelefttp=494,e.braceleftmid=494,e.braceleftbt=494,e.braceex=494,e.angleright=329,e.integral=274,e.integraltp=686,e.integralex=686,e.integralbt=686,e.parenrighttp=384,e.parenrightex=384,e.parenrightbt=384,e.bracketrighttp=384,e.bracketrightex=384,e.bracketrightbt=384,e.bracerighttp=494,e.bracerightmid=494,e.bracerightbt=494,e.apple=790}),n["Times-Roman"]=Si(function(e){e.space=250,e.exclam=333,e.quotedbl=408,e.numbersign=500,e.dollar=500,e.percent=833,e.ampersand=778,e.quoteright=333,e.parenleft=333,e.parenright=333,e.asterisk=500,e.plus=564,e.comma=250,e.hyphen=333,e.period=250,e.slash=278,e.zero=500,e.one=500,e.two=500,e.three=500,e.four=500,e.five=500,e.six=500,e.seven=500,e.eight=500,e.nine=500,e.colon=278,e.semicolon=278,e.less=564,e.equal=564,e.greater=564,e.question=444,e.at=921,e.A=722,e.B=667,e.C=667,e.D=722,e.E=611,e.F=556,e.G=722,e.H=722,e.I=333,e.J=389,e.K=722,e.L=611,e.M=889,e.N=722,e.O=722,e.P=556,e.Q=722,e.R=667,e.S=556,e.T=611,e.U=722,e.V=722,e.W=944,e.X=722,e.Y=722,e.Z=611,e.bracketleft=333,e.backslash=278,e.bracketright=333,e.asciicircum=469,e.underscore=500,e.quoteleft=333,e.a=444,e.b=500,e.c=444,e.d=500,e.e=444,e.f=333,e.g=500,e.h=500,e.i=278,e.j=278,e.k=500,e.l=278,e.m=778,e.n=500,e.o=500,e.p=500,e.q=500,e.r=333,e.s=389,e.t=278,e.u=500,e.v=500,e.w=722,e.x=500,e.y=500,e.z=444,e.braceleft=480,e.bar=200,e.braceright=480,e.asciitilde=541,e.exclamdown=333,e.cent=500,e.sterling=500,e.fraction=167,e.yen=500,e.florin=500,e.section=500,e.currency=500,e.quotesingle=180,e.quotedblleft=444,e.guillemotleft=500,e.guilsinglleft=333,e.guilsinglright=333,e.fi=556,e.fl=556,e.endash=500,e.dagger=500,e.daggerdbl=500,e.periodcentered=250,e.paragraph=453,e.bullet=350,e.quotesinglbase=333,e.quotedblbase=444,e.quotedblright=444,e.guillemotright=500,e.ellipsis=1e3,e.perthousand=1e3,e.questiondown=444,e.grave=333,e.acute=333,e.circumflex=333,e.tilde=333,e.macron=333,e.breve=333,e.dotaccent=333,e.dieresis=333,e.ring=333,e.cedilla=333,e.hungarumlaut=333,e.ogonek=333,e.caron=333,e.emdash=1e3,e.AE=889,e.ordfeminine=276,e.Lslash=611,e.Oslash=722,e.OE=889,e.ordmasculine=310,e.ae=667,e.dotlessi=278,e.lslash=278,e.oslash=500,e.oe=722,e.germandbls=500,e.Idieresis=333,e.eacute=444,e.abreve=444,e.uhungarumlaut=500,e.ecaron=444,e.Ydieresis=722,e.divide=564,e.Yacute=722,e.Acircumflex=722,e.aacute=444,e.Ucircumflex=722,e.yacute=500,e.scommaaccent=389,e.ecircumflex=444,e.Uring=722,e.Udieresis=722,e.aogonek=444,e.Uacute=722,e.uogonek=500,e.Edieresis=611,e.Dcroat=722,e.commaaccent=250,e.copyright=760,e.Emacron=611,e.ccaron=444,e.aring=444,e.Ncommaaccent=722,e.lacute=278,e.agrave=444,e.Tcommaaccent=611,e.Cacute=667,e.atilde=444,e.Edotaccent=611,e.scaron=389,e.scedilla=389,e.iacute=278,e.lozenge=471,e.Rcaron=667,e.Gcommaaccent=722,e.ucircumflex=500,e.acircumflex=444,e.Amacron=722,e.rcaron=333,e.ccedilla=444,e.Zdotaccent=611,e.Thorn=556,e.Omacron=722,e.Racute=667,e.Sacute=556,e.dcaron=588,e.Umacron=722,e.uring=500,e.threesuperior=300,e.Ograve=722,e.Agrave=722,e.Abreve=722,e.multiply=564,e.uacute=500,e.Tcaron=611,e.partialdiff=476,e.ydieresis=500,e.Nacute=722,e.icircumflex=278,e.Ecircumflex=611,e.adieresis=444,e.edieresis=444,e.cacute=444,e.nacute=500,e.umacron=500,e.Ncaron=722,e.Iacute=333,e.plusminus=564,e.brokenbar=200,e.registered=760,e.Gbreve=722,e.Idotaccent=333,e.summation=600,e.Egrave=611,e.racute=333,e.omacron=500,e.Zacute=611,e.Zcaron=611,e.greaterequal=549,e.Eth=722,e.Ccedilla=667,e.lcommaaccent=278,e.tcaron=326,e.eogonek=444,e.Uogonek=722,e.Aacute=722,e.Adieresis=722,e.egrave=444,e.zacute=444,e.iogonek=278,e.Oacute=722,e.oacute=500,e.amacron=444,e.sacute=389,e.idieresis=278,e.Ocircumflex=722,e.Ugrave=722,e.Delta=612,e.thorn=500,e.twosuperior=300,e.Odieresis=722,e.mu=500,e.igrave=278,e.ohungarumlaut=500,e.Eogonek=611,e.dcroat=500,e.threequarters=750,e.Scedilla=556,e.lcaron=344,e.Kcommaaccent=722,e.Lacute=611,e.trademark=980,e.edotaccent=444,e.Igrave=333,e.Imacron=333,e.Lcaron=611,e.onehalf=750,e.lessequal=549,e.ocircumflex=500,e.ntilde=500,e.Uhungarumlaut=722,e.Eacute=611,e.emacron=444,e.gbreve=500,e.onequarter=750,e.Scaron=556,e.Scommaaccent=556,e.Ohungarumlaut=722,e.degree=400,e.ograve=500,e.Ccaron=667,e.ugrave=500,e.radical=453,e.Dcaron=722,e.rcommaaccent=333,e.Ntilde=722,e.otilde=500,e.Rcommaaccent=667,e.Lcommaaccent=611,e.Atilde=722,e.Aogonek=722,e.Aring=722,e.Otilde=722,e.zdotaccent=444,e.Ecaron=611,e.Iogonek=333,e.kcommaaccent=500,e.minus=564,e.Icircumflex=333,e.ncaron=500,e.tcommaaccent=278,e.logicalnot=564,e.odieresis=500,e.udieresis=500,e.notequal=549,e.gcommaaccent=500,e.eth=500,e.zcaron=444,e.ncommaaccent=500,e.onesuperior=300,e.imacron=278,e.Euro=500}),n["Times-Bold"]=Si(function(e){e.space=250,e.exclam=333,e.quotedbl=555,e.numbersign=500,e.dollar=500,e.percent=1e3,e.ampersand=833,e.quoteright=333,e.parenleft=333,e.parenright=333,e.asterisk=500,e.plus=570,e.comma=250,e.hyphen=333,e.period=250,e.slash=278,e.zero=500,e.one=500,e.two=500,e.three=500,e.four=500,e.five=500,e.six=500,e.seven=500,e.eight=500,e.nine=500,e.colon=333,e.semicolon=333,e.less=570,e.equal=570,e.greater=570,e.question=500,e.at=930,e.A=722,e.B=667,e.C=722,e.D=722,e.E=667,e.F=611,e.G=778,e.H=778,e.I=389,e.J=500,e.K=778,e.L=667,e.M=944,e.N=722,e.O=778,e.P=611,e.Q=778,e.R=722,e.S=556,e.T=667,e.U=722,e.V=722,e.W=1e3,e.X=722,e.Y=722,e.Z=667,e.bracketleft=333,e.backslash=278,e.bracketright=333,e.asciicircum=581,e.underscore=500,e.quoteleft=333,e.a=500,e.b=556,e.c=444,e.d=556,e.e=444,e.f=333,e.g=500,e.h=556,e.i=278,e.j=333,e.k=556,e.l=278,e.m=833,e.n=556,e.o=500,e.p=556,e.q=556,e.r=444,e.s=389,e.t=333,e.u=556,e.v=500,e.w=722,e.x=500,e.y=500,e.z=444,e.braceleft=394,e.bar=220,e.braceright=394,e.asciitilde=520,e.exclamdown=333,e.cent=500,e.sterling=500,e.fraction=167,e.yen=500,e.florin=500,e.section=500,e.currency=500,e.quotesingle=278,e.quotedblleft=500,e.guillemotleft=500,e.guilsinglleft=333,e.guilsinglright=333,e.fi=556,e.fl=556,e.endash=500,e.dagger=500,e.daggerdbl=500,e.periodcentered=250,e.paragraph=540,e.bullet=350,e.quotesinglbase=333,e.quotedblbase=500,e.quotedblright=500,e.guillemotright=500,e.ellipsis=1e3,e.perthousand=1e3,e.questiondown=500,e.grave=333,e.acute=333,e.circumflex=333,e.tilde=333,e.macron=333,e.breve=333,e.dotaccent=333,e.dieresis=333,e.ring=333,e.cedilla=333,e.hungarumlaut=333,e.ogonek=333,e.caron=333,e.emdash=1e3,e.AE=1e3,e.ordfeminine=300,e.Lslash=667,e.Oslash=778,e.OE=1e3,e.ordmasculine=330,e.ae=722,e.dotlessi=278,e.lslash=278,e.oslash=500,e.oe=722,e.germandbls=556,e.Idieresis=389,e.eacute=444,e.abreve=500,e.uhungarumlaut=556,e.ecaron=444,e.Ydieresis=722,e.divide=570,e.Yacute=722,e.Acircumflex=722,e.aacute=500,e.Ucircumflex=722,e.yacute=500,e.scommaaccent=389,e.ecircumflex=444,e.Uring=722,e.Udieresis=722,e.aogonek=500,e.Uacute=722,e.uogonek=556,e.Edieresis=667,e.Dcroat=722,e.commaaccent=250,e.copyright=747,e.Emacron=667,e.ccaron=444,e.aring=500,e.Ncommaaccent=722,e.lacute=278,e.agrave=500,e.Tcommaaccent=667,e.Cacute=722,e.atilde=500,e.Edotaccent=667,e.scaron=389,e.scedilla=389,e.iacute=278,e.lozenge=494,e.Rcaron=722,e.Gcommaaccent=778,e.ucircumflex=556,e.acircumflex=500,e.Amacron=722,e.rcaron=444,e.ccedilla=444,e.Zdotaccent=667,e.Thorn=611,e.Omacron=778,e.Racute=722,e.Sacute=556,e.dcaron=672,e.Umacron=722,e.uring=556,e.threesuperior=300,e.Ograve=778,e.Agrave=722,e.Abreve=722,e.multiply=570,e.uacute=556,e.Tcaron=667,e.partialdiff=494,e.ydieresis=500,e.Nacute=722,e.icircumflex=278,e.Ecircumflex=667,e.adieresis=500,e.edieresis=444,e.cacute=444,e.nacute=556,e.umacron=556,e.Ncaron=722,e.Iacute=389,e.plusminus=570,e.brokenbar=220,e.registered=747,e.Gbreve=778,e.Idotaccent=389,e.summation=600,e.Egrave=667,e.racute=444,e.omacron=500,e.Zacute=667,e.Zcaron=667,e.greaterequal=549,e.Eth=722,e.Ccedilla=722,e.lcommaaccent=278,e.tcaron=416,e.eogonek=444,e.Uogonek=722,e.Aacute=722,e.Adieresis=722,e.egrave=444,e.zacute=444,e.iogonek=278,e.Oacute=778,e.oacute=500,e.amacron=500,e.sacute=389,e.idieresis=278,e.Ocircumflex=778,e.Ugrave=722,e.Delta=612,e.thorn=556,e.twosuperior=300,e.Odieresis=778,e.mu=556,e.igrave=278,e.ohungarumlaut=500,e.Eogonek=667,e.dcroat=556,e.threequarters=750,e.Scedilla=556,e.lcaron=394,e.Kcommaaccent=778,e.Lacute=667,e.trademark=1e3,e.edotaccent=444,e.Igrave=389,e.Imacron=389,e.Lcaron=667,e.onehalf=750,e.lessequal=549,e.ocircumflex=500,e.ntilde=556,e.Uhungarumlaut=722,e.Eacute=667,e.emacron=444,e.gbreve=500,e.onequarter=750,e.Scaron=556,e.Scommaaccent=556,e.Ohungarumlaut=778,e.degree=400,e.ograve=500,e.Ccaron=722,e.ugrave=556,e.radical=549,e.Dcaron=722,e.rcommaaccent=444,e.Ntilde=722,e.otilde=500,e.Rcommaaccent=722,e.Lcommaaccent=667,e.Atilde=722,e.Aogonek=722,e.Aring=722,e.Otilde=778,e.zdotaccent=444,e.Ecaron=667,e.Iogonek=389,e.kcommaaccent=556,e.minus=570,e.Icircumflex=389,e.ncaron=556,e.tcommaaccent=333,e.logicalnot=570,e.odieresis=500,e.udieresis=556,e.notequal=549,e.gcommaaccent=500,e.eth=500,e.zcaron=444,e.ncommaaccent=556,e.onesuperior=300,e.imacron=278,e.Euro=500}),n["Times-BoldItalic"]=Si(function(e){e.space=250,e.exclam=389,e.quotedbl=555,e.numbersign=500,e.dollar=500,e.percent=833,e.ampersand=778,e.quoteright=333,e.parenleft=333,e.parenright=333,e.asterisk=500,e.plus=570,e.comma=250,e.hyphen=333,e.period=250,e.slash=278,e.zero=500,e.one=500,e.two=500,e.three=500,e.four=500,e.five=500,e.six=500,e.seven=500,e.eight=500,e.nine=500,e.colon=333,e.semicolon=333,e.less=570,e.equal=570,e.greater=570,e.question=500,e.at=832,e.A=667,e.B=667,e.C=667,e.D=722,e.E=667,e.F=667,e.G=722,e.H=778,e.I=389,e.J=500,e.K=667,e.L=611,e.M=889,e.N=722,e.O=722,e.P=611,e.Q=722,e.R=667,e.S=556,e.T=611,e.U=722,e.V=667,e.W=889,e.X=667,e.Y=611,e.Z=611,e.bracketleft=333,e.backslash=278,e.bracketright=333,e.asciicircum=570,e.underscore=500,e.quoteleft=333,e.a=500,e.b=500,e.c=444,e.d=500,e.e=444,e.f=333,e.g=500,e.h=556,e.i=278,e.j=278,e.k=500,e.l=278,e.m=778,e.n=556,e.o=500,e.p=500,e.q=500,e.r=389,e.s=389,e.t=278,e.u=556,e.v=444,e.w=667,e.x=500,e.y=444,e.z=389,e.braceleft=348,e.bar=220,e.braceright=348,e.asciitilde=570,e.exclamdown=389,e.cent=500,e.sterling=500,e.fraction=167,e.yen=500,e.florin=500,e.section=500,e.currency=500,e.quotesingle=278,e.quotedblleft=500,e.guillemotleft=500,e.guilsinglleft=333,e.guilsinglright=333,e.fi=556,e.fl=556,e.endash=500,e.dagger=500,e.daggerdbl=500,e.periodcentered=250,e.paragraph=500,e.bullet=350,e.quotesinglbase=333,e.quotedblbase=500,e.quotedblright=500,e.guillemotright=500,e.ellipsis=1e3,e.perthousand=1e3,e.questiondown=500,e.grave=333,e.acute=333,e.circumflex=333,e.tilde=333,e.macron=333,e.breve=333,e.dotaccent=333,e.dieresis=333,e.ring=333,e.cedilla=333,e.hungarumlaut=333,e.ogonek=333,e.caron=333,e.emdash=1e3,e.AE=944,e.ordfeminine=266,e.Lslash=611,e.Oslash=722,e.OE=944,e.ordmasculine=300,e.ae=722,e.dotlessi=278,e.lslash=278,e.oslash=500,e.oe=722,e.germandbls=500,e.Idieresis=389,e.eacute=444,e.abreve=500,e.uhungarumlaut=556,e.ecaron=444,e.Ydieresis=611,e.divide=570,e.Yacute=611,e.Acircumflex=667,e.aacute=500,e.Ucircumflex=722,e.yacute=444,e.scommaaccent=389,e.ecircumflex=444,e.Uring=722,e.Udieresis=722,e.aogonek=500,e.Uacute=722,e.uogonek=556,e.Edieresis=667,e.Dcroat=722,e.commaaccent=250,e.copyright=747,e.Emacron=667,e.ccaron=444,e.aring=500,e.Ncommaaccent=722,e.lacute=278,e.agrave=500,e.Tcommaaccent=611,e.Cacute=667,e.atilde=500,e.Edotaccent=667,e.scaron=389,e.scedilla=389,e.iacute=278,e.lozenge=494,e.Rcaron=667,e.Gcommaaccent=722,e.ucircumflex=556,e.acircumflex=500,e.Amacron=667,e.rcaron=389,e.ccedilla=444,e.Zdotaccent=611,e.Thorn=611,e.Omacron=722,e.Racute=667,e.Sacute=556,e.dcaron=608,e.Umacron=722,e.uring=556,e.threesuperior=300,e.Ograve=722,e.Agrave=667,e.Abreve=667,e.multiply=570,e.uacute=556,e.Tcaron=611,e.partialdiff=494,e.ydieresis=444,e.Nacute=722,e.icircumflex=278,e.Ecircumflex=667,e.adieresis=500,e.edieresis=444,e.cacute=444,e.nacute=556,e.umacron=556,e.Ncaron=722,e.Iacute=389,e.plusminus=570,e.brokenbar=220,e.registered=747,e.Gbreve=722,e.Idotaccent=389,e.summation=600,e.Egrave=667,e.racute=389,e.omacron=500,e.Zacute=611,e.Zcaron=611,e.greaterequal=549,e.Eth=722,e.Ccedilla=667,e.lcommaaccent=278,e.tcaron=366,e.eogonek=444,e.Uogonek=722,e.Aacute=667,e.Adieresis=667,e.egrave=444,e.zacute=389,e.iogonek=278,e.Oacute=722,e.oacute=500,e.amacron=500,e.sacute=389,e.idieresis=278,e.Ocircumflex=722,e.Ugrave=722,e.Delta=612,e.thorn=500,e.twosuperior=300,e.Odieresis=722,e.mu=576,e.igrave=278,e.ohungarumlaut=500,e.Eogonek=667,e.dcroat=500,e.threequarters=750,e.Scedilla=556,e.lcaron=382,e.Kcommaaccent=667,e.Lacute=611,e.trademark=1e3,e.edotaccent=444,e.Igrave=389,e.Imacron=389,e.Lcaron=611,e.onehalf=750,e.lessequal=549,e.ocircumflex=500,e.ntilde=556,e.Uhungarumlaut=722,e.Eacute=667,e.emacron=444,e.gbreve=500,e.onequarter=750,e.Scaron=556,e.Scommaaccent=556,e.Ohungarumlaut=722,e.degree=400,e.ograve=500,e.Ccaron=667,e.ugrave=556,e.radical=549,e.Dcaron=722,e.rcommaaccent=389,e.Ntilde=722,e.otilde=500,e.Rcommaaccent=667,e.Lcommaaccent=611,e.Atilde=667,e.Aogonek=667,e.Aring=667,e.Otilde=722,e.zdotaccent=389,e.Ecaron=667,e.Iogonek=389,e.kcommaaccent=500,e.minus=606,e.Icircumflex=389,e.ncaron=556,e.tcommaaccent=278,e.logicalnot=606,e.odieresis=500,e.udieresis=556,e.notequal=549,e.gcommaaccent=500,e.eth=500,e.zcaron=389,e.ncommaaccent=556,e.onesuperior=300,e.imacron=278,e.Euro=500}),n["Times-Italic"]=Si(function(e){e.space=250,e.exclam=333,e.quotedbl=420,e.numbersign=500,e.dollar=500,e.percent=833,e.ampersand=778,e.quoteright=333,e.parenleft=333,e.parenright=333,e.asterisk=500,e.plus=675,e.comma=250,e.hyphen=333,e.period=250,e.slash=278,e.zero=500,e.one=500,e.two=500,e.three=500,e.four=500,e.five=500,e.six=500,e.seven=500,e.eight=500,e.nine=500,e.colon=333,e.semicolon=333,e.less=675,e.equal=675,e.greater=675,e.question=500,e.at=920,e.A=611,e.B=611,e.C=667,e.D=722,e.E=611,e.F=611,e.G=722,e.H=722,e.I=333,e.J=444,e.K=667,e.L=556,e.M=833,e.N=667,e.O=722,e.P=611,e.Q=722,e.R=611,e.S=500,e.T=556,e.U=722,e.V=611,e.W=833,e.X=611,e.Y=556,e.Z=556,e.bracketleft=389,e.backslash=278,e.bracketright=389,e.asciicircum=422,e.underscore=500,e.quoteleft=333,e.a=500,e.b=500,e.c=444,e.d=500,e.e=444,e.f=278,e.g=500,e.h=500,e.i=278,e.j=278,e.k=444,e.l=278,e.m=722,e.n=500,e.o=500,e.p=500,e.q=500,e.r=389,e.s=389,e.t=278,e.u=500,e.v=444,e.w=667,e.x=444,e.y=444,e.z=389,e.braceleft=400,e.bar=275,e.braceright=400,e.asciitilde=541,e.exclamdown=389,e.cent=500,e.sterling=500,e.fraction=167,e.yen=500,e.florin=500,e.section=500,e.currency=500,e.quotesingle=214,e.quotedblleft=556,e.guillemotleft=500,e.guilsinglleft=333,e.guilsinglright=333,e.fi=500,e.fl=500,e.endash=500,e.dagger=500,e.daggerdbl=500,e.periodcentered=250,e.paragraph=523,e.bullet=350,e.quotesinglbase=333,e.quotedblbase=556,e.quotedblright=556,e.guillemotright=500,e.ellipsis=889,e.perthousand=1e3,e.questiondown=500,e.grave=333,e.acute=333,e.circumflex=333,e.tilde=333,e.macron=333,e.breve=333,e.dotaccent=333,e.dieresis=333,e.ring=333,e.cedilla=333,e.hungarumlaut=333,e.ogonek=333,e.caron=333,e.emdash=889,e.AE=889,e.ordfeminine=276,e.Lslash=556,e.Oslash=722,e.OE=944,e.ordmasculine=310,e.ae=667,e.dotlessi=278,e.lslash=278,e.oslash=500,e.oe=667,e.germandbls=500,e.Idieresis=333,e.eacute=444,e.abreve=500,e.uhungarumlaut=500,e.ecaron=444,e.Ydieresis=556,e.divide=675,e.Yacute=556,e.Acircumflex=611,e.aacute=500,e.Ucircumflex=722,e.yacute=444,e.scommaaccent=389,e.ecircumflex=444,e.Uring=722,e.Udieresis=722,e.aogonek=500,e.Uacute=722,e.uogonek=500,e.Edieresis=611,e.Dcroat=722,e.commaaccent=250,e.copyright=760,e.Emacron=611,e.ccaron=444,e.aring=500,e.Ncommaaccent=667,e.lacute=278,e.agrave=500,e.Tcommaaccent=556,e.Cacute=667,e.atilde=500,e.Edotaccent=611,e.scaron=389,e.scedilla=389,e.iacute=278,e.lozenge=471,e.Rcaron=611,e.Gcommaaccent=722,e.ucircumflex=500,e.acircumflex=500,e.Amacron=611,e.rcaron=389,e.ccedilla=444,e.Zdotaccent=556,e.Thorn=611,e.Omacron=722,e.Racute=611,e.Sacute=500,e.dcaron=544,e.Umacron=722,e.uring=500,e.threesuperior=300,e.Ograve=722,e.Agrave=611,e.Abreve=611,e.multiply=675,e.uacute=500,e.Tcaron=556,e.partialdiff=476,e.ydieresis=444,e.Nacute=667,e.icircumflex=278,e.Ecircumflex=611,e.adieresis=500,e.edieresis=444,e.cacute=444,e.nacute=500,e.umacron=500,e.Ncaron=667,e.Iacute=333,e.plusminus=675,e.brokenbar=275,e.registered=760,e.Gbreve=722,e.Idotaccent=333,e.summation=600,e.Egrave=611,e.racute=389,e.omacron=500,e.Zacute=556,e.Zcaron=556,e.greaterequal=549,e.Eth=722,e.Ccedilla=667,e.lcommaaccent=278,e.tcaron=300,e.eogonek=444,e.Uogonek=722,e.Aacute=611,e.Adieresis=611,e.egrave=444,e.zacute=389,e.iogonek=278,e.Oacute=722,e.oacute=500,e.amacron=500,e.sacute=389,e.idieresis=278,e.Ocircumflex=722,e.Ugrave=722,e.Delta=612,e.thorn=500,e.twosuperior=300,e.Odieresis=722,e.mu=500,e.igrave=278,e.ohungarumlaut=500,e.Eogonek=611,e.dcroat=500,e.threequarters=750,e.Scedilla=500,e.lcaron=300,e.Kcommaaccent=667,e.Lacute=556,e.trademark=980,e.edotaccent=444,e.Igrave=333,e.Imacron=333,e.Lcaron=611,e.onehalf=750,e.lessequal=549,e.ocircumflex=500,e.ntilde=500,e.Uhungarumlaut=722,e.Eacute=611,e.emacron=444,e.gbreve=500,e.onequarter=750,e.Scaron=500,e.Scommaaccent=500,e.Ohungarumlaut=722,e.degree=400,e.ograve=500,e.Ccaron=667,e.ugrave=500,e.radical=453,e.Dcaron=722,e.rcommaaccent=389,e.Ntilde=667,e.otilde=500,e.Rcommaaccent=611,e.Lcommaaccent=556,e.Atilde=611,e.Aogonek=611,e.Aring=611,e.Otilde=722,e.zdotaccent=389,e.Ecaron=611,e.Iogonek=333,e.kcommaaccent=444,e.minus=675,e.Icircumflex=333,e.ncaron=500,e.tcommaaccent=278,e.logicalnot=675,e.odieresis=500,e.udieresis=500,e.notequal=549,e.gcommaaccent=500,e.eth=500,e.zcaron=389,e.ncommaaccent=500,e.onesuperior=300,e.imacron=278,e.Euro=500}),n.ZapfDingbats=Si(function(e){e.space=278,e.a1=974,e.a2=961,e.a202=974,e.a3=980,e.a4=719,e.a5=789,e.a119=790,e.a118=791,e.a117=690,e.a11=960,e.a12=939,e.a13=549,e.a14=855,e.a15=911,e.a16=933,e.a105=911,e.a17=945,e.a18=974,e.a19=755,e.a20=846,e.a21=762,e.a22=761,e.a23=571,e.a24=677,e.a25=763,e.a26=760,e.a27=759,e.a28=754,e.a6=494,e.a7=552,e.a8=537,e.a9=577,e.a10=692,e.a29=786,e.a30=788,e.a31=788,e.a32=790,e.a33=793,e.a34=794,e.a35=816,e.a36=823,e.a37=789,e.a38=841,e.a39=823,e.a40=833,e.a41=816,e.a42=831,e.a43=923,e.a44=744,e.a45=723,e.a46=749,e.a47=790,e.a48=792,e.a49=695,e.a50=776,e.a51=768,e.a52=792,e.a53=759,e.a54=707,e.a55=708,e.a56=682,e.a57=701,e.a58=826,e.a59=815,e.a60=789,e.a61=789,e.a62=707,e.a63=687,e.a64=696,e.a65=689,e.a66=786,e.a67=787,e.a68=713,e.a69=791,e.a70=785,e.a71=791,e.a72=873,e.a73=761,e.a74=762,e.a203=762,e.a75=759,e.a204=759,e.a76=892,e.a77=892,e.a78=788,e.a79=784,e.a81=438,e.a82=138,e.a83=277,e.a84=415,e.a97=392,e.a98=392,e.a99=668,e.a100=668,e.a89=390,e.a90=390,e.a93=317,e.a94=317,e.a91=276,e.a92=276,e.a205=509,e.a85=509,e.a206=410,e.a86=410,e.a87=234,e.a88=234,e.a95=334,e.a96=334,e.a101=732,e.a102=544,e.a103=544,e.a104=910,e.a106=667,e.a107=760,e.a108=760,e.a112=776,e.a111=595,e.a110=694,e.a109=626,e.a120=788,e.a121=788,e.a122=788,e.a123=788,e.a124=788,e.a125=788,e.a126=788,e.a127=788,e.a128=788,e.a129=788,e.a130=788,e.a131=788,e.a132=788,e.a133=788,e.a134=788,e.a135=788,e.a136=788,e.a137=788,e.a138=788,e.a139=788,e.a140=788,e.a141=788,e.a142=788,e.a143=788,e.a144=788,e.a145=788,e.a146=788,e.a147=788,e.a148=788,e.a149=788,e.a150=788,e.a151=788,e.a152=788,e.a153=788,e.a154=788,e.a155=788,e.a156=788,e.a157=788,e.a158=788,e.a159=788,e.a160=894,e.a161=838,e.a163=1016,e.a164=458,e.a196=748,e.a165=924,e.a192=748,e.a166=918,e.a167=927,e.a168=928,e.a169=928,e.a170=834,e.a171=873,e.a172=828,e.a173=924,e.a162=924,e.a174=917,e.a175=930,e.a176=931,e.a177=463,e.a178=883,e.a179=836,e.a193=836,e.a180=867,e.a199=867,e.a181=696,e.a200=696,e.a182=874,e.a201=874,e.a183=760,e.a184=946,e.a197=771,e.a185=865,e.a194=771,e.a198=888,e.a186=967,e.a195=888,e.a187=831,e.a188=873,e.a189=927,e.a190=970,e.a191=918})}),Lz=Si(function(n){n.Courier={ascent:629,descent:-157,capHeight:562,xHeight:-426},n["Courier-Bold"]={ascent:629,descent:-157,capHeight:562,xHeight:439},n["Courier-Oblique"]={ascent:629,descent:-157,capHeight:562,xHeight:426},n["Courier-BoldOblique"]={ascent:629,descent:-157,capHeight:562,xHeight:426},n.Helvetica={ascent:718,descent:-207,capHeight:718,xHeight:523},n["Helvetica-Bold"]={ascent:718,descent:-207,capHeight:718,xHeight:532},n["Helvetica-Oblique"]={ascent:718,descent:-207,capHeight:718,xHeight:523},n["Helvetica-BoldOblique"]={ascent:718,descent:-207,capHeight:718,xHeight:532},n["Times-Roman"]={ascent:683,descent:-217,capHeight:662,xHeight:450},n["Times-Bold"]={ascent:683,descent:-217,capHeight:676,xHeight:461},n["Times-Italic"]={ascent:683,descent:-217,capHeight:653,xHeight:441},n["Times-BoldItalic"]={ascent:683,descent:-217,capHeight:669,xHeight:462},n.Symbol={ascent:Math.NaN,descent:Math.NaN,capHeight:Math.NaN,xHeight:Math.NaN},n.ZapfDingbats={ascent:Math.NaN,descent:Math.NaN,capHeight:Math.NaN,xHeight:Math.NaN}}),Bz=1,Jx=2,Zx=4,bk=8,Sm=16,Im=32,Uz=64,Em=1,Qx=2,Hz=8,zz=32,jz=64,Gz=128,vw=256;class Vz{constructor({glyfTable:e,isGlyphLocationsLong:t,locaTable:i,numGlyphs:s}){this.glyphs=[];const r=new DataView(i.buffer,i.byteOffset,i.byteLength),a=new DataView(e.buffer,e.byteOffset,e.byteLength),o=t?4:2;let l=t?r.getUint32(0):2*r.getUint16(0),c=0;for(let h=0;h<s;h++){c+=o;const u=t?r.getUint32(c):2*r.getUint16(c);if(u===l){this.glyphs.push(new qp({}));continue}const d=qp.parse(l,a);this.glyphs.push(d),l=u}}getSize(){return Math.sumPrecise(this.glyphs.map(e=>e.getSize()+3&-4))}write(){const e=this.getSize(),t=new DataView(new ArrayBuffer(e)),i=e>131070,s=i?4:2,r=new DataView(new ArrayBuffer((this.glyphs.length+1)*s));i?r.setUint32(0,0):r.setUint16(0,0);let a=0,o=0;for(const l of this.glyphs)a+=l.write(a,t),a=a+3&-4,o+=s,i?r.setUint32(o,a):r.setUint16(o,a>>1);return{isLocationLong:i,loca:new Uint8Array(r.buffer),glyf:new Uint8Array(t.buffer)}}scale(e){for(let t=0,i=this.glyphs.length;t<i;t++)this.glyphs[t].scale(e[t])}}class qp{constructor({header:e=null,simple:t=null,composites:i=null}){this.header=e,this.simple=t,this.composites=i}static parse(e,t){const[i,s]=R4.parse(e,t);if(e+=i,s.numberOfContours<0){const a=[];for(;;){const[o,l]=P4.parse(e,t);if(e+=o,a.push(l),!(l.flags&zz))break}return new qp({header:s,composites:a})}const r=M4.parse(e,t,s.numberOfContours);return new qp({header:s,simple:r})}getSize(){if(!this.header)return 0;const e=this.simple?this.simple.getSize():Math.sumPrecise(this.composites.map(t=>t.getSize()));return this.header.getSize()+e}write(e,t){if(!this.header)return 0;const i=e;if(e+=this.header.write(e,t),this.simple)e+=this.simple.write(e,t);else for(const s of this.composites)e+=s.write(e,t);return e-i}scale(e){if(!this.header)return;const t=(this.header.xMin+this.header.xMax)/2;if(this.header.scale(t,e),this.simple)this.simple.scale(t,e);else for(const i of this.composites)i.scale(t,e)}}class R4{constructor({numberOfContours:e,xMin:t,yMin:i,xMax:s,yMax:r}){this.numberOfContours=e,this.xMin=t,this.yMin=i,this.xMax=s,this.yMax=r}static parse(e,t){return[10,new R4({numberOfContours:t.getInt16(e),xMin:t.getInt16(e+2),yMin:t.getInt16(e+4),xMax:t.getInt16(e+6),yMax:t.getInt16(e+8)})]}getSize(){return 10}write(e,t){return t.setInt16(e,this.numberOfContours),t.setInt16(e+2,this.xMin),t.setInt16(e+4,this.yMin),t.setInt16(e+6,this.xMax),t.setInt16(e+8,this.yMax),10}scale(e,t){this.xMin=Math.round(e+(this.xMin-e)*t),this.xMax=Math.round(e+(this.xMax-e)*t)}}class qz{constructor({flags:e,xCoordinates:t,yCoordinates:i}){this.xCoordinates=t,this.yCoordinates=i,this.flags=e}}class M4{constructor({contours:e,instructions:t}){this.contours=e,this.instructions=t}static parse(e,t,i){const s=[];for(let x=0;x<i;x++){const p=t.getUint16(e);e+=2,s.push(p)}const r=s[i-1]+1,a=t.getUint16(e);e+=2;const o=new Uint8Array(t).slice(e,e+a);e+=a;const l=[];for(let x=0;x<r;e++,x++){let p=t.getUint8(e);if(l.push(p),p&bk){const y=t.getUint8(++e);p^=bk;for(let w=0;w<y;w++)l.push(p);x+=y}}const c=[];let h=[],u=[],d=[];const f=[];let g=0,m=0;for(let x=0;x<r;x++){const p=l[x];if(p&Jx){const y=t.getUint8(e++);m+=p&Sm?y:-y,h.push(m)}else p&Sm||(m+=t.getInt16(e),e+=2),h.push(m);s[g]===x&&(g++,c.push(h),h=[])}m=0,g=0;for(let x=0;x<r;x++){const p=l[x];if(p&Zx){const y=t.getUint8(e++);m+=p&Im?y:-y,u.push(m)}else p&Im||(m+=t.getInt16(e),e+=2),u.push(m);d.push(p&Bz|p&Uz),s[g]===x&&(h=c[g],g++,f.push(new qz({flags:d,xCoordinates:h,yCoordinates:u})),u=[],d=[])}return new M4({contours:f,instructions:o})}getSize(){let e=this.contours.length*2+2+this.instructions.length,t=0,i=0;for(const s of this.contours){e+=s.flags.length;for(let r=0,a=s.xCoordinates.length;r<a;r++){const o=s.xCoordinates[r],l=s.yCoordinates[r];let c=Math.abs(o-t);c>255?e+=2:c>0&&(e+=1),t=o,c=Math.abs(l-i),c>255?e+=2:c>0&&(e+=1),i=l}}return e}write(e,t){const i=e,s=[],r=[],a=[];let o=0,l=0;for(const c of this.contours){for(let h=0,u=c.xCoordinates.length;h<u;h++){let d=c.flags[h];const f=c.xCoordinates[h];let g=f-o;if(g===0)d|=Sm,s.push(0);else{const x=Math.abs(g);x<=255?(d|=g>=0?Jx|Sm:Jx,s.push(x)):s.push(g)}o=f;const m=c.yCoordinates[h];if(g=m-l,g===0)d|=Im,r.push(0);else{const x=Math.abs(g);x<=255?(d|=g>=0?Zx|Im:Zx,r.push(x)):r.push(g)}l=m,a.push(d)}t.setUint16(e,s.length-1),e+=2}t.setUint16(e,this.instructions.length),e+=2,this.instructions.length&&(new Uint8Array(t.buffer,0,t.buffer.byteLength).set(this.instructions,e),e+=this.instructions.length);for(const c of a)t.setUint8(e++,c);for(let c=0,h=s.length;c<h;c++){const u=s[c],d=a[c];d&Jx?t.setUint8(e++,u):d&Sm||(t.setInt16(e,u),e+=2)}for(let c=0,h=r.length;c<h;c++){const u=r[c],d=a[c];d&Zx?t.setUint8(e++,u):d&Im||(t.setInt16(e,u),e+=2)}return e-i}scale(e,t){for(const i of this.contours)if(i.xCoordinates.length!==0)for(let s=0,r=i.xCoordinates.length;s<r;s++)i.xCoordinates[s]=Math.round(e+(i.xCoordinates[s]-e)*t)}}class P4{constructor({flags:e,glyphIndex:t,argument1:i,argument2:s,transf:r,instructions:a}){this.flags=e,this.glyphIndex=t,this.argument1=i,this.argument2=s,this.transf=r,this.instructions=a}static parse(e,t){const i=e,s=[];let r=t.getUint16(e);const a=t.getUint16(e+2);e+=4;let o,l;r&Em?(r&Qx?(o=t.getInt16(e),l=t.getInt16(e+2)):(o=t.getUint16(e),l=t.getUint16(e+2)),e+=4,r^=Em):(r&Qx?(o=t.getInt8(e),l=t.getInt8(e+1)):(o=t.getUint8(e),l=t.getUint8(e+1)),e+=2),r&Hz?(s.push(t.getUint16(e)),e+=2):r&jz?(s.push(t.getUint16(e),t.getUint16(e+2)),e+=4):r&Gz&&(s.push(t.getUint16(e),t.getUint16(e+2),t.getUint16(e+4),t.getUint16(e+6)),e+=8);let c=null;if(r&vw){const h=t.getUint16(e);e+=2,c=new Uint8Array(t).slice(e,e+h),e+=h}return[e-i,new P4({flags:r,glyphIndex:a,argument1:o,argument2:l,transf:s,instructions:c})]}getSize(){let e=4+this.transf.length*2;return this.flags&vw&&(e+=2+this.instructions.length),e+=2,this.flags&2?this.argument1>=-128&&this.argument1<=127&&this.argument2>=-128&&this.argument2<=127||(e+=2):this.argument1>=0&&this.argument1<=255&&this.argument2>=0&&this.argument2<=255||(e+=2),e}write(e,t){const i=e;return this.flags&Qx?this.argument1>=-128&&this.argument1<=127&&this.argument2>=-128&&this.argument2<=127||(this.flags|=Em):this.argument1>=0&&this.argument1<=255&&this.argument2>=0&&this.argument2<=255||(this.flags|=Em),t.setUint16(e,this.flags),t.setUint16(e+2,this.glyphIndex),e+=4,this.flags&Em?(this.flags&Qx?(t.setInt16(e,this.argument1),t.setInt16(e+2,this.argument2)):(t.setUint16(e,this.argument1),t.setUint16(e+2,this.argument2)),e+=4):(t.setUint8(e,this.argument1),t.setUint8(e+1,this.argument2),e+=2),this.flags&vw&&(t.setUint16(e,this.instructions.length),e+=2,this.instructions.length&&(new Uint8Array(t.buffer,0,t.buffer.byteLength).set(this.instructions,e),e+=this.instructions.length)),e-i}scale(e,t){}}function $x(n,e,t){n[e]=t>>8&255,n[e+1]=t&255}function kw(n,e,t){n[e]=t>>24&255,n[e+1]=t>>16&255,n[e+2]=t>>8&255,n[e+3]=t&255}function Wz(n,e,t){if(t instanceof Uint8Array)n.set(t,e);else if(typeof t=="string")for(let i=0,s=t.length;i<s;i++)n[e++]=t.charCodeAt(i)&255;else for(const i of t)n[e++]=i&255}const xk=12,yk=16;class Wp{constructor(e){this.sfnt=e,this.tables=Object.create(null)}static getSearchParams(e,t){let i=1,s=0;for(;(i^e)>i;)i<<=1,s++;const r=i*t;return{range:r,entry:s,rangeShift:t*e-r}}toArray(){let e=this.sfnt;const t=this.tables,i=Object.keys(t);i.sort();const s=i.length;let r,a,o,l,c,h=xk+s*yk;const u=[h];for(r=0;r<s;r++){l=t[i[r]];const g=(l.length+3&-4)>>>0;h+=g,u.push(h)}const d=new Uint8Array(h);for(r=0;r<s;r++)l=t[i[r]],Wz(d,u[r],l);e==="true"&&(e=ar(65536)),d[0]=e.charCodeAt(0)&255,d[1]=e.charCodeAt(1)&255,d[2]=e.charCodeAt(2)&255,d[3]=e.charCodeAt(3)&255,$x(d,4,s);const f=Wp.getSearchParams(s,16);for($x(d,6,f.range),$x(d,8,f.entry),$x(d,10,f.rangeShift),h=xk,r=0;r<s;r++){c=i[r],d[h]=c.charCodeAt(0)&255,d[h+1]=c.charCodeAt(1)&255,d[h+2]=c.charCodeAt(2)&255,d[h+3]=c.charCodeAt(3)&255;let g=0;for(a=u[r],o=u[r+1];a<o;a+=4){const m=Yn(d,a);g=g+m>>>0}kw(d,h+4,g),kw(d,h+8,u[r]),kw(d,h+12,t[c].length),h+=yk}return d}addTable(e,t){if(e in this.tables)throw new Error("Table "+e+" already exists");this.tables[e]=t}}const Kz=!1,Nr={hstem:[1],vstem:[3],vmoveto:[4],rlineto:[5],hlineto:[6],vlineto:[7],rrcurveto:[8],callsubr:[10],flex:[12,35],drop:[12,18],endchar:[14],rmoveto:[21],hmoveto:[22],vhcurveto:[30],hvcurveto:[31]};class Xz{constructor(){this.width=0,this.lsb=0,this.flexing=!1,this.output=[],this.stack=[]}convert(e,t,i){const s=e.length;let r=!1,a,o,l;for(let c=0;c<s;c++){let h=e[c];if(h<32){switch(h===12&&(h=(h<<8)+e[++c]),h){case 1:{this.stack=[];break}case 3:{this.stack=[];break}case 4:if(this.flexing){if(this.stack.length<1){r=!0;break}const m=this.stack.pop();this.stack.push(0,m);break}r=this.executeCommand(1,Nr.vmoveto);break;case 5:r=this.executeCommand(2,Nr.rlineto);break;case 6:r=this.executeCommand(1,Nr.hlineto);break;case 7:r=this.executeCommand(1,Nr.vlineto);break;case 8:r=this.executeCommand(6,Nr.rrcurveto);break;case 9:this.stack=[];break;case 10:if(this.stack.length<1){r=!0;break}if(l=this.stack.pop(),!t[l]){r=!0;break}r=this.convert(t[l],t,i);break;case 11:return r;case 13:if(this.stack.length<2){r=!0;break}a=this.stack.pop(),o=this.stack.pop(),this.lsb=o,this.width=a,this.stack.push(a,o),r=this.executeCommand(2,Nr.hmoveto);break;case 14:this.output.push(Nr.endchar[0]);break;case 21:if(this.flexing)break;r=this.executeCommand(2,Nr.rmoveto);break;case 22:if(this.flexing){this.stack.push(0);break}r=this.executeCommand(1,Nr.hmoveto);break;case 30:r=this.executeCommand(4,Nr.vhcurveto);break;case 31:r=this.executeCommand(4,Nr.hvcurveto);break;case 3072:this.stack=[];break;case 3073:{this.stack=[];break}case 3074:{this.stack=[];break}case 3078:if(i){const m=this.stack.at(-5);this.seac=this.stack.splice(-4,4),this.seac[0]+=this.lsb-m,r=this.executeCommand(0,Nr.endchar)}else r=this.executeCommand(4,Nr.endchar);break;case 3079:if(this.stack.length<4){r=!0;break}this.stack.pop(),a=this.stack.pop();const u=this.stack.pop();o=this.stack.pop(),this.lsb=o,this.width=a,this.stack.push(a,o,u),r=this.executeCommand(3,Nr.rmoveto);break;case 3084:if(this.stack.length<2){r=!0;break}const d=this.stack.pop(),f=this.stack.pop();this.stack.push(f/d);break;case 3088:if(this.stack.length<2){r=!0;break}l=this.stack.pop();const g=this.stack.pop();if(l===0&&g===3){const m=this.stack.splice(-17,17);this.stack.push(m[2]+m[0],m[3]+m[1],m[4],m[5],m[6],m[7],m[8],m[9],m[10],m[11],m[12],m[13],m[14]),r=this.executeCommand(13,Nr.flex,!0),this.flexing=!1,this.stack.push(m[15],m[16])}else l===1&&g===0&&(this.flexing=!0);break;case 3089:break;case 3105:this.stack=[];break;default:ce('Unknown type 1 charstring command of "'+h+'"');break}if(r)break;continue}else h<=246?h-=139:h<=250?h=(h-247)*256+e[++c]+108:h<=254?h=-((h-251)*256)-e[++c]-108:h=(e[++c]&255)<<24|(e[++c]&255)<<16|(e[++c]&255)<<8|(e[++c]&255)<<0;this.stack.push(h)}return r}executeCommand(e,t,i){const s=this.stack.length;if(e>s)return!0;const r=s-e;for(let a=r;a<s;a++){let o=this.stack[a];Number.isInteger(o)?this.output.push(28,o>>8&255,o&255):(o=65536*o|0,this.output.push(255,o>>24&255,o>>16&255,o>>8&255,o&255))}return this.output.push(...t),i?this.stack.splice(r,e):this.stack.length=0,!1}}const wk=55665,Yz=4330;function vl(n){return n>=48&&n<=57||n>=65&&n<=70||n>=97&&n<=102}function _k(n,e,t){if(t>=n.length)return new Uint8Array(0);const i=52845,s=22719;let r=e|0,a,o;for(a=0;a<t;a++)r=(n[a]+r)*i+s&65535;const l=n.length-t,c=new Uint8Array(l);for(a=t,o=0;o<l;a++,o++){const h=n[a];c[o]=h^r>>8,r=(h+r)*i+s&65535}return c}function Jz(n,e,t){let r=e|0;const a=n.length,o=a>>>1,l=new Uint8Array(o);let c,h;for(c=0,h=0;c<a;c++){const u=n[c];if(!vl(u))continue;c++;let d;for(;c<a&&!vl(d=n[c]);)c++;if(c<a){const f=parseInt(String.fromCharCode(u,d),16);l[h++]=f^r>>8,r=(f+r)*52845+22719&65535}}return l.slice(t,h)}function vk(n){return n===47||n===91||n===93||n===123||n===125||n===40||n===41}class kk{constructor(e,t,i){if(t){const s=e.getBytes(),r=!((vl(s[0])||qa(s[0]))&&vl(s[1])&&vl(s[2])&&vl(s[3])&&vl(s[4])&&vl(s[5])&&vl(s[6])&&vl(s[7]));e=new Hi(r?_k(s,wk,4):Jz(s,wk,4))}this.seacAnalysisEnabled=!!i,this.stream=e,this.nextChar()}readNumberArray(){this.getToken();const e=[];for(;;){const t=this.getToken();if(t===null||t==="]"||t==="}")break;e.push(parseFloat(t||0))}return e}readNumber(){const e=this.getToken();return parseFloat(e||0)}readInt(){const e=this.getToken();return parseInt(e||0,10)|0}readBoolean(){return this.getToken()==="true"?1:0}nextChar(){return this.currentChar=this.stream.getByte()}prevChar(){return this.stream.skip(-2),this.currentChar=this.stream.getByte()}getToken(){let e=!1,t=this.currentChar;for(;;){if(t===-1)return null;if(e)(t===10||t===13)&&(e=!1);else if(t===37)e=!0;else if(!qa(t))break;t=this.nextChar()}if(vk(t))return this.nextChar(),String.fromCharCode(t);let i="";do i+=String.fromCharCode(t),t=this.nextChar();while(t>=0&&!qa(t)&&!vk(t));return i}readCharStrings(e,t){return t===-1?e:_k(e,Yz,t)}extractFontProgram(e){const t=this.stream,i=[],s=[],r=Object.create(null);r.lenIV=4;const a={subrs:[],charstrings:[],properties:{privateData:r}};let o,l,c,h;for(;(o=this.getToken())!==null;)if(o==="/")switch(o=this.getToken(),o){case"CharStrings":for(this.getToken(),this.getToken(),this.getToken(),this.getToken();o=this.getToken(),!(o===null||o==="end");){if(o!=="/")continue;const d=this.getToken();l=this.readInt(),this.getToken(),c=l>0?t.getBytes(l):new Uint8Array(0),h=a.properties.privateData.lenIV;const f=this.readCharStrings(c,h);this.nextChar(),o=this.getToken(),o==="noaccess"?this.getToken():o==="/"&&this.prevChar(),s.push({glyph:d,encoded:f})}break;case"Subrs":for(this.readInt(),this.getToken();this.getToken()==="dup";){const d=this.readInt();l=this.readInt(),this.getToken(),c=l>0?t.getBytes(l):new Uint8Array(0),h=a.properties.privateData.lenIV;const f=this.readCharStrings(c,h);this.nextChar(),o=this.getToken(),o==="noaccess"&&this.getToken(),i[d]=f}break;case"BlueValues":case"OtherBlues":case"FamilyBlues":case"FamilyOtherBlues":const u=this.readNumberArray();u.length>0&&u.length%2===0&&Kz&&(a.properties.privateData[o]=u);break;case"StemSnapH":case"StemSnapV":a.properties.privateData[o]=this.readNumberArray();break;case"StdHW":case"StdVW":a.properties.privateData[o]=this.readNumberArray()[0];break;case"BlueShift":case"lenIV":case"BlueFuzz":case"BlueScale":case"LanguageGroup":a.properties.privateData[o]=this.readNumber();break;case"ExpansionFactor":a.properties.privateData[o]=this.readNumber()||.06;break;case"ForceBold":a.properties.privateData[o]=this.readBoolean();break}for(const{encoded:u,glyph:d}of s){const f=new Xz,g=f.convert(u,i,this.seacAnalysisEnabled);let m=f.output;g&&(m=[14]);const x={glyphName:d,charstring:m,width:f.width,lsb:f.lsb,seac:f.seac};if(d===".notdef"?a.charstrings.unshift(x):a.charstrings.push(x),e.builtInEncoding){const p=e.builtInEncoding.indexOf(d);p>-1&&e.widths[p]===void 0&&p>=e.firstChar&&p<=e.lastChar&&(e.widths[p]=f.width)}}return a}extractFontHeader(e){let t;for(;(t=this.getToken())!==null;)if(t==="/")switch(t=this.getToken(),t){case"FontMatrix":const i=this.readNumberArray();e.fontMatrix=i;break;case"Encoding":const s=this.getToken();let r;if(!/^\d+$/.test(s))r=jp(s);else{r=[];const o=parseInt(s,10)|0;this.getToken();for(let l=0;l<o;l++){for(t=this.getToken();t!=="dup"&&t!=="def";)if(t=this.getToken(),t===null)return;if(t==="def")break;const c=this.readInt();this.getToken();const h=this.getToken();r[c]=h,this.getToken()}}e.builtInEncoding=r;break;case"FontBBox":const a=this.readNumberArray();e.ascent=Math.max(a[3],a[1]),e.descent=Math.min(a[1],a[3]),e.ascentScaled=!0;break}}}function Ck(n,e,t){const i=n.length,s=e.length,r=i-s;let a=t,o=!1;for(;a<r;){let l=0;for(;l<s&&n[a+l]===e[l];)l++;if(l>=s){for(a+=l;a<i&&qa(n[a]);)a++;o=!0;break}a++}return{found:o,length:a}}function Zz(n,e){const t=[101,101,120,101,99],i=n.pos;let s,r,a;try{s=n.getBytes(e),r=s.length}catch{}if(r===e&&(a=Ck(s,t,e-2*t.length),a.found&&a.length===e))return{stream:new Hi(s),length:e};ce('Invalid "Length1" property in Type1 font -- trying to recover.'),n.pos=i;const o=2048;let l;for(;;){const c=n.peekBytes(o);if(a=Ck(c,t,0),a.length===0)break;if(n.pos+=a.length,a.found){l=n.pos-i;break}}return n.pos=i,l?{stream:new Hi(n.getBytes(l)),length:l}:(ce('Unable to recover "Length1" property in Type1 font -- using as is.'),{stream:new Hi(n.getBytes(e)),length:e})}function Qz(n,e){const t=n.getBytes();if(t.length===0)throw new Te("getEexecBlock - no font program found.");return{stream:new Hi(t),length:t.length}}class $z{constructor(e,t,i){let r=i.length1;i.length2;let a=t.peekBytes(6);const o=a[0]===128&&a[1]===1;o&&(t.skip(6),r=a[5]<<24|a[4]<<16|a[3]<<8|a[2]);const l=Zz(t,r);new kk(l.stream,!1,s1).extractFontHeader(i),o&&(a=t.getBytes(6),a[5]<<24|a[4]<<16|a[3]<<8|a[2]);const h=Qz(t),d=new kk(h.stream,!0,s1).extractFontProgram(i);for(const x in d.properties)i[x]=d.properties[x];const f=d.charstrings,g=this.getType2Charstrings(f),m=this.getType2Subrs(d.subrs);this.charstrings=f,this.data=this.wrap(e,g,this.charstrings,m,i),this.seacs=this.getSeacs(d.charstrings)}get numGlyphs(){return this.charstrings.length+1}getCharset(){const e=[".notdef"];for(const{glyphName:t}of this.charstrings)e.push(t);return e}getGlyphMapping(e){const t=this.charstrings;if(e.composite){const o=Object.create(null);for(let l=0,c=t.length;l<c;l++){const h=e.cMap.charCodeOf(l);o[h]=l+1}return o}const i=[".notdef"];let s,r;for(r=0;r<t.length;r++)i.push(t[r].glyphName);const a=e.builtInEncoding;if(a){s=Object.create(null);for(const o in a)r=i.indexOf(a[o]),r>=0&&(s[o]=r)}return UR(e,s,i)}hasGlyphId(e){return e<0||e>=this.numGlyphs?!1:e===0?!0:this.charstrings[e-1].charstring.length>0}getSeacs(e){const t=[];for(let i=0,s=e.length;i<s;i++){const r=e[i];r.seac&&(t[i+1]=r.seac)}return t}getType2Charstrings(e){const t=[];for(const i of e)t.push(i.charstring);return t}getType2Subrs(e){let t=0;const i=e.length;i<1133?t=107:i<33769?t=1131:t=32768;const s=[];let r;for(r=0;r<t;r++)s.push([11]);for(r=0;r<i;r++)s.push(e[r]);return s}wrap(e,t,i,s,r){const a=new HR;a.header=new zR(1,0,4,4),a.names=[e];const o=new Gp;o.setByName("version",391),o.setByName("Notice",392),o.setByName("FullName",393),o.setByName("FamilyName",394),o.setByName("Weight",395),o.setByName("Encoding",null),o.setByName("FontMatrix",r.fontMatrix),o.setByName("FontBBox",r.bbox),o.setByName("charset",null),o.setByName("CharStrings",null),o.setByName("Private",null),a.topDict=o;const l=new E4;l.add("Version 0.11"),l.add("See original notice"),l.add(e),l.add(e),l.add("Medium"),a.strings=l,a.globalSubrIndex=new Ph;const c=t.length,h=[".notdef"];let u,d;for(u=0;u<c;u++){const y=i[u].glyphName;s3.indexOf(y)===-1&&l.add(y),h.push(y)}a.charset=new lp(!1,0,h);const f=new Ph;for(f.add([139,14]),u=0;u<c;u++)f.add(t[u]);a.charStrings=f;const g=new Vp;g.setByName("Subrs",null);const m=["BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StemSnapH","StemSnapV","BlueShift","BlueFuzz","BlueScale","LanguageGroup","ExpansionFactor","ForceBold","StdHW","StdVW"];for(u=0,d=m.length;u<d;u++){const y=m[u];if(!(y in r.privateData))continue;const w=r.privateData[y];if(Array.isArray(w))for(let _=w.length-1;_>0;_--)w[_]-=w[_-1];g.setByName(y,w)}a.topDict.privateDict=g;const x=new Ph;for(u=0,d=s.length;u<d;u++)x.add(s[u]);return g.subrsIndex=x,new fx(a).compile()}}const cc=[[57344,63743],[1048576,1114109]],ou=1e3,Ak=["ascent","bbox","black","bold","charProcOperatorList","cssFontInfo","data","defaultVMetrics","defaultWidth","descent","disableFontFace","fallbackName","fontExtraProperties","fontMatrix","isInvalidPDFjsFont","isType3Font","italic","loadedName","mimetype","missingFile","name","remeasure","systemFontInfo","vertical"],ej=["cMap","composite","defaultEncoding","differences","isMonospace","isSerifFont","isSymbolicFont","seacMap","subtype","toFontChar","toUnicode","type","vmetrics","widths"];function Sk(n){if(!n.fontMatrix||n.fontMatrix[0]===Ld[0])return;const e=.001/n.fontMatrix[0],t=n.widths;for(const i in t)t[i]*=e;n.defaultWidth*=e}function tj(n,e,t){if(n.isInternalFont||n.hasIncludedToUnicodeMap||n.hasEncoding||n.toUnicode instanceof uo||!e||t.length===0||n.defaultEncoding===zp)return;for(const a of t)if(!KR(a))return;const i=zp,s=[],r=Kl();for(const a in i){const o=i[a];if(o==="")continue;const l=r[o];l!==void 0&&(s[a]=String.fromCharCode(l))}s.length>0&&n.toUnicode.amend(s)}function nj(n,e){if(n.isInternalFont||n.hasIncludedToUnicodeMap||e===n.defaultEncoding||n.toUnicode instanceof uo)return;const t=[],i=Kl();for(const s in e){if(n.hasEncoding&&(n.baseEncodingName||n.differences[s]!==void 0))continue;const r=e[s],a=Tg(r,i);a!==-1&&(t[s]=String.fromCharCode(a))}t.length>0&&n.toUnicode.amend(t)}function Ik(n){if(!n.fallbackToUnicode||n.toUnicode instanceof uo)return;const e=[];for(const t in n.fallbackToUnicode)n.toUnicode.has(t)||(e[t]=n.fallbackToUnicode[t]);e.length>0&&n.toUnicode.amend(e)}class ij{constructor(e,t,i,s,r,a,o,l,c){this.originalCharCode=e,this.fontChar=t,this.unicode=i,this.accent=s,this.width=r,this.vmetric=a,this.operatorListId=o,this.isSpace=l,this.isInFont=c}get category(){return Ze(this,"category",fz(this.unicode),!0)}}function $h(n,e){return(n<<8)+e}function Tm(n,e,t){n[e+1]=t,n[e]=t>>>8}function pa(n,e){const t=(n<<8)+e;return t&32768?t-65536:t}function sj(n,e,t){n[e+3]=t&255,n[e+2]=t>>>8,n[e+1]=t>>>16,n[e]=t>>>24}function rj(n,e,t,i){return(n<<24)+(e<<16)+(t<<8)+i}function jn(n){return String.fromCharCode(n>>8&255,n&255)}function eu(n){return n>32767?n=32767:n<-32768&&(n=-32768),String.fromCharCode(n>>8&255,n&255)}function aj(n){const e=n.peekBytes(4);return Yn(e,0)===65536||da(e)==="true"}function WR(n){const e=n.peekBytes(4);return da(e)==="ttcf"}function oj(n){const e=n.peekBytes(4);return da(e)==="OTTO"}function lj(n){const e=n.peekBytes(2);return e[0]===37&&e[1]===33||e[0]===128&&e[1]===1}function cj(n){const e=n.peekBytes(4);return e[0]>=1&&e[3]>=1&&e[3]<=4}function hj(n,{type:e,subtype:t,composite:i}){let s,r;return aj(n)||WR(n)?s=i?"CIDFontType2":"TrueType":oj(n)?s=i?"CIDFontType2":"OpenType":lj(n)?i?s="CIDFontType0":s=e==="MMType1"?"MMType1":"Type1":cj(n)?i?(s="CIDFontType0",r="CIDFontType0C"):(s=e==="MMType1"?"MMType1":"Type1",r="Type1C"):(ce("getFontFileType: Unable to detect correct font file Type/Subtype."),s=e,r=t),[s,r]}function e9(n,e){for(const t in e)n[+t]=e[t]}function Cw(n,e,t){const i=[];let s;for(let r=0,a=n.length;r<a;r++)s=Tg(n[r],e),s!==-1&&(i[r]=s);for(const r in t)s=Tg(t[r],e),s!==-1&&(i[+r]=s);return i}function uj(n){return n.platform===1&&n.encoding===0&&n.language===0}function KR(n){return n.platform===3&&n.encoding===1&&n.language===1033}function Aw(n,e,t=!1){switch(e.length){case 1:return e.charCodeAt(0);case 2:return e.charCodeAt(0)<<8|e.charCodeAt(1)}const i=`Unsupported CID string (charCode ${n}): "${e}".`;if(t)throw new Te(i);return ce(i),e}function Ek(n,e,t,i){const s=Object.create(null),r=new Map,a=[],o=new Set;let l=0,h=cc[l][0],u=cc[l][1];const d=g=>cc[0][0]<=g&&g<=cc[0][1]||cc[1][0]<=g&&g<=cc[1][1];let f=null;for(const g in n){let m=n[g];if(!e(m))continue;if(h>u){if(l++,l>=cc.length){ce("Ran out of space in font private use area.");break}h=cc[l][0],u=cc[l][1]}const x=h++;m===0&&(m=t);let p=i.get(g);if(typeof p=="string")if(p.length===1)p=p.codePointAt(0);else{if(!f){f=new Map;for(let y=64256;y<=64335;y++){const w=String.fromCharCode(y).normalize("NFKD");w.length>1&&f.set(w,y)}}p=f.get(p)||p.codePointAt(0)}p&&!d(p)&&!o.has(m)&&(r.set(p,m),o.add(m)),s[x]=m,a[g]=x}return{toFontChar:a,charCodeToGlyphId:s,toUnicodeExtraMap:r,nextAvailableFontCharCode:h}}function dj(n,e,t){const i=[];for(const a in n)n[a]>=t||i.push({fontCharCode:a|0,glyphId:n[a]});if(e)for(const[a,o]of e)o>=t||i.push({fontCharCode:a,glyphId:o});i.length===0&&i.push({fontCharCode:0,glyphId:0}),i.sort((a,o)=>a.fontCharCode-o.fontCharCode);const s=[],r=i.length;for(let a=0;a<r;){const o=i[a].fontCharCode,l=[i[a].glyphId];++a;let c=o;for(;a<r&&c+1===i[a].fontCharCode&&(l.push(i[a].glyphId),++c,++a,c!==65535););s.push([o,c,l])}return s}function Tk(n,e,t){const i=dj(n,e,t),s=i.at(-1)[1]>65535?2:1;let r="\0\0"+jn(s)+"\0\0"+ar(4+s*8),a,o,l,c;for(a=i.length-1;a>=0&&!(i[a][0]<=65535);--a);const h=a+1;i[a][0]<65535&&i[a][1]===65535&&(i[a][1]=65534);const u=i[a][1]<65535?1:0,d=h+u,f=Wp.getSearchParams(d,2);let g="",m="",x="",p="",y="",w=0,_,v,C,k;for(a=0,o=h;a<o;a++){_=i[a],v=_[0],C=_[1],g+=jn(v),m+=jn(C),k=_[2];let N=!0;for(l=1,c=k.length;l<c;++l)if(k[l]!==k[l-1]+1){N=!1;break}if(N){const F=k[0];x+=jn(F-v&65535),p+=jn(0)}else{const F=(d-a)*2+w*2;for(w+=C-v+1,x+=jn(0),p+=jn(F),l=0,c=k.length;l<c;++l)y+=jn(k[l])}}u>0&&(m+="ÿÿ",g+="ÿÿ",x+="\0",p+="\0\0");const I="\0\0"+jn(2*d)+jn(f.range)+jn(f.entry)+jn(f.rangeShift)+m+"\0\0"+g+x+p+y;let S="",M="";if(s>1){for(r+=`\0\0
`+ar(4+s*8+4+I.length),S="",a=0,o=i.length;a<o;a++){_=i[a],v=_[0],k=_[2];let N=k[0];for(l=1,c=k.length;l<c;++l)k[l]!==k[l-1]+1&&(C=_[0]+l-1,S+=ar(v)+ar(C)+ar(N),v=C+1,N=k[l]);S+=ar(v)+ar(_[1])+ar(N)}M="\0\f\0\0"+ar(S.length+16)+"\0\0\0\0"+ar(S.length/12)}return r+"\0"+jn(I.length+4)+I+M+S}function fj(n,e){e.pos=(e.start||0)+n.offset;const t=e.getUint16();e.skip(60);const i=e.getUint16();if(t<4&&i&768)return!1;const s=e.getUint16(),r=e.getUint16();return s>r||(e.skip(6),e.getUint16()===0)?!1:(n.data[8]=n.data[9]=0,!0)}function Rk(n,e,t){t||(t={unitsPerEm:0,yMax:0,yMin:0,ascent:0,descent:0});let i=0,s=0,r=0,a=0,o=null,l=0,c=-1;if(e){for(let p in e)if(p|=0,(o>p||!o)&&(o=p),l<p&&(l=p),c=uz(p,c),c<32)i|=1<<c;else if(c<64)s|=1<<c-32;else if(c<96)r|=1<<c-64;else if(c<123)a|=1<<c-96;else throw new Te("Unicode ranges Bits > 123 are reserved for internal usage");l>65535&&(l=65535)}else o=0,l=255;const h=n.bbox||[0,0,0,0],u=t.unitsPerEm||(n.fontMatrix?1/Math.max(...n.fontMatrix.slice(0,4).map(Math.abs)):1e3),d=n.ascentScaled?1:u/ou,f=t.ascent||Math.round(d*(n.ascent||h[3]));let g=t.descent||Math.round(d*(n.descent||h[1]));g>0&&n.descent>0&&h[1]<0&&(g=-g);const m=t.yMax||f,x=-t.yMin||-g;return"\0$ô\0\0\0»\0\0\0»\0\0ß\x001\0\0\0\0"+String.fromCharCode(n.fixedPitch?9:0)+"\0\0\0\0\0\0"+ar(i)+ar(s)+ar(r)+ar(a)+"*21*"+jn(n.italicAngle?1:0)+jn(o||n.firstChar)+jn(l||n.lastChar)+jn(f)+jn(g)+"\0d"+jn(m)+jn(x)+"\0\0\0\0\0\0\0\0"+jn(n.xHeight)+jn(n.capHeight)+jn(0)+jn(o||n.firstChar)+"\0"}function Mk(n){const e=Math.floor(n.italicAngle*65536);return"\0\0\0"+ar(e)+"\0\0\0\0"+ar(n.fixedPitch?1:0)+"\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"}function gj(n){return n.replaceAll(/[^\x21-\x7E]|[[\](){}<>/%]/g,"").slice(0,63)}function Sw(n,e){e||(e=[[],[]]);const t=[e[0][0]||"Original licence",e[0][1]||n,e[0][2]||"Unknown",e[0][3]||"uniqueID",e[0][4]||n,e[0][5]||"Version 0.11",e[0][6]||gj(n),e[0][7]||"Unknown",e[0][8]||"Unknown",e[0][9]||"Unknown"],i=[];let s,r,a,o,l;for(s=0,r=t.length;s<r;s++){l=e[1][s]||t[s];const x=[];for(a=0,o=l.length;a<o;a++)x.push(jn(l.charCodeAt(a)));i.push(x.join(""))}const c=[t,i],h=["\0","\0"],u=["\0\0","\0"],d=["\0\0","	"],f=t.length*h.length;let g="\0\0"+jn(f)+jn(f*12+6),m=0;for(s=0,r=h.length;s<r;s++){const x=c[s];for(a=0,o=x.length;a<o;a++){l=x[a];const p=h[s]+u[s]+d[s]+jn(a)+jn(l.length)+jn(m);g+=p,m+=l.length}}return g+=t.join("")+i.join(""),g}class Pk{constructor(e,t,i,s){var h;this.name=e,this.psName=null,this.mimetype=null,this.disableFontFace=s.disableFontFace,this.fontExtraProperties=s.fontExtraProperties,this.loadedName=i.loadedName,this.isType3Font=i.isType3Font,this.missingFile=!1,this.cssFontInfo=i.cssFontInfo,this._charsCache=Object.create(null),this._glyphCache=Object.create(null);let r=!!(i.flags&lo.Serif);if(!r&&!i.isSimulatedFlags){const u=e.replaceAll(/[,_]/g,"-").split("-",1)[0],d=T4();for(const f of u.split("+"))if(d[f]){r=!0;break}}this.isSerifFont=r,this.isSymbolicFont=!!(i.flags&lo.Symbolic),this.isMonospace=!!(i.flags&lo.FixedPitch);let{type:a,subtype:o}=i;this.type=a,this.subtype=o,this.systemFontInfo=i.systemFontInfo;const l=e.match(/^InvalidPDFjsFont_(.*)_\d+$/);if(this.isInvalidPDFjsFont=!!l,this.isInvalidPDFjsFont?this.fallbackName=l[1]:this.isMonospace?this.fallbackName="monospace":this.isSerifFont?this.fallbackName="serif":this.fallbackName="sans-serif",(h=this.systemFontInfo)!=null&&h.guessFallback&&(this.systemFontInfo.guessFallback=!1,this.systemFontInfo.css+=`,${this.fallbackName}`),this.differences=i.differences,this.widths=i.widths,this.defaultWidth=i.defaultWidth,this.composite=i.composite,this.cMap=i.cMap,this.capHeight=i.capHeight/ou,this.ascent=i.ascent/ou,this.descent=i.descent/ou,this.lineHeight=this.ascent-this.descent,this.fontMatrix=i.fontMatrix,this.bbox=i.bbox,this.defaultEncoding=i.defaultEncoding,this.toUnicode=i.toUnicode,this.toFontChar=[],i.type==="Type3"){for(let u=0;u<256;u++)this.toFontChar[u]=this.differences[u]||i.defaultEncoding[u];return}if(this.cidEncoding=i.cidEncoding||"",this.vertical=!!i.vertical,this.vertical&&(this.vmetrics=i.vmetrics,this.defaultVMetrics=i.defaultVMetrics),!t||t.isEmpty){t&&ce('Font file is empty in "'+e+'" ('+this.loadedName+")"),this.fallbackToSystemFont(i);return}[a,o]=hj(t,i),(a!==this.type||o!==this.subtype)&&gn(`Inconsistent font file Type/SubType, expected: ${this.type}/${this.subtype} but found: ${a}/${o}.`);let c;try{switch(a){case"MMType1":gn("MMType1 font ("+e+"), falling back to Type1.");case"Type1":case"CIDFontType0":this.mimetype="font/opentype";const u=o==="Type1C"||o==="CIDFontType0C"?new _w(t,i):new $z(e,t,i);Sk(i),c=this.convert(e,u,i);break;case"OpenType":case"TrueType":case"CIDFontType2":this.mimetype="font/opentype",c=this.checkAndRepair(e,t,i),Sk(i),this.isOpenType&&(a="OpenType");break;default:throw new Te(`Font ${a} is not supported`)}}catch(u){ce(u),this.fallbackToSystemFont(i);return}Ik(i),this.data=c,this.type=a,this.subtype=o,this.fontMatrix=i.fontMatrix,this.widths=i.widths,this.defaultWidth=i.defaultWidth,this.toUnicode=i.toUnicode,this.seacMap=i.seacMap}get renderer(){const e=Dz.create(this,s1);return Ze(this,"renderer",e)}exportData(){const e=this.fontExtraProperties?[...Ak,...ej]:Ak,t=Object.create(null);for(const i of e){const s=this[i];s!==void 0&&(t[i]=s)}return t}fallbackToSystemFont(e){this.missingFile=!0;const{name:t,type:i}=this;let s=dx(t);const r=iy(),a=GR(),o=!!r[s],l=!!(a[s]&&r[a[s]]);s=r[s]||a[s]||s;const h=Lz()[s];h&&(isNaN(this.ascent)&&(this.ascent=h.ascent/ou),isNaN(this.descent)&&(this.descent=h.descent/ou),isNaN(this.capHeight)&&(this.capHeight=h.capHeight/ou)),this.bold=/bold/gi.test(s),this.italic=/oblique|italic/gi.test(s),this.black=/Black/g.test(t);const u=/Narrow/g.test(t);if(this.remeasure=(!o||u)&&Object.keys(this.widths).length>0,(o||l)&&i==="CIDFontType2"&&this.cidEncoding.startsWith("Identity-")){const d=e.cidToGidMap,f=[];if(e9(f,fk()),/Arial-?Black/i.test(t)?e9(f,Iz()):/Calibri/i.test(t)&&e9(f,Ez()),d){for(const g in f){const m=f[g];d[m]!==void 0&&(f[+g]=d[m])}d.length!==this.toUnicode.length&&e.hasIncludedToUnicodeMap&&this.toUnicode instanceof uo&&this.toUnicode.forEach(function(g,m){const x=f[g];d[x]===void 0&&(f[+g]=m)})}this.toUnicode instanceof uo||this.toUnicode.forEach(function(g,m){f[+g]=m}),this.toFontChar=f,this.toUnicode=new cp(f)}else if(/Symbol/i.test(s))this.toFontChar=Cw(A4,Kl(),this.differences);else if(/Dingbats/i.test(s))this.toFontChar=Cw(S4,lz(),this.differences);else if(o||l){const d=Cw(this.defaultEncoding,Kl(),this.differences);i==="CIDFontType2"&&!this.cidEncoding.startsWith("Identity-")&&!(this.toUnicode instanceof uo)&&this.toUnicode.forEach(function(f,g){d[+f]=g}),this.toFontChar=d}else{const d=Kl(),f=[];this.toUnicode.forEach((g,m)=>{if(!this.composite){const x=this.differences[g]||this.defaultEncoding[g],p=Tg(x,d);p!==-1&&(m=p)}f[+g]=m}),this.composite&&this.toUnicode instanceof uo&&/Tahoma|Verdana/i.test(t)&&e9(f,fk()),this.toFontChar=f}Ik(e),this.loadedName=s.split("-",1)[0]}checkAndRepair(e,t,i){var he,we,ye;const s=["OS/2","cmap","head","hhea","hmtx","maxp","name","post","loca","glyf","fpgm","prep","cvt ","CFF "];function r(P,V){const re=Object.create(null);re["OS/2"]=null,re.cmap=null,re.head=null,re.hhea=null,re.hmtx=null,re.maxp=null,re.name=null,re.post=null;for(let X=0;X<V;X++){const ue=a(P);s.includes(ue.tag)&&ue.length!==0&&(re[ue.tag]=ue)}return re}function a(P){const V=P.getString(4),re=P.getInt32()>>>0,X=P.getInt32()>>>0,ue=P.getInt32()>>>0,oe=P.pos;P.pos=P.start||0,P.skip(X);const Q=P.getBytes(ue);return P.pos=oe,V==="head"&&(Q[8]=Q[9]=Q[10]=Q[11]=0,Q[17]|=32),{tag:V,checksum:re,length:ue,offset:X,data:Q}}function o(P){return{version:P.getString(4),numTables:P.getUint16(),searchRange:P.getUint16(),entrySelector:P.getUint16(),rangeShift:P.getUint16()}}function l(P){const V=P.getString(4);Hs(V==="ttcf","Must be a TrueType Collection font.");const re=P.getUint16(),X=P.getUint16(),ue=P.getInt32()>>>0,oe=[];for(let ae=0;ae<ue;ae++)oe.push(P.getInt32()>>>0);const Q={ttcTag:V,majorVersion:re,minorVersion:X,numFonts:ue,offsetTable:oe};switch(re){case 1:return Q;case 2:return Q.dsigTag=P.getInt32()>>>0,Q.dsigLength=P.getInt32()>>>0,Q.dsigOffset=P.getInt32()>>>0,Q}throw new Te(`Invalid TrueType Collection majorVersion: ${re}.`)}function c(P,V){var Q;const{numFonts:re,offsetTable:X}=l(P),ue=V.split("+");let oe;for(let ae=0;ae<re;ae++){P.pos=(P.start||0)+X[ae];const Ke=o(P),Ue=r(P,Ke.numTables);if(!Ue.name)throw new Te('TrueType Collection font must contain a "name" table.');const[De]=x(Ue.name);for(let je=0,ze=De.length;je<ze;je++)for(let Qe=0,ft=De[je].length;Qe<ft;Qe++){const ut=(Q=De[je][Qe])==null?void 0:Q.replaceAll(/\s/g,"");if(ut){if(ut===V)return{header:Ke,tables:Ue};if(!(ue.length<2))for(const Je of ue)ut===Je&&(oe={name:Je,header:Ke,tables:Ue})}}}if(oe)return ce(`TrueType Collection does not contain "${V}" font, falling back to "${oe.name}" font instead.`),{header:oe.header,tables:oe.tables};throw new Te(`TrueType Collection does not contain "${V}" font.`)}function h(P,V,re,X){if(!P)return ce("No cmap table available."),{platformId:-1,encodingId:-1,mappings:[],hasShortCmap:!1};let ue,oe=(V.start||0)+P.offset;V.pos=oe,V.skip(2);const Q=V.getUint16();let ae,Ke=!1;for(let Je=0;Je<Q;Je++){const rt=V.getUint16(),ge=V.getUint16(),Pt=V.getInt32()>>>0;let lt=!1;if(!((ae==null?void 0:ae.platformId)===rt&&(ae==null?void 0:ae.encodingId)===ge)){if(rt===0&&(ge===0||ge===1||ge===3))lt=!0;else if(rt===1&&ge===0)lt=!0;else if(rt===3&&ge===1&&(X||!ae))lt=!0,re||(Ke=!0);else if(re&&rt===3&&ge===0){lt=!0;let ct=!0;if(Je<Q-1){const Ge=V.peekBytes(2);$h(Ge[0],Ge[1])<rt&&(ct=!1)}ct&&(Ke=!0)}if(lt&&(ae={platformId:rt,encodingId:ge,offset:Pt}),Ke)break}}if(ae&&(V.pos=oe+ae.offset),!ae||V.peekByte()===-1)return ce("Could not find a preferred cmap table."),{platformId:-1,encodingId:-1,mappings:[],hasShortCmap:!1};const Ue=V.getUint16();let De=!1;const je=[];let ze,Qe;if(Ue===0){for(V.skip(4),ze=0;ze<256;ze++){const Je=V.getByte();Je&&je.push({charCode:ze,glyphId:Je})}De=!0}else if(Ue===2){V.skip(4);const Je=[];let rt=0;for(let Pt=0;Pt<256;Pt++){const lt=V.getUint16()>>3;Je.push(lt),rt=Math.max(lt,rt)}const ge=[];for(let Pt=0;Pt<=rt;Pt++)ge.push({firstCode:V.getUint16(),entryCount:V.getUint16(),idDelta:pa(V.getByte(),V.getByte()),idRangePos:V.pos+V.getUint16()});for(let Pt=0;Pt<256;Pt++)if(Je[Pt]===0)V.pos=ge[0].idRangePos+2*Pt,Qe=V.getUint16(),je.push({charCode:Pt,glyphId:Qe});else{const lt=ge[Je[Pt]];for(ze=0;ze<lt.entryCount;ze++){const ct=(Pt<<8)+ze+lt.firstCode;V.pos=lt.idRangePos+2*ze,Qe=V.getUint16(),Qe!==0&&(Qe=(Qe+lt.idDelta)%65536),je.push({charCode:ct,glyphId:Qe})}}}else if(Ue===4){V.skip(4);const Je=V.getUint16()>>1;V.skip(6);const rt=[];let ge;for(ge=0;ge<Je;ge++)rt.push({end:V.getUint16()});for(V.skip(2),ge=0;ge<Je;ge++)rt[ge].start=V.getUint16();for(ge=0;ge<Je;ge++)rt[ge].delta=V.getUint16();let Pt=0,lt;for(ge=0;ge<Je;ge++){ue=rt[ge];const Ge=V.getUint16();if(!Ge){ue.offsetIndex=-1;continue}lt=(Ge>>1)-(Je-ge),ue.offsetIndex=lt,Pt=Math.max(Pt,lt+ue.end-ue.start+1)}const ct=[];for(ze=0;ze<Pt;ze++)ct.push(V.getUint16());for(ge=0;ge<Je;ge++){ue=rt[ge],oe=ue.start;const Ge=ue.end,Ft=ue.delta;for(lt=ue.offsetIndex,ze=oe;ze<=Ge;ze++)ze!==65535&&(Qe=lt<0?ze:ct[lt+ze-oe],Qe=Qe+Ft&65535,je.push({charCode:ze,glyphId:Qe}))}}else if(Ue===6){V.skip(4);const Je=V.getUint16(),rt=V.getUint16();for(ze=0;ze<rt;ze++){Qe=V.getUint16();const ge=Je+ze;je.push({charCode:ge,glyphId:Qe})}}else if(Ue===12){V.skip(10);const Je=V.getInt32()>>>0;for(ze=0;ze<Je;ze++){const rt=V.getInt32()>>>0,ge=V.getInt32()>>>0;let Pt=V.getInt32()>>>0;for(let lt=rt;lt<=ge;lt++)je.push({charCode:lt,glyphId:Pt++})}}else return ce("cmap table has unsupported format: "+Ue),{platformId:-1,encodingId:-1,mappings:[],hasShortCmap:!1};je.sort((Je,rt)=>Je.charCode-rt.charCode);const ft=[],ut=new Set;for(const Je of je){const{charCode:rt}=Je;ut.has(rt)||(ut.add(rt),ft.push(Je))}return{platformId:ae.platformId,encodingId:ae.encodingId,mappings:ft,hasShortCmap:De}}function u(P,V,re,X,ue,oe){if(!V){re&&(re.data=null);return}P.pos=(P.start||0)+V.offset,P.pos+=4,P.pos+=2,P.pos+=2,P.pos+=2,P.pos+=2,P.pos+=2,P.pos+=2,P.pos+=2,P.pos+=2,P.pos+=2;const Q=P.getUint16();P.pos+=8,P.pos+=2;let ae=P.getUint16();Q!==0&&($h(X.data[44],X.data[45])&2||(V.data[22]=0,V.data[23]=0)),ae>ue&&(gn(`The numOfMetrics (${ae}) should not be greater than the numGlyphs (${ue}).`),ae=ue,V.data[34]=(ae&65280)>>8,V.data[35]=ae&255);const Ue=ue-ae-(re.length-ae*4>>1);if(Ue>0){const De=new Uint8Array(re.length+Ue*2);De.set(re.data),oe&&(De[re.length]=re.data[2],De[re.length+1]=re.data[3]),re.data=De}}function d(P,V,re,X,ue,oe){const Q={length:0,sizeOfInstructions:0};if(V<0||V>=P.length||re>P.length||re-V<=12)return Q;const ae=P.subarray(V,re),Ke=pa(ae[2],ae[3]),Ue=pa(ae[4],ae[5]),De=pa(ae[6],ae[7]),je=pa(ae[8],ae[9]);Ke>De&&(Tm(ae,2,De),Tm(ae,6,Ke)),Ue>je&&(Tm(ae,4,je),Tm(ae,8,Ue));const ze=pa(ae[0],ae[1]);if(ze<0)return ze<-1||(X.set(ae,ue),Q.length=ae.length),Q;let Qe,ft=10,ut=0;for(Qe=0;Qe<ze;Qe++)ut=(ae[ft]<<8|ae[ft+1])+1,ft+=2;const Je=ft,rt=ae[ft]<<8|ae[ft+1];Q.sizeOfInstructions=rt,ft+=2+rt;const ge=ft;let Pt=0;for(Qe=0;Qe<ut;Qe++){const ct=ae[ft++];ct&192&&(ae[ft-1]=ct&63);let Ge=2;ct&2?Ge=1:ct&16&&(Ge=0);let Ft=2;ct&4?Ft=1:ct&32&&(Ft=0);const sn=Ge+Ft;if(Pt+=sn,ct&8){const Me=ae[ft++];Me===0&&(ae[ft-1]^=8),Qe+=Me,Pt+=Me*sn}}if(Pt===0)return Q;let lt=ft+Pt;return lt>ae.length?Q:!oe&&rt>0?(X.set(ae.subarray(0,Je),ue),X.set([0,0],ue+Je),X.set(ae.subarray(ge,lt),ue+Je+2),lt-=rt,ae.length-lt>3&&(lt=lt+3&-4),Q.length=lt,Q):ae.length-lt>3?(lt=lt+3&-4,X.set(ae.subarray(0,lt),ue),Q.length=lt,Q):(X.set(ae,ue),Q.length=ae.length,Q)}function f(P,V,re){const X=P.data,ue=rj(X[0],X[1],X[2],X[3]);ue>>16!==1&&(gn("Attempting to fix invalid version in head table: "+ue),X[0]=0,X[1]=1,X[2]=0,X[3]=0);const oe=$h(X[50],X[51]);if(oe<0||oe>1){gn("Attempting to fix invalid indexToLocFormat in head table: "+oe);const Q=V+1;if(re===Q<<1)X[50]=0,X[51]=0;else if(re===Q<<2)X[50]=0,X[51]=1;else throw new Te("Could not fix indexToLocFormat: "+oe)}}function g(P,V,re,X,ue,oe,Q){let ae,Ke,Ue;X?(ae=4,Ke=function(Ft,sn){return Ft[sn]<<24|Ft[sn+1]<<16|Ft[sn+2]<<8|Ft[sn+3]},Ue=function(Ft,sn,Me){Ft[sn]=Me>>>24&255,Ft[sn+1]=Me>>16&255,Ft[sn+2]=Me>>8&255,Ft[sn+3]=Me&255}):(ae=2,Ke=function(Ft,sn){return Ft[sn]<<9|Ft[sn+1]<<1},Ue=function(Ft,sn,Me){Ft[sn]=Me>>9&255,Ft[sn+1]=Me>>1&255});const De=oe?re+1:re,je=ae*(1+De),ze=new Uint8Array(je);ze.set(P.data.subarray(0,je)),P.data=ze;const Qe=V.data,ft=Qe.length,ut=new Uint8Array(ft);let Je,rt;const ge=[];for(Je=0,rt=0;Je<re+1;Je++,rt+=ae){let Ge=Ke(ze,rt);Ge>ft&&(Ge=ft),ge.push({index:Je,offset:Ge,endOffset:0})}for(ge.sort((Ge,Ft)=>Ge.offset-Ft.offset),Je=0;Je<re;Je++)ge[Je].endOffset=ge[Je+1].offset;for(ge.sort((Ge,Ft)=>Ge.index-Ft.index),Je=0;Je<re;Je++){const{offset:Ge,endOffset:Ft}=ge[Je];if(Ge!==0||Ft!==0)break;const sn=ge[Je+1].offset;if(sn!==0){ge[Je].endOffset=sn;break}}const Pt=ge.at(-2);Pt.offset!==0&&Pt.endOffset===0&&(Pt.endOffset=ft);const lt=Object.create(null);let ct=0;for(Ue(ze,0,ct),Je=0,rt=ae;Je<re;Je++,rt+=ae){const Ge=d(Qe,ge[Je].offset,ge[Je].endOffset,ut,ct,ue),Ft=Ge.length;Ft===0&&(lt[Je]=!0),Ge.sizeOfInstructions>Q&&(Q=Ge.sizeOfInstructions),ct+=Ft,Ue(ze,rt,ct)}if(ct===0){const Ge=new Uint8Array([0,1,0,0,0,0,0,0,0,0,0,0,0,0,49,0]);for(Je=0,rt=ae;Je<De;Je++,rt+=ae)Ue(ze,rt,Ge.length);V.data=Ge}else if(oe){const Ge=Ke(ze,ae);ut.length>Ge+ct?V.data=ut.subarray(0,Ge+ct):(V.data=new Uint8Array(Ge+ct),V.data.set(ut.subarray(0,ct))),V.data.set(ut.subarray(0,Ge),ct),Ue(P.data,ze.length-ae,ct+Ge)}else V.data=ut.subarray(0,ct);return{missingGlyphs:lt,maxSizeOfInstructions:Q}}function m(P,V,re){const X=(t.start||0)+P.offset;t.pos=X;const ue=P.length,oe=X+ue,Q=t.getInt32();t.skip(28);let ae,Ke=!0,Ue;switch(Q){case 65536:ae=hk;break;case 131072:const De=t.getUint16();if(De!==re){Ke=!1;break}const je=[];for(Ue=0;Ue<De;++Ue){const ft=t.getUint16();if(ft>=32768){Ke=!1;break}je.push(ft)}if(!Ke)break;const ze=[],Qe=[];for(;t.pos<oe;){const ft=t.getByte();for(Qe.length=ft,Ue=0;Ue<ft;++Ue)Qe[Ue]=String.fromCharCode(t.getByte());ze.push(Qe.join(""))}for(ae=[],Ue=0;Ue<De;++Ue){const ft=je[Ue];if(ft<258){ae.push(hk[ft]);continue}ae.push(ze[ft-258])}break;case 196608:break;default:ce("Unknown/unsupported post table version "+Q),Ke=!1,V.defaultEncoding&&(ae=V.defaultEncoding);break}return V.glyphNames=ae,Ke}function x(P){const V=(t.start||0)+P.offset;t.pos=V;const re=[[],[]],X=[],ue=P.length,oe=V+ue;if(t.getUint16()!==0||ue<6)return[re,X];const Ke=t.getUint16(),Ue=t.getUint16(),De=12;let je,ze;for(je=0;je<Ke&&t.pos+De<=oe;je++){const Qe={platform:t.getUint16(),encoding:t.getUint16(),language:t.getUint16(),name:t.getUint16(),length:t.getUint16(),offset:t.getUint16()};(uj(Qe)||KR(Qe))&&X.push(Qe)}for(je=0,ze=X.length;je<ze;je++){const Qe=X[je];if(Qe.length<=0)continue;const ft=V+Ue+Qe.offset;if(ft+Qe.length>oe)continue;t.pos=ft;const ut=Qe.name;if(Qe.encoding){let Je="";for(let rt=0,ge=Qe.length;rt<ge;rt+=2)Je+=String.fromCharCode(t.getUint16());re[1][ut]=Je}else re[0][ut]=t.getString(Qe.length)}return[re,X]}const p=[0,0,0,0,0,0,0,0,-2,-2,-2,-2,0,0,-2,-5,-1,-1,-1,-1,-1,-1,-1,-1,0,0,-1,0,-1,-1,-1,-1,1,-1,-999,0,1,0,-1,-2,0,-1,-2,-1,-1,0,-1,-1,0,0,-999,-999,-1,-1,-1,-1,-2,-999,-2,-2,-999,0,-2,-2,0,0,-2,0,-2,0,0,0,-2,-1,-1,1,1,0,0,-1,-1,-1,-1,-1,-1,-1,0,0,-1,0,-1,-1,0,-999,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,0,0,0,0,0,-2,-999,-999,-999,-999,-999,-1,-1,-2,-2,0,0,0,0,-1,-1,-999,-2,-2,0,0,-1,-2,-2,0,0,0,-1,-1,-1,-2];function y(P,V){let re=P.data,X=0,ue,oe,Q,ae,Ke,Ue=0,De=0;const je=[],ze=[],Qe=[];let ft=V.tooComplexToFollowFunctions,ut=!1,Je=0,rt=0;for(let Pt=re.length;X<Pt;){const lt=re[X++];if(lt===64)if(oe=re[X++],ut||rt)X+=oe;else for(ue=0;ue<oe;ue++)je.push(re[X++]);else if(lt===65)if(oe=re[X++],ut||rt)X+=oe*2;else for(ue=0;ue<oe;ue++)Q=re[X++],je.push(Q<<8|re[X++]);else if((lt&248)===176)if(oe=lt-176+1,ut||rt)X+=oe;else for(ue=0;ue<oe;ue++)je.push(re[X++]);else if((lt&248)===184)if(oe=lt-184+1,ut||rt)X+=oe*2;else for(ue=0;ue<oe;ue++)Q=re[X++],je.push(pa(Q,re[X++]));else if(lt===43&&!ft){if(!ut&&!rt){if(ae=je.at(-1),isNaN(ae))gn("TT: CALL empty stack (or invalid entry).");else if(V.functionsUsed[ae]=!0,ae in V.functionsStackDeltas){const ct=je.length+V.functionsStackDeltas[ae];if(ct<0){ce("TT: CALL invalid functions stack delta."),V.hintsValid=!1;return}je.length=ct}else if(ae in V.functionsDefined&&!Qe.includes(ae)){if(ze.push({data:re,i:X,stackTop:je.length-1}),Qe.push(ae),Ke=V.functionsDefined[ae],!Ke){ce("TT: CALL non-existent function"),V.hintsValid=!1;return}re=Ke.data,X=Ke.i}}}else if(lt===44&&!ft)(ut||rt)&&(ce("TT: nested FDEFs not allowed"),ft=!0),ut=!0,De=X,ae=je.pop(),V.functionsDefined[ae]={data:re,i:X};else if(lt===45)if(ut)ut=!1,Ue=X;else{if(Ke=ze.pop(),!Ke){ce("TT: ENDF bad stack"),V.hintsValid=!1;return}ae=Qe.pop(),re=Ke.data,X=Ke.i,V.functionsStackDeltas[ae]=je.length-Ke.stackTop}else if(lt===137)(ut||rt)&&(ce("TT: nested IDEFs not allowed"),ft=!0),ut=!0,De=X;else if(lt===88)++Je;else if(lt===27)rt=Je;else if(lt===89)rt===Je&&(rt=0),--Je;else if(lt===28&&!ut&&!rt){const ct=je.at(-1);ct>0&&(X+=ct-1)}if(!ut&&!rt){let ct=0;for(lt<=142?ct=p[lt]:lt>=192&&lt<=223?ct=-1:lt>=224&&(ct=-2),lt>=113&&lt<=117&&(oe=je.pop(),isNaN(oe)||(ct=-oe*2));ct<0&&je.length>0;)je.pop(),ct++;for(;ct>0;)je.push(NaN),ct--}}V.tooComplexToFollowFunctions=ft;const ge=[re];X>re.length&&ge.push(new Uint8Array(X-re.length)),De>Ue&&(ce("TT: complementing a missing function tail"),ge.push(new Uint8Array([34,45]))),_(P,ge)}function w(P,V){if(!P.tooComplexToFollowFunctions){if(P.functionsDefined.length>V){ce("TT: more functions defined than expected"),P.hintsValid=!1;return}for(let re=0,X=P.functionsUsed.length;re<X;re++){if(re>V){ce("TT: invalid function id: "+re),P.hintsValid=!1;return}if(P.functionsUsed[re]&&!P.functionsDefined[re]){ce("TT: undefined function: "+re),P.hintsValid=!1;return}}}}function _(P,V){if(V.length>1){let re=0,X,ue;for(X=0,ue=V.length;X<ue;X++)re+=V[X].length;re=re+3&-4;const oe=new Uint8Array(re);let Q=0;for(X=0,ue=V.length;X<ue;X++)oe.set(V[X],Q),Q+=V[X].length;P.data=oe,P.length=re}}function v(P,V,re,X){const ue={functionsDefined:[],functionsUsed:[],functionsStackDeltas:[],tooComplexToFollowFunctions:!1,hintsValid:!0};if(P&&y(P,ue),V&&y(V,ue),P&&w(ue,X),re&&re.length&1){const oe=new Uint8Array(re.length+1);oe.set(re.data),re.data=oe}return ue.hintsValid}t=new Hi(new Uint8Array(t.getBytes()));let C,k;if(WR(t)){const P=c(t,this.name);C=P.header,k=P.tables}else C=o(t),k=r(t,C.numTables);let I,S;const M=!k["CFF "];if(M){if(!k.loca)throw new Te('Required "loca" table is not found');k.glyf||(ce('Required "glyf" table is not found -- trying to recover.'),k.glyf={tag:"glyf",data:new Uint8Array(0)}),this.isOpenType=!1}else{const P=i.composite&&(((he=i.cidToGidMap)==null?void 0:he.length)>0||!(i.cMap instanceof i1));if(C.version==="OTTO"&&!P||!k.head||!k.hhea||!k.maxp||!k.post)return S=new Hi(k["CFF "].data),I=new _w(S,i),this.convert(e,I,i);delete k.glyf,delete k.loca,delete k.fpgm,delete k.prep,delete k["cvt "],this.isOpenType=!0}if(!k.maxp)throw new Te('Required "maxp" table is not found');t.pos=(t.start||0)+k.maxp.offset;let N=t.getInt32();const F=t.getUint16();if(N!==65536&&N!==20480){if(k.maxp.length===6)N=20480;else if(k.maxp.length>=32)N=65536;else throw new Te('"maxp" table has a wrong version number');sj(k.maxp.data,0,N)}if(((we=i.scaleFactors)==null?void 0:we.length)===F&&M){const{scaleFactors:P}=i,V=$h(k.head.data[50],k.head.data[51]),re=new Vz({glyfTable:k.glyf.data,isGlyphLocationsLong:V,locaTable:k.loca.data,numGlyphs:F});re.scale(P);const{glyf:X,loca:ue,isLocationLong:oe}=re.write();k.glyf.data=X,k.loca.data=ue,oe!==!!V&&(k.head.data[50]=0,k.head.data[51]=oe?1:0);const Q=k.hmtx.data;for(let ae=0;ae<F;ae++){const Ke=4*ae,Ue=Math.round(P[ae]*$h(Q[Ke],Q[Ke+1]));Q[Ke]=Ue>>8&255,Q[Ke+1]=Ue&255;const De=Math.round(P[ae]*pa(Q[Ke+2],Q[Ke+3]));Tm(Q,Ke+2,De)}}let H=F+1,T=!0;H>65535&&(T=!1,H=F,ce("Not enough space in glyfs to duplicate first glyph."));let z=0,R=0;N>=65536&&k.maxp.length>=32&&(t.pos+=8,t.getUint16()>2&&(k.maxp.data[14]=0,k.maxp.data[15]=2),t.pos+=4,z=t.getUint16(),t.pos+=4,R=t.getUint16()),k.maxp.data[4]=H>>8,k.maxp.data[5]=H&255;const L=v(k.fpgm,k.prep,k["cvt "],z);if(L||(delete k.fpgm,delete k.prep,delete k["cvt "]),u(t,k.hhea,k.hmtx,k.head,H,T),!k.head)throw new Te('Required "head" table is not found');f(k.head,F,M?k.loca.length:0);let Y=Object.create(null);if(M){const P=$h(k.head.data[50],k.head.data[51]),V=g(k.loca,k.glyf,F,P,L,T,R);Y=V.missingGlyphs,N>=65536&&k.maxp.length>=32&&(k.maxp.data[26]=V.maxSizeOfInstructions>>8,k.maxp.data[27]=V.maxSizeOfInstructions&255)}if(!k.hhea)throw new Te('Required "hhea" table is not found');k.hhea.data[10]===0&&k.hhea.data[11]===0&&(k.hhea.data[10]=255,k.hhea.data[11]=255);const j={unitsPerEm:$h(k.head.data[18],k.head.data[19]),yMax:pa(k.head.data[42],k.head.data[43]),yMin:pa(k.head.data[38],k.head.data[39]),ascent:pa(k.hhea.data[4],k.hhea.data[5]),descent:pa(k.hhea.data[6],k.hhea.data[7]),lineGap:pa(k.hhea.data[8],k.hhea.data[9])};this.ascent=j.ascent/j.unitsPerEm,this.descent=j.descent/j.unitsPerEm,this.lineGap=j.lineGap/j.unitsPerEm,(ye=this.cssFontInfo)!=null&&ye.lineHeight?(this.lineHeight=this.cssFontInfo.metrics.lineHeight,this.lineGap=this.cssFontInfo.metrics.lineGap):this.lineHeight=this.ascent-this.descent+this.lineGap,k.post&&m(k.post,i,F),k.post={tag:"post",data:Mk(i)};const J=Object.create(null);function G(P){return!Y[P]}if(i.composite){const P=i.cidToGidMap||[],V=P.length===0;i.cMap.forEach(function(re,X){if(typeof X=="string"&&(X=Aw(re,X,!0)),X>65535)throw new Te("Max size of CID is 65,535");let ue=-1;V?ue=X:P[X]!==void 0&&(ue=P[X]),ue>=0&&ue<F&&G(ue)&&(J[re]=ue)})}else{const P=h(k.cmap,t,this.isSymbolicFont,i.hasEncoding),V=P.platformId,re=P.encodingId,X=P.mappings;let ue=[],oe=!1;if(i.hasEncoding&&(i.baseEncodingName==="MacRomanEncoding"||i.baseEncodingName==="WinAnsiEncoding")&&(ue=jp(i.baseEncodingName)),i.hasEncoding&&!this.isSymbolicFont&&(V===3&&re===1||V===1&&re===0)){const Q=Kl();for(let ae=0;ae<256;ae++){let Ke;if(this.differences[ae]!==void 0?Ke=this.differences[ae]:ue.length&&ue[ae]!==""?Ke=ue[ae]:Ke=o0[ae],!Ke)continue;const Ue=BR(Ke,Q);let De;if(V===3&&re===1?De=Q[Ue]:V===1&&re===0&&(De=C4.indexOf(Ue)),De===void 0){if(!i.glyphNames&&i.hasIncludedToUnicodeMap&&!(this.toUnicode instanceof uo)){const je=this.toUnicode.get(ae);je&&(De=je.codePointAt(0))}if(De===void 0)continue}for(const je of X)if(je.charCode===De){J[ae]=je.glyphId;break}}}else if(V===0){for(const Q of X)J[Q.charCode]=Q.glyphId;oe=!0}else if(V===3&&re===0)for(const Q of X){let ae=Q.charCode;ae>=61440&&ae<=61695&&(ae&=255),J[ae]=Q.glyphId}else for(const Q of X)J[Q.charCode]=Q.glyphId;if(i.glyphNames&&(ue.length||this.differences.length))for(let Q=0;Q<256;++Q){if(!oe&&J[Q]!==void 0)continue;const ae=this.differences[Q]||ue[Q];if(!ae)continue;const Ke=i.glyphNames.indexOf(ae);Ke>0&&G(Ke)&&(J[Q]=Ke)}}J.length===0&&(J[0]=0);let se=H-1;if(T||(se=0),!i.cssFontInfo){const P=Ek(J,G,se,this.toUnicode);this.toFontChar=P.toFontChar,k.cmap={tag:"cmap",data:Tk(P.charCodeToGlyphId,P.toUnicodeExtraMap,H)},(!k["OS/2"]||!fj(k["OS/2"],t))&&(k["OS/2"]={tag:"OS/2",data:Rk(i,P.charCodeToGlyphId,j)})}if(!M)try{S=new Hi(k["CFF "].data),I=new I4(S,i,s1).parse(),I.duplicateFirstGlyph();const V=new fx(I);k["CFF "].data=V.compile()}catch{ce("Failed to compile font "+i.loadedName)}if(!k.name)k.name={tag:"name",data:Sw(this.name)};else{const[P,V]=x(k.name);k.name.data=Sw(e,P),this.psName=P[0][6]||null,i.composite||tj(i,this.isSymbolicFont,V)}const de=new Wp(C.version);for(const P in k)de.addTable(P,k[P].data);return de.toArray()}convert(e,t,i){i.fixedPitch=!1,i.builtInEncoding&&nj(i,i.builtInEncoding);let s=1;t instanceof _w&&(s=t.numGlyphs-1);const r=t.getGlyphMapping(i);let a=null,o=r,l=null;i.cssFontInfo||(a=Ek(r,t.hasGlyphId.bind(t),s,this.toUnicode),this.toFontChar=a.toFontChar,o=a.charCodeToGlyphId,l=a.toUnicodeExtraMap);const c=t.numGlyphs;function h(m,x){let p=null;for(const y in m)x===m[y]&&(p||(p=[])).push(y|0);return p}function u(m,x){for(const p in m)if(x===m[p])return p|0;return a.charCodeToGlyphId[a.nextAvailableFontCharCode]=x,a.nextAvailableFontCharCode++}const d=t.seacs;if(a&&s1&&(d!=null&&d.length)){const m=i.fontMatrix||Ld,x=t.getCharset(),p=Object.create(null);for(let y in d){y|=0;const w=d[y],_=o0[w[2]],v=o0[w[3]],C=x.indexOf(_),k=x.indexOf(v);if(C<0||k<0)continue;const I={x:w[0]*m[0]+w[1]*m[2]+m[4],y:w[0]*m[1]+w[1]*m[3]+m[5]},S=h(r,y);if(S)for(const M of S){const N=a.charCodeToGlyphId,F=u(N,C),H=u(N,k);p[M]={baseFontCharCode:F,accentFontCharCode:H,accentOffset:I}}}i.seacMap=p}const f=i.fontMatrix?1/Math.max(...i.fontMatrix.slice(0,4).map(Math.abs)):1e3,g=new Wp("OTTO");return g.addTable("CFF ",t.data),g.addTable("OS/2",Rk(i,o)),g.addTable("cmap",Tk(o,l,c)),g.addTable("head","\0\0\0\0\0\0\0\0\0\0_<õ\0\0"+eu(f)+"\0\0\0\0\v~'\0\0\0\0\v~'\0\0"+eu(i.descent)+"ÿ"+eu(i.ascent)+jn(i.italicAngle?2:0)+"\0\0\0\0\0\0\0"),g.addTable("hhea","\0\0\0"+eu(i.ascent)+eu(i.descent)+"\0\0ÿÿ\0\0\0\0\0\0"+eu(i.capHeight)+eu(Math.tan(i.italicAngle)*i.xHeight)+"\0\0\0\0\0\0\0\0\0\0\0\0"+jn(c)),g.addTable("hmtx",function(){const x=t.charstrings,p=t.cff?t.cff.widths:null;let y="\0\0\0\0";for(let w=1,_=c;w<_;w++){let v=0;if(x){const C=x[w-1];v="width"in C?C.width:0}else p&&(v=Math.ceil(p[w]||0));y+=jn(v)+jn(0)}return y}()),g.addTable("maxp","\0\0P\0"+jn(c)),g.addTable("name",Sw(e)),g.addTable("post",Mk(i)),g.toArray()}get _spaceWidth(){const e=["space","minus","one","i","I"];let t;for(const i of e){if(i in this.widths){t=this.widths[i];break}const r=Kl()[i];let a=0;if(this.composite&&this.cMap.contains(r)&&(a=this.cMap.lookup(r),typeof a=="string"&&(a=Aw(r,a))),!a&&this.toUnicode&&(a=this.toUnicode.charCodeOf(r)),a<=0&&(a=r),t=this.widths[a],t)break}return Ze(this,"_spaceWidth",t||this.defaultWidth)}_charToGlyph(e,t=!1){var f,g,m;let i=this._glyphCache[e];if((i==null?void 0:i.isSpace)===t)return i;let s,r,a,o=e;(f=this.cMap)!=null&&f.contains(e)&&(o=this.cMap.lookup(e),typeof o=="string"&&(o=Aw(e,o))),r=this.widths[o],typeof r!="number"&&(r=this.defaultWidth);const l=(g=this.vmetrics)==null?void 0:g[o];let c=this.toUnicode.get(e)||e;typeof c=="number"&&(c=String.fromCharCode(c));let h=this.toFontChar[e]!==void 0;if(s=this.toFontChar[e]||e,this.missingFile){const x=this.differences[e]||this.defaultEncoding[e];(x===".notdef"||x==="")&&this.type==="Type1"&&(s=32,x===""&&(r||(r=this._spaceWidth),c=String.fromCharCode(s))),s=hz(s)}this.isType3Font&&(a=s);let u=null;if((m=this.seacMap)!=null&&m[e]){h=!0;const x=this.seacMap[e];s=x.baseFontCharCode,u={fontChar:String.fromCodePoint(x.accentFontCharCode),offset:x.accentOffset}}let d="";if(typeof s=="number"&&(s<=1114111?d=String.fromCodePoint(s):ce(`charToGlyph - invalid fontCharCode: ${s}`)),this.missingFile&&this.vertical&&d.length===1){const x=mz()[d.charCodeAt(0)];x&&(d=c=String.fromCharCode(x))}return i=new ij(e,d,c,u,r,l,a,t,h),this._glyphCache[e]=i}charsToGlyphs(e){let t=this._charsCache[e];if(t)return t;if(t=[],this.cMap){const i=Object.create(null),s=e.length;let r=0;for(;r<s;){this.cMap.readCharCode(e,r,i);const{charcode:a,length:o}=i;r+=o;const l=this._charToGlyph(a,o===1&&e.charCodeAt(r-1)===32);t.push(l)}}else for(let i=0,s=e.length;i<s;++i){const r=e.charCodeAt(i),a=this._charToGlyph(r,r===32);t.push(a)}return this._charsCache[e]=t}getCharPositions(e){const t=[];if(this.cMap){const i=Object.create(null);let s=0;for(;s<e.length;){this.cMap.readCharCode(e,s,i);const r=i.length;t.push([s,s+r]),s+=r}}else for(let i=0,s=e.length;i<s;++i)t.push([i,i+1]);return t}get glyphCacheValues(){return Object.values(this._glyphCache)}encodeString(e){const t=[],i=[],s=()=>t.length%2===1,r=this.toUnicode instanceof uo?a=>this.toUnicode.charCodeOf(a):a=>this.toUnicode.charCodeOf(String.fromCodePoint(a));for(let a=0,o=e.length;a<o;a++){const l=e.codePointAt(a);if(l>55295&&(l<57344||l>65533)&&a++,this.toUnicode){const c=r(l);if(c!==-1){s()&&(t.push(i.join("")),i.length=0);const h=this.cMap?this.cMap.getCharCodeLength(c):1;for(let u=h-1;u>=0;u--)i.push(String.fromCharCode(c>>8*u&255));continue}}s()||(t.push(i.join("")),i.length=0),i.push(String.fromCodePoint(l))}return t.push(i.join("")),t}}class Nk{constructor(e){this.error=e,this.loadedName="g_font_error",this.missingFile=!0}charsToGlyphs(){return[]}encodeString(e){return[e]}exportData(){return{error:this.error}}}const Gr={FUNCTION_BASED:1,AXIAL:2,RADIAL:3,FREE_FORM_MESH:4,LATTICE_FORM_MESH:5,COONS_PATCH_MESH:6,TENSOR_PATCH_MESH:7};class mj{constructor(){kn("Cannot initialize Pattern.")}static parseShading(e,t,i,s,r,a){const o=e instanceof un?e.dict:e,l=o.get("ShadingType");try{switch(l){case Gr.AXIAL:case Gr.RADIAL:return new pj(o,t,i,s,r,a);case Gr.FREE_FORM_MESH:case Gr.LATTICE_FORM_MESH:case Gr.COONS_PATCH_MESH:case Gr.TENSOR_PATCH_MESH:return new J7(e,t,i,s,r,a);default:throw new Te("Unsupported ShadingType: "+l)}}catch(c){if(c instanceof xi)throw c;return ce(c),new wj}}}class r1{getIR(){kn("Abstract method `getIR` called.")}}He(r1,"SMALL_NUMBER",1e-6);class pj extends r1{constructor(e,t,i,s,r,a){super(),this.shadingType=e.get("ShadingType");let o=0;if(this.shadingType===Gr.AXIAL?o=4:this.shadingType===Gr.RADIAL&&(o=6),this.coordsArr=e.getArray("Coords"),!Vr(this.coordsArr,o))throw new Te("RadialAxialShading: Invalid /Coords array.");const l=Nn.parse({cs:e.getRaw("CS")||e.getRaw("ColorSpace"),xref:t,resources:i,pdfFunctionFactory:s,globalColorSpaceCache:r,localColorSpaceCache:a});this.bbox=y0(e.getArray("BBox"),null);let c=0,h=1;const u=e.getArray("Domain");Vr(u,2)&&([c,h]=u);let d=!1,f=!1;const g=e.getArray("Extend");if(AU(g,2)&&([d,f]=g),this.shadingType===Gr.RADIAL&&(!d||!f)){const[se,de,he,we,ye,P]=this.coordsArr,V=Math.hypot(se-we,de-ye);he<=P+V&&P<=he+V&&ce("Unsupported radial gradient.")}this.extendStart=d,this.extendEnd=f;const m=e.getRaw("Function"),x=s.create(m,!0),p=840,y=(h-c)/p,w=this.colorStops=[];if(c>=h||y<=0){gn("Bad shading domain.");return}const _=new Float32Array(l.numComps),v=new Float32Array(1);let C=0;v[0]=c,x(v,0,_,0);const k=new Uint8ClampedArray(3);l.getRgb(_,0,k);let[I,S,M]=k;w.push([0,Dn.makeHexColor(I,S,M)]);let N=1;v[0]=c+y,x(v,0,_,0),l.getRgb(_,0,k);let[F,H,T]=k,z=F-I+1,R=H-S+1,L=T-M+1,Y=F-I-1,j=H-S-1,J=T-M-1;for(let se=2;se<p;se++){v[0]=c+se*y,x(v,0,_,0),l.getRgb(_,0,k);const[de,he,we]=k,ye=se-C;if(z=Math.min(z,(de-I+1)/ye),R=Math.min(R,(he-S+1)/ye),L=Math.min(L,(we-M+1)/ye),Y=Math.max(Y,(de-I-1)/ye),j=Math.max(j,(he-S-1)/ye),J=Math.max(J,(we-M-1)/ye),!(Y<=z&&j<=R&&J<=L)){const V=Dn.makeHexColor(F,H,T);w.push([N/p,V]),z=de-F+1,R=he-H+1,L=we-T+1,Y=de-F-1,j=he-H-1,J=we-T-1,C=N,I=F,S=H,M=T}N=se,F=de,H=he,T=we}w.push([1,Dn.makeHexColor(F,H,T)]);let G="transparent";e.has("Background")&&(G=l.getRgbHex(e.get("Background"),0)),d||(w.unshift([0,G]),w[1][0]+=r1.SMALL_NUMBER),f||(w.at(-1)[0]-=r1.SMALL_NUMBER,w.push([1,G])),this.colorStops=w}getIR(){const{coordsArr:e,shadingType:t}=this;let i,s,r,a,o;return t===Gr.AXIAL?(s=[e[0],e[1]],r=[e[2],e[3]],a=null,o=null,i="axial"):t===Gr.RADIAL?(s=[e[0],e[1]],r=[e[3],e[4]],a=e[2],o=e[5],i="radial"):kn(`getPattern type unknown: ${t}`),["RadialAxial",i,this.bbox,this.colorStops,s,r,a,o]}}class bj{constructor(e,t){this.stream=e,this.context=t,this.buffer=0,this.bufferLength=0;const i=t.numComps;this.tmpCompsBuf=new Float32Array(i);const s=t.colorSpace.numComps;this.tmpCsCompsBuf=t.colorFn?new Float32Array(s):this.tmpCompsBuf}get hasData(){if(this.stream.end)return this.stream.pos<this.stream.end;if(this.bufferLength>0)return!0;const e=this.stream.getByte();return e<0?!1:(this.buffer=e,this.bufferLength=8,!0)}readBits(e){const{stream:t}=this;let{buffer:i,bufferLength:s}=this;if(e===32){if(s===0)return t.getInt32()>>>0;i=i<<24|t.getByte()<<16|t.getByte()<<8|t.getByte();const r=t.getByte();return this.buffer=r&(1<<s)-1,(i<<8-s|(r&255)>>s)>>>0}if(e===8&&s===0)return t.getByte();for(;s<e;)i=i<<8|t.getByte(),s+=8;return s-=e,this.bufferLength=s,this.buffer=i&(1<<s)-1,i>>s}align(){this.buffer=0,this.bufferLength=0}readFlag(){return this.readBits(this.context.bitsPerFlag)}readCoordinate(){const{bitsPerCoordinate:e,decode:t}=this.context,i=this.readBits(e),s=this.readBits(e),r=e<32?1/((1<<e)-1):23283064365386963e-26;return[i*r*(t[1]-t[0])+t[0],s*r*(t[3]-t[2])+t[2]]}readComponents(){const{bitsPerComponent:e,colorFn:t,colorSpace:i,decode:s,numComps:r}=this.context,a=e<32?1/((1<<e)-1):23283064365386963e-26,o=this.tmpCompsBuf;for(let c=0,h=4;c<r;c++,h+=2){const u=this.readBits(e);o[c]=u*a*(s[h+1]-s[h])+s[h]}const l=this.tmpCsCompsBuf;return t==null||t(o,0,l,0),i.getRgb(l,0)}}let r3=Object.create(null);function xj(n){const e=[];for(let t=0;t<=n;t++){const i=t/n,s=1-i;e.push(new Float32Array([s**3,3*i*s**2,3*i**2*s,i**3]))}return e}function Ok(n){return r3[n]||(r3[n]=xj(n))}function yj(){r3=Object.create(null)}const To=class To extends r1{constructor(e,t,i,s,r,a){if(super(),!(e instanceof un))throw new Te("Mesh data is not a stream");const o=e.dict;this.shadingType=o.get("ShadingType"),this.bbox=y0(o.getArray("BBox"),null);const l=Nn.parse({cs:o.getRaw("CS")||o.getRaw("ColorSpace"),xref:t,resources:i,pdfFunctionFactory:s,globalColorSpaceCache:r,localColorSpaceCache:a});this.background=o.has("Background")?l.getRgb(o.get("Background"),0):null;const c=o.getRaw("Function"),h=c?s.create(c,!0):null;this.coords=[],this.colors=[],this.figures=[];const u={bitsPerCoordinate:o.get("BitsPerCoordinate"),bitsPerComponent:o.get("BitsPerComponent"),bitsPerFlag:o.get("BitsPerFlag"),decode:o.getArray("Decode"),colorFn:h,colorSpace:l,numComps:h?1:l.numComps},d=new bj(e,u);let f=!1;switch(this.shadingType){case Gr.FREE_FORM_MESH:this._decodeType4Shading(d);break;case Gr.LATTICE_FORM_MESH:const g=o.get("VerticesPerRow")|0;if(g<2)throw new Te("Invalid VerticesPerRow");this._decodeType5Shading(d,g);break;case Gr.COONS_PATCH_MESH:this._decodeType6Shading(d),f=!0;break;case Gr.TENSOR_PATCH_MESH:this._decodeType7Shading(d),f=!0;break;default:kn("Unsupported mesh type.");break}if(f){this._updateBounds();for(let g=0,m=this.figures.length;g<m;g++)this._buildFigureFromPatch(g)}this._updateBounds(),this._packData()}_decodeType4Shading(e){const t=this.coords,i=this.colors,s=[];let r=0;for(;e.hasData;){const a=e.readFlag(),o=e.readCoordinate(),l=e.readComponents();if(r===0){if(!(0<=a&&a<=2))throw new Te("Unknown type4 flag");switch(a){case 0:r=3;break;case 1:s.push(s.at(-2),s.at(-1)),r=1;break;case 2:s.push(s.at(-3),s.at(-1)),r=1;break}}s.push(t.length),t.push(o),i.push(l),r--,e.align()}this.figures.push({type:"triangles",coords:new Int32Array(s),colors:new Int32Array(s)})}_decodeType5Shading(e,t){const i=this.coords,s=this.colors,r=[];for(;e.hasData;){const a=e.readCoordinate(),o=e.readComponents();r.push(i.length),i.push(a),s.push(o)}this.figures.push({type:"lattice",coords:new Int32Array(r),colors:new Int32Array(r),verticesPerRow:t})}_decodeType6Shading(e){const t=this.coords,i=this.colors,s=new Int32Array(16),r=new Int32Array(4);for(;e.hasData;){const a=e.readFlag();if(!(0<=a&&a<=3))throw new Te("Unknown type6 flag");const o=t.length;for(let f=0,g=a!==0?8:12;f<g;f++)t.push(e.readCoordinate());const l=i.length;for(let f=0,g=a!==0?2:4;f<g;f++)i.push(e.readComponents());let c,h,u,d;switch(a){case 0:s[12]=o+3,s[13]=o+4,s[14]=o+5,s[15]=o+6,s[8]=o+2,s[11]=o+7,s[4]=o+1,s[7]=o+8,s[0]=o,s[1]=o+11,s[2]=o+10,s[3]=o+9,r[2]=l+1,r[3]=l+2,r[0]=l,r[1]=l+3;break;case 1:c=s[12],h=s[13],u=s[14],d=s[15],s[12]=d,s[13]=o+0,s[14]=o+1,s[15]=o+2,s[8]=u,s[11]=o+3,s[4]=h,s[7]=o+4,s[0]=c,s[1]=o+7,s[2]=o+6,s[3]=o+5,c=r[2],h=r[3],r[2]=h,r[3]=l,r[0]=c,r[1]=l+1;break;case 2:c=s[15],h=s[11],s[12]=s[3],s[13]=o+0,s[14]=o+1,s[15]=o+2,s[8]=s[7],s[11]=o+3,s[4]=h,s[7]=o+4,s[0]=c,s[1]=o+7,s[2]=o+6,s[3]=o+5,c=r[3],r[2]=r[1],r[3]=l,r[0]=c,r[1]=l+1;break;case 3:s[12]=s[0],s[13]=o+0,s[14]=o+1,s[15]=o+2,s[8]=s[1],s[11]=o+3,s[4]=s[2],s[7]=o+4,s[0]=s[3],s[1]=o+7,s[2]=o+6,s[3]=o+5,r[2]=r[0],r[3]=l,r[0]=r[1],r[1]=l+1;break}s[5]=t.length,t.push([(-4*t[s[0]][0]-t[s[15]][0]+6*(t[s[4]][0]+t[s[1]][0])-2*(t[s[12]][0]+t[s[3]][0])+3*(t[s[13]][0]+t[s[7]][0]))/9,(-4*t[s[0]][1]-t[s[15]][1]+6*(t[s[4]][1]+t[s[1]][1])-2*(t[s[12]][1]+t[s[3]][1])+3*(t[s[13]][1]+t[s[7]][1]))/9]),s[6]=t.length,t.push([(-4*t[s[3]][0]-t[s[12]][0]+6*(t[s[2]][0]+t[s[7]][0])-2*(t[s[0]][0]+t[s[15]][0])+3*(t[s[4]][0]+t[s[14]][0]))/9,(-4*t[s[3]][1]-t[s[12]][1]+6*(t[s[2]][1]+t[s[7]][1])-2*(t[s[0]][1]+t[s[15]][1])+3*(t[s[4]][1]+t[s[14]][1]))/9]),s[9]=t.length,t.push([(-4*t[s[12]][0]-t[s[3]][0]+6*(t[s[8]][0]+t[s[13]][0])-2*(t[s[0]][0]+t[s[15]][0])+3*(t[s[11]][0]+t[s[1]][0]))/9,(-4*t[s[12]][1]-t[s[3]][1]+6*(t[s[8]][1]+t[s[13]][1])-2*(t[s[0]][1]+t[s[15]][1])+3*(t[s[11]][1]+t[s[1]][1]))/9]),s[10]=t.length,t.push([(-4*t[s[15]][0]-t[s[0]][0]+6*(t[s[11]][0]+t[s[14]][0])-2*(t[s[12]][0]+t[s[3]][0])+3*(t[s[2]][0]+t[s[8]][0]))/9,(-4*t[s[15]][1]-t[s[0]][1]+6*(t[s[11]][1]+t[s[14]][1])-2*(t[s[12]][1]+t[s[3]][1])+3*(t[s[2]][1]+t[s[8]][1]))/9]),this.figures.push({type:"patch",coords:new Int32Array(s),colors:new Int32Array(r)})}}_decodeType7Shading(e){const t=this.coords,i=this.colors,s=new Int32Array(16),r=new Int32Array(4);for(;e.hasData;){const a=e.readFlag();if(!(0<=a&&a<=3))throw new Te("Unknown type7 flag");const o=t.length;for(let f=0,g=a!==0?12:16;f<g;f++)t.push(e.readCoordinate());const l=i.length;for(let f=0,g=a!==0?2:4;f<g;f++)i.push(e.readComponents());let c,h,u,d;switch(a){case 0:s[12]=o+3,s[13]=o+4,s[14]=o+5,s[15]=o+6,s[8]=o+2,s[9]=o+13,s[10]=o+14,s[11]=o+7,s[4]=o+1,s[5]=o+12,s[6]=o+15,s[7]=o+8,s[0]=o,s[1]=o+11,s[2]=o+10,s[3]=o+9,r[2]=l+1,r[3]=l+2,r[0]=l,r[1]=l+3;break;case 1:c=s[12],h=s[13],u=s[14],d=s[15],s[12]=d,s[13]=o+0,s[14]=o+1,s[15]=o+2,s[8]=u,s[9]=o+9,s[10]=o+10,s[11]=o+3,s[4]=h,s[5]=o+8,s[6]=o+11,s[7]=o+4,s[0]=c,s[1]=o+7,s[2]=o+6,s[3]=o+5,c=r[2],h=r[3],r[2]=h,r[3]=l,r[0]=c,r[1]=l+1;break;case 2:c=s[15],h=s[11],s[12]=s[3],s[13]=o+0,s[14]=o+1,s[15]=o+2,s[8]=s[7],s[9]=o+9,s[10]=o+10,s[11]=o+3,s[4]=h,s[5]=o+8,s[6]=o+11,s[7]=o+4,s[0]=c,s[1]=o+7,s[2]=o+6,s[3]=o+5,c=r[3],r[2]=r[1],r[3]=l,r[0]=c,r[1]=l+1;break;case 3:s[12]=s[0],s[13]=o+0,s[14]=o+1,s[15]=o+2,s[8]=s[1],s[9]=o+9,s[10]=o+10,s[11]=o+3,s[4]=s[2],s[5]=o+8,s[6]=o+11,s[7]=o+4,s[0]=s[3],s[1]=o+7,s[2]=o+6,s[3]=o+5,r[2]=r[0],r[3]=l,r[0]=r[1],r[1]=l+1;break}this.figures.push({type:"patch",coords:new Int32Array(s),colors:new Int32Array(r)})}}_buildFigureFromPatch(e){const t=this.figures[e];Hs(t.type==="patch","Unexpected patch mesh figure");const i=this.coords,s=this.colors,r=t.coords,a=t.colors,o=Math.min(i[r[0]][0],i[r[3]][0],i[r[12]][0],i[r[15]][0]),l=Math.min(i[r[0]][1],i[r[3]][1],i[r[12]][1],i[r[15]][1]),c=Math.max(i[r[0]][0],i[r[3]][0],i[r[12]][0],i[r[15]][0]),h=Math.max(i[r[0]][1],i[r[3]][1],i[r[12]][1],i[r[15]][1]);let u=Math.ceil((c-o)*To.TRIANGLE_DENSITY/(this.bounds[2]-this.bounds[0]));u=zs(u,To.MIN_SPLIT_PATCH_CHUNKS_AMOUNT,To.MAX_SPLIT_PATCH_CHUNKS_AMOUNT);let d=Math.ceil((h-l)*To.TRIANGLE_DENSITY/(this.bounds[3]-this.bounds[1]));d=zs(d,To.MIN_SPLIT_PATCH_CHUNKS_AMOUNT,To.MAX_SPLIT_PATCH_CHUNKS_AMOUNT);const f=u+1,g=new Int32Array((d+1)*f),m=new Int32Array((d+1)*f);let x=0;const p=new Uint8Array(3),y=new Uint8Array(3),w=s[a[0]],_=s[a[1]],v=s[a[2]],C=s[a[3]],k=Ok(d),I=Ok(u);for(let S=0;S<=d;S++){p[0]=(w[0]*(d-S)+v[0]*S)/d|0,p[1]=(w[1]*(d-S)+v[1]*S)/d|0,p[2]=(w[2]*(d-S)+v[2]*S)/d|0,y[0]=(_[0]*(d-S)+C[0]*S)/d|0,y[1]=(_[1]*(d-S)+C[1]*S)/d|0,y[2]=(_[2]*(d-S)+C[2]*S)/d|0;for(let M=0;M<=u;M++,x++){if((S===0||S===d)&&(M===0||M===u))continue;let N=0,F=0,H=0;for(let z=0;z<=3;z++)for(let R=0;R<=3;R++,H++){const L=k[S][z]*I[M][R];N+=i[r[H]][0]*L,F+=i[r[H]][1]*L}g[x]=i.length,i.push([N,F]),m[x]=s.length;const T=new Uint8Array(3);T[0]=(p[0]*(u-M)+y[0]*M)/u|0,T[1]=(p[1]*(u-M)+y[1]*M)/u|0,T[2]=(p[2]*(u-M)+y[2]*M)/u|0,s.push(T)}}g[0]=r[0],m[0]=a[0],g[u]=r[3],m[u]=a[1],g[f*d]=r[12],m[f*d]=a[2],g[f*d+u]=r[15],m[f*d+u]=a[3],this.figures[e]={type:"lattice",coords:g,colors:m,verticesPerRow:f}}_updateBounds(){let e=this.coords[0][0],t=this.coords[0][1],i=e,s=t;for(let r=1,a=this.coords.length;r<a;r++){const o=this.coords[r][0],l=this.coords[r][1];e=e>o?o:e,t=t>l?l:t,i=i<o?o:i,s=s<l?l:s}this.bounds=[e,t,i,s]}_packData(){let e,t,i,s;const r=this.coords,a=new Float32Array(r.length*2);for(e=0,i=0,t=r.length;e<t;e++){const h=r[e];a[i++]=h[0],a[i++]=h[1]}this.coords=a;const o=this.colors,l=new Uint8Array(o.length*3);for(e=0,i=0,t=o.length;e<t;e++){const h=o[e];l[i++]=h[0],l[i++]=h[1],l[i++]=h[2]}this.colors=l;const c=this.figures;for(e=0,t=c.length;e<t;e++){const h=c[e],u=h.coords,d=h.colors;for(i=0,s=u.length;i<s;i++)u[i]*=2,d[i]*=3}}getIR(){const{bounds:e}=this;if(e[2]-e[0]===0||e[3]-e[1]===0)throw new Te(`Invalid MeshShading bounds: [${e}].`);return["Mesh",this.shadingType,this.coords,this.colors,this.figures,e,this.bbox,this.background]}};He(To,"MIN_SPLIT_PATCH_CHUNKS_AMOUNT",3),He(To,"MAX_SPLIT_PATCH_CHUNKS_AMOUNT",20),He(To,"TRIANGLE_DENSITY",20);let J7=To;class wj extends r1{getIR(){return["Dummy"]}}function Dk(n,e,t){const i=Th(e.getArray("Matrix"),el),s=y0(e.getArray("BBox"),null);if(!s||s[2]-s[0]===0||s[3]-s[1]===0)throw new Te("Invalid getTilingPatternIR /BBox array.");const r=e.get("XStep");if(typeof r!="number")throw new Te("Invalid getTilingPatternIR /XStep value.");const a=e.get("YStep");if(typeof a!="number")throw new Te("Invalid getTilingPatternIR /YStep value.");const o=e.get("PaintType");if(!Number.isInteger(o))throw new Te("Invalid getTilingPatternIR /PaintType value.");const l=e.get("TilingType");if(!Number.isInteger(l))throw new Te("Invalid getTilingPatternIR /TilingType value.");return["TilingPattern",t,n,i,s,r,a,o,l]}const _j=[1.3877,1,1,1,.97801,.92482,.89552,.91133,.81988,.97566,.98152,.93548,.93548,1.2798,.85284,.92794,1,.96134,1.54657,.91133,.91133,.91133,.91133,.91133,.91133,.91133,.91133,.91133,.91133,.82845,.82845,.85284,.85284,.85284,.75859,.92138,.83908,.7762,.73293,.87289,.73133,.7514,.81921,.87356,.95958,.59526,.75727,.69225,1.04924,.9121,.86943,.79795,.88198,.77958,.70864,.81055,.90399,.88653,.96017,.82577,.77892,.78257,.97507,1.54657,.97507,.85284,.89552,.90176,.88762,.8785,.75241,.8785,.90518,.95015,.77618,.8785,.88401,.91916,.86304,.88401,.91488,.8785,.8801,.8785,.8785,.91343,.7173,1.04106,.8785,.85075,.95794,.82616,.85162,.79492,.88331,1.69808,.88331,.85284,.97801,.89552,.91133,.89552,.91133,1.7801,.89552,1.24487,1.13254,1.12401,.96839,.85284,.68787,.70645,.85592,.90747,1.01466,1.0088,.90323,1,1.07463,1,.91056,.75806,1.19118,.96839,.78864,.82845,.84133,.75859,.83908,.83908,.83908,.83908,.83908,.83908,.77539,.73293,.73133,.73133,.73133,.73133,.95958,.95958,.95958,.95958,.88506,.9121,.86943,.86943,.86943,.86943,.86943,.85284,.87508,.90399,.90399,.90399,.90399,.77892,.79795,.90807,.88762,.88762,.88762,.88762,.88762,.88762,.8715,.75241,.90518,.90518,.90518,.90518,.88401,.88401,.88401,.88401,.8785,.8785,.8801,.8801,.8801,.8801,.8801,.90747,.89049,.8785,.8785,.8785,.8785,.85162,.8785,.85162,.83908,.88762,.83908,.88762,.83908,.88762,.73293,.75241,.73293,.75241,.73293,.75241,.73293,.75241,.87289,.83016,.88506,.93125,.73133,.90518,.73133,.90518,.73133,.90518,.73133,.90518,.73133,.90518,.81921,.77618,.81921,.77618,.81921,.77618,1,1,.87356,.8785,.91075,.89608,.95958,.88401,.95958,.88401,.95958,.88401,.95958,.88401,.95958,.88401,.76229,.90167,.59526,.91916,1,1,.86304,.69225,.88401,1,1,.70424,.79468,.91926,.88175,.70823,.94903,.9121,.8785,1,1,.9121,.8785,.87802,.88656,.8785,.86943,.8801,.86943,.8801,.86943,.8801,.87402,.89291,.77958,.91343,1,1,.77958,.91343,.70864,.7173,.70864,.7173,.70864,.7173,.70864,.7173,1,1,.81055,.75841,.81055,1.06452,.90399,.8785,.90399,.8785,.90399,.8785,.90399,.8785,.90399,.8785,.90399,.8785,.96017,.95794,.77892,.85162,.77892,.78257,.79492,.78257,.79492,.78257,.79492,.9297,.56892,.83908,.88762,.77539,.8715,.87508,.89049,1,1,.81055,1.04106,1.20528,1.20528,1,1.15543,.70674,.98387,.94721,1.33431,1.45894,.95161,1.06303,.83908,.80352,.57184,.6965,.56289,.82001,.56029,.81235,1.02988,.83908,.7762,.68156,.80367,.73133,.78257,.87356,.86943,.95958,.75727,.89019,1.04924,.9121,.7648,.86943,.87356,.79795,.78275,.81055,.77892,.9762,.82577,.99819,.84896,.95958,.77892,.96108,1.01407,.89049,1.02988,.94211,.96108,.8936,.84021,.87842,.96399,.79109,.89049,1.00813,1.02988,.86077,.87445,.92099,.84723,.86513,.8801,.75638,.85714,.78216,.79586,.87965,.94211,.97747,.78287,.97926,.84971,1.02988,.94211,.8801,.94211,.84971,.73133,1,1,1,1,1,1,1,1,1,1,1,1,.90264,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.90518,1,1,1,1,1,1,1,1,1,1,1,1,.90548,1,1,1,1,1,1,.96017,.95794,.96017,.95794,.96017,.95794,.77892,.85162,1,1,.89552,.90527,1,.90363,.92794,.92794,.92794,.92794,.87012,.87012,.87012,.89552,.89552,1.42259,.71143,1.06152,1,1,1.03372,1.03372,.97171,1.4956,2.2807,.93835,.83406,.91133,.84107,.91133,1,1,1,.72021,1,1.23108,.83489,.88525,.88525,.81499,.90527,1.81055,.90527,1.81055,1.31006,1.53711,.94434,1.08696,1,.95018,.77192,.85284,.90747,1.17534,.69825,.9716,1.37077,.90747,.90747,.85356,.90747,.90747,1.44947,.85284,.8941,.8941,.70572,.8,.70572,.70572,.70572,.70572,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.99862,.99862,1,1,1,1,1,1.08004,.91027,1,1,1,.99862,1,1,1,1,1,1,1,1,1,1,1,1,.90727,.90727,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],vj={lineHeight:1.2207,lineGap:.2207},kj=[1.3877,1,1,1,.97801,.92482,.89552,.91133,.81988,.97566,.98152,.93548,.93548,1.2798,.85284,.92794,1,.96134,1.56239,.91133,.91133,.91133,.91133,.91133,.91133,.91133,.91133,.91133,.91133,.82845,.82845,.85284,.85284,.85284,.75859,.92138,.83908,.7762,.71805,.87289,.73133,.7514,.81921,.87356,.95958,.59526,.75727,.69225,1.04924,.90872,.85938,.79795,.87068,.77958,.69766,.81055,.90399,.88653,.96068,.82577,.77892,.78257,.97507,1.529,.97507,.85284,.89552,.90176,.94908,.86411,.74012,.86411,.88323,.95015,.86411,.86331,.88401,.91916,.86304,.88401,.9039,.86331,.86331,.86411,.86411,.90464,.70852,1.04106,.86331,.84372,.95794,.82616,.84548,.79492,.88331,1.69808,.88331,.85284,.97801,.89552,.91133,.89552,.91133,1.7801,.89552,1.24487,1.13254,1.19129,.96839,.85284,.68787,.70645,.85592,.90747,1.01466,1.0088,.90323,1,1.07463,1,.91056,.75806,1.19118,.96839,.78864,.82845,.84133,.75859,.83908,.83908,.83908,.83908,.83908,.83908,.77539,.71805,.73133,.73133,.73133,.73133,.95958,.95958,.95958,.95958,.88506,.90872,.85938,.85938,.85938,.85938,.85938,.85284,.87068,.90399,.90399,.90399,.90399,.77892,.79795,.90807,.94908,.94908,.94908,.94908,.94908,.94908,.85887,.74012,.88323,.88323,.88323,.88323,.88401,.88401,.88401,.88401,.8785,.86331,.86331,.86331,.86331,.86331,.86331,.90747,.89049,.86331,.86331,.86331,.86331,.84548,.86411,.84548,.83908,.94908,.83908,.94908,.83908,.94908,.71805,.74012,.71805,.74012,.71805,.74012,.71805,.74012,.87289,.79538,.88506,.92726,.73133,.88323,.73133,.88323,.73133,.88323,.73133,.88323,.73133,.88323,.81921,.86411,.81921,.86411,.81921,.86411,1,1,.87356,.86331,.91075,.8777,.95958,.88401,.95958,.88401,.95958,.88401,.95958,.88401,.95958,.88401,.76467,.90167,.59526,.91916,1,1,.86304,.69225,.88401,1,1,.70424,.77312,.91926,.88175,.70823,.94903,.90872,.86331,1,1,.90872,.86331,.86906,.88116,.86331,.85938,.86331,.85938,.86331,.85938,.86331,.87402,.86549,.77958,.90464,1,1,.77958,.90464,.69766,.70852,.69766,.70852,.69766,.70852,.69766,.70852,1,1,.81055,.75841,.81055,1.06452,.90399,.86331,.90399,.86331,.90399,.86331,.90399,.86331,.90399,.86331,.90399,.86331,.96068,.95794,.77892,.84548,.77892,.78257,.79492,.78257,.79492,.78257,.79492,.9297,.56892,.83908,.94908,.77539,.85887,.87068,.89049,1,1,.81055,1.04106,1.20528,1.20528,1,1.15543,.70088,.98387,.94721,1.33431,1.45894,.95161,1.48387,.83908,.80352,.57118,.6965,.56347,.79179,.55853,.80346,1.02988,.83908,.7762,.67174,.86036,.73133,.78257,.87356,.86441,.95958,.75727,.89019,1.04924,.90872,.74889,.85938,.87891,.79795,.7957,.81055,.77892,.97447,.82577,.97466,.87179,.95958,.77892,.94252,.95612,.8753,1.02988,.92733,.94252,.87411,.84021,.8728,.95612,.74081,.8753,1.02189,1.02988,.84814,.87445,.91822,.84723,.85668,.86331,.81344,.87581,.76422,.82046,.96057,.92733,.99375,.78022,.95452,.86015,1.02988,.92733,.86331,.92733,.86015,.73133,1,1,1,1,1,1,1,1,1,1,1,1,.90631,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.88323,1,1,1,1,1,1,1,1,1,1,1,1,.85174,1,1,1,1,1,1,.96068,.95794,.96068,.95794,.96068,.95794,.77892,.84548,1,1,.89552,.90527,1,.90363,.92794,.92794,.92794,.89807,.87012,.87012,.87012,.89552,.89552,1.42259,.71094,1.06152,1,1,1.03372,1.03372,.97171,1.4956,2.2807,.92972,.83406,.91133,.83326,.91133,1,1,1,.72021,1,1.23108,.83489,.88525,.88525,.81499,.90616,1.81055,.90527,1.81055,1.3107,1.53711,.94434,1.08696,1,.95018,.77192,.85284,.90747,1.17534,.69825,.9716,1.37077,.90747,.90747,.85356,.90747,.90747,1.44947,.85284,.8941,.8941,.70572,.8,.70572,.70572,.70572,.70572,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.99862,.99862,1,1,1,1,1,1.08004,.91027,1,1,1,.99862,1,1,1,1,1,1,1,1,1,1,1,1,.90727,.90727,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],Cj={lineHeight:1.2207,lineGap:.2207},Aj=[1.3877,1,1,1,1.17223,1.1293,.89552,.91133,.80395,1.02269,1.15601,.91056,.91056,1.2798,.85284,.89807,1,.90861,1.39543,.91133,.91133,.91133,.91133,.91133,.91133,.91133,.91133,.91133,.91133,.96309,.96309,.85284,.85284,.85284,.83319,.88071,.8675,.81552,.72346,.85193,.73206,.7522,.81105,.86275,.90685,.6377,.77892,.75593,1.02638,.89249,.84118,.77452,.85374,.75186,.67789,.79776,.88844,.85066,.94309,.77818,.7306,.76659,1.10369,1.38313,1.10369,1.06139,.89552,.8739,.9245,.9245,.83203,.9245,.85865,1.09842,.9245,.9245,1.03297,1.07692,.90918,1.03297,.94959,.9245,.92274,.9245,.9245,1.02933,.77832,1.20562,.9245,.8916,.98986,.86621,.89453,.79004,.94152,1.77256,.94152,.85284,.97801,.89552,.91133,.89552,.91133,1.91729,.89552,1.17889,1.13254,1.16359,.92098,.85284,.68787,.71353,.84737,.90747,1.0088,1.0044,.87683,1,1.09091,1,.92229,.739,1.15642,.92098,.76288,.80504,.80972,.75859,.8675,.8675,.8675,.8675,.8675,.8675,.76318,.72346,.73206,.73206,.73206,.73206,.90685,.90685,.90685,.90685,.86477,.89249,.84118,.84118,.84118,.84118,.84118,.85284,.84557,.88844,.88844,.88844,.88844,.7306,.77452,.86331,.9245,.9245,.9245,.9245,.9245,.9245,.84843,.83203,.85865,.85865,.85865,.85865,.82601,.82601,.82601,.82601,.94469,.9245,.92274,.92274,.92274,.92274,.92274,.90747,.86651,.9245,.9245,.9245,.9245,.89453,.9245,.89453,.8675,.9245,.8675,.9245,.8675,.9245,.72346,.83203,.72346,.83203,.72346,.83203,.72346,.83203,.85193,.8875,.86477,.99034,.73206,.85865,.73206,.85865,.73206,.85865,.73206,.85865,.73206,.85865,.81105,.9245,.81105,.9245,.81105,.9245,1,1,.86275,.9245,.90872,.93591,.90685,.82601,.90685,.82601,.90685,.82601,.90685,1.03297,.90685,.82601,.77896,1.05611,.6377,1.07692,1,1,.90918,.75593,1.03297,1,1,.76032,.9375,.98156,.93407,.77261,1.11429,.89249,.9245,1,1,.89249,.9245,.92534,.86698,.9245,.84118,.92274,.84118,.92274,.84118,.92274,.8667,.86291,.75186,1.02933,1,1,.75186,1.02933,.67789,.77832,.67789,.77832,.67789,.77832,.67789,.77832,1,1,.79776,.97655,.79776,1.23023,.88844,.9245,.88844,.9245,.88844,.9245,.88844,.9245,.88844,.9245,.88844,.9245,.94309,.98986,.7306,.89453,.7306,.76659,.79004,.76659,.79004,.76659,.79004,1.09231,.54873,.8675,.9245,.76318,.84843,.84557,.86651,1,1,.79776,1.20562,1.18622,1.18622,1,1.1437,.67009,.96334,.93695,1.35191,1.40909,.95161,1.48387,.8675,.90861,.6192,.7363,.64824,.82411,.56321,.85696,1.23516,.8675,.81552,.7286,.84134,.73206,.76659,.86275,.84369,.90685,.77892,.85871,1.02638,.89249,.75828,.84118,.85984,.77452,.76466,.79776,.7306,.90782,.77818,.903,.87291,.90685,.7306,.99058,1.03667,.94635,1.23516,.9849,.99058,.92393,.8916,.942,1.03667,.75026,.94635,1.0297,1.23516,.90918,.94048,.98217,.89746,.84153,.92274,.82507,.88832,.84438,.88178,1.03525,.9849,1.00225,.78086,.97248,.89404,1.23516,.9849,.92274,.9849,.89404,.73206,1,1,1,1,1,1,1,1,1,1,1,1,.89693,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.85865,1,1,1,1,1,1,1,1,1,1,1,1,.90933,1,1,1,1,1,1,.94309,.98986,.94309,.98986,.94309,.98986,.7306,.89453,1,1,.89552,.90527,1,.90186,1.12308,1.12308,1.12308,1.12308,1.2566,1.2566,1.2566,.89552,.89552,1.42259,.68994,1.03809,1,1,1.0176,1.0176,1.11523,1.4956,2.01462,.97858,.82616,.91133,.83437,.91133,1,1,1,.70508,1,1.23108,.79801,.84426,.84426,.774,.90572,1.81055,.90749,1.81055,1.28809,1.55469,.94434,1.07806,1,.97094,.7589,.85284,.90747,1.19658,.69825,.97622,1.33512,.90747,.90747,.85284,.90747,.90747,1.44947,.85284,.8941,.8941,.70572,.8,.70572,.70572,.70572,.70572,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.99862,.99862,1,1,1,1,1,1.0336,.91027,1,1,1,.99862,1,1,1,1,1,1,1,1,1,1,1,1,1.05859,1.05859,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],Sj={lineHeight:1.2207,lineGap:.2207},Ij=[1.3877,1,1,1,1.17223,1.1293,.89552,.91133,.80395,1.02269,1.15601,.91056,.91056,1.2798,.85284,.89807,1,.90861,1.39016,.91133,.91133,.91133,.91133,.91133,.91133,.91133,.91133,.91133,.91133,.96309,.96309,.85284,.85284,.85284,.83319,.88071,.8675,.81552,.73834,.85193,.73206,.7522,.81105,.86275,.90685,.6377,.77892,.75593,1.02638,.89385,.85122,.77452,.86503,.75186,.68887,.79776,.88844,.85066,.94258,.77818,.7306,.76659,1.10369,1.39016,1.10369,1.06139,.89552,.8739,.86128,.94469,.8457,.94469,.89464,1.09842,.84636,.94469,1.03297,1.07692,.90918,1.03297,.95897,.94469,.9482,.94469,.94469,1.04692,.78223,1.20562,.94469,.90332,.98986,.86621,.90527,.79004,.94152,1.77256,.94152,.85284,.97801,.89552,.91133,.89552,.91133,1.91729,.89552,1.17889,1.13254,1.08707,.92098,.85284,.68787,.71353,.84737,.90747,1.0088,1.0044,.87683,1,1.09091,1,.92229,.739,1.15642,.92098,.76288,.80504,.80972,.75859,.8675,.8675,.8675,.8675,.8675,.8675,.76318,.73834,.73206,.73206,.73206,.73206,.90685,.90685,.90685,.90685,.86477,.89385,.85122,.85122,.85122,.85122,.85122,.85284,.85311,.88844,.88844,.88844,.88844,.7306,.77452,.86331,.86128,.86128,.86128,.86128,.86128,.86128,.8693,.8457,.89464,.89464,.89464,.89464,.82601,.82601,.82601,.82601,.94469,.94469,.9482,.9482,.9482,.9482,.9482,.90747,.86651,.94469,.94469,.94469,.94469,.90527,.94469,.90527,.8675,.86128,.8675,.86128,.8675,.86128,.73834,.8457,.73834,.8457,.73834,.8457,.73834,.8457,.85193,.92454,.86477,.9921,.73206,.89464,.73206,.89464,.73206,.89464,.73206,.89464,.73206,.89464,.81105,.84636,.81105,.84636,.81105,.84636,1,1,.86275,.94469,.90872,.95786,.90685,.82601,.90685,.82601,.90685,.82601,.90685,1.03297,.90685,.82601,.77741,1.05611,.6377,1.07692,1,1,.90918,.75593,1.03297,1,1,.76032,.90452,.98156,1.11842,.77261,1.11429,.89385,.94469,1,1,.89385,.94469,.95877,.86901,.94469,.85122,.9482,.85122,.9482,.85122,.9482,.8667,.90016,.75186,1.04692,1,1,.75186,1.04692,.68887,.78223,.68887,.78223,.68887,.78223,.68887,.78223,1,1,.79776,.92188,.79776,1.23023,.88844,.94469,.88844,.94469,.88844,.94469,.88844,.94469,.88844,.94469,.88844,.94469,.94258,.98986,.7306,.90527,.7306,.76659,.79004,.76659,.79004,.76659,.79004,1.09231,.54873,.8675,.86128,.76318,.8693,.85311,.86651,1,1,.79776,1.20562,1.18622,1.18622,1,1.1437,.67742,.96334,.93695,1.35191,1.40909,.95161,1.48387,.86686,.90861,.62267,.74359,.65649,.85498,.56963,.88254,1.23516,.8675,.81552,.75443,.84503,.73206,.76659,.86275,.85122,.90685,.77892,.85746,1.02638,.89385,.75657,.85122,.86275,.77452,.74171,.79776,.7306,.95165,.77818,.89772,.88831,.90685,.7306,.98142,1.02191,.96576,1.23516,.99018,.98142,.9236,.89258,.94035,1.02191,.78848,.96576,.9561,1.23516,.90918,.92578,.95424,.89746,.83969,.9482,.80113,.89442,.85208,.86155,.98022,.99018,1.00452,.81209,.99247,.89181,1.23516,.99018,.9482,.99018,.89181,.73206,1,1,1,1,1,1,1,1,1,1,1,1,.88844,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.89464,1,1,1,1,1,1,1,1,1,1,1,1,.96766,1,1,1,1,1,1,.94258,.98986,.94258,.98986,.94258,.98986,.7306,.90527,1,1,.89552,.90527,1,.90186,1.12308,1.12308,1.12308,1.12308,1.2566,1.2566,1.2566,.89552,.89552,1.42259,.69043,1.03809,1,1,1.0176,1.0176,1.11523,1.4956,2.01462,.99331,.82616,.91133,.84286,.91133,1,1,1,.70508,1,1.23108,.79801,.84426,.84426,.774,.90527,1.81055,.90527,1.81055,1.28809,1.55469,.94434,1.07806,1,.97094,.7589,.85284,.90747,1.19658,.69825,.97622,1.33512,.90747,.90747,.85356,.90747,.90747,1.44947,.85284,.8941,.8941,.70572,.8,.70572,.70572,.70572,.70572,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.99862,.99862,1,1,1,1,1,1.0336,.91027,1,1,1,.99862,1,1,1,1,1,1,1,1,1,1,1,1,1.05859,1.05859,1,1,1,1.07185,.99413,.96334,1.08065,1,1,1,1,1,1,1,1,1,1,1],Ej={lineHeight:1.2207,lineGap:.2207},Tj=[.76116,1,1,1.0006,.99998,.99974,.99973,.99973,.99982,.99977,1.00087,.99998,.99998,.99959,1.00003,1.0006,.99998,1.0006,1.0006,.99973,.99973,.99973,.99973,.99973,.99973,.99973,.99973,.99973,.99973,.99998,1,1.00003,1.00003,1.00003,1.00026,.9999,.99977,.99977,.99977,.99977,1.00001,1.00026,1.00022,.99977,1.0006,.99973,.99977,1.00026,.99999,.99977,1.00022,1.00001,1.00022,.99977,1.00001,1.00026,.99977,1.00001,1.00016,1.00001,1.00001,1.00026,.99998,1.0006,.99998,1.00003,.99973,.99998,.99973,1.00026,.99973,1.00026,.99973,.99998,1.00026,1.00026,1.0006,1.0006,.99973,1.0006,.99982,1.00026,1.00026,1.00026,1.00026,.99959,.99973,.99998,1.00026,.99973,1.00022,.99973,.99973,1,.99959,1.00077,.99959,1.00003,.99998,.99973,.99973,.99973,.99973,1.00077,.99973,.99998,1.00025,.99968,.99973,1.00003,1.00025,.60299,1.00024,1.06409,1,1,.99998,1,.99973,1.0006,.99998,1,.99936,.99973,1.00002,1.00002,1.00002,1.00026,.99977,.99977,.99977,.99977,.99977,.99977,1,.99977,1.00001,1.00001,1.00001,1.00001,1.0006,1.0006,1.0006,1.0006,.99977,.99977,1.00022,1.00022,1.00022,1.00022,1.00022,1.00003,1.00022,.99977,.99977,.99977,.99977,1.00001,1.00001,1.00026,.99973,.99973,.99973,.99973,.99973,.99973,.99982,.99973,.99973,.99973,.99973,.99973,1.0006,1.0006,1.0006,1.0006,1.00026,1.00026,1.00026,1.00026,1.00026,1.00026,1.00026,1.06409,1.00026,1.00026,1.00026,1.00026,1.00026,.99973,1.00026,.99973,.99977,.99973,.99977,.99973,.99977,.99973,.99977,.99973,.99977,.99973,.99977,.99973,.99977,.99973,.99977,1.03374,.99977,1.00026,1.00001,.99973,1.00001,.99973,1.00001,.99973,1.00001,.99973,1.00001,.99973,1.00022,1.00026,1.00022,1.00026,1.00022,1.00026,1.00022,1.00026,.99977,1.00026,.99977,1.00026,1.0006,1.0006,1.0006,1.0006,1.0006,1.0006,1.0006,1.0006,1.0006,1.0006,1.00042,.99973,.99973,1.0006,.99977,.99973,.99973,1.00026,1.0006,1.00026,1.0006,1.00026,1.03828,1.00026,.99999,1.00026,1.0006,.99977,1.00026,.99977,1.00026,.99977,1.00026,.9993,.9998,1.00026,1.00022,1.00026,1.00022,1.00026,1.00022,1.00026,1,1.00016,.99977,.99959,.99977,.99959,.99977,.99959,1.00001,.99973,1.00001,.99973,1.00001,.99973,1.00001,.99973,1.00026,.99998,1.00026,.8121,1.00026,.99998,.99977,1.00026,.99977,1.00026,.99977,1.00026,.99977,1.00026,.99977,1.00026,.99977,1.00026,1.00016,1.00022,1.00001,.99973,1.00001,1.00026,1,1.00026,1,1.00026,1,1.0006,.99973,.99977,.99973,1,.99982,1.00022,1.00026,1.00001,.99973,1.00026,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,1.00034,.99977,1,.99997,1.00026,1.00078,1.00036,.99973,1.00013,1.0006,.99977,.99977,.99988,.85148,1.00001,1.00026,.99977,1.00022,1.0006,.99977,1.00001,.99999,.99977,1.00069,1.00022,.99977,1.00001,.99984,1.00026,1.00001,1.00024,1.00001,.9999,1,1.0006,1.00001,1.00041,.99962,1.00026,1.0006,.99995,1.00041,.99942,.99973,.99927,1.00082,.99902,1.00026,1.00087,1.0006,1.00069,.99973,.99867,.99973,.9993,1.00026,1.00049,1.00056,1,.99988,.99935,.99995,.99954,1.00055,.99945,1.00032,1.0006,.99995,1.00026,.99995,1.00032,1.00001,1.00008,.99971,1.00019,.9994,1.00001,1.0006,1.00044,.99973,1.00023,1.00047,1,.99942,.99561,.99989,1.00035,.99977,1.00035,.99977,1.00019,.99944,1.00001,1.00021,.99926,1.00035,1.00035,.99942,1.00048,.99999,.99977,1.00022,1.00035,1.00001,.99977,1.00026,.99989,1.00057,1.00001,.99936,1.00052,1.00012,.99996,1.00043,1,1.00035,.9994,.99976,1.00035,.99973,1.00052,1.00041,1.00119,1.00037,.99973,1.00002,.99986,1.00041,1.00041,.99902,.9996,1.00034,.99999,1.00026,.99999,1.00026,.99973,1.00052,.99973,1,.99973,1.00041,1.00075,.9994,1.0003,.99999,1,1.00041,.99955,1,.99915,.99973,.99973,1.00026,1.00119,.99955,.99973,1.0006,.99911,1.0006,1.00026,.99972,1.00026,.99902,1.00041,.99973,.99999,1,1,1.00038,1.0005,1.00016,1.00022,1.00016,1.00022,1.00016,1.00022,1.00001,.99973,1,1,.99973,1,1,.99955,1.0006,1.0006,1.0006,1.0006,1,1,1,.99973,.99973,.99972,1,1,1.00106,.99999,.99998,.99998,.99999,.99998,1.66475,1,.99973,.99973,1.00023,.99973,.99971,1.00047,1.00023,1,.99991,.99984,1.00002,1.00002,1.00002,1.00002,1,1,1,1,1,1,1,.99972,1,1.20985,1.39713,1.00003,1.00031,1.00015,1,.99561,1.00027,1.00031,1.00031,.99915,1.00031,1.00031,.99999,1.00003,.99999,.99999,1.41144,1.6,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.40579,1.40579,1.36625,.99999,1,.99861,.99861,1,1.00026,1.00026,1.00026,1.00026,.99972,.99999,.99999,.99999,.99999,1.40483,1,.99977,1.00054,1,1,.99953,.99962,1.00042,.9995,1,1,1,1,1,1,1,1,.99998,.99998,.99998,.99998,1,1,1,1,1,1,1,1,1,1,1],Rj={lineHeight:1.2,lineGap:.2},Mj=[.76116,1,1,1.0006,.99998,.99974,.99973,.99973,.99982,.99977,1.00087,.99998,.99998,.99959,1.00003,1.0006,.99998,1.0006,1.0006,.99973,.99973,.99973,.99973,.99973,.99973,.99973,.99973,.99973,.99973,.99998,1,1.00003,1.00003,1.00003,1.00026,.9999,.99977,.99977,.99977,.99977,1.00001,1.00026,1.00022,.99977,1.0006,.99973,.99977,1.00026,.99999,.99977,1.00022,1.00001,1.00022,.99977,1.00001,1.00026,.99977,1.00001,1.00016,1.00001,1.00001,1.00026,.99998,1.0006,.99998,1.00003,.99973,.99998,.99973,1.00026,.99973,1.00026,.99973,.99998,1.00026,1.00026,1.0006,1.0006,.99973,1.0006,.99982,1.00026,1.00026,1.00026,1.00026,.99959,.99973,.99998,1.00026,.99973,1.00022,.99973,.99973,1,.99959,1.00077,.99959,1.00003,.99998,.99973,.99973,.99973,.99973,1.00077,.99973,.99998,1.00025,.99968,.99973,1.00003,1.00025,.60299,1.00024,1.06409,1,1,.99998,1,.99973,1.0006,.99998,1,.99936,.99973,1.00002,1.00002,1.00002,1.00026,.99977,.99977,.99977,.99977,.99977,.99977,1,.99977,1.00001,1.00001,1.00001,1.00001,1.0006,1.0006,1.0006,1.0006,.99977,.99977,1.00022,1.00022,1.00022,1.00022,1.00022,1.00003,1.00022,.99977,.99977,.99977,.99977,1.00001,1.00001,1.00026,.99973,.99973,.99973,.99973,.99973,.99973,.99982,.99973,.99973,.99973,.99973,.99973,1.0006,1.0006,1.0006,1.0006,1.00026,1.00026,1.00026,1.00026,1.00026,1.00026,1.00026,1.06409,1.00026,1.00026,1.00026,1.00026,1.00026,.99973,1.00026,.99973,.99977,.99973,.99977,.99973,.99977,.99973,.99977,.99973,.99977,.99973,.99977,.99973,.99977,.99973,.99977,1.0044,.99977,1.00026,1.00001,.99973,1.00001,.99973,1.00001,.99973,1.00001,.99973,1.00001,.99973,1.00022,1.00026,1.00022,1.00026,1.00022,1.00026,1.00022,1.00026,.99977,1.00026,.99977,1.00026,1.0006,1.0006,1.0006,1.0006,1.0006,1.0006,1.0006,1.0006,1.0006,1.0006,.99971,.99973,.99973,1.0006,.99977,.99973,.99973,1.00026,1.0006,1.00026,1.0006,1.00026,1.01011,1.00026,.99999,1.00026,1.0006,.99977,1.00026,.99977,1.00026,.99977,1.00026,.9993,.9998,1.00026,1.00022,1.00026,1.00022,1.00026,1.00022,1.00026,1,1.00016,.99977,.99959,.99977,.99959,.99977,.99959,1.00001,.99973,1.00001,.99973,1.00001,.99973,1.00001,.99973,1.00026,.99998,1.00026,.8121,1.00026,.99998,.99977,1.00026,.99977,1.00026,.99977,1.00026,.99977,1.00026,.99977,1.00026,.99977,1.00026,1.00016,1.00022,1.00001,.99973,1.00001,1.00026,1,1.00026,1,1.00026,1,1.0006,.99973,.99977,.99973,1,.99982,1.00022,1.00026,1.00001,.99973,1.00026,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99977,1,1,1.00026,.99969,.99972,.99981,.9998,1.0006,.99977,.99977,1.00022,.91155,1.00001,1.00026,.99977,1.00022,1.0006,.99977,1.00001,.99999,.99977,.99966,1.00022,1.00032,1.00001,.99944,1.00026,1.00001,.99968,1.00001,1.00047,1,1.0006,1.00001,.99981,1.00101,1.00026,1.0006,.99948,.99981,1.00064,.99973,.99942,1.00101,1.00061,1.00026,1.00069,1.0006,1.00014,.99973,1.01322,.99973,1.00065,1.00026,1.00012,.99923,1,1.00064,1.00076,.99948,1.00055,1.00063,1.00007,.99943,1.0006,.99948,1.00026,.99948,.99943,1.00001,1.00001,1.00029,1.00038,1.00035,1.00001,1.0006,1.0006,.99973,.99978,1.00001,1.00057,.99989,.99967,.99964,.99967,.99977,.99999,.99977,1.00038,.99977,1.00001,.99973,1.00066,.99967,.99967,1.00041,.99998,.99999,.99977,1.00022,.99967,1.00001,.99977,1.00026,.99964,1.00031,1.00001,.99999,.99999,1,1.00023,1,1,.99999,1.00035,1.00001,.99999,.99973,.99977,.99999,1.00058,.99973,.99973,.99955,.9995,1.00026,1.00026,1.00032,.99989,1.00034,.99999,1.00026,1.00026,1.00026,.99973,.45998,.99973,1.00026,.99973,1.00001,.99999,.99982,.99994,.99996,1,1.00042,1.00044,1.00029,1.00023,.99973,.99973,1.00026,.99949,1.00002,.99973,1.0006,1.0006,1.0006,.99975,1.00026,1.00026,1.00032,.98685,.99973,1.00026,1,1,.99966,1.00044,1.00016,1.00022,1.00016,1.00022,1.00016,1.00022,1.00001,.99973,1,1,.99973,1,1,.99955,1.0006,1.0006,1.0006,1.0006,1,1,1,.99973,.99973,.99972,1,1,1.00106,.99999,.99998,.99998,.99999,.99998,1.66475,1,.99973,.99973,1,.99973,.99971,.99978,1,1,.99991,.99984,1.00002,1.00002,1.00002,1.00002,1.00098,1,1,1,1.00049,1,1,.99972,1,1.20985,1.39713,1.00003,1.00031,1.00015,1,.99561,1.00027,1.00031,1.00031,.99915,1.00031,1.00031,.99999,1.00003,.99999,.99999,1.41144,1.6,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.40579,1.40579,1.36625,.99999,1,.99861,.99861,1,1.00026,1.00026,1.00026,1.00026,.99972,.99999,.99999,.99999,.99999,1.40483,1,.99977,1.00054,1,1,.99953,.99962,1.00042,.9995,1,1,1,1,1,1,1,1,.99998,.99998,.99998,.99998,1,1,1,1,1,1,1,1,1,1,1],Pj={lineHeight:1.35,lineGap:.2},Nj=[.76116,1,1,1.0006,1.0006,1.00006,.99973,.99973,.99982,1.00001,1.00043,.99998,.99998,.99959,1.00003,1.0006,.99998,1.0006,1.0006,.99973,.99973,.99973,.99973,.99973,.99973,.99973,.99973,.99973,.99973,1.0006,1,1.00003,1.00003,1.00003,.99973,.99987,1.00001,1.00001,.99977,.99977,1.00001,1.00026,1.00022,.99977,1.0006,1,1.00001,.99973,.99999,.99977,1.00022,1.00001,1.00022,.99977,1.00001,1.00026,.99977,1.00001,1.00016,1.00001,1.00001,1.00026,1.0006,1.0006,1.0006,.99949,.99973,.99998,.99973,.99973,1,.99973,.99973,1.0006,.99973,.99973,.99924,.99924,1,.99924,.99999,.99973,.99973,.99973,.99973,.99998,1,1.0006,.99973,1,.99977,1,1,1,1.00005,1.0009,1.00005,1.00003,.99998,.99973,.99973,.99973,.99973,1.0009,.99973,.99998,1.00025,.99968,.99973,1.00003,1.00025,.60299,1.00024,1.06409,1,1,.99998,1,.9998,1.0006,.99998,1,.99936,.99973,1.00002,1.00002,1.00002,1.00026,1.00001,1.00001,1.00001,1.00001,1.00001,1.00001,1,.99977,1.00001,1.00001,1.00001,1.00001,1.0006,1.0006,1.0006,1.0006,.99977,.99977,1.00022,1.00022,1.00022,1.00022,1.00022,1.00003,1.00022,.99977,.99977,.99977,.99977,1.00001,1.00001,1.00026,.99973,.99973,.99973,.99973,.99973,.99973,.99982,1,.99973,.99973,.99973,.99973,1.0006,1.0006,1.0006,1.0006,.99973,.99973,.99973,.99973,.99973,.99973,.99973,1.06409,1.00026,.99973,.99973,.99973,.99973,1,.99973,1,1.00001,.99973,1.00001,.99973,1.00001,.99973,.99977,1,.99977,1,.99977,1,.99977,1,.99977,1.0288,.99977,.99973,1.00001,.99973,1.00001,.99973,1.00001,.99973,1.00001,.99973,1.00001,.99973,1.00022,.99973,1.00022,.99973,1.00022,.99973,1.00022,.99973,.99977,.99973,.99977,.99973,1.0006,1.0006,1.0006,1.0006,1.0006,1.0006,1.0006,.99924,1.0006,1.0006,.99946,1.00034,1,.99924,1.00001,1,1,.99973,.99924,.99973,.99924,.99973,1.06311,.99973,1.00024,.99973,.99924,.99977,.99973,.99977,.99973,.99977,.99973,1.00041,.9998,.99973,1.00022,.99973,1.00022,.99973,1.00022,.99973,1,1.00016,.99977,.99998,.99977,.99998,.99977,.99998,1.00001,1,1.00001,1,1.00001,1,1.00001,1,1.00026,1.0006,1.00026,.89547,1.00026,1.0006,.99977,.99973,.99977,.99973,.99977,.99973,.99977,.99973,.99977,.99973,.99977,.99973,1.00016,.99977,1.00001,1,1.00001,1.00026,1,1.00026,1,1.00026,1,.99924,.99973,1.00001,.99973,1,.99982,1.00022,1.00026,1.00001,1,1.00026,1.0006,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,1.00001,1,1.00054,.99977,1.00084,1.00007,.99973,1.00013,.99924,1.00001,1.00001,.99945,.91221,1.00001,1.00026,.99977,1.00022,1.0006,1.00001,1.00001,.99999,.99977,.99933,1.00022,1.00054,1.00001,1.00065,1.00026,1.00001,1.0001,1.00001,1.00052,1,1.0006,1.00001,.99945,.99897,.99968,.99924,1.00036,.99945,.99949,1,1.0006,.99897,.99918,.99968,.99911,.99924,1,.99962,1.01487,1,1.0005,.99973,1.00012,1.00043,1,.99995,.99994,1.00036,.99947,1.00019,1.00063,1.00025,.99924,1.00036,.99973,1.00036,1.00025,1.00001,1.00001,1.00027,1.0001,1.00068,1.00001,1.0006,1.0006,1,1.00008,.99957,.99972,.9994,.99954,.99975,1.00051,1.00001,1.00019,1.00001,1.0001,.99986,1.00001,1.00001,1.00038,.99954,.99954,.9994,1.00066,.99999,.99977,1.00022,1.00054,1.00001,.99977,1.00026,.99975,1.0001,1.00001,.99993,.9995,.99955,1.00016,.99978,.99974,1.00019,1.00022,.99955,1.00053,.99973,1.00089,1.00005,.99967,1.00048,.99973,1.00002,1.00034,.99973,.99973,.99964,1.00006,1.00066,.99947,.99973,.98894,.99973,1,.44898,1,.99946,1,1.00039,1.00082,.99991,.99991,.99985,1.00022,1.00023,1.00061,1.00006,.99966,.99973,.99973,.99973,1.00019,1.0008,1,.99924,.99924,.99924,.99983,1.00044,.99973,.99964,.98332,1,.99973,1,1,.99962,.99895,1.00016,.99977,1.00016,.99977,1.00016,.99977,1.00001,1,1,1,.99973,1,1,.99955,.99924,.99924,.99924,.99924,.99998,.99998,.99998,.99973,.99973,.99972,1,1,1.00267,.99999,.99998,.99998,1,.99998,1.66475,1,.99973,.99973,1.00023,.99973,1.00423,.99925,.99999,1,.99991,.99984,1.00002,1.00002,1.00002,1.00002,1.00049,1,1.00245,1,1,1,1,.96329,1,1.20985,1.39713,1.00003,.8254,1.00015,1,1.00035,1.00027,1.00031,1.00031,1.00003,1.00031,1.00031,.99999,1.00003,.99999,.99999,1.41144,1.6,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.40579,1.40579,1.36625,.99999,1,.99861,.99861,1,1.00026,1.00026,1.00026,1.00026,.95317,.99999,.99999,.99999,.99999,1.40483,1,.99977,1.00054,1,1,.99953,.99962,1.00042,.9995,1,1,1,1,1,1,1,1,.99998,.99998,.99998,.99998,1,1,1,1,1,1,1,1,1,1,1],Oj={lineHeight:1.35,lineGap:.2},Dj=[.76116,1,1,1.0006,1.0006,1.00006,.99973,.99973,.99982,1.00001,1.00043,.99998,.99998,.99959,1.00003,1.0006,.99998,1.0006,1.0006,.99973,.99973,.99973,.99973,.99973,.99973,.99973,.99973,.99973,.99973,1.0006,1,1.00003,1.00003,1.00003,.99973,.99987,1.00001,1.00001,.99977,.99977,1.00001,1.00026,1.00022,.99977,1.0006,1,1.00001,.99973,.99999,.99977,1.00022,1.00001,1.00022,.99977,1.00001,1.00026,.99977,1.00001,1.00016,1.00001,1.00001,1.00026,1.0006,1.0006,1.0006,.99949,.99973,.99998,.99973,.99973,1,.99973,.99973,1.0006,.99973,.99973,.99924,.99924,1,.99924,.99999,.99973,.99973,.99973,.99973,.99998,1,1.0006,.99973,1,.99977,1,1,1,1.00005,1.0009,1.00005,1.00003,.99998,.99973,.99973,.99973,.99973,1.0009,.99973,.99998,1.00025,.99968,.99973,1.00003,1.00025,.60299,1.00024,1.06409,1,1,.99998,1,.9998,1.0006,.99998,1,.99936,.99973,1.00002,1.00002,1.00002,1.00026,1.00001,1.00001,1.00001,1.00001,1.00001,1.00001,1,.99977,1.00001,1.00001,1.00001,1.00001,1.0006,1.0006,1.0006,1.0006,.99977,.99977,1.00022,1.00022,1.00022,1.00022,1.00022,1.00003,1.00022,.99977,.99977,.99977,.99977,1.00001,1.00001,1.00026,.99973,.99973,.99973,.99973,.99973,.99973,.99982,1,.99973,.99973,.99973,.99973,1.0006,1.0006,1.0006,1.0006,.99973,.99973,.99973,.99973,.99973,.99973,.99973,1.06409,1.00026,.99973,.99973,.99973,.99973,1,.99973,1,1.00001,.99973,1.00001,.99973,1.00001,.99973,.99977,1,.99977,1,.99977,1,.99977,1,.99977,1.04596,.99977,.99973,1.00001,.99973,1.00001,.99973,1.00001,.99973,1.00001,.99973,1.00001,.99973,1.00022,.99973,1.00022,.99973,1.00022,.99973,1.00022,.99973,.99977,.99973,.99977,.99973,1.0006,1.0006,1.0006,1.0006,1.0006,1.0006,1.0006,.99924,1.0006,1.0006,1.00019,1.00034,1,.99924,1.00001,1,1,.99973,.99924,.99973,.99924,.99973,1.02572,.99973,1.00005,.99973,.99924,.99977,.99973,.99977,.99973,.99977,.99973,.99999,.9998,.99973,1.00022,.99973,1.00022,.99973,1.00022,.99973,1,1.00016,.99977,.99998,.99977,.99998,.99977,.99998,1.00001,1,1.00001,1,1.00001,1,1.00001,1,1.00026,1.0006,1.00026,.84533,1.00026,1.0006,.99977,.99973,.99977,.99973,.99977,.99973,.99977,.99973,.99977,.99973,.99977,.99973,1.00016,.99977,1.00001,1,1.00001,1.00026,1,1.00026,1,1.00026,1,.99924,.99973,1.00001,.99973,1,.99982,1.00022,1.00026,1.00001,1,1.00026,1.0006,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99928,1,.99977,1.00013,1.00055,.99947,.99945,.99941,.99924,1.00001,1.00001,1.0004,.91621,1.00001,1.00026,.99977,1.00022,1.0006,1.00001,1.00005,.99999,.99977,1.00015,1.00022,.99977,1.00001,.99973,1.00026,1.00001,1.00019,1.00001,.99946,1,1.0006,1.00001,.99978,1.00045,.99973,.99924,1.00023,.99978,.99966,1,1.00065,1.00045,1.00019,.99973,.99973,.99924,1,1,.96499,1,1.00055,.99973,1.00008,1.00027,1,.9997,.99995,1.00023,.99933,1.00019,1.00015,1.00031,.99924,1.00023,.99973,1.00023,1.00031,1.00001,.99928,1.00029,1.00092,1.00035,1.00001,1.0006,1.0006,1,.99988,.99975,1,1.00082,.99561,.9996,1.00035,1.00001,.99962,1.00001,1.00092,.99964,1.00001,.99963,.99999,1.00035,1.00035,1.00082,.99962,.99999,.99977,1.00022,1.00035,1.00001,.99977,1.00026,.9996,.99967,1.00001,1.00034,1.00074,1.00054,1.00053,1.00063,.99971,.99962,1.00035,.99975,.99977,.99973,1.00043,.99953,1.0007,.99915,.99973,1.00008,.99892,1.00073,1.00073,1.00114,.99915,1.00073,.99955,.99973,1.00092,.99973,1,.99998,1,1.0003,1,1.00043,1.00001,.99969,1.0003,1,1.00035,1.00001,.9995,1,1.00092,.99973,.99973,.99973,1.0007,.9995,1,.99924,1.0006,.99924,.99972,1.00062,.99973,1.00114,1.00073,1,.99955,1,1,1.00047,.99968,1.00016,.99977,1.00016,.99977,1.00016,.99977,1.00001,1,1,1,.99973,1,1,.99955,.99924,.99924,.99924,.99924,.99998,.99998,.99998,.99973,.99973,.99972,1,1,1.00267,.99999,.99998,.99998,1,.99998,1.66475,1,.99973,.99973,1.00023,.99973,.99971,.99925,1.00023,1,.99991,.99984,1.00002,1.00002,1.00002,1.00002,1,1,1,1,1,1,1,.96329,1,1.20985,1.39713,1.00003,.8254,1.00015,1,1.00035,1.00027,1.00031,1.00031,.99915,1.00031,1.00031,.99999,1.00003,.99999,.99999,1.41144,1.6,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.40579,1.40579,1.36625,.99999,1,.99861,.99861,1,1.00026,1.00026,1.00026,1.00026,.95317,.99999,.99999,.99999,.99999,1.40483,1,.99977,1.00054,1,1,.99953,.99962,1.00042,.9995,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],Fj={lineHeight:1.2,lineGap:.2},Rm=[365,0,333,278,333,474,556,556,889,722,238,333,333,389,584,278,333,278,278,556,556,556,556,556,556,556,556,556,556,333,333,584,584,584,611,975,722,722,722,722,667,611,778,722,278,556,722,611,833,722,778,667,778,722,667,611,722,667,944,667,667,611,333,278,333,584,556,333,556,611,556,611,556,333,611,611,278,278,556,278,889,611,611,611,611,389,556,333,611,556,778,556,556,500,389,280,389,584,333,556,556,556,556,280,556,333,737,370,556,584,737,552,400,549,333,333,333,576,556,278,333,333,365,556,834,834,834,611,722,722,722,722,722,722,1e3,722,667,667,667,667,278,278,278,278,722,722,778,778,778,778,778,584,778,722,722,722,722,667,667,611,556,556,556,556,556,556,889,556,556,556,556,556,278,278,278,278,611,611,611,611,611,611,611,549,611,611,611,611,611,556,611,556,722,556,722,556,722,556,722,556,722,556,722,556,722,556,722,719,722,611,667,556,667,556,667,556,667,556,667,556,778,611,778,611,778,611,778,611,722,611,722,611,278,278,278,278,278,278,278,278,278,278,785,556,556,278,722,556,556,611,278,611,278,611,385,611,479,611,278,722,611,722,611,722,611,708,723,611,778,611,778,611,778,611,1e3,944,722,389,722,389,722,389,667,556,667,556,667,556,667,556,611,333,611,479,611,333,722,611,722,611,722,611,722,611,722,611,722,611,944,778,667,556,667,611,500,611,500,611,500,278,556,722,556,1e3,889,778,611,667,556,611,333,333,333,333,333,333,333,333,333,333,333,465,722,333,853,906,474,825,927,838,278,722,722,601,719,667,611,722,778,278,722,667,833,722,644,778,722,667,600,611,667,821,667,809,802,278,667,615,451,611,278,582,615,610,556,606,475,460,611,541,278,558,556,612,556,445,611,766,619,520,684,446,582,715,576,753,845,278,582,611,582,845,667,669,885,567,711,667,278,276,556,1094,1062,875,610,722,622,719,722,719,722,567,712,667,904,626,719,719,610,702,833,722,778,719,667,722,611,622,854,667,730,703,1005,1019,870,979,719,711,1031,719,556,618,615,417,635,556,709,497,615,615,500,635,740,604,611,604,611,556,490,556,875,556,615,581,833,844,729,854,615,552,854,583,556,556,611,417,552,556,278,281,278,969,906,611,500,615,556,604,778,611,487,447,944,778,944,778,944,778,667,556,333,333,556,1e3,1e3,552,278,278,278,278,500,500,500,556,556,350,1e3,1e3,240,479,333,333,604,333,167,396,556,556,1094,556,885,489,1115,1e3,768,600,834,834,834,834,1e3,500,1e3,500,1e3,500,500,494,612,823,713,584,549,713,979,722,274,549,549,583,549,549,604,584,604,604,708,625,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,729,604,604,354,354,1e3,990,990,990,990,494,604,604,604,604,354,1021,1052,917,750,750,531,656,594,510,500,750,750,611,611,333,333,333,333,333,333,333,333,222,222,333,333,333,333,333,333,333,333],Mm=[-1,-1,-1,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,161,162,163,164,165,166,167,168,169,170,171,172,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,402,506,507,508,509,510,511,536,537,538,539,710,711,713,728,729,730,731,732,733,900,901,902,903,904,905,906,908,910,911,912,913,914,915,916,917,918,919,920,921,922,923,924,925,926,927,928,929,931,932,933,934,935,936,937,938,939,940,941,942,943,944,945,946,947,948,949,950,951,952,953,954,955,956,957,958,959,960,961,962,963,964,965,966,967,968,969,970,971,972,973,974,1024,1025,1026,1027,1028,1029,1030,1031,1032,1033,1034,1035,1036,1037,1038,1039,1040,1041,1042,1043,1044,1045,1046,1047,1048,1049,1050,1051,1052,1053,1054,1055,1056,1057,1058,1059,1060,1061,1062,1063,1064,1065,1066,1067,1068,1069,1070,1071,1072,1073,1074,1075,1076,1077,1078,1079,1080,1081,1082,1083,1084,1085,1086,1087,1088,1089,1090,1091,1092,1093,1094,1095,1096,1097,1098,1099,1100,1101,1102,1103,1104,1105,1106,1107,1108,1109,1110,1111,1112,1113,1114,1115,1116,1117,1118,1119,1138,1139,1168,1169,7808,7809,7810,7811,7812,7813,7922,7923,8208,8209,8211,8212,8213,8215,8216,8217,8218,8219,8220,8221,8222,8224,8225,8226,8230,8240,8242,8243,8249,8250,8252,8254,8260,8319,8355,8356,8359,8364,8453,8467,8470,8482,8486,8494,8539,8540,8541,8542,8592,8593,8594,8595,8596,8597,8616,8706,8710,8719,8721,8722,8730,8734,8735,8745,8747,8776,8800,8801,8804,8805,8962,8976,8992,8993,9472,9474,9484,9488,9492,9496,9500,9508,9516,9524,9532,9552,9553,9554,9555,9556,9557,9558,9559,9560,9561,9562,9563,9564,9565,9566,9567,9568,9569,9570,9571,9572,9573,9574,9575,9576,9577,9578,9579,9580,9600,9604,9608,9612,9616,9617,9618,9619,9632,9633,9642,9643,9644,9650,9658,9660,9668,9674,9675,9679,9688,9689,9702,9786,9787,9788,9792,9794,9824,9827,9829,9830,9834,9835,9836,61441,61442,61445,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],Pm=[365,0,333,278,333,474,556,556,889,722,238,333,333,389,584,278,333,278,278,556,556,556,556,556,556,556,556,556,556,333,333,584,584,584,611,975,722,722,722,722,667,611,778,722,278,556,722,611,833,722,778,667,778,722,667,611,722,667,944,667,667,611,333,278,333,584,556,333,556,611,556,611,556,333,611,611,278,278,556,278,889,611,611,611,611,389,556,333,611,556,778,556,556,500,389,280,389,584,333,556,556,556,556,280,556,333,737,370,556,584,737,552,400,549,333,333,333,576,556,278,333,333,365,556,834,834,834,611,722,722,722,722,722,722,1e3,722,667,667,667,667,278,278,278,278,722,722,778,778,778,778,778,584,778,722,722,722,722,667,667,611,556,556,556,556,556,556,889,556,556,556,556,556,278,278,278,278,611,611,611,611,611,611,611,549,611,611,611,611,611,556,611,556,722,556,722,556,722,556,722,556,722,556,722,556,722,556,722,740,722,611,667,556,667,556,667,556,667,556,667,556,778,611,778,611,778,611,778,611,722,611,722,611,278,278,278,278,278,278,278,278,278,278,782,556,556,278,722,556,556,611,278,611,278,611,396,611,479,611,278,722,611,722,611,722,611,708,723,611,778,611,778,611,778,611,1e3,944,722,389,722,389,722,389,667,556,667,556,667,556,667,556,611,333,611,479,611,333,722,611,722,611,722,611,722,611,722,611,722,611,944,778,667,556,667,611,500,611,500,611,500,278,556,722,556,1e3,889,778,611,667,556,611,333,333,333,333,333,333,333,333,333,333,333,333,722,333,854,906,473,844,930,847,278,722,722,610,671,667,611,722,778,278,722,667,833,722,657,778,718,667,590,611,667,822,667,829,781,278,667,620,479,611,278,591,620,621,556,610,479,492,611,558,278,566,556,603,556,450,611,712,605,532,664,409,591,704,578,773,834,278,591,611,591,834,667,667,886,614,719,667,278,278,556,1094,1042,854,622,719,677,719,722,708,722,614,722,667,927,643,719,719,615,687,833,722,778,719,667,722,611,677,781,667,729,708,979,989,854,1e3,708,719,1042,729,556,619,604,534,618,556,736,510,611,611,507,622,740,604,611,611,611,556,889,556,885,556,646,583,889,935,707,854,594,552,865,589,556,556,611,469,563,556,278,278,278,969,906,611,507,619,556,611,778,611,575,467,944,778,944,778,944,778,667,556,333,333,556,1e3,1e3,552,278,278,278,278,500,500,500,556,556,350,1e3,1e3,240,479,333,333,604,333,167,396,556,556,1104,556,885,516,1146,1e3,768,600,834,834,834,834,999,500,1e3,500,1e3,500,500,494,612,823,713,584,549,713,979,722,274,549,549,583,549,549,604,584,604,604,708,625,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,729,604,604,354,354,1e3,990,990,990,990,494,604,604,604,604,354,1021,1052,917,750,750,531,656,594,510,500,750,750,611,611,333,333,333,333,333,333,333,333,222,222,333,333,333,333,333,333,333,333],Nm=[-1,-1,-1,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,161,162,163,164,165,166,167,168,169,170,171,172,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,402,506,507,508,509,510,511,536,537,538,539,710,711,713,728,729,730,731,732,733,900,901,902,903,904,905,906,908,910,911,912,913,914,915,916,917,918,919,920,921,922,923,924,925,926,927,928,929,931,932,933,934,935,936,937,938,939,940,941,942,943,944,945,946,947,948,949,950,951,952,953,954,955,956,957,958,959,960,961,962,963,964,965,966,967,968,969,970,971,972,973,974,1024,1025,1026,1027,1028,1029,1030,1031,1032,1033,1034,1035,1036,1037,1038,1039,1040,1041,1042,1043,1044,1045,1046,1047,1048,1049,1050,1051,1052,1053,1054,1055,1056,1057,1058,1059,1060,1061,1062,1063,1064,1065,1066,1067,1068,1069,1070,1071,1072,1073,1074,1075,1076,1077,1078,1079,1080,1081,1082,1083,1084,1085,1086,1087,1088,1089,1090,1091,1092,1093,1094,1095,1096,1097,1098,1099,1100,1101,1102,1103,1104,1105,1106,1107,1108,1109,1110,1111,1112,1113,1114,1115,1116,1117,1118,1119,1138,1139,1168,1169,7808,7809,7810,7811,7812,7813,7922,7923,8208,8209,8211,8212,8213,8215,8216,8217,8218,8219,8220,8221,8222,8224,8225,8226,8230,8240,8242,8243,8249,8250,8252,8254,8260,8319,8355,8356,8359,8364,8453,8467,8470,8482,8486,8494,8539,8540,8541,8542,8592,8593,8594,8595,8596,8597,8616,8706,8710,8719,8721,8722,8730,8734,8735,8745,8747,8776,8800,8801,8804,8805,8962,8976,8992,8993,9472,9474,9484,9488,9492,9496,9500,9508,9516,9524,9532,9552,9553,9554,9555,9556,9557,9558,9559,9560,9561,9562,9563,9564,9565,9566,9567,9568,9569,9570,9571,9572,9573,9574,9575,9576,9577,9578,9579,9580,9600,9604,9608,9612,9616,9617,9618,9619,9632,9633,9642,9643,9644,9650,9658,9660,9668,9674,9675,9679,9688,9689,9702,9786,9787,9788,9792,9794,9824,9827,9829,9830,9834,9835,9836,61441,61442,61445,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],Om=[365,0,333,278,278,355,556,556,889,667,191,333,333,389,584,278,333,278,278,556,556,556,556,556,556,556,556,556,556,278,278,584,584,584,556,1015,667,667,722,722,667,611,778,722,278,500,667,556,833,722,778,667,778,722,667,611,722,667,944,667,667,611,278,278,278,469,556,333,556,556,500,556,556,278,556,556,222,222,500,222,833,556,556,556,556,333,500,278,556,500,722,500,500,500,334,260,334,584,333,556,556,556,556,260,556,333,737,370,556,584,737,552,400,549,333,333,333,576,537,278,333,333,365,556,834,834,834,611,667,667,667,667,667,667,1e3,722,667,667,667,667,278,278,278,278,722,722,778,778,778,778,778,584,778,722,722,722,722,667,667,611,556,556,556,556,556,556,889,500,556,556,556,556,278,278,278,278,556,556,556,556,556,556,556,549,611,556,556,556,556,500,556,500,667,556,667,556,667,556,722,500,722,500,722,500,722,500,722,625,722,556,667,556,667,556,667,556,667,556,667,556,778,556,778,556,778,556,778,556,722,556,722,556,278,278,278,278,278,278,278,222,278,278,733,444,500,222,667,500,500,556,222,556,222,556,281,556,400,556,222,722,556,722,556,722,556,615,723,556,778,556,778,556,778,556,1e3,944,722,333,722,333,722,333,667,500,667,500,667,500,667,500,611,278,611,354,611,278,722,556,722,556,722,556,722,556,722,556,722,556,944,722,667,500,667,611,500,611,500,611,500,222,556,667,556,1e3,889,778,611,667,500,611,278,333,333,333,333,333,333,333,333,333,333,333,667,278,789,846,389,794,865,775,222,667,667,570,671,667,611,722,778,278,667,667,833,722,648,778,725,667,600,611,667,837,667,831,761,278,667,570,439,555,222,550,570,571,500,556,439,463,555,542,222,500,492,548,500,447,556,670,573,486,603,374,550,652,546,728,779,222,550,556,550,779,667,667,843,544,708,667,278,278,500,1066,982,844,589,715,639,724,667,651,667,544,704,667,917,614,715,715,589,686,833,722,778,725,667,722,611,639,795,667,727,673,920,923,805,886,651,694,1022,682,556,562,522,493,553,556,688,465,556,556,472,564,686,550,556,556,556,500,833,500,835,500,572,518,830,851,621,736,526,492,752,534,556,556,556,378,496,500,222,222,222,910,828,556,472,565,500,556,778,556,492,339,944,722,944,722,944,722,667,500,333,333,556,1e3,1e3,552,222,222,222,222,333,333,333,556,556,350,1e3,1e3,188,354,333,333,500,333,167,365,556,556,1094,556,885,323,1083,1e3,768,600,834,834,834,834,1e3,500,998,500,1e3,500,500,494,612,823,713,584,549,713,979,719,274,549,549,584,549,549,604,584,604,604,708,625,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,729,604,604,354,354,1e3,990,990,990,990,494,604,604,604,604,354,1021,1052,917,750,750,531,656,594,510,500,750,750,500,500,333,333,333,333,333,333,333,333,222,222,294,294,324,324,316,328,398,285],Dm=[-1,-1,-1,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,161,162,163,164,165,166,167,168,169,170,171,172,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,402,506,507,508,509,510,511,536,537,538,539,710,711,713,728,729,730,731,732,733,900,901,902,903,904,905,906,908,910,911,912,913,914,915,916,917,918,919,920,921,922,923,924,925,926,927,928,929,931,932,933,934,935,936,937,938,939,940,941,942,943,944,945,946,947,948,949,950,951,952,953,954,955,956,957,958,959,960,961,962,963,964,965,966,967,968,969,970,971,972,973,974,1024,1025,1026,1027,1028,1029,1030,1031,1032,1033,1034,1035,1036,1037,1038,1039,1040,1041,1042,1043,1044,1045,1046,1047,1048,1049,1050,1051,1052,1053,1054,1055,1056,1057,1058,1059,1060,1061,1062,1063,1064,1065,1066,1067,1068,1069,1070,1071,1072,1073,1074,1075,1076,1077,1078,1079,1080,1081,1082,1083,1084,1085,1086,1087,1088,1089,1090,1091,1092,1093,1094,1095,1096,1097,1098,1099,1100,1101,1102,1103,1104,1105,1106,1107,1108,1109,1110,1111,1112,1113,1114,1115,1116,1117,1118,1119,1138,1139,1168,1169,7808,7809,7810,7811,7812,7813,7922,7923,8208,8209,8211,8212,8213,8215,8216,8217,8218,8219,8220,8221,8222,8224,8225,8226,8230,8240,8242,8243,8249,8250,8252,8254,8260,8319,8355,8356,8359,8364,8453,8467,8470,8482,8486,8494,8539,8540,8541,8542,8592,8593,8594,8595,8596,8597,8616,8706,8710,8719,8721,8722,8730,8734,8735,8745,8747,8776,8800,8801,8804,8805,8962,8976,8992,8993,9472,9474,9484,9488,9492,9496,9500,9508,9516,9524,9532,9552,9553,9554,9555,9556,9557,9558,9559,9560,9561,9562,9563,9564,9565,9566,9567,9568,9569,9570,9571,9572,9573,9574,9575,9576,9577,9578,9579,9580,9600,9604,9608,9612,9616,9617,9618,9619,9632,9633,9642,9643,9644,9650,9658,9660,9668,9674,9675,9679,9688,9689,9702,9786,9787,9788,9792,9794,9824,9827,9829,9830,9834,9835,9836,61441,61442,61445,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],Fm=[365,0,333,278,278,355,556,556,889,667,191,333,333,389,584,278,333,278,278,556,556,556,556,556,556,556,556,556,556,278,278,584,584,584,556,1015,667,667,722,722,667,611,778,722,278,500,667,556,833,722,778,667,778,722,667,611,722,667,944,667,667,611,278,278,278,469,556,333,556,556,500,556,556,278,556,556,222,222,500,222,833,556,556,556,556,333,500,278,556,500,722,500,500,500,334,260,334,584,333,556,556,556,556,260,556,333,737,370,556,584,737,552,400,549,333,333,333,576,537,278,333,333,365,556,834,834,834,611,667,667,667,667,667,667,1e3,722,667,667,667,667,278,278,278,278,722,722,778,778,778,778,778,584,778,722,722,722,722,667,667,611,556,556,556,556,556,556,889,500,556,556,556,556,278,278,278,278,556,556,556,556,556,556,556,549,611,556,556,556,556,500,556,500,667,556,667,556,667,556,722,500,722,500,722,500,722,500,722,615,722,556,667,556,667,556,667,556,667,556,667,556,778,556,778,556,778,556,778,556,722,556,722,556,278,278,278,278,278,278,278,222,278,278,735,444,500,222,667,500,500,556,222,556,222,556,292,556,334,556,222,722,556,722,556,722,556,604,723,556,778,556,778,556,778,556,1e3,944,722,333,722,333,722,333,667,500,667,500,667,500,667,500,611,278,611,375,611,278,722,556,722,556,722,556,722,556,722,556,722,556,944,722,667,500,667,611,500,611,500,611,500,222,556,667,556,1e3,889,778,611,667,500,611,278,333,333,333,333,333,333,333,333,333,333,333,667,278,784,838,384,774,855,752,222,667,667,551,668,667,611,722,778,278,667,668,833,722,650,778,722,667,618,611,667,798,667,835,748,278,667,578,446,556,222,547,578,575,500,557,446,441,556,556,222,500,500,576,500,448,556,690,569,482,617,395,547,648,525,713,781,222,547,556,547,781,667,667,865,542,719,667,278,278,500,1057,1010,854,583,722,635,719,667,656,667,542,677,667,923,604,719,719,583,656,833,722,778,719,667,722,611,635,760,667,740,667,917,938,792,885,656,719,1010,722,556,573,531,365,583,556,669,458,559,559,438,583,688,552,556,542,556,500,458,500,823,500,573,521,802,823,625,719,521,510,750,542,556,556,556,365,510,500,222,278,222,906,812,556,438,559,500,552,778,556,489,411,944,722,944,722,944,722,667,500,333,333,556,1e3,1e3,552,222,222,222,222,333,333,333,556,556,350,1e3,1e3,188,354,333,333,500,333,167,365,556,556,1094,556,885,323,1073,1e3,768,600,834,834,834,834,1e3,500,1e3,500,1e3,500,500,494,612,823,713,584,549,713,979,719,274,549,549,583,549,549,604,584,604,604,708,625,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,729,604,604,354,354,1e3,990,990,990,990,494,604,604,604,604,354,1021,1052,917,750,750,531,656,594,510,500,750,750,500,500,333,333,333,333,333,333,333,333,222,222,294,294,324,324,316,328,398,285],Lm=[-1,-1,-1,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,161,162,163,164,165,166,167,168,169,170,171,172,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,402,506,507,508,509,510,511,536,537,538,539,710,711,713,728,729,730,731,732,733,900,901,902,903,904,905,906,908,910,911,912,913,914,915,916,917,918,919,920,921,922,923,924,925,926,927,928,929,931,932,933,934,935,936,937,938,939,940,941,942,943,944,945,946,947,948,949,950,951,952,953,954,955,956,957,958,959,960,961,962,963,964,965,966,967,968,969,970,971,972,973,974,1024,1025,1026,1027,1028,1029,1030,1031,1032,1033,1034,1035,1036,1037,1038,1039,1040,1041,1042,1043,1044,1045,1046,1047,1048,1049,1050,1051,1052,1053,1054,1055,1056,1057,1058,1059,1060,1061,1062,1063,1064,1065,1066,1067,1068,1069,1070,1071,1072,1073,1074,1075,1076,1077,1078,1079,1080,1081,1082,1083,1084,1085,1086,1087,1088,1089,1090,1091,1092,1093,1094,1095,1096,1097,1098,1099,1100,1101,1102,1103,1104,1105,1106,1107,1108,1109,1110,1111,1112,1113,1114,1115,1116,1117,1118,1119,1138,1139,1168,1169,7808,7809,7810,7811,7812,7813,7922,7923,8208,8209,8211,8212,8213,8215,8216,8217,8218,8219,8220,8221,8222,8224,8225,8226,8230,8240,8242,8243,8249,8250,8252,8254,8260,8319,8355,8356,8359,8364,8453,8467,8470,8482,8486,8494,8539,8540,8541,8542,8592,8593,8594,8595,8596,8597,8616,8706,8710,8719,8721,8722,8730,8734,8735,8745,8747,8776,8800,8801,8804,8805,8962,8976,8992,8993,9472,9474,9484,9488,9492,9496,9500,9508,9516,9524,9532,9552,9553,9554,9555,9556,9557,9558,9559,9560,9561,9562,9563,9564,9565,9566,9567,9568,9569,9570,9571,9572,9573,9574,9575,9576,9577,9578,9579,9580,9600,9604,9608,9612,9616,9617,9618,9619,9632,9633,9642,9643,9644,9650,9658,9660,9668,9674,9675,9679,9688,9689,9702,9786,9787,9788,9792,9794,9824,9827,9829,9830,9834,9835,9836,61441,61442,61445,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],Lj=[1.36898,1,1,.72706,.80479,.83734,.98894,.99793,.9897,.93884,.86209,.94292,.94292,1.16661,1.02058,.93582,.96694,.93582,1.19137,.99793,.99793,.99793,.99793,.99793,.99793,.99793,.99793,.99793,.99793,.78076,.78076,1.02058,1.02058,1.02058,.72851,.78966,.90838,.83637,.82391,.96376,.80061,.86275,.8768,.95407,1.0258,.73901,.85022,.83655,1.0156,.95546,.92179,.87107,.92179,.82114,.8096,.89713,.94438,.95353,.94083,.91905,.90406,.9446,.94292,1.18777,.94292,1.02058,.89903,.90088,.94938,.97898,.81093,.97571,.94938,1.024,.9577,.95933,.98621,1.0474,.97455,.98981,.9672,.95933,.9446,.97898,.97407,.97646,.78036,1.10208,.95442,.95298,.97579,.9332,.94039,.938,.80687,1.01149,.80687,1.02058,.80479,.99793,.99793,.99793,.99793,1.01149,1.00872,.90088,.91882,1.0213,.8361,1.02058,.62295,.54324,.89022,1.08595,1,1,.90088,1,.97455,.93582,.90088,1,1.05686,.8361,.99642,.99642,.99642,.72851,.90838,.90838,.90838,.90838,.90838,.90838,.868,.82391,.80061,.80061,.80061,.80061,1.0258,1.0258,1.0258,1.0258,.97484,.95546,.92179,.92179,.92179,.92179,.92179,1.02058,.92179,.94438,.94438,.94438,.94438,.90406,.86958,.98225,.94938,.94938,.94938,.94938,.94938,.94938,.9031,.81093,.94938,.94938,.94938,.94938,.98621,.98621,.98621,.98621,.93969,.95933,.9446,.9446,.9446,.9446,.9446,1.08595,.9446,.95442,.95442,.95442,.95442,.94039,.97898,.94039,.90838,.94938,.90838,.94938,.90838,.94938,.82391,.81093,.82391,.81093,.82391,.81093,.82391,.81093,.96376,.84313,.97484,.97571,.80061,.94938,.80061,.94938,.80061,.94938,.80061,.94938,.80061,.94938,.8768,.9577,.8768,.9577,.8768,.9577,1,1,.95407,.95933,.97069,.95933,1.0258,.98621,1.0258,.98621,1.0258,.98621,1.0258,.98621,1.0258,.98621,.887,1.01591,.73901,1.0474,1,1,.97455,.83655,.98981,1,1,.83655,.73977,.83655,.73903,.84638,1.033,.95546,.95933,1,1,.95546,.95933,.8271,.95417,.95933,.92179,.9446,.92179,.9446,.92179,.9446,.936,.91964,.82114,.97646,1,1,.82114,.97646,.8096,.78036,.8096,.78036,1,1,.8096,.78036,1,1,.89713,.77452,.89713,1.10208,.94438,.95442,.94438,.95442,.94438,.95442,.94438,.95442,.94438,.95442,.94438,.95442,.94083,.97579,.90406,.94039,.90406,.9446,.938,.9446,.938,.9446,.938,1,.99793,.90838,.94938,.868,.9031,.92179,.9446,1,1,.89713,1.10208,.90088,.90088,.90088,.90088,.90088,.90088,.90088,.90088,.90088,.90989,.9358,.91945,.83181,.75261,.87992,.82976,.96034,.83689,.97268,1.0078,.90838,.83637,.8019,.90157,.80061,.9446,.95407,.92436,1.0258,.85022,.97153,1.0156,.95546,.89192,.92179,.92361,.87107,.96318,.89713,.93704,.95638,.91905,.91709,.92796,1.0258,.93704,.94836,1.0373,.95933,1.0078,.95871,.94836,.96174,.92601,.9498,.98607,.95776,.95933,1.05453,1.0078,.98275,.9314,.95617,.91701,1.05993,.9446,.78367,.9553,1,.86832,1.0128,.95871,.99394,.87548,.96361,.86774,1.0078,.95871,.9446,.95871,.86774,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.94083,.97579,.94083,.97579,.94083,.97579,.90406,.94039,.96694,1,.89903,1,1,1,.93582,.93582,.93582,1,.908,.908,.918,.94219,.94219,.96544,1,1.285,1,1,.81079,.81079,1,1,.74854,1,1,1,1,.99793,1,1,1,.65,1,1.36145,1,1,1,1,1,1,1,1,1,1,1,1.17173,1,.80535,.76169,1.02058,1.0732,1.05486,1,1,1.30692,1.08595,1.08595,1,1.08595,1.08595,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1.16161,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],Bj={lineHeight:1.2,lineGap:.2},Uj=[1.36898,1,1,.66227,.80779,.81625,.97276,.97276,.97733,.92222,.83266,.94292,.94292,1.16148,1.02058,.93582,.96694,.93582,1.17337,.97276,.97276,.97276,.97276,.97276,.97276,.97276,.97276,.97276,.97276,.78076,.78076,1.02058,1.02058,1.02058,.71541,.76813,.85576,.80591,.80729,.94299,.77512,.83655,.86523,.92222,.98621,.71743,.81698,.79726,.98558,.92222,.90637,.83809,.90637,.80729,.76463,.86275,.90699,.91605,.9154,.85308,.85458,.90531,.94292,1.21296,.94292,1.02058,.89903,1.18616,.99613,.91677,.78216,.91677,.90083,.98796,.9135,.92168,.95381,.98981,.95298,.95381,.93459,.92168,.91513,.92004,.91677,.95077,.748,1.04502,.91677,.92061,.94236,.89544,.89364,.9,.80687,.8578,.80687,1.02058,.80779,.97276,.97276,.97276,.97276,.8578,.99973,1.18616,.91339,1.08074,.82891,1.02058,.55509,.71526,.89022,1.08595,1,1,1.18616,1,.96736,.93582,1.18616,1,1.04864,.82711,.99043,.99043,.99043,.71541,.85576,.85576,.85576,.85576,.85576,.85576,.845,.80729,.77512,.77512,.77512,.77512,.98621,.98621,.98621,.98621,.95961,.92222,.90637,.90637,.90637,.90637,.90637,1.02058,.90251,.90699,.90699,.90699,.90699,.85458,.83659,.94951,.99613,.99613,.99613,.99613,.99613,.99613,.85811,.78216,.90083,.90083,.90083,.90083,.95381,.95381,.95381,.95381,.9135,.92168,.91513,.91513,.91513,.91513,.91513,1.08595,.91677,.91677,.91677,.91677,.91677,.89364,.92332,.89364,.85576,.99613,.85576,.99613,.85576,.99613,.80729,.78216,.80729,.78216,.80729,.78216,.80729,.78216,.94299,.76783,.95961,.91677,.77512,.90083,.77512,.90083,.77512,.90083,.77512,.90083,.77512,.90083,.86523,.9135,.86523,.9135,.86523,.9135,1,1,.92222,.92168,.92222,.92168,.98621,.95381,.98621,.95381,.98621,.95381,.98621,.95381,.98621,.95381,.86036,.97096,.71743,.98981,1,1,.95298,.79726,.95381,1,1,.79726,.6894,.79726,.74321,.81691,1.0006,.92222,.92168,1,1,.92222,.92168,.79464,.92098,.92168,.90637,.91513,.90637,.91513,.90637,.91513,.909,.87514,.80729,.95077,1,1,.80729,.95077,.76463,.748,.76463,.748,1,1,.76463,.748,1,1,.86275,.72651,.86275,1.04502,.90699,.91677,.90699,.91677,.90699,.91677,.90699,.91677,.90699,.91677,.90699,.91677,.9154,.94236,.85458,.89364,.85458,.90531,.9,.90531,.9,.90531,.9,1,.97276,.85576,.99613,.845,.85811,.90251,.91677,1,1,.86275,1.04502,1.18616,1.18616,1.18616,1.18616,1.18616,1.18616,1.18616,1.18616,1.18616,1.00899,1.30628,.85576,.80178,.66862,.7927,.69323,.88127,.72459,.89711,.95381,.85576,.80591,.7805,.94729,.77512,.90531,.92222,.90637,.98621,.81698,.92655,.98558,.92222,.85359,.90637,.90976,.83809,.94523,.86275,.83509,.93157,.85308,.83392,.92346,.98621,.83509,.92886,.91324,.92168,.95381,.90646,.92886,.90557,.86847,.90276,.91324,.86842,.92168,.99531,.95381,.9224,.85408,.92699,.86847,1.0051,.91513,.80487,.93481,1,.88159,1.05214,.90646,.97355,.81539,.89398,.85923,.95381,.90646,.91513,.90646,.85923,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.9154,.94236,.9154,.94236,.9154,.94236,.85458,.89364,.96694,1,.89903,1,1,1,.91782,.91782,.91782,1,.896,.896,.896,.9332,.9332,.95973,1,1.26,1,1,.80479,.80178,1,1,.85633,1,1,1,1,.97276,1,1,1,.698,1,1.36145,1,1,1,1,1,1,1,1,1,1,1,1.14542,1,.79199,.78694,1.02058,1.03493,1.05486,1,1,1.23026,1.08595,1.08595,1,1.08595,1.08595,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1.20006,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],Hj={lineHeight:1.2,lineGap:.2},zj=[1.36898,1,1,.65507,.84943,.85639,.88465,.88465,.86936,.88307,.86948,.85283,.85283,1.06383,1.02058,.75945,.9219,.75945,1.17337,.88465,.88465,.88465,.88465,.88465,.88465,.88465,.88465,.88465,.88465,.75945,.75945,1.02058,1.02058,1.02058,.69046,.70926,.85158,.77812,.76852,.89591,.70466,.76125,.80094,.86822,.83864,.728,.77212,.79475,.93637,.87514,.8588,.76013,.8588,.72421,.69866,.77598,.85991,.80811,.87832,.78112,.77512,.8562,1.0222,1.18417,1.0222,1.27014,.89903,1.15012,.93859,.94399,.846,.94399,.81453,1.0186,.94219,.96017,1.03075,1.02175,.912,1.03075,.96998,.96017,.93859,.94399,.94399,.95493,.746,1.12658,.94578,.91,.979,.882,.882,.83,.85034,.83537,.85034,1.02058,.70869,.88465,.88465,.88465,.88465,.83537,.90083,1.15012,.9161,.94565,.73541,1.02058,.53609,.69353,.79519,1.08595,1,1,1.15012,1,.91974,.75945,1.15012,1,.9446,.73361,.9005,.9005,.9005,.62864,.85158,.85158,.85158,.85158,.85158,.85158,.773,.76852,.70466,.70466,.70466,.70466,.83864,.83864,.83864,.83864,.90561,.87514,.8588,.8588,.8588,.8588,.8588,1.02058,.85751,.85991,.85991,.85991,.85991,.77512,.76013,.88075,.93859,.93859,.93859,.93859,.93859,.93859,.8075,.846,.81453,.81453,.81453,.81453,.82424,.82424,.82424,.82424,.9278,.96017,.93859,.93859,.93859,.93859,.93859,1.08595,.8562,.94578,.94578,.94578,.94578,.882,.94578,.882,.85158,.93859,.85158,.93859,.85158,.93859,.76852,.846,.76852,.846,.76852,.846,.76852,.846,.89591,.8544,.90561,.94399,.70466,.81453,.70466,.81453,.70466,.81453,.70466,.81453,.70466,.81453,.80094,.94219,.80094,.94219,.80094,.94219,1,1,.86822,.96017,.86822,.96017,.83864,.82424,.83864,.82424,.83864,.82424,.83864,1.03075,.83864,.82424,.81402,1.02738,.728,1.02175,1,1,.912,.79475,1.03075,1,1,.79475,.83911,.79475,.66266,.80553,1.06676,.87514,.96017,1,1,.87514,.96017,.86865,.87396,.96017,.8588,.93859,.8588,.93859,.8588,.93859,.867,.84759,.72421,.95493,1,1,.72421,.95493,.69866,.746,.69866,.746,1,1,.69866,.746,1,1,.77598,.88417,.77598,1.12658,.85991,.94578,.85991,.94578,.85991,.94578,.85991,.94578,.85991,.94578,.85991,.94578,.87832,.979,.77512,.882,.77512,.8562,.83,.8562,.83,.8562,.83,1,.88465,.85158,.93859,.773,.8075,.85751,.8562,1,1,.77598,1.12658,1.15012,1.15012,1.15012,1.15012,1.15012,1.15313,1.15012,1.15012,1.15012,1.08106,1.03901,.85158,.77025,.62264,.7646,.65351,.86026,.69461,.89947,1.03075,.85158,.77812,.76449,.88836,.70466,.8562,.86822,.8588,.83864,.77212,.85308,.93637,.87514,.82352,.8588,.85701,.76013,.89058,.77598,.8156,.82565,.78112,.77899,.89386,.83864,.8156,.9486,.92388,.96186,1.03075,.91123,.9486,.93298,.878,.93942,.92388,.84596,.96186,.95119,1.03075,.922,.88787,.95829,.88,.93559,.93859,.78815,.93758,1,.89217,1.03737,.91123,.93969,.77487,.85769,.86799,1.03075,.91123,.93859,.91123,.86799,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.87832,.979,.87832,.979,.87832,.979,.77512,.882,.9219,1,.89903,1,1,1,.87321,.87321,.87321,1,1.027,1.027,1.027,.86847,.86847,.79121,1,1.124,1,1,.73572,.73572,1,1,.85034,1,1,1,1,.88465,1,1,1,.669,1,1.36145,1,1,1,1,1,1,1,1,1,1,1,1.04828,1,.74948,.75187,1.02058,.98391,1.02119,1,1,1.06233,1.08595,1.08595,1,1.08595,1.08595,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1.05233,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],jj={lineHeight:1.2,lineGap:.2},Gj=[1.36898,1,1,.76305,.82784,.94935,.89364,.92241,.89073,.90706,.98472,.85283,.85283,1.0664,1.02058,.74505,.9219,.74505,1.23456,.92241,.92241,.92241,.92241,.92241,.92241,.92241,.92241,.92241,.92241,.74505,.74505,1.02058,1.02058,1.02058,.73002,.72601,.91755,.8126,.80314,.92222,.73764,.79726,.83051,.90284,.86023,.74,.8126,.84869,.96518,.91115,.8858,.79761,.8858,.74498,.73914,.81363,.89591,.83659,.89633,.85608,.8111,.90531,1.0222,1.22736,1.0222,1.27014,.89903,.90088,.86667,1.0231,.896,1.01411,.90083,1.05099,1.00512,.99793,1.05326,1.09377,.938,1.06226,1.00119,.99793,.98714,1.0231,1.01231,.98196,.792,1.19137,.99074,.962,1.01915,.926,.942,.856,.85034,.92006,.85034,1.02058,.69067,.92241,.92241,.92241,.92241,.92006,.9332,.90088,.91882,.93484,.75339,1.02058,.56866,.54324,.79519,1.08595,1,1,.90088,1,.95325,.74505,.90088,1,.97198,.75339,.91009,.91009,.91009,.66466,.91755,.91755,.91755,.91755,.91755,.91755,.788,.80314,.73764,.73764,.73764,.73764,.86023,.86023,.86023,.86023,.92915,.91115,.8858,.8858,.8858,.8858,.8858,1.02058,.8858,.89591,.89591,.89591,.89591,.8111,.79611,.89713,.86667,.86667,.86667,.86667,.86667,.86667,.86936,.896,.90083,.90083,.90083,.90083,.84224,.84224,.84224,.84224,.97276,.99793,.98714,.98714,.98714,.98714,.98714,1.08595,.89876,.99074,.99074,.99074,.99074,.942,1.0231,.942,.91755,.86667,.91755,.86667,.91755,.86667,.80314,.896,.80314,.896,.80314,.896,.80314,.896,.92222,.93372,.92915,1.01411,.73764,.90083,.73764,.90083,.73764,.90083,.73764,.90083,.73764,.90083,.83051,1.00512,.83051,1.00512,.83051,1.00512,1,1,.90284,.99793,.90976,.99793,.86023,.84224,.86023,.84224,.86023,.84224,.86023,1.05326,.86023,.84224,.82873,1.07469,.74,1.09377,1,1,.938,.84869,1.06226,1,1,.84869,.83704,.84869,.81441,.85588,1.08927,.91115,.99793,1,1,.91115,.99793,.91887,.90991,.99793,.8858,.98714,.8858,.98714,.8858,.98714,.894,.91434,.74498,.98196,1,1,.74498,.98196,.73914,.792,.73914,.792,1,1,.73914,.792,1,1,.81363,.904,.81363,1.19137,.89591,.99074,.89591,.99074,.89591,.99074,.89591,.99074,.89591,.99074,.89591,.99074,.89633,1.01915,.8111,.942,.8111,.90531,.856,.90531,.856,.90531,.856,1,.92241,.91755,.86667,.788,.86936,.8858,.89876,1,1,.81363,1.19137,.90088,.90088,.90088,.90088,.90088,.90088,.90088,.90088,.90088,.90388,1.03901,.92138,.78105,.7154,.86169,.80513,.94007,.82528,.98612,1.06226,.91755,.8126,.81884,.92819,.73764,.90531,.90284,.8858,.86023,.8126,.91172,.96518,.91115,.83089,.8858,.87791,.79761,.89297,.81363,.88157,.89992,.85608,.81992,.94307,.86023,.88157,.95308,.98699,.99793,1.06226,.95817,.95308,.97358,.928,.98088,.98699,.92761,.99793,.96017,1.06226,.986,.944,.95978,.938,.96705,.98714,.80442,.98972,1,.89762,1.04552,.95817,.99007,.87064,.91879,.88888,1.06226,.95817,.98714,.95817,.88888,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.89633,1.01915,.89633,1.01915,.89633,1.01915,.8111,.942,.9219,1,.89903,1,1,1,.93173,.93173,.93173,1,1.06304,1.06304,1.06904,.89903,.89903,.80549,1,1.156,1,1,.76575,.76575,1,1,.72458,1,1,1,1,.92241,1,1,1,.619,1,1.36145,1,1,1,1,1,1,1,1,1,1,1,1.07257,1,.74705,.71119,1.02058,1.024,1.02119,1,1,1.1536,1.08595,1.08595,1,1.08595,1.08595,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1.05638,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],Vj={lineHeight:1.2,lineGap:.2},qj=[1.76738,1,1,.99297,.9824,1.04016,1.06497,1.03424,.97529,1.17647,1.23203,1.1085,1.1085,1.16939,1.2107,.9754,1.21408,.9754,1.59578,1.03424,1.03424,1.03424,1.03424,1.03424,1.03424,1.03424,1.03424,1.03424,1.03424,.81378,.81378,1.2107,1.2107,1.2107,.71703,.97847,.97363,.88776,.8641,1.02096,.79795,.85132,.914,1.06085,1.1406,.8007,.89858,.83693,1.14889,1.09398,.97489,.92094,.97489,.90399,.84041,.95923,1.00135,1,1.06467,.98243,.90996,.99361,1.1085,1.56942,1.1085,1.2107,.74627,.94282,.96752,1.01519,.86304,1.01359,.97278,1.15103,1.01359,.98561,1.02285,1.02285,1.00527,1.02285,1.0302,.99041,1.0008,1.01519,1.01359,1.02258,.79104,1.16862,.99041,.97454,1.02511,.99298,.96752,.95801,.94856,1.16579,.94856,1.2107,.9824,1.03424,1.03424,1,1.03424,1.16579,.8727,1.3871,1.18622,1.10818,1.04478,1.2107,1.18622,.75155,.94994,1.28826,1.21408,1.21408,.91056,1,.91572,.9754,.64663,1.18328,1.24866,1.04478,1.14169,1.15749,1.17389,.71703,.97363,.97363,.97363,.97363,.97363,.97363,.93506,.8641,.79795,.79795,.79795,.79795,1.1406,1.1406,1.1406,1.1406,1.02096,1.09398,.97426,.97426,.97426,.97426,.97426,1.2107,.97489,1.00135,1.00135,1.00135,1.00135,.90996,.92094,1.02798,.96752,.96752,.96752,.96752,.96752,.96752,.93136,.86304,.97278,.97278,.97278,.97278,1.02285,1.02285,1.02285,1.02285,.97122,.99041,1,1,1,1,1,1.28826,1.0008,.99041,.99041,.99041,.99041,.96752,1.01519,.96752,.97363,.96752,.97363,.96752,.97363,.96752,.8641,.86304,.8641,.86304,.8641,.86304,.8641,.86304,1.02096,1.03057,1.02096,1.03517,.79795,.97278,.79795,.97278,.79795,.97278,.79795,.97278,.79795,.97278,.914,1.01359,.914,1.01359,.914,1.01359,1,1,1.06085,.98561,1.06085,1.00879,1.1406,1.02285,1.1406,1.02285,1.1406,1.02285,1.1406,1.02285,1.1406,1.02285,.97138,1.08692,.8007,1.02285,1,1,1.00527,.83693,1.02285,1,1,.83693,.9455,.83693,.90418,.83693,1.13005,1.09398,.99041,1,1,1.09398,.99041,.96692,1.09251,.99041,.97489,1.0008,.97489,1.0008,.97489,1.0008,.93994,.97931,.90399,1.02258,1,1,.90399,1.02258,.84041,.79104,.84041,.79104,.84041,.79104,.84041,.79104,1,1,.95923,1.07034,.95923,1.16862,1.00135,.99041,1.00135,.99041,1.00135,.99041,1.00135,.99041,1.00135,.99041,1.00135,.99041,1.06467,1.02511,.90996,.96752,.90996,.99361,.95801,.99361,.95801,.99361,.95801,1.07733,1.03424,.97363,.96752,.93506,.93136,.97489,1.0008,1,1,.95923,1.16862,1.15103,1.15103,1.01173,1.03959,.75953,.81378,.79912,1.15103,1.21994,.95161,.87815,1.01149,.81525,.7676,.98167,1.01134,1.02546,.84097,1.03089,1.18102,.97363,.88776,.85134,.97826,.79795,.99361,1.06085,.97489,1.1406,.89858,1.0388,1.14889,1.09398,.86039,.97489,1.0595,.92094,.94793,.95923,.90996,.99346,.98243,1.02112,.95493,1.1406,.90996,1.03574,1.02597,1.0008,1.18102,1.06628,1.03574,1.0192,1.01932,1.00886,.97531,1.0106,1.0008,1.13189,1.18102,1.02277,.98683,1.0016,.99561,1.07237,1.0008,.90434,.99921,.93803,.8965,1.23085,1.06628,1.04983,.96268,1.0499,.98439,1.18102,1.06628,1.0008,1.06628,.98439,.79795,1,1,1,1,1,1,1,1,1,1,1,1,1.09466,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.97278,1,1,1,1,1,1,1,1,1,1,1,1,1.02065,1,1,1,1,1,1,1.06467,1.02511,1.06467,1.02511,1.06467,1.02511,.90996,.96752,1,1.21408,.89903,1,1,.75155,1.04394,1.04394,1.04394,1.04394,.98633,.98633,.98633,.73047,.73047,1.20642,.91211,1.25635,1.222,1.02956,1.03372,1.03372,.96039,1.24633,1,1.12454,.93503,1.03424,1.19687,1.03424,1,1,1,.771,1,1,1.15749,1.15749,1.15749,1.10948,.86279,.94434,.86279,.94434,.86182,1,1,1.16897,1,.96085,.90137,1.2107,1.18416,1.13973,.69825,.9716,2.10339,1.29004,1.29004,1.21172,1.29004,1.29004,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1.42603,1,.99862,.99862,1,.87025,.87025,.87025,.87025,1.18874,1.42603,1,1.42603,1.42603,.99862,1,1,1,1,1,1.2886,1.04315,1.15296,1.34163,1,1,1,1.09193,1.09193,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],Wj={lineHeight:1.33008,lineGap:0},Kj=[1.76738,1,1,.98946,1.03959,1.04016,1.02809,1.036,.97639,1.10953,1.23203,1.11144,1.11144,1.16939,1.21237,.9754,1.21261,.9754,1.59754,1.036,1.036,1.036,1.036,1.036,1.036,1.036,1.036,1.036,1.036,.81378,.81378,1.21237,1.21237,1.21237,.73541,.97847,.97363,.89723,.87897,1.0426,.79429,.85292,.91149,1.05815,1.1406,.79631,.90128,.83853,1.04396,1.10615,.97552,.94436,.97552,.88641,.80527,.96083,1.00135,1,1.06777,.9817,.91142,.99361,1.11144,1.57293,1.11144,1.21237,.74627,1.31818,1.06585,.97042,.83055,.97042,.93503,1.1261,.97042,.97922,1.14236,.94552,1.01054,1.14236,1.02471,.97922,.94165,.97042,.97042,1.0276,.78929,1.1261,.97922,.95874,1.02197,.98507,.96752,.97168,.95107,1.16579,.95107,1.21237,1.03959,1.036,1.036,1,1.036,1.16579,.87357,1.31818,1.18754,1.26781,1.05356,1.21237,1.18622,.79487,.94994,1.29004,1.24047,1.24047,1.31818,1,.91484,.9754,1.31818,1.1349,1.24866,1.05356,1.13934,1.15574,1.17389,.73541,.97363,.97363,.97363,.97363,.97363,.97363,.94385,.87897,.79429,.79429,.79429,.79429,1.1406,1.1406,1.1406,1.1406,1.0426,1.10615,.97552,.97552,.97552,.97552,.97552,1.21237,.97552,1.00135,1.00135,1.00135,1.00135,.91142,.94436,.98721,1.06585,1.06585,1.06585,1.06585,1.06585,1.06585,.96705,.83055,.93503,.93503,.93503,.93503,1.14236,1.14236,1.14236,1.14236,.93125,.97922,.94165,.94165,.94165,.94165,.94165,1.29004,.94165,.97922,.97922,.97922,.97922,.96752,.97042,.96752,.97363,1.06585,.97363,1.06585,.97363,1.06585,.87897,.83055,.87897,.83055,.87897,.83055,.87897,.83055,1.0426,1.0033,1.0426,.97042,.79429,.93503,.79429,.93503,.79429,.93503,.79429,.93503,.79429,.93503,.91149,.97042,.91149,.97042,.91149,.97042,1,1,1.05815,.97922,1.05815,.97922,1.1406,1.14236,1.1406,1.14236,1.1406,1.14236,1.1406,1.14236,1.1406,1.14236,.97441,1.04302,.79631,1.01582,1,1,1.01054,.83853,1.14236,1,1,.83853,1.09125,.83853,.90418,.83853,1.19508,1.10615,.97922,1,1,1.10615,.97922,1.01034,1.10466,.97922,.97552,.94165,.97552,.94165,.97552,.94165,.91602,.91981,.88641,1.0276,1,1,.88641,1.0276,.80527,.78929,.80527,.78929,.80527,.78929,.80527,.78929,1,1,.96083,1.05403,.95923,1.16862,1.00135,.97922,1.00135,.97922,1.00135,.97922,1.00135,.97922,1.00135,.97922,1.00135,.97922,1.06777,1.02197,.91142,.96752,.91142,.99361,.97168,.99361,.97168,.99361,.97168,1.23199,1.036,.97363,1.06585,.94385,.96705,.97552,.94165,1,1,.96083,1.1261,1.31818,1.31818,1.31818,1.31818,1.31818,1.31818,1.31818,1.31818,1.31818,.95161,1.27126,1.00811,.83284,.77702,.99137,.95253,1.0347,.86142,1.07205,1.14236,.97363,.89723,.86869,1.09818,.79429,.99361,1.05815,.97552,1.1406,.90128,1.06662,1.04396,1.10615,.84918,.97552,1.04694,.94436,.98015,.96083,.91142,1.00356,.9817,1.01945,.98999,1.1406,.91142,1.04961,.9898,1.00639,1.14236,1.07514,1.04961,.99607,1.02897,1.008,.9898,.95134,1.00639,1.11121,1.14236,1.00518,.97981,1.02186,1,1.08578,.94165,.99314,.98387,.93028,.93377,1.35125,1.07514,1.10687,.93491,1.04232,1.00351,1.14236,1.07514,.94165,1.07514,1.00351,.79429,1,1,1,1,1,1,1,1,1,1,1,1,1.09097,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.93503,1,1,1,1,1,1,1,1,1,1,1,1,.96609,1,1,1,1,1,1,1.06777,1.02197,1.06777,1.02197,1.06777,1.02197,.91142,.96752,1,1.21261,.89903,1,1,.75155,1.04745,1.04745,1.04745,1.04394,.98633,.98633,.98633,.72959,.72959,1.20502,.91406,1.26514,1.222,1.02956,1.03372,1.03372,.96039,1.24633,1,1.09125,.93327,1.03336,1.16541,1.036,1,1,1,.771,1,1,1.15574,1.15574,1.15574,1.15574,.86364,.94434,.86279,.94434,.86224,1,1,1.16798,1,.96085,.90068,1.21237,1.18416,1.13904,.69825,.9716,2.10339,1.29004,1.29004,1.21339,1.29004,1.29004,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1.42603,1,.99862,.99862,1,.87025,.87025,.87025,.87025,1.18775,1.42603,1,1.42603,1.42603,.99862,1,1,1,1,1,1.2886,1.04315,1.15296,1.34163,1,1,1,1.13269,1.13269,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],Xj={lineHeight:1.33008,lineGap:0},Yj=[1.76738,1,1,.98946,1.14763,1.05365,1.06234,.96927,.92586,1.15373,1.18414,.91349,.91349,1.07403,1.17308,.78383,1.20088,.78383,1.42531,.96927,.96927,.96927,.96927,.96927,.96927,.96927,.96927,.96927,.96927,.78383,.78383,1.17308,1.17308,1.17308,.77349,.94565,.94729,.85944,.88506,.9858,.74817,.80016,.88449,.98039,.95782,.69238,.89898,.83231,.98183,1.03989,.96924,.86237,.96924,.80595,.74524,.86091,.95402,.94143,.98448,.8858,.83089,.93285,1.0949,1.39016,1.0949,1.45994,.74627,1.04839,.97454,.97454,.87207,.97454,.87533,1.06151,.97454,1.00176,1.16484,1.08132,.98047,1.16484,1.02989,1.01054,.96225,.97454,.97454,1.06598,.79004,1.16344,1.00351,.94629,.9973,.91016,.96777,.9043,.91082,.92481,.91082,1.17308,.95748,.96927,.96927,1,.96927,.92481,.80597,1.04839,1.23393,1.1781,.9245,1.17308,1.20808,.63218,.94261,1.24822,1.09971,1.09971,1.04839,1,.85273,.78032,1.04839,1.09971,1.22326,.9245,1.09836,1.13525,1.15222,.70424,.94729,.94729,.94729,.94729,.94729,.94729,.85498,.88506,.74817,.74817,.74817,.74817,.95782,.95782,.95782,.95782,.9858,1.03989,.96924,.96924,.96924,.96924,.96924,1.17308,.96924,.95402,.95402,.95402,.95402,.83089,.86237,.88409,.97454,.97454,.97454,.97454,.97454,.97454,.92916,.87207,.87533,.87533,.87533,.87533,.93146,.93146,.93146,.93146,.93854,1.01054,.96225,.96225,.96225,.96225,.96225,1.24822,.8761,1.00351,1.00351,1.00351,1.00351,.96777,.97454,.96777,.94729,.97454,.94729,.97454,.94729,.97454,.88506,.87207,.88506,.87207,.88506,.87207,.88506,.87207,.9858,.95391,.9858,.97454,.74817,.87533,.74817,.87533,.74817,.87533,.74817,.87533,.74817,.87533,.88449,.97454,.88449,.97454,.88449,.97454,1,1,.98039,1.00176,.98039,1.00176,.95782,.93146,.95782,.93146,.95782,.93146,.95782,1.16484,.95782,.93146,.84421,1.12761,.69238,1.08132,1,1,.98047,.83231,1.16484,1,1,.84723,1.04861,.84723,.78755,.83231,1.23736,1.03989,1.01054,1,1,1.03989,1.01054,.9857,1.03849,1.01054,.96924,.96225,.96924,.96225,.96924,.96225,.92383,.90171,.80595,1.06598,1,1,.80595,1.06598,.74524,.79004,.74524,.79004,.74524,.79004,.74524,.79004,1,1,.86091,1.02759,.85771,1.16344,.95402,1.00351,.95402,1.00351,.95402,1.00351,.95402,1.00351,.95402,1.00351,.95402,1.00351,.98448,.9973,.83089,.96777,.83089,.93285,.9043,.93285,.9043,.93285,.9043,1.31868,.96927,.94729,.97454,.85498,.92916,.96924,.8761,1,1,.86091,1.16344,1.04839,1.04839,1.04839,1.04839,1.04839,1.04839,1.04839,1.04839,1.04839,.81965,.81965,.94729,.78032,.71022,.90883,.84171,.99877,.77596,1.05734,1.2,.94729,.85944,.82791,.9607,.74817,.93285,.98039,.96924,.95782,.89898,.98316,.98183,1.03989,.78614,.96924,.97642,.86237,.86075,.86091,.83089,.90082,.8858,.97296,1.01284,.95782,.83089,1.0976,1.04,1.03342,1.2,1.0675,1.0976,.98205,1.03809,1.05097,1.04,.95364,1.03342,1.05401,1.2,1.02148,1.0119,1.04724,1.0127,1.02732,.96225,.8965,.97783,.93574,.94818,1.30679,1.0675,1.11826,.99821,1.0557,1.0326,1.2,1.0675,.96225,1.0675,1.0326,.74817,1,1,1,1,1,1,1,1,1,1,1,1,1.03754,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.87533,1,1,1,1,1,1,1,1,1,1,1,1,.98705,1,1,1,1,1,1,.98448,.9973,.98448,.9973,.98448,.9973,.83089,.96777,1,1.20088,.89903,1,1,.75155,.94945,.94945,.94945,.94945,1.12317,1.12317,1.12317,.67603,.67603,1.15621,.73584,1.21191,1.22135,1.06483,.94868,.94868,.95996,1.24633,1,1.07497,.87709,.96927,1.01473,.96927,1,1,1,.77295,1,1,1.09836,1.09836,1.09836,1.01522,.86321,.94434,.8649,.94434,.86182,1,1,1.083,1,.91578,.86438,1.17308,1.18416,1.14589,.69825,.97622,1.96791,1.24822,1.24822,1.17308,1.24822,1.24822,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1.42603,1,.99862,.99862,1,.87025,.87025,.87025,.87025,1.17984,1.42603,1,1.42603,1.42603,.99862,1,1,1,1,1,1.2886,1.04315,1.15296,1.34163,1,1,1,1.10742,1.10742,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],Jj={lineHeight:1.33008,lineGap:0},Zj=[1.76738,1,1,.98594,1.02285,1.10454,1.06234,.96927,.92037,1.19985,1.2046,.90616,.90616,1.07152,1.1714,.78032,1.20088,.78032,1.40246,.96927,.96927,.96927,.96927,.96927,.96927,.96927,.96927,.96927,.96927,.78032,.78032,1.1714,1.1714,1.1714,.80597,.94084,.96706,.85944,.85734,.97093,.75842,.79936,.88198,.9831,.95782,.71387,.86969,.84636,1.07796,1.03584,.96924,.83968,.96924,.82826,.79649,.85771,.95132,.93119,.98965,.88433,.8287,.93365,1.08612,1.3638,1.08612,1.45786,.74627,.80499,.91484,1.05707,.92383,1.05882,.9403,1.12654,1.05882,1.01756,1.09011,1.09011,.99414,1.09011,1.034,1.01756,1.05356,1.05707,1.05882,1.04399,.84863,1.21968,1.01756,.95801,1.00068,.91797,.96777,.9043,.90351,.92105,.90351,1.1714,.85337,.96927,.96927,.99912,.96927,.92105,.80597,1.2434,1.20808,1.05937,.90957,1.1714,1.20808,.75155,.94261,1.24644,1.09971,1.09971,.84751,1,.85273,.78032,.61584,1.05425,1.17914,.90957,1.08665,1.11593,1.14169,.73381,.96706,.96706,.96706,.96706,.96706,.96706,.86035,.85734,.75842,.75842,.75842,.75842,.95782,.95782,.95782,.95782,.97093,1.03584,.96924,.96924,.96924,.96924,.96924,1.1714,.96924,.95132,.95132,.95132,.95132,.8287,.83968,.89049,.91484,.91484,.91484,.91484,.91484,.91484,.93575,.92383,.9403,.9403,.9403,.9403,.8717,.8717,.8717,.8717,1.00527,1.01756,1.05356,1.05356,1.05356,1.05356,1.05356,1.24644,.95923,1.01756,1.01756,1.01756,1.01756,.96777,1.05707,.96777,.96706,.91484,.96706,.91484,.96706,.91484,.85734,.92383,.85734,.92383,.85734,.92383,.85734,.92383,.97093,1.0969,.97093,1.05882,.75842,.9403,.75842,.9403,.75842,.9403,.75842,.9403,.75842,.9403,.88198,1.05882,.88198,1.05882,.88198,1.05882,1,1,.9831,1.01756,.9831,1.01756,.95782,.8717,.95782,.8717,.95782,.8717,.95782,1.09011,.95782,.8717,.84784,1.11551,.71387,1.09011,1,1,.99414,.84636,1.09011,1,1,.84636,1.0536,.84636,.94298,.84636,1.23297,1.03584,1.01756,1,1,1.03584,1.01756,1.00323,1.03444,1.01756,.96924,1.05356,.96924,1.05356,.96924,1.05356,.93066,.98293,.82826,1.04399,1,1,.82826,1.04399,.79649,.84863,.79649,.84863,.79649,.84863,.79649,.84863,1,1,.85771,1.17318,.85771,1.21968,.95132,1.01756,.95132,1.01756,.95132,1.01756,.95132,1.01756,.95132,1.01756,.95132,1.01756,.98965,1.00068,.8287,.96777,.8287,.93365,.9043,.93365,.9043,.93365,.9043,1.08571,.96927,.96706,.91484,.86035,.93575,.96924,.95923,1,1,.85771,1.21968,1.11437,1.11437,.93109,.91202,.60411,.84164,.55572,1.01173,.97361,.81818,.81818,.96635,.78032,.72727,.92366,.98601,1.03405,.77968,1.09799,1.2,.96706,.85944,.85638,.96491,.75842,.93365,.9831,.96924,.95782,.86969,.94152,1.07796,1.03584,.78437,.96924,.98715,.83968,.83491,.85771,.8287,.94492,.88433,.9287,1.0098,.95782,.8287,1.0625,.98248,1.03424,1.2,1.01071,1.0625,.95246,1.03809,1.04912,.98248,1.00221,1.03424,1.05443,1.2,1.04785,.99609,1.00169,1.05176,.99346,1.05356,.9087,1.03004,.95542,.93117,1.23362,1.01071,1.07831,1.02512,1.05205,1.03502,1.2,1.01071,1.05356,1.01071,1.03502,.75842,1,1,1,1,1,1,1,1,1,1,1,1,1.03719,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.9403,1,1,1,1,1,1,1,1,1,1,1,1,1.04021,1,1,1,1,1,1,.98965,1.00068,.98965,1.00068,.98965,1.00068,.8287,.96777,1,1.20088,.89903,1,1,.75155,1.03077,1.03077,1.03077,1.03077,1.13196,1.13196,1.13196,.67428,.67428,1.16039,.73291,1.20996,1.22135,1.06483,.94868,.94868,.95996,1.24633,1,1.07497,.87796,.96927,1.01518,.96927,1,1,1,.77295,1,1,1.10539,1.10539,1.11358,1.06967,.86279,.94434,.86279,.94434,.86182,1,1,1.083,1,.91578,.86507,1.1714,1.18416,1.14589,.69825,.97622,1.9697,1.24822,1.24822,1.17238,1.24822,1.24822,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1.42603,1,.99862,.99862,1,.87025,.87025,.87025,.87025,1.18083,1.42603,1,1.42603,1.42603,.99862,1,1,1,1,1,1.2886,1.04315,1.15296,1.34163,1,1,1,1.10938,1.10938,1,1,1,1.05425,1.09971,1.09971,1.09971,1,1,1,1,1,1,1,1,1,1,1],Qj={lineHeight:1.33008,lineGap:0},$j=Si(function(n){n["MyriadPro-Regular"]=n["PdfJS-Fallback-Regular"]={name:"LiberationSans-Regular",factors:Gj,baseWidths:Fm,baseMapping:Lm,metrics:Vj},n["MyriadPro-Bold"]=n["PdfJS-Fallback-Bold"]={name:"LiberationSans-Bold",factors:Lj,baseWidths:Rm,baseMapping:Mm,metrics:Bj},n["MyriadPro-It"]=n["MyriadPro-Italic"]=n["PdfJS-Fallback-Italic"]={name:"LiberationSans-Italic",factors:zj,baseWidths:Om,baseMapping:Dm,metrics:jj},n["MyriadPro-BoldIt"]=n["MyriadPro-BoldItalic"]=n["PdfJS-Fallback-BoldItalic"]={name:"LiberationSans-BoldItalic",factors:Uj,baseWidths:Pm,baseMapping:Nm,metrics:Hj},n.ArialMT=n.Arial=n["Arial-Regular"]={name:"LiberationSans-Regular",baseWidths:Fm,baseMapping:Lm},n["Arial-BoldMT"]=n["Arial-Bold"]={name:"LiberationSans-Bold",baseWidths:Rm,baseMapping:Mm},n["Arial-ItalicMT"]=n["Arial-Italic"]={name:"LiberationSans-Italic",baseWidths:Om,baseMapping:Dm},n["Arial-BoldItalicMT"]=n["Arial-BoldItalic"]={name:"LiberationSans-BoldItalic",baseWidths:Pm,baseMapping:Nm},n["Calibri-Regular"]={name:"LiberationSans-Regular",factors:Ij,baseWidths:Fm,baseMapping:Lm,metrics:Ej},n["Calibri-Bold"]={name:"LiberationSans-Bold",factors:_j,baseWidths:Rm,baseMapping:Mm,metrics:vj},n["Calibri-Italic"]={name:"LiberationSans-Italic",factors:Aj,baseWidths:Om,baseMapping:Dm,metrics:Sj},n["Calibri-BoldItalic"]={name:"LiberationSans-BoldItalic",factors:kj,baseWidths:Pm,baseMapping:Nm,metrics:Cj},n["Segoeui-Regular"]={name:"LiberationSans-Regular",factors:Zj,baseWidths:Fm,baseMapping:Lm,metrics:Qj},n["Segoeui-Bold"]={name:"LiberationSans-Bold",factors:qj,baseWidths:Rm,baseMapping:Mm,metrics:Wj},n["Segoeui-Italic"]={name:"LiberationSans-Italic",factors:Yj,baseWidths:Om,baseMapping:Dm,metrics:Jj},n["Segoeui-BoldItalic"]={name:"LiberationSans-BoldItalic",factors:Kj,baseWidths:Pm,baseMapping:Nm,metrics:Xj},n["Helvetica-Regular"]=n.Helvetica={name:"LiberationSans-Regular",factors:Dj,baseWidths:Fm,baseMapping:Lm,metrics:Fj},n["Helvetica-Bold"]={name:"LiberationSans-Bold",factors:Tj,baseWidths:Rm,baseMapping:Mm,metrics:Rj},n["Helvetica-Italic"]={name:"LiberationSans-Italic",factors:Nj,baseWidths:Om,baseMapping:Dm,metrics:Oj},n["Helvetica-BoldItalic"]={name:"LiberationSans-BoldItalic",factors:Mj,baseWidths:Pm,baseMapping:Nm,metrics:Pj}});function N4(n){const e=dx(n);return $j()[e]}function eG(n){const e=N4(n);if(!e)return null;const{baseWidths:t,baseMapping:i,factors:s}=e,r=s?t.map((c,h)=>c*s[h]):t;let a=-2,o;const l=[];for(const[c,h]of i.map((u,d)=>[u,d]).sort(([u],[d])=>u-d))c!==-1&&(c===a+1?(o.push(r[h]),a+=1):(a=c,o=[r[h]],l.push(c,o)));return l}function XR(n){const e=eG(n),t=new fe(null);t.set("BaseFont",ve.get(n)),t.set("Type",ve.get("Font")),t.set("Subtype",ve.get("CIDFontType2")),t.set("Encoding",ve.get("Identity-H")),t.set("CIDToGIDMap",ve.get("Identity")),t.set("W",e),t.set("FirstChar",e[0]),t.set("LastChar",e.at(-2)+e.at(-1).length-1);const i=new fe(null);t.set("FontDescriptor",i);const s=new fe(null);return s.set("Ordering","Identity"),s.set("Registry","Adobe"),s.set("Supplement",0),t.set("CIDSystemInfo",s),t}class tG{constructor(e){this.lexer=e,this.operators=[],this.token=null,this.prev=null}nextToken(){this.prev=this.token,this.token=this.lexer.getToken()}accept(e){return this.token.type===e?(this.nextToken(),!0):!1}expect(e){if(this.accept(e))return!0;throw new Te(`Unexpected symbol: found ${this.token.type} expected ${e}.`)}parse(){return this.nextToken(),this.expect(kr.LBRACE),this.parseBlock(),this.expect(kr.RBRACE),this.operators}parseBlock(){for(;;)if(this.accept(kr.NUMBER))this.operators.push(this.prev.value);else if(this.accept(kr.OPERATOR))this.operators.push(this.prev.value);else if(this.accept(kr.LBRACE))this.parseCondition();else return}parseCondition(){const e=this.operators.length;if(this.operators.push(null,null),this.parseBlock(),this.expect(kr.RBRACE),this.accept(kr.IF))this.operators[e]=this.operators.length,this.operators[e+1]="jz";else if(this.accept(kr.LBRACE)){const t=this.operators.length;this.operators.push(null,null);const i=this.operators.length;this.parseBlock(),this.expect(kr.RBRACE),this.expect(kr.IFELSE),this.operators[t]=this.operators.length,this.operators[t+1]="j",this.operators[e]=i,this.operators[e+1]="jz"}else throw new Te("PS Function: error parsing conditional.")}}const kr={LBRACE:0,RBRACE:1,NUMBER:2,OPERATOR:3,IF:4,IFELSE:5};class Ua{static get opCache(){return Ze(this,"opCache",Object.create(null))}constructor(e,t){this.type=e,this.value=t}static getOperator(e){var t;return(t=Ua.opCache)[e]||(t[e]=new Ua(kr.OPERATOR,e))}static get LBRACE(){return Ze(this,"LBRACE",new Ua(kr.LBRACE,"{"))}static get RBRACE(){return Ze(this,"RBRACE",new Ua(kr.RBRACE,"}"))}static get IF(){return Ze(this,"IF",new Ua(kr.IF,"IF"))}static get IFELSE(){return Ze(this,"IFELSE",new Ua(kr.IFELSE,"IFELSE"))}}class nG{constructor(e){this.stream=e,this.nextChar(),this.strBuf=[]}nextChar(){return this.currentChar=this.stream.getByte()}getToken(){let e=!1,t=this.currentChar;for(;;){if(t<0)return Bs;if(e)(t===10||t===13)&&(e=!1);else if(t===37)e=!0;else if(!qa(t))break;t=this.nextChar()}switch(t|0){case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 43:case 45:case 46:return new Ua(kr.NUMBER,this.getNumber());case 123:return this.nextChar(),Ua.LBRACE;case 125:return this.nextChar(),Ua.RBRACE}const i=this.strBuf;for(i.length=0,i[0]=String.fromCharCode(t);(t=this.nextChar())>=0&&(t>=65&&t<=90||t>=97&&t<=122);)i.push(String.fromCharCode(t));const s=i.join("");switch(s.toLowerCase()){case"if":return Ua.IF;case"ifelse":return Ua.IFELSE;default:return Ua.getOperator(s)}}getNumber(){let e=this.currentChar;const t=this.strBuf;for(t.length=0,t[0]=String.fromCharCode(e);(e=this.nextChar())>=0&&(e>=48&&e<=57||e===45||e===46);)t.push(String.fromCharCode(e));const i=parseFloat(t.join(""));if(isNaN(i))throw new Te(`Invalid floating point number: ${i}`);return i}}class lf{constructor(e){this._onlyRefs=(e==null?void 0:e.onlyRefs)===!0,this._onlyRefs||(this._nameRefMap=new Map,this._imageMap=new Map),this._imageCache=new ca}getByName(e){this._onlyRefs&&kn("Should not call `getByName` method.");const t=this._nameRefMap.get(e);return t?this.getByRef(t):this._imageMap.get(e)||null}getByRef(e){return this._imageCache.get(e)||null}set(e,t,i){kn("Abstract method `set` called.")}}class Fk extends lf{set(e,t=null,i){if(typeof e!="string")throw new Error('LocalImageCache.set - expected "name" argument.');if(t){if(this._imageCache.has(t))return;this._nameRefMap.set(e,t),this._imageCache.put(t,i);return}this._imageMap.has(e)||this._imageMap.set(e,i)}}class YR extends lf{set(e=null,t=null,i){if(typeof e!="string"&&!t)throw new Error('LocalColorSpaceCache.set - expected "name" and/or "ref" argument.');if(t){if(this._imageCache.has(t))return;e!==null&&this._nameRefMap.set(e,t),this._imageCache.put(t,i);return}this._imageMap.has(e)||this._imageMap.set(e,i)}}class iG extends lf{constructor(e){super({onlyRefs:!0})}set(e=null,t,i){if(!t)throw new Error('LocalFunctionCache.set - expected "ref" argument.');this._imageCache.has(t)||this._imageCache.put(t,i)}}class Lk extends lf{set(e,t=null,i){if(typeof e!="string")throw new Error('LocalGStateCache.set - expected "name" argument.');if(t){if(this._imageCache.has(t))return;this._nameRefMap.set(e,t),this._imageCache.put(t,i);return}this._imageMap.has(e)||this._imageMap.set(e,i)}}class sG extends lf{constructor(e){super({onlyRefs:!0})}set(e=null,t,i){if(!t)throw new Error('LocalTilingPatternCache.set - expected "ref" argument.');this._imageCache.has(t)||this._imageCache.put(t,i)}}class rG extends lf{constructor(e){super({onlyRefs:!0})}set(e=null,t,i){if(!t)throw new Error('RegionalImageCache.set - expected "ref" argument.');this._imageCache.has(t)||this._imageCache.put(t,i)}}class aG extends lf{constructor(e){super({onlyRefs:!0})}set(e=null,t,i){if(!t)throw new Error('GlobalColorSpaceCache.set - expected "ref" argument.');this._imageCache.has(t)||this._imageCache.put(t,i)}clear(){this._imageCache.clear()}}var _g,rf,JR,Q7;const wc=class wc{constructor(){B(this,rf);B(this,_g,new Zi);this._refCache=new ca,this._imageCache=new ca}shouldCache(e,t){let i=this._refCache.get(e);return i||(i=new Set,this._refCache.put(e,i)),i.add(t),!(i.size<wc.NUM_PAGES_THRESHOLD||!this._imageCache.has(e)&&b(this,rf,Q7))}addDecodeFailed(e){b(this,_g).put(e)}hasDecodeFailed(e){return b(this,_g).has(e)}addByteSize(e,t){const i=this._imageCache.get(e);i&&(i.byteSize||(i.byteSize=t))}getData(e,t){const i=this._refCache.get(e);if(!i||i.size<wc.NUM_PAGES_THRESHOLD)return null;const s=this._imageCache.get(e);return s?(i.add(t),s):null}setData(e,t){if(!this._refCache.has(e))throw new Error('GlobalImageCache.setData - expected "shouldCache" to have been called.');if(!this._imageCache.has(e)){if(b(this,rf,Q7)){ce("GlobalImageCache.setData - cache limit reached.");return}this._imageCache.put(e,t)}}clear(e=!1){e||(b(this,_g).clear(),this._refCache.clear()),this._imageCache.clear()}};_g=new WeakMap,rf=new WeakSet,JR=function(){let e=0;for(const t of this._imageCache)e+=t.byteSize;return e},Q7=function(){return!(this._imageCache.size<wc.MIN_IMAGES_TO_CACHE||b(this,rf,JR)<wc.MAX_BYTE_SIZE)},He(wc,"NUM_PAGES_THRESHOLD",2),He(wc,"MIN_IMAGES_TO_CACHE",10),He(wc,"MAX_BYTE_SIZE",5e7);let Z7=wc;class ZR{constructor({xref:e,isEvalSupported:t=!0}){this.xref=e,this.isEvalSupported=t!==!1}create(e,t=!1){var a;let i,s;if(e instanceof st?i=e:e instanceof fe?i=e.objId:e instanceof un&&(i=(a=e.dict)==null?void 0:a.objId),i){const o=this._localFunctionCache.getByRef(i);if(o)return o}const r=this.xref.fetchIfRef(e);if(Array.isArray(r)){if(!t)throw new Error('PDFFunctionFactory.create - expected "parseArray" argument.');s=Bk.parseArray(this,r)}else s=Bk.parse(this,r);return i&&this._localFunctionCache.set(null,i,s),s}get _localFunctionCache(){return Ze(this,"_localFunctionCache",new iG)}}function Za(n){return Array.isArray(n)?Vr(n,null)?n:n.map(e=>+e):null}class Bk{static getSampleArray(e,t,i,s){let r,a,o=1;for(r=0,a=e.length;r<a;r++)o*=e[r];o*=t;const l=new Array(o);let c=0,h=0;const u=1/(2**i-1),d=s.getBytes((o*i+7)/8);let f=0;for(r=0;r<o;r++){for(;c<i;)h<<=8,h|=d[f++],c+=8;c-=i,l[r]=(h>>c)*u,h&=(1<<c)-1}return l}static parse(e,t){const i=t.dict||t;switch(i.get("FunctionType")){case 0:return this.constructSampled(e,t,i);case 1:break;case 2:return this.constructInterpolated(e,i);case 3:return this.constructStiched(e,i);case 4:return this.constructPostScript(e,t,i)}throw new Te("Unknown type of function")}static parseArray(e,t){const{xref:i}=e,s=[];for(const r of t)s.push(this.parse(e,i.fetchIfRef(r)));return function(r,a,o,l){for(let c=0,h=s.length;c<h;c++)s[c](r,a,o,l+c)}}static constructSampled(e,t,i){function s(x){const p=x.length,y=[];let w=0;for(let _=0;_<p;_+=2)y[w++]=[x[_],x[_+1]];return y}function r(x,p,y,w,_){return w+(x-p)*((_-w)/(y-p))}let a=Za(i.getArray("Domain")),o=Za(i.getArray("Range"));if(!a||!o)throw new Te("No domain or range");const l=a.length/2,c=o.length/2;a=s(a),o=s(o);const h=Za(i.getArray("Size")),u=i.get("BitsPerSample"),d=i.get("Order")||1;d!==1&&gn("No support for cubic spline interpolation: "+d);let f=Za(i.getArray("Encode"));if(f)f=s(f);else{f=[];for(let x=0;x<l;++x)f.push([0,h[x]-1])}let g=Za(i.getArray("Decode"));g=g?s(g):o;const m=this.getSampleArray(h,c,u,t);return function(p,y,w,_){const v=1<<l,C=new Float64Array(v).fill(1),k=new Uint32Array(v);let I,S,M=c,N=1;for(I=0;I<l;++I){const F=a[I][0],H=a[I][1],T=zs(p[y+I],F,H);let z=r(T,F,H,f[I][0],f[I][1]);const R=h[I];z=zs(z,0,R-1);const L=z<R-1?Math.floor(z):z-1,Y=L+1-z,j=z-L,J=L*M,G=J+M;for(S=0;S<v;S++)S&N?(C[S]*=j,k[S]+=G):(C[S]*=Y,k[S]+=J);M*=R,N<<=1}for(S=0;S<c;++S){let F=0;for(I=0;I<v;I++)F+=m[k[I]+S]*C[I];F=r(F,0,1,g[S][0],g[S][1]),w[_+S]=zs(F,o[S][0],o[S][1])}}}static constructInterpolated(e,t){const i=Za(t.getArray("C0"))||[0],s=Za(t.getArray("C1"))||[1],r=t.get("N"),a=[];for(let l=0,c=i.length;l<c;++l)a.push(s[l]-i[l]);const o=a.length;return function(c,h,u,d){const f=r===1?c[h]:c[h]**r;for(let g=0;g<o;++g)u[d+g]=i[g]+f*a[g]}}static constructStiched(e,t){const i=Za(t.getArray("Domain"));if(!i)throw new Te("No domain");if(i.length/2!==1)throw new Te("Bad domain for stiched function");const{xref:r}=e,a=[];for(const h of t.get("Functions"))a.push(this.parse(e,r.fetchIfRef(h)));const o=Za(t.getArray("Bounds")),l=Za(t.getArray("Encode")),c=new Float32Array(1);return function(u,d,f,g){const m=zs(u[d],i[0],i[1]),x=o.length;let p;for(p=0;p<x&&!(m<o[p]);++p);let y=i[0];p>0&&(y=o[p-1]);let w=i[1];p<o.length&&(w=o[p]);const _=l[2*p],v=l[2*p+1];c[0]=y===w?_:_+(m-y)*(v-_)/(w-y),a[p](c,0,f,g)}}static constructPostScript(e,t,i){const s=Za(i.getArray("Domain")),r=Za(i.getArray("Range"));if(!s)throw new Te("No domain.");if(!r)throw new Te("No range.");const a=new nG(t),l=new tG(a).parse();if(e.isEvalSupported&&fa.isEvalSupported){const x=new gG().compile(l,s,r);if(x)return new Function("src","srcOffset","dest","destOffset",x)}gn("Unable to compile PS function");const c=r.length>>1,h=s.length>>1,u=new oG(l),d=Object.create(null);let g=2048*4;const m=new Float32Array(h);return function(p,y,w,_){let v,C,k="";const I=m;for(v=0;v<h;v++)C=p[y+v],I[v]=C,k+=C+"_";const S=d[k];if(S!==void 0){w.set(S,_);return}const M=new Float32Array(c),N=u.execute(I),F=N.length-c;for(v=0;v<c;v++){C=N[F+v];let H=r[v*2];C<H?C=H:(H=r[v*2+1],C>H&&(C=H)),M[v]=C}g>0&&(g--,d[k]=M),w.set(M,_)}}}function Iw(n){let e;if(n instanceof fe)e=n;else if(n instanceof un)e=n.dict;else return!1;return e.has("FunctionType")}const Ip=class Ip{constructor(e){this.stack=e?Array.from(e):[]}push(e){if(this.stack.length>=Ip.MAX_STACK_SIZE)throw new Error("PostScript function stack overflow.");this.stack.push(e)}pop(){if(this.stack.length<=0)throw new Error("PostScript function stack underflow.");return this.stack.pop()}copy(e){if(this.stack.length+e>=Ip.MAX_STACK_SIZE)throw new Error("PostScript function stack overflow.");const t=this.stack;for(let i=t.length-e,s=e-1;s>=0;s--,i++)t.push(t[i])}index(e){this.push(this.stack[this.stack.length-e-1])}roll(e,t){const i=this.stack,s=i.length-e,r=i.length-1,a=s+(t-Math.floor(t/e)*e);for(let o=s,l=r;o<l;o++,l--){const c=i[o];i[o]=i[l],i[l]=c}for(let o=s,l=a-1;o<l;o++,l--){const c=i[o];i[o]=i[l],i[l]=c}for(let o=a,l=r;o<l;o++,l--){const c=i[o];i[o]=i[l],i[l]=c}}};He(Ip,"MAX_STACK_SIZE",100);let $7=Ip;class oG{constructor(e){this.operators=e}execute(e){const t=new $7(e);let i=0;const s=this.operators,r=s.length;let a,o,l;for(;i<r;){if(a=s[i++],typeof a=="number"){t.push(a);continue}switch(a){case"jz":l=t.pop(),o=t.pop(),o||(i=l);break;case"j":o=t.pop(),i=o;break;case"abs":o=t.pop(),t.push(Math.abs(o));break;case"add":l=t.pop(),o=t.pop(),t.push(o+l);break;case"and":l=t.pop(),o=t.pop(),typeof o=="boolean"&&typeof l=="boolean"?t.push(o&&l):t.push(o&l);break;case"atan":l=t.pop(),o=t.pop(),o=Math.atan2(o,l)/Math.PI*180,o<0&&(o+=360),t.push(o);break;case"bitshift":l=t.pop(),o=t.pop(),o>0?t.push(o<<l):t.push(o>>l);break;case"ceiling":o=t.pop(),t.push(Math.ceil(o));break;case"copy":o=t.pop(),t.copy(o);break;case"cos":o=t.pop(),t.push(Math.cos(o%360/180*Math.PI));break;case"cvi":o=t.pop()|0,t.push(o);break;case"cvr":break;case"div":l=t.pop(),o=t.pop(),t.push(o/l);break;case"dup":t.copy(1);break;case"eq":l=t.pop(),o=t.pop(),t.push(o===l);break;case"exch":t.roll(2,1);break;case"exp":l=t.pop(),o=t.pop(),t.push(o**l);break;case"false":t.push(!1);break;case"floor":o=t.pop(),t.push(Math.floor(o));break;case"ge":l=t.pop(),o=t.pop(),t.push(o>=l);break;case"gt":l=t.pop(),o=t.pop(),t.push(o>l);break;case"idiv":l=t.pop(),o=t.pop(),t.push(o/l|0);break;case"index":o=t.pop(),t.index(o);break;case"le":l=t.pop(),o=t.pop(),t.push(o<=l);break;case"ln":o=t.pop(),t.push(Math.log(o));break;case"log":o=t.pop(),t.push(Math.log10(o));break;case"lt":l=t.pop(),o=t.pop(),t.push(o<l);break;case"mod":l=t.pop(),o=t.pop(),t.push(o%l);break;case"mul":l=t.pop(),o=t.pop(),t.push(o*l);break;case"ne":l=t.pop(),o=t.pop(),t.push(o!==l);break;case"neg":o=t.pop(),t.push(-o);break;case"not":o=t.pop(),typeof o=="boolean"?t.push(!o):t.push(~o);break;case"or":l=t.pop(),o=t.pop(),typeof o=="boolean"&&typeof l=="boolean"?t.push(o||l):t.push(o|l);break;case"pop":t.pop();break;case"roll":l=t.pop(),o=t.pop(),t.roll(o,l);break;case"round":o=t.pop(),t.push(Math.round(o));break;case"sin":o=t.pop(),t.push(Math.sin(o%360/180*Math.PI));break;case"sqrt":o=t.pop(),t.push(Math.sqrt(o));break;case"sub":l=t.pop(),o=t.pop(),t.push(o-l);break;case"true":t.push(!0);break;case"truncate":o=t.pop(),o=o<0?Math.ceil(o):Math.floor(o),t.push(o);break;case"xor":l=t.pop(),o=t.pop(),typeof o=="boolean"&&typeof l=="boolean"?t.push(o!==l):t.push(o^l);break;default:throw new Te(`Unknown operator ${a}`)}}return t.stack}}class Yg{constructor(e){this.type=e}visit(e){kn("abstract method")}}class lG extends Yg{constructor(e,t,i){super("args"),this.index=e,this.min=t,this.max=i}visit(e){e.visitArgument(this)}}class Bd extends Yg{constructor(e){super("literal"),this.number=e,this.min=e,this.max=e}visit(e){e.visitLiteral(this)}}class O4 extends Yg{constructor(e,t,i,s,r){super("binary"),this.op=e,this.arg1=t,this.arg2=i,this.min=s,this.max=r}visit(e){e.visitBinaryOperation(this)}}class cG extends Yg{constructor(e,t){super("max"),this.arg=e,this.min=e.min,this.max=t}visit(e){e.visitMin(this)}}class Uk extends Yg{constructor(e,t,i){super("var"),this.index=e,this.min=t,this.max=i}visit(e){e.visitVariable(this)}}class Hk extends Yg{constructor(e,t){super("definition"),this.variable=e,this.arg=t}visit(e){e.visitVariableDefinition(this)}}class zk{constructor(){this.parts=[]}visitArgument(e){this.parts.push("Math.max(",e.min,", Math.min(",e.max,", src[srcOffset + ",e.index,"]))")}visitVariable(e){this.parts.push("v",e.index)}visitLiteral(e){this.parts.push(e.number)}visitBinaryOperation(e){this.parts.push("("),e.arg1.visit(this),this.parts.push(" ",e.op," "),e.arg2.visit(this),this.parts.push(")")}visitVariableDefinition(e){this.parts.push("var "),e.variable.visit(this),this.parts.push(" = "),e.arg.visit(this),this.parts.push(";")}visitMin(e){this.parts.push("Math.min("),e.arg.visit(this),this.parts.push(", ",e.max,")")}toString(){return this.parts.join("")}}function hG(n,e){return e.type==="literal"&&e.number===0?n:n.type==="literal"&&n.number===0?e:e.type==="literal"&&n.type==="literal"?new Bd(n.number+e.number):new O4("+",n,e,n.min+e.min,n.max+e.max)}function uG(n,e){if(e.type==="literal"){if(e.number===0)return new Bd(0);if(e.number===1)return n;if(n.type==="literal")return new Bd(n.number*e.number)}if(n.type==="literal"){if(n.number===0)return new Bd(0);if(n.number===1)return e}const t=Math.min(n.min*e.min,n.min*e.max,n.max*e.min,n.max*e.max),i=Math.max(n.min*e.min,n.min*e.max,n.max*e.min,n.max*e.max);return new O4("*",n,e,t,i)}function dG(n,e){if(e.type==="literal"){if(e.number===0)return n;if(n.type==="literal")return new Bd(n.number-e.number)}return e.type==="binary"&&e.op==="-"&&n.type==="literal"&&n.number===1&&e.arg1.type==="literal"&&e.arg1.number===1?e.arg2:new O4("-",n,e,n.min-e.max,n.max-e.min)}function fG(n,e){return n.min>=e?new Bd(e):n.max<=e?n:new cG(n,e)}class gG{compile(e,t,i){const s=[],r=[],a=t.length>>1,o=i.length>>1;let l=0,c,h,u,d,f,g,m,x;for(let y=0;y<a;y++)s.push(new lG(y,t[y*2],t[y*2+1]));for(let y=0,w=e.length;y<w;y++){if(x=e[y],typeof x=="number"){s.push(new Bd(x));continue}switch(x){case"add":if(s.length<2)return null;d=s.pop(),u=s.pop(),s.push(hG(u,d));break;case"cvr":if(s.length<1)return null;break;case"mul":if(s.length<2)return null;d=s.pop(),u=s.pop(),s.push(uG(u,d));break;case"sub":if(s.length<2)return null;d=s.pop(),u=s.pop(),s.push(dG(u,d));break;case"exch":if(s.length<2)return null;f=s.pop(),g=s.pop(),s.push(f,g);break;case"pop":if(s.length<1)return null;s.pop();break;case"index":if(s.length<1||(u=s.pop(),u.type!=="literal")||(c=u.number,c<0||!Number.isInteger(c)||s.length<c))return null;if(f=s[s.length-c-1],f.type==="literal"||f.type==="var"){s.push(f);break}m=new Uk(l++,f.min,f.max),s[s.length-c-1]=m,s.push(m),r.push(new Hk(m,f));break;case"dup":if(s.length<1)return null;if(typeof e[y+1]=="number"&&e[y+2]==="gt"&&e[y+3]===y+7&&e[y+4]==="jz"&&e[y+5]==="pop"&&e[y+6]===e[y+1]){u=s.pop(),s.push(fG(u,e[y+1])),y+=6;break}if(f=s.at(-1),f.type==="literal"||f.type==="var"){s.push(f);break}m=new Uk(l++,f.min,f.max),s[s.length-1]=m,s.push(m),r.push(new Hk(m,f));break;case"roll":if(s.length<2||(d=s.pop(),u=s.pop(),d.type!=="literal"||u.type!=="literal")||(h=d.number,c=u.number,c<=0||!Number.isInteger(c)||!Number.isInteger(h)||s.length<c))return null;if(h=(h%c+c)%c,h===0)break;s.push(...s.splice(s.length-c,c-h));break;default:return null}}if(s.length!==o)return null;const p=[];for(const y of r){const w=new zk;y.visit(w),p.push(w.toString())}for(let y=0,w=s.length;y<w;y++){const _=s[y],v=new zk;_.visit(v);const C=i[y*2],k=i[y*2+1],I=[v.toString()];C>_.min&&(I.unshift("Math.max(",C,", "),I.push(")")),k<_.max&&(I.unshift("Math.min(",k,", "),I.push(")")),I.unshift("dest[destOffset + ",y,"] = "),I.push(";"),p.push(I.join(""))}return p.join(`
`)}}const mG=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","ON","ON","ET","ET","ET","ON","ON","ON","ON","ON","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","ON","ON","ON","ON","ON","ON","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","ON","ON","ON","ON","ON","ON","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","ON","ON","ON","ON","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","ON","ET","ET","ET","ET","ON","ON","ON","ON","L","ON","ON","BN","ON","ON","ET","ET","EN","EN","ON","L","ON","ON","ON","EN","L","ON","ON","ON","ON","ON","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","ON","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","ON","L","L","L","L","L","L","L","L"],pG=["AN","AN","AN","AN","AN","AN","ON","ON","AL","ET","ET","AL","CS","AL","ON","ON","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","ON","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","ON","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL"];function jk(n){return(n&1)!==0}function bG(n){return(n&1)===0}function xG(n,e,t){let i,s;for(i=e,s=n.length;i<s;++i)if(n[i]!==t)return i;return i}function Gk(n,e,t){for(let i=e,s=t-1;i<s;++i,--s){const r=n[i];n[i]=n[s],n[s]=r}}function Ew(n,e,t=!1){let i="ltr";return t?i="ttb":e||(i="rtl"),{str:n,dir:i}}const S0=[],Fn=[];function QR(n,e=-1,t=!1){let i=!0;const s=n.length;if(s===0||t)return Ew(n,i,t);S0.length=s,Fn.length=s;let r=0,a,o;for(a=0;a<s;++a){S0[a]=n.charAt(a);const p=n.charCodeAt(a);let y="L";p<=255?y=mG[p]:1424<=p&&p<=1524?y="R":1536<=p&&p<=1791?(y=pG[p&255],y||ce("Bidi: invalid Unicode character "+p.toString(16))):(1792<=p&&p<=2220||64336<=p&&p<=65023||65136<=p&&p<=65279)&&(y="AL"),(y==="R"||y==="AL"||y==="AN")&&r++,Fn[a]=y}if(r===0)return i=!0,Ew(n,i);e===-1&&(r/s<.3&&s>4?(i=!0,e=0):(i=!1,e=1));const l=[];for(a=0;a<s;++a)l[a]=e;const c=jk(e)?"R":"L",h=c,u=h;let d=h;for(a=0;a<s;++a)Fn[a]==="NSM"?Fn[a]=d:d=Fn[a];d=h;let f;for(a=0;a<s;++a)f=Fn[a],f==="EN"?Fn[a]=d==="AL"?"AN":"EN":(f==="R"||f==="L"||f==="AL")&&(d=f);for(a=0;a<s;++a)f=Fn[a],f==="AL"&&(Fn[a]="R");for(a=1;a<s-1;++a)Fn[a]==="ES"&&Fn[a-1]==="EN"&&Fn[a+1]==="EN"&&(Fn[a]="EN"),Fn[a]==="CS"&&(Fn[a-1]==="EN"||Fn[a-1]==="AN")&&Fn[a+1]===Fn[a-1]&&(Fn[a]=Fn[a-1]);for(a=0;a<s;++a)if(Fn[a]==="EN"){for(let p=a-1;p>=0&&Fn[p]==="ET";--p)Fn[p]="EN";for(let p=a+1;p<s&&Fn[p]==="ET";++p)Fn[p]="EN"}for(a=0;a<s;++a)f=Fn[a],(f==="WS"||f==="ES"||f==="ET"||f==="CS")&&(Fn[a]="ON");for(d=h,a=0;a<s;++a)f=Fn[a],f==="EN"?Fn[a]=d==="L"?"L":"EN":(f==="R"||f==="L")&&(d=f);for(a=0;a<s;++a)if(Fn[a]==="ON"){const p=xG(Fn,a+1,"ON");let y=h;a>0&&(y=Fn[a-1]);let w=u;p+1<s&&(w=Fn[p+1]),y!=="L"&&(y="R"),w!=="L"&&(w="R"),y===w&&Fn.fill(y,a,p),a=p-1}for(a=0;a<s;++a)Fn[a]==="ON"&&(Fn[a]=c);for(a=0;a<s;++a)f=Fn[a],bG(l[a])?f==="R"?l[a]+=1:(f==="AN"||f==="EN")&&(l[a]+=2):(f==="L"||f==="AN"||f==="EN")&&(l[a]+=1);let g=-1,m=99,x;for(a=0,o=l.length;a<o;++a)x=l[a],g<x&&(g=x),m>x&&jk(x)&&(m=x);for(x=g;x>=m;--x){let p=-1;for(a=0,o=l.length;a<o;++a)l[a]<x?p>=0&&(Gk(S0,p,a),p=-1):p<0&&(p=a);p>=0&&Gk(S0,p,l.length)}for(a=0,o=S0.length;a<o;++a){const p=S0[a];(p==="<"||p===">")&&(S0[a]="")}return Ew(S0.join(""),i)}const lu={style:"normal",weight:"normal"},du={style:"normal",weight:"bold"},fu={style:"italic",weight:"normal"},gu={style:"italic",weight:"bold"},mp=new Map([["Times-Roman",{local:["Times New Roman","Times-Roman","Times","Liberation Serif","Nimbus Roman","Nimbus Roman L","Tinos","Thorndale","TeX Gyre Termes","FreeSerif","Linux Libertine O","Libertinus Serif","DejaVu Serif","Bitstream Vera Serif","Ubuntu"],style:lu,ultimate:"serif"}],["Times-Bold",{alias:"Times-Roman",style:du,ultimate:"serif"}],["Times-Italic",{alias:"Times-Roman",style:fu,ultimate:"serif"}],["Times-BoldItalic",{alias:"Times-Roman",style:gu,ultimate:"serif"}],["Helvetica",{local:["Helvetica","Helvetica Neue","Arial","Arial Nova","Liberation Sans","Arimo","Nimbus Sans","Nimbus Sans L","A030","TeX Gyre Heros","FreeSans","DejaVu Sans","Albany","Bitstream Vera Sans","Arial Unicode MS","Microsoft Sans Serif","Apple Symbols","Cantarell"],path:"LiberationSans-Regular.ttf",style:lu,ultimate:"sans-serif"}],["Helvetica-Bold",{alias:"Helvetica",path:"LiberationSans-Bold.ttf",style:du,ultimate:"sans-serif"}],["Helvetica-Oblique",{alias:"Helvetica",path:"LiberationSans-Italic.ttf",style:fu,ultimate:"sans-serif"}],["Helvetica-BoldOblique",{alias:"Helvetica",path:"LiberationSans-BoldItalic.ttf",style:gu,ultimate:"sans-serif"}],["Courier",{local:["Courier","Courier New","Liberation Mono","Nimbus Mono","Nimbus Mono L","Cousine","Cumberland","TeX Gyre Cursor","FreeMono","Linux Libertine Mono O","Libertinus Mono"],style:lu,ultimate:"monospace"}],["Courier-Bold",{alias:"Courier",style:du,ultimate:"monospace"}],["Courier-Oblique",{alias:"Courier",style:fu,ultimate:"monospace"}],["Courier-BoldOblique",{alias:"Courier",style:gu,ultimate:"monospace"}],["ArialBlack",{local:["Arial Black"],style:{style:"normal",weight:"900"},fallback:"Helvetica-Bold"}],["ArialBlack-Bold",{alias:"ArialBlack"}],["ArialBlack-Italic",{alias:"ArialBlack",style:{style:"italic",weight:"900"},fallback:"Helvetica-BoldOblique"}],["ArialBlack-BoldItalic",{alias:"ArialBlack-Italic"}],["ArialNarrow",{local:["Arial Narrow","Liberation Sans Narrow","Helvetica Condensed","Nimbus Sans Narrow","TeX Gyre Heros Cn"],style:lu,fallback:"Helvetica"}],["ArialNarrow-Bold",{alias:"ArialNarrow",style:du,fallback:"Helvetica-Bold"}],["ArialNarrow-Italic",{alias:"ArialNarrow",style:fu,fallback:"Helvetica-Oblique"}],["ArialNarrow-BoldItalic",{alias:"ArialNarrow",style:gu,fallback:"Helvetica-BoldOblique"}],["Calibri",{local:["Calibri","Carlito"],style:lu,fallback:"Helvetica"}],["Calibri-Bold",{alias:"Calibri",style:du,fallback:"Helvetica-Bold"}],["Calibri-Italic",{alias:"Calibri",style:fu,fallback:"Helvetica-Oblique"}],["Calibri-BoldItalic",{alias:"Calibri",style:gu,fallback:"Helvetica-BoldOblique"}],["Wingdings",{local:["Wingdings","URW Dingbats"],style:lu}],["Wingdings-Regular",{alias:"Wingdings"}],["Wingdings-Bold",{alias:"Wingdings"}]]),yG=new Map([["Arial-Black","ArialBlack"]]);function wG(n){switch(n){case du:return"Bold";case fu:return"Italic";case gu:return"Bold Italic";default:if((n==null?void 0:n.weight)==="bold")return"Bold";if((n==null?void 0:n.style)==="italic")return"Italic"}return""}function Vk(n){const e=new Set(["thin","extralight","ultralight","demilight","semilight","light","book","regular","normal","medium","demibold","semibold","bold","extrabold","ultrabold","black","heavy","extrablack","ultrablack","roman","italic","oblique","ultracondensed","extracondensed","condensed","semicondensed","normal","semiexpanded","expanded","extraexpanded","ultraexpanded","bolditalic"]);return n.split(/[- ,+]+/g).filter(t=>!e.has(t.toLowerCase())).join(" ")}function e6({alias:n,local:e,path:t,fallback:i,style:s,ultimate:r},a,o,l=!0,c=!0,h=""){const u={style:null,ultimate:null};if(e){const d=h?` ${h}`:"";for(const f of e)a.push(`local(${f}${d})`)}if(n){const d=mp.get(n),f=h||wG(s);Object.assign(u,e6(d,a,o,l&&!i,c&&!t,f))}if(s&&(u.style=s),r&&(u.ultimate=r),l&&i){const d=mp.get(i),{ultimate:f}=e6(d,a,o,l,c&&!t,h);u.ultimate||(u.ultimate=f)}return c&&t&&o&&a.push(`url(${o}${t})`),u}function qk(n,e,t,i,s,r){if(i.startsWith("InvalidPDFjsFont_"))return null;(r==="TrueType"||r==="Type1")&&/^[A-Z]{6}\+/.test(i)&&(i=i.slice(7)),i=dx(i);const a=i;let o=n.get(a);if(o)return o;let l=mp.get(i);if(!l){for(const[x,p]of yG)if(i.startsWith(x)){i=`${p}${i.substring(x.length)}`,l=mp.get(i);break}}let c=!1;l||(l=mp.get(s),c=!0);const h=`${e.getDocId()}_s${e.createFontId()}`;if(!l){if(!R7(i))return ce(`Cannot substitute the font because of its name: ${i}`),n.set(a,null),null;const x=/bold/gi.test(i),p=/oblique|italic/gi.test(i),y=x&&p&&gu||x&&du||p&&fu||lu;return o={css:`"${Vk(i)}",${h}`,guessFallback:!0,loadedName:h,baseFontName:i,src:`local(${i})`,style:y},n.set(a,o),o}const u=[];c&&R7(i)&&u.push(`local(${i})`);const{style:d,ultimate:f}=e6(l,u,t),g=f===null,m=g?"":`,${f}`;return o={css:`"${Vk(i)}",${h}${m}`,guessFallback:g,loadedName:h,baseFontName:i,src:u.join(","),style:d},n.set(a,o),o}const Wk=3285377520,Qa=4294901760,bl=65535;class _G{constructor(e){this.h1=e?e&4294967295:Wk,this.h2=e?e&4294967295:Wk}update(e){let t,i;if(typeof e=="string"){t=new Uint8Array(e.length*2),i=0;for(let m=0,x=e.length;m<x;m++){const p=e.charCodeAt(m);p<=255?t[i++]=p:(t[i++]=p>>>8,t[i++]=p&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),i=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const s=i>>2,r=i-s*4,a=new Uint32Array(t.buffer,0,s);let o=0,l=0,c=this.h1,h=this.h2;const u=3432918353,d=461845907,f=u&bl,g=d&bl;for(let m=0;m<s;m++)m&1?(o=a[m],o=o*u&Qa|o*f&bl,o=o<<15|o>>>17,o=o*d&Qa|o*g&bl,c^=o,c=c<<13|c>>>19,c=c*5+3864292196):(l=a[m],l=l*u&Qa|l*f&bl,l=l<<15|l>>>17,l=l*d&Qa|l*g&bl,h^=l,h=h<<13|h>>>19,h=h*5+3864292196);switch(o=0,r){case 3:o^=t[s*4+2]<<16;case 2:o^=t[s*4+1]<<8;case 1:o^=t[s*4],o=o*u&Qa|o*f&bl,o=o<<15|o>>>17,o=o*d&Qa|o*g&bl,s&1?c^=o:h^=o}this.h1=c,this.h2=h}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&Qa|e*36045&bl,t=t*4283543511&Qa|((t<<16|e>>>16)*2950163797&Qa)>>>16,e^=t>>>1,e=e*444984403&Qa|e*60499&bl,t=t*3301882366&Qa|((t<<16|e>>>16)*3120437893&Qa)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}function Kk(n,e,t,i,s,r){const a=s*r;let o;e<=8?o=new Uint8Array(a):e<=16?o=new Uint16Array(a):o=new Uint32Array(a);const l=t/s,c=i/r;let h,u,d,f=0,g;const m=new Uint16Array(s),x=t;for(h=0;h<s;h++)m[h]=Math.floor(h*l);for(h=0;h<r;h++)for(d=Math.floor(h*c)*x,u=0;u<s;u++)g=d+m[u],o[f++]=n[g];return o}var Xb,t6;const Vf=class Vf{constructor({xref:e,res:t,image:i,isInline:s=!1,smask:r=null,mask:a=null,isMask:o=!1,pdfFunctionFactory:l,globalColorSpaceCache:c,localColorSpaceCache:h}){B(this,Xb);var p,y;this.image=i;const u=i.dict,d=u.get("F","Filter");let f;if(d instanceof ve)f=d.name;else if(Array.isArray(d)){const w=e.fetchIfRef(d[0]);w instanceof ve&&(f=w.name)}switch(f){case"JPXDecode":({width:i.width,height:i.height,componentsCount:i.numComps,bitsPerComponent:i.bitsPerComponent}=Go.parseImageProperties(i.stream)),i.stream.reset();const w=Ro.getReducePowerForJPX(i.width,i.height,i.numComps);if(this.jpxDecoderOptions={numComponents:0,isIndexedColormap:!1,smaskInData:u.has("SMaskInData"),reducePower:w},w){const _=2**w;i.width=Math.ceil(i.width/_),i.height=Math.ceil(i.height/_)}break;case"JBIG2Decode":i.bitsPerComponent=1,i.numComps=1;break}let g=u.get("W","Width"),m=u.get("H","Height");if(Number.isInteger(i.width)&&i.width>0&&Number.isInteger(i.height)&&i.height>0&&(i.width!==g||i.height!==m))ce("PDFImage - using the Width/Height of the image data, rather than the image dictionary."),g=i.width,m=i.height;else{const w=typeof g=="number"&&g>0,_=typeof m=="number"&&m>0;if(!w||!_){if(!i.fallbackDims)throw new Te(`Invalid image width: ${g} or height: ${m}`);ce("PDFImage - using the Width/Height of the parent image, for SMask/Mask data."),w||(g=i.fallbackDims.width),_||(m=i.fallbackDims.height)}}this.width=g,this.height=m,this.interpolate=u.get("I","Interpolate"),this.imageMask=u.get("IM","ImageMask")||!1,this.matte=u.get("Matte")||!1;let x=i.bitsPerComponent;if(!x&&(x=u.get("BPC","BitsPerComponent"),!x))if(this.imageMask)x=1;else throw new Te(`Bits per component missing in image: ${this.imageMask}`);if(this.bpc=x,!this.imageMask){let w=u.getRaw("CS")||u.getRaw("ColorSpace");const _=!!w;if(_)(p=this.jpxDecoderOptions)!=null&&p.smaskInData&&(w=ve.get("DeviceRGBA"));else if(this.jpxDecoderOptions)w=ve.get("DeviceRGBA");else switch(i.numComps){case 1:w=ve.get("DeviceGray");break;case 3:w=ve.get("DeviceRGB");break;case 4:w=ve.get("DeviceCMYK");break;default:throw new Error(`Images with ${i.numComps} color components not supported.`)}this.colorSpace=Nn.parse({cs:w,xref:e,resources:s?t:null,pdfFunctionFactory:l,globalColorSpaceCache:c,localColorSpaceCache:h}),this.numComps=this.colorSpace.numComps,this.jpxDecoderOptions&&(this.jpxDecoderOptions.numComponents=_?this.numComps:0,this.jpxDecoderOptions.isIndexedColormap=this.colorSpace.name==="Indexed")}if(this.decode=u.getArray("D","Decode"),this.needsDecode=!1,this.decode&&(this.colorSpace&&!this.colorSpace.isDefaultDecode(this.decode,x)||o&&!fr.isDefaultDecode(this.decode,1))){this.needsDecode=!0;const w=(1<<x)-1;this.decodeCoefficients=[],this.decodeAddends=[];const _=((y=this.colorSpace)==null?void 0:y.name)==="Indexed";for(let v=0,C=0;v<this.decode.length;v+=2,++C){const k=this.decode[v],I=this.decode[v+1];this.decodeCoefficients[C]=_?(I-k)/w:I-k,this.decodeAddends[C]=_?k:w*k}}r?(r.fallbackDims??(r.fallbackDims={width:g,height:m}),this.smask=new Vf({xref:e,res:t,image:r,isInline:s,pdfFunctionFactory:l,globalColorSpaceCache:c,localColorSpaceCache:h})):a&&(a instanceof un?a.dict.get("IM","ImageMask")?(a.fallbackDims??(a.fallbackDims={width:g,height:m}),this.mask=new Vf({xref:e,res:t,image:a,isInline:s,isMask:!0,pdfFunctionFactory:l,globalColorSpaceCache:c,localColorSpaceCache:h})):ce("Ignoring /Mask in image without /ImageMask."):this.mask=a)}static async buildImage({xref:e,res:t,image:i,isInline:s=!1,pdfFunctionFactory:r,globalColorSpaceCache:a,localColorSpaceCache:o}){const l=i;let c=null,h=null;const u=i.dict.get("SMask"),d=i.dict.get("Mask");return u?u instanceof un?c=u:ce("Unsupported /SMask format."):d&&(d instanceof un||Array.isArray(d)?h=d:ce("Unsupported /Mask format.")),new Vf({xref:e,res:t,image:l,isInline:s,smask:c,mask:h,pdfFunctionFactory:r,globalColorSpaceCache:a,localColorSpaceCache:o})}static async createMask({image:e,isOffscreenCanvasSupported:t=!1}){const{dict:i}=e,s=i.get("W","Width"),r=i.get("H","Height"),a=i.get("I","Interpolate"),o=i.getArray("D","Decode"),l=(o==null?void 0:o[0])>0,c=(s+7>>3)*r,h=e.getBytes(c),u=s===1&&r===1&&l===(h.length===0||!!(h[0]&128));if(u)return{isSingleOpaquePixel:u};if(t){if(Ro.needsToBeResized(s,r)){const w=new Uint8ClampedArray(s*r*4);return L7({src:h,dest:w,width:s,height:r,nonBlackColor:0,inverseDecode:l}),Ro.createImage({kind:Fs.RGBA_32BPP,data:w,width:s,height:r,interpolate:a})}const m=new OffscreenCanvas(s,r),x=m.getContext("2d"),p=x.createImageData(s,r);L7({src:h,dest:p.data,width:s,height:r,nonBlackColor:0,inverseDecode:l}),x.putImageData(p,0,0);const y=m.transferToImageBitmap();return{data:null,width:s,height:r,interpolate:a,bitmap:y}}const d=h.byteLength,f=c===d;let g;if(e instanceof Zr&&(!l||f)?g=h:l?(g=new Uint8Array(c),g.set(h),g.fill(255,d)):g=new Uint8Array(h),l)for(let m=0;m<d;m++)g[m]^=255;return{data:g,width:s,height:r,interpolate:a}}get drawWidth(){var e,t;return Math.max(this.width,((e=this.smask)==null?void 0:e.width)||0,((t=this.mask)==null?void 0:t.width)||0)}get drawHeight(){var e,t;return Math.max(this.height,((e=this.smask)==null?void 0:e.height)||0,((t=this.mask)==null?void 0:t.height)||0)}decodeBuffer(e){const t=this.bpc,i=this.numComps,s=this.decodeAddends,r=this.decodeCoefficients,a=(1<<t)-1;let o,l;if(t===1){for(o=0,l=e.length;o<l;o++)e[o]=+!e[o];return}let c=0;for(o=0,l=this.width*this.height;o<l;o++)for(let h=0;h<i;h++)e[c]=zs(s[h]+e[c]*r[h],0,a),c++}getComponents(e){const t=this.bpc;if(t===8)return e;const i=this.width,s=this.height,r=this.numComps,a=i*s*r;let o=0,l;t<=8?l=new Uint8Array(a):t<=16?l=new Uint16Array(a):l=new Uint32Array(a);const c=i*r,h=(1<<t)-1;let u=0,d,f;if(t===1){let g,m,x;for(let p=0;p<s;p++){for(m=u+(c&-8),x=u+c;u<m;)f=e[o++],l[u]=f>>7&1,l[u+1]=f>>6&1,l[u+2]=f>>5&1,l[u+3]=f>>4&1,l[u+4]=f>>3&1,l[u+5]=f>>2&1,l[u+6]=f>>1&1,l[u+7]=f&1,u+=8;if(u<x)for(f=e[o++],g=128;u<x;)l[u++]=+!!(f&g),g>>=1}}else{let g=0;for(f=0,u=0,d=a;u<d;++u){for(u%c===0&&(f=0,g=0);g<t;)f=f<<8|e[o++],g+=8;const m=g-t;let x=f>>m;x<0?x=0:x>h&&(x=h),l[u]=x,f&=(1<<m)-1,g=m}}return l}async fillOpacity(e,t,i,s,r){const a=this.smask,o=this.mask;let l,c,h,u,d,f;if(a)c=a.width,h=a.height,l=new Uint8ClampedArray(c*h),await a.fillGrayBuffer(l),(c!==t||h!==i)&&(l=Kk(l,a.bpc,c,h,t,i));else if(o)if(o instanceof Vf){for(c=o.width,h=o.height,l=new Uint8ClampedArray(c*h),o.numComps=1,await o.fillGrayBuffer(l),u=0,d=c*h;u<d;++u)l[u]=255-l[u];(c!==t||h!==i)&&(l=Kk(l,o.bpc,c,h,t,i))}else if(Array.isArray(o)){l=new Uint8ClampedArray(t*i);const g=this.numComps;for(u=0,d=t*i;u<d;++u){let m=0;const x=u*g;for(f=0;f<g;++f){const p=r[x+f],y=f*2;if(p<o[y]||p>o[y+1]){m=255;break}}l[u]=m}}else throw new Te("Unknown mask format.");if(l)for(u=0,f=3,d=t*s;u<d;++u,f+=4)e[f]=l[u];else for(u=0,f=3,d=t*s;u<d;++u,f+=4)e[f]=255}undoPreblend(e,t,i){var h;const s=(h=this.smask)==null?void 0:h.matte;if(!s)return;const r=this.colorSpace.getRgb(s,0),a=r[0],o=r[1],l=r[2],c=t*i*4;for(let u=0;u<c;u+=4){const d=e[u+3];if(d===0){e[u]=255,e[u+1]=255,e[u+2]=255;continue}const f=255/d;e[u]=(e[u]-a)*f+a,e[u+1]=(e[u+1]-o)*f+o,e[u+2]=(e[u+2]-l)*f+l}}async createImageData(e=!1,t=!1){const i=this.drawWidth,s=this.drawHeight,r={width:i,height:s,interpolate:this.interpolate,kind:0,data:null},a=this.numComps,o=this.width,l=this.height,c=this.bpc,h=o*a*c+7>>3,u=t&&Ro.needsToBeResized(i,s);if(!this.smask&&!this.mask&&this.colorSpace.name==="DeviceRGBA"){r.kind=Fs.RGBA_32BPP;const v=r.data=await this.getImageBytes(l*o*4,{});return t?u?Ro.createImage(r,!1):this.createBitmap(Fs.RGBA_32BPP,i,s,v):r}if(!e){let v;if(this.colorSpace.name==="DeviceGray"&&c===1?v=Fs.GRAYSCALE_1BPP:this.colorSpace.name==="DeviceRGB"&&c===8&&!this.needsDecode&&(v=Fs.RGB_24BPP),v&&!this.smask&&!this.mask&&i===o&&s===l){const C=await D(this,Xb,t6).call(this,o,l);if(C)return C;const k=await this.getImageBytes(l*h,{});if(t)return u?Ro.createImage({data:k,kind:v,width:i,height:s,interpolate:this.interpolate},this.needsDecode):this.createBitmap(v,o,l,k);if(r.kind=v,r.data=k,this.needsDecode){Hs(v===Fs.GRAYSCALE_1BPP,"PDFImage.createImageData: The image must be grayscale.");const I=r.data;for(let S=0,M=I.length;S<M;S++)I[S]^=255}return r}if(this.image instanceof Eg&&!this.smask&&!this.mask&&!this.needsDecode){let C=l*h;if(t&&!u){let k=!1;switch(this.colorSpace.name){case"DeviceGray":C*=4,k=!0;break;case"DeviceRGB":C=C/3*4,k=!0;break;case"DeviceCMYK":k=!0;break}if(k){const I=await D(this,Xb,t6).call(this,i,s);if(I)return I;const S=await this.getImageBytes(C,{drawWidth:i,drawHeight:s,forceRGBA:!0});return this.createBitmap(Fs.RGBA_32BPP,i,s,S)}}else switch(this.colorSpace.name){case"DeviceGray":C*=3;case"DeviceRGB":case"DeviceCMYK":return r.kind=Fs.RGB_24BPP,r.data=await this.getImageBytes(C,{drawWidth:i,drawHeight:s,forceRGB:!0}),u?Ro.createImage(r):r}}}const d=await this.getImageBytes(l*h,{internal:!0}),f=0|d.length/h*s/l,g=this.getComponents(d);let m,x,p,y,w,_;if(t&&!u&&(p=new OffscreenCanvas(i,s),y=p.getContext("2d"),w=y.createImageData(i,s),_=w.data),r.kind=Fs.RGBA_32BPP,!e&&!this.smask&&!this.mask?(!t||u?(r.kind=Fs.RGB_24BPP,_=new Uint8ClampedArray(i*s*3),m=0):(new Uint32Array(_.buffer).fill(fa.isLittleEndian?4278190080:255),m=1),x=!1):((!t||u)&&(_=new Uint8ClampedArray(i*s*4)),m=1,x=!0,await this.fillOpacity(_,i,s,f,g)),this.needsDecode&&this.decodeBuffer(g),this.colorSpace.fillRgb(_,o,l,i,s,f,c,g,m),x&&this.undoPreblend(_,i,f),t&&!u){y.putImageData(w,0,0);const v=p.transferToImageBitmap();return{data:null,width:i,height:s,bitmap:v,interpolate:this.interpolate}}return r.data=_,u?Ro.createImage(r):r}async fillGrayBuffer(e){const t=this.numComps;if(t!==1)throw new Te(`Reading gray scale from a color image: ${t}`);const i=this.width,s=this.height,r=this.bpc,a=i*t*r+7>>3,o=await this.getImageBytes(s*a,{internal:!0}),l=this.getComponents(o);let c,h;if(r===1){if(h=i*s,this.needsDecode)for(c=0;c<h;++c)e[c]=l[c]-1&255;else for(c=0;c<h;++c)e[c]=-l[c]&255;return}this.needsDecode&&this.decodeBuffer(l),h=i*s;const u=255/((1<<r)-1);for(c=0;c<h;++c)e[c]=u*l[c]}createBitmap(e,t,i,s){const r=new OffscreenCanvas(t,i),a=r.getContext("2d");let o;e===Fs.RGBA_32BPP?o=new ImageData(s,t,i):(o=a.createImageData(t,i),vR({kind:e,src:s,dest:new Uint32Array(o.data.buffer),width:t,height:i,inverseDecode:this.needsDecode})),a.putImageData(o,0,0);const l=r.transferToImageBitmap();return{data:null,width:t,height:i,bitmap:l,interpolate:this.interpolate}}async getImageBytes(e,{drawWidth:t,drawHeight:i,forceRGBA:s=!1,forceRGB:r=!1,internal:a=!1}){this.image.reset(),this.image.drawWidth=t||this.width,this.image.drawHeight=i||this.height,this.image.forceRGBA=!!s,this.image.forceRGB=!!r;const o=await this.image.getImageData(e,this.jpxDecoderOptions);return a||this.image instanceof Zr?o:(Hs(o instanceof Uint8Array,'PDFImage.getImageBytes: Unsupported "imageBytes" type.'),new Uint8Array(o))}};Xb=new WeakSet,t6=async function(e,t){const i=await this.image.getTransferableImage();return i?{data:null,width:e,height:t,bitmap:i,interpolate:this.interpolate}:null};let pp=Vf;const vG=Object.freeze({maxImageSize:-1,disableFontFace:!1,ignoreErrors:!1,isEvalSupported:!0,isOffscreenCanvasSupported:!1,isImageDecoderSupported:!1,canvasMaxAreaInBytes:-1,fontExtraProperties:!1,useSystemFonts:!0,useWasm:!0,useWorkerFetch:!0,cMapUrl:null,iccUrl:null,standardFontDataUrl:null,wasmUrl:null}),Xk={TILING:1,SHADING:2},kG=10,Yk=Promise.resolve();function $R(n,e=!1){if(Array.isArray(n)){for(const t of n){const i=$R(t,!0);if(i)return i}return ce(`Unsupported blend mode Array: ${n}`),"source-over"}if(!(n instanceof ve))return e?null:"source-over";switch(n.name){case"Normal":case"Compatible":return"source-over";case"Multiply":return"multiply";case"Screen":return"screen";case"Overlay":return"overlay";case"Darken":return"darken";case"Lighten":return"lighten";case"ColorDodge":return"color-dodge";case"ColorBurn":return"color-burn";case"HardLight":return"hard-light";case"SoftLight":return"soft-light";case"Difference":return"difference";case"Exclusion":return"exclusion";case"Hue":return"hue";case"Saturation":return"saturation";case"Color":return"color";case"Luminosity":return"luminosity"}return e?null:(ce(`Unsupported blend mode: ${n.name}`),"source-over")}function Tw(n,{objId:e,fn:t,args:i,optionalContent:s,hasMask:r}){var a;e&&n.addDependency(e),n.addImageOps(t,i,s,r),t===ie.paintImageMaskXObject&&((a=i[0])==null?void 0:a.count)>0&&i[0].count++}const qf=class qf{constructor(){this.reset()}check(){return++this.checked<qf.CHECK_TIME_EVERY?!1:(this.checked=0,this.endTime<=Date.now())}reset(){this.endTime=Date.now()+qf.TIME_SLOT_DURATION_MS,this.checked=0}};He(qf,"TIME_SLOT_DURATION_MS",20),He(qf,"CHECK_TIME_EVERY",100);let N3=qf;class Rg{constructor({xref:e,handler:t,pageIndex:i,idFactory:s,fontCache:r,builtInCMapCache:a,standardFontDataCache:o,globalColorSpaceCache:l,globalImageCache:c,systemFontCache:h,options:u=null}){this.xref=e,this.handler=t,this.pageIndex=i,this.idFactory=s,this.fontCache=r,this.builtInCMapCache=a,this.standardFontDataCache=o,this.globalColorSpaceCache=l,this.globalImageCache=c,this.systemFontCache=h,this.options=u||vG,this.type3FontRefs=null,this._regionalImageCache=new rG,this._fetchBuiltInCMapBound=this.fetchBuiltInCMap.bind(this)}get _pdfFunctionFactory(){const e=new ZR({xref:this.xref,isEvalSupported:this.options.isEvalSupported});return Ze(this,"_pdfFunctionFactory",e)}get parsingType3Font(){return!!this.type3FontRefs}clone(e=null){const t=Object.create(this);return t.options=Object.assign(Object.create(null),this.options,e),t}hasBlendModes(e,t){if(!(e instanceof fe)||e.objId&&t.has(e.objId))return!1;const i=new Zi(t);e.objId&&i.put(e.objId);const s=[e],r=this.xref;for(;s.length;){const a=s.shift(),o=a.get("ExtGState");if(o instanceof fe)for(let c of o.getRawValues()){if(c instanceof st){if(i.has(c))continue;try{c=r.fetch(c)}catch(u){i.put(c),gn(`hasBlendModes - ignoring ExtGState: "${u}".`);continue}}if(!(c instanceof fe))continue;c.objId&&i.put(c.objId);const h=c.get("BM");if(h instanceof ve){if(h.name!=="Normal")return!0;continue}if(h!==void 0&&Array.isArray(h)){for(const u of h)if(u instanceof ve&&u.name!=="Normal")return!0}}const l=a.get("XObject");if(l instanceof fe)for(let c of l.getRawValues()){if(c instanceof st){if(i.has(c))continue;try{c=r.fetch(c)}catch(u){i.put(c),gn(`hasBlendModes - ignoring XObject: "${u}".`);continue}}if(!(c instanceof un))continue;c.dict.objId&&i.put(c.dict.objId);const h=c.dict.get("Resources");h instanceof fe&&(h.objId&&i.has(h.objId)||(s.push(h),h.objId&&i.put(h.objId)))}}for(const a of i)t.put(a);return!1}async fetchBuiltInCMap(e){const t=this.builtInCMapCache.get(e);if(t)return t;let i;return this.options.useWorkerFetch?i={cMapData:await E7(`${this.options.cMapUrl}${e}.bcmap`),isCompressed:!0}:i=await this.handler.sendWithPromise("FetchBinaryData",{type:"cMapReaderFactory",name:e}),this.builtInCMapCache.set(e,i),i}async fetchStandardFontData(e){const t=this.standardFontDataCache.get(e);if(t)return new Hi(t);if(this.options.useSystemFonts&&e!=="Symbol"&&e!=="ZapfDingbats")return null;const i=Sz(),s=i[e];let r;try{this.options.useWorkerFetch?r=await E7(`${this.options.standardFontDataUrl}${s}`):r=await this.handler.sendWithPromise("FetchBinaryData",{type:"standardFontDataFactory",filename:s})}catch(a){return ce(a),null}return this.standardFontDataCache.set(e,r),new Hi(r)}async buildFormXObject(e,t,i,s,r,a,o,l){const{dict:c}=t,h=Th(c.getArray("Matrix"),null),u=y0(c.getArray("BBox"),null);let d,f;c.has("OC")&&(d=await this.parseMarkedContentProps(c.get("OC"),e)),d!==void 0&&s.addOp(ie.beginMarkedContentProps,["OC",d]);const g=c.get("Group");if(g){f={matrix:h,bbox:u,smask:i,isolated:!1,knockout:!1};const w=g.get("S");let _=null;if(Di(w,"Transparency")&&(f.isolated=g.get("I")||!1,f.knockout=g.get("K")||!1,g.has("CS"))){const v=this._getColorSpace(g.getRaw("CS"),e,o);_=v instanceof fr?v:await this._handleColorSpace(v)}i!=null&&i.backdrop&&(_||(_=Nn.rgb),i.backdrop=_.getRgbHex(i.backdrop,0)),s.addOp(ie.beginGroup,[f])}const m=h&&new Float32Array(h),x=!g&&u&&new Float32Array(u)||null,p=[m,x];s.addOp(ie.paintFormXObjectBegin,p);const y=c.get("Resources");await this.getOperatorList({stream:t,task:r,resources:y instanceof fe?y:e,operatorList:s,initialState:a,prevRefs:l}),s.addOp(ie.paintFormXObjectEnd,[]),g&&s.addOp(ie.endGroup,[f]),d!==void 0&&s.addOp(ie.endMarkedContent,[])}_sendImgData(e,t,i=!1){const s=t?[t.bitmap||t.data.buffer]:null;return this.parsingType3Font||i?this.handler.send("commonobj",[e,"Image",t],s):this.handler.send("obj",[e,this.pageIndex,"Image",t],s)}async buildPaintImageXObject({resources:e,image:t,isInline:i=!1,operatorList:s,cacheKey:r,localImageCache:a,localColorSpaceCache:o}){const{maxImageSize:l,ignoreErrors:c,isOffscreenCanvasSupported:h}=this.options,{dict:u}=t,d=u.objId,f=u.get("W","Width"),g=u.get("H","Height");if(!(f&&typeof f=="number")||!(g&&typeof g=="number")){ce("Image dimensions are missing, or not numbers.");return}if(l!==-1&&f*g>l){const S="Image exceeded maximum allowed size and was removed.";if(!c)throw new Error(S);ce(S);return}let m;u.has("OC")&&(m=await this.parseMarkedContentProps(u.get("OC"),e));const x=u.get("IM","ImageMask")||!1;let p,y,w;if(x){if(p=await pp.createMask({image:t,isOffscreenCanvasSupported:h&&!this.parsingType3Font}),p.isSingleOpaquePixel){if(y=ie.paintSolidColorImageMask,w=[],s.addImageOps(y,w,m),r){const M={fn:y,args:w,optionalContent:m};a.set(r,d,M),d&&this._regionalImageCache.set(null,d,M)}return}if(this.parsingType3Font){if(w=pz(p),w){s.addImageOps(ie.constructPath,w,m);return}ce("Cannot compile Type3 glyph."),s.addImageOps(ie.paintImageMaskXObject,[p],m);return}const S=`mask_${this.idFactory.createObjId()}`;if(s.addDependency(S),p.dataLen=p.bitmap?p.width*p.height*4:p.data.length,this._sendImgData(S,p),y=ie.paintImageMaskXObject,w=[{data:S,width:p.width,height:p.height,interpolate:p.interpolate,count:1}],s.addImageOps(y,w,m),r){const M={objId:S,fn:y,args:w,optionalContent:m};a.set(r,d,M),d&&this._regionalImageCache.set(null,d,M)}return}const _=200,v=u.has("SMask")||u.has("Mask");if(i&&f+g<_&&!v){try{p=await new pp({xref:this.xref,res:e,image:t,isInline:i,pdfFunctionFactory:this._pdfFunctionFactory,globalColorSpaceCache:this.globalColorSpaceCache,localColorSpaceCache:o}).createImageData(!0,!1),s.addImageOps(ie.paintInlineImageXObject,[p],m)}catch(S){const M=`Unable to decode inline image: "${S}".`;if(!c)throw new Error(M);ce(M)}return}let C=`img_${this.idFactory.createObjId()}`,k=!1,I=null;if(this.parsingType3Font?C=`${this.idFactory.getDocId()}_type3_${C}`:r&&d&&(k=this.globalImageCache.shouldCache(d,this.pageIndex),k&&(Hs(!i,"Cannot cache an inline image globally."),C=`${this.idFactory.getDocId()}_${C}`)),s.addDependency(C),y=ie.paintImageXObject,w=[C,f,g],s.addImageOps(y,w,m,v),k){if(I={objId:C,fn:y,args:w,optionalContent:m,hasMask:v,byteSize:0},this.globalImageCache.hasDecodeFailed(d)){this.globalImageCache.setData(d,I),this._sendImgData(C,null,k);return}if(f*g>25e4||v){const S=await this.handler.sendWithPromise("commonobj",[C,"CopyLocalImage",{imageRef:d}]);if(S){this.globalImageCache.setData(d,I),this.globalImageCache.addByteSize(d,S);return}}}if(pp.buildImage({xref:this.xref,res:e,image:t,isInline:i,pdfFunctionFactory:this._pdfFunctionFactory,globalColorSpaceCache:this.globalColorSpaceCache,localColorSpaceCache:o}).then(async S=>(p=await S.createImageData(!1,h),p.dataLen=p.bitmap?p.width*p.height*4:p.data.length,p.ref=d,k&&this.globalImageCache.addByteSize(d,p.dataLen),this._sendImgData(C,p,k))).catch(S=>(ce(`Unable to decode image "${C}": "${S}".`),d&&this.globalImageCache.addDecodeFailed(d),this._sendImgData(C,null,k))),r){const S={objId:C,fn:y,args:w,optionalContent:m,hasMask:v};a.set(r,d,S),d&&(this._regionalImageCache.set(null,d,S),k&&(Hs(I,"The global cache-data must be available."),this.globalImageCache.setData(d,I)))}}handleSMask(e,t,i,s,r,a,o){const l=e.get("G"),c={subtype:e.get("S").name,backdrop:e.get("BC")},h=e.get("TR");if(Iw(h)){const u=this._pdfFunctionFactory.create(h),d=new Uint8Array(256),f=new Float32Array(1);for(let g=0;g<256;g++)f[0]=g/255,u(f,0,f,0),d[g]=f[0]*255|0;c.transferMap=d}return this.buildFormXObject(t,l,c,i,s,r.state.clone({newPath:!0}),a,o)}handleTransferFunction(e){let t;if(Array.isArray(e))t=e;else if(Iw(e))t=[e];else return null;const i=[];let s=0,r=0;for(const a of t){const o=this.xref.fetchIfRef(a);if(s++,Di(o,"Identity")){i.push(null);continue}else if(!Iw(o))return null;const l=this._pdfFunctionFactory.create(o),c=new Uint8Array(256),h=new Float32Array(1);for(let u=0;u<256;u++)h[0]=u/255,l(h,0,h,0),c[u]=h[0]*255|0;i.push(c),r++}return!(s===1||s===4)||r===0?null:i}handleTilingType(e,t,i,s,r,a,o,l){const c=new Sr,h=fe.merge({xref:this.xref,dictArray:[r.get("Resources"),i]});return this.getOperatorList({stream:s,task:o,resources:h,operatorList:c}).then(function(){const u=c.getIR(),d=Dk(u,r,t);a.addDependencies(c.dependencies),a.addOp(e,d),r.objId&&l.set(null,r.objId,{operatorListIR:u,dict:r})}).catch(u=>{if(!(u instanceof rr)){if(this.options.ignoreErrors){ce(`handleTilingType - ignoring pattern: "${u}".`);return}throw u}})}async handleSetFont(e,t,i,s,r,a,o=null,l=null){const c=(t==null?void 0:t[0])instanceof ve?t[0].name:null,h=await this.loadFont(c,i,e,r,o,l);return h.font.isType3Font&&s.addDependencies(h.type3Dependencies),a.font=h.font,h.send(this.handler),h.loadedName}handleText(e,t){const i=t.font,s=i.charsToGlyphs(e);return i.data&&(t.textRenderingMode&nR.ADD_TO_PATH_FLAG||t.fillColorSpace.name==="Pattern"||i.disableFontFace)&&Rg.buildFontPaths(i,s,this.handler,this.options),s}ensureStateFont(e){if(e.font)return;const t=new Te("Missing setFont (Tf) operator before text rendering operator.");if(this.options.ignoreErrors){ce(`ensureStateFont: "${t}".`);return}throw t}async setGState({resources:e,gState:t,operatorList:i,cacheKey:s,task:r,stateManager:a,localGStateCache:o,localColorSpaceCache:l,seenRefs:c}){const h=t.objId;let u=!0;const d=[];let f=Promise.resolve();for(const[g,m]of t)switch(g){case"Type":break;case"LW":if(typeof m!="number"){ce(`Invalid LW (line width): ${m}`);break}d.push([g,Math.abs(m)]);break;case"LC":case"LJ":case"ML":case"D":case"RI":case"FL":case"CA":case"ca":d.push([g,m]);break;case"Font":u=!1,f=f.then(()=>this.handleSetFont(e,null,m[0],i,r,a.state).then(function(p){i.addDependency(p),d.push([g,[p,m[1]]])}));break;case"BM":d.push([g,$R(m)]);break;case"SMask":if(Di(m,"None")){d.push([g,!1]);break}m instanceof fe?(u=!1,f=f.then(()=>this.handleSMask(m,e,i,r,a,l,c)),d.push([g,!0])):ce("Unsupported SMask type");break;case"TR":const x=this.handleTransferFunction(m);d.push([g,x]);break;case"OP":case"op":case"OPM":case"BG":case"BG2":case"UCR":case"UCR2":case"TR2":case"HT":case"SM":case"SA":case"AIS":case"TK":gn("graphic state operator "+g);break;default:gn("Unknown graphic state operator "+g);break}await f,d.length>0&&i.addOp(ie.setGState,[d]),u&&o.set(s,h,d)}loadFont(e,t,i,s,r=null,a=null){var x;const o=async()=>new Rw({loadedName:"g_font_error",font:new Nk(`Font "${e}" is not available.`),dict:t});let l;if(t)t instanceof st&&(l=t);else{const p=i.get("Font");p&&(l=p.getRaw(e))}if(l){if((x=this.type3FontRefs)!=null&&x.has(l))return o();if(this.fontCache.has(l))return this.fontCache.get(l);try{t=this.xref.fetchIfRef(l)}catch(p){ce(`loadFont - lookup failed: "${p}".`)}}if(!(t instanceof fe)){if(!this.options.ignoreErrors&&!this.parsingType3Font)return ce(`Font "${e}" is not available.`),o();ce(`Font "${e}" is not available -- attempting to fallback to a default font.`),t=r||Rg.fallbackFontDict}if(t.cacheKey&&this.fontCache.has(t.cacheKey))return this.fontCache.get(t.cacheKey);const{promise:c,resolve:h}=Promise.withResolvers();let u;try{u=this.preEvaluateFont(t),u.cssFontInfo=a}catch(p){return ce(`loadFont - preEvaluateFont failed: "${p}".`),o()}const{descriptor:d,hash:f}=u,g=l instanceof st;let m;if(f&&d instanceof fe){const p=d.fontAliases||(d.fontAliases=Object.create(null));if(p[f]){const y=p[f].aliasRef;if(g&&y&&this.fontCache.has(y))return this.fontCache.putAlias(l,y),this.fontCache.get(l)}else p[f]={fontID:this.idFactory.createFontId()};g&&(p[f].aliasRef=l),m=p[f].fontID}else m=this.idFactory.createFontId();return Hs(m==null?void 0:m.startsWith("f"),'The "fontID" must be (correctly) defined.'),g?this.fontCache.put(l,c):(t.cacheKey=`cacheKey_${m}`,this.fontCache.put(t.cacheKey,c)),t.loadedName=`${this.idFactory.getDocId()}_${m}`,this.translateFont(u).then(async p=>{const y=new Rw({loadedName:t.loadedName,font:p,dict:t});if(p.isType3Font)try{await y.loadType3Data(this,i,s)}catch(w){throw new Error(`Type3 font load error: ${w}`)}h(y)}).catch(p=>{ce(`loadFont - translateFont failed: "${p}".`),h(new Rw({loadedName:t.loadedName,font:new Nk(p==null?void 0:p.message),dict:t}))}),c}buildPath(e,t,i){const{pathMinMax:s,pathBuffer:r}=i;switch(e|0){case ie.rectangle:{const a=i.currentPointX=t[0],o=i.currentPointY=t[1],l=t[2],c=t[3],h=a+l,u=o+c;l===0||c===0?r.push(gs.moveTo,a,o,gs.lineTo,h,u,gs.closePath):r.push(gs.moveTo,a,o,gs.lineTo,h,o,gs.lineTo,h,u,gs.lineTo,a,u,gs.closePath),Dn.rectBoundingBox(a,o,h,u,s);break}case ie.moveTo:{const a=i.currentPointX=t[0],o=i.currentPointY=t[1];r.push(gs.moveTo,a,o),Dn.pointBoundingBox(a,o,s);break}case ie.lineTo:{const a=i.currentPointX=t[0],o=i.currentPointY=t[1];r.push(gs.lineTo,a,o),Dn.pointBoundingBox(a,o,s);break}case ie.curveTo:{const a=i.currentPointX,o=i.currentPointY,[l,c,h,u,d,f]=t;i.currentPointX=d,i.currentPointY=f,r.push(gs.curveTo,l,c,h,u,d,f),Dn.bezierBoundingBox(a,o,l,c,h,u,d,f,s);break}case ie.curveTo2:{const a=i.currentPointX,o=i.currentPointY,[l,c,h,u]=t;i.currentPointX=h,i.currentPointY=u,r.push(gs.curveTo,a,o,l,c,h,u),Dn.bezierBoundingBox(a,o,a,o,l,c,h,u,s);break}case ie.curveTo3:{const a=i.currentPointX,o=i.currentPointY,[l,c,h,u]=t;i.currentPointX=h,i.currentPointY=u,r.push(gs.curveTo,l,c,h,u,h,u),Dn.bezierBoundingBox(a,o,l,c,h,u,h,u,s);break}case ie.closePath:r.push(gs.closePath);break}}_getColorSpace(e,t,i){return Nn.parse({cs:e,xref:this.xref,resources:t,pdfFunctionFactory:this._pdfFunctionFactory,globalColorSpaceCache:this.globalColorSpaceCache,localColorSpaceCache:i,asyncIfNotCached:!0})}async _handleColorSpace(e){try{return await e}catch(t){if(t instanceof rr)return null;if(this.options.ignoreErrors)return ce(`_handleColorSpace - ignoring ColorSpace: "${t}".`),null;throw t}}parseShading({shading:e,resources:t,localColorSpaceCache:i,localShadingPatternCache:s}){let r=s.get(e);if(r)return r;let a;try{a=mj.parseShading(e,this.xref,t,this._pdfFunctionFactory,this.globalColorSpaceCache,i).getIR()}catch(o){if(o instanceof rr)return null;if(this.options.ignoreErrors)return ce(`parseShading - ignoring shading: "${o}".`),s.set(e,null),null;throw o}return r=`pattern_${this.idFactory.createObjId()}`,this.parsingType3Font&&(r=`${this.idFactory.getDocId()}_type3_${r}`),s.set(e,r),this.parsingType3Font?this.handler.send("commonobj",[r,"Pattern",a]):this.handler.send("obj",[r,this.pageIndex,"Pattern",a]),r}handleColorN(e,t,i,s,r,a,o,l,c,h){const u=i.pop();if(u instanceof ve){const d=r.getRaw(u.name),f=d instanceof st&&c.getByRef(d);if(f)try{const m=s.base?s.base.getRgbHex(i,0):null,x=Dk(f.operatorListIR,f.dict,m);e.addOp(t,x);return}catch{}const g=this.xref.fetchIfRef(d);if(g){const m=g instanceof un?g.dict:g,x=m.get("PatternType");if(x===Xk.TILING){const p=s.base?s.base.getRgbHex(i,0):null;return this.handleTilingType(t,p,a,g,m,e,o,c)}else if(x===Xk.SHADING){const p=m.get("Shading"),y=this.parseShading({shading:p,resources:a,localColorSpaceCache:l,localShadingPatternCache:h});if(y){const w=Th(m.getArray("Matrix"),null);e.addOp(t,["Shading",y,w])}return}throw new Te(`Unknown PatternType: ${x}`)}}throw new Te(`Unknown PatternName: ${u}`)}_parseVisibilityExpression(e,t,i){if(++t>10){ce("Visibility expression is too deeply nested");return}const r=e.length,a=this.xref.fetchIfRef(e[0]);if(r<2||!(a instanceof ve)){ce("Invalid visibility expression");return}switch(a.name){case"And":case"Or":case"Not":i.push(a.name);break;default:ce(`Invalid operator ${a.name} in visibility expression`);return}for(let o=1;o<r;o++){const l=e[o],c=this.xref.fetchIfRef(l);if(Array.isArray(c)){const h=[];i.push(h),this._parseVisibilityExpression(c,t,h)}else l instanceof st&&i.push(l.toString())}}async parseMarkedContentProps(e,t){var r;let i;if(e instanceof ve)i=t.get("Properties").get(e.name);else if(e instanceof fe)i=e;else throw new Te("Optional content properties malformed.");const s=(r=i.get("Type"))==null?void 0:r.name;if(s==="OCG")return{type:s,id:i.objId};if(s==="OCMD"){const a=i.get("VE");if(Array.isArray(a)){const l=[];if(this._parseVisibilityExpression(a,0,l),l.length>0)return{type:"OCMD",expression:l}}const o=i.get("OCGs");if(Array.isArray(o)||o instanceof fe){const l=[];if(Array.isArray(o))for(const c of o)l.push(c.toString());else l.push(o.objId);return{type:s,ids:l,policy:i.get("P")instanceof ve?i.get("P").name:null,expression:null}}else if(o instanceof st)return{type:s,id:o.toString()}}return null}getOperatorList({stream:e,task:t,resources:i,operatorList:s,initialState:r=null,fallbackFontDict:a=null,prevRefs:o=null}){var k;const l=(k=e.dict)==null?void 0:k.objId,c=new Zi(o);if(l){if(o!=null&&o.has(l))throw new Error(`getOperatorList - ignoring circular reference: ${l}`);c.put(l)}if(i||(i=fe.empty),r||(r=new nM),!s)throw new Error('getOperatorList: missing "operatorList" parameter');const h=this,u=this.xref,d=new Fk,f=new YR,g=new Lk,m=new sG,x=new Map,p=i.get("XObject")||fe.empty,y=i.get("Pattern")||fe.empty,w=new a3(r),_=new Mg(e,u,w),v=new N3;function C(I){for(let S=0,M=_.savedStatesDepth;S<M;S++)s.addOp(ie.restore,[])}return new Promise(function I(S,M){const N=function(j){Promise.all([j,s.ready]).then(function(){try{I(S,M)}catch(J){M(J)}},M)};t.ensureNotTerminated(),v.reset();const F={};let H,T,z,R,L,Y;for(;!(H=v.check())&&(F.args=null,!!_.read(F));){let j=F.args,J=F.fn;switch(J|0){case ie.paintXObject:if(Y=j[0]instanceof ve,L=j[0].name,Y){const P=d.getByName(L);if(P){Tw(s,P),j=null;continue}}N(new Promise(function(P,V){if(!Y)throw new Te("XObject must be referred to by name.");let re=p.getRaw(L);if(re instanceof st){const ue=d.getByRef(re)||h._regionalImageCache.getByRef(re)||h.globalImageCache.getData(re,h.pageIndex);if(ue){Tw(s,ue),P();return}re=u.fetch(re)}if(!(re instanceof un))throw new Te("XObject should be a stream");const X=re.dict.get("Subtype");if(!(X instanceof ve))throw new Te("XObject should have a Name subtype");if(X.name==="Form"){w.save(),h.buildFormXObject(i,re,null,s,t,w.state.clone({newPath:!0}),f,c).then(function(){w.restore(),P()},V);return}else if(X.name==="Image"){h.buildPaintImageXObject({resources:i,image:re,operatorList:s,cacheKey:L,localImageCache:d,localColorSpaceCache:f}).then(P,V);return}else if(X.name==="PS")gn("Ignored XObject subtype PS");else throw new Te(`Unhandled XObject subtype ${X.name}`);P()}).catch(function(P){if(!(P instanceof rr)){if(h.options.ignoreErrors){ce(`getOperatorList - ignoring XObject: "${P}".`);return}throw P}}));return;case ie.setFont:const G=j[1];N(h.handleSetFont(i,j,null,s,t,w.state,a).then(function(P){s.addDependency(P),s.addOp(ie.setFont,[P,G])}));return;case ie.endInlineImage:const se=j[0].cacheKey;if(se){const P=d.getByName(se);if(P){Tw(s,P),j=null;continue}}N(h.buildPaintImageXObject({resources:i,image:j[0],isInline:!0,operatorList:s,cacheKey:se,localImageCache:d,localColorSpaceCache:f}));return;case ie.showText:if(!w.state.font){h.ensureStateFont(w.state);continue}j[0]=h.handleText(j[0],w.state);break;case ie.showSpacedText:if(!w.state.font){h.ensureStateFont(w.state);continue}const de=[],he=w.state;for(const P of j[0])typeof P=="string"?de.push(...h.handleText(P,he)):typeof P=="number"&&de.push(P);j[0]=de,J=ie.showText;break;case ie.nextLineShowText:if(!w.state.font){h.ensureStateFont(w.state);continue}s.addOp(ie.nextLine),j[0]=h.handleText(j[0],w.state),J=ie.showText;break;case ie.nextLineSetSpacingShowText:if(!w.state.font){h.ensureStateFont(w.state);continue}s.addOp(ie.nextLine),s.addOp(ie.setWordSpacing,[j.shift()]),s.addOp(ie.setCharSpacing,[j.shift()]),j[0]=h.handleText(j[0],w.state),J=ie.showText;break;case ie.setTextRenderingMode:w.state.textRenderingMode=j[0];break;case ie.setFillColorSpace:{const P=h._getColorSpace(j[0],i,f);if(P instanceof fr){w.state.fillColorSpace=P;continue}N(h._handleColorSpace(P).then(V=>{w.state.fillColorSpace=V||Nn.gray}));return}case ie.setStrokeColorSpace:{const P=h._getColorSpace(j[0],i,f);if(P instanceof fr){w.state.strokeColorSpace=P;continue}N(h._handleColorSpace(P).then(V=>{w.state.strokeColorSpace=V||Nn.gray}));return}case ie.setFillColor:R=w.state.fillColorSpace,j=[R.getRgbHex(j,0)],J=ie.setFillRGBColor;break;case ie.setStrokeColor:R=w.state.strokeColorSpace,j=[R.getRgbHex(j,0)],J=ie.setStrokeRGBColor;break;case ie.setFillGray:w.state.fillColorSpace=Nn.gray,j=[Nn.gray.getRgbHex(j,0)],J=ie.setFillRGBColor;break;case ie.setStrokeGray:w.state.strokeColorSpace=Nn.gray,j=[Nn.gray.getRgbHex(j,0)],J=ie.setStrokeRGBColor;break;case ie.setFillCMYKColor:w.state.fillColorSpace=Nn.cmyk,j=[Nn.cmyk.getRgbHex(j,0)],J=ie.setFillRGBColor;break;case ie.setStrokeCMYKColor:w.state.strokeColorSpace=Nn.cmyk,j=[Nn.cmyk.getRgbHex(j,0)],J=ie.setStrokeRGBColor;break;case ie.setFillRGBColor:w.state.fillColorSpace=Nn.rgb,j=[Nn.rgb.getRgbHex(j,0)];break;case ie.setStrokeRGBColor:w.state.strokeColorSpace=Nn.rgb,j=[Nn.rgb.getRgbHex(j,0)];break;case ie.setFillColorN:if(R=w.state.patternFillColorSpace,!R){if(Vr(j,null)){j=[Nn.gray.getRgbHex(j,0)],J=ie.setFillRGBColor;break}j=[],J=ie.setFillTransparent;break}if(R.name==="Pattern"){N(h.handleColorN(s,ie.setFillColorN,j,R,y,i,t,f,m,x));return}j=[R.getRgbHex(j,0)],J=ie.setFillRGBColor;break;case ie.setStrokeColorN:if(R=w.state.patternStrokeColorSpace,!R){if(Vr(j,null)){j=[Nn.gray.getRgbHex(j,0)],J=ie.setStrokeRGBColor;break}j=[],J=ie.setStrokeTransparent;break}if(R.name==="Pattern"){N(h.handleColorN(s,ie.setStrokeColorN,j,R,y,i,t,f,m,x));return}j=[R.getRgbHex(j,0)],J=ie.setStrokeRGBColor;break;case ie.shadingFill:let we;try{const P=i.get("Shading");if(!P)throw new Te("No shading resource found");if(we=P.get(j[0].name),!we)throw new Te("No shading object found")}catch(P){if(P instanceof rr)continue;if(h.options.ignoreErrors){ce(`getOperatorList - ignoring Shading: "${P}".`);continue}throw P}const ye=h.parseShading({shading:we,resources:i,localColorSpaceCache:f,localShadingPatternCache:x});if(!ye)continue;j=[ye],J=ie.shadingFill;break;case ie.setGState:if(Y=j[0]instanceof ve,L=j[0].name,Y){const P=g.getByName(L);if(P){P.length>0&&s.addOp(ie.setGState,[P]),j=null;continue}}N(new Promise(function(P,V){if(!Y)throw new Te("GState must be referred to by name.");const re=i.get("ExtGState");if(!(re instanceof fe))throw new Te("ExtGState should be a dictionary.");const X=re.get(L);if(!(X instanceof fe))throw new Te("GState should be a dictionary.");h.setGState({resources:i,gState:X,operatorList:s,cacheKey:L,task:t,stateManager:w,localGStateCache:g,localColorSpaceCache:f,seenRefs:c}).then(P,V)}).catch(function(P){if(!(P instanceof rr)){if(h.options.ignoreErrors){ce(`getOperatorList - ignoring ExtGState: "${P}".`);return}throw P}}));return;case ie.setLineWidth:{const[P]=j;if(typeof P!="number"){ce(`Invalid setLineWidth: ${P}`);continue}j[0]=Math.abs(P);break}case ie.moveTo:case ie.lineTo:case ie.curveTo:case ie.curveTo2:case ie.curveTo3:case ie.closePath:case ie.rectangle:h.buildPath(J,j,w.state);continue;case ie.stroke:case ie.closeStroke:case ie.fill:case ie.eoFill:case ie.fillStroke:case ie.eoFillStroke:case ie.closeFillStroke:case ie.closeEOFillStroke:case ie.endPath:{const{state:{pathBuffer:P,pathMinMax:V}}=w;(J===ie.closeStroke||J===ie.closeFillStroke||J===ie.closeEOFillStroke)&&P.push(gs.closePath),P.length===0?s.addOp(ie.constructPath,[J,[null],null]):(s.addOp(ie.constructPath,[J,[new Float32Array(P)],V.slice()]),P.length=0,V.set([1/0,1/0,-1/0,-1/0],0));continue}case ie.setTextMatrix:s.addOp(J,[new Float32Array(j)]);continue;case ie.markPoint:case ie.markPointProps:case ie.beginCompat:case ie.endCompat:continue;case ie.beginMarkedContentProps:if(!(j[0]instanceof ve)){ce(`Expected name for beginMarkedContentProps arg0=${j[0]}`),s.addOp(ie.beginMarkedContentProps,["OC",null]);continue}if(j[0].name==="OC"){N(h.parseMarkedContentProps(j[1],i).then(P=>{s.addOp(ie.beginMarkedContentProps,["OC",P])}).catch(P=>{if(!(P instanceof rr)){if(h.options.ignoreErrors){ce(`getOperatorList - ignoring beginMarkedContentProps: "${P}".`),s.addOp(ie.beginMarkedContentProps,["OC",null]);return}throw P}}));return}j=[j[0].name,j[1]instanceof fe?j[1].get("MCID"):null];break;case ie.beginMarkedContent:case ie.endMarkedContent:default:if(j!==null){for(T=0,z=j.length;T<z&&!(j[T]instanceof fe);T++);if(T<z){ce("getOperatorList - ignoring operator: "+J);continue}}}s.addOp(J,j)}if(H){N(Yk);return}C(),S()}).catch(I=>{if(!(I instanceof rr)){if(this.options.ignoreErrors){ce(`getOperatorList - ignoring errors during "${t.name}" task: "${I}".`),C();return}throw I}})}getTextContent({stream:e,task:t,resources:i,stateManager:s=null,includeMarkedContent:r=!1,sink:a,seenStyles:o=new Set,viewBox:l,lang:c=null,markedContentData:h=null,disableNormalization:u=!1,keepWhiteSpace:d=!1,prevRefs:f=null,intersector:g=null}){var Ue;const m=(Ue=e.dict)==null?void 0:Ue.objId,x=new Zi(f);if(m){if(f!=null&&f.has(m))throw new Error(`getTextContent - ignoring circular reference: ${m}`);x.put(m)}i||(i=fe.empty),s||(s=new a3(new CG)),r&&(h||(h={level:0}));const p={items:[],styles:Object.create(null),lang:c},y={initialized:!1,str:[],totalWidth:0,totalHeight:0,width:0,height:0,vertical:!1,prevTransform:null,textAdvanceScale:0,spaceInFlowMin:0,spaceInFlowMax:0,trackingSpaceMin:1/0,negativeSpaceMax:-1/0,notASpace:-1/0,transform:null,fontName:null,hasEOL:!1},w=[" "," "];let _=0;function v(De){const je=(_+1)%2,ze=w[_]!==" "&&w[je]===" ";return w[_]=De,_=je,!d&&ze}function C(){return!d&&w[_]!==" "&&w[(_+1)%2]===" "}function k(){w[0]=w[1]=" ",_=0}const I=.102,S=.03,M=-.2,N=.102,F=.6,H=.25,T=this,z=this.xref,R=[];let L=null;const Y=new Fk,j=new Lk,J=new Mg(e,z,s);let G;function se({width:De=0,height:je=0,transform:ze=y.prevTransform,fontName:Qe=y.fontName}){g==null||g.addExtraChar(" "),p.items.push({str:" ",dir:"ltr",width:De,height:je,transform:ze,fontName:Qe,hasEOL:!1})}function de(){const De=G.font,je=[G.fontSize*G.textHScale,0,0,G.fontSize,0,G.textRise];if(De.isType3Font&&(G.fontSize<=1||De.isCharBBox)&&!Bp(G.fontMatrix,Ld)){const ze=De.bbox[3]-De.bbox[1];ze>0&&(je[3]*=ze*G.fontMatrix[3])}return Dn.transform(G.ctm,Dn.transform(G.textMatrix,je))}function he(){if(y.initialized)return y;const{font:De,loadedName:je}=G;if(!o.has(je)&&(o.add(je),p.styles[je]={fontFamily:De.fallbackName,ascent:De.ascent,descent:De.descent,vertical:De.vertical},T.options.fontExtraProperties&&De.systemFontInfo)){const Je=p.styles[je];Je.fontSubstitution=De.systemFontInfo.css,Je.fontSubstitutionLoadedName=De.systemFontInfo.loadedName}y.fontName=je;const ze=y.transform=de();De.vertical?(y.width=y.totalWidth=Math.hypot(ze[0],ze[1]),y.height=y.totalHeight=0,y.vertical=!0):(y.width=y.totalWidth=0,y.height=y.totalHeight=Math.hypot(ze[2],ze[3]),y.vertical=!1);const Qe=Math.hypot(G.textLineMatrix[0],G.textLineMatrix[1]),ft=Math.hypot(G.ctm[0],G.ctm[1]);y.textAdvanceScale=ft*Qe;const{fontSize:ut}=G;return y.trackingSpaceMin=ut*I,y.notASpace=ut*S,y.negativeSpaceMax=ut*M,y.spaceInFlowMin=ut*N,y.spaceInFlowMax=ut*F,y.hasEOL=!1,y.initialized=!0,y}function we(){if(!y.initialized)return;const De=Math.hypot(G.textLineMatrix[0],G.textLineMatrix[1]),ze=Math.hypot(G.ctm[0],G.ctm[1])*De;ze!==y.textAdvanceScale&&(y.vertical?(y.totalHeight+=y.height*y.textAdvanceScale,y.height=0):(y.totalWidth+=y.width*y.textAdvanceScale,y.width=0),y.textAdvanceScale=ze)}function ye(De){let je=De.str.join("");u||(je=pU(je));const ze=QR(je,-1,De.vertical);return{str:ze.str,dir:ze.dir,width:Math.abs(De.totalWidth),height:Math.abs(De.totalHeight),transform:De.transform,fontName:De.fontName,hasEOL:De.hasEOL}}async function P(De,je){const ze=await T.loadFont(De,je,i,t);G.loadedName=ze.loadedName,G.font=ze.font,G.fontMatrix=ze.font.fontMatrix||Ld}function V(De,je,ze){const Qe=Math.hypot(ze[0],ze[1]);return[(ze[0]*De+ze[1]*je)/Qe,(ze[2]*De+ze[3]*je)/Qe]}function re(De){var lt;const je=de();let ze=je[4],Qe=je[5];if((lt=G.font)!=null&&lt.vertical){if(ze<l[0]||ze>l[2]||Qe+De<l[1]||Qe>l[3])return!1}else if(ze+De<l[0]||ze>l[2]||Qe<l[1]||Qe>l[3])return!1;if(!G.font||!y.prevTransform)return!0;let ft=y.prevTransform[4],ut=y.prevTransform[5];if(ft===ze&&ut===Qe)return!0;let Je=-1;switch(je[0]&&je[1]===0&&je[2]===0?Je=je[0]>0?0:180:je[1]&&je[0]===0&&je[3]===0&&(Je=je[1]>0?90:270),Je){case 0:break;case 90:[ze,Qe]=[Qe,ze],[ft,ut]=[ut,ft];break;case 180:[ze,Qe,ft,ut]=[-ze,-Qe,-ft,-ut];break;case 270:[ze,Qe]=[-Qe,-ze],[ft,ut]=[-ut,-ft];break;default:[ze,Qe]=V(ze,Qe,je),[ft,ut]=V(ft,ut,y.prevTransform)}if(G.font.vertical){const ct=(ut-Qe)/y.textAdvanceScale,Ge=ze-ft,Ft=Math.sign(y.height);return ct<Ft*y.negativeSpaceMax?Math.abs(Ge)>.5*y.width?(ue(),!0):(k(),Q(),!0):Math.abs(Ge)>y.width?(ue(),!0):(ct<=Ft*y.notASpace&&k(),ct<=Ft*y.trackingSpaceMin?C()?(k(),Q(),se({height:Math.abs(ct)})):y.height+=ct:oe(ct,y.prevTransform,Ft)||(y.str.length===0?(k(),se({height:Math.abs(ct)})):y.height+=ct),Math.abs(Ge)>y.width*H&&Q(),!0)}const rt=(ze-ft)/y.textAdvanceScale,ge=Qe-ut,Pt=Math.sign(y.width);return rt<Pt*y.negativeSpaceMax?Math.abs(ge)>.5*y.height?(ue(),!0):(k(),Q(),!0):Math.abs(ge)>y.height?(ue(),!0):(rt<=Pt*y.notASpace&&k(),rt<=Pt*y.trackingSpaceMin?C()?(k(),Q(),se({width:Math.abs(rt)})):y.width+=rt:oe(rt,y.prevTransform,Pt)||(y.str.length===0?(k(),se({width:Math.abs(rt)})):y.width+=rt),Math.abs(ge)>y.height*H&&Q(),!0)}function X({chars:De,extraSpacing:je}){const ze=G.font;if(!De){const ut=G.charSpacing+je;ut&&(ze.vertical?G.translateTextMatrix(0,-ut):G.translateTextMatrix(ut*G.textHScale,0)),d&&re(0);return}const Qe=ze.charsToGlyphs(De),ft=G.fontMatrix[0]*G.fontSize;for(let ut=0,Je=Qe.length;ut<Je;ut++){const rt=Qe[ut],{category:ge}=rt;if(ge.isInvisibleFormatMark)continue;let Pt=G.charSpacing+(ut+1===Je?je:0),lt=rt.width;ze.vertical&&(lt=rt.vmetric?rt.vmetric[0]:-lt);let ct=lt*ft;if(!d&&ge.isWhitespace){ze.vertical?(Pt+=-ct+G.wordSpacing,G.translateTextMatrix(0,-Pt)):(Pt+=ct+G.wordSpacing,G.translateTextMatrix(Pt*G.textHScale,0)),v(" ");continue}if(!ge.isZeroWidthDiacritic&&!re(ct)){ze.vertical?G.translateTextMatrix(0,ct):G.translateTextMatrix(ct*G.textHScale,0);continue}const Ge=he();ge.isZeroWidthDiacritic&&(ct=0),ze.vertical?(g==null||g.addGlyph(de(),0,ct,rt.unicode),G.translateTextMatrix(0,ct),ct=Math.abs(ct),Ge.height+=ct):(ct*=G.textHScale,g==null||g.addGlyph(de(),ct,0,rt.unicode),G.translateTextMatrix(ct,0),Ge.width+=ct),ct&&(Ge.prevTransform=de());const Ft=rt.unicode;v(Ft)&&(Ge.str.push(" "),g==null||g.addExtraChar(" ")),g||Ge.str.push(Ft),Pt&&(ze.vertical?G.translateTextMatrix(0,-Pt):G.translateTextMatrix(Pt*G.textHScale,0))}}function ue(){g==null||g.addExtraChar(`
`),k(),y.initialized?(y.hasEOL=!0,Q()):p.items.push({str:"",dir:"ltr",width:0,height:0,transform:de(),fontName:G.loadedName,hasEOL:!0})}function oe(De,je,ze){if(ze*y.spaceInFlowMin<=De&&De<=ze*y.spaceInFlowMax)return y.initialized&&(k(),y.str.push(" "),g==null||g.addExtraChar(" ")),!1;const Qe=y.fontName;let ft=0;return y.vertical&&(ft=De,De=0),Q(),k(),se({width:Math.abs(De),height:Math.abs(ft),transform:je||de(),fontName:Qe}),!0}function Q(){!y.initialized||!y.str||(y.vertical?y.totalHeight+=y.height*y.textAdvanceScale:y.totalWidth+=y.width*y.textAdvanceScale,p.items.push(ye(y)),y.initialized=!1,y.str.length=0)}function ae(De=!1){const je=p.items.length;je!==0&&(De&&je<kG||(a==null||a.enqueue(p,je),p.items=[],p.styles=Object.create(null)))}const Ke=new N3;return new Promise(function De(je,ze){const Qe=function(Pt){ae(!0),Promise.all([Pt,a==null?void 0:a.ready]).then(function(){try{De(je,ze)}catch(lt){ze(lt)}},ze)};t.ensureNotTerminated(),Ke.reset();const ft={};let ut,Je,rt,ge=[];for(;!(ut=Ke.check())&&(ge.length=0,ft.args=ge,!!J.read(ft));){const Pt=G;G=s.state;const lt=ft.fn;switch(ge=ft.args,lt|0){case ie.setFont:const ct=ge[0].name,Ge=ge[1];if(G.font&&ct===G.fontName&&Ge===G.fontSize)break;Q(),G.fontName=ct,G.fontSize=Ge,Qe(P(ct,null));return;case ie.setTextRise:G.textRise=ge[0];break;case ie.setHScale:G.textHScale=ge[0]/100;break;case ie.setLeading:G.leading=ge[0];break;case ie.moveText:G.translateTextLineMatrix(ge[0],ge[1]),G.textMatrix=G.textLineMatrix.slice();break;case ie.setLeadingMoveText:G.leading=-ge[1],G.translateTextLineMatrix(ge[0],ge[1]),G.textMatrix=G.textLineMatrix.slice();break;case ie.nextLine:G.carriageReturn();break;case ie.setTextMatrix:G.setTextMatrix(ge[0],ge[1],ge[2],ge[3],ge[4],ge[5]),G.setTextLineMatrix(ge[0],ge[1],ge[2],ge[3],ge[4],ge[5]),we();break;case ie.setCharSpacing:G.charSpacing=ge[0];break;case ie.setWordSpacing:G.wordSpacing=ge[0];break;case ie.beginText:G.textMatrix=el.slice(),G.textLineMatrix=el.slice();break;case ie.showSpacedText:if(!s.state.font){T.ensureStateFont(s.state);continue}const Ft=(G.font.vertical?1:-1)*G.fontSize/1e3,sn=ge[0];for(let Me=0,Lt=sn.length;Me<Lt;Me++){const dt=sn[Me];if(typeof dt=="string")R.push(dt);else if(typeof dt=="number"&&dt!==0){const Vt=R.join("");R.length=0,X({chars:Vt,extraSpacing:dt*Ft})}}if(R.length>0){const Me=R.join("");R.length=0,X({chars:Me,extraSpacing:0})}break;case ie.showText:if(!s.state.font){T.ensureStateFont(s.state);continue}X({chars:ge[0],extraSpacing:0});break;case ie.nextLineShowText:if(!s.state.font){T.ensureStateFont(s.state);continue}G.carriageReturn(),X({chars:ge[0],extraSpacing:0});break;case ie.nextLineSetSpacingShowText:if(!s.state.font){T.ensureStateFont(s.state);continue}G.wordSpacing=ge[0],G.charSpacing=ge[1],G.carriageReturn(),X({chars:ge[2],extraSpacing:0});break;case ie.paintXObject:if(Q(),L??(L=i.get("XObject")||fe.empty),rt=ge[0]instanceof ve,Je=ge[0].name,rt&&Y.getByName(Je))break;Qe(new Promise(function(Me,Lt){if(!rt)throw new Te("XObject must be referred to by name.");let dt=L.getRaw(Je);if(dt instanceof st){if(Y.getByRef(dt)){Me();return}if(T.globalImageCache.getData(dt,T.pageIndex)){Me();return}dt=z.fetch(dt)}if(!(dt instanceof un))throw new Te("XObject should be a stream");const{dict:Vt}=dt,Ln=Vt.get("Subtype");if(!(Ln instanceof ve))throw new Te("XObject should have a Name subtype");if(Ln.name!=="Form"){Y.set(Je,Vt.objId,!0),Me();return}const Wn=s.state.clone(),hi=new a3(Wn),Gi=Th(Vt.getArray("Matrix"),null);Gi&&hi.transform(Gi);const ws=Vt.get("Resources");ae();const ui={enqueueInvoked:!1,enqueue(Wi,_s){this.enqueueInvoked=!0,a.enqueue(Wi,_s)},get desiredSize(){return a.desiredSize??0},get ready(){return a.ready}};T.getTextContent({stream:dt,task:t,resources:ws instanceof fe?ws:i,stateManager:hi,includeMarkedContent:r,sink:a&&ui,seenStyles:o,viewBox:l,lang:c,markedContentData:h,disableNormalization:u,keepWhiteSpace:d,prevRefs:x}).then(function(){ui.enqueueInvoked||Y.set(Je,Vt.objId,!0),Me()},Lt)}).catch(function(Me){if(!(Me instanceof rr)){if(T.options.ignoreErrors){ce(`getTextContent - ignoring XObject: "${Me}".`);return}throw Me}}));return;case ie.setGState:if(rt=ge[0]instanceof ve,Je=ge[0].name,rt&&j.getByName(Je))break;Qe(new Promise(function(Me,Lt){if(!rt)throw new Te("GState must be referred to by name.");const dt=i.get("ExtGState");if(!(dt instanceof fe))throw new Te("ExtGState should be a dictionary.");const Vt=dt.get(Je);if(!(Vt instanceof fe))throw new Te("GState should be a dictionary.");const Ln=Vt.get("Font");if(!Ln){j.set(Je,Vt.objId,!0),Me();return}Q(),G.fontName=null,G.fontSize=Ln[1],P(null,Ln[0]).then(Me,Lt)}).catch(function(Me){if(!(Me instanceof rr)){if(T.options.ignoreErrors){ce(`getTextContent - ignoring ExtGState: "${Me}".`);return}throw Me}}));return;case ie.beginMarkedContent:Q(),r&&(h.level++,p.items.push({type:"beginMarkedContent",tag:ge[0]instanceof ve?ge[0].name:null}));break;case ie.beginMarkedContentProps:if(Q(),r){h.level++;let Me=null;ge[1]instanceof fe&&(Me=ge[1].get("MCID")),p.items.push({type:"beginMarkedContentProps",id:Number.isInteger(Me)?`${T.idFactory.getPageObjId()}_mc${Me}`:null,tag:ge[0]instanceof ve?ge[0].name:null})}break;case ie.endMarkedContent:if(Q(),r){if(h.level===0)break;h.level--,p.items.push({type:"endMarkedContent"})}break;case ie.restore:Pt&&(Pt.font!==G.font||Pt.fontSize!==G.fontSize||Pt.fontName!==G.fontName)&&Q();break}if(p.items.length>=((a==null?void 0:a.desiredSize)??1)){ut=!0;break}}if(ut){Qe(Yk);return}Q(),ae(),je()}).catch(De=>{if(!(De instanceof rr)){if(this.options.ignoreErrors){ce(`getTextContent - ignoring errors during "${t.name}" task: "${De}".`),Q(),ae();return}throw De}})}async extractDataStructures(e,t){const i=this.xref;let s;const r=this.readToUnicode(t.toUnicode);if(t.composite){const d=e.get("CIDSystemInfo");d instanceof fe&&(t.cidSystemInfo={registry:Tn(d.get("Registry")),ordering:Tn(d.get("Ordering")),supplement:d.get("Supplement")});try{const f=e.get("CIDToGIDMap");f instanceof un&&(s=f.getBytes())}catch(f){if(!this.options.ignoreErrors)throw f;ce(`extractDataStructures - ignoring CIDToGIDMap data: "${f}".`)}}const a=[];let o=null,l;if(e.has("Encoding")){if(l=e.get("Encoding"),l instanceof fe){if(o=l.get("BaseEncoding"),o=o instanceof ve?o.name:null,l.has("Differences")){const d=l.get("Differences");let f=0;for(const g of d){const m=i.fetchIfRef(g);if(typeof m=="number")f=m;else if(m instanceof ve)a[f++]=m.name;else throw new Te(`Invalid entry in 'Differences' array: ${m}`)}}}else if(l instanceof ve)o=l.name;else{const d="Encoding is not a Name nor a Dict";if(!this.options.ignoreErrors)throw new Te(d);ce(d)}o!=="MacRomanEncoding"&&o!=="MacExpertEncoding"&&o!=="WinAnsiEncoding"&&(o=null)}const c=!t.file||t.isInternalFont,h=K7()[t.name];if(o&&c&&h&&(o=null),o)t.defaultEncoding=jp(o);else{const d=!!(t.flags&lo.Symbolic),f=!!(t.flags&lo.Nonsymbolic);l=o0,t.type==="TrueType"&&!f&&(l=zp),(d||h)&&(l=C4,c&&(/Symbol/i.test(t.name)?l=A4:/Dingbats/i.test(t.name)?l=S4:/Wingdings/i.test(t.name)&&(l=zp))),t.defaultEncoding=l}t.differences=a,t.baseEncodingName=o,t.hasEncoding=!!o||a.length>0,t.dict=e,t.toUnicode=await r;const u=await this.buildToUnicode(t);return t.toUnicode=u,s&&(t.cidToGidMap=this.readCidToGidMap(s,u)),t}_simpleFontToUnicode(e,t=!1){Hs(!e.composite,"Must be a simple font.");const i=[],s=e.defaultEncoding.slice(),r=e.baseEncodingName,a=e.differences;for(const l in a){const c=a[l];c!==".notdef"&&(s[l]=c)}const o=Kl();for(const l in s){let c=s[l];if(c==="")continue;let h=o[c];if(h!==void 0){i[l]=String.fromCharCode(h);continue}let u=0;switch(c[0]){case"G":c.length===3&&(u=parseInt(c.substring(1),16));break;case"g":c.length===5&&(u=parseInt(c.substring(1),16));break;case"C":case"c":if(c.length>=3&&c.length<=4){const d=c.substring(1);if(t){u=parseInt(d,16);break}if(u=+d,Number.isNaN(u)&&Number.isInteger(parseInt(d,16)))return this._simpleFontToUnicode(e,!0)}break;case"u":h=Tg(c,o),h!==-1&&(u=h);break;default:switch(c){case"f_h":case"f_t":case"T_h":i[l]=c.replaceAll("_","");continue}break}if(u>0&&u<=1114111&&Number.isInteger(u)){if(r&&u===+l){const d=jp(r);if(d&&(c=d[l])){i[l]=String.fromCharCode(o[c]);continue}}i[l]=String.fromCodePoint(u)}}return i}async buildToUnicode(e){var t,i;if(e.hasIncludedToUnicodeMap=((t=e.toUnicode)==null?void 0:t.length)>0,e.hasIncludedToUnicodeMap)return!e.composite&&e.hasEncoding&&(e.fallbackToUnicode=this._simpleFontToUnicode(e)),e.toUnicode;if(!e.composite)return new cp(this._simpleFontToUnicode(e));if(e.composite&&(e.cMap.builtInCMap&&!(e.cMap instanceof i1)||((i=e.cidSystemInfo)==null?void 0:i.registry)==="Adobe"&&(e.cidSystemInfo.ordering==="GB1"||e.cidSystemInfo.ordering==="CNS1"||e.cidSystemInfo.ordering==="Japan1"||e.cidSystemInfo.ordering==="Korea1"))){const{registry:s,ordering:r}=e.cidSystemInfo,a=ve.get(`${s}-${r}-UCS2`),o=await Xx.create({encoding:a,fetchBuiltInCMap:this._fetchBuiltInCMapBound,useCMap:null}),l=[],c=[];return e.cMap.forEach(function(h,u){if(u>65535)throw new Te("Max size of CID is 65,535");const d=o.lookup(u);if(d){c.length=0;for(let f=0,g=d.length;f<g;f+=2)c.push((d.charCodeAt(f)<<8)+d.charCodeAt(f+1));l[h]=String.fromCharCode(...c)}}),new cp(l)}return new uo(e.firstChar,e.lastChar)}async readToUnicode(e){if(!e)return null;if(e instanceof ve){const t=await Xx.create({encoding:e,fetchBuiltInCMap:this._fetchBuiltInCMapBound,useCMap:null});return t instanceof i1?new uo(0,65535):new cp(t.getMap())}if(e instanceof un)try{const t=await Xx.create({encoding:e,fetchBuiltInCMap:this._fetchBuiltInCMapBound,useCMap:null});if(t instanceof i1)return new uo(0,65535);const i=new Array(t.length);return t.forEach(function(s,r){if(typeof r=="number"){i[s]=String.fromCodePoint(r);return}r.length%2!==0&&(r="\0"+r);const a=[];for(let o=0;o<r.length;o+=2){const l=r.charCodeAt(o)<<8|r.charCodeAt(o+1);if((l&63488)!==55296){a.push(l);continue}o+=2;const c=r.charCodeAt(o)<<8|r.charCodeAt(o+1);a.push(((l&1023)<<10)+(c&1023)+65536)}i[s]=String.fromCodePoint(...a)}),new cp(i)}catch(t){if(t instanceof rr)return null;if(this.options.ignoreErrors)return ce(`readToUnicode - ignoring ToUnicode data: "${t}".`),null;throw t}return null}readCidToGidMap(e,t){const i=[];for(let s=0,r=e.length;s<r;s++){const a=e[s++]<<8|e[s],o=s>>1;a===0&&!t.has(o)||(i[o]=a)}return i}extractWidths(e,t,i){const s=this.xref;let r=[],a=0;const o=[];let l;if(i.composite){const u=e.get("DW");a=typeof u=="number"?Math.ceil(u):1e3;const d=e.get("W");if(Array.isArray(d))for(let f=0,g=d.length;f<g;f++){let m=s.fetchIfRef(d[f++]);if(!Number.isInteger(m))break;const x=s.fetchIfRef(d[f]);if(Array.isArray(x))for(const p of x){const y=s.fetchIfRef(p);typeof y=="number"&&(r[m]=y),m++}else if(Number.isInteger(x)){const p=s.fetchIfRef(d[++f]);if(typeof p!="number")continue;for(let y=m;y<=x;y++)r[y]=p}else break}if(i.vertical){const f=e.getArray("DW2");let g=Vr(f,2)?f:[880,-1e3];if(l=[g[1],a*.5,g[0]],g=e.get("W2"),Array.isArray(g))for(let m=0,x=g.length;m<x;m++){let p=s.fetchIfRef(g[m++]);if(!Number.isInteger(p))break;const y=s.fetchIfRef(g[m]);if(Array.isArray(y))for(let w=0,_=y.length;w<_;w++){const v=[s.fetchIfRef(y[w++]),s.fetchIfRef(y[w++]),s.fetchIfRef(y[w])];Vr(v,null)&&(o[p]=v),p++}else if(Number.isInteger(y)){const w=[s.fetchIfRef(g[++m]),s.fetchIfRef(g[++m]),s.fetchIfRef(g[++m])];if(!Vr(w,null))continue;for(let _=p;_<=y;_++)o[_]=w}else break}}}else{const u=e.get("Widths");if(Array.isArray(u)){let d=i.firstChar;for(const g of u){const m=s.fetchIfRef(g);typeof m=="number"&&(r[d]=m),d++}const f=t.get("MissingWidth");a=typeof f=="number"?f:0}else{const d=e.get("BaseFont");if(d instanceof ve){const f=this.getBaseFontMetrics(d.name);r=this.buildCharCodeToWidth(f.widths,i),a=f.defaultWidth}}}let c=!0,h=a;for(const u in r){const d=r[u];if(d){if(!h){h=d;continue}if(h!==d){c=!1;break}}}c?i.flags|=lo.FixedPitch:i.flags&=~lo.FixedPitch,i.defaultWidth=a,i.widths=r,i.defaultVMetrics=l,i.vmetrics=o}isSerifFont(e){const t=e.split("-",1)[0];return t in T4()||/serif/gi.test(t)}getBaseFontMetrics(e){let t=0,i=Object.create(null),s=!1,a=iy()[e]||e;const o=Fz();a in o||(a=this.isSerifFont(e)?"Times-Roman":"Helvetica");const l=o[a];return typeof l=="number"?(t=l,s=!0):i=l(),{defaultWidth:t,monospace:s,widths:i}}buildCharCodeToWidth(e,t){const i=Object.create(null),s=t.differences,r=t.defaultEncoding;for(let a=0;a<256;a++){if(a in s&&e[s[a]]){i[a]=e[s[a]];continue}if(a in r&&e[r[a]]){i[a]=e[r[a]];continue}}return i}preEvaluateFont(e){const t=e;let i=e.get("Subtype");if(!(i instanceof ve))throw new Te("invalid font Subtype");let s=!1,r;if(i.name==="Type0"){const h=e.get("DescendantFonts");if(!h)throw new Te("Descendant fonts are not specified");if(e=Array.isArray(h)?this.xref.fetchIfRef(h[0]):h,!(e instanceof fe))throw new Te("Descendant font is not a dictionary.");if(i=e.get("Subtype"),!(i instanceof ve))throw new Te("invalid font Subtype");s=!0}let a=e.get("FirstChar");Number.isInteger(a)||(a=0);let o=e.get("LastChar");Number.isInteger(o)||(o=s?65535:255);const l=e.get("FontDescriptor"),c=e.get("ToUnicode")||t.get("ToUnicode");if(l){r=new _G;const h=t.getRaw("Encoding");if(h instanceof ve)r.update(h.name);else if(h instanceof st)r.update(h.toString());else if(h instanceof fe){for(const d of h.getRawValues())if(d instanceof ve)r.update(d.name);else if(d instanceof st)r.update(d.toString());else if(Array.isArray(d)){const f=d.length,g=new Array(f);for(let m=0;m<f;m++){const x=d[m];x instanceof ve?g[m]=x.name:(typeof x=="number"||x instanceof st)&&(g[m]=x.toString())}r.update(g.join())}}if(r.update(`${a}-${o}`),c instanceof un){const d=c.str||c,f=d.buffer?new Uint8Array(d.buffer.buffer,0,d.bufferLength):new Uint8Array(d.bytes.buffer,d.start,d.end-d.start);r.update(f)}else c instanceof ve&&r.update(c.name);const u=e.get("Widths")||t.get("Widths");if(Array.isArray(u)){const d=[];for(const f of u)(typeof f=="number"||f instanceof st)&&d.push(f.toString());r.update(d.join())}if(s){r.update("compositeFont");const d=e.get("W")||t.get("W");if(Array.isArray(d)){const g=[];for(const m of d)if(typeof m=="number"||m instanceof st)g.push(m.toString());else if(Array.isArray(m)){const x=[];for(const p of m)(typeof p=="number"||p instanceof st)&&x.push(p.toString());g.push(`[${x.join()}]`)}r.update(g.join())}const f=e.getRaw("CIDToGIDMap")||t.getRaw("CIDToGIDMap");f instanceof ve?r.update(f.name):f instanceof st?r.update(f.toString()):f instanceof un&&r.update(f.peekBytes())}}return{descriptor:l,dict:e,baseDict:t,composite:s,type:i.name,firstChar:a,lastChar:o,toUnicode:c,hash:r?r.hexdigest():""}}async translateFont({descriptor:e,dict:t,baseDict:i,composite:s,type:r,firstChar:a,lastChar:o,toUnicode:l,cssFontInfo:c}){const h=r==="Type3";if(!e)if(h)e=fe.empty;else{let L=t.get("BaseFont");if(!(L instanceof ve))throw new Te("Base font is not specified");L=L.name.replaceAll(/[,_]/g,"-");const Y=this.getBaseFontMetrics(L),j=L.split("-",1)[0],J=(this.isSerifFont(j)?lo.Serif:0)|(Y.monospace?lo.FixedPitch:0)|(K7()[j]?lo.Symbolic:lo.Nonsymbolic),G={type:r,name:L,loadedName:i.loadedName,systemFontInfo:null,widths:Y.widths,defaultWidth:Y.defaultWidth,isSimulatedFlags:!0,flags:J,firstChar:a,lastChar:o,toUnicode:l,xHeight:0,capHeight:0,italicAngle:0,isType3Font:h},se=t.get("Widths"),de=gk(L);let he=null;de&&(he=await this.fetchStandardFontData(de),G.isInternalFont=!!he),!G.isInternalFont&&this.options.useSystemFonts&&(G.systemFontInfo=qk(this.systemFontCache,this.idFactory,this.options.standardFontDataUrl,L,de,r));const we=await this.extractDataStructures(t,G);if(Array.isArray(se)){const ye=[];let P=a;for(const V of se){const re=this.xref.fetchIfRef(V);typeof re=="number"&&(ye[P]=re),P++}we.widths=ye}else we.widths=this.buildCharCodeToWidth(Y.widths,we);return new Pk(L,he,we,this.options)}let u=e.get("FontName"),d=t.get("BaseFont");typeof u=="string"&&(u=ve.get(u)),typeof d=="string"&&(d=ve.get(d));const f=u==null?void 0:u.name,g=d==null?void 0:d.name;if(h?f||(u=ve.get(r)):f!==g&&(gn(`The FontDescriptor's FontName is "${f}" but should be the same as the Font's BaseFont "${g}".`),f&&g&&(g.startsWith(f)||!mk(f)&&mk(g))&&(u=null),u||(u=d)),!(u instanceof ve))throw new Te("invalid font name");let m,x,p,y,w;try{if(m=e.get("FontFile","FontFile2","FontFile3"),m)if(m instanceof un){if(m.isEmpty)throw new Te("FontFile is empty")}else throw new Te("FontFile should be a stream")}catch(L){if(!this.options.ignoreErrors)throw L;ce(`translateFont - fetching "${u.name}" font file: "${L}".`),m=null}let _=!1,v=null,C=null;if(m){if(m.dict){const L=m.dict.get("Subtype");L instanceof ve&&(x=L.name),p=m.dict.get("Length1"),y=m.dict.get("Length2"),w=m.dict.get("Length3")}}else if(c){const L=N4(u.name);L&&(c.fontFamily=`${c.fontFamily}-PdfJS-XFA`,c.metrics=L.metrics||null,v=L.factors||null,m=await this.fetchStandardFontData(L.name),_=!!m,i=t=XR(u.name),s=!0)}else if(!h){const L=gk(u.name);L&&(m=await this.fetchStandardFontData(L),_=!!m),!_&&this.options.useSystemFonts&&(C=qk(this.systemFontCache,this.idFactory,this.options.standardFontDataUrl,u.name,L,r))}const k=Th(t.getArray("FontMatrix"),Ld),I=y0(e.getArray("FontBBox")||t.getArray("FontBBox"),h?[0,0,0,0]:void 0);let S=e.get("Ascent");typeof S!="number"&&(S=void 0);let M=e.get("Descent");typeof M!="number"&&(M=void 0);let N=e.get("XHeight");typeof N!="number"&&(N=0);let F=e.get("CapHeight");typeof F!="number"&&(F=0);let H=e.get("Flags");Number.isInteger(H)||(H=0);let T=e.get("ItalicAngle");typeof T!="number"&&(T=0);const z={type:r,name:u.name,subtype:x,file:m,length1:p,length2:y,length3:w,isInternalFont:_,loadedName:i.loadedName,composite:s,fixedPitch:!1,fontMatrix:k,firstChar:a,lastChar:o,toUnicode:l,bbox:I,ascent:S,descent:M,xHeight:N,capHeight:F,flags:H,italicAngle:T,isType3Font:h,cssFontInfo:c,scaleFactors:v,systemFontInfo:C};if(s){const L=i.get("Encoding");L instanceof ve&&(z.cidEncoding=L.name);const Y=await Xx.create({encoding:L,fetchBuiltInCMap:this._fetchBuiltInCMapBound,useCMap:null});z.cMap=Y,z.vertical=z.cMap.vertical}const R=await this.extractDataStructures(t,z);return this.extractWidths(t,e,R),new Pk(u.name,m,R,this.options)}static buildFontPaths(e,t,i,s){function r(a){const o=`${e.loadedName}_path_${a}`;try{if(e.renderer.hasBuiltPath(a))return;i.send("commonobj",[o,"FontPath",e.renderer.getPathJs(a)])}catch(l){if(s.ignoreErrors){ce(`buildFontPaths - ignoring ${o} glyph: "${l}".`);return}throw l}}for(const a of t){r(a.fontChar);const o=a.accent;o!=null&&o.fontChar&&r(o.fontChar)}}static get fallbackFontDict(){const e=new fe;return e.set("BaseFont",ve.get("Helvetica")),e.set("Type",ve.get("FallbackType")),e.set("Subtype",ve.get("FallbackType")),e.set("Encoding",ve.get("WinAnsiEncoding")),Ze(this,"fallbackFontDict",e)}}var Yb,Pd,Vg,eM,tM;class Rw{constructor({loadedName:e,font:t,dict:i}){B(this,Vg);B(this,Yb,!1);B(this,Pd,null);this.loadedName=e,this.font=t,this.dict=i,this.type3Dependencies=t.isType3Font?new Set:null}send(e){b(this,Yb)||(O(this,Yb,!0),e.send("commonobj",[this.loadedName,"Font",this.font.exportData()]))}fallback(e,t){this.font.data&&(this.font.disableFontFace=!0,Rg.buildFontPaths(this.font,this.font.glyphCacheValues,e,t))}loadType3Data(e,t,i){if(b(this,Pd))return b(this,Pd);const{font:s,type3Dependencies:r}=this;Hs(s.isType3Font,"Must be a Type3 font.");const a=e.clone({ignoreErrors:!1}),o=new Zi(e.type3FontRefs);this.dict.objId&&!o.has(this.dict.objId)&&o.put(this.dict.objId),a.type3FontRefs=o;let l=Promise.resolve();const c=this.dict.get("CharProcs"),h=this.dict.get("Resources")||t,u=Object.create(null),[d,f,g,m]=s.bbox,x=g-d,p=m-f,y=Math.hypot(x,p);for(const w of c.getKeys())l=l.then(()=>{const _=c.get(w),v=new Sr;return a.getOperatorList({stream:_,task:i,resources:h,operatorList:v}).then(()=>{switch(v.fnArray[0]){case ie.setCharWidthAndBounds:D(this,Vg,eM).call(this,v,y);break;case ie.setCharWidth:y||D(this,Vg,tM).call(this,v);break}u[w]=v.getIR();for(const C of v.dependencies)r.add(C)}).catch(function(C){ce(`Type3 font resource "${w}" is not available.`);const k=new Sr;u[w]=k.getIR()})});return O(this,Pd,l.then(()=>{s.charProcOperatorList=u,this._bbox&&(s.isCharBBox=!0,s.bbox=this._bbox)})),b(this,Pd)}}Yb=new WeakMap,Pd=new WeakMap,Vg=new WeakSet,eM=function(e,t=NaN){const i=Dn.normalizeRect(e.argsArray[0].slice(2)),s=i[2]-i[0],r=i[3]-i[1],a=Math.hypot(s,r);s===0||r===0?(e.fnArray.splice(0,1),e.argsArray.splice(0,1)):(t===0||Math.round(a/t)>=10)&&(this._bbox??(this._bbox=[1/0,1/0,-1/0,-1/0]),Dn.rectBoundingBox(...i,this._bbox));let o=0,l=e.length;for(;o<l;){switch(e.fnArray[o]){case ie.setCharWidthAndBounds:break;case ie.setStrokeColorSpace:case ie.setFillColorSpace:case ie.setStrokeColor:case ie.setStrokeColorN:case ie.setFillColor:case ie.setFillColorN:case ie.setStrokeGray:case ie.setFillGray:case ie.setStrokeRGBColor:case ie.setFillRGBColor:case ie.setStrokeCMYKColor:case ie.setFillCMYKColor:case ie.shadingFill:case ie.setRenderingIntent:e.fnArray.splice(o,1),e.argsArray.splice(o,1),l--;continue;case ie.setGState:const[c]=e.argsArray[o];let h=0,u=c.length;for(;h<u;){const[d]=c[h];switch(d){case"TR":case"TR2":case"HT":case"BG":case"BG2":case"UCR":case"UCR2":c.splice(h,1),u--;continue}h++}break}o++}},tM=function(e){let t=1;const i=e.length;for(;t<i;){switch(e.fnArray[t]){case ie.constructPath:const s=e.argsArray[t][2];this._bbox??(this._bbox=[1/0,1/0,-1/0,-1/0]),Dn.rectBoundingBox(...s,this._bbox);break}t++}};class a3{constructor(e=new nM){this.state=e,this.stateStack=[]}save(){const e=this.state;this.stateStack.push(this.state),this.state=e.clone()}restore(){const e=this.stateStack.pop();e&&(this.state=e)}transform(e){this.state.ctm=Dn.transform(this.state.ctm,e)}}class CG{constructor(){this.ctm=new Float32Array(el),this.fontName=null,this.fontSize=0,this.loadedName=null,this.font=null,this.fontMatrix=Ld,this.textMatrix=el.slice(),this.textLineMatrix=el.slice(),this.charSpacing=0,this.wordSpacing=0,this.leading=0,this.textHScale=1,this.textRise=0}setTextMatrix(e,t,i,s,r,a){const o=this.textMatrix;o[0]=e,o[1]=t,o[2]=i,o[3]=s,o[4]=r,o[5]=a}setTextLineMatrix(e,t,i,s,r,a){const o=this.textLineMatrix;o[0]=e,o[1]=t,o[2]=i,o[3]=s,o[4]=r,o[5]=a}translateTextMatrix(e,t){const i=this.textMatrix;i[4]=i[0]*e+i[2]*t+i[4],i[5]=i[1]*e+i[3]*t+i[5]}translateTextLineMatrix(e,t){const i=this.textLineMatrix;i[4]=i[0]*e+i[2]*t+i[4],i[5]=i[1]*e+i[3]*t+i[5]}carriageReturn(){this.translateTextLineMatrix(0,-this.leading),this.textMatrix=this.textLineMatrix.slice()}clone(){const e=Object.create(this);return e.textMatrix=this.textMatrix.slice(),e.textLineMatrix=this.textLineMatrix.slice(),e.fontMatrix=this.fontMatrix.slice(),e}}class nM{constructor(){this.ctm=new Float32Array(el),this.font=null,this.textRenderingMode=nR.FILL,this._fillColorSpace=this._strokeColorSpace=Nn.gray,this.patternFillColorSpace=null,this.patternStrokeColorSpace=null,this.currentPointX=this.currentPointY=0,this.pathMinMax=new Float32Array([1/0,1/0,-1/0,-1/0]),this.pathBuffer=[]}get fillColorSpace(){return this._fillColorSpace}set fillColorSpace(e){this._fillColorSpace=this.patternFillColorSpace=e}get strokeColorSpace(){return this._strokeColorSpace}set strokeColorSpace(e){this._strokeColorSpace=this.patternStrokeColorSpace=e}clone({newPath:e=!1}={}){const t=Object.create(this);return e&&(t.pathBuffer=[],t.pathMinMax=new Float32Array([1/0,1/0,-1/0,-1/0])),t}}const Wf=class Wf{static get opMap(){return Ze(this,"opMap",Object.assign(Object.create(null),{w:{id:ie.setLineWidth,numArgs:1,variableArgs:!1},J:{id:ie.setLineCap,numArgs:1,variableArgs:!1},j:{id:ie.setLineJoin,numArgs:1,variableArgs:!1},M:{id:ie.setMiterLimit,numArgs:1,variableArgs:!1},d:{id:ie.setDash,numArgs:2,variableArgs:!1},ri:{id:ie.setRenderingIntent,numArgs:1,variableArgs:!1},i:{id:ie.setFlatness,numArgs:1,variableArgs:!1},gs:{id:ie.setGState,numArgs:1,variableArgs:!1},q:{id:ie.save,numArgs:0,variableArgs:!1},Q:{id:ie.restore,numArgs:0,variableArgs:!1},cm:{id:ie.transform,numArgs:6,variableArgs:!1},m:{id:ie.moveTo,numArgs:2,variableArgs:!1},l:{id:ie.lineTo,numArgs:2,variableArgs:!1},c:{id:ie.curveTo,numArgs:6,variableArgs:!1},v:{id:ie.curveTo2,numArgs:4,variableArgs:!1},y:{id:ie.curveTo3,numArgs:4,variableArgs:!1},h:{id:ie.closePath,numArgs:0,variableArgs:!1},re:{id:ie.rectangle,numArgs:4,variableArgs:!1},S:{id:ie.stroke,numArgs:0,variableArgs:!1},s:{id:ie.closeStroke,numArgs:0,variableArgs:!1},f:{id:ie.fill,numArgs:0,variableArgs:!1},F:{id:ie.fill,numArgs:0,variableArgs:!1},"f*":{id:ie.eoFill,numArgs:0,variableArgs:!1},B:{id:ie.fillStroke,numArgs:0,variableArgs:!1},"B*":{id:ie.eoFillStroke,numArgs:0,variableArgs:!1},b:{id:ie.closeFillStroke,numArgs:0,variableArgs:!1},"b*":{id:ie.closeEOFillStroke,numArgs:0,variableArgs:!1},n:{id:ie.endPath,numArgs:0,variableArgs:!1},W:{id:ie.clip,numArgs:0,variableArgs:!1},"W*":{id:ie.eoClip,numArgs:0,variableArgs:!1},BT:{id:ie.beginText,numArgs:0,variableArgs:!1},ET:{id:ie.endText,numArgs:0,variableArgs:!1},Tc:{id:ie.setCharSpacing,numArgs:1,variableArgs:!1},Tw:{id:ie.setWordSpacing,numArgs:1,variableArgs:!1},Tz:{id:ie.setHScale,numArgs:1,variableArgs:!1},TL:{id:ie.setLeading,numArgs:1,variableArgs:!1},Tf:{id:ie.setFont,numArgs:2,variableArgs:!1},Tr:{id:ie.setTextRenderingMode,numArgs:1,variableArgs:!1},Ts:{id:ie.setTextRise,numArgs:1,variableArgs:!1},Td:{id:ie.moveText,numArgs:2,variableArgs:!1},TD:{id:ie.setLeadingMoveText,numArgs:2,variableArgs:!1},Tm:{id:ie.setTextMatrix,numArgs:6,variableArgs:!1},"T*":{id:ie.nextLine,numArgs:0,variableArgs:!1},Tj:{id:ie.showText,numArgs:1,variableArgs:!1},TJ:{id:ie.showSpacedText,numArgs:1,variableArgs:!1},"'":{id:ie.nextLineShowText,numArgs:1,variableArgs:!1},'"':{id:ie.nextLineSetSpacingShowText,numArgs:3,variableArgs:!1},d0:{id:ie.setCharWidth,numArgs:2,variableArgs:!1},d1:{id:ie.setCharWidthAndBounds,numArgs:6,variableArgs:!1},CS:{id:ie.setStrokeColorSpace,numArgs:1,variableArgs:!1},cs:{id:ie.setFillColorSpace,numArgs:1,variableArgs:!1},SC:{id:ie.setStrokeColor,numArgs:4,variableArgs:!0},SCN:{id:ie.setStrokeColorN,numArgs:33,variableArgs:!0},sc:{id:ie.setFillColor,numArgs:4,variableArgs:!0},scn:{id:ie.setFillColorN,numArgs:33,variableArgs:!0},G:{id:ie.setStrokeGray,numArgs:1,variableArgs:!1},g:{id:ie.setFillGray,numArgs:1,variableArgs:!1},RG:{id:ie.setStrokeRGBColor,numArgs:3,variableArgs:!1},rg:{id:ie.setFillRGBColor,numArgs:3,variableArgs:!1},K:{id:ie.setStrokeCMYKColor,numArgs:4,variableArgs:!1},k:{id:ie.setFillCMYKColor,numArgs:4,variableArgs:!1},sh:{id:ie.shadingFill,numArgs:1,variableArgs:!1},BI:{id:ie.beginInlineImage,numArgs:0,variableArgs:!1},ID:{id:ie.beginImageData,numArgs:0,variableArgs:!1},EI:{id:ie.endInlineImage,numArgs:1,variableArgs:!1},Do:{id:ie.paintXObject,numArgs:1,variableArgs:!1},MP:{id:ie.markPoint,numArgs:1,variableArgs:!1},DP:{id:ie.markPointProps,numArgs:2,variableArgs:!1},BMC:{id:ie.beginMarkedContent,numArgs:1,variableArgs:!1},BDC:{id:ie.beginMarkedContentProps,numArgs:2,variableArgs:!1},EMC:{id:ie.endMarkedContent,numArgs:0,variableArgs:!1},BX:{id:ie.beginCompat,numArgs:0,variableArgs:!1},EX:{id:ie.endCompat,numArgs:0,variableArgs:!1},BM:null,BD:null,true:null,fa:null,fal:null,fals:null,false:null,nu:null,nul:null,null:null}))}constructor(e,t,i=new a3){this.parser=new R0({lexer:new Wo(e,Wf.opMap),xref:t}),this.stateManager=i,this.nonProcessedArgs=[],this._isPathOp=!1,this._numInvalidPathOPS=0}get savedStatesDepth(){return this.stateManager.stateStack.length}read(e){let t=e.args;for(;;){const i=this.parser.getObj();if(i instanceof ss){const s=i.cmd,r=Wf.opMap[s];if(!r){ce(`Unknown command "${s}".`);continue}const a=r.id,o=r.numArgs;let l=t!==null?t.length:0;if(this._isPathOp||(this._numInvalidPathOPS=0),this._isPathOp=a>=ie.moveTo&&a<=ie.endPath,r.variableArgs)l>o&&gn(`Command ${s}: expected [0, ${o}] args, but received ${l} args.`);else{if(l!==o){const c=this.nonProcessedArgs;for(;l>o;)c.push(t.shift()),l--;for(;l<o&&c.length!==0;)t===null&&(t=[]),t.unshift(c.pop()),l++}if(l<o){const c=`command ${s}: expected ${o} args, but received ${l} args.`;if(this._isPathOp&&++this._numInvalidPathOPS>Wf.MAX_INVALID_PATH_OPS)throw new Te(`Invalid ${c}`);ce(`Skipping ${c}`),t!==null&&(t.length=0);continue}}return this.preprocessCommand(a,t),e.fn=a,e.args=t,!0}if(i===Bs)return!1;if(i!==null&&(t===null&&(t=[]),t.push(i),t.length>33))throw new Te("Too many arguments")}}preprocessCommand(e,t){switch(e|0){case ie.save:this.stateManager.save();break;case ie.restore:this.stateManager.restore();break;case ie.transform:this.stateManager.transform(t);break}}};He(Wf,"MAX_INVALID_PATH_OPS",10);let Mg=Wf;class AG extends Mg{constructor(e){super(new Jr(e))}parse(){const e={fn:0,args:[]},t={fontSize:0,fontName:"",fontColor:new Uint8ClampedArray(3)};try{for(;e.args.length=0,!!this.read(e);){if(this.savedStatesDepth!==0)continue;const{fn:i,args:s}=e;switch(i|0){case ie.setFont:const[r,a]=s;r instanceof ve&&(t.fontName=r.name),typeof a=="number"&&a>0&&(t.fontSize=a);break;case ie.setFillRGBColor:Nn.rgb.getRgbItem(s,0,t.fontColor,0);break;case ie.setFillGray:Nn.gray.getRgbItem(s,0,t.fontColor,0);break;case ie.setFillCMYKColor:Nn.cmyk.getRgbItem(s,0,t.fontColor,0);break}}}catch(i){ce(`parseDefaultAppearance - ignoring errors: "${i}".`)}return t}}function D4(n){return new AG(n).parse()}class SG extends Mg{constructor(e,t,i,s){var r;super(e),this.stream=e,this.evaluatorOptions=t,this.xref=i,this.globalColorSpaceCache=s,this.resources=(r=e.dict)==null?void 0:r.get("Resources")}parse(){const e={fn:0,args:[]};let t={scaleFactor:1,fontSize:0,fontName:"",fontColor:new Uint8ClampedArray(3),fillColorSpace:Nn.gray},i=!1;const s=[];try{for(;e.args.length=0,!(i||!this.read(e));){const{fn:r,args:a}=e;switch(r|0){case ie.save:s.push({scaleFactor:t.scaleFactor,fontSize:t.fontSize,fontName:t.fontName,fontColor:t.fontColor.slice(),fillColorSpace:t.fillColorSpace});break;case ie.restore:t=s.pop()||t;break;case ie.setTextMatrix:t.scaleFactor*=Math.hypot(a[0],a[1]);break;case ie.setFont:const[o,l]=a;o instanceof ve&&(t.fontName=o.name),typeof l=="number"&&l>0&&(t.fontSize=l*t.scaleFactor);break;case ie.setFillColorSpace:t.fillColorSpace=Nn.parse({cs:a[0],xref:this.xref,resources:this.resources,pdfFunctionFactory:this._pdfFunctionFactory,globalColorSpaceCache:this.globalColorSpaceCache,localColorSpaceCache:this._localColorSpaceCache});break;case ie.setFillColor:t.fillColorSpace.getRgbItem(a,0,t.fontColor,0);break;case ie.setFillRGBColor:Nn.rgb.getRgbItem(a,0,t.fontColor,0);break;case ie.setFillGray:Nn.gray.getRgbItem(a,0,t.fontColor,0);break;case ie.setFillCMYKColor:Nn.cmyk.getRgbItem(a,0,t.fontColor,0);break;case ie.showText:case ie.showSpacedText:case ie.nextLineShowText:case ie.nextLineSetSpacingShowText:i=!0;break}}}catch(r){ce(`parseAppearanceStream - ignoring errors: "${r}".`)}return this.stream.reset(),delete t.scaleFactor,delete t.fillColorSpace,t}get _localColorSpaceCache(){return Ze(this,"_localColorSpaceCache",new YR)}get _pdfFunctionFactory(){const e=new ZR({xref:this.xref,isEvalSupported:this.evaluatorOptions.isEvalSupported});return Ze(this,"_pdfFunctionFactory",e)}}function IG(n,e,t,i){return new SG(n,e,t,i).parse()}function sc(n,e){if(n[0]===n[1]&&n[1]===n[2]){const t=n[0]/255;return`${vn(t)} ${e?"g":"G"}`}return Array.from(n,t=>vn(t/255)).join(" ")+` ${e?"rg":"RG"}`}function EG({fontSize:n,fontName:e,fontColor:t}){return`/${w4(e)} ${n} Tf ${sc(t,!0)}`}class Vl{constructor(e,t){this.xref=e,this.widths=null,this.firstChar=1/0,this.lastChar=-1/0,this.fontFamily=t;const i=new OffscreenCanvas(1,1);this.ctxMeasure=i.getContext("2d",{willReadFrequently:!0}),Vl._fontNameId||(Vl._fontNameId=1),this.fontName=ve.get(`InvalidPDFjsFont_${t}_${Vl._fontNameId++}`)}get fontDescriptorRef(){if(!Vl._fontDescriptorRef){const e=new fe(this.xref);e.set("Type",ve.get("FontDescriptor")),e.set("FontName",this.fontName),e.set("FontFamily","MyriadPro Regular"),e.set("FontBBox",[0,0,0,0]),e.set("FontStretch",ve.get("Normal")),e.set("FontWeight",400),e.set("ItalicAngle",0),Vl._fontDescriptorRef=this.xref.getNewPersistentRef(e)}return Vl._fontDescriptorRef}get descendantFontRef(){const e=new fe(this.xref);e.set("BaseFont",this.fontName),e.set("Type",ve.get("Font")),e.set("Subtype",ve.get("CIDFontType0")),e.set("CIDToGIDMap",ve.get("Identity")),e.set("FirstChar",this.firstChar),e.set("LastChar",this.lastChar),e.set("FontDescriptor",this.fontDescriptorRef),e.set("DW",1e3);const t=[],i=[...this.widths.entries()].sort();let s=null,r=null;for(const[o,l]of i){if(!s){s=o,r=[l];continue}o===s+r.length?r.push(l):(t.push(s,r),s=o,r=[l])}s&&t.push(s,r),e.set("W",t);const a=new fe(this.xref);return a.set("Ordering","Identity"),a.set("Registry","Adobe"),a.set("Supplement",0),e.set("CIDSystemInfo",a),this.xref.getNewPersistentRef(e)}get baseFontRef(){const e=new fe(this.xref);return e.set("BaseFont",this.fontName),e.set("Type",ve.get("Font")),e.set("Subtype",ve.get("Type0")),e.set("Encoding",ve.get("Identity-H")),e.set("DescendantFonts",[this.descendantFontRef]),e.set("ToUnicode",ve.get("Identity-H")),this.xref.getNewPersistentRef(e)}get resources(){const e=new fe(this.xref),t=new fe(this.xref);return t.set(this.fontName.name,this.baseFontRef),e.set("Font",t),e}_createContext(){return this.widths=new Map,this.ctxMeasure.font=`1000px ${this.fontFamily}`,this.ctxMeasure}createFontResources(e){const t=this._createContext();for(const i of e.split(/\r\n?|\n/))for(const s of i.split("")){const r=s.charCodeAt(0);if(this.widths.has(r))continue;const a=t.measureText(s),o=Math.ceil(a.width);this.widths.set(r,o),this.firstChar=Math.min(r,this.firstChar),this.lastChar=Math.max(r,this.lastChar)}return this.resources}static getFirstPositionInfo(e,t,i){const[s,r,a,o]=e;let l=a-s,c=o-r;t%180!==0&&([l,c]=[c,l]);const h=a0*i,u=A3*i;return{coords:[0,c+u-h],bbox:[0,0,l,c],matrix:t!==0?T3(t,c,h):void 0}}createAppearance(e,t,i,s,r,a){const o=this._createContext(),l=[];let c=-1/0;for(const H of e.split(/\r\n?|\n/)){l.push(H);const T=o.measureText(H).width;c=Math.max(c,T);for(const z of IU(H)){const R=String.fromCodePoint(z);let L=this.widths.get(z);if(L===void 0){const Y=o.measureText(R);L=Math.ceil(Y.width),this.widths.set(z,L),this.firstChar=Math.min(z,this.firstChar),this.lastChar=Math.max(z,this.lastChar)}}}c*=s/1e3;const[h,u,d,f]=t;let g=d-h,m=f-u;i%180!==0&&([g,m]=[m,g]);let x=1;c>g&&(x=g/c);let p=1;const y=a0*s,w=A3*s,_=y*l.length;_>m&&(p=m/_);const v=Math.min(x,p),C=s*v,k=["q",`0 0 ${vn(g)} ${vn(m)} re W n`,"BT",`1 0 0 1 0 ${vn(m+w)} Tm 0 Tc ${sc(r,!0)}`,`/${this.fontName.name} ${vn(C)} Tf`],{resources:I}=this;if(a=typeof a=="number"&&a>=0&&a<=1?a:1,a!==1){k.push("/R0 gs");const H=new fe(this.xref),T=new fe(this.xref);T.set("ca",a),T.set("CA",a),T.set("Type",ve.get("ExtGState")),H.set("R0",T),I.set("ExtGState",H)}const S=vn(y);for(const H of l)k.push(`0 -${S} Td <${RU(H)}> Tj`);k.push("ET","Q");const M=k.join(`
`),N=new fe(this.xref);if(N.set("Subtype",ve.get("Form")),N.set("Type",ve.get("XObject")),N.set("BBox",[0,0,g,m]),N.set("Length",M.length),N.set("Resources",I),i){const H=T3(i,g,m);N.set("Matrix",H)}const F=new Jr(M);return F.dict=N,F}}const TG=["m/d","m/d/yy","mm/dd/yy","mm/yy","d-mmm","d-mmm-yy","dd-mmm-yy","yy-mm-dd","mmm-yy","mmmm-yy","mmm d, yyyy","mmmm d, yyyy","m/d/yy h:MM tt","m/d/yy HH:MM"],RG=["HH:MM","h:MM tt","HH:MM:ss","h:MM:ss tt"];class iM{constructor(e,t,i){this.root=e,this.xref=t,this._type=i}getAll(){const e=new Map;if(!this.root)return e;const t=this.xref,i=new Zi;i.put(this.root);const s=[this.root];for(;s.length>0;){const r=t.fetchIfRef(s.shift());if(!(r instanceof fe))continue;if(r.has("Kids")){const o=r.get("Kids");if(!Array.isArray(o))continue;for(const l of o){if(i.has(l))throw new Te(`Duplicate entry in "${this._type}" tree.`);s.push(l),i.put(l)}continue}const a=r.get(this._type);if(Array.isArray(a))for(let o=0,l=a.length;o<l;o+=2)e.set(t.fetchIfRef(a[o]),t.fetchIfRef(a[o+1]))}return e}getRaw(e){if(!this.root)return null;const t=this.xref;let i=t.fetchIfRef(this.root),s=0;const r=10;for(;i.has("Kids");){if(++s>r)return ce(`Search depth limit reached for "${this._type}" tree.`),null;const o=i.get("Kids");if(!Array.isArray(o))return null;let l=0,c=o.length-1;for(;l<=c;){const h=l+c>>1,u=t.fetchIfRef(o[h]),d=u.get("Limits");if(e<t.fetchIfRef(d[0]))c=h-1;else if(e>t.fetchIfRef(d[1]))l=h+1;else{i=u;break}}if(l>c)return null}const a=i.get(this._type);if(Array.isArray(a)){let o=0,l=a.length-2;for(;o<=l;){const c=o+l>>1,h=c+(c&1),u=t.fetchIfRef(a[h]);if(e<u)l=h-2;else if(e>u)o=h+2;else return a[h+1]}}return null}get(e){return this.xref.fetchIfRef(this.getRaw(e))}}class pf extends iM{constructor(e,t){super(e,t,"Names")}}class O3 extends iM{constructor(e,t){super(e,t,"Nums")}}function F4(){yj(),_U(),gz(),Go.cleanup()}function Jk(n){return n instanceof fe?n.has("UF")?n.get("UF"):n.has("F")?n.get("F"):n.has("Unix")?n.get("Unix"):n.has("Mac")?n.get("Mac"):n.has("DOS")?n.get("DOS"):null:null}function MG(n){return n.substring(n.lastIndexOf("/")+1)}var Jb;class n6{constructor(e,t,i=!1){B(this,Jb,!1);e instanceof fe&&(this.xref=t,this.root=e,e.has("FS")&&(this.fs=e.get("FS")),e.has("RF")&&ce("Related file specifications are not supported"),i||(e.has("EF")?O(this,Jb,!0):ce("Non-embedded file specifications are not supported")))}get filename(){let e="";const t=Jk(this.root);return t&&typeof t=="string"&&(e=Tn(t,!0).replaceAll("\\\\","\\").replaceAll("\\/","/").replaceAll("\\","/")),Ze(this,"filename",e||"unnamed")}get content(){var t;if(!b(this,Jb))return null;this._contentRef||(this._contentRef=Jk((t=this.root)==null?void 0:t.get("EF")));let e=null;if(this._contentRef){const i=this.xref.fetchIfRef(this._contentRef);i instanceof un?e=i.getBytes():ce("Embedded file specification points to non-existing/invalid content")}else ce("Embedded file specification does not have any content");return e}get description(){var i;let e="";const t=(i=this.root)==null?void 0:i.get("Desc");return t&&typeof t=="string"&&(e=Tn(t)),Ze(this,"description",e)}get serializable(){return{rawFilename:this.filename,filename:MG(this.filename),content:this.content,description:this.description}}}Jb=new WeakMap;const la={NoError:0,EndOfDocument:-1,UnterminatedCdat:-2,UnterminatedXmlDeclaration:-3,UnterminatedDoctypeDeclaration:-4,UnterminatedComment:-5,MalformedElement:-6,OutOfMemory:-7,UnterminatedAttributeValue:-8,UnterminatedElement:-9,ElementNeverBegun:-10};function Rf(n,e){const t=n[e];return t===" "||t===`
`||t==="\r"||t==="	"}function PG(n){for(let e=0,t=n.length;e<t;e++)if(!Rf(n,e))return!1;return!0}class sM{_resolveEntities(e){return e.replaceAll(/&([^;]+);/g,(t,i)=>{if(i.substring(0,2)==="#x")return String.fromCodePoint(parseInt(i.substring(2),16));if(i.substring(0,1)==="#")return String.fromCodePoint(parseInt(i.substring(1),10));switch(i){case"lt":return"<";case"gt":return">";case"amp":return"&";case"quot":return'"';case"apos":return"'"}return this.onResolveEntity(i)})}_parseContent(e,t){const i=[];let s=t;function r(){for(;s<e.length&&Rf(e,s);)++s}for(;s<e.length&&!Rf(e,s)&&e[s]!==">"&&e[s]!=="/";)++s;const a=e.substring(t,s);for(r();s<e.length&&e[s]!==">"&&e[s]!=="/"&&e[s]!=="?";){r();let o="",l="";for(;s<e.length&&!Rf(e,s)&&e[s]!=="=";)o+=e[s],++s;if(r(),e[s]!=="=")return null;++s,r();const c=e[s];if(c!=='"'&&c!=="'")return null;const h=e.indexOf(c,++s);if(h<0)return null;l=e.substring(s,h),i.push({name:o,value:this._resolveEntities(l)}),s=h+1,r()}return{name:a,attributes:i,parsed:s-t}}_parseProcessingInstruction(e,t){let i=t;function s(){for(;i<e.length&&Rf(e,i);)++i}for(;i<e.length&&!Rf(e,i)&&e[i]!==">"&&e[i]!=="?"&&e[i]!=="/";)++i;const r=e.substring(t,i);s();const a=i;for(;i<e.length&&(e[i]!=="?"||e[i+1]!==">");)++i;const o=e.substring(a,i);return{name:r,value:o,parsed:i-t}}parseXml(e){let t=0;for(;t<e.length;){const i=e[t];let s=t;if(i==="<"){++s;const r=e[s];let a;switch(r){case"/":if(++s,a=e.indexOf(">",s),a<0){this.onError(la.UnterminatedElement);return}this.onEndElement(e.substring(s,a)),s=a+1;break;case"?":++s;const o=this._parseProcessingInstruction(e,s);if(e.substring(s+o.parsed,s+o.parsed+2)!=="?>"){this.onError(la.UnterminatedXmlDeclaration);return}this.onPi(o.name,o.value),s+=o.parsed+2;break;case"!":if(e.substring(s+1,s+3)==="--"){if(a=e.indexOf("-->",s+3),a<0){this.onError(la.UnterminatedComment);return}this.onComment(e.substring(s+3,a)),s=a+3}else if(e.substring(s+1,s+8)==="[CDATA["){if(a=e.indexOf("]]>",s+8),a<0){this.onError(la.UnterminatedCdat);return}this.onCdata(e.substring(s+8,a)),s=a+3}else if(e.substring(s+1,s+8)==="DOCTYPE"){const h=e.indexOf("[",s+8);let u=!1;if(a=e.indexOf(">",s+8),a<0){this.onError(la.UnterminatedDoctypeDeclaration);return}if(h>0&&a>h){if(a=e.indexOf("]>",s+8),a<0){this.onError(la.UnterminatedDoctypeDeclaration);return}u=!0}const d=e.substring(s+8,a+(u?1:0));this.onDoctype(d),s=a+(u?2:1)}else{this.onError(la.MalformedElement);return}break;default:const l=this._parseContent(e,s);if(l===null){this.onError(la.MalformedElement);return}let c=!1;if(e.substring(s+l.parsed,s+l.parsed+2)==="/>")c=!0;else if(e.substring(s+l.parsed,s+l.parsed+1)!==">"){this.onError(la.UnterminatedElement);return}this.onBeginElement(l.name,l.attributes,c),s+=l.parsed+(c?2:1);break}}else{for(;s<e.length&&e[s]!=="<";)s++;const r=e.substring(t,s);this.onText(this._resolveEntities(r))}t=s}}onResolveEntity(e){return`&${e};`}onPi(e,t){}onComment(e){}onCdata(e){}onDoctype(e){}onText(e){}onBeginElement(e,t,i){}onEndElement(e){}onError(e){}}class bp{constructor(e,t){this.nodeName=e,this.nodeValue=t,Object.defineProperty(this,"parentNode",{value:null,writable:!0})}get firstChild(){var e;return(e=this.childNodes)==null?void 0:e[0]}get nextSibling(){const e=this.parentNode.childNodes;if(!e)return;const t=e.indexOf(this);if(t!==-1)return e[t+1]}get textContent(){return this.childNodes?this.childNodes.map(e=>e.textContent).join(""):this.nodeValue||""}get children(){return this.childNodes||[]}hasChildNodes(){var e;return((e=this.childNodes)==null?void 0:e.length)>0}searchNode(e,t){var a;if(t>=e.length)return this;const i=e[t];if(i.name.startsWith("#")&&t<e.length-1)return this.searchNode(e,t+1);const s=[];let r=this;for(;;){if(i.name===r.nodeName)if(i.pos===0){const o=r.searchNode(e,t+1);if(o!==null)return o}else{if(s.length===0)return null;{const[o]=s.pop();let l=0;for(const c of o.childNodes)if(i.name===c.nodeName){if(l===i.pos)return c.searchNode(e,t+1);l++}return r.searchNode(e,t+1)}}if(((a=r.childNodes)==null?void 0:a.length)>0)s.push([r,0]),r=r.childNodes[0];else{if(s.length===0)return null;for(;s.length!==0;){const[o,l]=s.pop(),c=l+1;if(c<o.childNodes.length){s.push([o,c]),r=o.childNodes[c];break}}if(s.length===0)return null}}}dump(e){if(this.nodeName==="#text"){e.push(n1(this.nodeValue));return}if(e.push(`<${this.nodeName}`),this.attributes)for(const t of this.attributes)e.push(` ${t.name}="${n1(t.value)}"`);if(this.hasChildNodes()){e.push(">");for(const t of this.childNodes)t.dump(e);e.push(`</${this.nodeName}>`)}else this.nodeValue?e.push(`>${n1(this.nodeValue)}</${this.nodeName}>`):e.push("/>")}}class sy extends sM{constructor({hasAttributes:e=!1,lowerCaseName:t=!1}){super(),this._currentFragment=null,this._stack=null,this._errorCode=la.NoError,this._hasAttributes=e,this._lowerCaseName=t}parseFromString(e){if(this._currentFragment=[],this._stack=[],this._errorCode=la.NoError,this.parseXml(e),this._errorCode!==la.NoError)return;const[t]=this._currentFragment;if(t)return{documentElement:t}}onText(e){if(PG(e))return;const t=new bp("#text",e);this._currentFragment.push(t)}onCdata(e){const t=new bp("#text",e);this._currentFragment.push(t)}onBeginElement(e,t,i){this._lowerCaseName&&(e=e.toLowerCase());const s=new bp(e);s.childNodes=[],this._hasAttributes&&(s.attributes=t),this._currentFragment.push(s),!i&&(this._stack.push(this._currentFragment),this._currentFragment=s.childNodes)}onEndElement(e){this._currentFragment=this._stack.pop()||[];const t=this._currentFragment.at(-1);if(!t)return null;for(const i of t.childNodes)i.parentNode=t;return t}onError(e){this._errorCode=e}}class NG{constructor(e){e=this._repair(e);const i=new sy({lowerCaseName:!0}).parseFromString(e);this._metadataMap=new Map,this._data=e,i&&this._parse(i)}_repair(e){return e.replace(/^[^<]+/,"").replaceAll(/>\\376\\377([^<]+)/g,function(t,i){const s=i.replaceAll(/\\([0-3])([0-7])([0-7])/g,function(a,o,l,c){return String.fromCharCode(o*64+l*8+c*1)}).replaceAll(/&(amp|apos|gt|lt|quot);/g,function(a,o){switch(o){case"amp":return"&";case"apos":return"'";case"gt":return">";case"lt":return"<";case"quot":return'"'}throw new Error(`_repair: ${o} isn't defined.`)}),r=[">"];for(let a=0,o=s.length;a<o;a+=2){const l=s.charCodeAt(a)*256+s.charCodeAt(a+1);l>=32&&l<127&&l!==60&&l!==62&&l!==38?r.push(String.fromCharCode(l)):r.push("&#x"+(65536+l).toString(16).substring(1)+";")}return r.join("")})}_getSequence(e){const t=e.nodeName;return t!=="rdf:bag"&&t!=="rdf:seq"&&t!=="rdf:alt"?null:e.childNodes.filter(i=>i.nodeName==="rdf:li")}_parseArray(e){if(!e.hasChildNodes())return;const[t]=e.childNodes,i=this._getSequence(t)||[];this._metadataMap.set(e.nodeName,i.map(s=>s.textContent.trim()))}_parse(e){let t=e.documentElement;if(t.nodeName!=="rdf:rdf")for(t=t.firstChild;t&&t.nodeName!=="rdf:rdf";)t=t.nextSibling;if(!(!t||t.nodeName!=="rdf:rdf"||!t.hasChildNodes())){for(const i of t.childNodes)if(i.nodeName==="rdf:description")for(const s of i.childNodes){const r=s.nodeName;switch(r){case"#text":continue;case"dc:creator":case"dc:subject":this._parseArray(s);continue}this._metadataMap.set(r,s.textContent.trim())}}}get serializable(){return{parsedData:this._metadataMap,rawData:this._data}}}const Zk=40,ho={PAGE_CONTENT:1,STREAM_CONTENT:2,OBJECT:3,ANNOTATION:4,ELEMENT:5};var H5,rM,_o,i6,s6,aM,oM;const xu=class xu{constructor(e,t,i){B(this,H5);this.xref=e,this.dict=t,this.ref=i instanceof st?i:null,this.roleMap=new Map,this.structParentIds=null}init(){this.readRoleMap()}addAnnotationIdToPage(e,t){D(this,H5,rM).call(this,e,t,ho.ANNOTATION)}readRoleMap(){const e=this.dict.get("RoleMap");if(e instanceof fe)for(const[t,i]of e)i instanceof ve&&this.roleMap.set(t,i.name)}static async canCreateStructureTree({catalogRef:e,pdfManager:t,newAnnotationsByPage:i}){var a;if(!(e instanceof st))return ce("Cannot save the struct tree: no catalog reference."),!1;let s=0,r=!0;for(const[o,l]of i){const{ref:c}=await t.getPage(o);if(!(c instanceof st)){ce(`Cannot save the struct tree: page ${o} has no ref.`),r=!0;break}for(const h of l)(a=h.accessibilityData)!=null&&a.type&&(h.parentTreeId=s++,r=!1)}if(r){for(const o of i.values())for(const l of o)delete l.parentTreeId;return!1}return!0}static async createStructureTree({newAnnotationsByPage:e,xref:t,catalogRef:i,pdfManager:s,changes:r}){const a=await s.ensureCatalog("cloneDict"),o=new ca;o.put(i,a);const l=t.getNewTemporaryRef();a.set("StructTreeRoot",l);const c=new fe(t);c.set("Type",ve.get("StructTreeRoot"));const h=t.getNewTemporaryRef();c.set("ParentTree",h);const u=[];c.set("K",u),o.put(l,c);const d=new fe(t),f=[];d.set("Nums",f);const g=await D(this,_o,i6).call(this,{newAnnotationsByPage:e,structTreeRootRef:l,structTreeRoot:null,kids:u,nums:f,xref:t,pdfManager:s,changes:r,cache:o});c.set("ParentTreeNextKey",g),o.put(h,d);for(const[m,x]of o.items())r.put(m,{data:x})}async canUpdateStructTree({pdfManager:e,newAnnotationsByPage:t}){var l,c;if(!this.ref)return ce("Cannot update the struct tree: no root reference."),!1;let i=this.dict.get("ParentTreeNextKey");if(!Number.isInteger(i)||i<0)return ce("Cannot update the struct tree: invalid next key."),!1;const s=this.dict.get("ParentTree");if(!(s instanceof fe))return ce("Cannot update the struct tree: ParentTree isn't a dict."),!1;const r=s.get("Nums");if(!Array.isArray(r))return ce("Cannot update the struct tree: nums isn't an array."),!1;const a=new O3(s,this.xref);for(const h of t.keys()){const{pageDict:u}=await e.getPage(h);if(!u.has("StructParents"))continue;const d=u.get("StructParents");if(!Number.isInteger(d)||!Array.isArray(a.get(d)))return ce(`Cannot save the struct tree: page ${h} has a wrong id.`),!1}let o=!0;for(const[h,u]of t){const{pageDict:d}=await e.getPage(h);D(l=xu,_o,aM).call(l,{elements:u,xref:this.xref,pageDict:d,numberTree:a});for(const f of u)(c=f.accessibilityData)!=null&&c.type&&(f.accessibilityData.structParent>=0||(f.parentTreeId=i++),o=!1)}if(o){for(const h of t.values())for(const u of h)delete u.parentTreeId,delete u.structTreeParent;return!1}return!0}async updateStructureTree({newAnnotationsByPage:e,pdfManager:t,changes:i}){var f;const{ref:s,xref:r}=this,a=this.dict.clone(),o=new ca;o.put(s,a);let l=a.getRaw("ParentTree"),c;l instanceof st?c=r.fetch(l):(c=l,l=r.getNewTemporaryRef(),a.set("ParentTree",l)),c=c.clone(),o.put(l,c);let h=c.getRaw("Nums"),u=null;h instanceof st&&(u=h,h=r.fetch(u)),h=h.slice(),u||c.set("Nums",h);const d=await D(f=xu,_o,i6).call(f,{newAnnotationsByPage:e,structTreeRootRef:s,structTreeRoot:this,kids:null,nums:h,xref:r,pdfManager:t,changes:i,cache:o});if(d!==-1){a.set("ParentTreeNextKey",d),u&&o.put(u,h);for(const[g,m]of o.items())i.put(g,{data:m})}}};H5=new WeakSet,rM=function(e,t,i){if(!(e instanceof st)||t<0)return;this.structParentIds||(this.structParentIds=new ca);let s=this.structParentIds.get(e);s||(s=[],this.structParentIds.put(e,s)),s.push([t,i])},_o=new WeakSet,i6=async function({newAnnotationsByPage:e,structTreeRootRef:t,structTreeRoot:i,kids:s,nums:r,xref:a,pdfManager:o,changes:l,cache:c}){var f,g;const h=ve.get("OBJR");let u=-1,d;for(const[m,x]of e){const p=await o.getPage(m),{ref:y}=p,w=y instanceof st;for(const{accessibilityData:_,ref:v,parentTreeId:C,structTreeParent:k}of x){if(!(_!=null&&_.type))continue;const{structParent:I}=_;if(i&&Number.isInteger(I)&&I>=0){let F=(d||(d=new Map)).get(m);F===void 0&&(F=new lM(i,p.pageDict).collectObjects(y),d.set(m,F));const H=F==null?void 0:F.get(I);if(H){const T=a.fetch(H).clone();D(f=xu,_o,s6).call(f,T,_),l.put(H,{data:T});continue}}u=Math.max(u,C);const S=a.getNewTemporaryRef(),M=new fe(a);D(g=xu,_o,s6).call(g,M,_),await D(this,_o,oM).call(this,{structTreeParent:k,tagDict:M,newTagRef:S,structTreeRootRef:t,fallbackKids:s,xref:a,cache:c});const N=new fe(a);M.set("K",N),N.set("Type",h),w&&N.set("Pg",y),N.set("Obj",v),c.put(S,M),r.push(C,S)}}return u+1},s6=function(e,{type:t,title:i,lang:s,alt:r,expanded:a,actualText:o}){e.set("S",ve.get(t)),i&&e.set("T",go(i)),s&&e.set("Lang",go(s)),r&&e.set("Alt",go(r)),a&&e.set("E",go(a)),o&&e.set("ActualText",go(o))},aM=function({elements:e,xref:t,pageDict:i,numberTree:s}){const r=new Map;for(const c of e)if(c.structTreeParentId){const h=parseInt(c.structTreeParentId.split("_mc")[1],10);let u=r.get(h);u||(u=[],r.set(h,u)),u.push(c)}const a=i.get("StructParents");if(!Number.isInteger(a))return;const o=s.get(a),l=(c,h,u)=>{const d=r.get(c);if(d){const f=h.getRaw("P"),g=t.fetchIfRef(f);if(f instanceof st&&g instanceof fe){const m={ref:u,dict:h};for(const x of d)x.structTreeParent=m}return!0}return!1};for(const c of o){if(!(c instanceof st))continue;const h=t.fetch(c),u=h.get("K");if(Number.isInteger(u)){l(u,h,c);continue}if(Array.isArray(u))for(let d of u){if(d=t.fetchIfRef(d),Number.isInteger(d)&&l(d,h,c))break;if(!(d instanceof fe))continue;if(!Di(d.get("Type"),"MCR"))break;const f=d.get("MCID");if(Number.isInteger(f)&&l(f,h,c))break}}},oM=async function({structTreeParent:e,tagDict:t,newTagRef:i,structTreeRootRef:s,fallbackKids:r,xref:a,cache:o}){let l=null,c;e?({ref:l}=e,c=e.dict.getRaw("P")||s):c=s,t.set("P",c);const h=a.fetchIfRef(c);if(!h){r.push(i);return}let u=o.get(c);u||(u=h.clone(),o.put(c,u));const d=u.getRaw("K");let f=d instanceof st?o.get(d):null;if(!f){f=a.fetchIfRef(d),f=Array.isArray(f)?f.slice():[d];const m=a.getNewTemporaryRef();u.set("K",m),o.put(m,f)}const g=f.indexOf(l);f.splice(g>=0?g+1:f.length,0,i)},B(xu,_o);let Kp=xu;class OG{constructor(e,t){this.tree=e,this.xref=e.xref,this.dict=t,this.kids=[],this.parseKids()}get role(){const e=this.dict.get("S"),t=e instanceof ve?e.name:"",{root:i}=this.tree;return i.roleMap.get(t)??t}parseKids(){let e=null;const t=this.dict.getRaw("Pg");t instanceof st&&(e=t.toString());const i=this.dict.get("K");if(Array.isArray(i))for(const s of i){const r=this.parseKid(e,this.xref.fetchIfRef(s));r&&this.kids.push(r)}else{const s=this.parseKid(e,i);s&&this.kids.push(s)}}parseKid(e,t){if(Number.isInteger(t))return this.tree.pageDict.objId!==e?null:new t9({type:ho.PAGE_CONTENT,mcid:t,pageObjId:e});if(!(t instanceof fe))return null;const i=t.getRaw("Pg");i instanceof st&&(e=i.toString());const s=t.get("Type")instanceof ve?t.get("Type").name:null;if(s==="MCR"){if(this.tree.pageDict.objId!==e)return null;const r=t.getRaw("Stm");return new t9({type:ho.STREAM_CONTENT,refObjId:r instanceof st?r.toString():null,pageObjId:e,mcid:t.get("MCID")})}if(s==="OBJR"){if(this.tree.pageDict.objId!==e)return null;const r=t.getRaw("Obj");return new t9({type:ho.OBJECT,refObjId:r instanceof st?r.toString():null,pageObjId:e})}return new t9({type:ho.ELEMENT,dict:t})}}class t9{constructor({type:e,dict:t=null,mcid:i=null,pageObjId:s=null,refObjId:r=null}){this.type=e,this.dict=t,this.mcid=i,this.pageObjId=s,this.refObjId=r,this.parentNode=null}}class lM{constructor(e,t){this.root=e,this.xref=(e==null?void 0:e.xref)??null,this.rootDict=(e==null?void 0:e.dict)??null,this.pageDict=t,this.nodes=[]}collectObjects(e){var a;if(!this.root||!this.rootDict||!(e instanceof st))return null;const t=this.rootDict.get("ParentTree");if(!t)return null;const i=(a=this.root.structParentIds)==null?void 0:a.get(e);if(!i)return null;const s=new Map,r=new O3(t,this.xref);for(const[o]of i){const l=r.getRaw(o);l instanceof st&&s.set(o,l)}return s}parse(e){var o,l;if(!this.root||!this.rootDict||!(e instanceof st))return;const t=this.rootDict.get("ParentTree");if(!t)return;const i=this.pageDict.get("StructParents"),s=(o=this.root.structParentIds)==null?void 0:o.get(e);if(!Number.isInteger(i)&&!s)return;const r=new Map,a=new O3(t,this.xref);if(Number.isInteger(i)){const c=a.get(i);if(Array.isArray(c))for(const h of c)h instanceof st&&this.addNode(this.xref.fetch(h),r)}if(s)for(const[c,h]of s){const u=a.get(c);if(u){const d=this.addNode(this.xref.fetchIfRef(u),r);((l=d==null?void 0:d.kids)==null?void 0:l.length)===1&&d.kids[0].type===ho.OBJECT&&(d.kids[0].type=h)}}}addNode(e,t,i=0){if(i>Zk)return ce("StructTree MAX_DEPTH reached."),null;if(!(e instanceof fe))return null;if(t.has(e))return t.get(e);const s=new OG(this,e);t.set(e,s);const r=e.get("P");if(!(r instanceof fe)||Di(r.get("Type"),"StructTreeRoot"))return this.addTopLevelNode(e,s)||t.delete(e),s;const a=this.addNode(r,t,i+1);if(!a)return s;let o=!1;for(const l of a.kids)l.type===ho.ELEMENT&&l.dict===e&&(l.parentNode=s,o=!0);return o||t.delete(e),s}addTopLevelNode(e,t){const i=this.rootDict.get("K");if(!i)return!1;if(i instanceof fe)return i.objId!==e.objId?!1:(this.nodes[0]=t,!0);if(!Array.isArray(i))return!0;let s=!1;for(let r=0;r<i.length;r++){const a=i[r];(a==null?void 0:a.toString())===e.objId&&(this.nodes[r]=t,s=!0)}return s}get serializable(){function e(i,s,r=0){if(r>Zk){ce("StructTree too deep to be fully serialized.");return}const a=Object.create(null);a.role=i.role,a.children=[],s.children.push(a);let o=i.dict.get("Alt");typeof o!="string"&&(o=i.dict.get("ActualText")),typeof o=="string"&&(a.alt=Tn(o));const l=i.dict.get("A");if(l instanceof fe){const h=y0(l.getArray("BBox"),null);if(h)a.bbox=h;else{const u=l.get("Width"),d=l.get("Height");typeof u=="number"&&u>0&&typeof d=="number"&&d>0&&(a.bbox=[0,0,u,d])}}const c=i.dict.get("Lang");typeof c=="string"&&(a.lang=Tn(c));for(const h of i.kids){const u=h.type===ho.ELEMENT?h.parentNode:null;if(u){e(u,a,r+1);continue}else h.type===ho.PAGE_CONTENT||h.type===ho.STREAM_CONTENT?a.children.push({type:"content",id:`p${h.pageObjId}_mc${h.mcid}`}):h.type===ho.OBJECT?a.children.push({type:"object",id:h.refObjId}):h.type===ho.ANNOTATION&&a.children.push({type:"annotation",id:`${bU}${h.refObjId}`})}}const t=Object.create(null);t.children=[],t.role="Root";for(const i of this.nodes)i&&e(i,t);return t}}const DG=n=>n instanceof st,D3=xU.bind(null,DG,Di);function Mw(n){return n instanceof fe&&(n=n.get("D")),D3(n)?n:null}function Qk(n){let e=n.get("D");if(e){if(e instanceof ve&&(e=e.name),typeof e=="string")return Tn(e,!0);if(D3(e))return JSON.stringify(e)}return null}var vg,Kn,ls,cM,hM,uM,dM,fM,gM,r6,mM,pM;const z5=class z5{constructor(e,t){B(this,ls);B(this,vg,null);B(this,Kn,null);He(this,"builtInCMapCache",new Map);He(this,"fontCache",new ca);He(this,"globalColorSpaceCache",new aG);He(this,"globalImageCache",new Z7);He(this,"nonBlendModesSet",new Zi);He(this,"pageDictCache",new ca);He(this,"pageIndexCache",new ca);He(this,"pageKidsCountCache",new ca);He(this,"standardFontDataCache",new Map);He(this,"systemFontCache",new Map);if(this.pdfManager=e,this.xref=t,O(this,Kn,t.getCatalogObj()),!(b(this,Kn)instanceof fe))throw new Te("Catalog object is not a dictionary.");this.toplevelPagesDict}cloneDict(){return b(this,Kn).clone()}get version(){const e=b(this,Kn).get("Version");if(e instanceof ve){if(aR.test(e.name))return Ze(this,"version",e.name);ce(`Invalid PDF catalog version: ${e.name}`)}return Ze(this,"version",null)}get lang(){const e=b(this,Kn).get("Lang");return Ze(this,"lang",e&&typeof e=="string"?Tn(e):null)}get needsRendering(){const e=b(this,Kn).get("NeedsRendering");return Ze(this,"needsRendering",typeof e=="boolean"?e:!1)}get collection(){let e=null;try{const t=b(this,Kn).get("Collection");t instanceof fe&&t.size>0&&(e=t)}catch(t){if(t instanceof xi)throw t;gn("Cannot fetch Collection entry; assuming no collection is present.")}return Ze(this,"collection",e)}get acroForm(){let e=null;try{const t=b(this,Kn).get("AcroForm");t instanceof fe&&t.size>0&&(e=t)}catch(t){if(t instanceof xi)throw t;gn("Cannot fetch AcroForm entry; assuming no forms are present.")}return Ze(this,"acroForm",e)}get acroFormRef(){const e=b(this,Kn).getRaw("AcroForm");return Ze(this,"acroFormRef",e instanceof st?e:null)}get metadata(){var i;const e=b(this,Kn).getRaw("Metadata");if(!(e instanceof st))return Ze(this,"metadata",null);let t=null;try{const s=this.xref.fetch(e,!((i=this.xref.encrypt)!=null&&i.encryptMetadata));if(s instanceof un&&s.dict instanceof fe){const r=s.dict.get("Type"),a=s.dict.get("Subtype");if(Di(r,"Metadata")&&Di(a,"XML")){const o=Lp(s.getString());o&&(t=new NG(o).serializable)}}}catch(s){if(s instanceof xi)throw s;gn(`Skipping invalid Metadata: "${s}".`)}return Ze(this,"metadata",t)}get markInfo(){let e=null;try{e=D(this,ls,cM).call(this)}catch(t){if(t instanceof xi)throw t;ce("Unable to read mark info.")}return Ze(this,"markInfo",e)}get structTreeRoot(){let e=null;try{e=D(this,ls,hM).call(this)}catch(t){if(t instanceof xi)throw t;ce("Unable read to structTreeRoot info.")}return Ze(this,"structTreeRoot",e)}get toplevelPagesDict(){const e=b(this,Kn).get("Pages");if(!(e instanceof fe))throw new Te("Invalid top-level pages dictionary.");return Ze(this,"toplevelPagesDict",e)}get documentOutline(){let e=null;try{e=D(this,ls,uM).call(this)}catch(t){if(t instanceof xi)throw t;ce("Unable to read document outline.")}return Ze(this,"documentOutline",e)}get permissions(){let e=null;try{e=D(this,ls,dM).call(this)}catch(t){if(t instanceof xi)throw t;ce("Unable to read permissions.")}return Ze(this,"permissions",e)}get optionalContentConfig(){let e=null;try{const t=b(this,Kn).get("OCProperties");if(!t)return Ze(this,"optionalContentConfig",null);const i=t.get("D");if(!i)return Ze(this,"optionalContentConfig",null);const s=t.get("OCGs");if(!Array.isArray(s))return Ze(this,"optionalContentConfig",null);const r=new ca;for(const a of s)!(a instanceof st)||r.has(a)||r.put(a,D(this,ls,fM).call(this,a));e=D(this,ls,gM).call(this,i,r)}catch(t){if(t instanceof xi)throw t;ce(`Unable to read optional content config: ${t}`)}return Ze(this,"optionalContentConfig",e)}setActualNumPages(e=null){O(this,vg,e)}get hasActualNumPages(){return b(this,vg)!==null}get _pagesCount(){const e=this.toplevelPagesDict.get("Count");if(!Number.isInteger(e))throw new Te("Page count in top-level pages dictionary is not an integer.");return Ze(this,"_pagesCount",e)}get numPages(){return b(this,vg)??this._pagesCount}get destinations(){var i;const e=D(this,ls,r6).call(this),t=Object.create(null);for(const s of e)if(s instanceof pf)for(const[r,a]of s.getAll()){const o=Mw(a);o&&(t[Tn(r,!0)]=o)}else if(s instanceof fe)for(const[r,a]of s){const o=Mw(a);o&&(t[i=Tn(r,!0)]||(t[i]=o))}return Ze(this,"destinations",t)}getDestination(e){if(this.hasOwnProperty("destinations"))return this.destinations[e]??null;const t=D(this,ls,r6).call(this);for(const i of t)if(i instanceof pf||i instanceof fe){const s=Mw(i.get(e));if(s)return s}if(t.length){const i=this.destinations[e];if(i)return i}return null}get pageLabels(){let e=null;try{e=D(this,ls,mM).call(this)}catch(t){if(t instanceof xi)throw t;ce("Unable to read page labels.")}return Ze(this,"pageLabels",e)}get pageLayout(){const e=b(this,Kn).get("PageLayout");let t="";if(e instanceof ve)switch(e.name){case"SinglePage":case"OneColumn":case"TwoColumnLeft":case"TwoColumnRight":case"TwoPageLeft":case"TwoPageRight":t=e.name}return Ze(this,"pageLayout",t)}get pageMode(){const e=b(this,Kn).get("PageMode");let t="UseNone";if(e instanceof ve)switch(e.name){case"UseNone":case"UseOutlines":case"UseThumbs":case"FullScreen":case"UseOC":case"UseAttachments":t=e.name}return Ze(this,"pageMode",t)}get viewerPreferences(){const e=b(this,Kn).get("ViewerPreferences");if(!(e instanceof fe))return Ze(this,"viewerPreferences",null);let t=null;for(const[i,s]of e){let r;switch(i){case"HideToolbar":case"HideMenubar":case"HideWindowUI":case"FitWindow":case"CenterWindow":case"DisplayDocTitle":case"PickTrayByPDFSize":typeof s=="boolean"&&(r=s);break;case"NonFullScreenPageMode":if(s instanceof ve)switch(s.name){case"UseNone":case"UseOutlines":case"UseThumbs":case"UseOC":r=s.name;break;default:r="UseNone"}break;case"Direction":if(s instanceof ve)switch(s.name){case"L2R":case"R2L":r=s.name;break;default:r="L2R"}break;case"ViewArea":case"ViewClip":case"PrintArea":case"PrintClip":if(s instanceof ve)switch(s.name){case"MediaBox":case"CropBox":case"BleedBox":case"TrimBox":case"ArtBox":r=s.name;break;default:r="CropBox"}break;case"PrintScaling":if(s instanceof ve)switch(s.name){case"None":case"AppDefault":r=s.name;break;default:r="AppDefault"}break;case"Duplex":if(s instanceof ve)switch(s.name){case"Simplex":case"DuplexFlipShortEdge":case"DuplexFlipLongEdge":r=s.name;break;default:r="None"}break;case"PrintPageRange":Array.isArray(s)&&s.length%2===0&&s.every((o,l,c)=>Number.isInteger(o)&&o>0&&(l===0||o>=c[l-1])&&o<=this.numPages)&&(r=s);break;case"NumCopies":Number.isInteger(s)&&s>0&&(r=s);break;default:ce(`Ignoring non-standard key in ViewerPreferences: ${i}.`);continue}if(r===void 0){ce(`Bad value, for key "${i}", in ViewerPreferences: ${s}.`);continue}t??(t=Object.create(null)),t[i]=r}return Ze(this,"viewerPreferences",t)}get openAction(){const e=b(this,Kn).get("OpenAction"),t=Object.create(null);if(e instanceof fe){const i=new fe(this.xref);i.set("A",e);const s={url:null,dest:null,action:null};z5.parseDestDictionary({destDict:i,resultObj:s}),Array.isArray(s.dest)?t.dest=s.dest:s.action&&(t.action=s.action)}else D3(e)&&(t.dest=e);return Ze(this,"openAction",x4(t)>0?t:null)}get attachments(){const e=b(this,Kn).get("Names");let t=null;if(e instanceof fe&&e.has("EmbeddedFiles")){const i=new pf(e.getRaw("EmbeddedFiles"),this.xref);for(const[s,r]of i.getAll()){const a=new n6(r,this.xref);t??(t=Object.create(null)),t[Tn(s,!0)]=a.serializable}}return Ze(this,"attachments",t)}get xfaImages(){const e=b(this,Kn).get("Names");let t=null;if(e instanceof fe&&e.has("XFAImages")){const i=new pf(e.getRaw("XFAImages"),this.xref);for(const[s,r]of i.getAll())r instanceof un&&(t??(t=new Map),t.set(Tn(s,!0),r.getBytes()))}return Ze(this,"xfaImages",t)}get jsActions(){const e=D(this,ls,pM).call(this);let t=ey(this.xref,b(this,Kn),lU);if(e){t||(t=Object.create(null));for(const[i,s]of e)i in t?t[i].push(s):t[i]=[s]}return Ze(this,"jsActions",t)}async cleanup(e=!1){F4(),this.globalColorSpaceCache.clear(),this.globalImageCache.clear(e),this.pageKidsCountCache.clear(),this.pageIndexCache.clear(),this.pageDictCache.clear(),this.nonBlendModesSet.clear();for(const{dict:t}of await Promise.all(this.fontCache))delete t.cacheKey;this.fontCache.clear(),this.builtInCMapCache.clear(),this.standardFontDataCache.clear(),this.systemFontCache.clear()}async getPageDict(e){const t=[this.toplevelPagesDict],i=new Zi,s=b(this,Kn).getRaw("Pages");s instanceof st&&i.put(s);const r=this.xref,a=this.pageKidsCountCache,o=this.pageIndexCache,l=this.pageDictCache;let c=0;for(;t.length;){const h=t.pop();if(h instanceof st){const g=a.get(h);if(g>=0&&c+g<=e){c+=g;continue}if(i.has(h))throw new Te("Pages tree contains circular reference.");i.put(h);const m=await(l.get(h)||r.fetchAsync(h));if(m instanceof fe){let x=m.getRaw("Type");if(x instanceof st&&(x=await r.fetchAsync(x)),Di(x,"Page")||!m.has("Kids")){if(a.has(h)||a.put(h,1),o.has(h)||o.put(h,c),c===e)return[m,h];c++;continue}}t.push(m);continue}if(!(h instanceof fe))throw new Te("Page dictionary kid reference points to wrong type of object.");const{objId:u}=h;let d=h.getRaw("Count");if(d instanceof st&&(d=await r.fetchAsync(d)),Number.isInteger(d)&&d>=0&&(u&&!a.has(u)&&a.put(u,d),c+d<=e)){c+=d;continue}let f=h.getRaw("Kids");if(f instanceof st&&(f=await r.fetchAsync(f)),!Array.isArray(f)){let g=h.getRaw("Type");if(g instanceof st&&(g=await r.fetchAsync(g)),Di(g,"Page")||!h.has("Kids")){if(c===e)return[h,null];c++;continue}throw new Te("Page dictionary kids object is not an array.")}for(let g=f.length-1;g>=0;g--){const m=f[g];t.push(m),h===this.toplevelPagesDict&&m instanceof st&&!l.has(m)&&l.put(m,r.fetchAsync(m))}}throw new Error(`Page index ${e} not found.`)}async getAllPageDicts(e=!1){const{ignoreErrors:t}=this.pdfManager.evaluatorOptions,i=[{currentNode:this.toplevelPagesDict,posInKids:0}],s=new Zi,r=b(this,Kn).getRaw("Pages");r instanceof st&&s.put(r);const a=new Map,o=this.xref,l=this.pageIndexCache;let c=0;function h(d,f){f&&!l.has(f)&&l.put(f,c),a.set(c++,[d,f])}function u(d){if(d instanceof Eh&&!e)throw d;e&&t&&c===0&&(ce(`getAllPageDicts - Skipping invalid first page: "${d}".`),d=fe.empty),a.set(c++,[d,null])}for(;i.length>0;){const d=i.at(-1),{currentNode:f,posInKids:g}=d;let m=f.getRaw("Kids");if(m instanceof st)try{m=await o.fetchAsync(m)}catch(w){u(w);break}if(!Array.isArray(m)){u(new Te("Page dictionary kids object is not an array."));break}if(g>=m.length){i.pop();continue}const x=m[g];let p;if(x instanceof st){if(s.has(x)){u(new Te("Pages tree contains circular reference."));break}s.put(x);try{p=await o.fetchAsync(x)}catch(w){u(w);break}}else p=x;if(!(p instanceof fe)){u(new Te("Page dictionary kid reference points to wrong type of object."));break}let y=p.getRaw("Type");if(y instanceof st)try{y=await o.fetchAsync(y)}catch(w){u(w);break}Di(y,"Page")||!p.has("Kids")?h(p,x instanceof st?x:null):i.push({currentNode:p,posInKids:0}),d.posInKids++}return a}getPageIndex(e){const t=this.pageIndexCache.get(e);if(t!==void 0)return Promise.resolve(t);const i=this.xref;function s(o){let l=0,c;return i.fetchAsync(o).then(function(h){if(I3(o,e)&&!rR(h,"Page")&&!(h instanceof fe&&!h.has("Type")&&h.has("Contents")))throw new Te("The reference does not point to a /Page dictionary.");if(!h)return null;if(!(h instanceof fe))throw new Te("Node must be a dictionary.");return c=h.getRaw("Parent"),h.getAsync("Parent")}).then(function(h){if(!h)return null;if(!(h instanceof fe))throw new Te("Parent must be a dictionary.");return h.getAsync("Kids")}).then(function(h){if(!h)return null;const u=[];let d=!1;for(const f of h){if(!(f instanceof st))throw new Te("Kid must be a reference.");if(I3(f,o)){d=!0;break}u.push(i.fetchAsync(f).then(function(g){if(!(g instanceof fe))throw new Te("Kid node must be a dictionary.");g.has("Count")?l+=g.get("Count"):l++}))}if(!d)throw new Te("Kid reference not found in parent's kids.");return Promise.all(u).then(()=>[l,c])})}let r=0;const a=o=>s(o).then(l=>{if(!l)return this.pageIndexCache.put(e,r),r;const[c,h]=l;return r+=c,a(h)});return a(e)}get baseUrl(){const e=b(this,Kn).get("URI");if(e instanceof fe){const t=e.get("Base");if(typeof t=="string"){const i=S3(t,null,{tryConvertEncoding:!0});if(i)return Ze(this,"baseUrl",i.href)}}return Ze(this,"baseUrl",this.pdfManager.docBaseUrl)}static parseDestDictionary({destDict:e,resultObj:t,docBaseUrl:i=null,docAttachments:s=null}){if(!(e instanceof fe)){ce("parseDestDictionary: `destDict` must be a dictionary.");return}let r=e.get("A"),a,o;if(r instanceof fe||(e.has("Dest")?r=e.get("Dest"):(r=e.get("AA"),r instanceof fe&&(r.has("D")?r=r.get("D"):r.has("U")&&(r=r.get("U"))))),r instanceof fe){const l=r.get("S");if(!(l instanceof ve)){ce("parseDestDictionary: Invalid type in Action dictionary.");return}const c=l.name;switch(c){case"ResetForm":const h=r.get("Flags"),u=((typeof h=="number"?h:0)&1)===0,d=[],f=[];for(const M of r.get("Fields")||[])M instanceof st?f.push(M.toString()):typeof M=="string"&&d.push(Tn(M));t.resetForm={fields:d,refs:f,include:u};break;case"URI":a=r.get("URI"),a instanceof ve&&(a="/"+a.name);break;case"GoTo":o=r.get("D");break;case"Launch":case"GoToR":const g=r.get("F");if(g instanceof fe){const M=new n6(g,null,!0),{rawFilename:N}=M.serializable;a=N}else typeof g=="string"&&(a=g);const m=Qk(r);m&&typeof a=="string"&&(a=a.split("#",1)[0]+"#"+m);const x=r.get("NewWindow");typeof x=="boolean"&&(t.newWindow=x);break;case"GoToE":const p=r.get("T");let y;if(s&&p instanceof fe){const M=p.get("R"),N=p.get("N");Di(M,"C")&&typeof N=="string"&&(y=s[Tn(N,!0)])}if(y){t.attachment=y;const M=Qk(r);M&&(t.attachmentDest=M)}else ce('parseDestDictionary - unimplemented "GoToE" action.');break;case"Named":const w=r.get("N");w instanceof ve&&(t.action=w.name);break;case"SetOCGState":const _=r.get("State"),v=r.get("PreserveRB");if(!Array.isArray(_)||_.length===0)break;const C=[];for(const M of _)if(M instanceof ve)switch(M.name){case"ON":case"OFF":case"Toggle":C.push(M.name);break}else M instanceof st&&C.push(M.toString());if(C.length!==_.length)break;t.setOCGState={state:C,preserveRB:typeof v=="boolean"?v:!0};break;case"JavaScript":const k=r.get("JS");let I;k instanceof un?I=k.getString():typeof k=="string"&&(I=k);const S=I&&cR(Tn(I,!0));if(S){a=S.url,t.newWindow=S.newWindow;break}default:if(c==="JavaScript"||c==="SubmitForm")break;ce(`parseDestDictionary - unsupported action: "${c}".`);break}}else e.has("Dest")&&(o=e.get("Dest"));if(typeof a=="string"){const l=S3(a,i,{addDefaultProtocol:!0,tryConvertEncoding:!0});l&&(t.url=l.href),t.unsafeUrl=a}o&&(o instanceof ve&&(o=o.name),typeof o=="string"?t.dest=Tn(o,!0):D3(o)&&(t.dest=o))}};vg=new WeakMap,Kn=new WeakMap,ls=new WeakSet,cM=function(){const e=b(this,Kn).get("MarkInfo");if(!(e instanceof fe))return null;const t={Marked:!1,UserProperties:!1,Suspects:!1};for(const i in t){const s=e.get(i);typeof s=="boolean"&&(t[i]=s)}return t},hM=function(){const e=b(this,Kn).getRaw("StructTreeRoot"),t=this.xref.fetchIfRef(e);if(!(t instanceof fe))return null;const i=new Kp(this.xref,t,e);return i.init(),i},uM=function(){let e=b(this,Kn).get("Outlines");if(!(e instanceof fe)||(e=e.getRaw("First"),!(e instanceof st)))return null;const t={items:[]},i=[{obj:e,parent:t}],s=new Zi;s.put(e);const r=this.xref,a=new Uint8ClampedArray(3);for(;i.length>0;){const o=i.shift(),l=r.fetchIfRef(o.obj);if(l===null)continue;l.has("Title")||ce("Invalid outline item encountered.");const c={url:null,dest:null,action:null};z5.parseDestDictionary({destDict:l,resultObj:c,docBaseUrl:this.baseUrl,docAttachments:this.attachments});const h=l.get("Title"),u=l.get("F")||0,d=l.getArray("C"),f=l.get("Count");let g=a;Vr(d,3)&&(d[0]!==0||d[1]!==0||d[2]!==0)&&(g=Nn.rgb.getRgb(d,0));const m={action:c.action,attachment:c.attachment,dest:c.dest,url:c.url,unsafeUrl:c.unsafeUrl,newWindow:c.newWindow,setOCGState:c.setOCGState,title:typeof h=="string"?Tn(h):"",color:g,count:Number.isInteger(f)?f:void 0,bold:!!(u&2),italic:!!(u&1),items:[]};o.parent.items.push(m),e=l.getRaw("First"),e instanceof st&&!s.has(e)&&(i.push({obj:e,parent:m}),s.put(e)),e=l.getRaw("Next"),e instanceof st&&!s.has(e)&&(i.push({obj:e,parent:o.parent}),s.put(e))}return t.items.length>0?t.items:null},dM=function(){const e=this.xref.trailer.get("Encrypt");if(!(e instanceof fe))return null;let t=e.get("P");if(typeof t!="number")return null;t+=2**32;const i=[];for(const s in Hv){const r=Hv[s];t&r&&i.push(r)}return i},fM=function(e){const t=this.xref.fetch(e),i={id:e.toString(),name:null,intent:null,usage:{print:null,view:null},rbGroups:[]},s=t.get("Name");typeof s=="string"&&(i.name=Tn(s));let r=t.getArray("Intent");Array.isArray(r)||(r=[r]),r.every(h=>h instanceof ve)&&(i.intent=r.map(h=>h.name));const a=t.get("Usage");if(!(a instanceof fe))return i;const o=i.usage,l=a.get("Print");if(l instanceof fe){const h=l.get("PrintState");if(h instanceof ve)switch(h.name){case"ON":case"OFF":o.print={printState:h.name}}}const c=a.get("View");if(c instanceof fe){const h=c.get("ViewState");if(h instanceof ve)switch(h.name){case"ON":case"OFF":o.view={viewState:h.name}}}return i},gM=function(e,t){function i(h){const u=[];if(Array.isArray(h))for(const d of h)d instanceof st&&t.has(d)&&u.push(d.toString());return u}function s(h,u=0){if(!Array.isArray(h))return null;const d=[];for(const g of h){if(g instanceof st&&t.has(g)){l.put(g),d.push(g.toString());continue}const m=r(g,u);m&&d.push(m)}if(u>0)return d;const f=[];for(const[g]of t.items())l.has(g)||f.push(g.toString());return f.length&&d.push({name:null,order:f}),d}function r(h,u){if(++u>c)return ce("parseNestedOrder - reached MAX_NESTED_LEVELS."),null;const d=o.fetchIfRef(h);if(!Array.isArray(d))return null;const f=o.fetchIfRef(d[0]);if(typeof f!="string")return null;const g=s(d.slice(1),u);return g!=null&&g.length?{name:Tn(f),order:g}:null}function a(h){if(Array.isArray(h))for(const u of h){const d=o.fetchIfRef(u);if(!Array.isArray(d)||!d.length)continue;const f=new Set;for(const g of d)g instanceof st&&t.has(g)&&!f.has(g.toString())&&(f.add(g.toString()),t.get(g).rbGroups.push(f))}}const o=this.xref,l=new Zi,c=10;return a(e.get("RBGroups")),{name:typeof e.get("Name")=="string"?Tn(e.get("Name")):null,creator:typeof e.get("Creator")=="string"?Tn(e.get("Creator")):null,baseState:e.get("BaseState")instanceof ve?e.get("BaseState").name:null,on:i(e.get("ON")),off:i(e.get("OFF")),order:s(e.get("Order")),groups:[...t]}},r6=function(){const e=b(this,Kn).get("Names"),t=[];return e!=null&&e.has("Dests")&&t.push(new pf(e.getRaw("Dests"),this.xref)),b(this,Kn).has("Dests")&&t.push(b(this,Kn).get("Dests")),t},mM=function(){const e=b(this,Kn).getRaw("PageLabels");if(!e)return null;const t=new Array(this.numPages);let i=null,s="";const a=new O3(e,this.xref).getAll();let o="",l=1;for(let c=0,h=this.numPages;c<h;c++){const u=a.get(c);if(u!==void 0){if(!(u instanceof fe))throw new Te("PageLabel is not a dictionary.");if(u.has("Type")&&!Di(u.get("Type"),"PageLabel"))throw new Te("Invalid type in PageLabel dictionary.");if(u.has("S")){const d=u.get("S");if(!(d instanceof ve))throw new Te("Invalid style in PageLabel dictionary.");i=d.name}else i=null;if(u.has("P")){const d=u.get("P");if(typeof d!="string")throw new Te("Invalid prefix in PageLabel dictionary.");s=Tn(d)}else s="";if(u.has("St")){const d=u.get("St");if(!(Number.isInteger(d)&&d>=1))throw new Te("Invalid start in PageLabel dictionary.");l=d}else l=1}switch(i){case"D":o=l;break;case"R":case"r":o=CU(l,i==="r");break;case"A":case"a":const d=26,m=i==="a"?97:65,x=l-1;o=String.fromCharCode(m+x%d).repeat(Math.floor(x/d)+1);break;default:if(i)throw new Te(`Invalid style "${i}" in PageLabel dictionary.`);o=""}t[c]=s+o,l++}return t},pM=function(){const e=b(this,Kn).get("Names");let t=null;function i(r,a){if(!(a instanceof fe)||!Di(a.get("S"),"JavaScript"))return;let o=a.get("JS");if(o instanceof un)o=o.getString();else if(typeof o!="string")return;o=Tn(o,!0).replaceAll("\0",""),o&&(t||(t=new Map)).set(r,o)}if(e instanceof fe&&e.has("JavaScript")){const r=new pf(e.getRaw("JavaScript"),this.xref);for(const[a,o]of r.getAll())i(Tn(a,!0),o)}const s=b(this,Kn).get("OpenAction");return s&&i("OpenAction",s),t};let Xp=z5;function FG(n){return n instanceof st||n instanceof fe||n instanceof un||Array.isArray(n)}function LG(n,e){if(n instanceof fe)n=n.getRawValues();else if(n instanceof un)n=n.dict.getRawValues();else if(!Array.isArray(n))return;for(const t of n)FG(t)&&e.push(t)}var Zb,a6;const Y_=class Y_{constructor(e,t,i){B(this,Zb);He(this,"refSet",new Zi);this.dict=e,this.keys=t,this.xref=i}async load(){const{keys:e,dict:t}=this,i=[];for(const s of e){const r=t.getRaw(s);r!==void 0&&i.push(r)}await D(this,Zb,a6).call(this,i),this.refSet=null}static async load(e,t,i){if(i.stream.isDataLoaded)return;await new Y_(e,t,i).load()}};Zb=new WeakSet,a6=async function(e){const t=[],i=[];for(;e.length;){let s=e.pop();if(s instanceof st){if(this.refSet.has(s))continue;try{this.refSet.put(s),s=this.xref.fetch(s)}catch(r){if(!(r instanceof xi)){ce(`ObjectLoader.#walk - requesting all data: "${r}".`),await this.xref.stream.manager.requestAllChunks();return}t.push(s),i.push({begin:r.begin,end:r.end})}}if(s instanceof un){const r=s.getBaseStreams();if(r){let a=!1;for(const o of r)o.isDataLoaded||(a=!0,i.push({begin:o.start,end:o.end}));a&&t.push(s)}}LG(s,e)}if(i.length){await this.xref.stream.manager.requestRanges(i);for(const s of t)s instanceof st&&this.refSet.remove(s);await D(this,Zb,a6).call(this,t)}};let Pg=Y_;const ry=Symbol(),Ud=Symbol(),Li=Symbol(),zh=Symbol(),wo=Symbol(),Lf=Symbol(),o3=Symbol(),Xo=Symbol(),ql=Symbol(),Oe=Symbol("content"),mo=Symbol("data"),Ng=Symbol(),_e=Symbol("extra"),ti=Symbol(),gx=Symbol(),o6=Symbol(),bM=Symbol(),Hd=Symbol(),ay=Symbol(),Yp=Symbol(),xp=Symbol(),L4=Symbol(),hr=Symbol(),yp=Symbol(),js=Symbol(),Og=Symbol(),_c=Symbol(),Qi=Symbol(),$t=Symbol(),Yi=Symbol(),ei=Symbol(),Jp=Symbol(),Mf=Symbol(),l6=Symbol(),l3=Symbol(),B4=Symbol(),cf=Symbol(),Bf=Symbol(),D0=Symbol(),wp=Symbol(),l0=Symbol(),w0=Symbol(),Zp=Symbol(),Qp=Symbol(),BG=Symbol(),Ji=Symbol("namespaceId"),On=Symbol("nodeName"),t0=Symbol(),Ql=Symbol(),c6=Symbol(),c0=Symbol(),rc=Symbol(),ha=Symbol(),Jg=Symbol(),Nh=Symbol(),xM=Symbol("root"),hp=Symbol(),n0=Symbol(),h6=Symbol(),yM=Symbol(),ga=Symbol(),Vo=Symbol(),bs=Symbol(),wM=Symbol(),Kt=Symbol(),_p=Symbol(),Rn=Symbol(),Vn=Symbol("uid"),cl=Symbol(),es={config:{id:0,check:n=>n.startsWith("http://www.xfa.org/schema/xci/")},connectionSet:{id:1,check:n=>n.startsWith("http://www.xfa.org/schema/xfa-connection-set/")},datasets:{id:2,check:n=>n.startsWith("http://www.xfa.org/schema/xfa-data/")},form:{id:3,check:n=>n.startsWith("http://www.xfa.org/schema/xfa-form/")},localeSet:{id:4,check:n=>n.startsWith("http://www.xfa.org/schema/xfa-locale-set/")},pdf:{id:5,check:n=>n==="http://ns.adobe.com/xdp/pdf/"},signature:{id:6,check:n=>n==="http://www.w3.org/2000/09/xmldsig#"},sourceSet:{id:7,check:n=>n.startsWith("http://www.xfa.org/schema/xfa-source-set/")},stylesheet:{id:8,check:n=>n==="http://www.w3.org/1999/XSL/Transform"},template:{id:9,check:n=>n.startsWith("http://www.xfa.org/schema/xfa-template/")},xdc:{id:10,check:n=>n.startsWith("http://www.xfa.org/schema/xdc/")},xdp:{id:11,check:n=>n==="http://ns.adobe.com/xdp/"},xfdf:{id:12,check:n=>n==="http://ns.adobe.com/xfdf/"},xhtml:{id:13,check:n=>n==="http://www.w3.org/1999/xhtml"},xmpmeta:{id:14,check:n=>n==="http://ns.adobe.com/xmpmeta/"}},UG={pt:n=>n,cm:n=>n/2.54*72,mm:n=>n/(10*2.54)*72,in:n=>n*72,px:n=>n},HG=/([+-]?\d+\.?\d*)(.*)/;function oy(n){return n.startsWith("'")||n.startsWith('"')?n.slice(1,-1):n}function Qt({data:n,defaultValue:e,validate:t}){if(!n)return e;n=n.trim();const i=parseInt(n,10);return!isNaN(i)&&t(i)?i:e}function F3({data:n,defaultValue:e,validate:t}){if(!n)return e;n=n.trim();const i=parseFloat(n);return!isNaN(i)&&t(i)?i:e}function ly({data:n,defaultValue:e,validate:t}){return n?(n=n.trim(),t(n)?n:e):e}function Fe(n,e){return ly({data:n,defaultValue:e[0],validate:t=>e.includes(t)})}function pt(n,e="0"){if(e||(e="0"),!n)return pt(e);const t=n.trim().match(HG);if(!t)return pt(e);const[,i,s]=t,r=parseFloat(i);if(isNaN(r))return pt(e);if(r===0)return 0;const a=UG[s];return a?a(r):r}function $k(n){if(!n)return{num:1,den:1};const e=n.split(":",2).map(s=>parseFloat(s.trim())).filter(s=>!isNaN(s));if(e.length===1&&e.push(1),e.length===0)return{num:1,den:1};const[t,i]=e;return{num:t,den:i}}function hl(n){return n?n.trim().split(/\s+/).map(e=>({excluded:e[0]==="-",viewname:e.substring(1)})):[]}function zG(n,e=[0,0,0]){let[t,i,s]=e;if(!n)return{r:t,g:i,b:s};const r=n.split(",",3).map(a=>zs(parseInt(a.trim(),10),0,255)).map(a=>isNaN(a)?0:a);return r.length<3?{r:t,g:i,b:s}:([t,i,s]=r,{r:t,g:i,b:s})}function jG(n){if(!n)return{x:-1,y:-1,width:-1,height:-1};const t=n.split(",",4).map(o=>pt(o.trim(),"-1"));if(t.length<4||t[2]<0||t[3]<0)return{x:-1,y:-1,width:-1,height:-1};const[i,s,r,a]=t;return{x:i,y:s,width:r,height:a}}class Tt{static get FAILURE(){return Ze(this,"FAILURE",new Tt(!1,null,null,null))}static get EMPTY(){return Ze(this,"EMPTY",new Tt(!0,null,null,null))}constructor(e,t,i,s){this.success=e,this.html=t,this.bbox=i,this.breakNode=s}isBreak(){return!!this.breakNode}static breakNode(e){return new Tt(!1,null,null,e)}static success(e,t=null){return new Tt(!0,e,t,null)}}class GG{constructor(e){this.fonts=new Map,this.cache=new Map,this.warned=new Set,this.defaultFont=null,this.add(e)}add(e,t=null){for(const s of e)this.addPdfFont(s);for(const s of this.fonts.values())s.regular||(s.regular=s.italic||s.bold||s.bolditalic);if(!t||t.size===0)return;const i=this.fonts.get("PdfJS-Fallback-PdfJS-XFA");for(const s of t)this.fonts.set(s,i)}addPdfFont(e){var o,l,c;const t=e.cssFontInfo,i=t.fontFamily;let s=this.fonts.get(i);s||(s=Object.create(null),this.fonts.set(i,s),this.defaultFont||(this.defaultFont=s));let r="";const a=parseFloat(t.fontWeight);parseFloat(t.italicAngle)!==0?r=a>=700?"bolditalic":"italic":a>=700&&(r="bold"),r||((e.name.includes("Bold")||(o=e.psName)!=null&&o.includes("Bold"))&&(r="bold"),(e.name.includes("Italic")||e.name.endsWith("It")||(l=e.psName)!=null&&l.includes("Italic")||(c=e.psName)!=null&&c.endsWith("It"))&&(r+="italic")),r||(r="regular"),s[r]=e}getDefault(){return this.defaultFont}find(e,t=!0){var o,l;let i=this.fonts.get(e)||this.cache.get(e);if(i)return i;const s=/,|-|_| |bolditalic|bold|italic|regular|it/gi;let r=e.replaceAll(s,"");if(i=this.fonts.get(r),i)return this.cache.set(e,i),i;r=r.toLowerCase();const a=[];for(const[c,h]of this.fonts.entries())c.replaceAll(s,"").toLowerCase().startsWith(r)&&a.push(h);if(a.length===0)for(const[,c]of this.fonts.entries())(o=c.regular.name)!=null&&o.replaceAll(s,"").toLowerCase().startsWith(r)&&a.push(c);if(a.length===0){r=r.replaceAll(/psmt|mt/gi,"");for(const[c,h]of this.fonts.entries())c.replaceAll(s,"").toLowerCase().startsWith(r)&&a.push(h)}if(a.length===0)for(const c of this.fonts.values())(l=c.regular.name)!=null&&l.replaceAll(s,"").toLowerCase().startsWith(r)&&a.push(c);return a.length>=1?(a.length!==1&&t&&ce(`XFA - Too many choices to guess the correct font: ${e}`),this.cache.set(e,a[0]),a[0]):(t&&!this.warned.has(e)&&(this.warned.add(e),ce(`XFA - Cannot find the font: ${e}`)),null)}}function U4(n,e){return n.posture==="italic"?n.weight==="bold"?e.bolditalic:e.italic:n.weight==="bold"?e.bold:e.regular}function VG(n,e=!1){let t=null;if(n){const a=oy(n.typeface),o=n[ei].fontFinder.find(a);t=U4(n,o)}if(!t)return{lineHeight:12,lineGap:2,lineNoGap:10};const i=n.size||10,s=t.lineHeight?Math.max(e?0:1.2,t.lineHeight):1.2,r=t.lineGap===void 0?.2:t.lineGap;return{lineHeight:s*i,lineGap:r*i,lineNoGap:Math.max(1,s-r)*i}}const qG=1.02;class eC{constructor(e,t,i,s){if(this.lineHeight=i,this.paraMargin=t||{top:0,bottom:0,left:0,right:0},!e){[this.pdfFont,this.xfaFont]=this.defaultFont(s);return}this.xfaFont={typeface:e.typeface,posture:e.posture,weight:e.weight,size:e.size,letterSpacing:e.letterSpacing};const r=s.find(e.typeface);if(!r){[this.pdfFont,this.xfaFont]=this.defaultFont(s);return}this.pdfFont=U4(e,r),this.pdfFont||([this.pdfFont,this.xfaFont]=this.defaultFont(s))}defaultFont(e){const t=e.find("Helvetica",!1)||e.find("Myriad Pro",!1)||e.find("Arial",!1)||e.getDefault();if(t!=null&&t.regular){const s=t.regular,a={typeface:s.cssFontInfo.fontFamily,posture:"normal",weight:"normal",size:10,letterSpacing:0};return[s,a]}return[null,{typeface:"Courier",posture:"normal",weight:"normal",size:10,letterSpacing:0}]}}class WG{constructor(e,t,i,s){this.fontFinder=s,this.stack=[new eC(e,t,i,s)]}pushData(e,t,i){const s=this.stack.at(-1);for(const a of["typeface","posture","weight","size","letterSpacing"])e[a]||(e[a]=s.xfaFont[a]);for(const a of["top","bottom","left","right"])isNaN(t[a])&&(t[a]=s.paraMargin[a]);const r=new eC(e,t,i||s.lineHeight,this.fontFinder);r.pdfFont||(r.pdfFont=s.pdfFont),this.stack.push(r)}popFont(){this.stack.pop()}topFont(){return this.stack.at(-1)}}class KG{constructor(e,t,i,s){this.glyphs=[],this.fontSelector=new WG(e,t,i,s),this.extraHeight=0}pushData(e,t,i){this.fontSelector.pushData(e,t,i)}popFont(e){return this.fontSelector.popFont()}addPara(){const e=this.fontSelector.topFont();this.extraHeight+=e.paraMargin.top+e.paraMargin.bottom}addString(e){if(!e)return;const t=this.fontSelector.topFont(),i=t.xfaFont.size;if(t.pdfFont){const s=t.xfaFont.letterSpacing,r=t.pdfFont,a=r.lineHeight||1.2,o=t.lineHeight||Math.max(1.2,a)*i,l=r.lineGap===void 0?.2:r.lineGap,c=a-l,h=Math.max(1,c)*i,u=i/1e3,d=r.defaultWidth||r.charsToGlyphs(" ")[0].width;for(const f of e.split(/[\u2029\n]/)){const g=r.encodeString(f).join(""),m=r.charsToGlyphs(g);for(const x of m){const p=x.width||d;this.glyphs.push([p*u+s,o,h,x.unicode,!1])}this.glyphs.push([0,0,0,`
`,!0])}this.glyphs.pop();return}for(const s of e.split(/[\u2029\n]/)){for(const r of s.split(""))this.glyphs.push([i,1.2*i,i,r,!1]);this.glyphs.push([0,0,0,`
`,!0])}this.glyphs.pop()}compute(e){let t=-1,i=0,s=0,r=0,a=0,o=0,l=!1,c=!0;for(let h=0,u=this.glyphs.length;h<u;h++){const[d,f,g,m,x]=this.glyphs[h],p=m===" ",y=c?g:f;if(x){s=Math.max(s,a),a=0,r+=o,o=y,t=-1,i=0,c=!1;continue}if(p){a+d>e?(s=Math.max(s,a),a=0,r+=o,o=y,t=-1,i=0,l=!0,c=!1):(o=Math.max(y,o),i=a,a+=d,t=h);continue}if(a+d>e){r+=o,o=y,t!==-1?(h=t,s=Math.max(s,i),a=0,t=-1,i=0):(s=Math.max(s,a),a=d),l=!0,c=!1;continue}a+=d,o=Math.max(y,o)}return s=Math.max(s,a),r+=o+this.extraHeight,{width:qG*s,height:r,isBroken:l}}}const tC=/^[^.[]+/,XG=/^[^\]]+/,Ha={dot:0,dotDot:1,dotHash:2,dotBracket:3,dotParen:4},_M=new Map([["$data",(n,e)=>n.datasets?n.datasets.data:n],["$record",(n,e)=>(n.datasets?n.datasets.data:n)[js]()[0]],["$template",(n,e)=>n.template],["$connectionSet",(n,e)=>n.connectionSet],["$form",(n,e)=>n.form],["$layout",(n,e)=>n.layout],["$host",(n,e)=>n.host],["$dataWindow",(n,e)=>n.dataWindow],["$event",(n,e)=>n.event],["!",(n,e)=>n.datasets],["$xfa",(n,e)=>n],["xfa",(n,e)=>n],["$",(n,e)=>e]]),nC=new WeakMap;function YG(n){return n=n.trim(),n==="*"?1/0:parseInt(n,10)||0}function vM(n,e,t=!0){let i=n.match(tC);if(!i)return null;let[s]=i;const r=[{name:s,cacheName:"."+s,index:0,js:null,formCalc:null,operator:Ha.dot}];let a=s.length;for(;a<n.length;){const o=a;if(n.charAt(a++)==="["){if(i=n.slice(a).match(XG),!i)return ce("XFA - Invalid index in SOM expression"),null;r.at(-1).index=YG(i[0]),a+=i[0].length+1;continue}let c;switch(n.charAt(a)){case".":if(!e)return null;a++,c=Ha.dotDot;break;case"#":a++,c=Ha.dotHash;break;case"[":if(t)return ce("XFA - SOM expression contains a FormCalc subexpression which is not supported for now."),null;c=Ha.dotBracket;break;case"(":if(t)return ce("XFA - SOM expression contains a JavaScript subexpression which is not supported for now."),null;c=Ha.dotParen;break;default:c=Ha.dot;break}if(i=n.slice(a).match(tC),!i)break;[s]=i,a+=s.length,r.push({name:s,cacheName:n.slice(o,a),operator:c,index:0,js:null,formCalc:null})}return r}function M0(n,e,t,i=!0,s=!0){const r=vM(t,i);if(!r)return null;const a=_M.get(r[0].name);let o=0,l;a?(l=!0,n=[a(n,e)],o=1):(l=e===null,n=[e||n]);for(let c=r.length;o<c;o++){const{name:h,cacheName:u,operator:d,index:f}=r[o],g=[];for(const m of n){if(!m.isXFAObject)continue;let x,p;if(s&&(p=nC.get(m),p||(p=new Map,nC.set(m,p)),x=p.get(u)),!x){switch(d){case Ha.dot:x=m[Yp](h,!1);break;case Ha.dotDot:x=m[Yp](h,!0);break;case Ha.dotHash:x=m[ay](h),x=x.isXFAObjectArray?x.children:[x];break}s&&p.set(u,x)}x.length>0&&g.push(x)}if(g.length===0&&!l&&o===0){if(e=e[$t](),!e)return null;o=-1,n=[e];continue}n=isFinite(f)?g.filter(m=>f<m.length).map(m=>m[f]):g.flat()}return n.length===0?null:n}function JG(n,e,t){const i=vM(t);if(!i||i.some(a=>a.operator===Ha.dotDot))return null;const s=_M.get(i[0].name);let r=0;s?(n=s(n,e),r=1):n=e||n;for(let a=i.length;r<a;r++){const{name:o,operator:l,index:c}=i[r];if(!isFinite(c))return i[r].index=0,n.createNodes(i.slice(r));let h;switch(l){case Ha.dot:h=n[Yp](o,!1);break;case Ha.dotDot:h=n[Yp](o,!0);break;case Ha.dotHash:h=n[ay](o),h=h.isXFAObjectArray?h.children:[h];break}if(h.length===0)return n.createNodes(i.slice(r));if(c<h.length){const u=h[c];if(!u.isXFAObject)return ce("XFA - Cannot create a node."),null;n=u}else return i[r].index=c-h.length,n.createNodes(i.slice(r))}return null}const n9=Symbol(),tu=Symbol(),bf=Symbol(),dn=Symbol("_children"),Pw=Symbol(),I0=Symbol(),Nw=Symbol(),iC=Symbol(),Ow=Symbol(),sC=Symbol(),Dw=Symbol(),up=Symbol(),i9=Symbol(),co=Symbol("parent"),Bm=Symbol(),Um=Symbol(),Fw=Symbol();let u6=0;const kM=es.datasets.id;class Se{constructor(e,t,i=!1){this[Ji]=e,this[On]=t,this[Dw]=i,this[co]=null,this[dn]=[],this[Vn]=`${t}${u6++}`,this[ei]=null}get isXFAObject(){return!0}get isXFAObjectArray(){return!1}createNodes(e){let t=this,i=null;for(const{name:s,index:r}of e){for(let a=0,o=isFinite(r)?r:0;a<=o;a++){const l=t[Ji]===kM?-1:t[Ji];i=new $l(l,s),t[Li](i)}t=i}return i}[Ql](e){if(!this[Dw]||!this[c6](e))return!1;const t=e[On],i=this[t];if(i instanceof le){if(i.push(e))return this[Li](e),!0}else return i!==null&&this[Nh](i),this[t]=e,this[Li](e),!0;let s="";return this.id?s=` (id: ${this.id})`:this.name&&(s=` (name: ${this.name} ${this.h.value})`),ce(`XFA - node "${this[On]}"${s} has already enough "${t}"!`),!1}[c6](e){return this.hasOwnProperty(e[On])&&e[Ji]===this[Ji]}[wp](){return!1}[ry](){return!1}[B4](){return!1}[cf](){return!1}[ha](){this.para&&this[Yi]()[_e].paraStack.pop()}[Jg](){this[Yi]()[_e].paraStack.push(this.para)}[h6](e){this.id&&this[Ji]===es.template.id&&e.set(this.id,this)}[Yi](){return this[ei].template}[l0](){return!1}[w0](){return!1}[Li](e){e[co]=this,this[dn].push(e),!e[ei]&&this[ei]&&(e[ei]=this[ei])}[Nh](e){const t=this[dn].indexOf(e);this[dn].splice(t,1)}[Jp](){return this.hasOwnProperty("value")}[ga](e){}[c0](e){}[ti](){}[wo](e){delete this[Dw],this[o3]&&(e.clean(this[o3]),delete this[o3])}[l6](e){return this[dn].indexOf(e)}[l3](e,t){t[co]=this,this[dn].splice(e,0,t),!t[ei]&&this[ei]&&(t[ei]=this[ei])}[Zp](){return!this.name}[BG](){return""}[bs](){return this[dn].length===0?this[Oe]:this[dn].map(e=>e[bs]()).join("")}get[bf](){const e=Object.getPrototypeOf(this);if(!e._attributes){const t=e._attributes=new Set;for(const i of Object.getOwnPropertyNames(this)){if(this[i]===null||this[i]instanceof Se||this[i]instanceof le)break;t.add(i)}}return Ze(this,bf,e._attributes)}[D0](e){let t=this;for(;t;){if(t===e)return!0;t=t[$t]()}return!1}[$t](){return this[co]}[Qi](){return this[$t]()}[js](e=null){return e?this[e]:this[dn]}[Ng](){const e=Object.create(null);this[Oe]&&(e.$content=this[Oe]);for(const t of Object.getOwnPropertyNames(this)){const i=this[t];i!==null&&(i instanceof Se?e[t]=i[Ng]():i instanceof le?i.isEmpty()||(e[t]=i.dump()):e[t]=i)}return e}[Rn](){return null}[Kt](){return Tt.EMPTY}*[Og](){for(const e of this[js]())yield e}*[iC](e,t){for(const i of this[Og]())if(!e||t===e.has(i[On])){const s=this[Hd](),r=i[Kt](s);r.success||(this[_e].failingNode=i),yield r}}[gx](){return null}[Ud](e,t){this[_e].children.push(e)}[Hd](){}[zh]({filter:e=null,include:t=!0}){if(!this[_e].generator)this[_e].generator=this[iC](e,t);else{const i=this[Hd](),s=this[_e].failingNode[Kt](i);if(!s.success)return s;s.html&&this[Ud](s.html,s.bbox),delete this[_e].failingNode}for(;;){const i=this[_e].generator.next();if(i.done)break;const s=i.value;if(!s.success)return s;s.html&&this[Ud](s.html,s.bbox)}return this[_e].generator=null,Tt.EMPTY}[yM](e){this[Um]=new Set(Object.keys(e))}[sC](e){const t=this[bf],i=this[Um];return[...e].filter(s=>t.has(s)&&!i.has(s))}[hp](e,t=new Set){for(const i of this[dn])i[Bm](e,t)}[Bm](e,t){const i=this[Ow](e,t);i?this[n9](i,e,t):this[hp](e,t)}[Ow](e,t){const{use:i,usehref:s}=this;if(!i&&!s)return null;let r=null,a=null,o=null,l=i;if(s?(l=s,s.startsWith("#som(")&&s.endsWith(")")?a=s.slice(5,-1):s.startsWith(".#som(")&&s.endsWith(")")?a=s.slice(6,-1):s.startsWith("#")?o=s.slice(1):s.startsWith(".#")&&(o=s.slice(2))):i.startsWith("#")?o=i.slice(1):a=i,this.use=this.usehref="",o?r=e.get(o):(r=M0(e.get(xM),this,a,!0,!1),r&&(r=r[0])),!r)return ce(`XFA - Invalid prototype reference: ${l}.`),null;if(r[On]!==this[On])return ce(`XFA - Incompatible prototype: ${r[On]} !== ${this[On]}.`),null;if(t.has(r))return ce("XFA - Cycle detected in prototypes use."),null;t.add(r);const c=r[Ow](e,t);return c&&r[n9](c,e,t),r[hp](e,t),t.delete(r),r}[n9](e,t,i){if(i.has(e)){ce("XFA - Cycle detected in prototypes use.");return}!this[Oe]&&e[Oe]&&(this[Oe]=e[Oe]),new Set(i).add(e);for(const r of this[sC](e[Um]))this[r]=e[r],this[Um]&&this[Um].add(r);for(const r of Object.getOwnPropertyNames(this)){if(this[bf].has(r))continue;const a=this[r],o=e[r];if(a instanceof le){for(const l of a[dn])l[Bm](t,i);for(let l=a[dn].length,c=o[dn].length;l<c;l++){const h=e[dn][l][Xo]();if(a.push(h))h[co]=this,this[dn].push(h),h[Bm](t,i);else break}continue}if(a!==null){a[hp](t,i),o&&a[n9](o,t,i);continue}if(o!==null){const l=o[Xo]();l[co]=this,this[r]=l,this[dn].push(l),l[Bm](t,i)}}}static[Pw](e){return Array.isArray(e)?e.map(t=>Se[Pw](t)):typeof e=="object"&&e!==null?Object.assign({},e):e}[Xo](){const e=Object.create(Object.getPrototypeOf(this));for(const t of Object.getOwnPropertySymbols(this))try{e[t]=this[t]}catch{Ze(e,t,this[t])}e[Vn]=`${e[On]}${u6++}`,e[dn]=[];for(const t of Object.getOwnPropertyNames(this)){if(this[bf].has(t)){e[t]=Se[Pw](this[t]);continue}const i=this[t];e[t]=i instanceof le?new le(i[up]):null}for(const t of this[dn]){const i=t[On],s=t[Xo]();e[dn].push(s),s[co]=e,e[i]===null?e[i]=s:e[i][dn].push(s)}return e}[js](e=null){return e?this[dn].filter(t=>t[On]===e):this[dn]}[ay](e){return this[e]}[Yp](e,t,i=!0){return Array.from(this[xp](e,t,i))}*[xp](e,t,i=!0){if(e==="parent"){yield this[co];return}for(const s of this[dn])s[On]===e&&(yield s),s.name===e&&(yield s),(t||s[Zp]())&&(yield*s[xp](e,t,!1));i&&this[bf].has(e)&&(yield new H4(this,e,this[e]))}}class le{constructor(e=1/0){this[up]=e,this[dn]=[]}get isXFAObject(){return!1}get isXFAObjectArray(){return!0}push(e){return this[dn].length<=this[up]?(this[dn].push(e),!0):(ce(`XFA - node "${e[On]}" accepts no more than ${this[up]} children`),!1)}isEmpty(){return this[dn].length===0}dump(){return this[dn].length===1?this[dn][0][Ng]():this[dn].map(e=>e[Ng]())}[Xo](){const e=new le(this[up]);return e[dn]=this[dn].map(t=>t[Xo]()),e}get children(){return this[dn]}clear(){this[dn].length=0}}class H4{constructor(e,t,i){this[co]=e,this[On]=t,this[Oe]=i,this[ql]=!1,this[Vn]=`attribute${u6++}`}[$t](){return this[co]}[Bf](){return!0}[L4](){return this[Oe].trim()}[ga](e){e=e.value||"",this[Oe]=e.toString()}[bs](){return this[Oe]}[D0](e){return this[co]===e||this[co][D0](e)}}class $l extends Se{constructor(e,t,i={}){if(super(e,t),this[Oe]="",this[I0]=null,t!=="#text"){const s=new Map;this[tu]=s;for(const[r,a]of Object.entries(i))s.set(r,new H4(this,r,a));if(i.hasOwnProperty(t0)){const r=i[t0].xfa.dataNode;r!==void 0&&(r==="dataGroup"?this[I0]=!1:r==="dataValue"&&(this[I0]=!0))}}this[ql]=!1}[_p](e){const t=this[On];if(t==="#text"){e.push(n1(this[Oe]));return}const i=k7(t),s=this[Ji]===kM?"xfa:":"";e.push(`<${s}${i}`);for(const[r,a]of this[tu].entries()){const o=k7(r);e.push(` ${o}="${n1(a[Oe])}"`)}if(this[I0]!==null&&(this[I0]?e.push(' xfa:dataNode="dataValue"'):e.push(' xfa:dataNode="dataGroup"')),!this[Oe]&&this[dn].length===0){e.push("/>");return}if(e.push(">"),this[Oe])typeof this[Oe]=="string"?e.push(n1(this[Oe])):this[Oe][_p](e);else for(const r of this[dn])r[_p](e);e.push(`</${s}${i}>`)}[Ql](e){if(this[Oe]){const t=new $l(this[Ji],"#text");this[Li](t),t[Oe]=this[Oe],this[Oe]=""}return this[Li](e),!0}[c0](e){this[Oe]+=e}[ti](){if(this[Oe]&&this[dn].length>0){const e=new $l(this[Ji],"#text");this[Li](e),e[Oe]=this[Oe],delete this[Oe]}}[Kt](){return this[On]==="#text"?Tt.success({name:"#text",value:this[Oe]}):Tt.EMPTY}[js](e=null){return e?this[dn].filter(t=>t[On]===e):this[dn]}[bM](){return this[tu]}[ay](e){const t=this[tu].get(e);return t!==void 0?t:this[js](e)}*[xp](e,t){const i=this[tu].get(e);i&&(yield i);for(const s of this[dn])s[On]===e&&(yield s),t&&(yield*s[xp](e,t))}*[o6](e,t){const i=this[tu].get(e);i&&(!t||!i[ql])&&(yield i);for(const s of this[dn])yield*s[o6](e,t)}*[yp](e,t,i){for(const s of this[dn])s[On]===e&&(!i||!s[ql])&&(yield s),t&&(yield*s[yp](e,t,i))}[Bf](){return this[I0]===null?this[dn].length===0||this[dn][0][Ji]===es.xhtml.id:this[I0]}[L4](){return this[I0]===null?this[dn].length===0?this[Oe].trim():this[dn][0][Ji]===es.xhtml.id?this[dn][0][bs]().trim():null:this[Oe].trim()}[ga](e){e=e.value||"",this[Oe]=e.toString()}[Ng](e=!1){const t=Object.create(null);e&&(t.$ns=this[Ji]),this[Oe]&&(t.$content=this[Oe]),t.$name=this[On],t.children=[];for(const i of this[dn])t.children.push(i[Ng](e));t.attributes=Object.create(null);for(const[i,s]of this[tu])t.attributes[i]=s[Oe];return t}}class zi extends Se{constructor(e,t){super(e,t),this[Oe]=""}[c0](e){this[Oe]+=e}[ti](){}}class qn extends zi{constructor(e,t,i){super(e,t),this[i9]=i}[ti](){this[Oe]=ly({data:this[Oe],defaultValue:this[i9][0],validate:e=>this[i9].includes(e)})}[wo](e){super[wo](e),delete this[i9]}}class bn extends zi{[ti](){this[Oe]=this[Oe].trim()}}class ul extends zi{constructor(e,t,i,s){super(e,t),this[Nw]=i,this[Fw]=s}[ti](){this[Oe]=Qt({data:this[Oe],defaultValue:this[Nw],validate:this[Fw]})}[wo](e){super[wo](e),delete this[Nw],delete this[Fw]}}class ys extends ul{constructor(e,t){super(e,t,0,i=>i===1)}}class CM extends ul{constructor(e,t){super(e,t,1,i=>i===0)}}function Zt(n){return typeof n=="string"?"0px":Number.isInteger(n)?`${n}px`:`${n.toFixed(2)}px`}const rC={anchorType(n,e){const t=n[Qi]();if(!(!t||t.layout&&t.layout!=="position"))switch("transform"in e||(e.transform=""),n.anchorType){case"bottomCenter":e.transform+="translate(-50%, -100%)";break;case"bottomLeft":e.transform+="translate(0,-100%)";break;case"bottomRight":e.transform+="translate(-100%,-100%)";break;case"middleCenter":e.transform+="translate(-50%,-50%)";break;case"middleLeft":e.transform+="translate(0,-50%)";break;case"middleRight":e.transform+="translate(-100%,-50%)";break;case"topCenter":e.transform+="translate(-50%,0)";break;case"topRight":e.transform+="translate(-100%,0)";break}},dimensions(n,e){var r;const t=n[Qi]();let i=n.w;const s=n.h;if((r=t.layout)!=null&&r.includes("row")){const a=t[_e],o=n.colSpan;let l;o===-1?(l=Math.sumPrecise(a.columnWidths.slice(a.currentColumn)),a.currentColumn=0):(l=Math.sumPrecise(a.columnWidths.slice(a.currentColumn,a.currentColumn+o)),a.currentColumn=(a.currentColumn+n.colSpan)%a.columnWidths.length),isNaN(l)||(i=n.w=l)}e.width=i!==""?Zt(i):"auto",e.height=s!==""?Zt(s):"auto"},position(n,e){const t=n[Qi]();t!=null&&t.layout&&t.layout!=="position"||(e.position="absolute",e.left=Zt(n.x),e.top=Zt(n.y))},rotate(n,e){n.rotate&&("transform"in e||(e.transform=""),e.transform+=`rotate(-${n.rotate}deg)`,e.transformOrigin="top left")},presence(n,e){switch(n.presence){case"invisible":e.visibility="hidden";break;case"hidden":case"inactive":e.display="none";break}},hAlign(n,e){if(n[On]==="para")switch(n.hAlign){case"justifyAll":e.textAlign="justify-all";break;case"radix":e.textAlign="left";break;default:e.textAlign=n.hAlign}else switch(n.hAlign){case"left":e.alignSelf="start";break;case"center":e.alignSelf="center";break;case"right":e.alignSelf="end";break}},margin(n,e){n.margin&&(e.margin=n.margin[Rn]().margin)}};function AM(n,e){n[Qi]().layout==="position"&&(n.minW>0&&(e.minWidth=Zt(n.minW)),n.maxW>0&&(e.maxWidth=Zt(n.maxW)),n.minH>0&&(e.minHeight=Zt(n.minH)),n.maxH>0&&(e.maxHeight=Zt(n.maxH)))}function aC(n,e,t,i,s,r){const a=new KG(e,t,i,s);return typeof n=="string"?a.addString(n):n[rc](a),a.compute(r)}function z4(n,e){let t=null,i=null,s=!1;if((!n.w||!n.h)&&n.value){let r=0,a=0;n.margin&&(r=n.margin.leftInset+n.margin.rightInset,a=n.margin.topInset+n.margin.bottomInset);let o=null,l=null;n.para&&(l=Object.create(null),o=n.para.lineHeight===""?null:n.para.lineHeight,l.top=n.para.spaceAbove===""?0:n.para.spaceAbove,l.bottom=n.para.spaceBelow===""?0:n.para.spaceBelow,l.left=n.para.marginLeft===""?0:n.para.marginLeft,l.right=n.para.marginRight===""?0:n.para.marginRight);let c=n.font;if(!c){const d=n[Yi]();let f=n[$t]();for(;f&&f!==d;){if(f.font){c=f.font;break}f=f[$t]()}}const h=(n.w||e.width)-r,u=n[ei].fontFinder;if(n.value.exData&&n.value.exData[Oe]&&n.value.exData.contentType==="text/html"){const d=aC(n.value.exData[Oe],c,l,o,u,h);i=d.width,t=d.height,s=d.isBroken}else{const d=n.value[bs]();if(d){const f=aC(d,c,l,o,u,h);i=f.width,t=f.height,s=f.isBroken}}i!==null&&!n.w&&(i+=r),t!==null&&!n.h&&(t+=a)}return{w:i,h:t,isBroken:s}}function SM(n,e,t){let i;if(n.w!==""&&n.h!=="")i=[n.x,n.y,n.w,n.h];else{if(!t)return null;let s=n.w;if(s===""){if(n.maxW===0){const a=n[Qi]();s=a.layout==="position"&&a.w!==""?0:n.minW}else s=Math.min(n.maxW,t.width);e.attributes.style.width=Zt(s)}let r=n.h;if(r===""){if(n.maxH===0){const a=n[Qi]();r=a.layout==="position"&&a.h!==""?0:n.minH}else r=Math.min(n.maxH,t.height);e.attributes.style.height=Zt(r)}i=[n.x,n.y,s,r]}return i}function cy(n){var t;const e=n[Qi]();if((t=e.layout)!=null&&t.includes("row")){const i=e[_e],s=n.colSpan;let r;s===-1?r=Math.sumPrecise(i.columnWidths.slice(i.currentColumn)):r=Math.sumPrecise(i.columnWidths.slice(i.currentColumn,i.currentColumn+s)),isNaN(r)||(n.w=r)}e.layout&&e.layout!=="position"&&(n.x=n.y=0),n.layout==="table"&&n.w===""&&Array.isArray(n.columnWidths)&&(n.w=Math.sumPrecise(n.columnWidths))}function IM(n){switch(n.layout){case"position":return"xfaPosition";case"lr-tb":return"xfaLrTb";case"rl-row":return"xfaRlRow";case"rl-tb":return"xfaRlTb";case"row":return"xfaRow";case"table":return"xfaTable";case"tb":return"xfaTb";default:return"xfaPosition"}}function ea(n,...e){const t=Object.create(null);for(const i of e){const s=n[i];if(s!==null){if(rC.hasOwnProperty(i)){rC[i](n,t);continue}if(s instanceof Se){const r=s[Rn]();r?Object.assign(t,r):ce(`(DEBUG) - XFA - style for ${i} not implemented yet`)}}}return t}function zd(n,e){const{attributes:t}=e,{style:i}=t,s={name:"div",attributes:{class:["xfaWrapper"],style:Object.create(null)},children:[]};if(t.class.push("xfaWrapped"),n.border){const{widths:r,insets:a}=n.border[_e];let o,l,c=a[0],h=a[3];const u=a[0]+a[2],d=a[1]+a[3];switch(n.border.hand){case"even":c-=r[0]/2,h-=r[3]/2,o=`calc(100% + ${(r[1]+r[3])/2-d}px)`,l=`calc(100% + ${(r[0]+r[2])/2-u}px)`;break;case"left":c-=r[0],h-=r[3],o=`calc(100% + ${r[1]+r[3]-d}px)`,l=`calc(100% + ${r[0]+r[2]-u}px)`;break;case"right":o=d?`calc(100% - ${d}px)`:"100%",l=u?`calc(100% - ${u}px)`:"100%";break}const f=["xfaBorder"];Zg(n.border)&&f.push("xfaPrintOnly");const g={name:"div",attributes:{class:f,style:{top:`${c}px`,left:`${h}px`,width:o,height:l}},children:[]};for(const m of["border","borderWidth","borderColor","borderRadius","borderStyle"])i[m]!==void 0&&(g.attributes.style[m]=i[m],delete i[m]);s.children.push(g,e)}else s.children.push(e);for(const r of["background","backgroundClip","top","left","width","height","minWidth","minHeight","maxWidth","maxHeight","transform","transformOrigin","visibility"])i[r]!==void 0&&(s.attributes.style[r]=i[r],delete i[r]);return s.attributes.style.position=i.position==="absolute"?"absolute":"relative",delete i.position,i.alignSelf&&(s.attributes.style.alignSelf=i.alignSelf,delete i.alignSelf),s}function EM(n){const e=pt(n.textIndent,"0px");if(e>=0)return;const i="padding"+((n.textAlign==="right"?"right":"left")==="left"?"Left":"Right"),s=pt(n[i],"0px");n[i]=`${s-e}px`}function j4(n,e){switch(n.access){case"nonInteractive":e.push("xfaNonInteractive");break;case"readOnly":e.push("xfaReadOnly");break;case"protected":e.push("xfaDisabled");break}}function Zg(n){return n.relevant.length>0&&!n.relevant[0].excluded&&n.relevant[0].viewname==="print"}function TM(n){const e=n[Yi]()[_e].paraStack;return e.length?e.at(-1):null}function RM(n,e,t){var i;if((i=t.attributes.class)!=null&&i.includes("xfaRich")){e&&(n.h===""&&(e.height="auto"),n.w===""&&(e.width="auto"));const s=TM(n);if(s){const r=t.attributes.style;switch(r.display="flex",r.flexDirection="column",s.vAlign){case"top":r.justifyContent="start";break;case"bottom":r.justifyContent="end";break;case"middle":r.justifyContent="center";break}const a=s[Rn]();for(const[o,l]of Object.entries(a))o in r||(r[o]=l)}}}function MM(n,e,t,i){if(!t){delete i.fontFamily;return}const s=oy(n.typeface);i.fontFamily=`"${s}"`;const r=t.find(s);if(r){const{fontFamily:a}=r.regular.cssFontInfo;a!==s&&(i.fontFamily=`"${a}"`);const o=TM(e);if(o&&o.lineHeight!==""||i.lineHeight)return;const l=U4(n,r);l&&(i.lineHeight=Math.max(1.2,l.lineHeight))}}function PM(n){const e=S3(n,null,{addDefaultProtocol:!0,tryConvertEncoding:!0});return e?e.href:null}function NM(n,e){return{name:"div",attributes:{class:[n.layout==="lr-tb"?"xfaLr":"xfaRl"]},children:e}}function OM(n){if(!n[_e])return null;const t={name:"div",attributes:n[_e].attributes,children:n[_e].children};if(n[_e].failingNode){const i=n[_e].failingNode[gx]();i&&(n.layout.endsWith("-tb")?t.children.push(NM(n,[i])):t.children.push(i))}return t.children.length===0?null:t}function DM(n,e,t){const i=n[_e],s=i.availableSpace,[r,a,o,l]=t;switch(n.layout){case"position":{i.width=Math.max(i.width,r+o),i.height=Math.max(i.height,a+l),i.children.push(e);break}case"lr-tb":case"rl-tb":(!i.line||i.attempt===1)&&(i.line=NM(n,[]),i.children.push(i.line),i.numberInLine=0),i.numberInLine+=1,i.line.children.push(e),i.attempt===0?(i.currentWidth+=o,i.height=Math.max(i.height,i.prevHeight+l)):(i.currentWidth=o,i.prevHeight=i.height,i.height+=l,i.attempt=0),i.width=Math.max(i.width,i.currentWidth);break;case"rl-row":case"row":{i.children.push(e),i.width+=o,i.height=Math.max(i.height,l);const c=Zt(i.height);for(const h of i.children)h.attributes.style.height=c;break}case"table":{i.width=zs(o,i.width,s.width),i.height+=l,i.children.push(e);break}case"tb":{i.width=zs(o,i.width,s.width),i.height+=l,i.children.push(e);break}}}function FM(n){const e=n[_e].availableSpace,t=n.margin?n.margin.topInset+n.margin.bottomInset:0,i=n.margin?n.margin.leftInset+n.margin.rightInset:0;switch(n.layout){case"lr-tb":case"rl-tb":return n[_e].attempt===0?{width:e.width-i-n[_e].currentWidth,height:e.height-t-n[_e].prevHeight}:{width:e.width-i,height:e.height-t-n[_e].height};case"rl-row":case"row":return{width:Math.sumPrecise(n[_e].columnWidths.slice(n[_e].currentColumn)),height:e.height-i};case"table":case"tb":return{width:e.width-i,height:e.height-t-n[_e].height};case"position":default:return e}}function ZG(n){let e=n.w===""?NaN:n.w,t=n.h===""?NaN:n.h,[i,s]=[0,0];switch(n.anchorType||""){case"bottomCenter":[i,s]=[e/2,t];break;case"bottomLeft":[i,s]=[0,t];break;case"bottomRight":[i,s]=[e,t];break;case"middleCenter":[i,s]=[e/2,t/2];break;case"middleLeft":[i,s]=[0,t/2];break;case"middleRight":[i,s]=[e,t/2];break;case"topCenter":[i,s]=[e/2,0];break;case"topRight":[i,s]=[e,0];break}let r,a;switch(n.rotate||0){case 0:[r,a]=[-i,-s];break;case 90:[r,a]=[-s,i],[e,t]=[t,-e];break;case 180:[r,a]=[i,s],[e,t]=[-e,-t];break;case 270:[r,a]=[s,-i],[e,t]=[-t,e];break}return[n.x+r+Math.min(0,e),n.y+a+Math.min(0,t),Math.abs(e),Math.abs(t)]}function hy(n,e){var l;if(n[Yi]()[_e].firstUnsplittable===null||n.w===0||n.h===0)return!0;const t=2,i=n[Qi](),s=((l=i[_e])==null?void 0:l.attempt)||0,[,r,a,o]=ZG(n);switch(i.layout){case"lr-tb":case"rl-tb":return s===0?n[Yi]()[_e].noLayoutFailure?n.w!==""?Math.round(a-e.width)<=t:e.width>t:n.h!==""&&Math.round(o-e.height)>t?!1:n.w!==""?Math.round(a-e.width)<=t?!0:i[_e].numberInLine===0?e.height>t:!1:e.width>t:n[Yi]()[_e].noLayoutFailure?!0:n.h!==""&&Math.round(o-e.height)>t?!1:n.w===""||Math.round(a-e.width)<=t?e.height>t:i[w0]()?!1:e.height>t;case"table":case"tb":return n[Yi]()[_e].noLayoutFailure?!0:n.h!==""&&!n[l0]()?Math.round(o-e.height)<=t:n.w===""||Math.round(a-e.width)<=t?e.height>t:i[w0]()?!1:e.height>t;case"position":if(n[Yi]()[_e].noLayoutFailure||n.h===""||Math.round(o+r-e.height)<=t)return!0;const c=n[Yi]()[_e].currentContentArea;return o+r>c.h;case"rl-row":case"row":return n[Yi]()[_e].noLayoutFailure?!0:n.h!==""?Math.round(o-e.height)<=t:!0;default:return!0}}const et=es.template.id,jd="http://www.w3.org/2000/svg",L3=2,QG=3,$G=5e3,eV=/^H(\d+)$/,tV=new Set(["image/gif","image/jpeg","image/jpg","image/pjpeg","image/png","image/apng","image/x-png","image/bmp","image/x-ms-bmp","image/tiff","image/tif","application/octet-stream"]),nV=[[[66,77],"image/bmp"],[[255,216,255],"image/jpeg"],[[73,73,42,0],"image/tiff"],[[77,77,0,42],"image/tiff"],[[71,73,70,56,57,97],"image/gif"],[[137,80,78,71,13,10,26,10],"image/png"]];function oC(n){if(!n||!n.border)return{w:0,h:0};const e=n.border[hr]();return e?{w:e.widths[0]+e.widths[2]+e.insets[0]+e.insets[2],h:e.widths[1]+e.widths[3]+e.insets[1]+e.insets[3]}:{w:0,h:0}}function G4(n){return n.margin&&(n.margin.topInset||n.margin.rightInset||n.margin.bottomInset||n.margin.leftInset)}function V4(n,e){if(!n.value){const t=new Z4({});n[Li](t),n.value=t}n.value[ga](e)}function*q4(n){for(const e of n[js]()){if(e instanceof X4){yield*e[Og]();continue}yield e}}function mx(n){var e;return((e=n.validate)==null?void 0:e.nullTest)==="error"}function uy(n){for(;n;){if(!n.traversal){n[Vo]=n[$t]()[Vo];return}if(n[Vo])return;let e=null;for(const s of n.traversal[js]())if(s.operation==="next"){e=s;break}if(!e||!e.ref){n[Vo]=n[$t]()[Vo];return}const t=n[Yi]();n[Vo]=++t[Vo];const i=t[n0](e.ref,n);if(!i)return;n=i[0]}}function dy(n,e){var i;const t=n.assist;if(t){const s=t[Kt]();s&&(e.title=s);const a=t.role.match(eV);if(a){const o="heading",l=a[1];e.role=o,e["aria-level"]=l}}if(n.layout==="table")e.role="table";else if(n.layout==="row")e.role="row";else{const s=n[$t]();s.layout==="row"&&(e.role=((i=s.assist)==null?void 0:i.role)==="TH"?"columnheader":"cell")}}function Jd(n){if(!n.assist)return null;const e=n.assist;return e.speak&&e.speak[Oe]!==""?e.speak[Oe]:e.toolTip?e.toolTip[Oe]:null}function Xh(n){return Tt.success({name:"div",attributes:{class:["xfaRich"],style:Object.create(null)},children:[{name:"span",attributes:{style:Object.create(null)},value:n}]})}function fy(n){const e=n[Yi]();e[_e].firstUnsplittable===null&&(e[_e].firstUnsplittable=n,e[_e].noLayoutFailure=!0)}function gy(n){const e=n[Yi]();e[_e].firstUnsplittable===n&&(e[_e].noLayoutFailure=!1)}function lC(n){if(n[_e]||(n[_e]=Object.create(null),n.targetType==="auto"))return!1;const e=n[Yi]();let t=null;if(n.target){if(t=e[n0](n.target,n[$t]()),!t)return!1;t=t[0]}const{currentPageArea:i,currentContentArea:s}=e[_e];if(n.targetType==="pageArea")return t instanceof Dg||(t=null),n.startNew?(n[_e].target=t||i,!0):t&&t!==i?(n[_e].target=t,!0):!1;t instanceof W4||(t=null);const r=t&&t[$t]();let a,o=r;if(n.startNew)if(t){const l=r.contentArea.children,c=l.indexOf(s),h=l.indexOf(t);c!==-1&&c<h&&(o=null),a=h-1}else a=i.contentArea.children.indexOf(s);else if(t&&t!==s)a=r.contentArea.children.indexOf(t)-1,o=r===i?null:r;else return!1;return n[_e].target=o,n[_e].index=a,!0}function cC(n,e,t){const i=n[Yi](),s=i[_e].noLayoutFailure,r=e[Qi];e[Qi]=()=>n,i[_e].noLayoutFailure=!0;const a=e[Kt](t);n[Ud](a.html,a.bbox),i[_e].noLayoutFailure=s,e[Qi]=r}class iV extends bn{constructor(e){super(et,"appearanceFilter"),this.id=e.id||"",this.type=Fe(e.type,["optional","required"]),this.use=e.use||"",this.usehref=e.usehref||""}}class LM extends Se{constructor(e){super(et,"arc",!0),this.circular=Qt({data:e.circular,defaultValue:0,validate:t=>t===1}),this.hand=Fe(e.hand,["even","left","right"]),this.id=e.id||"",this.startAngle=F3({data:e.startAngle,defaultValue:0,validate:t=>!0}),this.sweepAngle=F3({data:e.sweepAngle,defaultValue:360,validate:t=>!0}),this.use=e.use||"",this.usehref=e.usehref||"",this.edge=null,this.fill=null}[Kt](){var l;const e=this.edge||new px({}),t=e[Rn](),i=Object.create(null);((l=this.fill)==null?void 0:l.presence)==="visible"?Object.assign(i,this.fill[Rn]()):i.fill="transparent",i.strokeWidth=Zt(e.presence==="visible"?e.thickness:0),i.stroke=t.color;let s;const r={xmlns:jd,style:{width:"100%",height:"100%",overflow:"visible"}};if(this.sweepAngle===360)s={name:"ellipse",attributes:{xmlns:jd,cx:"50%",cy:"50%",rx:"50%",ry:"50%",style:i}};else{const c=this.startAngle*Math.PI/180,h=this.sweepAngle*Math.PI/180,u=this.sweepAngle>180?1:0,[d,f,g,m]=[50*(1+Math.cos(c)),50*(1-Math.sin(c)),50*(1+Math.cos(c+h)),50*(1-Math.sin(c+h))];s={name:"path",attributes:{xmlns:jd,d:`M ${d} ${f} A 50 50 0 ${u} 0 ${g} ${m}`,vectorEffect:"non-scaling-stroke",style:i}},Object.assign(r,{viewBox:"0 0 100 100",preserveAspectRatio:"none"})}const a={name:"svg",children:[s],attributes:r},o=this[$t]()[$t]();return G4(o)?Tt.success({name:"div",attributes:{style:{display:"inline",width:"100%",height:"100%"}},children:[a]}):(a.attributes.style.position="absolute",Tt.success(a))}}class sV extends Se{constructor(e){super(et,"area",!0),this.colSpan=Qt({data:e.colSpan,defaultValue:1,validate:t=>t>=1||t===-1}),this.id=e.id||"",this.name=e.name||"",this.relevant=hl(e.relevant),this.use=e.use||"",this.usehref=e.usehref||"",this.x=pt(e.x,"0pt"),this.y=pt(e.y,"0pt"),this.desc=null,this.extras=null,this.area=new le,this.draw=new le,this.exObject=new le,this.exclGroup=new le,this.field=new le,this.subform=new le,this.subformSet=new le}*[Og](){yield*q4(this)}[Zp](){return!0}[cf](){return!0}[Ud](e,t){const[i,s,r,a]=t;this[_e].width=Math.max(this[_e].width,i+r),this[_e].height=Math.max(this[_e].height,s+a),this[_e].children.push(e)}[Hd](){return this[_e].availableSpace}[Kt](e){const t=ea(this,"position"),i={style:t,id:this[Vn],class:["xfaArea"]};Zg(this)&&i.class.push("xfaPrintOnly"),this.name&&(i.xfaName=this.name);const s=[];this[_e]={children:s,width:0,height:0,availableSpace:e};const r=this[zh]({filter:new Set(["area","draw","field","exclGroup","subform","subformSet"]),include:!0});if(!r.success)return r.isBreak()?r:(delete this[_e],Tt.FAILURE);t.width=Zt(this[_e].width),t.height=Zt(this[_e].height);const a={name:"div",attributes:i,children:s},o=[this.x,this.y,this[_e].width,this[_e].height];return delete this[_e],Tt.success(a,o)}}class rV extends Se{constructor(e){super(et,"assist",!0),this.id=e.id||"",this.role=e.role||"",this.use=e.use||"",this.usehref=e.usehref||"",this.speak=null,this.toolTip=null}[Kt](){var e;return((e=this.toolTip)==null?void 0:e[Oe])||null}}class aV extends Se{constructor(e){super(et,"barcode",!0),this.charEncoding=ly({data:e.charEncoding?e.charEncoding.toLowerCase():"",defaultValue:"",validate:t=>["utf-8","big-five","fontspecific","gbk","gb-18030","gb-2312","ksc-5601","none","shift-jis","ucs-2","utf-16"].includes(t)||t.match(/iso-8859-\d{2}/)}),this.checksum=Fe(e.checksum,["none","1mod10","1mod10_1mod11","2mod10","auto"]),this.dataColumnCount=Qt({data:e.dataColumnCount,defaultValue:-1,validate:t=>t>=0}),this.dataLength=Qt({data:e.dataLength,defaultValue:-1,validate:t=>t>=0}),this.dataPrep=Fe(e.dataPrep,["none","flateCompress"]),this.dataRowCount=Qt({data:e.dataRowCount,defaultValue:-1,validate:t=>t>=0}),this.endChar=e.endChar||"",this.errorCorrectionLevel=Qt({data:e.errorCorrectionLevel,defaultValue:-1,validate:t=>t>=0&&t<=8}),this.id=e.id||"",this.moduleHeight=pt(e.moduleHeight,"5mm"),this.moduleWidth=pt(e.moduleWidth,"0.25mm"),this.printCheckDigit=Qt({data:e.printCheckDigit,defaultValue:0,validate:t=>t===1}),this.rowColumnRatio=$k(e.rowColumnRatio),this.startChar=e.startChar||"",this.textLocation=Fe(e.textLocation,["below","above","aboveEmbedded","belowEmbedded","none"]),this.truncate=Qt({data:e.truncate,defaultValue:0,validate:t=>t===1}),this.type=Fe(e.type?e.type.toLowerCase():"",["aztec","codabar","code2of5industrial","code2of5interleaved","code2of5matrix","code2of5standard","code3of9","code3of9extended","code11","code49","code93","code128","code128a","code128b","code128c","code128sscc","datamatrix","ean8","ean8add2","ean8add5","ean13","ean13add2","ean13add5","ean13pwcd","fim","logmars","maxicode","msi","pdf417","pdf417macro","plessey","postauscust2","postauscust3","postausreplypaid","postausstandard","postukrm4scc","postusdpbc","postusimb","postusstandard","postus5zip","qrcode","rfid","rss14","rss14expanded","rss14limited","rss14stacked","rss14stackedomni","rss14truncated","telepen","ucc128","ucc128random","ucc128sscc","upca","upcaadd2","upcaadd5","upcapwcd","upce","upceadd2","upceadd5","upcean2","upcean5","upsmaxicode"]),this.upsMode=Fe(e.upsMode,["usCarrier","internationalCarrier","secureSymbol","standardSymbol"]),this.use=e.use||"",this.usehref=e.usehref||"",this.wideNarrowRatio=$k(e.wideNarrowRatio),this.encrypt=null,this.extras=null}}class oV extends Se{constructor(e){super(et,"bind",!0),this.match=Fe(e.match,["once","dataRef","global","none"]),this.ref=e.ref||"",this.picture=null}}class d6 extends Se{constructor(e){super(et,"bindItems"),this.connection=e.connection||"",this.labelRef=e.labelRef||"",this.ref=e.ref||"",this.valueRef=e.valueRef||""}}class lV extends Se{constructor(e){super(et,"bookend"),this.id=e.id||"",this.leader=e.leader||"",this.trailer=e.trailer||"",this.use=e.use||"",this.usehref=e.usehref||""}}class cV extends ys{constructor(e){super(et,"boolean"),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}[Kt](e){return Xh(this[Oe]===1?"1":"0")}}class BM extends Se{constructor(e){super(et,"border",!0),this.break=Fe(e.break,["close","open"]),this.hand=Fe(e.hand,["even","left","right"]),this.id=e.id||"",this.presence=Fe(e.presence,["visible","hidden","inactive","invisible"]),this.relevant=hl(e.relevant),this.use=e.use||"",this.usehref=e.usehref||"",this.corner=new le(4),this.edge=new le(4),this.extras=null,this.fill=null,this.margin=null}[hr](){if(!this[_e]){const e=this.edge.children.slice();if(e.length<4){const s=e.at(-1)||new px({});for(let r=e.length;r<4;r++)e.push(s)}const t=e.map(s=>s.thickness),i=[0,0,0,0];this.margin&&(i[0]=this.margin.topInset,i[1]=this.margin.rightInset,i[2]=this.margin.bottomInset,i[3]=this.margin.leftInset),this[_e]={widths:t,insets:i,edges:e}}return this[_e]}[Rn](){var s;const{edges:e}=this[hr](),t=e.map(r=>{const a=r[Rn]();return a.color||(a.color="#000000"),a}),i=Object.create(null);if(this.margin&&Object.assign(i,this.margin[Rn]()),((s=this.fill)==null?void 0:s.presence)==="visible"&&Object.assign(i,this.fill[Rn]()),this.corner.children.some(r=>r.radius!==0)){const r=this.corner.children.map(a=>a[Rn]());if(r.length===2||r.length===3){const a=r.at(-1);for(let o=r.length;o<4;o++)r.push(a)}i.borderRadius=r.map(a=>a.radius).join(" ")}switch(this.presence){case"invisible":case"hidden":i.borderStyle="";break;case"inactive":i.borderStyle="none";break;default:i.borderStyle=t.map(r=>r.style).join(" ");break}return i.borderWidth=t.map(r=>r.width).join(" "),i.borderColor=t.map(r=>r.color).join(" "),i}}class hV extends Se{constructor(e){super(et,"break",!0),this.after=Fe(e.after,["auto","contentArea","pageArea","pageEven","pageOdd"]),this.afterTarget=e.afterTarget||"",this.before=Fe(e.before,["auto","contentArea","pageArea","pageEven","pageOdd"]),this.beforeTarget=e.beforeTarget||"",this.bookendLeader=e.bookendLeader||"",this.bookendTrailer=e.bookendTrailer||"",this.id=e.id||"",this.overflowLeader=e.overflowLeader||"",this.overflowTarget=e.overflowTarget||"",this.overflowTrailer=e.overflowTrailer||"",this.startNew=Qt({data:e.startNew,defaultValue:0,validate:t=>t===1}),this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null}}class UM extends Se{constructor(e){super(et,"breakAfter",!0),this.id=e.id||"",this.leader=e.leader||"",this.startNew=Qt({data:e.startNew,defaultValue:0,validate:t=>t===1}),this.target=e.target||"",this.targetType=Fe(e.targetType,["auto","contentArea","pageArea"]),this.trailer=e.trailer||"",this.use=e.use||"",this.usehref=e.usehref||"",this.script=null}}class HM extends Se{constructor(e){super(et,"breakBefore",!0),this.id=e.id||"",this.leader=e.leader||"",this.startNew=Qt({data:e.startNew,defaultValue:0,validate:t=>t===1}),this.target=e.target||"",this.targetType=Fe(e.targetType,["auto","contentArea","pageArea"]),this.trailer=e.trailer||"",this.use=e.use||"",this.usehref=e.usehref||"",this.script=null}[Kt](e){return this[_e]={},Tt.FAILURE}}class uV extends Se{constructor(e){super(et,"button",!0),this.highlight=Fe(e.highlight,["inverted","none","outline","push"]),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null}[Kt](e){const i=this[$t]()[$t](),s={name:"button",attributes:{id:this[Vn],class:["xfaButton"],style:{}},children:[]};for(const r of i.event.children){if(r.activity!=="click"||!r.script)continue;const a=cR(r.script[Oe]);if(!a)continue;const o=PM(a.url);o&&s.children.push({name:"a",attributes:{id:"link"+this[Vn],href:o,newWindow:a.newWindow,class:["xfaLink"],style:{}},children:[]})}return Tt.success(s)}}class dV extends Se{constructor(e){super(et,"calculate",!0),this.id=e.id||"",this.override=Fe(e.override,["disabled","error","ignore","warning"]),this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null,this.message=null,this.script=null}}class fV extends Se{constructor(e){super(et,"caption",!0),this.id=e.id||"",this.placement=Fe(e.placement,["left","bottom","inline","right","top"]),this.presence=Fe(e.presence,["visible","hidden","inactive","invisible"]),this.reserve=Math.ceil(pt(e.reserve)),this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null,this.font=null,this.margin=null,this.para=null,this.value=null}[ga](e){V4(this,e)}[hr](e){if(!this[_e]){let{width:t,height:i}=e;switch(this.placement){case"left":case"right":case"inline":t=this.reserve<=0?t:this.reserve;break;case"top":case"bottom":i=this.reserve<=0?i:this.reserve;break}this[_e]=z4(this,{width:t,height:i})}return this[_e]}[Kt](e){if(!this.value)return Tt.EMPTY;this[Jg]();const t=this.value[Kt](e).html;if(!t)return this[ha](),Tt.EMPTY;const i=this.reserve;if(this.reserve<=0){const{w:a,h:o}=this[hr](e);switch(this.placement){case"left":case"right":case"inline":this.reserve=a;break;case"top":case"bottom":this.reserve=o;break}}const s=[];typeof t=="string"?s.push({name:"#text",value:t}):s.push(t);const r=ea(this,"font","margin","visibility");switch(this.placement){case"left":case"right":this.reserve>0&&(r.width=Zt(this.reserve));break;case"top":case"bottom":this.reserve>0&&(r.height=Zt(this.reserve));break}return RM(this,null,t),this[ha](),this.reserve=i,Tt.success({name:"div",attributes:{style:r,class:["xfaCaption"]},children:s})}}class gV extends bn{constructor(e){super(et,"certificate"),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}}class mV extends Se{constructor(e){super(et,"certificates",!0),this.credentialServerPolicy=Fe(e.credentialServerPolicy,["optional","required"]),this.id=e.id||"",this.url=e.url||"",this.urlPolicy=e.urlPolicy||"",this.use=e.use||"",this.usehref=e.usehref||"",this.encryption=null,this.issuers=null,this.keyUsage=null,this.oids=null,this.signing=null,this.subjectDNs=null}}class zM extends Se{constructor(e){super(et,"checkButton",!0),this.id=e.id||"",this.mark=Fe(e.mark,["default","check","circle","cross","diamond","square","star"]),this.shape=Fe(e.shape,["square","round"]),this.size=pt(e.size,"10pt"),this.use=e.use||"",this.usehref=e.usehref||"",this.border=null,this.extras=null,this.margin=null}[Kt](e){var x,p,y;const t=ea(this,"margin"),i=Zt(this.size);t.width=t.height=i;let s,r,a;const o=this[$t]()[$t](),l=o.items.children.length&&o.items.children[0][Kt]().html||[],c={on:(l[0]!==void 0?l[0]:"on").toString(),off:(l[1]!==void 0?l[1]:"off").toString()},u=(((x=o.value)==null?void 0:x[bs]())||"off")===c.on||void 0,d=o[Qi](),f=o[Vn];let g;d instanceof qM?(a=d[Vn],s="radio",r="xfaRadio",g=((p=d[mo])==null?void 0:p[Vn])||d[Vn]):(s="checkbox",r="xfaCheckbox",g=((y=o[mo])==null?void 0:y[Vn])||o[Vn]);const m={name:"input",attributes:{class:[r],style:t,fieldId:f,dataId:g,type:s,checked:u,xfaOn:c.on,xfaOff:c.off,"aria-label":Jd(o),"aria-required":!1}};return a&&(m.attributes.name=a),mx(o)&&(m.attributes["aria-required"]=!0,m.attributes.required=!0),Tt.success({name:"label",attributes:{class:["xfaLabel"]},children:[m]})}}class jM extends Se{constructor(e){super(et,"choiceList",!0),this.commitOn=Fe(e.commitOn,["select","exit"]),this.id=e.id||"",this.open=Fe(e.open,["userControl","always","multiSelect","onEntry"]),this.textEntry=Qt({data:e.textEntry,defaultValue:0,validate:t=>t===1}),this.use=e.use||"",this.usehref=e.usehref||"",this.border=null,this.extras=null,this.margin=null}[Kt](e){var c,h,u;const t=ea(this,"border","margin"),s=this[$t]()[$t](),a={fontSize:`calc(${((c=s.font)==null?void 0:c.size)||10}px * var(--total-scale-factor))`},o=[];if(s.items.children.length>0){const d=s.items;let f=0,g=0;d.children.length===2&&(f=d.children[0].save,g=1-f);const m=d.children[f][Kt]().html,x=d.children[g][Kt]().html;let p=!1;const y=((h=s.value)==null?void 0:h[bs]())||"";for(let w=0,_=m.length;w<_;w++){const v={name:"option",attributes:{value:x[w]||m[w],style:a},value:m[w]};x[w]===y&&(v.attributes.selected=p=!0),o.push(v)}p||o.splice(0,0,{name:"option",attributes:{hidden:!0,selected:!0},value:" "})}const l={class:["xfaSelect"],fieldId:s[Vn],dataId:((u=s[mo])==null?void 0:u[Vn])||s[Vn],style:t,"aria-label":Jd(s),"aria-required":!1};return mx(s)&&(l["aria-required"]=!0,l.required=!0),this.open==="multiSelect"&&(l.multiple=!0),Tt.success({name:"label",attributes:{class:["xfaLabel"]},children:[{name:"select",children:o,attributes:l}]})}}class pV extends Se{constructor(e){super(et,"color",!0),this.cSpace=Fe(e.cSpace,["SRGB"]),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||"",this.value=e.value?zG(e.value):"",this.extras=null}[Jp](){return!1}[Rn](){return this.value?Dn.makeHexColor(this.value.r,this.value.g,this.value.b):null}}class bV extends Se{constructor(e){super(et,"comb"),this.id=e.id||"",this.numberOfCells=Qt({data:e.numberOfCells,defaultValue:0,validate:t=>t>=0}),this.use=e.use||"",this.usehref=e.usehref||""}}class xV extends Se{constructor(e){super(et,"connect",!0),this.connection=e.connection||"",this.id=e.id||"",this.ref=e.ref||"",this.usage=Fe(e.usage,["exportAndImport","exportOnly","importOnly"]),this.use=e.use||"",this.usehref=e.usehref||"",this.picture=null}}class W4 extends Se{constructor(e){super(et,"contentArea",!0),this.h=pt(e.h),this.id=e.id||"",this.name=e.name||"",this.relevant=hl(e.relevant),this.use=e.use||"",this.usehref=e.usehref||"",this.w=pt(e.w),this.x=pt(e.x,"0pt"),this.y=pt(e.y,"0pt"),this.desc=null,this.extras=null}[Kt](e){const t=Zt(this.x),i=Zt(this.y),s={left:t,top:i,width:Zt(this.w),height:Zt(this.h)},r=["xfaContentarea"];return Zg(this)&&r.push("xfaPrintOnly"),Tt.success({name:"div",children:[],attributes:{style:s,class:r,id:this[Vn]}})}}class GM extends Se{constructor(e){super(et,"corner",!0),this.id=e.id||"",this.inverted=Qt({data:e.inverted,defaultValue:0,validate:t=>t===1}),this.join=Fe(e.join,["square","round"]),this.presence=Fe(e.presence,["visible","hidden","inactive","invisible"]),this.radius=pt(e.radius),this.stroke=Fe(e.stroke,["solid","dashDot","dashDotDot","dashed","dotted","embossed","etched","lowered","raised"]),this.thickness=pt(e.thickness,"0.5pt"),this.use=e.use||"",this.usehref=e.usehref||"",this.color=null,this.extras=null}[Rn](){const e=ea(this,"visibility");return e.radius=Zt(this.join==="square"?0:this.radius),e}}class yV extends zi{constructor(e){super(et,"date"),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}[ti](){const e=this[Oe].trim();this[Oe]=e?new Date(e):null}[Kt](e){return Xh(this[Oe]?this[Oe].toString():"")}}class wV extends zi{constructor(e){super(et,"dateTime"),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}[ti](){const e=this[Oe].trim();this[Oe]=e?new Date(e):null}[Kt](e){return Xh(this[Oe]?this[Oe].toString():"")}}class _V extends Se{constructor(e){super(et,"dateTimeEdit",!0),this.hScrollPolicy=Fe(e.hScrollPolicy,["auto","off","on"]),this.id=e.id||"",this.picker=Fe(e.picker,["host","none"]),this.use=e.use||"",this.usehref=e.usehref||"",this.border=null,this.comb=null,this.extras=null,this.margin=null}[Kt](e){var r;const t=ea(this,"border","font","margin"),i=this[$t]()[$t](),s={name:"input",attributes:{type:"text",fieldId:i[Vn],dataId:((r=i[mo])==null?void 0:r[Vn])||i[Vn],class:["xfaTextfield"],style:t,"aria-label":Jd(i),"aria-required":!1}};return mx(i)&&(s.attributes["aria-required"]=!0,s.attributes.required=!0),Tt.success({name:"label",attributes:{class:["xfaLabel"]},children:[s]})}}class vV extends zi{constructor(e){super(et,"decimal"),this.fracDigits=Qt({data:e.fracDigits,defaultValue:2,validate:t=>!0}),this.id=e.id||"",this.leadDigits=Qt({data:e.leadDigits,defaultValue:-1,validate:t=>!0}),this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}[ti](){const e=parseFloat(this[Oe].trim());this[Oe]=isNaN(e)?null:e}[Kt](e){return Xh(this[Oe]!==null?this[Oe].toString():"")}}class kV extends Se{constructor(e){super(et,"defaultUi",!0),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null}}class CV extends Se{constructor(e){super(et,"desc",!0),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||"",this.boolean=new le,this.date=new le,this.dateTime=new le,this.decimal=new le,this.exData=new le,this.float=new le,this.image=new le,this.integer=new le,this.text=new le,this.time=new le}}class AV extends qn{constructor(e){super(et,"digestMethod",["","SHA1","SHA256","SHA512","RIPEMD160"]),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||""}}class SV extends Se{constructor(e){super(et,"digestMethods",!0),this.id=e.id||"",this.type=Fe(e.type,["optional","required"]),this.use=e.use||"",this.usehref=e.usehref||"",this.digestMethod=new le}}class VM extends Se{constructor(e){super(et,"draw",!0),this.anchorType=Fe(e.anchorType,["topLeft","bottomCenter","bottomLeft","bottomRight","middleCenter","middleLeft","middleRight","topCenter","topRight"]),this.colSpan=Qt({data:e.colSpan,defaultValue:1,validate:t=>t>=1||t===-1}),this.h=e.h?pt(e.h):"",this.hAlign=Fe(e.hAlign,["left","center","justify","justifyAll","radix","right"]),this.id=e.id||"",this.locale=e.locale||"",this.maxH=pt(e.maxH,"0pt"),this.maxW=pt(e.maxW,"0pt"),this.minH=pt(e.minH,"0pt"),this.minW=pt(e.minW,"0pt"),this.name=e.name||"",this.presence=Fe(e.presence,["visible","hidden","inactive","invisible"]),this.relevant=hl(e.relevant),this.rotate=Qt({data:e.rotate,defaultValue:0,validate:t=>t%90===0}),this.use=e.use||"",this.usehref=e.usehref||"",this.w=e.w?pt(e.w):"",this.x=pt(e.x,"0pt"),this.y=pt(e.y,"0pt"),this.assist=null,this.border=null,this.caption=null,this.desc=null,this.extras=null,this.font=null,this.keep=null,this.margin=null,this.para=null,this.traversal=null,this.ui=null,this.value=null,this.setProperty=new le}[ga](e){V4(this,e)}[Kt](e){if(uy(this),this.presence==="hidden"||this.presence==="inactive")return Tt.EMPTY;cy(this),this[Jg]();const t=this.w,i=this.h,{w:s,h:r,isBroken:a}=z4(this,e);if(s&&this.w===""){if(a&&this[Qi]()[w0]())return this[ha](),Tt.FAILURE;this.w=s}if(r&&this.h===""&&(this.h=r),fy(this),!hy(this,e))return this.w=t,this.h=i,this[ha](),Tt.FAILURE;gy(this);const o=ea(this,"font","hAlign","dimensions","position","presence","rotate","anchorType","border","margin");AM(this,o),o.margin&&(o.padding=o.margin,delete o.margin);const l=["xfaDraw"];this.font&&l.push("xfaFont"),Zg(this)&&l.push("xfaPrintOnly");const c={style:o,id:this[Vn],class:l};this.name&&(c.xfaName=this.name);const h={name:"div",attributes:c,children:[]};dy(this,c);const u=SM(this,h,e),d=this.value?this.value[Kt](e).html:null;return d===null?(this.w=t,this.h=i,this[ha](),Tt.success(zd(this,h),u)):(h.children.push(d),RM(this,o,d),this.w=t,this.h=i,this[ha](),Tt.success(zd(this,h),u))}}class px extends Se{constructor(e){super(et,"edge",!0),this.cap=Fe(e.cap,["square","butt","round"]),this.id=e.id||"",this.presence=Fe(e.presence,["visible","hidden","inactive","invisible"]),this.stroke=Fe(e.stroke,["solid","dashDot","dashDotDot","dashed","dotted","embossed","etched","lowered","raised"]),this.thickness=pt(e.thickness,"0.5pt"),this.use=e.use||"",this.usehref=e.usehref||"",this.color=null,this.extras=null}[Rn](){const e=ea(this,"visibility");if(Object.assign(e,{linecap:this.cap,width:Zt(this.thickness),color:this.color?this.color[Rn]():"#000000",style:""}),this.presence!=="visible")e.style="none";else switch(this.stroke){case"solid":e.style="solid";break;case"dashDot":e.style="dashed";break;case"dashDotDot":e.style="dashed";break;case"dashed":e.style="dashed";break;case"dotted":e.style="dotted";break;case"embossed":e.style="ridge";break;case"etched":e.style="groove";break;case"lowered":e.style="inset";break;case"raised":e.style="outset";break}return e}}class IV extends qn{constructor(e){super(et,"encoding",["adbe.x509.rsa_sha1","adbe.pkcs7.detached","adbe.pkcs7.sha1"]),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||""}}class EV extends Se{constructor(e){super(et,"encodings",!0),this.id=e.id||"",this.type=Fe(e.type,["optional","required"]),this.use=e.use||"",this.usehref=e.usehref||"",this.encoding=new le}}class TV extends Se{constructor(e){super(et,"encrypt",!0),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||"",this.certificate=null}}class RV extends Se{constructor(e){super(et,"encryptData",!0),this.id=e.id||"",this.operation=Fe(e.operation,["encrypt","decrypt"]),this.target=e.target||"",this.use=e.use||"",this.usehref=e.usehref||"",this.filter=null,this.manifest=null}}class MV extends Se{constructor(e){super(et,"encryption",!0),this.id=e.id||"",this.type=Fe(e.type,["optional","required"]),this.use=e.use||"",this.usehref=e.usehref||"",this.certificate=new le}}class PV extends qn{constructor(e){super(et,"encryptionMethod",["","AES256-CBC","TRIPLEDES-CBC","AES128-CBC","AES192-CBC"]),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||""}}class NV extends Se{constructor(e){super(et,"encryptionMethods",!0),this.id=e.id||"",this.type=Fe(e.type,["optional","required"]),this.use=e.use||"",this.usehref=e.usehref||"",this.encryptionMethod=new le}}let OV=class extends Se{constructor(e){super(et,"event",!0),this.activity=Fe(e.activity,["click","change","docClose","docReady","enter","exit","full","indexChange","initialize","mouseDown","mouseEnter","mouseExit","mouseUp","postExecute","postOpen","postPrint","postSave","postSign","postSubmit","preExecute","preOpen","prePrint","preSave","preSign","preSubmit","ready","validationState"]),this.id=e.id||"",this.listen=Fe(e.listen,["refOnly","refAndDescendents"]),this.name=e.name||"",this.ref=e.ref||"",this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null,this.encryptData=null,this.execute=null,this.script=null,this.signData=null,this.submit=null}};class DV extends zi{constructor(e){super(et,"exData"),this.contentType=e.contentType||"",this.href=e.href||"",this.id=e.id||"",this.maxLength=Qt({data:e.maxLength,defaultValue:-1,validate:t=>t>=-1}),this.name=e.name||"",this.rid=e.rid||"",this.transferEncoding=Fe(e.transferEncoding,["none","base64","package"]),this.use=e.use||"",this.usehref=e.usehref||""}[B4](){return this.contentType==="text/html"}[Ql](e){return this.contentType==="text/html"&&e[Ji]===es.xhtml.id?(this[Oe]=e,!0):this.contentType==="text/xml"?(this[Oe]=e,!0):!1}[Kt](e){return this.contentType!=="text/html"||!this[Oe]?Tt.EMPTY:this[Oe][Kt](e)}}class FV extends Se{constructor(e){super(et,"exObject",!0),this.archive=e.archive||"",this.classId=e.classId||"",this.codeBase=e.codeBase||"",this.codeType=e.codeType||"",this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null,this.boolean=new le,this.date=new le,this.dateTime=new le,this.decimal=new le,this.exData=new le,this.exObject=new le,this.float=new le,this.image=new le,this.integer=new le,this.text=new le,this.time=new le}}class qM extends Se{constructor(e){super(et,"exclGroup",!0),this.access=Fe(e.access,["open","nonInteractive","protected","readOnly"]),this.accessKey=e.accessKey||"",this.anchorType=Fe(e.anchorType,["topLeft","bottomCenter","bottomLeft","bottomRight","middleCenter","middleLeft","middleRight","topCenter","topRight"]),this.colSpan=Qt({data:e.colSpan,defaultValue:1,validate:t=>t>=1||t===-1}),this.h=e.h?pt(e.h):"",this.hAlign=Fe(e.hAlign,["left","center","justify","justifyAll","radix","right"]),this.id=e.id||"",this.layout=Fe(e.layout,["position","lr-tb","rl-row","rl-tb","row","table","tb"]),this.maxH=pt(e.maxH,"0pt"),this.maxW=pt(e.maxW,"0pt"),this.minH=pt(e.minH,"0pt"),this.minW=pt(e.minW,"0pt"),this.name=e.name||"",this.presence=Fe(e.presence,["visible","hidden","inactive","invisible"]),this.relevant=hl(e.relevant),this.use=e.use||"",this.usehref=e.usehref||"",this.w=e.w?pt(e.w):"",this.x=pt(e.x,"0pt"),this.y=pt(e.y,"0pt"),this.assist=null,this.bind=null,this.border=null,this.calculate=null,this.caption=null,this.desc=null,this.extras=null,this.margin=null,this.para=null,this.traversal=null,this.validate=null,this.connect=new le,this.event=new le,this.field=new le,this.setProperty=new le}[cf](){return!0}[Jp](){return!0}[ga](e){for(const t of this.field.children){if(!t.value){const i=new Z4({});t[Li](i),t.value=i}t.value[ga](e)}}[w0](){return this.layout.endsWith("-tb")&&this[_e].attempt===0&&this[_e].numberInLine>0||this[$t]()[w0]()}[l0](){var t;const e=this[Qi]();return e[l0]()?this[_e]._isSplittable!==void 0?this[_e]._isSplittable:this.layout==="position"||this.layout.includes("row")?(this[_e]._isSplittable=!1,!1):(t=e.layout)!=null&&t.endsWith("-tb")&&e[_e].numberInLine!==0?!1:(this[_e]._isSplittable=!0,!0):!1}[gx](){return OM(this)}[Ud](e,t){DM(this,e,t)}[Hd](){return FM(this)}[Kt](e){if(uy(this),this.presence==="hidden"||this.presence==="inactive"||this.h===0||this.w===0)return Tt.EMPTY;cy(this);const t=[],i={id:this[Vn],class:[]};j4(this,i.class),this[_e]||(this[_e]=Object.create(null)),Object.assign(this[_e],{children:t,attributes:i,attempt:0,line:null,numberInLine:0,availableSpace:{width:Math.min(this.w||1/0,e.width),height:Math.min(this.h||1/0,e.height)},width:0,height:0,prevHeight:0,currentWidth:0});const s=this[l0]();if(s||fy(this),!hy(this,e))return Tt.FAILURE;const r=new Set(["field"]);if(this.layout.includes("row")){const p=this[Qi]().columnWidths;Array.isArray(p)&&p.length>0&&(this[_e].columnWidths=p,this[_e].currentColumn=0)}const a=ea(this,"anchorType","dimensions","position","presence","border","margin","hAlign"),o=["xfaExclgroup"],l=IM(this);l&&o.push(l),Zg(this)&&o.push("xfaPrintOnly"),i.style=a,i.class=o,this.name&&(i.xfaName=this.name),this[Jg]();const c=this.layout==="lr-tb"||this.layout==="rl-tb",h=c?L3:1;for(;this[_e].attempt<h;this[_e].attempt++){c&&this[_e].attempt===L3-1&&(this[_e].numberInLine=0);const p=this[zh]({filter:r,include:!0});if(p.success)break;if(p.isBreak())return this[ha](),p;if(c&&this[_e].attempt===0&&this[_e].numberInLine===0&&!this[Yi]()[_e].noLayoutFailure){this[_e].attempt=h;break}}if(this[ha](),s||gy(this),this[_e].attempt===h)return s||delete this[_e],Tt.FAILURE;let u=0,d=0;this.margin&&(u=this.margin.leftInset+this.margin.rightInset,d=this.margin.topInset+this.margin.bottomInset);const f=Math.max(this[_e].width+u,this.w||0),g=Math.max(this[_e].height+d,this.h||0),m=[this.x,this.y,f,g];this.w===""&&(a.width=Zt(f)),this.h===""&&(a.height=Zt(g));const x={name:"div",attributes:i,children:t};return dy(this,i),delete this[_e],Tt.success(zd(this,x),m)}}class LV extends Se{constructor(e){super(et,"execute"),this.connection=e.connection||"",this.executeType=Fe(e.executeType,["import","remerge"]),this.id=e.id||"",this.runAt=Fe(e.runAt,["client","both","server"]),this.use=e.use||"",this.usehref=e.usehref||""}}class BV extends Se{constructor(e){super(et,"extras",!0),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||"",this.boolean=new le,this.date=new le,this.dateTime=new le,this.decimal=new le,this.exData=new le,this.extras=new le,this.float=new le,this.image=new le,this.integer=new le,this.text=new le,this.time=new le}}class K4 extends Se{constructor(e){super(et,"field",!0),this.access=Fe(e.access,["open","nonInteractive","protected","readOnly"]),this.accessKey=e.accessKey||"",this.anchorType=Fe(e.anchorType,["topLeft","bottomCenter","bottomLeft","bottomRight","middleCenter","middleLeft","middleRight","topCenter","topRight"]),this.colSpan=Qt({data:e.colSpan,defaultValue:1,validate:t=>t>=1||t===-1}),this.h=e.h?pt(e.h):"",this.hAlign=Fe(e.hAlign,["left","center","justify","justifyAll","radix","right"]),this.id=e.id||"",this.locale=e.locale||"",this.maxH=pt(e.maxH,"0pt"),this.maxW=pt(e.maxW,"0pt"),this.minH=pt(e.minH,"0pt"),this.minW=pt(e.minW,"0pt"),this.name=e.name||"",this.presence=Fe(e.presence,["visible","hidden","inactive","invisible"]),this.relevant=hl(e.relevant),this.rotate=Qt({data:e.rotate,defaultValue:0,validate:t=>t%90===0}),this.use=e.use||"",this.usehref=e.usehref||"",this.w=e.w?pt(e.w):"",this.x=pt(e.x,"0pt"),this.y=pt(e.y,"0pt"),this.assist=null,this.bind=null,this.border=null,this.calculate=null,this.caption=null,this.desc=null,this.extras=null,this.font=null,this.format=null,this.items=new le(2),this.keep=null,this.margin=null,this.para=null,this.traversal=null,this.ui=null,this.validate=null,this.value=null,this.bindItems=new le,this.connect=new le,this.event=new le,this.setProperty=new le}[cf](){return!0}[ga](e){V4(this,e)}[Kt](e){var p,y,w,_,v;if(uy(this),!this.ui){this.ui=new J4({}),this.ui[ei]=this[ei],this[Li](this.ui);let C;switch(this.items.children.length){case 0:C=new ZM({}),this.ui.textEdit=C;break;case 1:C=new zM({}),this.ui.checkButton=C;break;case 2:C=new jM({}),this.ui.choiceList=C;break}this.ui[Li](C)}if(!this.ui||this.presence==="hidden"||this.presence==="inactive"||this.h===0||this.w===0)return Tt.EMPTY;this.caption&&delete this.caption[_e],this[Jg]();const t=this.caption?this.caption[Kt](e).html:null,i=this.w,s=this.h;let r=0,a=0;this.margin&&(r=this.margin.leftInset+this.margin.rightInset,a=this.margin.topInset+this.margin.bottomInset);let o=null;if(this.w===""||this.h===""){let C=null,k=null,I=0,S=0;if(this.ui.checkButton)I=S=this.ui.checkButton.size;else{const{w:M,h:N}=z4(this,e);M!==null?(I=M,S=N):S=VG(this.font,!0).lineNoGap}if(o=oC(this.ui[hr]()),I+=o.w,S+=o.h,this.caption){const{w:M,h:N,isBroken:F}=this.caption[hr](e);if(F&&this[Qi]()[w0]())return this[ha](),Tt.FAILURE;switch(C=M,k=N,this.caption.placement){case"left":case"right":case"inline":C+=I;break;case"top":case"bottom":k+=S;break}}else C=I,k=S;C&&this.w===""&&(C+=r,this.w=Math.min(this.maxW<=0?1/0:this.maxW,this.minW+1<C?C:this.minW)),k&&this.h===""&&(k+=a,this.h=Math.min(this.maxH<=0?1/0:this.maxH,this.minH+1<k?k:this.minH))}if(this[ha](),cy(this),fy(this),!hy(this,e))return this.w=i,this.h=s,this[ha](),Tt.FAILURE;gy(this);const l=ea(this,"font","dimensions","position","rotate","anchorType","presence","margin","hAlign");AM(this,l);const c=["xfaField"];this.font&&c.push("xfaFont"),Zg(this)&&c.push("xfaPrintOnly");const h={style:l,id:this[Vn],class:c};l.margin&&(l.padding=l.margin,delete l.margin),j4(this,c),this.name&&(h.xfaName=this.name);const u=[],d={name:"div",attributes:h,children:u};dy(this,h);const f=this.border?this.border[Rn]():null,g=SM(this,d,e),m=this.ui[Kt]().html;if(!m)return Object.assign(l,f),Tt.success(zd(this,d),g);this[Vo]&&((p=m.children)!=null&&p[0]?m.children[0].attributes.tabindex=this[Vo]:m.attributes.tabindex=this[Vo]),(y=m.attributes).style||(y.style=Object.create(null));let x=null;if(this.ui.button?(m.children.length===1&&([x]=m.children.splice(0,1)),Object.assign(m.attributes.style,f)):Object.assign(l,f),u.push(m),this.value){if(this.ui.imageEdit)m.children.push(this.value[Kt]().html);else if(!this.ui.button){let C="";if(this.value.exData)C=this.value.exData[bs]();else if(this.value.text)C=this.value.text[hr]();else{const k=this.value[Kt]().html;k!==null&&(C=k.children[0].value)}this.ui.textEdit&&((w=this.value.text)!=null&&w.maxChars)&&(m.children[0].attributes.maxLength=this.value.text.maxChars),C&&(this.ui.numericEdit&&(C=parseFloat(C),C=isNaN(C)?"":C.toString()),m.children[0].name==="textarea"?m.children[0].attributes.textContent=C:m.children[0].attributes.value=C)}}if(!this.ui.imageEdit&&((_=m.children)!=null&&_[0])&&this.h){o=o||oC(this.ui[hr]());let C=0;if(this.caption&&["top","bottom"].includes(this.caption.placement)){C=this.caption.reserve,C<=0&&(C=this.caption[hr](e).h);const k=this.h-C-a-o.h;m.children[0].attributes.style.height=Zt(k)}else m.children[0].attributes.style.height="100%"}if(x&&m.children.push(x),!t)return m.attributes.class&&m.attributes.class.push("xfaLeft"),this.w=i,this.h=s,Tt.success(zd(this,d),g);if(this.ui.button)return l.padding&&delete l.padding,t.name==="div"&&(t.name="span"),m.children.push(t),Tt.success(d,g);switch(this.ui.checkButton&&(t.attributes.class[0]="xfaCaptionForCheckButton"),(v=m.attributes).class||(v.class=[]),m.children.splice(0,0,t),this.caption.placement){case"left":m.attributes.class.push("xfaLeft");break;case"right":m.attributes.class.push("xfaRight");break;case"top":m.attributes.class.push("xfaTop");break;case"bottom":m.attributes.class.push("xfaBottom");break;case"inline":m.attributes.class.push("xfaLeft");break}return this.w=i,this.h=s,Tt.success(zd(this,d),g)}}class UV extends Se{constructor(e){super(et,"fill",!0),this.id=e.id||"",this.presence=Fe(e.presence,["visible","hidden","inactive","invisible"]),this.use=e.use||"",this.usehref=e.usehref||"",this.color=null,this.extras=null,this.linear=null,this.pattern=null,this.radial=null,this.solid=null,this.stipple=null}[Rn](){var o;const e=this[$t](),i=e[$t]()[$t](),s=Object.create(null);let r="color",a=r;e instanceof BM&&(r="background-color",a="background",i instanceof J4&&(s.backgroundColor="white")),(e instanceof XM||e instanceof LM)&&(r=a="fill",s.fill="white");for(const l of Object.getOwnPropertyNames(this)){if(l==="extras"||l==="color")continue;const c=this[l];if(!(c instanceof Se))continue;const h=c[Rn](this.color);return h&&(s[h.startsWith("#")?r:a]=h),s}if((o=this.color)!=null&&o.value){const l=this.color[Rn]();s[l.startsWith("#")?r:a]=l}return s}}class HV extends Se{constructor(e){super(et,"filter",!0),this.addRevocationInfo=Fe(e.addRevocationInfo,["","required","optional","none"]),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||"",this.version=Qt({data:this.version,defaultValue:5,validate:t=>t>=1&&t<=5}),this.appearanceFilter=null,this.certificates=null,this.digestMethods=null,this.encodings=null,this.encryptionMethods=null,this.handler=null,this.lockDocument=null,this.mdp=null,this.reasons=null,this.timeStamp=null}}class zV extends zi{constructor(e){super(et,"float"),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}[ti](){const e=parseFloat(this[Oe].trim());this[Oe]=isNaN(e)?null:e}[Kt](e){return Xh(this[Oe]!==null?this[Oe].toString():"")}}class jV extends Se{constructor(e){super(et,"font",!0),this.baselineShift=pt(e.baselineShift),this.fontHorizontalScale=F3({data:e.fontHorizontalScale,defaultValue:100,validate:t=>t>=0}),this.fontVerticalScale=F3({data:e.fontVerticalScale,defaultValue:100,validate:t=>t>=0}),this.id=e.id||"",this.kerningMode=Fe(e.kerningMode,["none","pair"]),this.letterSpacing=pt(e.letterSpacing,"0"),this.lineThrough=Qt({data:e.lineThrough,defaultValue:0,validate:t=>t===1||t===2}),this.lineThroughPeriod=Fe(e.lineThroughPeriod,["all","word"]),this.overline=Qt({data:e.overline,defaultValue:0,validate:t=>t===1||t===2}),this.overlinePeriod=Fe(e.overlinePeriod,["all","word"]),this.posture=Fe(e.posture,["normal","italic"]),this.size=pt(e.size,"10pt"),this.typeface=e.typeface||"Courier",this.underline=Qt({data:e.underline,defaultValue:0,validate:t=>t===1||t===2}),this.underlinePeriod=Fe(e.underlinePeriod,["all","word"]),this.use=e.use||"",this.usehref=e.usehref||"",this.weight=Fe(e.weight,["normal","bold"]),this.extras=null,this.fill=null}[wo](e){super[wo](e),this[ei].usedTypefaces.add(this.typeface)}[Rn](){const e=ea(this,"fill"),t=e.color;return t&&(t==="#000000"?delete e.color:t.startsWith("#")||(e.background=t,e.backgroundClip="text",e.color="transparent")),this.baselineShift&&(e.verticalAlign=Zt(this.baselineShift)),e.fontKerning=this.kerningMode==="none"?"none":"normal",e.letterSpacing=Zt(this.letterSpacing),this.lineThrough!==0&&(e.textDecoration="line-through",this.lineThrough===2&&(e.textDecorationStyle="double")),this.overline!==0&&(e.textDecoration="overline",this.overline===2&&(e.textDecorationStyle="double")),e.fontStyle=this.posture,e.fontSize=Zt(.99*this.size),MM(this,this,this[ei].fontFinder,e),this.underline!==0&&(e.textDecoration="underline",this.underline===2&&(e.textDecorationStyle="double")),e.fontWeight=this.weight,e}}class GV extends Se{constructor(e){super(et,"format",!0),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null,this.picture=null}}class VV extends bn{constructor(e){super(et,"handler"),this.id=e.id||"",this.type=Fe(e.type,["optional","required"]),this.use=e.use||"",this.usehref=e.usehref||""}}class qV extends Se{constructor(e){super(et,"hyphenation"),this.excludeAllCaps=Qt({data:e.excludeAllCaps,defaultValue:0,validate:t=>t===1}),this.excludeInitialCap=Qt({data:e.excludeInitialCap,defaultValue:0,validate:t=>t===1}),this.hyphenate=Qt({data:e.hyphenate,defaultValue:0,validate:t=>t===1}),this.id=e.id||"",this.pushCharacterCount=Qt({data:e.pushCharacterCount,defaultValue:3,validate:t=>t>=0}),this.remainCharacterCount=Qt({data:e.remainCharacterCount,defaultValue:3,validate:t=>t>=0}),this.use=e.use||"",this.usehref=e.usehref||"",this.wordCharacterCount=Qt({data:e.wordCharacterCount,defaultValue:7,validate:t=>t>=0})}}let WM=class extends bn{constructor(e){super(et,"image"),this.aspect=Fe(e.aspect,["fit","actual","height","none","width"]),this.contentType=e.contentType||"",this.href=e.href||"",this.id=e.id||"",this.name=e.name||"",this.transferEncoding=Fe(e.transferEncoding,["base64","none","package"]),this.use=e.use||"",this.usehref=e.usehref||""}[Kt](){var r;if(this.contentType&&!tV.has(this.contentType.toLowerCase()))return Tt.EMPTY;let e=(r=this[ei].images)==null?void 0:r.get(this.href);if(!e&&(this.href||!this[Oe])||(!e&&this.transferEncoding==="base64"&&(e=yU(this[Oe])),!e))return Tt.EMPTY;if(!this.contentType){for(const[a,o]of nV)if(e.length>a.length&&a.every((l,c)=>l===e[c])){this.contentType=o;break}if(!this.contentType)return Tt.EMPTY}const t=new Blob([e],{type:this.contentType});let i;switch(this.aspect){case"fit":case"actual":break;case"height":i={height:"100%",objectFit:"fill"};break;case"none":i={width:"100%",height:"100%",objectFit:"fill"};break;case"width":i={width:"100%",objectFit:"fill"};break}const s=this[$t]();return Tt.success({name:"img",attributes:{class:["xfaImage"],style:i,src:URL.createObjectURL(t),alt:s?Jd(s[$t]()):null}})}};class WV extends Se{constructor(e){super(et,"imageEdit",!0),this.data=Fe(e.data,["link","embed"]),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||"",this.border=null,this.extras=null,this.margin=null}[Kt](e){return this.data==="embed"?Tt.success({name:"div",children:[],attributes:{}}):Tt.EMPTY}}class KV extends zi{constructor(e){super(et,"integer"),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}[ti](){const e=parseInt(this[Oe].trim(),10);this[Oe]=isNaN(e)?null:e}[Kt](e){return Xh(this[Oe]!==null?this[Oe].toString():"")}}class XV extends Se{constructor(e){super(et,"issuers",!0),this.id=e.id||"",this.type=Fe(e.type,["optional","required"]),this.use=e.use||"",this.usehref=e.usehref||"",this.certificate=new le}}class f6 extends Se{constructor(e){super(et,"items",!0),this.id=e.id||"",this.name=e.name||"",this.presence=Fe(e.presence,["visible","hidden","inactive","invisible"]),this.ref=e.ref||"",this.save=Qt({data:e.save,defaultValue:0,validate:t=>t===1}),this.use=e.use||"",this.usehref=e.usehref||"",this.boolean=new le,this.date=new le,this.dateTime=new le,this.decimal=new le,this.exData=new le,this.float=new le,this.image=new le,this.integer=new le,this.text=new le,this.time=new le}[Kt](){const e=[];for(const t of this[js]())e.push(t[bs]());return Tt.success(e)}}class YV extends Se{constructor(e){super(et,"keep",!0),this.id=e.id||"";const t=["none","contentArea","pageArea"];this.intact=Fe(e.intact,t),this.next=Fe(e.next,t),this.previous=Fe(e.previous,t),this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null}}class JV extends Se{constructor(e){super(et,"keyUsage");const t=["","yes","no"];this.crlSign=Fe(e.crlSign,t),this.dataEncipherment=Fe(e.dataEncipherment,t),this.decipherOnly=Fe(e.decipherOnly,t),this.digitalSignature=Fe(e.digitalSignature,t),this.encipherOnly=Fe(e.encipherOnly,t),this.id=e.id||"",this.keyAgreement=Fe(e.keyAgreement,t),this.keyCertSign=Fe(e.keyCertSign,t),this.keyEncipherment=Fe(e.keyEncipherment,t),this.nonRepudiation=Fe(e.nonRepudiation,t),this.type=Fe(e.type,["optional","required"]),this.use=e.use||"",this.usehref=e.usehref||""}}class ZV extends Se{constructor(e){super(et,"line",!0),this.hand=Fe(e.hand,["even","left","right"]),this.id=e.id||"",this.slope=Fe(e.slope,["\\","/"]),this.use=e.use||"",this.usehref=e.usehref||"",this.edge=null}[Kt](){const e=this[$t]()[$t](),t=this.edge||new px({}),i=t[Rn](),s=Object.create(null),r=t.presence==="visible"?t.thickness:0;s.strokeWidth=Zt(r),s.stroke=i.color;let a,o,l,c,h="100%",u="100%";e.w<=r?([a,o,l,c]=["50%",0,"50%","100%"],h=s.strokeWidth):e.h<=r?([a,o,l,c]=[0,"50%","100%","50%"],u=s.strokeWidth):this.slope==="\\"?[a,o,l,c]=[0,0,"100%","100%"]:[a,o,l,c]=[0,"100%","100%",0];const f={name:"svg",children:[{name:"line",attributes:{xmlns:jd,x1:a,y1:o,x2:l,y2:c,style:s}}],attributes:{xmlns:jd,width:h,height:u,style:{overflow:"visible"}}};return G4(e)?Tt.success({name:"div",attributes:{style:{display:"inline",width:"100%",height:"100%"}},children:[f]}):(f.attributes.style.position="absolute",Tt.success(f))}}class QV extends Se{constructor(e){super(et,"linear",!0),this.id=e.id||"",this.type=Fe(e.type,["toRight","toBottom","toLeft","toTop"]),this.use=e.use||"",this.usehref=e.usehref||"",this.color=null,this.extras=null}[Rn](e){e=e?e[Rn]():"#FFFFFF";const t=this.type.replace(/([RBLT])/," $1").toLowerCase(),i=this.color?this.color[Rn]():"#000000";return`linear-gradient(${t}, ${e}, ${i})`}}class $V extends zi{constructor(e){super(et,"lockDocument"),this.id=e.id||"",this.type=Fe(e.type,["optional","required"]),this.use=e.use||"",this.usehref=e.usehref||""}[ti](){this[Oe]=Fe(this[Oe],["auto","0","1"])}}class eq extends Se{constructor(e){super(et,"manifest",!0),this.action=Fe(e.action,["include","all","exclude"]),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null,this.ref=new le}}class tq extends Se{constructor(e){super(et,"margin",!0),this.bottomInset=pt(e.bottomInset,"0"),this.id=e.id||"",this.leftInset=pt(e.leftInset,"0"),this.rightInset=pt(e.rightInset,"0"),this.topInset=pt(e.topInset,"0"),this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null}[Rn](){return{margin:Zt(this.topInset)+" "+Zt(this.rightInset)+" "+Zt(this.bottomInset)+" "+Zt(this.leftInset)}}}class nq extends Se{constructor(e){super(et,"mdp"),this.id=e.id||"",this.permissions=Qt({data:e.permissions,defaultValue:2,validate:t=>t===1||t===3}),this.signatureType=Fe(e.signatureType,["filler","author"]),this.use=e.use||"",this.usehref=e.usehref||""}}class iq extends Se{constructor(e){super(et,"medium"),this.id=e.id||"",this.imagingBBox=jG(e.imagingBBox),this.long=pt(e.long),this.orientation=Fe(e.orientation,["portrait","landscape"]),this.short=pt(e.short),this.stock=e.stock||"",this.trayIn=Fe(e.trayIn,["auto","delegate","pageFront"]),this.trayOut=Fe(e.trayOut,["auto","delegate"]),this.use=e.use||"",this.usehref=e.usehref||""}}class sq extends Se{constructor(e){super(et,"message",!0),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||"",this.text=new le}}class rq extends Se{constructor(e){super(et,"numericEdit",!0),this.hScrollPolicy=Fe(e.hScrollPolicy,["auto","off","on"]),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||"",this.border=null,this.comb=null,this.extras=null,this.margin=null}[Kt](e){var r;const t=ea(this,"border","font","margin"),i=this[$t]()[$t](),s={name:"input",attributes:{type:"text",fieldId:i[Vn],dataId:((r=i[mo])==null?void 0:r[Vn])||i[Vn],class:["xfaTextfield"],style:t,"aria-label":Jd(i),"aria-required":!1}};return mx(i)&&(s.attributes["aria-required"]=!0,s.attributes.required=!0),Tt.success({name:"label",attributes:{class:["xfaLabel"]},children:[s]})}}class aq extends Se{constructor(e){super(et,"occur",!0),this.id=e.id||"",this.initial=e.initial!==""?Qt({data:e.initial,defaultValue:"",validate:t=>!0}):"",this.max=e.max!==""?Qt({data:e.max,defaultValue:1,validate:t=>!0}):"",this.min=e.min!==""?Qt({data:e.min,defaultValue:1,validate:t=>!0}):"",this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null}[wo](){const e=this[$t](),t=this.min;this.min===""&&(this.min=e instanceof Dg||e instanceof $p?0:1),this.max===""&&(t===""?this.max=e instanceof Dg||e instanceof $p?-1:1:this.max=this.min),this.max!==-1&&this.max<this.min&&(this.max=this.min),this.initial===""&&(this.initial=e instanceof Y4?1:this.min)}}class oq extends bn{constructor(e){super(et,"oid"),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}}class lq extends Se{constructor(e){super(et,"oids",!0),this.id=e.id||"",this.type=Fe(e.type,["optional","required"]),this.use=e.use||"",this.usehref=e.usehref||"",this.oid=new le}}class KM extends Se{constructor(e){super(et,"overflow"),this.id=e.id||"",this.leader=e.leader||"",this.target=e.target||"",this.trailer=e.trailer||"",this.use=e.use||"",this.usehref=e.usehref||""}[hr](){if(!this[_e]){const e=this[$t](),t=this[Yi](),i=t[n0](this.target,e),s=t[n0](this.leader,e),r=t[n0](this.trailer,e);this[_e]={target:(i==null?void 0:i[0])||null,leader:(s==null?void 0:s[0])||null,trailer:(r==null?void 0:r[0])||null,addLeader:!1,addTrailer:!1}}return this[_e]}}class Dg extends Se{constructor(e){super(et,"pageArea",!0),this.blankOrNotBlank=Fe(e.blankOrNotBlank,["any","blank","notBlank"]),this.id=e.id||"",this.initialNumber=Qt({data:e.initialNumber,defaultValue:1,validate:t=>!0}),this.name=e.name||"",this.numbered=Qt({data:e.numbered,defaultValue:1,validate:t=>!0}),this.oddOrEven=Fe(e.oddOrEven,["any","even","odd"]),this.pagePosition=Fe(e.pagePosition,["any","first","last","only","rest"]),this.relevant=hl(e.relevant),this.use=e.use||"",this.usehref=e.usehref||"",this.desc=null,this.extras=null,this.medium=null,this.occur=null,this.area=new le,this.contentArea=new le,this.draw=new le,this.exclGroup=new le,this.field=new le,this.subform=new le}[Qp](){return this[_e]?!this.occur||this.occur.max===-1||this[_e].numberOfUse<this.occur.max:(this[_e]={numberOfUse:0},!0)}[Lf](){delete this[_e]}[_c](){this[_e]||(this[_e]={numberOfUse:0});const e=this[$t]();return e.relation==="orderedOccurrence"&&this[Qp]()?(this[_e].numberOfUse+=1,this):e[_c]()}[Hd](){return this[_e].space||{width:0,height:0}}[Kt](){this[_e]||(this[_e]={numberOfUse:1});const e=[];this[_e].children=e;const t=Object.create(null);if(this.medium&&this.medium.short&&this.medium.long){if(t.width=Zt(this.medium.short),t.height=Zt(this.medium.long),this[_e].space={width:this.medium.short,height:this.medium.long},this.medium.orientation==="landscape"){const i=t.width;t.width=t.height,t.height=i,this[_e].space={width:this.medium.long,height:this.medium.short}}}else ce("XFA - No medium specified in pageArea: please file a bug.");return this[zh]({filter:new Set(["area","draw","field","subform"]),include:!0}),this[zh]({filter:new Set(["contentArea"]),include:!0}),Tt.success({name:"div",children:e,attributes:{class:["xfaPage"],id:this[Vn],style:t,xfaName:this.name}})}}class $p extends Se{constructor(e){super(et,"pageSet",!0),this.duplexImposition=Fe(e.duplexImposition,["longEdge","shortEdge"]),this.id=e.id||"",this.name=e.name||"",this.relation=Fe(e.relation,["orderedOccurrence","duplexPaginated","simplexPaginated"]),this.relevant=hl(e.relevant),this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null,this.occur=null,this.pageArea=new le,this.pageSet=new le}[Lf](){for(const e of this.pageArea.children)e[Lf]();for(const e of this.pageSet.children)e[Lf]()}[Qp](){return!this.occur||this.occur.max===-1||this[_e].numberOfUse<this.occur.max}[_c](){if(this[_e]||(this[_e]={numberOfUse:1,pageIndex:-1,pageSetIndex:-1}),this.relation==="orderedOccurrence"){if(this[_e].pageIndex+1<this.pageArea.children.length)return this[_e].pageIndex+=1,this.pageArea.children[this[_e].pageIndex][_c]();if(this[_e].pageSetIndex+1<this.pageSet.children.length)return this[_e].pageSetIndex+=1,this.pageSet.children[this[_e].pageSetIndex][_c]();if(this[Qp]())return this[_e].numberOfUse+=1,this[_e].pageIndex=-1,this[_e].pageSetIndex=-1,this[_c]();const r=this[$t]();return r instanceof $p?r[_c]():(this[Lf](),this[_c]())}const e=this[Yi]()[_e].pageNumber,t=e%2===0?"even":"odd",i=e===0?"first":"rest";let s=this.pageArea.children.find(r=>r.oddOrEven===t&&r.pagePosition===i);return s||(s=this.pageArea.children.find(r=>r.oddOrEven==="any"&&r.pagePosition===i),s)||(s=this.pageArea.children.find(r=>r.oddOrEven==="any"&&r.pagePosition==="any"),s)?s:this.pageArea.children[0]}}class cq extends Se{constructor(e){super(et,"para",!0),this.hAlign=Fe(e.hAlign,["left","center","justify","justifyAll","radix","right"]),this.id=e.id||"",this.lineHeight=e.lineHeight?pt(e.lineHeight,"0pt"):"",this.marginLeft=e.marginLeft?pt(e.marginLeft,"0pt"):"",this.marginRight=e.marginRight?pt(e.marginRight,"0pt"):"",this.orphans=Qt({data:e.orphans,defaultValue:0,validate:t=>t>=0}),this.preserve=e.preserve||"",this.radixOffset=e.radixOffset?pt(e.radixOffset,"0pt"):"",this.spaceAbove=e.spaceAbove?pt(e.spaceAbove,"0pt"):"",this.spaceBelow=e.spaceBelow?pt(e.spaceBelow,"0pt"):"",this.tabDefault=e.tabDefault?pt(this.tabDefault):"",this.tabStops=(e.tabStops||"").trim().split(/\s+/).map((t,i)=>i%2===1?pt(t):t),this.textIndent=e.textIndent?pt(e.textIndent,"0pt"):"",this.use=e.use||"",this.usehref=e.usehref||"",this.vAlign=Fe(e.vAlign,["top","bottom","middle"]),this.widows=Qt({data:e.widows,defaultValue:0,validate:t=>t>=0}),this.hyphenation=null}[Rn](){const e=ea(this,"hAlign");return this.marginLeft!==""&&(e.paddingLeft=Zt(this.marginLeft)),this.marginRight!==""&&(e.paddingRight=Zt(this.marginRight)),this.spaceAbove!==""&&(e.paddingTop=Zt(this.spaceAbove)),this.spaceBelow!==""&&(e.paddingBottom=Zt(this.spaceBelow)),this.textIndent!==""&&(e.textIndent=Zt(this.textIndent),EM(e)),this.lineHeight>0&&(e.lineHeight=Zt(this.lineHeight)),this.tabDefault!==""&&(e.tabSize=Zt(this.tabDefault)),this.tabStops.length>0,this.hyphenatation&&Object.assign(e,this.hyphenatation[Rn]()),e}}class hq extends Se{constructor(e){super(et,"passwordEdit",!0),this.hScrollPolicy=Fe(e.hScrollPolicy,["auto","off","on"]),this.id=e.id||"",this.passwordChar=e.passwordChar||"*",this.use=e.use||"",this.usehref=e.usehref||"",this.border=null,this.extras=null,this.margin=null}}class uq extends Se{constructor(e){super(et,"pattern",!0),this.id=e.id||"",this.type=Fe(e.type,["crossHatch","crossDiagonal","diagonalLeft","diagonalRight","horizontal","vertical"]),this.use=e.use||"",this.usehref=e.usehref||"",this.color=null,this.extras=null}[Rn](e){e=e?e[Rn]():"#FFFFFF";const t=this.color?this.color[Rn]():"#000000",i=5,s="repeating-linear-gradient",r=`${e},${e} ${i}px,${t} ${i}px,${t} ${2*i}px`;switch(this.type){case"crossHatch":return`${s}(to top,${r}) ${s}(to right,${r})`;case"crossDiagonal":return`${s}(45deg,${r}) ${s}(-45deg,${r})`;case"diagonalLeft":return`${s}(45deg,${r})`;case"diagonalRight":return`${s}(-45deg,${r})`;case"horizontal":return`${s}(to top,${r})`;case"vertical":return`${s}(to right,${r})`}return""}}class dq extends bn{constructor(e){super(et,"picture"),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||""}}class fq extends Se{constructor(e){super(et,"proto",!0),this.appearanceFilter=new le,this.arc=new le,this.area=new le,this.assist=new le,this.barcode=new le,this.bindItems=new le,this.bookend=new le,this.boolean=new le,this.border=new le,this.break=new le,this.breakAfter=new le,this.breakBefore=new le,this.button=new le,this.calculate=new le,this.caption=new le,this.certificate=new le,this.certificates=new le,this.checkButton=new le,this.choiceList=new le,this.color=new le,this.comb=new le,this.connect=new le,this.contentArea=new le,this.corner=new le,this.date=new le,this.dateTime=new le,this.dateTimeEdit=new le,this.decimal=new le,this.defaultUi=new le,this.desc=new le,this.digestMethod=new le,this.digestMethods=new le,this.draw=new le,this.edge=new le,this.encoding=new le,this.encodings=new le,this.encrypt=new le,this.encryptData=new le,this.encryption=new le,this.encryptionMethod=new le,this.encryptionMethods=new le,this.event=new le,this.exData=new le,this.exObject=new le,this.exclGroup=new le,this.execute=new le,this.extras=new le,this.field=new le,this.fill=new le,this.filter=new le,this.float=new le,this.font=new le,this.format=new le,this.handler=new le,this.hyphenation=new le,this.image=new le,this.imageEdit=new le,this.integer=new le,this.issuers=new le,this.items=new le,this.keep=new le,this.keyUsage=new le,this.line=new le,this.linear=new le,this.lockDocument=new le,this.manifest=new le,this.margin=new le,this.mdp=new le,this.medium=new le,this.message=new le,this.numericEdit=new le,this.occur=new le,this.oid=new le,this.oids=new le,this.overflow=new le,this.pageArea=new le,this.pageSet=new le,this.para=new le,this.passwordEdit=new le,this.pattern=new le,this.picture=new le,this.radial=new le,this.reason=new le,this.reasons=new le,this.rectangle=new le,this.ref=new le,this.script=new le,this.setProperty=new le,this.signData=new le,this.signature=new le,this.signing=new le,this.solid=new le,this.speak=new le,this.stipple=new le,this.subform=new le,this.subformSet=new le,this.subjectDN=new le,this.subjectDNs=new le,this.submit=new le,this.text=new le,this.textEdit=new le,this.time=new le,this.timeStamp=new le,this.toolTip=new le,this.traversal=new le,this.traverse=new le,this.ui=new le,this.validate=new le,this.value=new le,this.variables=new le}}class gq extends Se{constructor(e){super(et,"radial",!0),this.id=e.id||"",this.type=Fe(e.type,["toEdge","toCenter"]),this.use=e.use||"",this.usehref=e.usehref||"",this.color=null,this.extras=null}[Rn](e){e=e?e[Rn]():"#FFFFFF";const t=this.color?this.color[Rn]():"#000000";return`radial-gradient(circle at center, ${this.type==="toEdge"?`${e},${t}`:`${t},${e}`})`}}class mq extends bn{constructor(e){super(et,"reason"),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}}class pq extends Se{constructor(e){super(et,"reasons",!0),this.id=e.id||"",this.type=Fe(e.type,["optional","required"]),this.use=e.use||"",this.usehref=e.usehref||"",this.reason=new le}}class XM extends Se{constructor(e){super(et,"rectangle",!0),this.hand=Fe(e.hand,["even","left","right"]),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||"",this.corner=new le(4),this.edge=new le(4),this.fill=null}[Kt](){var c;const e=this.edge.children.length?this.edge.children[0]:new px({}),t=e[Rn](),i=Object.create(null);((c=this.fill)==null?void 0:c.presence)==="visible"?Object.assign(i,this.fill[Rn]()):i.fill="transparent",i.strokeWidth=Zt(e.presence==="visible"?e.thickness:0),i.stroke=t.color;const r=(this.corner.children.length?this.corner.children[0]:new GM({}))[Rn](),o={name:"svg",children:[{name:"rect",attributes:{xmlns:jd,width:"100%",height:"100%",x:0,y:0,rx:r.radius,ry:r.radius,style:i}}],attributes:{xmlns:jd,style:{overflow:"visible"},width:"100%",height:"100%"}},l=this[$t]()[$t]();return G4(l)?Tt.success({name:"div",attributes:{style:{display:"inline",width:"100%",height:"100%"}},children:[o]}):(o.attributes.style.position="absolute",Tt.success(o))}}class bq extends bn{constructor(e){super(et,"ref"),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||""}}class xq extends bn{constructor(e){super(et,"script"),this.binding=e.binding||"",this.contentType=e.contentType||"",this.id=e.id||"",this.name=e.name||"",this.runAt=Fe(e.runAt,["client","both","server"]),this.use=e.use||"",this.usehref=e.usehref||""}}class g6 extends Se{constructor(e){super(et,"setProperty"),this.connection=e.connection||"",this.ref=e.ref||"",this.target=e.target||""}}class yq extends Se{constructor(e){super(et,"signData",!0),this.id=e.id||"",this.operation=Fe(e.operation,["sign","clear","verify"]),this.ref=e.ref||"",this.target=e.target||"",this.use=e.use||"",this.usehref=e.usehref||"",this.filter=null,this.manifest=null}}class wq extends Se{constructor(e){super(et,"signature",!0),this.id=e.id||"",this.type=Fe(e.type,["PDF1.3","PDF1.6"]),this.use=e.use||"",this.usehref=e.usehref||"",this.border=null,this.extras=null,this.filter=null,this.manifest=null,this.margin=null}}class _q extends Se{constructor(e){super(et,"signing",!0),this.id=e.id||"",this.type=Fe(e.type,["optional","required"]),this.use=e.use||"",this.usehref=e.usehref||"",this.certificate=new le}}class vq extends Se{constructor(e){super(et,"solid",!0),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null}[Rn](e){return e?e[Rn]():"#FFFFFF"}}class kq extends bn{constructor(e){super(et,"speak"),this.disable=Qt({data:e.disable,defaultValue:0,validate:t=>t===1}),this.id=e.id||"",this.priority=Fe(e.priority,["custom","caption","name","toolTip"]),this.rid=e.rid||"",this.use=e.use||"",this.usehref=e.usehref||""}}class Cq extends Se{constructor(e){super(et,"stipple",!0),this.id=e.id||"",this.rate=Qt({data:e.rate,defaultValue:50,validate:t=>t>=0&&t<=100}),this.use=e.use||"",this.usehref=e.usehref||"",this.color=null,this.extras=null}[Rn](e){const t=this.rate/100;return Dn.makeHexColor(Math.round(e.value.r*(1-t)+this.value.r*t),Math.round(e.value.g*(1-t)+this.value.g*t),Math.round(e.value.b*(1-t)+this.value.b*t))}}class YM extends Se{constructor(e){super(et,"subform",!0),this.access=Fe(e.access,["open","nonInteractive","protected","readOnly"]),this.allowMacro=Qt({data:e.allowMacro,defaultValue:0,validate:t=>t===1}),this.anchorType=Fe(e.anchorType,["topLeft","bottomCenter","bottomLeft","bottomRight","middleCenter","middleLeft","middleRight","topCenter","topRight"]),this.colSpan=Qt({data:e.colSpan,defaultValue:1,validate:t=>t>=1||t===-1}),this.columnWidths=(e.columnWidths||"").trim().split(/\s+/).map(t=>t==="-1"?-1:pt(t)),this.h=e.h?pt(e.h):"",this.hAlign=Fe(e.hAlign,["left","center","justify","justifyAll","radix","right"]),this.id=e.id||"",this.layout=Fe(e.layout,["position","lr-tb","rl-row","rl-tb","row","table","tb"]),this.locale=e.locale||"",this.maxH=pt(e.maxH,"0pt"),this.maxW=pt(e.maxW,"0pt"),this.mergeMode=Fe(e.mergeMode,["consumeData","matchTemplate"]),this.minH=pt(e.minH,"0pt"),this.minW=pt(e.minW,"0pt"),this.name=e.name||"",this.presence=Fe(e.presence,["visible","hidden","inactive","invisible"]),this.relevant=hl(e.relevant),this.restoreState=Fe(e.restoreState,["manual","auto"]),this.scope=Fe(e.scope,["name","none"]),this.use=e.use||"",this.usehref=e.usehref||"",this.w=e.w?pt(e.w):"",this.x=pt(e.x,"0pt"),this.y=pt(e.y,"0pt"),this.assist=null,this.bind=null,this.bookend=null,this.border=null,this.break=null,this.calculate=null,this.desc=null,this.extras=null,this.keep=null,this.margin=null,this.occur=null,this.overflow=null,this.pageSet=null,this.para=null,this.traversal=null,this.validate=null,this.variables=null,this.area=new le,this.breakAfter=new le,this.breakBefore=new le,this.connect=new le,this.draw=new le,this.event=new le,this.exObject=new le,this.exclGroup=new le,this.field=new le,this.proto=new le,this.setProperty=new le,this.subform=new le,this.subformSet=new le}[Qi](){const e=this[$t]();return e instanceof X4?e[Qi]():e}[cf](){return!0}[w0](){return this.layout.endsWith("-tb")&&this[_e].attempt===0&&this[_e].numberInLine>0||this[$t]()[w0]()}*[Og](){yield*q4(this)}[gx](){return OM(this)}[Ud](e,t){DM(this,e,t)}[Hd](){return FM(this)}[l0](){var t;const e=this[Qi]();return e[l0]()?this[_e]._isSplittable!==void 0?this[_e]._isSplittable:this.layout==="position"||this.layout.includes("row")?(this[_e]._isSplittable=!1,!1):this.keep&&this.keep.intact!=="none"?(this[_e]._isSplittable=!1,!1):(t=e.layout)!=null&&t.endsWith("-tb")&&e[_e].numberInLine!==0?!1:(this[_e]._isSplittable=!0,!0):!1}[Kt](e){var _;if(uy(this),this.break){if(this.break.after!=="auto"||this.break.afterTarget!==""){const v=new UM({targetType:this.break.after,target:this.break.afterTarget,startNew:this.break.startNew.toString()});v[ei]=this[ei],this[Li](v),this.breakAfter.push(v)}if(this.break.before!=="auto"||this.break.beforeTarget!==""){const v=new HM({targetType:this.break.before,target:this.break.beforeTarget,startNew:this.break.startNew.toString()});v[ei]=this[ei],this[Li](v),this.breakBefore.push(v)}if(this.break.overflowTarget!==""){const v=new KM({target:this.break.overflowTarget,leader:this.break.overflowLeader,trailer:this.break.overflowTrailer});v[ei]=this[ei],this[Li](v),this.overflow.push(v)}this[Nh](this.break),this.break=null}if(this.presence==="hidden"||this.presence==="inactive")return Tt.EMPTY;if((this.breakBefore.children.length>1||this.breakAfter.children.length>1)&&ce("XFA - Several breakBefore or breakAfter in subforms: please file a bug."),this.breakBefore.children.length>=1){const v=this.breakBefore.children[0];if(lC(v))return Tt.breakNode(v)}if((_=this[_e])!=null&&_.afterBreakAfter)return Tt.EMPTY;cy(this);const t=[],i={id:this[Vn],class:[]};j4(this,i.class),this[_e]||(this[_e]=Object.create(null)),Object.assign(this[_e],{children:t,line:null,attributes:i,attempt:0,numberInLine:0,availableSpace:{width:Math.min(this.w||1/0,e.width),height:Math.min(this.h||1/0,e.height)},width:0,height:0,prevHeight:0,currentWidth:0});const s=this[Yi](),r=s[_e].noLayoutFailure,a=this[l0]();if(a||fy(this),!hy(this,e))return Tt.FAILURE;const o=new Set(["area","draw","exclGroup","field","subform","subformSet"]);if(this.layout.includes("row")){const v=this[Qi]().columnWidths;Array.isArray(v)&&v.length>0&&(this[_e].columnWidths=v,this[_e].currentColumn=0)}const l=ea(this,"anchorType","dimensions","position","presence","border","margin","hAlign"),c=["xfaSubform"],h=IM(this);if(h&&c.push(h),i.style=l,i.class=c,this.name&&(i.xfaName=this.name),this.overflow){const v=this.overflow[hr]();v.addLeader&&(v.addLeader=!1,cC(this,v.leader,e))}this[Jg]();const u=this.layout==="lr-tb"||this.layout==="rl-tb",d=u?L3:1;for(;this[_e].attempt<d;this[_e].attempt++){u&&this[_e].attempt===L3-1&&(this[_e].numberInLine=0);const v=this[zh]({filter:o,include:!0});if(v.success)break;if(v.isBreak())return this[ha](),v;if(u&&this[_e].attempt===0&&this[_e].numberInLine===0&&!s[_e].noLayoutFailure){this[_e].attempt=d;break}}if(this[ha](),a||gy(this),s[_e].noLayoutFailure=r,this[_e].attempt===d)return this.overflow&&(this[Yi]()[_e].overflowNode=this.overflow),a||delete this[_e],Tt.FAILURE;if(this.overflow){const v=this.overflow[hr]();v.addTrailer&&(v.addTrailer=!1,cC(this,v.trailer,e))}let f=0,g=0;this.margin&&(f=this.margin.leftInset+this.margin.rightInset,g=this.margin.topInset+this.margin.bottomInset);const m=Math.max(this[_e].width+f,this.w||0),x=Math.max(this[_e].height+g,this.h||0),p=[this.x,this.y,m,x];if(this.w===""&&(l.width=Zt(m)),this.h===""&&(l.height=Zt(x)),(l.width==="0px"||l.height==="0px")&&t.length===0)return Tt.EMPTY;const y={name:"div",attributes:i,children:t};dy(this,i);const w=Tt.success(zd(this,y),p);if(this.breakAfter.children.length>=1){const v=this.breakAfter.children[0];if(lC(v))return this[_e].afterBreakAfter=w,Tt.breakNode(v)}return delete this[_e],w}}class X4 extends Se{constructor(e){super(et,"subformSet",!0),this.id=e.id||"",this.name=e.name||"",this.relation=Fe(e.relation,["ordered","choice","unordered"]),this.relevant=hl(e.relevant),this.use=e.use||"",this.usehref=e.usehref||"",this.bookend=null,this.break=null,this.desc=null,this.extras=null,this.occur=null,this.overflow=null,this.breakAfter=new le,this.breakBefore=new le,this.subform=new le,this.subformSet=new le}*[Og](){yield*q4(this)}[Qi](){let e=this[$t]();for(;!(e instanceof YM);)e=e[$t]();return e}[cf](){return!0}}class Aq extends zi{constructor(e){super(et,"subjectDN"),this.delimiter=e.delimiter||",",this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}[ti](){this[Oe]=new Map(this[Oe].split(this.delimiter).map(e=>(e=e.split("=",2),e[0]=e[0].trim(),e)))}}class Sq extends Se{constructor(e){super(et,"subjectDNs",!0),this.id=e.id||"",this.type=Fe(e.type,["optional","required"]),this.use=e.use||"",this.usehref=e.usehref||"",this.subjectDN=new le}}class Iq extends Se{constructor(e){super(et,"submit",!0),this.embedPDF=Qt({data:e.embedPDF,defaultValue:0,validate:t=>t===1}),this.format=Fe(e.format,["xdp","formdata","pdf","urlencoded","xfd","xml"]),this.id=e.id||"",this.target=e.target||"",this.textEncoding=ly({data:e.textEncoding?e.textEncoding.toLowerCase():"",defaultValue:"",validate:t=>["utf-8","big-five","fontspecific","gbk","gb-18030","gb-2312","ksc-5601","none","shift-jis","ucs-2","utf-16"].includes(t)||t.match(/iso-8859-\d{2}/)}),this.use=e.use||"",this.usehref=e.usehref||"",this.xdpContent=e.xdpContent||"",this.encrypt=null,this.encryptData=new le,this.signData=new le}}class Y4 extends Se{constructor(e){super(et,"template",!0),this.baseProfile=Fe(e.baseProfile,["full","interactiveForms"]),this.extras=null,this.subform=new le}[ti](){this.subform.children.length===0&&ce("XFA - No subforms in template node."),this.subform.children.length>=2&&ce("XFA - Several subforms in template node: please file a bug."),this[Vo]=$G}[l0](){return!0}[n0](e,t){return e.startsWith("#")?[this[Mf].get(e.slice(1))]:M0(this,t,e,!0,!0)}*[wM](){var g,m,x;if(!this.subform.children.length)return Tt.success({name:"div",children:[]});this[_e]={overflowNode:null,firstUnsplittable:null,currentContentArea:null,currentPageArea:null,noLayoutFailure:!1,pageNumber:1,pagePosition:"first",oddOrEven:"odd",blankOrNotBlank:"nonBlank",paraStack:[]};const e=this.subform.children[0];e.pageSet[Lf]();const t=e.pageSet.pageArea.children,i={name:"div",children:[]};let s=null,r=null,a=null;if(e.breakBefore.children.length>=1?(r=e.breakBefore.children[0],a=r.target):e.subform.children.length>=1&&e.subform.children[0].breakBefore.children.length>=1?(r=e.subform.children[0].breakBefore.children[0],a=r.target):(g=e.break)!=null&&g.beforeTarget?(r=e.break,a=r.beforeTarget):e.subform.children.length>=1&&((m=e.subform.children[0].break)!=null&&m.beforeTarget)&&(r=e.subform.children[0].break,a=r.beforeTarget),r){const p=this[n0](a,r[$t]());p instanceof Dg&&(s=p,r[_e]={})}s||(s=t[0]),s[_e]={numberOfUse:1};const o=s[$t]();o[_e]={numberOfUse:1,pageIndex:o.pageArea.children.indexOf(s),pageSetIndex:0};let l,c=null,h=null,u=!0,d=0,f=0;for(;;){if(u)d=0;else if(i.children.pop(),++d===QG)return ce("XFA - Something goes wrong: please file a bug."),i;l=null,this[_e].currentPageArea=s;const p=s[Kt]().html;i.children.push(p),c&&(this[_e].noLayoutFailure=!0,p.children.push(c[Kt](s[_e].space).html),c=null),h&&(this[_e].noLayoutFailure=!0,p.children.push(h[Kt](s[_e].space).html),h=null);const y=s.contentArea.children,w=p.children.filter(v=>v.attributes.class.includes("xfaContentarea"));u=!1,this[_e].firstUnsplittable=null,this[_e].noLayoutFailure=!1;const _=v=>{var k;const C=e[gx]();C&&(u||(u=((k=C.children)==null?void 0:k.length)>0),w[v].children.push(C))};for(let v=f,C=y.length;v<C;v++){const k=this[_e].currentContentArea=y[v],I={width:k.w,height:k.h};f=0,c&&(w[v].children.push(c[Kt](I).html),c=null),h&&(w[v].children.push(h[Kt](I).html),h=null);const S=e[Kt](I);if(S.success)return S.html?(u||(u=((x=S.html.children)==null?void 0:x.length)>0),w[v].children.push(S.html)):!u&&i.children.length>1&&i.children.pop(),i;if(S.isBreak()){const M=S.breakNode;if(_(v),M.targetType==="auto")continue;M.leader&&(c=this[n0](M.leader,M[$t]()),c=c?c[0]:null),M.trailer&&(h=this[n0](M.trailer,M[$t]()),h=h?h[0]:null),M.targetType==="pageArea"?(l=M[_e].target,v=1/0):M[_e].target?(l=M[_e].target,f=M[_e].index+1,v=1/0):v=M[_e].index;continue}if(this[_e].overflowNode){const M=this[_e].overflowNode;this[_e].overflowNode=null;const N=M[hr](),F=N.target;N.addLeader=N.leader!==null,N.addTrailer=N.trailer!==null,_(v);const H=v;if(v=1/0,F instanceof Dg)l=F;else if(F instanceof W4){const T=y.indexOf(F);T!==-1?T>H?v=T-1:f=T:(l=F[$t](),f=l.contentArea.children.indexOf(F))}continue}_(v)}this[_e].pageNumber+=1,l&&(l[Qp]()?l[_e].numberOfUse+=1:l=null),s=l||s[_c](),yield null}}}class JM extends zi{constructor(e){super(et,"text"),this.id=e.id||"",this.maxChars=Qt({data:e.maxChars,defaultValue:0,validate:t=>t>=0}),this.name=e.name||"",this.rid=e.rid||"",this.use=e.use||"",this.usehref=e.usehref||""}[ry](){return!0}[Ql](e){return e[Ji]===es.xhtml.id?(this[Oe]=e,!0):(ce(`XFA - Invalid content in Text: ${e[On]}.`),!1)}[c0](e){this[Oe]instanceof Se||super[c0](e)}[ti](){typeof this[Oe]=="string"&&(this[Oe]=this[Oe].replaceAll(`\r
`,`
`))}[hr](){return typeof this[Oe]=="string"?this[Oe].split(/[\u2029\u2028\n]/).filter(e=>!!e).join(`
`):this[Oe][bs]()}[Kt](e){if(typeof this[Oe]=="string"){const t=Xh(this[Oe]).html;return this[Oe].includes("\u2029")?(t.name="div",t.children=[],this[Oe].split("\u2029").map(i=>i.split(/[\u2028\n]/).flatMap(s=>[{name:"span",value:s},{name:"br"}])).forEach(i=>{t.children.push({name:"p",children:i})})):/[\u2028\n]/.test(this[Oe])&&(t.name="div",t.children=[],this[Oe].split(/[\u2028\n]/).forEach(i=>{t.children.push({name:"span",value:i},{name:"br"})})),Tt.success(t)}return this[Oe][Kt](e)}}class ZM extends Se{constructor(e){super(et,"textEdit",!0),this.allowRichText=Qt({data:e.allowRichText,defaultValue:0,validate:t=>t===1}),this.hScrollPolicy=Fe(e.hScrollPolicy,["auto","off","on"]),this.id=e.id||"",this.multiLine=Qt({data:e.multiLine,defaultValue:"",validate:t=>t===0||t===1}),this.use=e.use||"",this.usehref=e.usehref||"",this.vScrollPolicy=Fe(e.vScrollPolicy,["auto","off","on"]),this.border=null,this.comb=null,this.extras=null,this.margin=null}[Kt](e){var r,a;const t=ea(this,"border","font","margin");let i;const s=this[$t]()[$t]();return this.multiLine===""&&(this.multiLine=s instanceof VM?1:0),this.multiLine===1?i={name:"textarea",attributes:{dataId:((r=s[mo])==null?void 0:r[Vn])||s[Vn],fieldId:s[Vn],class:["xfaTextfield"],style:t,"aria-label":Jd(s),"aria-required":!1}}:i={name:"input",attributes:{type:"text",dataId:((a=s[mo])==null?void 0:a[Vn])||s[Vn],fieldId:s[Vn],class:["xfaTextfield"],style:t,"aria-label":Jd(s),"aria-required":!1}},mx(s)&&(i.attributes["aria-required"]=!0,i.attributes.required=!0),Tt.success({name:"label",attributes:{class:["xfaLabel"]},children:[i]})}}class Eq extends bn{constructor(e){super(et,"time"),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}[ti](){const e=this[Oe].trim();this[Oe]=e?new Date(e):null}[Kt](e){return Xh(this[Oe]?this[Oe].toString():"")}}class Tq extends Se{constructor(e){super(et,"timeStamp"),this.id=e.id||"",this.server=e.server||"",this.type=Fe(e.type,["optional","required"]),this.use=e.use||"",this.usehref=e.usehref||""}}class Rq extends bn{constructor(e){super(et,"toolTip"),this.id=e.id||"",this.rid=e.rid||"",this.use=e.use||"",this.usehref=e.usehref||""}}class Mq extends Se{constructor(e){super(et,"traversal",!0),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null,this.traverse=new le}}class Pq extends Se{constructor(e){super(et,"traverse",!0),this.id=e.id||"",this.operation=Fe(e.operation,["next","back","down","first","left","right","up"]),this.ref=e.ref||"",this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null,this.script=null}get name(){return this.operation}[Zp](){return!1}}class J4 extends Se{constructor(e){super(et,"ui",!0),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null,this.picture=null,this.barcode=null,this.button=null,this.checkButton=null,this.choiceList=null,this.dateTimeEdit=null,this.defaultUi=null,this.imageEdit=null,this.numericEdit=null,this.passwordEdit=null,this.signature=null,this.textEdit=null}[hr](){if(this[_e]===void 0){for(const e of Object.getOwnPropertyNames(this)){if(e==="extras"||e==="picture")continue;const t=this[e];if(t instanceof Se)return this[_e]=t,t}this[_e]=null}return this[_e]}[Kt](e){const t=this[hr]();return t?t[Kt](e):Tt.EMPTY}}class Nq extends Se{constructor(e){super(et,"validate",!0),this.formatTest=Fe(e.formatTest,["warning","disabled","error"]),this.id=e.id||"",this.nullTest=Fe(e.nullTest,["disabled","error","warning"]),this.scriptTest=Fe(e.scriptTest,["error","disabled","warning"]),this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null,this.message=null,this.picture=null,this.script=null}}class Z4 extends Se{constructor(e){super(et,"value",!0),this.id=e.id||"",this.override=Qt({data:e.override,defaultValue:0,validate:t=>t===1}),this.relevant=hl(e.relevant),this.use=e.use||"",this.usehref=e.usehref||"",this.arc=null,this.boolean=null,this.date=null,this.dateTime=null,this.decimal=null,this.exData=null,this.float=null,this.image=null,this.integer=null,this.line=null,this.rectangle=null,this.text=null,this.time=null}[ga](e){var s;const t=this[$t]();if(t instanceof K4&&(s=t.ui)!=null&&s.imageEdit){this.image||(this.image=new WM({}),this[Li](this.image)),this.image[Oe]=e[Oe];return}const i=e[On];if(this[i]!==null){this[i][Oe]=e[Oe];return}for(const r of Object.getOwnPropertyNames(this)){const a=this[r];a instanceof Se&&(this[r]=null,this[Nh](a))}this[e[On]]=e,this[Li](e)}[bs](){if(this.exData)return typeof this.exData[Oe]=="string"?this.exData[Oe].trim():this.exData[Oe][bs]().trim();for(const e of Object.getOwnPropertyNames(this)){if(e==="image")continue;const t=this[e];if(t instanceof Se)return(t[Oe]||"").toString().trim()}return null}[Kt](e){for(const t of Object.getOwnPropertyNames(this)){const i=this[t];if(i instanceof Se)return i[Kt](e)}return Tt.EMPTY}}class Oq extends Se{constructor(e){super(et,"variables",!0),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||"",this.boolean=new le,this.date=new le,this.dateTime=new le,this.decimal=new le,this.exData=new le,this.float=new le,this.image=new le,this.integer=new le,this.manifest=new le,this.script=new le,this.text=new le,this.time=new le}[Zp](){return!0}}class B3{static[cl](e,t){if(B3.hasOwnProperty(e)){const i=B3[e](t);return i[yM](t),i}}static appearanceFilter(e){return new iV(e)}static arc(e){return new LM(e)}static area(e){return new sV(e)}static assist(e){return new rV(e)}static barcode(e){return new aV(e)}static bind(e){return new oV(e)}static bindItems(e){return new d6(e)}static bookend(e){return new lV(e)}static boolean(e){return new cV(e)}static border(e){return new BM(e)}static break(e){return new hV(e)}static breakAfter(e){return new UM(e)}static breakBefore(e){return new HM(e)}static button(e){return new uV(e)}static calculate(e){return new dV(e)}static caption(e){return new fV(e)}static certificate(e){return new gV(e)}static certificates(e){return new mV(e)}static checkButton(e){return new zM(e)}static choiceList(e){return new jM(e)}static color(e){return new pV(e)}static comb(e){return new bV(e)}static connect(e){return new xV(e)}static contentArea(e){return new W4(e)}static corner(e){return new GM(e)}static date(e){return new yV(e)}static dateTime(e){return new wV(e)}static dateTimeEdit(e){return new _V(e)}static decimal(e){return new vV(e)}static defaultUi(e){return new kV(e)}static desc(e){return new CV(e)}static digestMethod(e){return new AV(e)}static digestMethods(e){return new SV(e)}static draw(e){return new VM(e)}static edge(e){return new px(e)}static encoding(e){return new IV(e)}static encodings(e){return new EV(e)}static encrypt(e){return new TV(e)}static encryptData(e){return new RV(e)}static encryption(e){return new MV(e)}static encryptionMethod(e){return new PV(e)}static encryptionMethods(e){return new NV(e)}static event(e){return new OV(e)}static exData(e){return new DV(e)}static exObject(e){return new FV(e)}static exclGroup(e){return new qM(e)}static execute(e){return new LV(e)}static extras(e){return new BV(e)}static field(e){return new K4(e)}static fill(e){return new UV(e)}static filter(e){return new HV(e)}static float(e){return new zV(e)}static font(e){return new jV(e)}static format(e){return new GV(e)}static handler(e){return new VV(e)}static hyphenation(e){return new qV(e)}static image(e){return new WM(e)}static imageEdit(e){return new WV(e)}static integer(e){return new KV(e)}static issuers(e){return new XV(e)}static items(e){return new f6(e)}static keep(e){return new YV(e)}static keyUsage(e){return new JV(e)}static line(e){return new ZV(e)}static linear(e){return new QV(e)}static lockDocument(e){return new $V(e)}static manifest(e){return new eq(e)}static margin(e){return new tq(e)}static mdp(e){return new nq(e)}static medium(e){return new iq(e)}static message(e){return new sq(e)}static numericEdit(e){return new rq(e)}static occur(e){return new aq(e)}static oid(e){return new oq(e)}static oids(e){return new lq(e)}static overflow(e){return new KM(e)}static pageArea(e){return new Dg(e)}static pageSet(e){return new $p(e)}static para(e){return new cq(e)}static passwordEdit(e){return new hq(e)}static pattern(e){return new uq(e)}static picture(e){return new dq(e)}static proto(e){return new fq(e)}static radial(e){return new gq(e)}static reason(e){return new mq(e)}static reasons(e){return new pq(e)}static rectangle(e){return new XM(e)}static ref(e){return new bq(e)}static script(e){return new xq(e)}static setProperty(e){return new g6(e)}static signData(e){return new yq(e)}static signature(e){return new wq(e)}static signing(e){return new _q(e)}static solid(e){return new vq(e)}static speak(e){return new kq(e)}static stipple(e){return new Cq(e)}static subform(e){return new YM(e)}static subformSet(e){return new X4(e)}static subjectDN(e){return new Aq(e)}static subjectDNs(e){return new Sq(e)}static submit(e){return new Iq(e)}static template(e){return new Y4(e)}static text(e){return new JM(e)}static textEdit(e){return new ZM(e)}static time(e){return new Eq(e)}static timeStamp(e){return new Tq(e)}static toolTip(e){return new Rq(e)}static traversal(e){return new Mq(e)}static traverse(e){return new Pq(e)}static ui(e){return new J4(e)}static validate(e){return new Nq(e)}static value(e){return new Z4(e)}static variables(e){return new Oq(e)}}const hC=es.datasets.id;function s9(n){const e=new JM({});return e[Oe]=n,e}class Dq{constructor(e){var t;this.root=e,this.datasets=e.datasets,this.data=((t=e.datasets)==null?void 0:t.data)||new $l(es.datasets.id,"data"),this.emptyMerge=this.data[js]().length===0,this.root.form=this.form=e.template[Xo]()}_isConsumeData(){return!this.emptyMerge&&this._mergeMode}_isMatchTemplate(){return!this._isConsumeData()}bind(){return this._bindElement(this.form,this.data),this.form}getData(){return this.data}_bindValue(e,t,i){var s,r;if(e[mo]=t,e[Jp]())if(t[Bf]()){const a=t[L4]();e[ga](s9(a))}else if(e instanceof K4&&((r=(s=e.ui)==null?void 0:s.choiceList)==null?void 0:r.open)==="multiSelect"){const a=t[js]().map(o=>o[Oe].trim()).join(`
`);e[ga](s9(a))}else this._isConsumeData()&&ce("XFA - Nodes haven't the same type.");else!t[Bf]()||this._isMatchTemplate()?this._bindElement(e,t):ce("XFA - Nodes haven't the same type.")}_findDataByNameToConsume(e,t,i,s){if(!e)return null;let r,a;for(let o=0;o<3;o++){for(r=i[yp](e,!1,!0);a=r.next().value,!!a;)if(t===a[Bf]())return a;if(i[Ji]===es.datasets.id&&i[On]==="data")break;i=i[$t]()}return s?(r=this.data[yp](e,!0,!1),a=r.next().value,a||(r=this.data[o6](e,!0),a=r.next().value,a!=null&&a[Bf]())?a:null):null}_setProperties(e,t){if(e.hasOwnProperty("setProperty"))for(const{ref:i,target:s,connection:r}of e.setProperty.children){if(r||!i)continue;const a=M0(this.root,t,i,!1,!1);if(!a){ce(`XFA - Invalid reference: ${i}.`);continue}const[o]=a;if(!o[D0](this.data)){ce("XFA - Invalid node: must be a data node.");continue}const l=M0(this.root,e,s,!1,!1);if(!l){ce(`XFA - Invalid target: ${s}.`);continue}const[c]=l;if(!c[D0](e)){ce("XFA - Invalid target: must be a property or subproperty.");continue}const h=c[$t]();if(c instanceof g6||h instanceof g6){ce("XFA - Invalid target: cannot be a setProperty or one of its properties.");continue}if(c instanceof d6||h instanceof d6){ce("XFA - Invalid target: cannot be a bindItems or one of its properties.");continue}const u=o[bs](),d=c[On];if(c instanceof H4){const f=Object.create(null);f[d]=u;const g=Reflect.construct(Object.getPrototypeOf(h).constructor,[f]);h[d]=g[d];continue}if(!c.hasOwnProperty(Oe)){ce("XFA - Invalid node to use in setProperty");continue}c[mo]=o,c[Oe]=u,c[ti]()}}_bindItems(e,t){if(!e.hasOwnProperty("items")||!e.hasOwnProperty("bindItems")||e.bindItems.isEmpty())return;for(const r of e.items.children)e[Nh](r);e.items.clear();const i=new f6({}),s=new f6({});e[Li](i),e.items.push(i),e[Li](s),e.items.push(s);for(const{ref:r,labelRef:a,valueRef:o,connection:l}of e.bindItems.children){if(l||!r)continue;const c=M0(this.root,t,r,!1,!1);if(!c){ce(`XFA - Invalid reference: ${r}.`);continue}for(const h of c){if(!h[D0](this.datasets)){ce(`XFA - Invalid ref (${r}): must be a datasets child.`);continue}const u=M0(this.root,h,a,!0,!1);if(!u){ce(`XFA - Invalid label: ${a}.`);continue}const[d]=u;if(!d[D0](this.datasets)){ce("XFA - Invalid label: must be a datasets child.");continue}const f=M0(this.root,h,o,!0,!1);if(!f){ce(`XFA - Invalid value: ${o}.`);continue}const[g]=f;if(!g[D0](this.datasets)){ce("XFA - Invalid value: must be a datasets child.");continue}const m=s9(d[bs]()),x=s9(g[bs]());i[Li](m),i.text.push(m),s[Li](x),s.text.push(x)}}}_bindOccurrences(e,t,i){let s;if(t.length>1&&(s=e[Xo](),s[Nh](s.occur),s.occur=null),this._bindValue(e,t[0],i),this._setProperties(e,t[0]),this._bindItems(e,t[0]),t.length===1)return;const r=e[$t](),a=e[On],o=r[l6](e);for(let l=1,c=t.length;l<c;l++){const h=t[l],u=s[Xo]();r[a].push(u),r[l3](o+l,u),this._bindValue(u,h,i),this._setProperties(u,h),this._bindItems(u,h)}}_createOccurrences(e){if(!this.emptyMerge)return;const{occur:t}=e;if(!t||t.initial<=1)return;const i=e[$t](),s=e[On];if(!(i[s]instanceof le))return;let r;e.name?r=i[s].children.filter(l=>l.name===e.name).length:r=i[s].children.length;const a=i[l6](e)+1,o=t.initial-r;if(o){const l=e[Xo]();l[Nh](l.occur),l.occur=null,i[s].push(l),i[l3](a,l);for(let c=1;c<o;c++){const h=l[Xo]();i[s].push(h),i[l3](a+c,h)}}}_getOccurInfo(e){const{name:t,occur:i}=e;if(!i||!t)return[1,1];const s=i.max===-1?1/0:i.max;return[i.min,s]}_setAndBind(e,t){this._setProperties(e,t),this._bindItems(e,t),this._bindElement(e,t)}_bindElement(e,t){const i=[];this._createOccurrences(e);for(const s of e[js]()){if(s[mo])continue;if(this._mergeMode===void 0&&s[On]==="subform"){this._mergeMode=s.mergeMode==="consumeData";const u=t[js]();if(u.length>0)this._bindOccurrences(s,[u[0]],null);else if(this.emptyMerge){const d=t[Ji]===hC?-1:t[Ji],f=s[mo]=new $l(d,s.name||"root");t[Li](f),this._bindElement(s,f)}continue}if(!s[cf]())continue;let r=!1,a=null,o=null,l=null;if(s.bind){switch(s.bind.match){case"none":this._setAndBind(s,t);continue;case"global":r=!0;break;case"dataRef":if(!s.bind.ref){ce(`XFA - ref is empty in node ${s[On]}.`),this._setAndBind(s,t);continue}o=s.bind.ref;break}s.bind.picture&&(a=s.bind.picture[Oe])}const[c,h]=this._getOccurInfo(s);if(o)if(l=M0(this.root,t,o,!0,!1),l===null){if(l=JG(this.data,t,o),!l)continue;this._isConsumeData()&&(l[ql]=!0),this._setAndBind(s,l);continue}else this._isConsumeData()&&(l=l.filter(u=>!u[ql])),l.length>h?l=l.slice(0,h):l.length===0&&(l=null),l&&this._isConsumeData()&&l.forEach(u=>{u[ql]=!0});else{if(!s.name){this._setAndBind(s,t);continue}if(this._isConsumeData()){const u=[];for(;u.length<h;){const d=this._findDataByNameToConsume(s.name,s[Jp](),t,r);if(!d)break;d[ql]=!0,u.push(d)}l=u.length>0?u:null}else{if(l=t[yp](s.name,!1,this.emptyMerge).next().value,!l){if(c===0){i.push(s);continue}const u=t[Ji]===hC?-1:t[Ji];l=s[mo]=new $l(u,s.name),this.emptyMerge&&(l[ql]=!0),t[Li](l),this._setAndBind(s,l);continue}this.emptyMerge&&(l[ql]=!0),l=[l]}}l?this._bindOccurrences(s,l,a):c>0?this._setAndBind(s,t):i.push(s)}i.forEach(s=>s[$t]()[Nh](s))}}class Fq{constructor(e,t){this.data=t,this.dataset=e.datasets||null}serialize(e){const t=[[-1,this.data[js]()]];for(;t.length>0;){const s=t.at(-1),[r,a]=s;if(r+1===a.length){t.pop();continue}const o=a[++s[0]],l=e.get(o[Vn]);if(l)o[ga](l);else{const h=o[bM]();for(const u of h.values()){const d=e.get(u[Vn]);if(d){u[ga](d);break}}}const c=o[js]();c.length>0&&t.push([-1,c])}const i=['<xfa:datasets xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/">'];if(this.dataset)for(const s of this.dataset[js]())s[On]!=="data"&&s[_p](i);return this.data[_p](i),i.push("</xfa:datasets>"),i.join("")}}const Be=es.config.id;class Lq extends Se{constructor(e){super(Be,"acrobat",!0),this.acrobat7=null,this.autoSave=null,this.common=null,this.validate=null,this.validateApprovalSignatures=null,this.submitUrl=new le}}class Bq extends Se{constructor(e){super(Be,"acrobat7",!0),this.dynamicRender=null}}class Uq extends qn{constructor(e){super(Be,"ADBE_JSConsole",["delegate","Enable","Disable"])}}class Hq extends qn{constructor(e){super(Be,"ADBE_JSDebugger",["delegate","Enable","Disable"])}}class zq extends ys{constructor(e){super(Be,"addSilentPrint")}}class jq extends ys{constructor(e){super(Be,"addViewerPreferences")}}class Gq extends CM{constructor(e){super(Be,"adjustData")}}class Vq extends ul{constructor(e){super(Be,"adobeExtensionLevel",0,t=>t>=1&&t<=8)}}class qq extends Se{constructor(e){super(Be,"agent",!0),this.name=e.name?e.name.trim():"",this.common=new le}}class Wq extends zi{constructor(e){super(Be,"alwaysEmbed")}}class Kq extends bn{constructor(e){super(Be,"amd")}}class Xq extends Se{constructor(e){super(Be,"area"),this.level=Qt({data:e.level,defaultValue:0,validate:t=>t>=1&&t<=3}),this.name=Fe(e.name,["","barcode","coreinit","deviceDriver","font","general","layout","merge","script","signature","sourceSet","templateCache"])}}class Yq extends qn{constructor(e){super(Be,"attributes",["preserve","delegate","ignore"])}}class Jq extends qn{constructor(e){super(Be,"autoSave",["disabled","enabled"])}}class Zq extends bn{constructor(e){super(Be,"base")}}class Qq extends Se{constructor(e){super(Be,"batchOutput"),this.format=Fe(e.format,["none","concat","zip","zipCompress"])}}class $q extends zi{constructor(e){super(Be,"behaviorOverride")}[ti](){this[Oe]=new Map(this[Oe].trim().split(/\s+/).filter(e=>e.includes(":")).map(e=>e.split(":",2)))}}class eW extends Se{constructor(e){super(Be,"cache",!0),this.templateCache=null}}class tW extends ys{constructor(e){super(Be,"change")}}class nW extends Se{constructor(e){super(Be,"common",!0),this.data=null,this.locale=null,this.localeSet=null,this.messaging=null,this.suppressBanner=null,this.template=null,this.validationMessaging=null,this.versionControl=null,this.log=new le}}class iW extends Se{constructor(e){super(Be,"compress"),this.scope=Fe(e.scope,["imageOnly","document"])}}class sW extends ys{constructor(e){super(Be,"compressLogicalStructure")}}class rW extends CM{constructor(e){super(Be,"compressObjectStream")}}class aW extends Se{constructor(e){super(Be,"compression",!0),this.compressLogicalStructure=null,this.compressObjectStream=null,this.level=null,this.type=null}}class oW extends Se{constructor(e){super(Be,"config",!0),this.acrobat=null,this.present=null,this.trace=null,this.agent=new le}}class lW extends qn{constructor(e){super(Be,"conformance",["A","B"])}}class cW extends ys{constructor(e){super(Be,"contentCopy")}}class hW extends ul{constructor(e){super(Be,"copies",1,t=>t>=1)}}class uW extends bn{constructor(e){super(Be,"creator")}}class dW extends ul{constructor(e){super(Be,"currentPage",0,t=>t>=0)}}class fW extends Se{constructor(e){super(Be,"data",!0),this.adjustData=null,this.attributes=null,this.incrementalLoad=null,this.outputXSL=null,this.range=null,this.record=null,this.startNode=null,this.uri=null,this.window=null,this.xsl=null,this.excludeNS=new le,this.transform=new le}}class gW extends Se{constructor(e){super(Be,"debug",!0),this.uri=null}}class mW extends zi{constructor(e){super(Be,"defaultTypeface"),this.writingScript=Fe(e.writingScript,["*","Arabic","Cyrillic","EastEuropeanRoman","Greek","Hebrew","Japanese","Korean","Roman","SimplifiedChinese","Thai","TraditionalChinese","Vietnamese"])}}class pW extends qn{constructor(e){super(Be,"destination",["pdf","pcl","ps","webClient","zpl"])}}class bW extends ys{constructor(e){super(Be,"documentAssembly")}}class xW extends Se{constructor(e){super(Be,"driver",!0),this.name=e.name?e.name.trim():"",this.fontInfo=null,this.xdc=null}}class yW extends qn{constructor(e){super(Be,"duplexOption",["simplex","duplexFlipLongEdge","duplexFlipShortEdge"])}}class wW extends qn{constructor(e){super(Be,"dynamicRender",["forbidden","required"])}}class _W extends ys{constructor(e){super(Be,"embed")}}class vW extends ys{constructor(e){super(Be,"encrypt")}}class kW extends Se{constructor(e){super(Be,"encryption",!0),this.encrypt=null,this.encryptionLevel=null,this.permissions=null}}class CW extends qn{constructor(e){super(Be,"encryptionLevel",["40bit","128bit"])}}class AW extends bn{constructor(e){super(Be,"enforce")}}class SW extends Se{constructor(e){super(Be,"equate"),this.force=Qt({data:e.force,defaultValue:1,validate:t=>t===0}),this.from=e.from||"",this.to=e.to||""}}class IW extends Se{constructor(e){super(Be,"equateRange"),this.from=e.from||"",this.to=e.to||"",this._unicodeRange=e.unicodeRange||""}get unicodeRange(){const e=[],t=/U\+([0-9a-fA-F]+)/,i=this._unicodeRange;for(let s of i.split(",").map(r=>r.trim()).filter(r=>!!r))s=s.split("-",2).map(r=>{const a=r.match(t);return a?parseInt(a[1],16):0}),s.length===1&&s.push(s[0]),e.push(s);return Ze(this,"unicodeRange",e)}}class EW extends zi{constructor(e){super(Be,"exclude")}[ti](){this[Oe]=this[Oe].trim().split(/\s+/).filter(e=>e&&["calculate","close","enter","exit","initialize","ready","validate"].includes(e))}}class TW extends bn{constructor(e){super(Be,"excludeNS")}}class RW extends qn{constructor(e){super(Be,"flipLabel",["usePrinterSetting","on","off"])}}class MW extends Se{constructor(e){super(Be,"fontInfo",!0),this.embed=null,this.map=null,this.subsetBelow=null,this.alwaysEmbed=new le,this.defaultTypeface=new le,this.neverEmbed=new le}}class PW extends ys{constructor(e){super(Be,"formFieldFilling")}}class NW extends bn{constructor(e){super(Be,"groupParent")}}class OW extends qn{constructor(e){super(Be,"ifEmpty",["dataValue","dataGroup","ignore","remove"])}}class DW extends bn{constructor(e){super(Be,"includeXDPContent")}}class FW extends qn{constructor(e){super(Be,"incrementalLoad",["none","forwardOnly"])}}class LW extends ys{constructor(e){super(Be,"incrementalMerge")}}class BW extends ys{constructor(e){super(Be,"interactive")}}class UW extends qn{constructor(e){super(Be,"jog",["usePrinterSetting","none","pageSet"])}}class HW extends Se{constructor(e){super(Be,"labelPrinter",!0),this.name=Fe(e.name,["zpl","dpl","ipl","tcpl"]),this.batchOutput=null,this.flipLabel=null,this.fontInfo=null,this.xdc=null}}class zW extends qn{constructor(e){super(Be,"layout",["paginate","panel"])}}class jW extends ul{constructor(e){super(Be,"level",0,t=>t>0)}}class GW extends ys{constructor(e){super(Be,"linearized")}}class VW extends bn{constructor(e){super(Be,"locale")}}class qW extends bn{constructor(e){super(Be,"localeSet")}}class WW extends Se{constructor(e){super(Be,"log",!0),this.mode=null,this.threshold=null,this.to=null,this.uri=null}}class KW extends Se{constructor(e){super(Be,"map",!0),this.equate=new le,this.equateRange=new le}}class XW extends Se{constructor(e){super(Be,"mediumInfo",!0),this.map=null}}class YW extends Se{constructor(e){super(Be,"message",!0),this.msgId=null,this.severity=null}}class JW extends Se{constructor(e){super(Be,"messaging",!0),this.message=new le}}class ZW extends qn{constructor(e){super(Be,"mode",["append","overwrite"])}}class QW extends ys{constructor(e){super(Be,"modifyAnnots")}}class $W extends ul{constructor(e){super(Be,"msgId",1,t=>t>=1)}}class eK extends bn{constructor(e){super(Be,"nameAttr")}}class tK extends zi{constructor(e){super(Be,"neverEmbed")}}class nK extends ul{constructor(e){super(Be,"numberOfCopies",null,t=>t>=2&&t<=5)}}class iK extends Se{constructor(e){super(Be,"openAction",!0),this.destination=null}}class sK extends Se{constructor(e){super(Be,"output",!0),this.to=null,this.type=null,this.uri=null}}class rK extends bn{constructor(e){super(Be,"outputBin")}}class aK extends Se{constructor(e){super(Be,"outputXSL",!0),this.uri=null}}class oK extends qn{constructor(e){super(Be,"overprint",["none","both","draw","field"])}}class lK extends bn{constructor(e){super(Be,"packets")}[ti](){this[Oe]!=="*"&&(this[Oe]=this[Oe].trim().split(/\s+/).filter(e=>["config","datasets","template","xfdf","xslt"].includes(e)))}}class cK extends Se{constructor(e){super(Be,"pageOffset"),this.x=Qt({data:e.x,defaultValue:"useXDCSetting",validate:t=>!0}),this.y=Qt({data:e.y,defaultValue:"useXDCSetting",validate:t=>!0})}}class hK extends bn{constructor(e){super(Be,"pageRange")}[ti](){const e=this[Oe].trim().split(/\s+/).map(i=>parseInt(i,10)),t=[];for(let i=0,s=e.length;i<s;i+=2)t.push(e.slice(i,i+2));this[Oe]=t}}class uK extends qn{constructor(e){super(Be,"pagination",["simplex","duplexShortEdge","duplexLongEdge"])}}class dK extends qn{constructor(e){super(Be,"paginationOverride",["none","forceDuplex","forceDuplexLongEdge","forceDuplexShortEdge","forceSimplex"])}}class fK extends ul{constructor(e){super(Be,"part",1,t=>!1)}}class gK extends Se{constructor(e){super(Be,"pcl",!0),this.name=e.name||"",this.batchOutput=null,this.fontInfo=null,this.jog=null,this.mediumInfo=null,this.outputBin=null,this.pageOffset=null,this.staple=null,this.xdc=null}}class mK extends Se{constructor(e){super(Be,"pdf",!0),this.name=e.name||"",this.adobeExtensionLevel=null,this.batchOutput=null,this.compression=null,this.creator=null,this.encryption=null,this.fontInfo=null,this.interactive=null,this.linearized=null,this.openAction=null,this.pdfa=null,this.producer=null,this.renderPolicy=null,this.scriptModel=null,this.silentPrint=null,this.submitFormat=null,this.tagged=null,this.version=null,this.viewerPreferences=null,this.xdc=null}}class pK extends Se{constructor(e){super(Be,"pdfa",!0),this.amd=null,this.conformance=null,this.includeXDPContent=null,this.part=null}}class bK extends Se{constructor(e){super(Be,"permissions",!0),this.accessibleContent=null,this.change=null,this.contentCopy=null,this.documentAssembly=null,this.formFieldFilling=null,this.modifyAnnots=null,this.plaintextMetadata=null,this.print=null,this.printHighQuality=null}}class xK extends ys{constructor(e){super(Be,"pickTrayByPDFSize")}}class yK extends bn{constructor(e){super(Be,"picture")}}class wK extends ys{constructor(e){super(Be,"plaintextMetadata")}}class _K extends qn{constructor(e){super(Be,"presence",["preserve","dissolve","dissolveStructure","ignore","remove"])}}class vK extends Se{constructor(e){super(Be,"present",!0),this.behaviorOverride=null,this.cache=null,this.common=null,this.copies=null,this.destination=null,this.incrementalMerge=null,this.layout=null,this.output=null,this.overprint=null,this.pagination=null,this.paginationOverride=null,this.script=null,this.validate=null,this.xdp=null,this.driver=new le,this.labelPrinter=new le,this.pcl=new le,this.pdf=new le,this.ps=new le,this.submitUrl=new le,this.webClient=new le,this.zpl=new le}}class kK extends ys{constructor(e){super(Be,"print")}}class CK extends ys{constructor(e){super(Be,"printHighQuality")}}class AK extends qn{constructor(e){super(Be,"printScaling",["appdefault","noScaling"])}}class SK extends bn{constructor(e){super(Be,"printerName")}}class IK extends bn{constructor(e){super(Be,"producer")}}class EK extends Se{constructor(e){super(Be,"ps",!0),this.name=e.name||"",this.batchOutput=null,this.fontInfo=null,this.jog=null,this.mediumInfo=null,this.outputBin=null,this.staple=null,this.xdc=null}}let TK=class extends zi{constructor(e){super(Be,"range")}[ti](){this[Oe]=this[Oe].split(",",2).map(e=>e.split("-").map(t=>parseInt(t.trim(),10))).filter(e=>e.every(t=>!isNaN(t))).map(e=>(e.length===1&&e.push(e[0]),e))}};class RK extends zi{constructor(e){super(Be,"record")}[ti](){this[Oe]=this[Oe].trim();const e=parseInt(this[Oe],10);!isNaN(e)&&e>=0&&(this[Oe]=e)}}class MK extends zi{constructor(e){super(Be,"relevant")}[ti](){this[Oe]=this[Oe].trim().split(/\s+/)}}class PK extends zi{constructor(e){super(Be,"rename")}[ti](){this[Oe]=this[Oe].trim(),(this[Oe].toLowerCase().startsWith("xml")||new RegExp("[\\p{L}_][\\p{L}\\d._\\p{M}-]*","u").test(this[Oe]))&&ce("XFA - Rename: invalid XFA name")}}class NK extends qn{constructor(e){super(Be,"renderPolicy",["server","client"])}}class OK extends qn{constructor(e){super(Be,"runScripts",["both","client","none","server"])}}class DK extends Se{constructor(e){super(Be,"script",!0),this.currentPage=null,this.exclude=null,this.runScripts=null}}class FK extends qn{constructor(e){super(Be,"scriptModel",["XFA","none"])}}class LK extends qn{constructor(e){super(Be,"severity",["ignore","error","information","trace","warning"])}}class BK extends Se{constructor(e){super(Be,"silentPrint",!0),this.addSilentPrint=null,this.printerName=null}}class UK extends Se{constructor(e){super(Be,"staple"),this.mode=Fe(e.mode,["usePrinterSetting","on","off"])}}class HK extends bn{constructor(e){super(Be,"startNode")}}class zK extends ul{constructor(e){super(Be,"startPage",0,t=>!0)}}class jK extends qn{constructor(e){super(Be,"submitFormat",["html","delegate","fdf","xml","pdf"])}}class GK extends bn{constructor(e){super(Be,"submitUrl")}}class VK extends ul{constructor(e){super(Be,"subsetBelow",100,t=>t>=0&&t<=100)}}class qK extends ys{constructor(e){super(Be,"suppressBanner")}}class WK extends ys{constructor(e){super(Be,"tagged")}}class KK extends Se{constructor(e){super(Be,"template",!0),this.base=null,this.relevant=null,this.startPage=null,this.uri=null,this.xsl=null}}class XK extends qn{constructor(e){super(Be,"threshold",["trace","error","information","warning"])}}class YK extends qn{constructor(e){super(Be,"to",["null","memory","stderr","stdout","system","uri"])}}class JK extends Se{constructor(e){super(Be,"templateCache"),this.maxEntries=Qt({data:e.maxEntries,defaultValue:5,validate:t=>t>=0})}}class ZK extends Se{constructor(e){super(Be,"trace",!0),this.area=new le}}class QK extends Se{constructor(e){super(Be,"transform",!0),this.groupParent=null,this.ifEmpty=null,this.nameAttr=null,this.picture=null,this.presence=null,this.rename=null,this.whitespace=null}}class $K extends qn{constructor(e){super(Be,"type",["none","ascii85","asciiHex","ccittfax","flate","lzw","runLength","native","xdp","mergedXDP"])}}class eX extends bn{constructor(e){super(Be,"uri")}}class tX extends qn{constructor(e){super(Be,"validate",["preSubmit","prePrint","preExecute","preSave"])}}class nX extends zi{constructor(e){super(Be,"validateApprovalSignatures")}[ti](){this[Oe]=this[Oe].trim().split(/\s+/).filter(e=>["docReady","postSign"].includes(e))}}class iX extends qn{constructor(e){super(Be,"validationMessaging",["allMessagesIndividually","allMessagesTogether","firstMessageOnly","noMessages"])}}class sX extends qn{constructor(e){super(Be,"version",["1.7","1.6","1.5","1.4","1.3","1.2"])}}class rX extends Se{constructor(e){super(Be,"VersionControl"),this.outputBelow=Fe(e.outputBelow,["warn","error","update"]),this.sourceAbove=Fe(e.sourceAbove,["warn","error"]),this.sourceBelow=Fe(e.sourceBelow,["update","maintain"])}}class aX extends Se{constructor(e){super(Be,"viewerPreferences",!0),this.ADBE_JSConsole=null,this.ADBE_JSDebugger=null,this.addViewerPreferences=null,this.duplexOption=null,this.enforce=null,this.numberOfCopies=null,this.pageRange=null,this.pickTrayByPDFSize=null,this.printScaling=null}}class oX extends Se{constructor(e){super(Be,"webClient",!0),this.name=e.name?e.name.trim():"",this.fontInfo=null,this.xdc=null}}class lX extends qn{constructor(e){super(Be,"whitespace",["preserve","ltrim","normalize","rtrim","trim"])}}class cX extends zi{constructor(e){super(Be,"window")}[ti](){const e=this[Oe].split(",",2).map(t=>parseInt(t.trim(),10));if(e.some(t=>isNaN(t))){this[Oe]=[0,0];return}e.length===1&&e.push(e[0]),this[Oe]=e}}class hX extends Se{constructor(e){super(Be,"xdc",!0),this.uri=new le,this.xsl=new le}}class uX extends Se{constructor(e){super(Be,"xdp",!0),this.packets=null}}class dX extends Se{constructor(e){super(Be,"xsl",!0),this.debug=null,this.uri=null}}class fX extends Se{constructor(e){super(Be,"zpl",!0),this.name=e.name?e.name.trim():"",this.batchOutput=null,this.flipLabel=null,this.fontInfo=null,this.xdc=null}}class U3{static[cl](e,t){if(U3.hasOwnProperty(e))return U3[e](t)}static acrobat(e){return new Lq(e)}static acrobat7(e){return new Bq(e)}static ADBE_JSConsole(e){return new Uq(e)}static ADBE_JSDebugger(e){return new Hq(e)}static addSilentPrint(e){return new zq(e)}static addViewerPreferences(e){return new jq(e)}static adjustData(e){return new Gq(e)}static adobeExtensionLevel(e){return new Vq(e)}static agent(e){return new qq(e)}static alwaysEmbed(e){return new Wq(e)}static amd(e){return new Kq(e)}static area(e){return new Xq(e)}static attributes(e){return new Yq(e)}static autoSave(e){return new Jq(e)}static base(e){return new Zq(e)}static batchOutput(e){return new Qq(e)}static behaviorOverride(e){return new $q(e)}static cache(e){return new eW(e)}static change(e){return new tW(e)}static common(e){return new nW(e)}static compress(e){return new iW(e)}static compressLogicalStructure(e){return new sW(e)}static compressObjectStream(e){return new rW(e)}static compression(e){return new aW(e)}static config(e){return new oW(e)}static conformance(e){return new lW(e)}static contentCopy(e){return new cW(e)}static copies(e){return new hW(e)}static creator(e){return new uW(e)}static currentPage(e){return new dW(e)}static data(e){return new fW(e)}static debug(e){return new gW(e)}static defaultTypeface(e){return new mW(e)}static destination(e){return new pW(e)}static documentAssembly(e){return new bW(e)}static driver(e){return new xW(e)}static duplexOption(e){return new yW(e)}static dynamicRender(e){return new wW(e)}static embed(e){return new _W(e)}static encrypt(e){return new vW(e)}static encryption(e){return new kW(e)}static encryptionLevel(e){return new CW(e)}static enforce(e){return new AW(e)}static equate(e){return new SW(e)}static equateRange(e){return new IW(e)}static exclude(e){return new EW(e)}static excludeNS(e){return new TW(e)}static flipLabel(e){return new RW(e)}static fontInfo(e){return new MW(e)}static formFieldFilling(e){return new PW(e)}static groupParent(e){return new NW(e)}static ifEmpty(e){return new OW(e)}static includeXDPContent(e){return new DW(e)}static incrementalLoad(e){return new FW(e)}static incrementalMerge(e){return new LW(e)}static interactive(e){return new BW(e)}static jog(e){return new UW(e)}static labelPrinter(e){return new HW(e)}static layout(e){return new zW(e)}static level(e){return new jW(e)}static linearized(e){return new GW(e)}static locale(e){return new VW(e)}static localeSet(e){return new qW(e)}static log(e){return new WW(e)}static map(e){return new KW(e)}static mediumInfo(e){return new XW(e)}static message(e){return new YW(e)}static messaging(e){return new JW(e)}static mode(e){return new ZW(e)}static modifyAnnots(e){return new QW(e)}static msgId(e){return new $W(e)}static nameAttr(e){return new eK(e)}static neverEmbed(e){return new tK(e)}static numberOfCopies(e){return new nK(e)}static openAction(e){return new iK(e)}static output(e){return new sK(e)}static outputBin(e){return new rK(e)}static outputXSL(e){return new aK(e)}static overprint(e){return new oK(e)}static packets(e){return new lK(e)}static pageOffset(e){return new cK(e)}static pageRange(e){return new hK(e)}static pagination(e){return new uK(e)}static paginationOverride(e){return new dK(e)}static part(e){return new fK(e)}static pcl(e){return new gK(e)}static pdf(e){return new mK(e)}static pdfa(e){return new pK(e)}static permissions(e){return new bK(e)}static pickTrayByPDFSize(e){return new xK(e)}static picture(e){return new yK(e)}static plaintextMetadata(e){return new wK(e)}static presence(e){return new _K(e)}static present(e){return new vK(e)}static print(e){return new kK(e)}static printHighQuality(e){return new CK(e)}static printScaling(e){return new AK(e)}static printerName(e){return new SK(e)}static producer(e){return new IK(e)}static ps(e){return new EK(e)}static range(e){return new TK(e)}static record(e){return new RK(e)}static relevant(e){return new MK(e)}static rename(e){return new PK(e)}static renderPolicy(e){return new NK(e)}static runScripts(e){return new OK(e)}static script(e){return new DK(e)}static scriptModel(e){return new FK(e)}static severity(e){return new LK(e)}static silentPrint(e){return new BK(e)}static staple(e){return new UK(e)}static startNode(e){return new HK(e)}static startPage(e){return new zK(e)}static submitFormat(e){return new jK(e)}static submitUrl(e){return new GK(e)}static subsetBelow(e){return new VK(e)}static suppressBanner(e){return new qK(e)}static tagged(e){return new WK(e)}static template(e){return new KK(e)}static templateCache(e){return new JK(e)}static threshold(e){return new XK(e)}static to(e){return new YK(e)}static trace(e){return new ZK(e)}static transform(e){return new QK(e)}static type(e){return new $K(e)}static uri(e){return new eX(e)}static validate(e){return new tX(e)}static validateApprovalSignatures(e){return new nX(e)}static validationMessaging(e){return new iX(e)}static version(e){return new sX(e)}static versionControl(e){return new rX(e)}static viewerPreferences(e){return new aX(e)}static webClient(e){return new oX(e)}static whitespace(e){return new lX(e)}static window(e){return new cX(e)}static xdc(e){return new hX(e)}static xdp(e){return new uX(e)}static xsl(e){return new dX(e)}static zpl(e){return new fX(e)}}const Co=es.connectionSet.id;class gX extends Se{constructor(e){super(Co,"connectionSet",!0),this.wsdlConnection=new le,this.xmlConnection=new le,this.xsdConnection=new le}}class mX extends Se{constructor(e){super(Co,"effectiveInputPolicy"),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}}class pX extends Se{constructor(e){super(Co,"effectiveOutputPolicy"),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}}class bX extends bn{constructor(e){super(Co,"operation"),this.id=e.id||"",this.input=e.input||"",this.name=e.name||"",this.output=e.output||"",this.use=e.use||"",this.usehref=e.usehref||""}}class xX extends bn{constructor(e){super(Co,"rootElement"),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}}class yX extends bn{constructor(e){super(Co,"soapAction"),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}}class wX extends bn{constructor(e){super(Co,"soapAddress"),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}}class _X extends bn{constructor(e){super(Co,"uri"),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}}class vX extends bn{constructor(e){super(Co,"wsdlAddress"),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}}class kX extends Se{constructor(e){super(Co,"wsdlConnection",!0),this.dataDescription=e.dataDescription||"",this.name=e.name||"",this.effectiveInputPolicy=null,this.effectiveOutputPolicy=null,this.operation=null,this.soapAction=null,this.soapAddress=null,this.wsdlAddress=null}}class CX extends Se{constructor(e){super(Co,"xmlConnection",!0),this.dataDescription=e.dataDescription||"",this.name=e.name||"",this.uri=null}}class AX extends Se{constructor(e){super(Co,"xsdConnection",!0),this.dataDescription=e.dataDescription||"",this.name=e.name||"",this.rootElement=null,this.uri=null}}class H3{static[cl](e,t){if(H3.hasOwnProperty(e))return H3[e](t)}static connectionSet(e){return new gX(e)}static effectiveInputPolicy(e){return new mX(e)}static effectiveOutputPolicy(e){return new pX(e)}static operation(e){return new bX(e)}static rootElement(e){return new xX(e)}static soapAction(e){return new yX(e)}static soapAddress(e){return new wX(e)}static uri(e){return new _X(e)}static wsdlAddress(e){return new vX(e)}static wsdlConnection(e){return new kX(e)}static xmlConnection(e){return new CX(e)}static xsdConnection(e){return new AX(e)}}const m6=es.datasets.id;class SX extends $l{constructor(e){super(m6,"data",e)}[wp](){return!0}}class IX extends Se{constructor(e){super(m6,"datasets",!0),this.data=null,this.Signature=null}[Ql](e){const t=e[On];(t==="data"&&e[Ji]===m6||t==="Signature"&&e[Ji]===es.signature.id)&&(this[t]=e),this[Li](e)}}class z3{static[cl](e,t){if(z3.hasOwnProperty(e))return z3[e](t)}static datasets(e){return new IX(e)}static data(e){return new SX(e)}}const ji=es.localeSet.id;class EX extends Se{constructor(e){super(ji,"calendarSymbols",!0),this.name="gregorian",this.dayNames=new le(2),this.eraNames=null,this.meridiemNames=null,this.monthNames=new le(2)}}class TX extends bn{constructor(e){super(ji,"currencySymbol"),this.name=Fe(e.name,["symbol","isoname","decimal"])}}class RX extends Se{constructor(e){super(ji,"currencySymbols",!0),this.currencySymbol=new le(3)}}class MX extends bn{constructor(e){super(ji,"datePattern"),this.name=Fe(e.name,["full","long","med","short"])}}class PX extends Se{constructor(e){super(ji,"datePatterns",!0),this.datePattern=new le(4)}}class NX extends zi{constructor(e){super(ji,"dateTimeSymbols")}}class OX extends bn{constructor(e){super(ji,"day")}}class DX extends Se{constructor(e){super(ji,"dayNames",!0),this.abbr=Qt({data:e.abbr,defaultValue:0,validate:t=>t===1}),this.day=new le(7)}}class FX extends bn{constructor(e){super(ji,"era")}}class LX extends Se{constructor(e){super(ji,"eraNames",!0),this.era=new le(2)}}class BX extends Se{constructor(e){super(ji,"locale",!0),this.desc=e.desc||"",this.name="isoname",this.calendarSymbols=null,this.currencySymbols=null,this.datePatterns=null,this.dateTimeSymbols=null,this.numberPatterns=null,this.numberSymbols=null,this.timePatterns=null,this.typeFaces=null}}class UX extends Se{constructor(e){super(ji,"localeSet",!0),this.locale=new le}}class HX extends bn{constructor(e){super(ji,"meridiem")}}class zX extends Se{constructor(e){super(ji,"meridiemNames",!0),this.meridiem=new le(2)}}class jX extends bn{constructor(e){super(ji,"month")}}class GX extends Se{constructor(e){super(ji,"monthNames",!0),this.abbr=Qt({data:e.abbr,defaultValue:0,validate:t=>t===1}),this.month=new le(12)}}class VX extends bn{constructor(e){super(ji,"numberPattern"),this.name=Fe(e.name,["full","long","med","short"])}}class qX extends Se{constructor(e){super(ji,"numberPatterns",!0),this.numberPattern=new le(4)}}class WX extends bn{constructor(e){super(ji,"numberSymbol"),this.name=Fe(e.name,["decimal","grouping","percent","minus","zero"])}}class KX extends Se{constructor(e){super(ji,"numberSymbols",!0),this.numberSymbol=new le(5)}}class XX extends bn{constructor(e){super(ji,"timePattern"),this.name=Fe(e.name,["full","long","med","short"])}}class YX extends Se{constructor(e){super(ji,"timePatterns",!0),this.timePattern=new le(4)}}class JX extends Se{constructor(e){super(ji,"typeFace",!0),this.name=e.name|""}}class ZX extends Se{constructor(e){super(ji,"typeFaces",!0),this.typeFace=new le}}class j3{static[cl](e,t){if(j3.hasOwnProperty(e))return j3[e](t)}static calendarSymbols(e){return new EX(e)}static currencySymbol(e){return new TX(e)}static currencySymbols(e){return new RX(e)}static datePattern(e){return new MX(e)}static datePatterns(e){return new PX(e)}static dateTimeSymbols(e){return new NX(e)}static day(e){return new OX(e)}static dayNames(e){return new DX(e)}static era(e){return new FX(e)}static eraNames(e){return new LX(e)}static locale(e){return new BX(e)}static localeSet(e){return new UX(e)}static meridiem(e){return new HX(e)}static meridiemNames(e){return new zX(e)}static month(e){return new jX(e)}static monthNames(e){return new GX(e)}static numberPattern(e){return new VX(e)}static numberPatterns(e){return new qX(e)}static numberSymbol(e){return new WX(e)}static numberSymbols(e){return new KX(e)}static timePattern(e){return new XX(e)}static timePatterns(e){return new YX(e)}static typeFace(e){return new JX(e)}static typeFaces(e){return new ZX(e)}}const QX=es.signature.id;class $X extends Se{constructor(e){super(QX,"signature",!0)}}class G3{static[cl](e,t){if(G3.hasOwnProperty(e))return G3[e](t)}static signature(e){return new $X(e)}}const eY=es.stylesheet.id;class tY extends Se{constructor(e){super(eY,"stylesheet",!0)}}class V3{static[cl](e,t){if(V3.hasOwnProperty(e))return V3[e](t)}static stylesheet(e){return new tY(e)}}const nY=es.xdp.id;class iY extends Se{constructor(e){super(nY,"xdp",!0),this.uuid=e.uuid||"",this.timeStamp=e.timeStamp||"",this.config=null,this.connectionSet=null,this.datasets=null,this.localeSet=null,this.stylesheet=new le,this.template=null}[c6](e){const t=es[e[On]];return t&&e[Ji]===t.id}}class q3{static[cl](e,t){if(q3.hasOwnProperty(e))return q3[e](t)}static xdp(e){return new iY(e)}}const sY=es.xhtml.id,r9=Symbol(),rY=new Set(["color","font","font-family","font-size","font-stretch","font-style","font-weight","margin","margin-bottom","margin-left","margin-right","margin-top","letter-spacing","line-height","orphans","page-break-after","page-break-before","page-break-inside","tab-interval","tab-stop","text-align","text-decoration","text-indent","vertical-align","widows","kerning-mode","xfa-font-horizontal-scale","xfa-font-vertical-scale","xfa-spacerun","xfa-tab-stops"]),aY=new Map([["page-break-after","breakAfter"],["page-break-before","breakBefore"],["page-break-inside","breakInside"],["kerning-mode",n=>n==="none"?"none":"normal"],["xfa-font-horizontal-scale",n=>`scaleX(${Math.max(0,parseInt(n)/100).toFixed(2)})`],["xfa-font-vertical-scale",n=>`scaleY(${Math.max(0,parseInt(n)/100).toFixed(2)})`],["xfa-spacerun",""],["xfa-tab-stops",""],["font-size",(n,e)=>(n=e.fontSize=Math.abs(pt(n)),Zt(.99*n))],["letter-spacing",n=>Zt(pt(n))],["line-height",n=>Zt(pt(n))],["margin",n=>Zt(pt(n))],["margin-bottom",n=>Zt(pt(n))],["margin-left",n=>Zt(pt(n))],["margin-right",n=>Zt(pt(n))],["margin-top",n=>Zt(pt(n))],["text-indent",n=>Zt(pt(n))],["font-family",n=>n],["vertical-align",n=>Zt(pt(n))]]),oY=/\s+/g,lY=/[\r\n]+/g,cY=/\r\n?/g;function hY(n,e,t){const i=Object.create(null);if(!n)return i;const s=Object.create(null);for(const[r,a]of n.split(";").map(o=>o.split(":",2))){const o=aY.get(r);if(o==="")continue;let l=a;o&&(l=typeof o=="string"?o:o(a,s)),r.endsWith("scale")?i.transform=i.transform?`${i[r]} ${l}`:l:i[r.replaceAll(/-([a-zA-Z])/g,(c,h)=>h.toUpperCase())]=l}if(i.fontFamily&&MM({typeface:i.fontFamily,weight:i.fontWeight||"normal",posture:i.fontStyle||"normal",size:s.fontSize||0},e,e[ei].fontFinder,i),t&&i.verticalAlign&&i.verticalAlign!=="0px"&&i.fontSize){const o=pt(i.fontSize);i.fontSize=Zt(o*.583),i.verticalAlign=Zt(Math.sign(pt(i.verticalAlign))*o*.333)}return t&&i.fontSize&&(i.fontSize=`calc(${i.fontSize} * var(--total-scale-factor))`),EM(i),i}function uY(n){return n.style?n.style.split(";").filter(e=>!!e.trim()).map(e=>e.split(":",2).map(t=>t.trim())).filter(([e,t])=>(e==="font-family"&&n[ei].usedTypefaces.add(t),rY.has(e))).map(e=>e.join(":")).join(";"):""}const dY=new Set(["body","html"]);class Ya extends $l{constructor(e,t){super(sY,t),this[r9]=!1,this.style=e.style||""}[wo](e){super[wo](e),this.style=uY(this)}[ry](){return!dY.has(this[On])}[c0](e,t=!1){t?this[r9]=!0:(e=e.replaceAll(lY,""),this.style.includes("xfa-spacerun:yes")||(e=e.replaceAll(oY," "))),e&&(this[Oe]+=e)}[rc](e,t=!0){const i=Object.create(null),s={top:NaN,bottom:NaN,left:NaN,right:NaN};let r=null;for(const[a,o]of this.style.split(";").map(l=>l.split(":",2)))switch(a){case"font-family":i.typeface=oy(o);break;case"font-size":i.size=pt(o);break;case"font-weight":i.weight=o;break;case"font-style":i.posture=o;break;case"letter-spacing":i.letterSpacing=pt(o);break;case"margin":const l=o.split(/ \t/).map(c=>pt(c));switch(l.length){case 1:s.top=s.bottom=s.left=s.right=l[0];break;case 2:s.top=s.bottom=l[0],s.left=s.right=l[1];break;case 3:s.top=l[0],s.bottom=l[2],s.left=s.right=l[1];break;case 4:s.top=l[0],s.left=l[1],s.bottom=l[2],s.right=l[3];break}break;case"margin-top":s.top=pt(o);break;case"margin-bottom":s.bottom=pt(o);break;case"margin-left":s.left=pt(o);break;case"margin-right":s.right=pt(o);break;case"line-height":r=pt(o);break}if(e.pushData(i,s,r),this[Oe])e.addString(this[Oe]);else for(const a of this[js]()){if(a[On]==="#text"){e.addString(a[Oe]);continue}a[rc](e)}t&&e.popFont()}[Kt](e){const t=[];if(this[_e]={children:t},this[zh]({}),t.length===0&&!this[Oe])return Tt.EMPTY;let i;return this[r9]?i=this[Oe]?this[Oe].replaceAll(cY,`
`):void 0:i=this[Oe]||void 0,Tt.success({name:this[On],attributes:{href:this.href,style:hY(this.style,this,this[r9])},children:t,value:i})}}class fY extends Ya{constructor(e){super(e,"a"),this.href=PM(e.href)||""}}class gY extends Ya{constructor(e){super(e,"b")}[rc](e){e.pushFont({weight:"bold"}),super[rc](e),e.popFont()}}class mY extends Ya{constructor(e){super(e,"body")}[Kt](e){const t=super[Kt](e),{html:i}=t;return i?(i.name="div",i.attributes.class=["xfaRich"],t):Tt.EMPTY}}class pY extends Ya{constructor(e){super(e,"br")}[bs](){return`
`}[rc](e){e.addString(`
`)}[Kt](e){return Tt.success({name:"br"})}}class bY extends Ya{constructor(e){super(e,"html")}[Kt](e){var i;const t=[];if(this[_e]={children:t},this[zh]({}),t.length===0)return Tt.success({name:"div",attributes:{class:["xfaRich"],style:{}},value:this[Oe]||""});if(t.length===1){const s=t[0];if((i=s.attributes)!=null&&i.class.includes("xfaRich"))return Tt.success(s)}return Tt.success({name:"div",attributes:{class:["xfaRich"],style:{}},children:t})}}class xY extends Ya{constructor(e){super(e,"i")}[rc](e){e.pushFont({posture:"italic"}),super[rc](e),e.popFont()}}class yY extends Ya{constructor(e){super(e,"li")}}class wY extends Ya{constructor(e){super(e,"ol")}}class _Y extends Ya{constructor(e){super(e,"p")}[rc](e){super[rc](e,!1),e.addString(`
`),e.addPara(),e.popFont()}[bs](){return this[$t]()[js]().at(-1)===this?super[bs]():super[bs]()+`
`}}class vY extends Ya{constructor(e){super(e,"span")}}class kY extends Ya{constructor(e){super(e,"sub")}}class CY extends Ya{constructor(e){super(e,"sup")}}class AY extends Ya{constructor(e){super(e,"ul")}}class Fg{static[cl](e,t){if(Fg.hasOwnProperty(e))return Fg[e](t)}static a(e){return new fY(e)}static b(e){return new gY(e)}static body(e){return new mY(e)}static br(e){return new pY(e)}static html(e){return new bY(e)}static i(e){return new xY(e)}static li(e){return new yY(e)}static ol(e){return new wY(e)}static p(e){return new _Y(e)}static span(e){return new vY(e)}static sub(e){return new kY(e)}static sup(e){return new CY(e)}static ul(e){return new AY(e)}}const uC={config:U3,connection:H3,datasets:z3,localeSet:j3,signature:G3,stylesheet:V3,template:B3,xdp:q3,xhtml:Fg};class dC{constructor(e){this.namespaceId=e}[cl](e,t){return new $l(this.namespaceId,e,t)}}class SY extends Se{constructor(e){super(-1,"root",Object.create(null)),this.element=null,this[Mf]=e}[Ql](e){return this.element=e,!0}[ti](){super[ti](),this.element.template instanceof Y4&&(this[Mf].set(xM,this.element),this.element.template[hp](this[Mf]),this.element.template[Mf]=this[Mf])}}class IY extends Se{constructor(){super(-1,"",Object.create(null))}[Ql](e){return!1}}class EY{constructor(e=null){this._namespaceStack=[],this._nsAgnosticLevel=0,this._namespacePrefixes=new Map,this._namespaces=new Map,this._nextNsId=Math.max(...Object.values(es).map(({id:t})=>t)),this._currentNamespace=e||new dC(++this._nextNsId)}buildRoot(e){return new SY(e)}build({nsPrefix:e,name:t,attributes:i,namespace:s,prefixes:r}){const a=s!==null;if(a&&(this._namespaceStack.push(this._currentNamespace),this._currentNamespace=this._searchNamespace(s)),r&&this._addNamespacePrefix(r),i.hasOwnProperty(t0)){const c=uC.datasets,h=i[t0];let u=null;for(const[d,f]of Object.entries(h))if(this._getNamespaceToUse(d)===c){u={xfa:f};break}u?i[t0]=u:delete i[t0]}const o=this._getNamespaceToUse(e),l=(o==null?void 0:o[cl](t,i))||new IY;return l[wp]()&&this._nsAgnosticLevel++,(a||r||l[wp]())&&(l[o3]={hasNamespace:a,prefixes:r,nsAgnostic:l[wp]()}),l}isNsAgnostic(){return this._nsAgnosticLevel>0}_searchNamespace(e){let t=this._namespaces.get(e);if(t)return t;for(const[i,{check:s}]of Object.entries(es))if(s(e)){if(t=uC[i],t)return this._namespaces.set(e,t),t;break}return t=new dC(++this._nextNsId),this._namespaces.set(e,t),t}_addNamespacePrefix(e){for(const{prefix:t,value:i}of e){const s=this._searchNamespace(i);let r=this._namespacePrefixes.get(t);r||(r=[],this._namespacePrefixes.set(t,r)),r.push(s)}}_getNamespaceToUse(e){if(!e)return this._currentNamespace;const t=this._namespacePrefixes.get(e);return(t==null?void 0:t.length)>0?t.at(-1):(ce(`Unknown namespace prefix: ${e}.`),null)}clean(e){const{hasNamespace:t,prefixes:i,nsAgnostic:s}=e;t&&(this._currentNamespace=this._namespaceStack.pop()),i&&i.forEach(({prefix:r})=>{this._namespacePrefixes.get(r).pop()}),s&&this._nsAgnosticLevel--}}class W3 extends sM{constructor(e=null,t=!1){super(),this._builder=new EY(e),this._stack=[],this._globalData={usedTypefaces:new Set},this._ids=new Map,this._current=this._builder.buildRoot(this._ids),this._errorCode=la.NoError,this._whiteRegex=/^\s+$/,this._nbsps=/\xa0+/g,this._richText=t}parse(e){if(this.parseXml(e),this._errorCode===la.NoError)return this._current[ti](),this._current.element}onText(e){if(e=e.replace(this._nbsps,t=>t.slice(1)+" "),this._richText||this._current[ry]()){this._current[c0](e,this._richText);return}this._whiteRegex.test(e)||this._current[c0](e.trim())}onCdata(e){this._current[c0](e)}_mkAttributes(e,t){let i=null,s=null;const r=Object.create({});for(const{name:a,value:o}of e)if(a==="xmlns")i?ce(`XFA - multiple namespace definition in <${t}>`):i=o;else if(a.startsWith("xmlns:")){const l=a.substring(6);s??(s=[]),s.push({prefix:l,value:o})}else{const l=a.indexOf(":");if(l===-1)r[a]=o;else{const c=r[t0]??(r[t0]=Object.create(null)),[h,u]=[a.slice(0,l),a.slice(l+1)],d=c[h]||(c[h]=Object.create(null));d[u]=o}}return[i,s,r]}_getNameAndPrefix(e,t){const i=e.indexOf(":");return i===-1?[e,null]:[e.substring(i+1),t?"":e.substring(0,i)]}onBeginElement(e,t,i){const[s,r,a]=this._mkAttributes(t,e),[o,l]=this._getNameAndPrefix(e,this._builder.isNsAgnostic()),c=this._builder.build({nsPrefix:l,name:o,attributes:a,namespace:s,prefixes:r});if(c[ei]=this._globalData,i){c[ti](),this._current[Ql](c)&&c[h6](this._ids),c[wo](this._builder);return}this._stack.push(this._current),this._current=c}onEndElement(e){const t=this._current;if(t[B4]()&&typeof t[Oe]=="string"){const i=new W3;i._globalData=this._globalData;const s=i.parse(t[Oe]);t[Oe]=null,t[Ql](s)}t[ti](),this._current=this._stack.pop(),this._current[Ql](t)&&t[h6](this._ids),t[wo](this._builder)}onError(e){this._errorCode=e}}class bx{constructor(e){try{this.root=new W3().parse(bx._createDocument(e));const t=new Dq(this.root);this.form=t.bind(),this.dataHandler=new Fq(this.root,t.getData()),this.form[ei].template=this.form}catch(t){ce(`XFA - an error occurred during parsing and binding: ${t}`)}}isValid(){return!!(this.root&&this.form)}_createPagesHelper(){const e=this.form[wM]();return new Promise((t,i)=>{const s=()=>{try{const r=e.next();r.done?t(r.value):setTimeout(s,0)}catch(r){i(r)}};setTimeout(s,0)})}async _createPages(){try{this.pages=await this._createPagesHelper(),this.dims=this.pages.children.map(e=>{const{width:t,height:i}=e.attributes.style;return[0,0,parseInt(t),parseInt(i)]})}catch(e){ce(`XFA - an error occurred during layout: ${e}`)}}getBoundingBox(e){return this.dims[e]}async getNumPages(){return this.pages||await this._createPages(),this.dims.length}setImages(e){this.form[ei].images=e}setFonts(e){this.form[ei].fontFinder=new GG(e);const t=[];for(let i of this.form[ei].usedTypefaces)i=oy(i),this.form[ei].fontFinder.find(i)||t.push(i);return t.length>0?t:null}appendFonts(e,t){this.form[ei].fontFinder.add(e,t)}async getPages(){this.pages||await this._createPages();const e=this.pages;return this.pages=null,e}serializeData(e){return this.dataHandler.serialize(e)}static _createDocument(e){return e["/xdp:xdp"]?Object.values(e).join(""):e["xdp:xdp"]}static getRichTextAsHtml(e){if(!e||typeof e!="string")return null;try{let t=new W3(Fg,!0).parse(e);if(!["body","xhtml"].includes(t[On])){const a=Fg.body({});a[Li](t),t=a}const i=t[Kt]();if(!i.success)return null;const{html:s}=i,{attributes:r}=s;return r&&(r.class&&(r.class=r.class.filter(a=>!a.startsWith("xfa"))),r.dir="auto"),{html:s,str:t[bs]()}}catch(t){ce(`XFA - an error occurred during parsing of rich text: ${t}`)}return null}}class F0{static createGlobals(e){return Promise.all([e.ensureCatalog("acroForm"),e.ensureDoc("xfaDatasets"),e.ensureCatalog("structTreeRoot"),e.ensureCatalog("baseUrl"),e.ensureCatalog("attachments"),e.ensureCatalog("globalColorSpaceCache")]).then(([t,i,s,r,a,o])=>({pdfManager:e,acroForm:t instanceof fe?t:fe.empty,xfaDatasets:i,structTreeRoot:s,baseUrl:r,attachments:a,globalColorSpaceCache:o}),t=>(ce(`createGlobals: "${t}".`),null))}static async create(e,t,i,s,r,a,o){const l=r?await this._getPageIndex(e,t,i.pdfManager):null;return i.pdfManager.ensure(this,"_create",[e,t,i,s,r,a,l,o])}static _create(e,t,i,s,r=!1,a=null,o=null,l=null){const c=e.fetchIfRef(t);if(!(c instanceof fe))return;const{acroForm:h,pdfManager:u}=i,d=t instanceof st?t.toString():`annot_${s.createObjId()}`;let f=c.get("Subtype");f=f instanceof ve?f.name:null;const g={xref:e,ref:t,dict:c,subtype:f,id:d,annotationGlobals:i,collectFields:r,orphanFields:a,needAppearances:!r&&h.get("NeedAppearances")===!0,pageIndex:o,evaluatorOptions:u.evaluatorOptions,pageRef:l};switch(f){case"Link":return new OY(g);case"Text":return new NY(g);case"Widget":let m=fo({dict:c,key:"FT"});switch(m=m instanceof ve?m.name:null,m){case"Tx":return new RY(g);case"Btn":return new MY(g);case"Ch":return new PY(g);case"Sig":return new QM(g)}return ce(`Unimplemented widget field type "${m}", falling back to base field type.`),new il(g);case"Popup":return new $M(g);case"FreeText":return new Lw(g);case"Line":return new DY(g);case"Square":return new FY(g);case"Circle":return new LY(g);case"PolyLine":return new eP(g);case"Polygon":return new tP(g);case"Caret":return new BY(g);case"Ink":return new Hm(g);case"Highlight":return new Bw(g);case"Underline":return new UY(g);case"Squiggly":return new HY(g);case"StrikeOut":return new zY(g);case"Stamp":return new cu(g);case"FileAttachment":return new jY(g);default:return r||ce(f?`Unimplemented annotation type "${f}", falling back to base annotation.`:"Annotation is missing the required /Subtype."),new yx(g)}}static async _getPageIndex(e,t,i){try{const s=await e.fetchIfRefAsync(t);if(!(s instanceof fe))return-1;const r=s.getRaw("P");if(r instanceof st)try{return await i.ensureCatalog("getPageIndex",[r])}catch(o){gn(`_getPageIndex -- not a valid page reference: "${o}".`)}if(s.has("Kids"))return-1;const a=await i.ensureDoc("numPages");for(let o=0;o<a;o++){const l=await i.getPage(o),c=await i.ensure(l,"annotations");for(const h of c)if(h instanceof st&&I3(h,t))return o}}catch(s){ce(`_getPageIndex: "${s}".`)}return-1}static generateImages(e,t,i){if(!i)return ce("generateImages: OffscreenCanvas is not supported, cannot save or print some annotations with images."),null;let s;for(const{bitmapId:r,bitmap:a}of e)a&&(s||(s=new Map),s.set(r,cu.createImage(a,t)));return s}static async saveNewAnnotations(e,t,i,s,r){const a=e.xref;let o;const l=[],{isOffscreenCanvasSupported:c}=e.options;for(const h of i)if(!h.deleted)switch(h.annotationType){case pl.FREETEXT:if(!o){const d=new fe(a);d.set("BaseFont",ve.get("Helvetica")),d.set("Type",ve.get("Font")),d.set("Subtype",ve.get("Type1")),d.set("Encoding",ve.get("WinAnsiEncoding")),o=a.getNewTemporaryRef(),r.put(o,{data:d})}l.push(Lw.createNewAnnotation(a,h,r,{evaluator:e,task:t,baseFontRef:o}));break;case pl.HIGHLIGHT:h.quadPoints?l.push(Bw.createNewAnnotation(a,h,r)):l.push(Hm.createNewAnnotation(a,h,r));break;case pl.INK:l.push(Hm.createNewAnnotation(a,h,r));break;case pl.STAMP:const u=c?await(s==null?void 0:s.get(h.bitmapId)):null;if(u!=null&&u.imageStream){const{imageStream:d,smaskStream:f}=u;if(f){const m=a.getNewTemporaryRef();r.put(m,{data:f}),d.dict.set("SMask",m)}const g=u.imageRef=a.getNewTemporaryRef();r.put(g,{data:d}),u.imageStream=u.smaskStream=null}l.push(cu.createNewAnnotation(a,h,r,{image:u}));break;case pl.SIGNATURE:l.push(cu.createNewAnnotation(a,h,r,{}));break}return{annotations:await Promise.all(l)}}static async printNewAnnotations(e,t,i,s,r){if(!s)return null;const{options:a,xref:o}=t,l=[];for(const c of s)if(!c.deleted)switch(c.annotationType){case pl.FREETEXT:l.push(Lw.createNewPrintAnnotation(e,o,c,{evaluator:t,task:i,evaluatorOptions:a}));break;case pl.HIGHLIGHT:c.quadPoints?l.push(Bw.createNewPrintAnnotation(e,o,c,{evaluatorOptions:a})):l.push(Hm.createNewPrintAnnotation(e,o,c,{evaluatorOptions:a}));break;case pl.INK:l.push(Hm.createNewPrintAnnotation(e,o,c,{evaluatorOptions:a}));break;case pl.STAMP:const h=a.isOffscreenCanvasSupported?await(r==null?void 0:r.get(c.bitmapId)):null;if(h!=null&&h.imageStream){const{imageStream:u,smaskStream:d}=h;d&&u.dict.set("SMask",d),h.imageRef=new Eg(u,u.length),h.imageStream=h.smaskStream=null}l.push(cu.createNewPrintAnnotation(e,o,c,{image:h,evaluatorOptions:a}));break;case pl.SIGNATURE:l.push(cu.createNewPrintAnnotation(e,o,c,{evaluatorOptions:a}));break}return Promise.all(l)}}function a1(n,e=new Uint8ClampedArray(3)){if(!Array.isArray(n))return e;const t=e||new Uint8ClampedArray(3);switch(n.length){case 0:return null;case 1:return Nn.gray.getRgbItem(n,0,t,0),t;case 3:return Nn.rgb.getRgbItem(n,0,t,0),t;case 4:return Nn.cmyk.getRgbItem(n,0,t,0),t;default:return e}}function Er(n){return Array.from(n,e=>e/255)}function xx(n,e){const t=n.getArray("QuadPoints");if(!Vr(t,null)||t.length===0||t.length%8>0)return null;const i=new Float32Array(t.length);for(let s=0,r=t.length;s<r;s+=8){const[a,o,l,c,h,u,d,f]=t.slice(s,s+8),g=Math.min(a,l,h,d),m=Math.max(a,l,h,d),x=Math.min(o,c,u,f),p=Math.max(o,c,u,f);if(e!==null&&(g<e[0]||m>e[2]||x<e[1]||p>e[3]))return null;i.set([g,p,m,p,g,x,m,x],s)}return i}function p6(n,e,t){const i=new Float32Array([1/0,1/0,-1/0,-1/0]);Dn.axialAlignedBoundingBox(e,t,i);const[s,r,a,o]=i;if(s===a||r===o)return[1,0,0,1,n[0],n[1]];const l=(n[2]-n[0])/(a-s),c=(n[3]-n[1])/(o-r);return[l,0,0,c,n[0]-s*l,n[1]-r*c]}class yx{constructor(e){const{dict:t,xref:i,annotationGlobals:s,ref:r,orphanFields:a}=e,o=a==null?void 0:a.get(r);o&&t.set("Parent",o),this.setTitle(t.get("T")),this.setContents(t.get("Contents")),this.setModificationDate(t.get("M")),this.setFlags(t.get("F")),this.setRectangle(t.getArray("Rect")),this.setColor(t.getArray("C")),this.setBorderStyle(t),this.setAppearance(t),this.setOptionalContent(t);const l=t.get("MK");this.setBorderAndBackgroundColors(l),this.setRotation(l,t),this.ref=e.ref instanceof st?e.ref:null,this._streams=[],this.appearance&&this._streams.push(this.appearance);const c=!!(this.flags&bi.LOCKED),h=!!(this.flags&bi.LOCKEDCONTENTS);if(this.data={annotationFlags:this.flags,borderStyle:this.borderStyle,color:this.color,backgroundColor:this.backgroundColor,borderColor:this.borderColor,rotation:this.rotation,contentsObj:this._contents,hasAppearance:!!this.appearance,id:e.id,modificationDate:this.modificationDate,rect:this.rectangle,subtype:e.subtype,hasOwnCanvas:!1,noRotate:!!(this.flags&bi.NOROTATE),noHTML:c&&h,isEditable:!1,structParent:-1},s.structTreeRoot){let d=t.get("StructParent");this.data.structParent=d=Number.isInteger(d)&&d>=0?d:-1,s.structTreeRoot.addAnnotationIdToPage(e.pageRef,d)}if(e.collectFields){const d=t.get("Kids");if(Array.isArray(d)){const f=[];for(const g of d)g instanceof st&&f.push(g.toString());f.length!==0&&(this.data.kidIds=f)}this.data.actions=ey(i,t,iR),this.data.fieldName=this._constructFieldName(t),this.data.pageIndex=e.pageIndex}const u=t.get("IT");u instanceof ve&&(this.data.it=u.name),this._isOffscreenCanvasSupported=e.evaluatorOptions.isOffscreenCanvasSupported,this._fallbackFontDict=null,this._needAppearances=!1}_hasFlag(e,t){return!!(e&t)}_buildFlags(e,t){let{flags:i}=this;return e===void 0?t===void 0?void 0:t?i&~bi.PRINT:i&~bi.HIDDEN|bi.PRINT:e?(i|=bi.PRINT,t?i&~bi.NOVIEW|bi.HIDDEN:i&~bi.HIDDEN|bi.NOVIEW):(i&=~(bi.HIDDEN|bi.NOVIEW),t?i&~bi.PRINT:i|bi.PRINT)}_isViewable(e){return!this._hasFlag(e,bi.INVISIBLE)&&!this._hasFlag(e,bi.NOVIEW)}_isPrintable(e){return this._hasFlag(e,bi.PRINT)&&!this._hasFlag(e,bi.HIDDEN)&&!this._hasFlag(e,bi.INVISIBLE)}mustBeViewed(e,t){var s;const i=(s=e==null?void 0:e.get(this.data.id))==null?void 0:s.noView;return i!==void 0?!i:this.viewable&&!this._hasFlag(this.flags,bi.HIDDEN)}mustBePrinted(e){var i;const t=(i=e==null?void 0:e.get(this.data.id))==null?void 0:i.noPrint;return t!==void 0?!t:this.printable}mustBeViewedWhenEditing(e,t=null){return e?!this.data.isEditable:!(t!=null&&t.has(this.data.id))}get viewable(){return this.data.quadPoints===null?!1:this.flags===0?!0:this._isViewable(this.flags)}get printable(){return this.data.quadPoints===null||this.flags===0?!1:this._isPrintable(this.flags)}_parseStringHelper(e){const t=typeof e=="string"?Tn(e):"",i=t&&QR(t).dir==="rtl"?"rtl":"ltr";return{str:t,dir:i}}setDefaultAppearance(e){const{dict:t,annotationGlobals:i}=e,s=fo({dict:t,key:"DA"})||i.acroForm.get("DA");this._defaultAppearance=typeof s=="string"?s:"",this.data.defaultAppearanceData=D4(this._defaultAppearance)}setTitle(e){this._title=this._parseStringHelper(e)}setContents(e){this._contents=this._parseStringHelper(e)}setModificationDate(e){this.modificationDate=typeof e=="string"?e:null}setFlags(e){this.flags=Number.isInteger(e)&&e>0?e:0,this.flags&bi.INVISIBLE&&this.constructor.name!=="Annotation"&&(this.flags^=bi.INVISIBLE)}hasFlag(e){return this._hasFlag(this.flags,e)}setRectangle(e){this.rectangle=y0(e,[0,0,0,0])}setColor(e){this.color=a1(e)}setLineEndings(e){if(this.lineEndings=["None","None"],Array.isArray(e)&&e.length===2)for(let t=0;t<2;t++){const i=e[t];if(i instanceof ve)switch(i.name){case"None":continue;case"Square":case"Circle":case"Diamond":case"OpenArrow":case"ClosedArrow":case"Butt":case"ROpenArrow":case"RClosedArrow":case"Slash":this.lineEndings[t]=i.name;continue}ce(`Ignoring invalid lineEnding: ${i}`)}}setRotation(e,t){this.rotation=0;let i=e instanceof fe?e.get("R")||0:t.get("Rotate")||0;Number.isInteger(i)&&i!==0&&(i%=360,i<0&&(i+=360),i%90===0&&(this.rotation=i))}setBorderAndBackgroundColors(e){e instanceof fe?(this.borderColor=a1(e.getArray("BC"),null),this.backgroundColor=a1(e.getArray("BG"),null)):this.borderColor=this.backgroundColor=null}setBorderStyle(e){if(this.borderStyle=new TY,e instanceof fe)if(e.has("BS")){const t=e.get("BS");if(t instanceof fe){const i=t.get("Type");(!i||Di(i,"Border"))&&(this.borderStyle.setWidth(t.get("W"),this.rectangle),this.borderStyle.setStyle(t.get("S")),this.borderStyle.setDashArray(t.getArray("D")))}}else if(e.has("Border")){const t=e.getArray("Border");Array.isArray(t)&&t.length>=3&&(this.borderStyle.setHorizontalCornerRadius(t[0]),this.borderStyle.setVerticalCornerRadius(t[1]),this.borderStyle.setWidth(t[2],this.rectangle),t.length===4&&this.borderStyle.setDashArray(t[3],!0))}else this.borderStyle.setWidth(0)}setAppearance(e){this.appearance=null;const t=e.get("AP");if(!(t instanceof fe))return;const i=t.get("N");if(i instanceof un){this.appearance=i;return}if(!(i instanceof fe))return;const s=e.get("AS");if(!(s instanceof ve)||!i.has(s.name))return;const r=i.get(s.name);r instanceof un&&(this.appearance=r)}setOptionalContent(e){this.oc=null;const t=e.get("OC");t instanceof ve?ce("setOptionalContent: Support for /Name-entry is not implemented."):t instanceof fe&&(this.oc=t)}async loadResources(e,t){const i=await t.dict.getAsync("Resources");return i&&await Pg.load(i,e,i.xref),i}async getOperatorList(e,t,i,s){const{hasOwnCanvas:r,id:a,rect:o}=this.data;let l=this.appearance;const c=!!(r&&i&zr.DISPLAY);if(c&&(this.width===0||this.height===0))return this.data.hasOwnCanvas=!1,{opList:new Sr,separateForm:!1,separateCanvas:!1};if(!l){if(!c)return{opList:new Sr,separateForm:!1,separateCanvas:!1};l=new Jr(""),l.dict=new fe}const h=l.dict,u=await this.loadResources(A7,l),d=T7(h.getArray("BBox"),[0,0,1,1]),f=Th(h.getArray("Matrix"),el),g=p6(o,d,f),m=new Sr;let x;return this.oc&&(x=await e.parseMarkedContentProps(this.oc,null)),x!==void 0&&m.addOp(ie.beginMarkedContentProps,["OC",x]),m.addOp(ie.beginAnnotation,[a,o,g,f,c]),await e.getOperatorList({stream:l,task:t,resources:u,operatorList:m,fallbackFontDict:this._fallbackFontDict}),m.addOp(ie.endAnnotation,[]),x!==void 0&&m.addOp(ie.endMarkedContent,[]),this.reset(),{opList:m,separateForm:!1,separateCanvas:c}}async save(e,t,i,s){return null}get overlaysTextContent(){return!1}get hasTextContent(){return!1}async extractTextContent(e,t,i){if(!this.appearance)return;const s=await this.loadResources(S7,this.appearance),r=[],a=[];let o=null;const l={desiredSize:Math.Infinity,ready:!0,enqueue(c,h){for(const u of c.items)u.str!==void 0&&(o||(o=u.transform.slice(-2)),a.push(u.str),u.hasEOL&&(r.push(a.join("").trimEnd()),a.length=0))}};if(await e.getTextContent({stream:this.appearance,task:t,resources:s,includeMarkedContent:!0,keepWhiteSpace:!0,sink:l,viewBox:i}),this.reset(),a.length&&r.push(a.join("").trimEnd()),r.length>1||r[0]){const c=this.appearance.dict,h=T7(c.getArray("BBox"),null),u=Th(c.getArray("Matrix"),null);this.data.textPosition=this._transformPoint(o,h,u),this.data.textContent=r}}_transformPoint(e,t,i){const{rect:s}=this.data;t||(t=[0,0,1,1]),i||(i=[1,0,0,1,0,0]);const r=p6(s,t,i);r[4]-=s[0],r[5]-=s[1];const a=e.slice();return Dn.applyTransform(a,r),Dn.applyTransform(a,i),a}getFieldObject(){return this.data.kidIds?{id:this.data.id,actions:this.data.actions,name:this.data.fieldName,strokeColor:this.data.borderColor,fillColor:this.data.backgroundColor,type:"",kidIds:this.data.kidIds,page:this.data.pageIndex,rotation:this.rotation}:null}reset(){for(const e of this._streams)e.reset()}_constructFieldName(e){if(!e.has("T")&&!e.has("Parent"))return ce("Unknown field name, falling back to empty field name."),"";if(!e.has("Parent"))return Tn(e.get("T"));const t=[];e.has("T")&&t.unshift(Tn(e.get("T")));let i=e;const s=new Zi;for(e.objId&&s.put(e.objId);i.has("Parent")&&(i=i.get("Parent"),!(!(i instanceof fe)||i.objId&&s.has(i.objId)));)i.objId&&s.put(i.objId),i.has("T")&&t.unshift(Tn(i.get("T")));return t.join(".")}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class TY{constructor(){this.width=1,this.rawWidth=1,this.style=uf.SOLID,this.dashArray=[3],this.horizontalCornerRadius=0,this.verticalCornerRadius=0}setWidth(e,t=[0,0,0,0]){if(e instanceof ve){this.width=0;return}if(typeof e=="number"){if(e>0){this.rawWidth=e;const i=(t[2]-t[0])/2,s=(t[3]-t[1])/2;i>0&&s>0&&(e>i||e>s)&&(ce(`AnnotationBorderStyle.setWidth - ignoring width: ${e}`),e=1)}this.width=e}}setStyle(e){if(e instanceof ve)switch(e.name){case"S":this.style=uf.SOLID;break;case"D":this.style=uf.DASHED;break;case"B":this.style=uf.BEVELED;break;case"I":this.style=uf.INSET;break;case"U":this.style=uf.UNDERLINE;break}}setDashArray(e,t=!1){if(Array.isArray(e)){let i=!0,s=!0;for(const r of e)if(+r>=0)r>0&&(s=!1);else{i=!1;break}e.length===0||i&&!s?(this.dashArray=e,t&&this.setStyle(ve.get("D"))):this.width=0}else e&&(this.width=0)}setHorizontalCornerRadius(e){Number.isInteger(e)&&(this.horizontalCornerRadius=e)}setVerticalCornerRadius(e){Number.isInteger(e)&&(this.verticalCornerRadius=e)}}class ma extends yx{constructor(e){super(e);const{dict:t}=e;if(t.has("IRT")){const s=t.getRaw("IRT");this.data.inReplyTo=s instanceof st?s.toString():null;const r=t.get("RT");this.data.replyType=r instanceof ve?r.name:_7.REPLY}let i=null;if(this.data.replyType===_7.GROUP){const s=t.get("IRT");this.setTitle(s.get("T")),this.data.titleObj=this._title,this.setContents(s.get("Contents")),this.data.contentsObj=this._contents,s.has("CreationDate")?(this.setCreationDate(s.get("CreationDate")),this.data.creationDate=this.creationDate):this.data.creationDate=null,s.has("M")?(this.setModificationDate(s.get("M")),this.data.modificationDate=this.modificationDate):this.data.modificationDate=null,i=s.getRaw("Popup"),s.has("C")?(this.setColor(s.getArray("C")),this.data.color=this.color):this.data.color=null}else this.data.titleObj=this._title,this.setCreationDate(t.get("CreationDate")),this.data.creationDate=this.creationDate,i=t.getRaw("Popup"),t.has("C")||(this.data.color=null);this.data.popupRef=i instanceof st?i.toString():null,t.has("RC")&&(this.data.richText=bx.getRichTextAsHtml(t.get("RC")))}setCreationDate(e){this.creationDate=typeof e=="string"?e:null}_setDefaultAppearance({xref:e,extra:t,strokeColor:i,fillColor:s,blendMode:r,strokeAlpha:a,fillAlpha:o,pointsCallback:l}){const c=this.data.rect=[1/0,1/0,-1/0,-1/0],h=["q"];t&&h.push(t),i&&h.push(`${i[0]} ${i[1]} ${i[2]} RG`),s&&h.push(`${s[0]} ${s[1]} ${s[2]} rg`);const u=this.data.quadPoints||Float32Array.from([this.rectangle[0],this.rectangle[3],this.rectangle[2],this.rectangle[3],this.rectangle[0],this.rectangle[1],this.rectangle[2],this.rectangle[1]]);for(let w=0,_=u.length;w<_;w+=8){const v=l(h,u.subarray(w,w+8));Dn.rectBoundingBox(...v,c)}h.push("Q");const d=new fe(e),f=new fe(e);f.set("Subtype",ve.get("Form"));const g=new Jr(h.join(" "));g.dict=f,d.set("Fm0",g);const m=new fe(e);r&&m.set("BM",ve.get(r)),typeof a=="number"&&m.set("CA",a),typeof o=="number"&&m.set("ca",o);const x=new fe(e);x.set("GS0",m);const p=new fe(e);p.set("ExtGState",x),p.set("XObject",d);const y=new fe(e);y.set("Resources",p),y.set("BBox",c),this.appearance=new Jr("/GS0 gs /Fm0 Do"),this.appearance.dict=y,this._streams.push(this.appearance,g)}static async createNewAnnotation(e,t,i,s){const r=t.ref||(t.ref=e.getNewTemporaryRef()),a=await this.createNewAppearanceStream(t,e,s);let o;if(a){const l=e.getNewTemporaryRef();o=this.createNewDict(t,e,{apRef:l}),i.put(l,{data:a})}else o=this.createNewDict(t,e,{});return Number.isInteger(t.parentTreeId)&&o.set("StructParent",t.parentTreeId),i.put(r,{data:o}),{ref:r}}static async createNewPrintAnnotation(e,t,i,s){const r=await this.createNewAppearanceStream(i,t,s),a=this.createNewDict(i,t,r?{ap:r}:{}),o=new this.prototype.constructor({dict:a,xref:t,annotationGlobals:e,evaluatorOptions:s.evaluatorOptions});return i.ref&&(o.ref=o.refToReplace=i.ref),o}}class il extends yx{constructor(e){var d;super(e);const{dict:t,xref:i,annotationGlobals:s}=e,r=this.data;this._needAppearances=e.needAppearances,r.annotationType=Ks.WIDGET,r.fieldName===void 0&&(r.fieldName=this._constructFieldName(t)),r.actions===void 0&&(r.actions=ey(i,t,iR));let a=fo({dict:t,key:"V",getArray:!0});r.fieldValue=this._decodeFormValue(a);const o=fo({dict:t,key:"DV",getArray:!0});if(r.defaultFieldValue=this._decodeFormValue(o),a===void 0&&s.xfaDatasets){const f=this._title.str;f&&(this._hasValueFromXFA=!0,r.fieldValue=a=s.xfaDatasets.getValue(f))}a===void 0&&r.defaultFieldValue!==null&&(r.fieldValue=r.defaultFieldValue),r.alternativeText=Tn(t.get("TU")||""),this.setDefaultAppearance(e),r.hasAppearance||(r.hasAppearance=this._needAppearances&&r.fieldValue!==void 0&&r.fieldValue!==null);const l=fo({dict:t,key:"FT"});r.fieldType=l instanceof ve?l.name:null;const c=fo({dict:t,key:"DR"}),h=s.acroForm.get("DR"),u=(d=this.appearance)==null?void 0:d.dict.get("Resources");this._fieldResources={localResources:c,acroFormResources:h,appearanceResources:u,mergedResources:fe.merge({xref:i,dictArray:[c,u,h],mergeSubDicts:!0})},r.fieldFlags=fo({dict:t,key:"Ff"}),(!Number.isInteger(r.fieldFlags)||r.fieldFlags<0)&&(r.fieldFlags=0),r.password=this.hasFieldFlag(Jo.PASSWORD),r.readOnly=this.hasFieldFlag(Jo.READONLY),r.required=this.hasFieldFlag(Jo.REQUIRED),r.hidden=this._hasFlag(r.annotationFlags,bi.HIDDEN)||this._hasFlag(r.annotationFlags,bi.NOVIEW)}_decodeFormValue(e){return Array.isArray(e)?e.filter(t=>typeof t=="string").map(t=>Tn(t)):e instanceof ve?Tn(e.name):typeof e=="string"?Tn(e):null}hasFieldFlag(e){return!!(this.data.fieldFlags&e)}_isViewable(e){return!0}mustBeViewed(e,t){return t?this.viewable:super.mustBeViewed(e,t)&&!this._hasFlag(this.flags,bi.NOVIEW)}getRotationMatrix(e){var i;let t=(i=e==null?void 0:e.get(this.data.id))==null?void 0:i.rotation;return t===void 0&&(t=this.rotation),t===0?el:T3(t,this.width,this.height)}getBorderAndBackgroundAppearances(e){var r;let t=(r=e==null?void 0:e.get(this.data.id))==null?void 0:r.rotation;if(t===void 0&&(t=this.rotation),!this.backgroundColor&&!this.borderColor)return"";const i=t===0||t===180?`0 0 ${this.width} ${this.height} re`:`0 0 ${this.height} ${this.width} re`;let s="";if(this.backgroundColor&&(s=`${sc(this.backgroundColor,!0)} ${i} f `),this.borderColor){const a=this.borderStyle.width||1;s+=`${a} w ${sc(this.borderColor,!1)} ${i} S `}return s}async getOperatorList(e,t,i,s){if(i&zr.ANNOTATIONS_FORMS&&!(this instanceof QM)&&!this.data.noHTML&&!this.data.hasOwnCanvas)return{opList:new Sr,separateForm:!0,separateCanvas:!1};if(!this._hasText)return super.getOperatorList(e,t,i,s);const r=await this._getAppearance(e,t,i,s);if(this.appearance&&r===null)return super.getOperatorList(e,t,i,s);const a=new Sr;if(!this._defaultAppearance||r===null)return{opList:a,separateForm:!1,separateCanvas:!1};const o=!!(this.data.hasOwnCanvas&&i&zr.DISPLAY),l=[1,0,0,1,0,0],c=[0,0,this.width,this.height],h=p6(this.data.rect,c,l);let u;this.oc&&(u=await e.parseMarkedContentProps(this.oc,null)),u!==void 0&&a.addOp(ie.beginMarkedContentProps,["OC",u]),a.addOp(ie.beginAnnotation,[this.data.id,this.data.rect,h,this.getRotationMatrix(s),o]);const d=new Jr(r);return await e.getOperatorList({stream:d,task:t,resources:this._fieldResources.mergedResources,operatorList:a}),a.addOp(ie.endAnnotation,[]),u!==void 0&&a.addOp(ie.endMarkedContent,[]),{opList:a,separateForm:!1,separateCanvas:o}}_getMKDict(e){const t=new fe(null);return e&&t.set("R",e),this.borderColor&&t.set("BC",Er(this.borderColor)),this.backgroundColor&&t.set("BG",Er(this.backgroundColor)),t.size>0?t:null}amendSavedDict(e,t){}setValue(e,t,i,s){const{dict:r,ref:a}=kU(e,this.ref,i);if(!r)e.set("V",t);else if(!s.has(a)){const o=r.clone();return o.set("V",t),s.put(a,{data:o}),o}return null}async save(e,t,i,s){const r=i==null?void 0:i.get(this.data.id),a=this._buildFlags(r==null?void 0:r.noView,r==null?void 0:r.noPrint);let o=r==null?void 0:r.value,l=r==null?void 0:r.rotation;if(o===this.data.fieldValue||o===void 0){if(!this._hasValueFromXFA&&l===void 0&&a===void 0)return;o||(o=this.data.fieldValue)}if(l===void 0&&!this._hasValueFromXFA&&Array.isArray(o)&&Array.isArray(this.data.fieldValue)&&Bp(o,this.data.fieldValue)&&a===void 0)return;l===void 0&&(l=this.rotation);let c=null;if(!this._needAppearances&&(c=await this._getAppearance(e,t,zr.SAVE,i),c===null&&a===void 0))return;let h=!1;c!=null&&c.needAppearances&&(h=!0,c=null);const{xref:u}=e,d=u.fetchIfRef(this.ref);if(!(d instanceof fe))return;const f=new fe(u);for(const p of d.getKeys())p!=="AP"&&f.set(p,d.getRaw(p));if(a!==void 0&&(f.set("F",a),c===null&&!h)){const p=d.getRaw("AP");p&&f.set("AP",p)}const g={path:this.data.fieldName,value:o},m=this.setValue(f,Array.isArray(o)?o.map(go):go(o),u,s);this.amendSavedDict(i,m||f);const x=this._getMKDict(l);if(x&&f.set("MK",x),s.put(this.ref,{data:f,xfa:g,needAppearances:h}),c!==null){const p=u.getNewTemporaryRef(),y=new fe(u);f.set("AP",y),y.set("N",p);const w=this._getSaveFieldResources(u),_=new Jr(c),v=_.dict=new fe(u);v.set("Subtype",ve.get("Form")),v.set("Resources",w);const C=l%180===0?[0,0,this.width,this.height]:[0,0,this.height,this.width];v.set("BBox",C);const k=this.getRotationMatrix(i);k!==el&&v.set("Matrix",k),s.put(p,{data:_,xfa:null,needAppearances:!1})}f.set("M",`D:${x0()}`)}async _getAppearance(e,t,i,s){if(this.data.password)return null;const r=s==null?void 0:s.get(this.data.id);let a,o;if(r&&(a=r.formattedValue||r.value,o=r.rotation),o===void 0&&a===void 0&&!this._needAppearances&&(!this._hasValueFromXFA||this.appearance))return null;const l=this.getBorderAndBackgroundAppearances(s);if(a===void 0&&(a=this.data.fieldValue,!a))return`/Tx BMC q ${l}Q EMC`;if(Array.isArray(a)&&a.length===1&&(a=a[0]),Hs(typeof a=="string","Expected `value` to be a string."),a=a.trimEnd(),this.data.combo){const N=this.data.options.find(({exportValue:F})=>a===F);a=(N==null?void 0:N.displayValue)||a}if(a==="")return`/Tx BMC q ${l}Q EMC`;o===void 0&&(o=this.rotation);let c=-1,h;this.data.multiLine?(h=a.split(/\r\n?|\n/).map(N=>N.normalize("NFC")),c=h.length):h=[a.replace(/\r\n?|\n/,"").normalize("NFC")];const u=1,d=2;let{width:f,height:g}=this;(o===90||o===270)&&([f,g]=[g,f]),this._defaultAppearance||(this.data.defaultAppearanceData=D4(this._defaultAppearance="/Helvetica 0 Tf 0 g"));let m=await il._getFontData(e,t,this.data.defaultAppearanceData,this._fieldResources.mergedResources),x,p,y;const w=[];let _=!1;for(const N of h){const F=m.encodeString(N);F.length>1&&(_=!0),w.push(F.join(""))}if(_&&i&zr.SAVE)return{needAppearances:!0};if(_&&this._isOffscreenCanvasSupported){const N=this.data.comb?"monospace":"sans-serif",F=new Vl(e.xref,N),H=F.createFontResources(h.join("")),T=H.getRaw("Font");if(this._fieldResources.mergedResources.has("Font")){const L=this._fieldResources.mergedResources.get("Font");for(const Y of T.getKeys())L.set(Y,T.getRaw(Y))}else this._fieldResources.mergedResources.set("Font",T);const z=F.fontName.name;m=await il._getFontData(e,t,{fontName:z,fontSize:0},H);for(let L=0,Y=w.length;L<Y;L++)w[L]=uR(h[L]);const R=Object.assign(Object.create(null),this.data.defaultAppearanceData);this.data.defaultAppearanceData.fontSize=0,this.data.defaultAppearanceData.fontName=z,[x,p,y]=this._computeFontSize(g-2*u,f-2*d,a,m,c),this.data.defaultAppearanceData=R}else this._isOffscreenCanvasSupported||ce("_getAppearance: OffscreenCanvas is not supported, annotation may not render correctly."),[x,p,y]=this._computeFontSize(g-2*u,f-2*d,a,m,c);let v=m.descent;isNaN(v)?v=Uv*y:v=Math.max(Uv*y,Math.abs(v)*p);const C=Math.min(Math.floor((g-p)/2),u),k=this.data.textAlignment;if(this.data.multiLine)return this._getMultilineAppearance(x,w,m,p,f,g,k,d,C,v,y,s);if(this.data.comb)return this._getCombAppearance(x,m,w[0],p,f,g,d,C,v,y,s);const I=C+v;if(k===0||k>2)return`/Tx BMC q ${l}BT `+x+` 1 0 0 1 ${vn(d)} ${vn(I)} Tm (${Ig(w[0])}) Tj ET Q EMC`;const S={shift:0},M=this._renderText(w[0],m,p,f,k,S,d,I);return`/Tx BMC q ${l}BT `+x+` 1 0 0 1 0 0 Tm ${M} ET Q EMC`}static async _getFontData(e,t,i,s){const r=new Sr,a={font:null,clone(){return this}},{fontName:o,fontSize:l}=i;return await e.handleSetFont(s,[o&&ve.get(o),l],null,r,t,a,null),a.font}_getTextWidth(e,t){return Math.sumPrecise(t.charsToGlyphs(e).map(i=>i.width))/1e3}_computeFontSize(e,t,i,s,r){let{fontSize:a}=this.data.defaultAppearanceData,o=(a||12)*a0,l=Math.round(e/o);if(!a){const c=d=>Math.floor(d*100)/100;if(r===-1){const d=this._getTextWidth(i,s);a=c(Math.min(e/a0,t/d)),l=1}else{const d=i.split(/\r\n?|\n/),f=[];for(const m of d){const x=s.encodeString(m).join(""),p=s.charsToGlyphs(x),y=s.getCharPositions(x);f.push({line:x,glyphs:p,positions:y})}const g=m=>{let x=0;for(const p of f){const y=this._splitLine(null,s,m,t,p);if(x+=y.length*m,x>e)return!0}return!1};for(l=Math.max(l,r);;){if(o=e/l,a=c(o/a0),g(a)){l++;continue}break}}const{fontName:h,fontColor:u}=this.data.defaultAppearanceData;this._defaultAppearance=EG({fontSize:a,fontName:h,fontColor:u})}return[this._defaultAppearance,a,e/l]}_renderText(e,t,i,s,r,a,o,l){let c;if(r===1){const u=this._getTextWidth(e,t)*i;c=(s-u)/2}else if(r===2){const u=this._getTextWidth(e,t)*i;c=s-u-o}else c=o;const h=vn(c-a.shift);return a.shift=c,l=vn(l),`${h} ${l} Td (${Ig(e)}) Tj`}_getSaveFieldResources(e){var a;const{localResources:t,appearanceResources:i,acroFormResources:s}=this._fieldResources,r=(a=this.data.defaultAppearanceData)==null?void 0:a.fontName;if(!r)return t||fe.empty;for(const o of[t,i])if(o instanceof fe){const l=o.get("Font");if(l instanceof fe&&l.has(r))return o}if(s instanceof fe){const o=s.get("Font");if(o instanceof fe&&o.has(r)){const l=new fe(e);l.set(r,o.getRaw(r));const c=new fe(e);return c.set("Font",l),fe.merge({xref:e,dictArray:[c,t],mergeSubDicts:!0})}}return t||fe.empty}getFieldObject(){return null}}class RY extends il{constructor(e){super(e);const{dict:t}=e;t.has("PMD")&&(this.flags|=bi.HIDDEN,this.data.hidden=!0,ce("Barcodes are not supported")),this.data.hasOwnCanvas=this.data.readOnly&&!this.data.noHTML,this._hasText=!0,typeof this.data.fieldValue!="string"&&(this.data.fieldValue="");let i=fo({dict:t,key:"Q"});(!Number.isInteger(i)||i<0||i>2)&&(i=null),this.data.textAlignment=i;let s=fo({dict:t,key:"MaxLen"});(!Number.isInteger(s)||s<0)&&(s=0),this.data.maxLen=s,this.data.multiLine=this.hasFieldFlag(Jo.MULTILINE),this.data.comb=this.hasFieldFlag(Jo.COMB)&&!this.data.multiLine&&!this.data.password&&!this.hasFieldFlag(Jo.FILESELECT)&&this.data.maxLen!==0,this.data.doNotScroll=this.hasFieldFlag(Jo.DONOTSCROLL);const{data:{actions:r}}=this;for(const a of(r==null?void 0:r.Keystroke)||[]){const o=a.trim().match(/^AF(Date|Time)_Keystroke(?:Ex)?\(['"]?([^'"]+)['"]?\);$/);if(o){let l=o[2];const c=parseInt(l,10);!isNaN(c)&&Math.floor(Math.log10(c))+1===o[2].length&&(l=(o[1]==="Date"?TG:RG)[c]??l),this.data[o[1]==="Date"?"dateFormat":"timeFormat"]=l;break}}}get hasTextContent(){return!!this.appearance&&!this._needAppearances}_getCombAppearance(e,t,i,s,r,a,o,l,c,h,u){const d=r/this.data.maxLen,f=this.getBorderAndBackgroundAppearances(u),g=[],m=t.getCharPositions(i);for(const[p,y]of m)g.push(`(${Ig(i.substring(p,y))}) Tj`);const x=g.join(` ${vn(d)} 0 Td `);return`/Tx BMC q ${f}BT `+e+` 1 0 0 1 ${vn(o)} ${vn(l+c)} Tm ${x} ET Q EMC`}_getMultilineAppearance(e,t,i,s,r,a,o,l,c,h,u,d){const f=[],g=r-2*l,m={shift:0};for(let y=0,w=t.length;y<w;y++){const _=t[y],v=this._splitLine(_,i,s,g);for(let C=0,k=v.length;C<k;C++){const I=v[C],S=y===0&&C===0?-c-(u-h):-u;f.push(this._renderText(I,i,s,r,o,m,l,S))}}const x=this.getBorderAndBackgroundAppearances(d),p=f.join(`
`);return`/Tx BMC q ${x}BT `+e+` 1 0 0 1 0 ${vn(a)} Tm ${p} ET Q EMC`}_splitLine(e,t,i,s,r={}){e=r.line||e;const a=r.glyphs||t.charsToGlyphs(e);if(a.length<=1)return[e];const o=r.positions||t.getCharPositions(e),l=i/1e3,c=[];let h=-1,u=-1,d=-1,f=0,g=0;for(let m=0,x=a.length;m<x;m++){const[p,y]=o[m],w=a[m],_=w.width*l;w.unicode===" "?g+_>s?(c.push(e.substring(f,p)),f=p,g=_,h=-1,d=-1):(g+=_,h=p,u=y,d=m):g+_>s?h!==-1?(c.push(e.substring(f,u)),f=u,m=d+1,h=-1,g=0):(c.push(e.substring(f,p)),f=p,g=_):g+=_}return f<e.length&&c.push(e.substring(f,e.length)),c}async extractTextContent(e,t,i){await super.extractTextContent(e,t,i);const s=this.data.textContent;if(!s)return;const r=s.join(`
`);if(r===this.data.fieldValue)return;const a=r.replaceAll(/([.*+?^${}()|[\]\\])|(\s+)/g,(o,l)=>l?`\\${l}`:"\\s+");new RegExp(`^\\s*${a}\\s*$`).test(this.data.fieldValue)&&(this.data.textContent=this.data.fieldValue.split(`
`))}getFieldObject(){return{id:this.data.id,value:this.data.fieldValue,defaultValue:this.data.defaultFieldValue||"",multiline:this.data.multiLine,password:this.data.password,charLimit:this.data.maxLen,comb:this.data.comb,editable:!this.data.readOnly,hidden:this.data.hidden,name:this.data.fieldName,rect:this.data.rect,actions:this.data.actions,page:this.data.pageIndex,strokeColor:this.data.borderColor,fillColor:this.data.backgroundColor,rotation:this.rotation,type:"text"}}}class MY extends il{constructor(e){super(e),this.checkedAppearance=null,this.uncheckedAppearance=null;const t=this.hasFieldFlag(Jo.RADIO),i=this.hasFieldFlag(Jo.PUSHBUTTON);this.data.checkBox=!t&&!i,this.data.radioButton=t&&!i,this.data.pushButton=i,this.data.isTooltipOnly=!1,this.data.checkBox?this._processCheckBox(e):this.data.radioButton?this._processRadioButton(e):this.data.pushButton?(this.data.hasOwnCanvas=!0,this.data.noHTML=!1,this._processPushButton(e)):ce("Invalid field flags for button widget annotation")}async getOperatorList(e,t,i,s){if(this.data.pushButton)return super.getOperatorList(e,t,i,!1,s);let r=null,a=null;if(s){const l=s.get(this.data.id);r=l?l.value:null,a=l?l.rotation:null}if(r===null&&this.appearance)return super.getOperatorList(e,t,i,s);r==null&&(r=this.data.checkBox?this.data.fieldValue===this.data.exportValue:this.data.fieldValue===this.data.buttonValue);const o=r?this.checkedAppearance:this.uncheckedAppearance;if(o){const l=this.appearance,c=Th(o.dict.getArray("Matrix"),el);a&&o.dict.set("Matrix",this.getRotationMatrix(s)),this.appearance=o;const h=super.getOperatorList(e,t,i,s);return this.appearance=l,o.dict.set("Matrix",c),h}return{opList:new Sr,separateForm:!1,separateCanvas:!1}}async save(e,t,i,s){if(this.data.checkBox){this._saveCheckbox(e,t,i,s);return}this.data.radioButton&&this._saveRadioButton(e,t,i,s)}async _saveCheckbox(e,t,i,s){if(!i)return;const r=i.get(this.data.id),a=this._buildFlags(r==null?void 0:r.noView,r==null?void 0:r.noPrint);let o=r==null?void 0:r.rotation,l=r==null?void 0:r.value;if(o===void 0&&a===void 0&&(l===void 0||this.data.fieldValue===this.data.exportValue===l))return;let c=e.xref.fetchIfRef(this.ref);if(!(c instanceof fe))return;c=c.clone(),o===void 0&&(o=this.rotation),l===void 0&&(l=this.data.fieldValue===this.data.exportValue);const h={path:this.data.fieldName,value:l?this.data.exportValue:""},u=ve.get(l?this.data.exportValue:"Off");this.setValue(c,u,e.xref,s),c.set("AS",u),c.set("M",`D:${x0()}`),a!==void 0&&c.set("F",a);const d=this._getMKDict(o);d&&c.set("MK",d),s.put(this.ref,{data:c,xfa:h,needAppearances:!1})}async _saveRadioButton(e,t,i,s){if(!i)return;const r=i.get(this.data.id),a=this._buildFlags(r==null?void 0:r.noView,r==null?void 0:r.noPrint);let o=r==null?void 0:r.rotation,l=r==null?void 0:r.value;if(o===void 0&&a===void 0&&(l===void 0||this.data.fieldValue===this.data.buttonValue===l))return;let c=e.xref.fetchIfRef(this.ref);if(!(c instanceof fe))return;c=c.clone(),l===void 0&&(l=this.data.fieldValue===this.data.buttonValue),o===void 0&&(o=this.rotation);const h={path:this.data.fieldName,value:l?this.data.buttonValue:""},u=ve.get(l?this.data.buttonValue:"Off");l&&this.setValue(c,u,e.xref,s),c.set("AS",u),c.set("M",`D:${x0()}`),a!==void 0&&c.set("F",a);const d=this._getMKDict(o);d&&c.set("MK",d),s.put(this.ref,{data:c,xfa:h,needAppearances:!1})}_getDefaultCheckedAppearance(e,t){const{width:i,height:s}=this,r=[0,0,i,s],o=Math.min(i,s)*.8;let l,c;t==="check"?(l={width:.755*o,height:.705*o},c="3"):t==="disc"?(l={width:.791*o,height:.705*o},c="l"):kn(`_getDefaultCheckedAppearance - unsupported type: ${t}`);const h=vn((i-l.width)/2),u=vn((s-l.height)/2),d=`q BT /PdfJsZaDb ${o} Tf 0 g ${h} ${u} Td (${c}) Tj ET Q`,f=new fe(e.xref);f.set("FormType",1),f.set("Subtype",ve.get("Form")),f.set("Type",ve.get("XObject")),f.set("BBox",r),f.set("Matrix",[1,0,0,1,0,0]),f.set("Length",d.length);const g=new fe(e.xref),m=new fe(e.xref);m.set("PdfJsZaDb",this.fallbackFontDict),g.set("Font",m),f.set("Resources",g),this.checkedAppearance=new Jr(d),this.checkedAppearance.dict=f,this._streams.push(this.checkedAppearance)}_processCheckBox(e){const t=e.dict.get("AP");if(!(t instanceof fe))return;const i=t.get("N");if(!(i instanceof fe))return;const s=this._decodeFormValue(e.dict.get("AS"));typeof s=="string"&&(this.data.fieldValue=s);const r=this.data.fieldValue!==null&&this.data.fieldValue!=="Off"?this.data.fieldValue:"Yes",a=this._decodeFormValue(i.getKeys());if(a.length===0)a.push("Off",r);else if(a.length===1)a[0]==="Off"?a.push(r):a.unshift("Off");else if(a.includes(r))a.length=0,a.push("Off",r);else{const c=a.find(h=>h!=="Off");a.length=0,a.push("Off",c)}a.includes(this.data.fieldValue)||(this.data.fieldValue="Off"),this.data.exportValue=a[1];const o=i.get(this.data.exportValue);this.checkedAppearance=o instanceof un?o:null;const l=i.get("Off");this.uncheckedAppearance=l instanceof un?l:null,this.checkedAppearance?this._streams.push(this.checkedAppearance):this._getDefaultCheckedAppearance(e,"check"),this.uncheckedAppearance&&this._streams.push(this.uncheckedAppearance),this._fallbackFontDict=this.fallbackFontDict,this.data.defaultFieldValue===null&&(this.data.defaultFieldValue="Off")}_processRadioButton(e){this.data.buttonValue=null;const t=e.dict.get("Parent");if(t instanceof fe){this.parent=e.dict.getRaw("Parent");const o=t.get("V");o instanceof ve&&(this.data.fieldValue=this._decodeFormValue(o))}const i=e.dict.get("AP");if(!(i instanceof fe))return;const s=i.get("N");if(!(s instanceof fe))return;for(const o of s.getKeys())if(o!=="Off"){this.data.buttonValue=this._decodeFormValue(o);break}const r=s.get(this.data.buttonValue);this.checkedAppearance=r instanceof un?r:null;const a=s.get("Off");this.uncheckedAppearance=a instanceof un?a:null,this.checkedAppearance?this._streams.push(this.checkedAppearance):this._getDefaultCheckedAppearance(e,"disc"),this.uncheckedAppearance&&this._streams.push(this.uncheckedAppearance),this._fallbackFontDict=this.fallbackFontDict,this.data.defaultFieldValue===null&&(this.data.defaultFieldValue="Off")}_processPushButton(e){const{dict:t,annotationGlobals:i}=e;if(!t.has("A")&&!t.has("AA")&&!this.data.alternativeText){ce("Push buttons without action dictionaries are not supported");return}this.data.isTooltipOnly=!t.has("A")&&!t.has("AA"),Xp.parseDestDictionary({destDict:t,resultObj:this.data,docBaseUrl:i.baseUrl,docAttachments:i.attachments})}getFieldObject(){let e="button",t;return this.data.checkBox?(e="checkbox",t=this.data.exportValue):this.data.radioButton&&(e="radiobutton",t=this.data.buttonValue),{id:this.data.id,value:this.data.fieldValue||"Off",defaultValue:this.data.defaultFieldValue,exportValues:t,editable:!this.data.readOnly,name:this.data.fieldName,rect:this.data.rect,hidden:this.data.hidden,actions:this.data.actions,page:this.data.pageIndex,strokeColor:this.data.borderColor,fillColor:this.data.backgroundColor,rotation:this.rotation,type:e}}get fallbackFontDict(){const e=new fe;return e.set("BaseFont",ve.get("ZapfDingbats")),e.set("Type",ve.get("FallbackType")),e.set("Subtype",ve.get("FallbackType")),e.set("Encoding",ve.get("ZapfDingbatsEncoding")),Ze(this,"fallbackFontDict",e)}}class PY extends il{constructor(e){var r;super(e);const{dict:t,xref:i}=e;this.indices=t.getArray("I"),this.hasIndices=Array.isArray(this.indices)&&this.indices.length>0,this.data.options=[];const s=fo({dict:t,key:"Opt"});if(Array.isArray(s))for(let a=0,o=s.length;a<o;a++){const l=i.fetchIfRef(s[a]),c=Array.isArray(l);this.data.options[a]={exportValue:this._decodeFormValue(c?i.fetchIfRef(l[0]):l),displayValue:this._decodeFormValue(c?i.fetchIfRef(l[1]):l)}}if(!this.hasIndices)typeof this.data.fieldValue=="string"?this.data.fieldValue=[this.data.fieldValue]:(r=this.data).fieldValue||(r.fieldValue=[]);else{this.data.fieldValue=[];const a=this.data.options.length;for(const o of this.indices)Number.isInteger(o)&&o>=0&&o<a&&this.data.fieldValue.push(this.data.options[o].exportValue)}this.data.options.length===0&&this.data.fieldValue.length>0&&(this.data.options=this.data.fieldValue.map(a=>({exportValue:a,displayValue:a}))),this.data.combo=this.hasFieldFlag(Jo.COMBO),this.data.multiSelect=this.hasFieldFlag(Jo.MULTISELECT),this._hasText=!0}getFieldObject(){const e=this.data.combo?"combobox":"listbox",t=this.data.fieldValue.length>0?this.data.fieldValue[0]:null;return{id:this.data.id,value:t,defaultValue:this.data.defaultFieldValue,editable:!this.data.readOnly,name:this.data.fieldName,rect:this.data.rect,numItems:this.data.fieldValue.length,multipleSelection:this.data.multiSelect,hidden:this.data.hidden,actions:this.data.actions,items:this.data.options,page:this.data.pageIndex,strokeColor:this.data.borderColor,fillColor:this.data.backgroundColor,rotation:this.rotation,type:e}}amendSavedDict(e,t){var a;if(!this.hasIndices)return;let i=(a=e==null?void 0:e.get(this.data.id))==null?void 0:a.value;Array.isArray(i)||(i=[i]);const s=[],{options:r}=this.data;for(let o=0,l=0,c=r.length;o<c;o++)r[o].exportValue===i[l]&&(s.push(o),l+=1);t.set("I",s)}async _getAppearance(e,t,i,s){if(this.data.combo)return super._getAppearance(e,t,i,s);let r,a;const o=s==null?void 0:s.get(this.data.id);if(o&&(a=o.rotation,r=o.value),a===void 0&&r===void 0&&!this._needAppearances)return null;r===void 0?r=this.data.fieldValue:Array.isArray(r)||(r=[r]);const l=1,c=2;let{width:h,height:u}=this;(a===90||a===270)&&([h,u]=[u,h]);const d=this.data.options.length,f=[];for(let I=0;I<d;I++){const{exportValue:S}=this.data.options[I];r.includes(S)&&f.push(I)}this._defaultAppearance||(this.data.defaultAppearanceData=D4(this._defaultAppearance="/Helvetica 0 Tf 0 g"));const g=await il._getFontData(e,t,this.data.defaultAppearanceData,this._fieldResources.mergedResources);let m,{fontSize:x}=this.data.defaultAppearanceData;if(x)m=this._defaultAppearance;else{const I=(u-l)/d;let S=-1,M;for(const{displayValue:N}of this.data.options){const F=this._getTextWidth(N,g);F>S&&(S=F,M=N)}[m,x]=this._computeFontSize(I,h-2*c,M,g,-1)}const p=x*a0,y=(p-x)/2,w=Math.floor(u/p);let _=0;if(f.length>0){const I=Math.min(...f),S=Math.max(...f);_=Math.max(0,S-w+1),_>I&&(_=I)}const v=Math.min(_+w+1,d),C=["/Tx BMC q",`1 1 ${h} ${u} re W n`];if(f.length){C.push("0.600006 0.756866 0.854904 rg");for(const I of f)_<=I&&I<v&&C.push(`1 ${u-(I-_+1)*p} ${h} ${p} re f`)}C.push("BT",m,`1 0 0 1 0 ${u} Tm`);const k={shift:0};for(let I=_;I<v;I++){const{displayValue:S}=this.data.options[I],M=I===_?y:0;C.push(this._renderText(S,g,x,h,0,k,c,-p+M))}return C.push("ET Q EMC"),C.join(`
`)}}class QM extends il{constructor(e){super(e),this.data.fieldValue=null,this.data.hasOwnCanvas=this.data.noRotate,this.data.noHTML=!this.data.hasOwnCanvas}getFieldObject(){return{id:this.data.id,value:null,page:this.data.pageIndex,type:"signature"}}}class NY extends ma{constructor(e){super(e),this.data.noRotate=!0,this.data.hasOwnCanvas=this.data.noRotate,this.data.noHTML=!1;const{dict:i}=e;this.data.annotationType=Ks.TEXT,this.data.hasAppearance?this.data.name="NoIcon":(this.data.rect[1]=this.data.rect[3]-22,this.data.rect[2]=this.data.rect[0]+22,this.data.name=i.has("Name")?i.get("Name").name:"Note"),i.has("State")?(this.data.state=i.get("State")||null,this.data.stateModel=i.get("StateModel")||null):(this.data.state=null,this.data.stateModel=null)}}class OY extends yx{constructor(e){var r;super(e);const{dict:t,annotationGlobals:i}=e;this.data.annotationType=Ks.LINK,this.data.noHTML=!1;const s=xx(t,this.rectangle);s&&(this.data.quadPoints=s),(r=this.data).borderColor||(r.borderColor=this.data.color),Xp.parseDestDictionary({destDict:t,resultObj:this.data,docBaseUrl:i.baseUrl,docAttachments:i.attachments})}}class $M extends yx{constructor(e){super(e);const{dict:t}=e;this.data.annotationType=Ks.POPUP,this.data.noHTML=!1,(this.width===0||this.height===0)&&(this.data.rect=null);let i=t.get("Parent");if(!i){ce("Popup annotation has a missing or invalid parent annotation.");return}this.data.parentRect=y0(i.getArray("Rect"),null);const s=i.get("RT");if(Di(s,_7.GROUP)&&(i=i.get("IRT")),i.has("M")?(this.setModificationDate(i.get("M")),this.data.modificationDate=this.modificationDate):this.data.modificationDate=null,i.has("C")?(this.setColor(i.getArray("C")),this.data.color=this.color):this.data.color=null,!this.viewable){const r=i.get("F");this._isViewable(r)&&this.setFlags(r)}this.setTitle(i.get("T")),this.data.titleObj=this._title,this.setContents(i.get("Contents")),this.data.contentsObj=this._contents,i.has("RC")&&(this.data.richText=bx.getRichTextAsHtml(i.get("RC"))),this.data.open=!!t.get("Open")}}class Lw extends ma{constructor(e){var r;super(e),this.data.hasOwnCanvas=this.data.noRotate,this.data.isEditable=!this.data.noHTML,this.data.noHTML=!1;const{annotationGlobals:t,evaluatorOptions:i,xref:s}=e;if(this.data.annotationType=Ks.FREETEXT,this.setDefaultAppearance(e),this._hasAppearance=!!this.appearance,this._hasAppearance){const{fontColor:a,fontSize:o}=IG(this.appearance,i,s,t.globalColorSpaceCache);this.data.defaultAppearanceData.fontColor=a,this.data.defaultAppearanceData.fontSize=o||10}else{(r=this.data.defaultAppearanceData).fontSize||(r.fontSize=10);const{fontColor:a,fontSize:o}=this.data.defaultAppearanceData;if(this._contents.str){this.data.textContent=this._contents.str.split(/\r\n?|\n/).map(u=>u.trimEnd());const{coords:l,bbox:c,matrix:h}=Vl.getFirstPositionInfo(this.rectangle,this.rotation,o);this.data.textPosition=this._transformPoint(l,c,h)}if(this._isOffscreenCanvasSupported){const l=e.dict.get("CA"),c=new Vl(s,"sans-serif");this.appearance=c.createAppearance(this._contents.str,this.rectangle,this.rotation,o,a,l),this._streams.push(this.appearance)}else ce("FreeTextAnnotation: OffscreenCanvas is not supported, annotation may not render correctly.")}}get hasTextContent(){return this._hasAppearance}static createNewDict(e,t,{apRef:i,ap:s}){const{color:r,fontSize:a,oldAnnotation:o,rect:l,rotation:c,user:h,value:u}=e,d=o||new fe(t);d.set("Type",ve.get("Annot")),d.set("Subtype",ve.get("FreeText")),o?(d.set("M",`D:${x0()}`),d.delete("RC")):d.set("CreationDate",`D:${x0()}`),d.set("Rect",l);const f=`/Helv ${a} Tf ${sc(r,!0)}`;if(d.set("DA",f),d.set("Contents",go(u)),d.set("F",4),d.set("Border",[0,0,0]),d.set("Rotate",c),h&&d.set("T",go(h)),i||s){const g=new fe(t);d.set("AP",g),i?g.set("N",i):g.set("N",s)}return d}static async createNewAppearanceStream(e,t,i){const{baseFontRef:s,evaluator:r,task:a}=i,{color:o,fontSize:l,rect:c,rotation:h,value:u}=e,d=new fe(t),f=new fe(t);if(s)f.set("Helv",s);else{const he=new fe(t);he.set("BaseFont",ve.get("Helvetica")),he.set("Type",ve.get("Font")),he.set("Subtype",ve.get("Type1")),he.set("Encoding",ve.get("WinAnsiEncoding")),f.set("Helv",he)}d.set("Font",f);const g=await il._getFontData(r,a,{fontName:"Helv",fontSize:l},d),[m,x,p,y]=c;let w=p-m,_=y-x;h%180!==0&&([w,_]=[_,w]);const v=u.split(`
`),C=l/1e3;let k=-1/0;const I=[];for(let he of v){const we=g.encodeString(he);if(we.length>1)return null;he=we.join(""),I.push(he);let ye=0;const P=g.charsToGlyphs(he);for(const V of P)ye+=V.width*C;k=Math.max(k,ye)}let S=1;k>w&&(S=w/k);let M=1;const N=a0*l,F=(a0-A3)*l,H=N*v.length;H>_&&(M=_/H);const T=Math.min(S,M),z=l*T;let R,L,Y;switch(h){case 0:Y=[1,0,0,1],L=[c[0],c[1],w,_],R=[c[0],c[3]-F];break;case 90:Y=[0,1,-1,0],L=[c[1],-c[2],w,_],R=[c[1],-c[0]-F];break;case 180:Y=[-1,0,0,-1],L=[-c[2],-c[3],w,_],R=[-c[2],-c[1]-F];break;case 270:Y=[0,-1,1,0],L=[-c[3],c[0],w,_],R=[-c[3],c[2]-F];break}const j=["q",`${Y.join(" ")} 0 0 cm`,`${L.join(" ")} re W n`,"BT",`${sc(o,!0)}`,`0 Tc /Helv ${vn(z)} Tf`];j.push(`${R.join(" ")} Td (${Ig(I[0])}) Tj`);const J=vn(N);for(let he=1,we=I.length;he<we;he++){const ye=I[he];j.push(`0 -${J} Td (${Ig(ye)}) Tj`)}j.push("ET","Q");const G=j.join(`
`),se=new fe(t);se.set("FormType",1),se.set("Subtype",ve.get("Form")),se.set("Type",ve.get("XObject")),se.set("BBox",c),se.set("Resources",d),se.set("Matrix",[1,0,0,1,-c[0],-c[1]]);const de=new Jr(G);return de.dict=se,de}}class DY extends ma{constructor(e){super(e);const{dict:t,xref:i}=e;this.data.annotationType=Ks.LINE,this.data.hasOwnCanvas=this.data.noRotate,this.data.noHTML=!1;const s=T7(t.getArray("L"),[0,0,0,0]);if(this.data.lineCoordinates=Dn.normalizeRect(s),this.setLineEndings(t.getArray("LE")),this.data.lineEndings=this.lineEndings,!this.appearance){const r=this.color?Er(this.color):[0,0,0],a=t.get("CA"),o=a1(t.getArray("IC"),null),l=o?Er(o):null,c=l?a:null,h=this.borderStyle.width||1,u=2*h,d=[this.data.lineCoordinates[0]-u,this.data.lineCoordinates[1]-u,this.data.lineCoordinates[2]+u,this.data.lineCoordinates[3]+u];Dn.intersect(this.rectangle,d)||(this.rectangle=d),this._setDefaultAppearance({xref:i,extra:`${h} w`,strokeColor:r,fillColor:l,strokeAlpha:a,fillAlpha:c,pointsCallback:(f,g)=>(f.push(`${s[0]} ${s[1]} m`,`${s[2]} ${s[3]} l`,"S"),[g[0]-h,g[7]-h,g[2]+h,g[3]+h])})}}}class FY extends ma{constructor(e){super(e);const{dict:t,xref:i}=e;if(this.data.annotationType=Ks.SQUARE,this.data.hasOwnCanvas=this.data.noRotate,this.data.noHTML=!1,!this.appearance){const s=this.color?Er(this.color):[0,0,0],r=t.get("CA"),a=a1(t.getArray("IC"),null),o=a?Er(a):null,l=o?r:null;if(this.borderStyle.width===0&&!o)return;this._setDefaultAppearance({xref:i,extra:`${this.borderStyle.width} w`,strokeColor:s,fillColor:o,strokeAlpha:r,fillAlpha:l,pointsCallback:(c,h)=>{const u=h[4]+this.borderStyle.width/2,d=h[5]+this.borderStyle.width/2,f=h[6]-h[4]-this.borderStyle.width,g=h[3]-h[7]-this.borderStyle.width;return c.push(`${u} ${d} ${f} ${g} re`),o?c.push("B"):c.push("S"),[h[0],h[7],h[2],h[3]]}})}}}class LY extends ma{constructor(e){super(e);const{dict:t,xref:i}=e;if(this.data.annotationType=Ks.CIRCLE,!this.appearance){const s=this.color?Er(this.color):[0,0,0],r=t.get("CA"),a=a1(t.getArray("IC"),null),o=a?Er(a):null,l=o?r:null;if(this.borderStyle.width===0&&!o)return;const c=4/3*Math.tan(Math.PI/(2*4));this._setDefaultAppearance({xref:i,extra:`${this.borderStyle.width} w`,strokeColor:s,fillColor:o,strokeAlpha:r,fillAlpha:l,pointsCallback:(h,u)=>{const d=u[0]+this.borderStyle.width/2,f=u[1]-this.borderStyle.width/2,g=u[6]-this.borderStyle.width/2,m=u[7]+this.borderStyle.width/2,x=d+(g-d)/2,p=f+(m-f)/2,y=(g-d)/2*c,w=(m-f)/2*c;return h.push(`${x} ${m} m`,`${x+y} ${m} ${g} ${p+w} ${g} ${p} c`,`${g} ${p-w} ${x+y} ${f} ${x} ${f} c`,`${x-y} ${f} ${d} ${p-w} ${d} ${p} c`,`${d} ${p+w} ${x-y} ${m} ${x} ${m} c`,"h"),o?h.push("B"):h.push("S"),[u[0],u[7],u[2],u[3]]}})}}}class eP extends ma{constructor(e){super(e);const{dict:t,xref:i}=e;this.data.annotationType=Ks.POLYLINE,this.data.hasOwnCanvas=this.data.noRotate,this.data.noHTML=!1,this.data.vertices=null,this instanceof tP||(this.setLineEndings(t.getArray("LE")),this.data.lineEndings=this.lineEndings);const s=t.getArray("Vertices");if(!Vr(s,null))return;const r=this.data.vertices=Float32Array.from(s);if(!this.appearance){const a=this.color?Er(this.color):[0,0,0],o=t.get("CA"),l=this.borderStyle.width||1,c=2*l,h=[1/0,1/0,-1/0,-1/0];for(let u=0,d=r.length;u<d;u+=2)Dn.rectBoundingBox(r[u]-c,r[u+1]-c,r[u]+c,r[u+1]+c,h);Dn.intersect(this.rectangle,h)||(this.rectangle=h),this._setDefaultAppearance({xref:i,extra:`${l} w`,strokeColor:a,strokeAlpha:o,pointsCallback:(u,d)=>{for(let f=0,g=r.length;f<g;f+=2)u.push(`${r[f]} ${r[f+1]} ${f===0?"m":"l"}`);return u.push("S"),[d[0],d[7],d[2],d[3]]}})}}}class tP extends eP{constructor(e){super(e),this.data.annotationType=Ks.POLYGON}}class BY extends ma{constructor(e){super(e),this.data.annotationType=Ks.CARET}}class Hm extends ma{constructor(e){super(e),this.data.hasOwnCanvas=this.data.noRotate,this.data.noHTML=!1;const{dict:t,xref:i}=e;this.data.annotationType=Ks.INK,this.data.inkLists=[],this.data.isEditable=!this.data.noHTML,this.data.noHTML=!1,this.data.opacity=t.get("CA")||1;const s=t.getArray("InkList");if(Array.isArray(s)){for(let r=0,a=s.length;r<a;++r){if(!Array.isArray(s[r]))continue;const o=new Float32Array(s[r].length);this.data.inkLists.push(o);for(let l=0,c=s[r].length;l<c;l+=2){const h=i.fetchIfRef(s[r][l]),u=i.fetchIfRef(s[r][l+1]);typeof h=="number"&&typeof u=="number"&&(o[l]=h,o[l+1]=u)}}if(!this.appearance){const r=this.color?Er(this.color):[0,0,0],a=t.get("CA"),o=this.borderStyle.width||1,l=2*o,c=[1/0,1/0,-1/0,-1/0];for(const h of this.data.inkLists)for(let u=0,d=h.length;u<d;u+=2)Dn.rectBoundingBox(h[u]-l,h[u+1]-l,h[u]+l,h[u+1]+l,c);Dn.intersect(this.rectangle,c)||(this.rectangle=c),this._setDefaultAppearance({xref:i,extra:`${o} w`,strokeColor:r,strokeAlpha:a,pointsCallback:(h,u)=>{for(const d of this.data.inkLists){for(let f=0,g=d.length;f<g;f+=2)h.push(`${d[f]} ${d[f+1]} ${f===0?"m":"l"}`);h.push("S")}return[u[0],u[7],u[2],u[3]]}})}}}static createNewDict(e,t,{apRef:i,ap:s}){const{oldAnnotation:r,color:a,opacity:o,paths:l,outlines:c,rect:h,rotation:u,thickness:d,user:f}=e,g=r||new fe(t);g.set("Type",ve.get("Annot")),g.set("Subtype",ve.get("Ink")),g.set(r?"M":"CreationDate",`D:${x0()}`),g.set("Rect",h),g.set("InkList",(c==null?void 0:c.points)||l.points),g.set("F",4),g.set("Rotate",u),f&&g.set("T",go(f)),c&&g.set("IT",ve.get("InkHighlight"));const m=new fe(t);g.set("BS",m),m.set("W",d),g.set("C",Er(a)),g.set("CA",o);const x=new fe(t);return g.set("AP",x),i?x.set("N",i):x.set("N",s),g}static async createNewAppearanceStream(e,t,i){if(e.outlines)return this.createNewAppearanceStreamForHighlight(e,t,i);const{color:s,rect:r,paths:a,thickness:o,opacity:l}=e,c=[`${o} w 1 J 1 j`,`${sc(s,!1)}`];l!==1&&c.push("/R0 gs");for(const f of a.lines){c.push(`${vn(f[4])} ${vn(f[5])} m`);for(let g=6,m=f.length;g<m;g+=6)if(isNaN(f[g]))c.push(`${vn(f[g+4])} ${vn(f[g+5])} l`);else{const[x,p,y,w,_,v]=f.slice(g,g+6);c.push([x,p,y,w,_,v].map(vn).join(" ")+" c")}f.length===6&&c.push(`${vn(f[4])} ${vn(f[5])} l`)}c.push("S");const h=c.join(`
`),u=new fe(t);if(u.set("FormType",1),u.set("Subtype",ve.get("Form")),u.set("Type",ve.get("XObject")),u.set("BBox",r),u.set("Length",h.length),l!==1){const f=new fe(t),g=new fe(t),m=new fe(t);m.set("CA",l),m.set("Type",ve.get("ExtGState")),g.set("R0",m),f.set("ExtGState",g),u.set("Resources",f)}const d=new Jr(h);return d.dict=u,d}static async createNewAppearanceStreamForHighlight(e,t,i){const{color:s,rect:r,outlines:{outline:a},opacity:o}=e,l=[`${sc(s,!0)}`,"/R0 gs"];l.push(`${vn(a[4])} ${vn(a[5])} m`);for(let m=6,x=a.length;m<x;m+=6)if(isNaN(a[m]))l.push(`${vn(a[m+4])} ${vn(a[m+5])} l`);else{const[p,y,w,_,v,C]=a.slice(m,m+6);l.push([p,y,w,_,v,C].map(vn).join(" ")+" c")}l.push("h f");const c=l.join(`
`),h=new fe(t);h.set("FormType",1),h.set("Subtype",ve.get("Form")),h.set("Type",ve.get("XObject")),h.set("BBox",r),h.set("Length",c.length);const u=new fe(t),d=new fe(t);u.set("ExtGState",d),h.set("Resources",u);const f=new fe(t);d.set("R0",f),f.set("BM",ve.get("Multiply")),o!==1&&(f.set("ca",o),f.set("Type",ve.get("ExtGState")));const g=new Jr(c);return g.dict=h,g}}class Bw extends ma{constructor(e){var r;super(e);const{dict:t,xref:i}=e;if(this.data.annotationType=Ks.HIGHLIGHT,this.data.isEditable=!this.data.noHTML,this.data.noHTML=!1,this.data.opacity=t.get("CA")||1,this.data.quadPoints=xx(t,null)){const a=(r=this.appearance)==null?void 0:r.dict.get("Resources");if(!this.appearance||!(a!=null&&a.has("ExtGState"))){this.appearance&&ce("HighlightAnnotation - ignoring built-in appearance stream.");const o=this.color?Er(this.color):[1,1,0],l=t.get("CA");this._setDefaultAppearance({xref:i,fillColor:o,blendMode:"Multiply",fillAlpha:l,pointsCallback:(c,h)=>(c.push(`${h[0]} ${h[1]} m`,`${h[2]} ${h[3]} l`,`${h[6]} ${h[7]} l`,`${h[4]} ${h[5]} l`,"f"),[h[0],h[7],h[2],h[3]])})}}else this.data.popupRef=null}get overlaysTextContent(){return!0}static createNewDict(e,t,{apRef:i,ap:s}){const{color:r,oldAnnotation:a,opacity:o,rect:l,rotation:c,user:h,quadPoints:u}=e,d=a||new fe(t);if(d.set("Type",ve.get("Annot")),d.set("Subtype",ve.get("Highlight")),d.set(a?"M":"CreationDate",`D:${x0()}`),d.set("CreationDate",`D:${x0()}`),d.set("Rect",l),d.set("F",4),d.set("Border",[0,0,0]),d.set("Rotate",c),d.set("QuadPoints",u),d.set("C",Er(r)),d.set("CA",o),h&&d.set("T",go(h)),i||s){const f=new fe(t);d.set("AP",f),f.set("N",i||s)}return d}static async createNewAppearanceStream(e,t,i){const{color:s,rect:r,outlines:a,opacity:o}=e,l=[`${sc(s,!0)}`,"/R0 gs"],c=[];for(const x of a){c.length=0,c.push(`${vn(x[0])} ${vn(x[1])} m`);for(let p=2,y=x.length;p<y;p+=2)c.push(`${vn(x[p])} ${vn(x[p+1])} l`);c.push("h"),l.push(c.join(`
`))}l.push("f*");const h=l.join(`
`),u=new fe(t);u.set("FormType",1),u.set("Subtype",ve.get("Form")),u.set("Type",ve.get("XObject")),u.set("BBox",r),u.set("Length",h.length);const d=new fe(t),f=new fe(t);d.set("ExtGState",f),u.set("Resources",d);const g=new fe(t);f.set("R0",g),g.set("BM",ve.get("Multiply")),o!==1&&(g.set("ca",o),g.set("Type",ve.get("ExtGState")));const m=new Jr(h);return m.dict=u,m}}class UY extends ma{constructor(e){super(e);const{dict:t,xref:i}=e;if(this.data.annotationType=Ks.UNDERLINE,this.data.quadPoints=xx(t,null)){if(!this.appearance){const r=this.color?Er(this.color):[0,0,0],a=t.get("CA");this._setDefaultAppearance({xref:i,extra:"[] 0 d 0.571 w",strokeColor:r,strokeAlpha:a,pointsCallback:(o,l)=>(o.push(`${l[4]} ${l[5]+1.3} m`,`${l[6]} ${l[7]+1.3} l`,"S"),[l[0],l[7],l[2],l[3]])})}}else this.data.popupRef=null}get overlaysTextContent(){return!0}}class HY extends ma{constructor(e){super(e);const{dict:t,xref:i}=e;if(this.data.annotationType=Ks.SQUIGGLY,this.data.quadPoints=xx(t,null)){if(!this.appearance){const r=this.color?Er(this.color):[0,0,0],a=t.get("CA");this._setDefaultAppearance({xref:i,extra:"[] 0 d 1 w",strokeColor:r,strokeAlpha:a,pointsCallback:(o,l)=>{const c=(l[1]-l[5])/6;let h=c,u=l[4];const d=l[5],f=l[6];o.push(`${u} ${d+h} m`);do u+=2,h=h===0?c:0,o.push(`${u} ${d+h} l`);while(u<f);return o.push("S"),[l[4],d-2*c,f,d+2*c]}})}}else this.data.popupRef=null}get overlaysTextContent(){return!0}}class zY extends ma{constructor(e){super(e);const{dict:t,xref:i}=e;if(this.data.annotationType=Ks.STRIKEOUT,this.data.quadPoints=xx(t,null)){if(!this.appearance){const r=this.color?Er(this.color):[0,0,0],a=t.get("CA");this._setDefaultAppearance({xref:i,extra:"[] 0 d 1 w",strokeColor:r,strokeAlpha:a,pointsCallback:(o,l)=>(o.push(`${(l[0]+l[4])/2} ${(l[1]+l[5])/2} m`,`${(l[2]+l[6])/2} ${(l[3]+l[7])/2} l`,"S"),[l[0],l[7],l[2],l[3]])})}}else this.data.popupRef=null}get overlaysTextContent(){return!0}}var Nd,j5,nP;class cu extends ma{constructor(t){super(t);B(this,Nd,null);this.data.annotationType=Ks.STAMP,this.data.hasOwnCanvas=this.data.noRotate,this.data.isEditable=!this.data.noHTML,this.data.noHTML=!1}mustBeViewedWhenEditing(t,i=null){return t?(this.data.isEditable&&(b(this,Nd)??O(this,Nd,this.data.hasOwnCanvas),this.data.hasOwnCanvas=!0),!0):(b(this,Nd)!==null&&(this.data.hasOwnCanvas=b(this,Nd),O(this,Nd,null)),!(i!=null&&i.has(this.data.id)))}static async createImage(t,i){const{width:s,height:r}=t,a=new OffscreenCanvas(s,r),o=a.getContext("2d",{alpha:!0});o.drawImage(t,0,0);const l=o.getImageData(0,0,s,r).data,c=new Uint32Array(l.buffer),h=c.some(fa.isLittleEndian?p=>p>>>24!==255:p=>(p&255)!==255);h&&(o.fillStyle="white",o.fillRect(0,0,s,r),o.drawImage(t,0,0));const u=a.convertToBlob({type:"image/jpeg",quality:1}).then(p=>p.arrayBuffer()),d=ve.get("XObject"),f=ve.get("Image"),g=new fe(i);g.set("Type",d),g.set("Subtype",f),g.set("BitsPerComponent",8),g.set("ColorSpace",ve.get("DeviceRGB")),g.set("Filter",ve.get("DCTDecode")),g.set("BBox",[0,0,s,r]),g.set("Width",s),g.set("Height",r);let m=null;if(h){const p=new Uint8Array(c.length);if(fa.isLittleEndian)for(let w=0,_=c.length;w<_;w++)p[w]=c[w]>>>24;else for(let w=0,_=c.length;w<_;w++)p[w]=c[w]&255;const y=new fe(i);y.set("Type",d),y.set("Subtype",f),y.set("BitsPerComponent",8),y.set("ColorSpace",ve.get("DeviceGray")),y.set("Width",s),y.set("Height",r),m=new Hi(p,0,0,y)}return{imageStream:new Hi(await u,0,0,g),smaskStream:m,width:s,height:r}}static createNewDict(t,i,{apRef:s,ap:r}){const{oldAnnotation:a,rect:o,rotation:l,user:c}=t,h=a||new fe(i);if(h.set("Type",ve.get("Annot")),h.set("Subtype",ve.get("Stamp")),h.set(a?"M":"CreationDate",`D:${x0()}`),h.set("Rect",o),h.set("F",4),h.set("Border",[0,0,0]),h.set("Rotate",l),c&&h.set("T",go(c)),s||r){const u=new fe(i);h.set("AP",u),s?u.set("N",s):u.set("N",r)}return h}static async createNewAppearanceStream(t,i,s){if(t.oldAnnotation)return null;if(t.isSignature)return D(this,j5,nP).call(this,t,i);const{rotation:r}=t,{imageRef:a,width:o,height:l}=s.image,c=new fe(i),h=new fe(i);c.set("XObject",h),h.set("Im0",a);const u=`q ${o} 0 0 ${l} 0 0 cm /Im0 Do Q`,d=new fe(i);if(d.set("FormType",1),d.set("Subtype",ve.get("Form")),d.set("Type",ve.get("XObject")),d.set("BBox",[0,0,o,l]),d.set("Resources",c),r){const g=T3(r,o,l);d.set("Matrix",g)}const f=new Jr(u);return f.dict=d,f}}Nd=new WeakMap,j5=new WeakSet,nP=async function(t,i){const{areContours:s,color:r,rect:a,lines:o,thickness:l}=t,c=[`${l} w 1 J 1 j`,`${sc(r,s)}`];for(const f of o){c.push(`${vn(f[4])} ${vn(f[5])} m`);for(let g=6,m=f.length;g<m;g+=6)if(isNaN(f[g]))c.push(`${vn(f[g+4])} ${vn(f[g+5])} l`);else{const[x,p,y,w,_,v]=f.slice(g,g+6);c.push([x,p,y,w,_,v].map(vn).join(" ")+" c")}f.length===6&&c.push(`${vn(f[4])} ${vn(f[5])} l`)}c.push(s?"F":"S");const h=c.join(`
`),u=new fe(i);u.set("FormType",1),u.set("Subtype",ve.get("Form")),u.set("Type",ve.get("XObject")),u.set("BBox",a),u.set("Length",h.length);const d=new Jr(h);return d.dict=u,d},B(cu,j5);class jY extends ma{constructor(e){super(e);const{dict:t,xref:i}=e,s=new n6(t.get("FS"),i);this.data.annotationType=Ks.FILEATTACHMENT,this.data.hasOwnCanvas=this.data.noRotate,this.data.noHTML=!1,this.data.file=s.serializable;const r=t.get("Name");this.data.name=r instanceof ve?Tn(r.name):"PushPin";const a=t.get("ca");this.data.fillAlpha=typeof a=="number"&&a>=0&&a<=1?a:null}}const GY={get r(){return Ze(this,"r",new Uint8Array([7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21]))},get k(){return Ze(this,"k",new Int32Array([-680876936,-389564586,606105819,-1044525330,-176418897,1200080426,-1473231341,-45705983,1770035416,-1958414417,-42063,-1990404162,1804603682,-40341101,-1502002290,1236535329,-165796510,-1069501632,643717713,-373897302,-701558691,38016083,-660478335,-405537848,568446438,-1019803690,-187363961,1163531501,-1444681467,-51403784,1735328473,-1926607734,-378558,-2022574463,1839030562,-35309556,-1530992060,1272893353,-155497632,-1094730640,681279174,-358537222,-722521979,76029189,-640364487,-421815835,530742520,-995338651,-198630844,1126891415,-1416354905,-57434055,1700485571,-1894986606,-1051523,-2054922799,1873313359,-30611744,-1560198380,1309151649,-145523070,-1120210379,718787259,-343485551]))}};function P0(n,e,t){let i=1732584193,s=-271733879,r=-1732584194,a=271733878;const o=t+72&-64,l=new Uint8Array(o);let c,h;for(c=0;c<t;++c)l[c]=n[e++];l[c++]=128;const u=o-8;c<u&&(c=u),l[c++]=t<<3&255,l[c++]=t>>5&255,l[c++]=t>>13&255,l[c++]=t>>21&255,l[c++]=t>>>29&255,c+=3;const d=new Int32Array(16),{k:f,r:g}=GY;for(c=0;c<o;){for(h=0;h<16;++h,c+=4)d[h]=l[c]|l[c+1]<<8|l[c+2]<<16|l[c+3]<<24;let m=i,x=s,p=r,y=a,w,_;for(h=0;h<64;++h){h<16?(w=x&p|~x&y,_=h):h<32?(w=y&x|~y&p,_=5*h+1&15):h<48?(w=x^p^y,_=3*h+5&15):(w=p^(x|~y),_=7*h&15);const v=y,C=m+w+f[h]+d[_]|0,k=g[h];y=p,p=x,x=x+(C<<k|C>>>32-k)|0,m=v}i=i+m|0,s=s+x|0,r=r+p|0,a=a+y|0}return new Uint8Array([i&255,i>>8&255,i>>16&255,i>>>24&255,s&255,s>>8&255,s>>16&255,s>>>24&255,r&255,r>>8&255,r>>16&255,r>>>24&255,a&255,a>>8&255,a>>16&255,a>>>24&255])}function fC(n){try{return Lp(n)}catch(e){return ce(`UTF-8 decoding failed: "${e}".`),n}}class VY extends sy{constructor(e){super(e),this.node=null}onEndElement(e){const t=super.onEndElement(e);if(t&&e==="xfa:datasets")throw this.node=t,new Error("Aborting DatasetXMLParser.")}}class qY{constructor(e){if(e.datasets)this.node=new sy({hasAttributes:!0}).parseFromString(e.datasets).documentElement;else{const t=new VY({hasAttributes:!0});try{t.parseFromString(e["xdp:xdp"])}catch{}this.node=t.node}}getValue(e){if(!this.node||!e)return"";const t=this.node.searchNode(lR(e),0);if(!t)return"";const i=t.firstChild;return(i==null?void 0:i.nodeName)==="value"?t.children.map(s=>fC(s.textContent)):fC(t.textContent)}}var Qb,vh,kh,Ch,Ah,$b,kg,Sh,Od,Dd,G5,iP;class WY{constructor(e){B(this,G5);B(this,Qb);B(this,vh,1/0);B(this,kh,1/0);B(this,Ch,-1/0);B(this,Ah,-1/0);B(this,$b);B(this,kg,[]);B(this,Sh,[]);B(this,Od,-1);B(this,Dd,!1);O(this,Qb,e);const t=O(this,$b,e.data.quadPoints);for(let i=0,s=t.length;i<s;i+=8)O(this,vh,Math.min(b(this,vh),t[i])),O(this,Ch,Math.max(b(this,Ch),t[i+2])),O(this,kh,Math.min(b(this,kh),t[i+5])),O(this,Ah,Math.max(b(this,Ah),t[i+1]))}overlaps(e){return!(b(this,vh)>=b(e,Ch)||b(this,Ch)<=b(e,vh)||b(this,kh)>=b(e,Ah)||b(this,Ah)<=b(e,kh))}addGlyph(e,t,i){return D(this,G5,iP).call(this,e,t)?(b(this,Sh).length>0&&(b(this,kg).push(b(this,Sh).join("")),b(this,Sh).length=0),b(this,kg).push(i),O(this,Dd,!0),!0):(this.disableExtraChars(),!1)}addExtraChar(e){b(this,Dd)&&b(this,Sh).push(e)}disableExtraChars(){b(this,Dd)&&(O(this,Dd,!1),b(this,Sh).length=0)}setText(){b(this,Qb).data.overlaidText=b(this,kg).join("")}}Qb=new WeakMap,vh=new WeakMap,kh=new WeakMap,Ch=new WeakMap,Ah=new WeakMap,$b=new WeakMap,kg=new WeakMap,Sh=new WeakMap,Od=new WeakMap,Dd=new WeakMap,G5=new WeakSet,iP=function(e,t){if(b(this,vh)>=e||b(this,Ch)<=e||b(this,kh)>=t||b(this,Ah)<=t)return!1;const i=b(this,$b);if(i.length===8)return!0;if(b(this,Od)>=0){const s=b(this,Od);if(!(i[s]>=e||i[s+2]<=e||i[s+5]>=t||i[s+1]<=t))return!0;O(this,Od,-1)}for(let s=0,r=i.length;s<r;s+=8)if(!(i[s]>=e||i[s+2]<=e||i[s+5]>=t||i[s+1]<=t))return O(this,Od,s),!0;return!1};var Qc;class KY{constructor(e){B(this,Qc,new Map);for(const t of e){if(!t.data.quadPoints)continue;const i=new WY(t);for(const[s,r]of b(this,Qc))s.overlaps(i)&&(r?r.add(i):b(this,Qc).set(s,new Set([i])));b(this,Qc).set(i,null)}}addGlyph(e,t,i,s){const r=e[4]+t/2,a=e[5]+i/2;let o;for(const[l,c]of b(this,Qc)){if(o){o.has(l)?l.addGlyph(r,a,s):l.disableExtraChars();continue}l.addGlyph(r,a,s)&&(o=c)}}addExtraChar(e){for(const t of b(this,Qc).keys())t.addExtraChar(e)}setText(){for(const e of b(this,Qc).keys())e.setText()}}Qc=new WeakMap;class nt{constructor(e,t){this.high=e|0,this.low=t|0}and(e){this.high&=e.high,this.low&=e.low}xor(e){this.high^=e.high,this.low^=e.low}shiftRight(e){e>=32?(this.low=this.high>>>e-32|0,this.high=0):(this.low=this.low>>>e|this.high<<32-e,this.high=this.high>>>e|0)}rotateRight(e){let t,i;e&32?(i=this.low,t=this.high):(t=this.low,i=this.high),e&=31,this.low=t>>>e|i<<32-e,this.high=i>>>e|t<<32-e}not(){this.high=~this.high,this.low=~this.low}add(e){const t=(this.low>>>0)+(e.low>>>0);let i=(this.high>>>0)+(e.high>>>0);t>4294967295&&(i+=1),this.low=t|0,this.high=i|0}copyTo(e,t){e[t]=this.high>>>24&255,e[t+1]=this.high>>16&255,e[t+2]=this.high>>8&255,e[t+3]=this.high&255,e[t+4]=this.low>>>24&255,e[t+5]=this.low>>16&255,e[t+6]=this.low>>8&255,e[t+7]=this.low&255}assign(e){this.high=e.high,this.low=e.low}}const XY={get k(){return Ze(this,"k",[new nt(1116352408,3609767458),new nt(1899447441,602891725),new nt(3049323471,3964484399),new nt(3921009573,2173295548),new nt(961987163,4081628472),new nt(1508970993,3053834265),new nt(2453635748,2937671579),new nt(2870763221,3664609560),new nt(3624381080,2734883394),new nt(310598401,1164996542),new nt(607225278,1323610764),new nt(1426881987,3590304994),new nt(1925078388,4068182383),new nt(2162078206,991336113),new nt(2614888103,633803317),new nt(3248222580,3479774868),new nt(3835390401,2666613458),new nt(4022224774,944711139),new nt(264347078,2341262773),new nt(604807628,2007800933),new nt(770255983,1495990901),new nt(1249150122,1856431235),new nt(1555081692,3175218132),new nt(1996064986,2198950837),new nt(2554220882,3999719339),new nt(2821834349,766784016),new nt(2952996808,2566594879),new nt(3210313671,3203337956),new nt(3336571891,1034457026),new nt(3584528711,2466948901),new nt(113926993,3758326383),new nt(338241895,168717936),new nt(666307205,1188179964),new nt(773529912,1546045734),new nt(1294757372,1522805485),new nt(1396182291,2643833823),new nt(1695183700,2343527390),new nt(1986661051,1014477480),new nt(2177026350,1206759142),new nt(2456956037,344077627),new nt(2730485921,1290863460),new nt(2820302411,3158454273),new nt(3259730800,3505952657),new nt(3345764771,106217008),new nt(3516065817,3606008344),new nt(3600352804,1432725776),new nt(4094571909,1467031594),new nt(275423344,851169720),new nt(430227734,3100823752),new nt(506948616,1363258195),new nt(659060556,3750685593),new nt(883997877,3785050280),new nt(958139571,3318307427),new nt(1322822218,3812723403),new nt(1537002063,2003034995),new nt(1747873779,3602036899),new nt(1955562222,1575990012),new nt(2024104815,1125592928),new nt(2227730452,2716904306),new nt(2361852424,442776044),new nt(2428436474,593698344),new nt(2756734187,3733110249),new nt(3204031479,2999351573),new nt(3329325298,3815920427),new nt(3391569614,3928383900),new nt(3515267271,566280711),new nt(3940187606,3454069534),new nt(4118630271,4000239992),new nt(116418474,1914138554),new nt(174292421,2731055270),new nt(289380356,3203993006),new nt(460393269,320620315),new nt(685471733,587496836),new nt(852142971,1086792851),new nt(1017036298,365543100),new nt(1126000580,2618297676),new nt(1288033470,3409855158),new nt(1501505948,4234509866),new nt(1607167915,987167468),new nt(1816402316,1246189591)])}};function YY(n,e,t,i,s){n.assign(e),n.and(t),s.assign(e),s.not(),s.and(i),n.xor(s)}function JY(n,e,t,i,s){n.assign(e),n.and(t),s.assign(e),s.and(i),n.xor(s),s.assign(t),s.and(i),n.xor(s)}function ZY(n,e,t){n.assign(e),n.rotateRight(28),t.assign(e),t.rotateRight(34),n.xor(t),t.assign(e),t.rotateRight(39),n.xor(t)}function QY(n,e,t){n.assign(e),n.rotateRight(14),t.assign(e),t.rotateRight(18),n.xor(t),t.assign(e),t.rotateRight(41),n.xor(t)}function $Y(n,e,t){n.assign(e),n.rotateRight(1),t.assign(e),t.rotateRight(8),n.xor(t),t.assign(e),t.shiftRight(7),n.xor(t)}function eJ(n,e,t){n.assign(e),n.rotateRight(19),t.assign(e),t.rotateRight(61),n.xor(t),t.assign(e),t.shiftRight(6),n.xor(t)}function sP(n,e,t,i=!1){let s,r,a,o,l,c,h,u;i?(s=new nt(3418070365,3238371032),r=new nt(1654270250,914150663),a=new nt(2438529370,812702999),o=new nt(355462360,4144912697),l=new nt(1731405415,4290775857),c=new nt(2394180231,1750603025),h=new nt(3675008525,1694076839),u=new nt(1203062813,3204075428)):(s=new nt(1779033703,4089235720),r=new nt(3144134277,2227873595),a=new nt(1013904242,4271175723),o=new nt(2773480762,1595750129),l=new nt(1359893119,2917565137),c=new nt(2600822924,725511199),h=new nt(528734635,4215389547),u=new nt(1541459225,327033209));const d=Math.ceil((t+17)/128)*128,f=new Uint8Array(d);let g,m;for(g=0;g<t;++g)f[g]=n[e++];f[g++]=128;const x=d-16;g<x&&(g=x),g+=11,f[g++]=t>>>29&255,f[g++]=t>>21&255,f[g++]=t>>13&255,f[g++]=t>>5&255,f[g++]=t<<3&255;const p=new Array(80);for(g=0;g<80;g++)p[g]=new nt(0,0);const{k:y}=XY;let w=new nt(0,0),_=new nt(0,0),v=new nt(0,0),C=new nt(0,0),k=new nt(0,0),I=new nt(0,0),S=new nt(0,0),M=new nt(0,0);const N=new nt(0,0),F=new nt(0,0),H=new nt(0,0),T=new nt(0,0);let z;for(g=0;g<d;){for(m=0;m<16;++m)p[m].high=f[g]<<24|f[g+1]<<16|f[g+2]<<8|f[g+3],p[m].low=f[g+4]<<24|f[g+5]<<16|f[g+6]<<8|f[g+7],g+=8;for(m=16;m<80;++m)z=p[m],eJ(z,p[m-2],T),z.add(p[m-7]),$Y(H,p[m-15],T),z.add(H),z.add(p[m-16]);for(w.assign(s),_.assign(r),v.assign(a),C.assign(o),k.assign(l),I.assign(c),S.assign(h),M.assign(u),m=0;m<80;++m)N.assign(M),QY(H,k,T),N.add(H),YY(H,k,I,S,T),N.add(H),N.add(y[m]),N.add(p[m]),ZY(F,w,T),JY(H,w,_,v,T),F.add(H),z=M,M=S,S=I,I=k,C.add(N),k=C,C=v,v=_,_=w,z.assign(N),z.add(F),w=z;s.add(w),r.add(_),a.add(v),o.add(C),l.add(k),c.add(I),h.add(S),u.add(M)}let R;return i?(R=new Uint8Array(48),s.copyTo(R,0),r.copyTo(R,8),a.copyTo(R,16),o.copyTo(R,24),l.copyTo(R,32),c.copyTo(R,40)):(R=new Uint8Array(64),s.copyTo(R,0),r.copyTo(R,8),a.copyTo(R,16),o.copyTo(R,24),l.copyTo(R,32),c.copyTo(R,40),h.copyTo(R,48),u.copyTo(R,56)),R}function tJ(n,e,t){return sP(n,e,t,!0)}const nJ={get k(){return Ze(this,"k",[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298])}};function ec(n,e){return n>>>e|n<<32-e}function iJ(n,e,t){return n&e^~n&t}function sJ(n,e,t){return n&e^n&t^e&t}function rJ(n){return ec(n,2)^ec(n,13)^ec(n,22)}function aJ(n){return ec(n,6)^ec(n,11)^ec(n,25)}function oJ(n){return ec(n,7)^ec(n,18)^n>>>3}function lJ(n){return ec(n,17)^ec(n,19)^n>>>10}function b6(n,e,t){let i=1779033703,s=3144134277,r=1013904242,a=2773480762,o=1359893119,l=2600822924,c=528734635,h=1541459225;const u=Math.ceil((t+9)/64)*64,d=new Uint8Array(u);let f,g;for(f=0;f<t;++f)d[f]=n[e++];d[f++]=128;const m=u-8;f<m&&(f=m),f+=3,d[f++]=t>>>29&255,d[f++]=t>>21&255,d[f++]=t>>13&255,d[f++]=t>>5&255,d[f++]=t<<3&255;const x=new Uint32Array(64),{k:p}=nJ;for(f=0;f<u;){for(g=0;g<16;++g)x[g]=d[f]<<24|d[f+1]<<16|d[f+2]<<8|d[f+3],f+=4;for(g=16;g<64;++g)x[g]=lJ(x[g-2])+x[g-7]+oJ(x[g-15])+x[g-16]|0;let y=i,w=s,_=r,v=a,C=o,k=l,I=c,S=h,M,N;for(g=0;g<64;++g)M=S+aJ(C)+iJ(C,k,I)+p[g]+x[g],N=rJ(y)+sJ(y,w,_),S=I,I=k,k=C,C=v+M|0,v=_,_=w,w=y,y=M+N|0;i=i+y|0,s=s+w|0,r=r+_|0,a=a+v|0,o=o+C|0,l=l+k|0,c=c+I|0,h=h+S|0}return new Uint8Array([i>>24&255,i>>16&255,i>>8&255,i&255,s>>24&255,s>>16&255,s>>8&255,s&255,r>>24&255,r>>16&255,r>>8&255,r&255,a>>24&255,a>>16&255,a>>8&255,a&255,o>>24&255,o>>16&255,o>>8&255,o&255,l>>24&255,l>>16&255,l>>8&255,l&255,c>>24&255,c>>16&255,c>>8&255,c&255,h>>24&255,h>>16&255,h>>8&255,h&255])}const gC=512;class cJ extends Zr{constructor(e,t,i){super(t),this.str=e,this.dict=e.dict,this.decrypt=i,this.nextChunk=null,this.initialized=!1}readBlock(){var o;let e;if(this.initialized?e=this.nextChunk:(e=this.str.getBytes(gC),this.initialized=!0),!(e!=null&&e.length)){this.eof=!0;return}this.nextChunk=this.str.getBytes(gC);const t=((o=this.nextChunk)==null?void 0:o.length)>0,i=this.decrypt;e=i(e,!t);const s=this.bufferLength,r=s+e.length;this.ensureBuffer(r).set(e,s),this.bufferLength=r}}class nu{constructor(e){this.a=0,this.b=0;const t=new Uint8Array(256),i=e.length;for(let s=0;s<256;++s)t[s]=s;for(let s=0,r=0;s<256;++s){const a=t[s];r=r+a+e[s%i]&255,t[s]=t[r],t[r]=a}this.s=t}encryptBlock(e){let t=this.a,i=this.b;const s=this.s,r=e.length,a=new Uint8Array(r);for(let o=0;o<r;++o){t=t+1&255;const l=s[t];i=i+l&255;const c=s[i];s[t]=c,s[i]=l,a[o]=e[o]^s[l+c&255]}return this.a=t,this.b=i,a}decryptBlock(e){return this.encryptBlock(e)}encrypt(e){return this.encryptBlock(e)}}class hJ{decryptBlock(e){return e}encrypt(e){return e}}class Q4{constructor(){He(this,"_s",new Uint8Array([99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22]));He(this,"_inv_s",new Uint8Array([82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125]));He(this,"_mix",new Uint32Array([0,235474187,470948374,303765277,941896748,908933415,607530554,708780849,1883793496,2118214995,1817866830,1649639237,1215061108,1181045119,1417561698,1517767529,3767586992,4003061179,4236429990,4069246893,3635733660,3602770327,3299278474,3400528769,2430122216,2664543715,2362090238,2193862645,2835123396,2801107407,3035535058,3135740889,3678124923,3576870512,3341394285,3374361702,3810496343,3977675356,4279080257,4043610186,2876494627,2776292904,3076639029,3110650942,2472011535,2640243204,2403728665,2169303058,1001089995,899835584,666464733,699432150,59727847,226906860,530400753,294930682,1273168787,1172967064,1475418501,1509430414,1942435775,2110667444,1876241833,1641816226,2910219766,2743034109,2976151520,3211623147,2505202138,2606453969,2302690252,2269728455,3711829422,3543599269,3240894392,3475313331,3843699074,3943906441,4178062228,4144047775,1306967366,1139781709,1374988112,1610459739,1975683434,2076935265,1775276924,1742315127,1034867998,866637845,566021896,800440835,92987698,193195065,429456164,395441711,1984812685,2017778566,1784663195,1683407248,1315562145,1080094634,1383856311,1551037884,101039829,135050206,437757123,337553864,1042385657,807962610,573804783,742039012,2531067453,2564033334,2328828971,2227573024,2935566865,2700099354,3001755655,3168937228,3868552805,3902563182,4203181171,4102977912,3736164937,3501741890,3265478751,3433712980,1106041591,1340463100,1576976609,1408749034,2043211483,2009195472,1708848333,1809054150,832877231,1068351396,766945465,599762354,159417987,126454664,361929877,463180190,2709260871,2943682380,3178106961,3009879386,2572697195,2538681184,2236228733,2336434550,3509871135,3745345300,3441850377,3274667266,3910161971,3877198648,4110568485,4211818798,2597806476,2497604743,2261089178,2295101073,2733856160,2902087851,3202437046,2968011453,3936291284,3835036895,4136440770,4169408201,3535486456,3702665459,3467192302,3231722213,2051518780,1951317047,1716890410,1750902305,1113818384,1282050075,1584504582,1350078989,168810852,67556463,371049330,404016761,841739592,1008918595,775550814,540080725,3969562369,3801332234,4035489047,4269907996,3569255213,3669462566,3366754619,3332740144,2631065433,2463879762,2160117071,2395588676,2767645557,2868897406,3102011747,3069049960,202008497,33778362,270040487,504459436,875451293,975658646,675039627,641025152,2084704233,1917518562,1615861247,1851332852,1147550661,1248802510,1484005843,1451044056,933301370,967311729,733156972,632953703,260388950,25965917,328671808,496906059,1206477858,1239443753,1543208500,1441952575,2144161806,1908694277,1675577880,1842759443,3610369226,3644379585,3408119516,3307916247,4011190502,3776767469,4077384432,4245618683,2809771154,2842737049,3144396420,3043140495,2673705150,2438237621,2203032232,2370213795]));He(this,"_mixCol",new Uint8Array(256).map((e,t)=>t<128?t<<1:t<<1^27));this.buffer=new Uint8Array(16),this.bufferPosition=0}_expandKey(e){kn("Cannot call `_expandKey` on the base class")}_decrypt(e,t){let i,s,r;const a=new Uint8Array(16);a.set(e);for(let o=0,l=this._keySize;o<16;++o,++l)a[o]^=t[l];for(let o=this._cyclesOfRepetition-1;o>=1;--o){i=a[13],a[13]=a[9],a[9]=a[5],a[5]=a[1],a[1]=i,i=a[14],s=a[10],a[14]=a[6],a[10]=a[2],a[6]=i,a[2]=s,i=a[15],s=a[11],r=a[7],a[15]=a[3],a[11]=i,a[7]=s,a[3]=r;for(let l=0;l<16;++l)a[l]=this._inv_s[a[l]];for(let l=0,c=o*16;l<16;++l,++c)a[l]^=t[c];for(let l=0;l<16;l+=4){const c=this._mix[a[l]],h=this._mix[a[l+1]],u=this._mix[a[l+2]],d=this._mix[a[l+3]];i=c^h>>>8^h<<24^u>>>16^u<<16^d>>>24^d<<8,a[l]=i>>>24&255,a[l+1]=i>>16&255,a[l+2]=i>>8&255,a[l+3]=i&255}}i=a[13],a[13]=a[9],a[9]=a[5],a[5]=a[1],a[1]=i,i=a[14],s=a[10],a[14]=a[6],a[10]=a[2],a[6]=i,a[2]=s,i=a[15],s=a[11],r=a[7],a[15]=a[3],a[11]=i,a[7]=s,a[3]=r;for(let o=0;o<16;++o)a[o]=this._inv_s[a[o]],a[o]^=t[o];return a}_encrypt(e,t){const i=this._s;let s,r,a;const o=new Uint8Array(16);o.set(e);for(let l=0;l<16;++l)o[l]^=t[l];for(let l=1;l<this._cyclesOfRepetition;l++){for(let c=0;c<16;++c)o[c]=i[o[c]];a=o[1],o[1]=o[5],o[5]=o[9],o[9]=o[13],o[13]=a,a=o[2],r=o[6],o[2]=o[10],o[6]=o[14],o[10]=a,o[14]=r,a=o[3],r=o[7],s=o[11],o[3]=o[15],o[7]=a,o[11]=r,o[15]=s;for(let c=0;c<16;c+=4){const h=o[c],u=o[c+1],d=o[c+2],f=o[c+3];s=h^u^d^f,o[c]^=s^this._mixCol[h^u],o[c+1]^=s^this._mixCol[u^d],o[c+2]^=s^this._mixCol[d^f],o[c+3]^=s^this._mixCol[f^h]}for(let c=0,h=l*16;c<16;++c,++h)o[c]^=t[h]}for(let l=0;l<16;++l)o[l]=i[o[l]];a=o[1],o[1]=o[5],o[5]=o[9],o[9]=o[13],o[13]=a,a=o[2],r=o[6],o[2]=o[10],o[6]=o[14],o[10]=a,o[14]=r,a=o[3],r=o[7],s=o[11],o[3]=o[15],o[7]=a,o[11]=r,o[15]=s;for(let l=0,c=this._keySize;l<16;++l,++c)o[l]^=t[c];return o}_decryptBlock2(e,t){const i=e.length;let s=this.buffer,r=this.bufferPosition;const a=[];let o=this.iv;for(let h=0;h<i;++h){if(s[r]=e[h],++r,r<16)continue;const u=this._decrypt(s,this._key);for(let d=0;d<16;++d)u[d]^=o[d];o=s,a.push(u),s=new Uint8Array(16),r=0}if(this.buffer=s,this.bufferLength=r,this.iv=o,a.length===0)return new Uint8Array(0);let l=16*a.length;if(t){const h=a.at(-1);let u=h[15];if(u<=16){for(let d=15,f=16-u;d>=f;--d)if(h[d]!==u){u=0;break}l-=u,a[a.length-1]=h.subarray(0,16-u)}}const c=new Uint8Array(l);for(let h=0,u=0,d=a.length;h<d;++h,u+=16)c.set(a[h],u);return c}decryptBlock(e,t,i=null){const s=e.length,r=this.buffer;let a=this.bufferPosition;if(i)this.iv=i;else{for(let o=0;a<16&&o<s;++o,++a)r[a]=e[o];if(a<16)return this.bufferLength=a,new Uint8Array(0);this.iv=r,e=e.subarray(16)}return this.buffer=new Uint8Array(16),this.bufferLength=0,this.decryptBlock=this._decryptBlock2,this.decryptBlock(e,t)}encrypt(e,t){const i=e.length;let s=this.buffer,r=this.bufferPosition;const a=[];t||(t=new Uint8Array(16));for(let c=0;c<i;++c){if(s[r]=e[c],++r,r<16)continue;for(let u=0;u<16;++u)s[u]^=t[u];const h=this._encrypt(s,this._key);t=h,a.push(h),s=new Uint8Array(16),r=0}if(this.buffer=s,this.bufferLength=r,this.iv=t,a.length===0)return new Uint8Array(0);const o=16*a.length,l=new Uint8Array(o);for(let c=0,h=0,u=a.length;c<u;++c,h+=16)l.set(a[c],h);return l}}class rP extends Q4{constructor(t){super();He(this,"_rcon",new Uint8Array([141,1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145,57,114,228,211,189,97,194,159,37,74,148,51,102,204,131,29,58,116,232,203,141,1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145,57,114,228,211,189,97,194,159,37,74,148,51,102,204,131,29,58,116,232,203,141,1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145,57,114,228,211,189,97,194,159,37,74,148,51,102,204,131,29,58,116,232,203,141,1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145,57,114,228,211,189,97,194,159,37,74,148,51,102,204,131,29,58,116,232,203,141,1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145,57,114,228,211,189,97,194,159,37,74,148,51,102,204,131,29,58,116,232,203,141]));this._cyclesOfRepetition=10,this._keySize=160,this._key=this._expandKey(t)}_expandKey(t){const s=this._s,r=this._rcon,a=new Uint8Array(176);a.set(t);for(let o=16,l=1;o<176;++l){let c=a[o-3],h=a[o-2],u=a[o-1],d=a[o-4];c=s[c],h=s[h],u=s[u],d=s[d],c^=r[l];for(let f=0;f<4;++f)a[o]=c^=a[o-16],o++,a[o]=h^=a[o-16],o++,a[o]=u^=a[o-16],o++,a[o]=d^=a[o-16],o++}return a}}class x6 extends Q4{constructor(e){super(),this._cyclesOfRepetition=14,this._keySize=224,this._key=this._expandKey(e)}_expandKey(e){const i=this._s,s=new Uint8Array(240);s.set(e);let r=1,a,o,l,c;for(let h=32,u=1;h<240;++u){h%32===16?(a=i[a],o=i[o],l=i[l],c=i[c]):h%32===0&&(a=s[h-3],o=s[h-2],l=s[h-1],c=s[h-4],a=i[a],o=i[o],l=i[l],c=i[c],a^=r,(r<<=1)>=256&&(r=(r^27)&255));for(let d=0;d<4;++d)s[h]=a^=s[h-32],h++,s[h]=o^=s[h-32],h++,s[h]=l^=s[h-32],h++,s[h]=c^=s[h-32],h++}return s}}class aP{_hash(e,t,i){kn("Abstract method `_hash` called")}checkOwnerPassword(e,t,i,s){const r=new Uint8Array(e.length+56);r.set(e,0),r.set(t,e.length),r.set(i,e.length+t.length);const a=this._hash(e,r,i);return Bp(a,s)}checkUserPassword(e,t,i){const s=new Uint8Array(e.length+8);s.set(e,0),s.set(t,e.length);const r=this._hash(e,s,[]);return Bp(r,i)}getOwnerKey(e,t,i,s){const r=new Uint8Array(e.length+56);r.set(e,0),r.set(t,e.length),r.set(i,e.length+t.length);const a=this._hash(e,r,i);return new x6(a).decryptBlock(s,!1,new Uint8Array(16))}getUserKey(e,t,i){const s=new Uint8Array(e.length+8);s.set(e,0),s.set(t,e.length);const r=this._hash(e,s,[]);return new x6(r).decryptBlock(i,!1,new Uint8Array(16))}}class uJ extends aP{_hash(e,t,i){return b6(t,0,t.length)}}class dJ extends aP{_hash(e,t,i){let s=b6(t,0,t.length).subarray(0,32),r=[0],a=0;for(;a<64||r.at(-1)>a-32;){const o=e.length+s.length+i.length,l=new Uint8Array(o);let c=0;l.set(e,c),c+=e.length,l.set(s,c),c+=s.length,l.set(i,c);const h=new Uint8Array(o*64);for(let f=0,g=0;f<64;f++,g+=o)h.set(l,g);r=new rP(s.subarray(0,16)).encrypt(h,s.subarray(16,32));const d=Math.sumPrecise(r.slice(0,16))%3;d===0?s=b6(r,0,r.length):d===1?s=tJ(r,0,r.length):d===2&&(s=sP(r,0,r.length)),a++}return s.subarray(0,32)}}class mC{constructor(e,t){this.StringCipherConstructor=e,this.StreamCipherConstructor=t}createStream(e,t){const i=new this.StreamCipherConstructor;return new cJ(e,t,function(r,a){return i.decryptBlock(r,a)})}decryptString(e){const t=new this.StringCipherConstructor;let i=cr(e);return i=t.decryptBlock(i,!0),da(i)}encryptString(e){const t=new this.StringCipherConstructor;if(t instanceof Q4){const r=16-e.length%16;e+=String.fromCharCode(r).repeat(r);const a=new Uint8Array(16);crypto.getRandomValues(a);let o=cr(e);o=t.encrypt(o,a);const l=new Uint8Array(16+o.length);return l.set(a),l.set(o,16),da(l)}let i=cr(e);return i=t.encrypt(i),da(i)}}var Ir,oP,w6,lP,c3,_6;const Kf=class Kf{constructor(e,t,i){B(this,Ir);const s=e.get("Filter");if(!Di(s,"Standard"))throw new Te("unknown encryption method");this.filterName=s.name,this.dict=e;const r=e.get("V");if(!Number.isInteger(r)||r!==1&&r!==2&&r!==4&&r!==5)throw new Te("unsupported encryption algorithm");this.algorithm=r;let a=e.get("Length");if(!a)if(r<=3)a=40;else{const p=e.get("CF"),y=e.get("StmF");if(p instanceof fe&&y instanceof ve){p.suppressEncryption=!0;const w=p.get(y.name);a=(w==null?void 0:w.get("Length"))||128,a<40&&(a<<=3)}}if(!Number.isInteger(a)||a<40||a%8!==0)throw new Te("invalid key length");const o=cr(e.get("O")),l=cr(e.get("U")),c=o.subarray(0,32),h=l.subarray(0,32),u=e.get("P"),d=e.get("R"),f=(r===4||r===5)&&e.get("EncryptMetadata")!==!1;this.encryptMetadata=f;const g=cr(t);let m;if(i){if(d===6)try{i=k7(i)}catch{ce("CipherTransformFactory: Unable to convert UTF8 encoded password.")}m=cr(i)}let x;if(r!==5)x=D(this,Ir,w6).call(this,g,m,c,h,u,d,a,f);else{const p=o.subarray(32,40),y=o.subarray(40,48),w=l.subarray(0,48),_=l.subarray(32,40),v=l.subarray(40,48),C=cr(e.get("OE")),k=cr(e.get("UE")),I=cr(e.get("Perms"));x=D(this,Ir,oP).call(this,d,m,c,p,y,w,h,_,v,C,k,I)}if(!x){if(!i)throw new Dp("No password given",zv.NEED_PASSWORD);const p=D(this,Ir,lP).call(this,m,c,d,a);x=D(this,Ir,w6).call(this,g,p,c,h,u,d,a,f)}if(!x)throw new Dp("Incorrect Password",zv.INCORRECT_PASSWORD);if(r===4&&x.length<16?(this.encryptionKey=new Uint8Array(16),this.encryptionKey.set(x)):this.encryptionKey=x,r>=4){const p=e.get("CF");p instanceof fe&&(p.suppressEncryption=!0),this.cf=p,this.stmf=e.get("StmF")||ve.get("Identity"),this.strf=e.get("StrF")||ve.get("Identity"),this.eff=e.get("EFF")||this.stmf}}static get _defaultPasswordBytes(){return Ze(this,"_defaultPasswordBytes",new Uint8Array([40,191,78,94,78,117,138,65,100,0,78,86,255,250,1,8,46,46,0,182,208,104,62,128,47,12,169,254,100,83,105,122]))}createCipherTransform(e,t){if(this.algorithm===4||this.algorithm===5)return new mC(D(this,Ir,_6).call(this,this.cf,this.strf,e,t,this.encryptionKey),D(this,Ir,_6).call(this,this.cf,this.stmf,e,t,this.encryptionKey));const i=D(this,Ir,c3).call(this,e,t,this.encryptionKey,!1),s=function(){return new nu(i)};return new mC(s,s)}};Ir=new WeakSet,oP=function(e,t,i,s,r,a,o,l,c,h,u,d){if(t){const g=Math.min(127,t.length);t=t.subarray(0,g)}else t=[];const f=e===6?new dJ:new uJ;return f.checkUserPassword(t,l,o)?f.getUserKey(t,c,u):t.length&&f.checkOwnerPassword(t,s,a,i)?f.getOwnerKey(t,r,a,h):null},w6=function(e,t,i,s,r,a,o,l){const c=40+i.length+e.length,h=new Uint8Array(c);let u=0,d,f;if(t)for(f=Math.min(32,t.length);u<f;++u)h[u]=t[u];for(d=0;u<32;)h[u++]=Kf._defaultPasswordBytes[d++];h.set(i,u),u+=i.length,h[u++]=r&255,h[u++]=r>>8&255,h[u++]=r>>16&255,h[u++]=r>>>24&255,h.set(e,u),u+=e.length,a>=4&&!l&&(h.fill(255,u,u+4),u+=4);let g=P0(h,0,u);const m=o>>3;if(a>=3)for(d=0;d<50;++d)g=P0(g,0,m);const x=g.subarray(0,m);let p,y;if(a>=3){u=0,h.set(Kf._defaultPasswordBytes,u),u+=32,h.set(e,u),u+=e.length,p=new nu(x),y=p.encryptBlock(P0(h,0,u)),f=x.length;const w=new Uint8Array(f);for(d=1;d<=19;++d){for(let _=0;_<f;++_)w[_]=x[_]^d;p=new nu(w),y=p.encryptBlock(y)}}else p=new nu(x),y=p.encryptBlock(Kf._defaultPasswordBytes);return y.every((w,_)=>s[_]===w)?x:null},lP=function(e,t,i,s){const r=new Uint8Array(32);let a=0;const o=Math.min(32,e.length);for(;a<o;++a)r[a]=e[a];let l=0;for(;a<32;)r[a++]=Kf._defaultPasswordBytes[l++];let c=P0(r,0,a);const h=s>>3;if(i>=3)for(l=0;l<50;++l)c=P0(c,0,c.length);let u,d;if(i>=3){d=t;const f=new Uint8Array(h);for(l=19;l>=0;l--){for(let g=0;g<h;++g)f[g]=c[g]^l;u=new nu(f),d=u.encryptBlock(d)}}else u=new nu(c.subarray(0,h)),d=u.encryptBlock(t);return d},c3=function(e,t,i,s=!1){const r=i.length,a=new Uint8Array(r+9);a.set(i);let o=r;return a[o++]=e&255,a[o++]=e>>8&255,a[o++]=e>>16&255,a[o++]=t&255,a[o++]=t>>8&255,s&&(a[o++]=115,a[o++]=65,a[o++]=108,a[o++]=84),P0(a,0,o).subarray(0,Math.min(r+5,16))},_6=function(e,t,i,s,r){if(!(t instanceof ve))throw new Te("Invalid crypt filter name.");const a=this,o=e.get(t.name),l=o==null?void 0:o.get("CFM");if(!l||l.name==="None")return function(){return new hJ};if(l.name==="V2")return function(){var c;return new nu(D(c=a,Ir,c3).call(c,i,s,r,!1))};if(l.name==="AESV2")return function(){var c;return new rP(D(c=a,Ir,c3).call(c,i,s,r,!0))};if(l.name==="AESV3")return function(){return new x6(r)};throw new Te("Unknown crypto method")};let y6=Kf;var ex;class fJ{constructor(e,t){B(this,ex,null);this.stream=e,this.pdfManager=t,this.entries=[],this._xrefStms=new Set,this._cacheMap=new Map,this._pendingRefs=new Zi,this._newPersistentRefNum=null,this._newTemporaryRefNum=null,this._persistentRefsCache=null}getNewPersistentRef(e){this._newPersistentRefNum===null&&(this._newPersistentRefNum=this.entries.length||1);const t=this._newPersistentRefNum++;return this._cacheMap.set(t,e),st.get(t,0)}getNewTemporaryRef(){if(this._newTemporaryRefNum===null&&(this._newTemporaryRefNum=this.entries.length||1,this._newPersistentRefNum)){this._persistentRefsCache=new Map;for(let e=this._newTemporaryRefNum;e<this._newPersistentRefNum;e++)this._persistentRefsCache.set(e,this._cacheMap.get(e)),this._cacheMap.delete(e)}return st.get(this._newTemporaryRefNum++,0)}resetNewTemporaryRef(){if(this._newTemporaryRefNum=null,this._persistentRefsCache)for(const[e,t]of this._persistentRefsCache)this._cacheMap.set(e,t);this._persistentRefsCache=null}setStartXRef(e){this.startXRefQueue=[e]}parse(e=!1){let t;e?(ce("Indexing all PDF objects"),t=this.indexObjects()):t=this.readXRef(),t.assignXref(this),this.trailer=t;let i;try{i=t.get("Encrypt")}catch(r){if(r instanceof xi)throw r;ce(`XRef.parse - Invalid "Encrypt" reference: "${r}".`)}if(i instanceof fe){const r=t.get("ID"),a=r!=null&&r.length?r[0]:"";i.suppressEncryption=!0,this.encrypt=new y6(i,a,this.pdfManager.password)}let s;try{s=t.get("Root")}catch(r){if(r instanceof xi)throw r;ce(`XRef.parse - Invalid "Root" reference: "${r}".`)}if(s instanceof fe)try{if(s.get("Pages")instanceof fe){this.root=s;return}}catch(r){if(r instanceof xi)throw r;ce(`XRef.parse - Invalid "Pages" reference: "${r}".`)}throw e?new Fp("Invalid Root reference."):new t1}processXRefTable(e){"tableState"in this||(this.tableState={entryNum:0,streamPos:e.lexer.stream.pos,parserBuf1:e.buf1,parserBuf2:e.buf2});const t=this.readXRefTable(e);if(!Ss(t,"trailer"))throw new Te("Invalid XRef table: could not find trailer dictionary");let i=e.getObj();if(!(i instanceof fe)&&i.dict&&(i=i.dict),!(i instanceof fe))throw new Te("Invalid XRef table: could not parse trailer dictionary");return delete this.tableState,i}readXRefTable(e){const t=e.lexer.stream,i=this.tableState;t.pos=i.streamPos,e.buf1=i.parserBuf1,e.buf2=i.parserBuf2;let s;for(;;){if(!("firstEntryNum"in i)||!("entryCount"in i)){if(Ss(s=e.getObj(),"trailer"))break;i.firstEntryNum=s,i.entryCount=e.getObj()}let r=i.firstEntryNum;const a=i.entryCount;if(!Number.isInteger(r)||!Number.isInteger(a))throw new Te("Invalid XRef table: wrong types in subsection header");for(let o=i.entryNum;o<a;o++){i.streamPos=t.pos,i.entryNum=o,i.parserBuf1=e.buf1,i.parserBuf2=e.buf2;const l={};l.offset=e.getObj(),l.gen=e.getObj();const c=e.getObj();if(c instanceof ss)switch(c.cmd){case"f":l.free=!0;break;case"n":l.uncompressed=!0;break}if(!Number.isInteger(l.offset)||!Number.isInteger(l.gen)||!(l.free||l.uncompressed))throw new Te(`Invalid entry in XRef subsection: ${r}, ${a}`);o===0&&l.free&&r===1&&(r=0),this.entries[o+r]||(this.entries[o+r]=l)}i.entryNum=0,i.streamPos=t.pos,i.parserBuf1=e.buf1,i.parserBuf2=e.buf2,delete i.firstEntryNum,delete i.entryCount}if(this.entries[0]&&!this.entries[0].free)throw new Te("Invalid XRef table: unexpected first object");return s}processXRefStream(e){if(!("streamState"in this)){const{dict:t,pos:i}=e,s=t.get("W"),r=t.get("Index")||[0,t.get("Size")];this.streamState={entryRanges:r,byteWidths:s,entryNum:0,streamPos:i}}return this.readXRefStream(e),delete this.streamState,e.dict}readXRefStream(e){const t=this.streamState;e.pos=t.streamPos;const[i,s,r]=t.byteWidths,a=t.entryRanges;for(;a.length>0;){const[o,l]=a;if(!Number.isInteger(o)||!Number.isInteger(l))throw new Te(`Invalid XRef range fields: ${o}, ${l}`);if(!Number.isInteger(i)||!Number.isInteger(s)||!Number.isInteger(r))throw new Te(`Invalid XRef entry fields length: ${o}, ${l}`);for(let c=t.entryNum;c<l;++c){t.entryNum=c,t.streamPos=e.pos;let h=0,u=0,d=0;for(let g=0;g<i;++g){const m=e.getByte();if(m===-1)throw new Te("Invalid XRef byteWidths 'type'.");h=h<<8|m}i===0&&(h=1);for(let g=0;g<s;++g){const m=e.getByte();if(m===-1)throw new Te("Invalid XRef byteWidths 'offset'.");u=u<<8|m}for(let g=0;g<r;++g){const m=e.getByte();if(m===-1)throw new Te("Invalid XRef byteWidths 'generation'.");d=d<<8|m}const f={};switch(f.offset=u,f.gen=d,h){case 0:f.free=!0;break;case 1:f.uncompressed=!0;break;case 2:break;default:throw new Te(`Invalid XRef entry type: ${h}`)}this.entries[o+c]||(this.entries[o+c]=f)}t.entryNum=0,t.streamPos=e.pos,a.splice(0,2)}}indexObjects(){function o(M,N){let F="",H=M[N];for(;H!==10&&H!==13&&H!==60&&!(++N>=M.length);)F+=String.fromCharCode(H),H=M[N];return F}function l(M,N,F){const H=F.length,T=M.length;let z=0;for(;N<T;){let R=0;for(;R<H&&M[N+R]===F[R];)++R;if(R>=H)break;N++,z++}return z}const c=/\b(endobj|\d+\s+\d+\s+obj|xref|trailer\s*<<)\b/g,h=/\b(startxref|\d+\s+\d+\s+obj)\b/g,u=/^(\d+)\s+(\d+)\s+obj\b/,d=new Uint8Array([116,114,97,105,108,101,114]),f=new Uint8Array([115,116,97,114,116,120,114,101,102]),g=new Uint8Array([47,88,82,101,102]);this.entries.length=0,this._cacheMap.clear();const m=this.stream;m.pos=0;const x=m.getBytes(),p=da(x),y=x.length;let w=m.start;const _=[],v=[];for(;w<y;){let M=x[w];if(M===9||M===10||M===13||M===32){++w;continue}if(M===37){do{if(++w,w>=y)break;M=x[w]}while(M!==10&&M!==13);continue}const N=o(x,w);let F;if(N.startsWith("xref")&&(N.length===4||/\s/.test(N[4])))w+=l(x,w,d),_.push(w),w+=l(x,w,f);else if(F=u.exec(N)){const H=F[1]|0,T=F[2]|0,z=w+N.length;let R,L=!1;if(!this.entries[H])L=!0;else if(this.entries[H].gen===T)try{new R0({lexer:new Wo(m.makeSubStream(z))}).getObj(),L=!0}catch(G){G instanceof I7?ce(`indexObjects -- checking object (${N}): "${G}".`):L=!0}L&&(this.entries[H]={offset:w-m.start,gen:T,uncompressed:!0}),c.lastIndex=z;const Y=c.exec(p);Y?(R=c.lastIndex+1-w,Y[1]!=="endobj"&&(ce(`indexObjects: Found "${Y[1]}" inside of another "obj", caused by missing "endobj" -- trying to recover.`),R-=Y[1].length+1)):R=y-w;const j=x.subarray(w,w+R),J=l(j,0,g);J<R&&j[J+5]<64&&(v.push(w-m.start),this._xrefStms.add(w-m.start)),w+=R}else if(N.startsWith("trailer")&&(N.length===7||/\s/.test(N[7]))){_.push(w);const H=w+N.length;let T;h.lastIndex=H;const z=h.exec(p);z?(T=h.lastIndex+1-w,z[1]!=="startxref"&&(ce(`indexObjects: Found "${z[1]}" after "trailer", caused by missing "startxref" -- trying to recover.`),T-=z[1].length+1)):T=y-w,w+=T}else w+=N.length+1}for(const M of v)this.startXRefQueue.push(M),this.readXRef(!0);const C=[];let k=!1;for(const M of _){m.pos=M;const N=new R0({lexer:new Wo(m),xref:this,allowStreams:!0,recoveryMode:!0}),F=N.getObj();if(!Ss(F,"trailer"))continue;const H=N.getObj();H instanceof fe&&(C.push(H),H.has("Encrypt")&&(k=!0))}let I,S;for(const M of[...C,"genFallback",...C]){if(M==="genFallback"){if(!S)break;this._generationFallback=!0;continue}let N=!1;try{const F=M.get("Root");if(!(F instanceof fe))continue;const H=F.get("Pages");if(!(H instanceof fe))continue;const T=H.get("Count");Number.isInteger(T)&&(N=!0)}catch(F){S=F;continue}if(N&&(!k||M.has("Encrypt"))&&M.has("ID"))return M;I=M}if(I)return I;if(this.topDict)return this.topDict;if(!C.length)for(const[M,N]of this.entries.entries()){if(!N)continue;const F=st.get(M,N.gen);let H;try{H=this.fetch(F)}catch{continue}if(H instanceof un&&(H=H.dict),H instanceof fe&&H.has("Root"))return H}throw new Fp("Invalid PDF structure.")}readXRef(e=!1){const t=this.stream,i=new Set;for(;this.startXRefQueue.length;){try{const s=this.startXRefQueue[0];if(i.has(s)){ce("readXRef - skipping XRef table since it was already parsed."),this.startXRefQueue.shift();continue}i.add(s),t.pos=s+t.start;const r=new R0({lexer:new Wo(t),xref:this,allowStreams:!0});let a=r.getObj(),o;if(Ss(a,"xref"))o=this.processXRefTable(r),this.topDict||(this.topDict=o),a=o.get("XRefStm"),Number.isInteger(a)&&!this._xrefStms.has(a)&&(this._xrefStms.add(a),this.startXRefQueue.push(a),b(this,ex)??O(this,ex,a));else if(Number.isInteger(a)){if(!Number.isInteger(r.getObj())||!Ss(r.getObj(),"obj")||!((a=r.getObj())instanceof un))throw new Te("Invalid XRef stream");if(o=this.processXRefStream(a),this.topDict||(this.topDict=o),!o)throw new Te("Failed to read XRef stream")}else throw new Te("Invalid XRef stream header");a=o.get("Prev"),Number.isInteger(a)?this.startXRefQueue.push(a):a instanceof st&&this.startXRefQueue.push(a.num)}catch(s){if(s instanceof xi)throw s;gn("(while reading XRef): "+s)}this.startXRefQueue.shift()}if(this.topDict)return this.topDict;if(!e)throw new t1}get lastXRefStreamPos(){return b(this,ex)??(this._xrefStms.size>0?Math.max(...this._xrefStms):null)}getEntry(e){const t=this.entries[e];return t&&!t.free&&t.offset?t:null}fetchIfRef(e,t=!1){return e instanceof st?this.fetch(e,t):e}fetch(e,t=!1){if(!(e instanceof st))throw new Error("ref object is not a reference");const i=e.num,s=this._cacheMap.get(i);if(s!==void 0)return s instanceof fe&&!s.objId&&(s.objId=e.toString()),s;let r=this.getEntry(i);if(r===null)return r;if(this._pendingRefs.has(e))return this._pendingRefs.remove(e),ce(`Ignoring circular reference: ${e}.`),wU;this._pendingRefs.put(e);try{r=r.uncompressed?this.fetchUncompressed(e,r,t):this.fetchCompressed(e,r,t),this._pendingRefs.remove(e)}catch(a){throw this._pendingRefs.remove(e),a}return r instanceof fe?r.objId=e.toString():r instanceof un&&(r.dict.objId=e.toString()),r}fetchUncompressed(e,t,i=!1){const s=e.gen;let r=e.num;if(t.gen!==s){const u=`Inconsistent generation in XRef: ${e}`;if(this._generationFallback&&t.gen<s)return ce(u),this.fetchUncompressed(st.get(r,t.gen),t,i);throw new Eh(u)}const a=this.stream.makeSubStream(t.offset+this.stream.start),o=new R0({lexer:new Wo(a),xref:this,allowStreams:!0}),l=o.getObj(),c=o.getObj(),h=o.getObj();if(l!==r||c!==s||!(h instanceof ss))throw new Eh(`Bad (uncompressed) XRef entry: ${e}`);if(h.cmd!=="obj"){if(h.cmd.startsWith("obj")&&(r=parseInt(h.cmd.substring(3),10),!Number.isNaN(r)))return r;throw new Eh(`Bad (uncompressed) XRef entry: ${e}`)}return t=this.encrypt&&!i?o.getObj(this.encrypt.createCipherTransform(r,s)):o.getObj(),t instanceof un||this._cacheMap.set(r,t),t}fetchCompressed(e,t,i=!1){const s=t.offset,r=this.fetch(st.get(s,0));if(!(r instanceof un))throw new Te("bad ObjStm stream");const a=r.dict.get("First"),o=r.dict.get("N");if(!Number.isInteger(a)||!Number.isInteger(o))throw new Te("invalid first and n parameters for ObjStm stream");let l=new R0({lexer:new Wo(r),xref:this,allowStreams:!0});const c=new Array(o),h=new Array(o);for(let f=0;f<o;++f){const g=l.getObj();if(!Number.isInteger(g))throw new Te(`invalid object number in the ObjStm stream: ${g}`);const m=l.getObj();if(!Number.isInteger(m))throw new Te(`invalid object offset in the ObjStm stream: ${m}`);c[f]=g,h[f]=m}const u=(r.start||0)+a,d=new Array(o);for(let f=0;f<o;++f){const g=f<o-1?h[f+1]-h[f]:void 0;if(g<0)throw new Te("Invalid offset in the ObjStm stream.");l=new R0({lexer:new Wo(r.makeSubStream(u+h[f],g,r.dict)),xref:this,allowStreams:!0});const m=l.getObj();if(d[f]=m,m instanceof un)continue;const x=c[f],p=this.entries[x];p&&p.offset===s&&p.gen===f&&this._cacheMap.set(x,m)}if(t=d[t.gen],t===void 0)throw new Eh(`Bad (compressed) XRef entry: ${e}`);return t}async fetchIfRefAsync(e,t){return e instanceof st?this.fetchAsync(e,t):e}async fetchAsync(e,t){try{return this.fetch(e,t)}catch(i){if(!(i instanceof xi))throw i;return await this.pdfManager.requestRange(i.begin,i.end),this.fetchAsync(e,t)}}getCatalogObj(){return this.root}}ex=new WeakMap;const gJ=[0,0,612,792];var V5,Bi,Pf,dp,v6,cP,k6,C6;class pC{constructor({pdfManager:e,xref:t,pageIndex:i,pageDict:s,ref:r,globalIdFactory:a,fontCache:o,builtInCMapCache:l,standardFontDataCache:c,globalColorSpaceCache:h,globalImageCache:u,systemFontCache:d,nonBlendModesSet:f,xfaFactory:g}){B(this,Bi);B(this,V5,null);this.pdfManager=e,this.pageIndex=i,this.pageDict=s,this.xref=t,this.ref=r,this.fontCache=o,this.builtInCMapCache=l,this.standardFontDataCache=c,this.globalColorSpaceCache=h,this.globalImageCache=u,this.systemFontCache=d,this.nonBlendModesSet=f,this.evaluatorOptions=e.evaluatorOptions,this.xfaFactory=g;const m={obj:0};this._localIdFactory=class extends a{static createObjId(){return`p${i}_${++m.obj}`}static getPageObjId(){return`p${r.toString()}`}}}get content(){return this.pageDict.getArray("Contents")}get resources(){const e=D(this,Bi,dp).call(this,"Resources");return Ze(this,"resources",e instanceof fe?e:fe.empty)}get mediaBox(){return Ze(this,"mediaBox",D(this,Bi,v6).call(this,"MediaBox")||gJ)}get cropBox(){return Ze(this,"cropBox",D(this,Bi,v6).call(this,"CropBox")||this.mediaBox)}get userUnit(){const e=this.pageDict.get("UserUnit");return Ze(this,"userUnit",typeof e=="number"&&e>0?e:1)}get view(){const{cropBox:e,mediaBox:t}=this;if(e!==t&&!Bp(e,t)){const i=Dn.intersect(e,t);if(i&&i[2]-i[0]>0&&i[3]-i[1]>0)return Ze(this,"view",i);ce("Empty /CropBox and /MediaBox intersection.")}return Ze(this,"view",t)}get rotate(){let e=D(this,Bi,dp).call(this,"Rotate")||0;return e%90!==0?e=0:e>=360?e%=360:e<0&&(e=(e%360+360)%360),Ze(this,"rotate",e)}async getContentStream(){const e=await this.pdfManager.ensure(this,"content");return e instanceof un?e:Array.isArray(e)?new oH(e,D(this,Bi,cP).bind(this)):new F7}get xfaData(){return Ze(this,"xfaData",this.xfaFactory?{bbox:this.xfaFactory.getBoundingBox(this.pageIndex)}:null)}async saveNewAnnotations(e,t,i,s,r){if(this.xfaFactory)throw new Error("XFA: Cannot save new annotations.");const a=D(this,Bi,Pf).call(this,e),o=new ca,l=new Zi;await D(this,Bi,k6).call(this,i,o,l);const c=this.pageDict,h=this.annotations.filter(f=>!(f instanceof st&&o.has(f))),u=await F0.saveNewAnnotations(a,t,i,s,r);for(const{ref:f}of u.annotations)f instanceof st&&!l.has(f)&&h.push(f);const d=c.clone();d.set("Annots",h),r.put(this.ref,{data:d});for(const f of o)r.put(f,{data:null})}async save(e,t,i,s){const r=D(this,Bi,Pf).call(this,e),a=await this._parsedAnnotations,o=[];for(const l of a)o.push(l.save(r,t,i,s).catch(function(c){return ce(`save - ignoring annotation data during "${t.name}" task: "${c}".`),null}));return Promise.all(o)}async loadResources(e){await(b(this,V5)??O(this,V5,this.pdfManager.ensure(this,"resources"))),await Pg.load(this.resources,e,this.xref)}async getOperatorList({handler:e,sink:t,task:i,intent:s,cacheKey:r,annotationStorage:a=null,modifiedIds:o=null}){const l=this.getContentStream(),c=this.loadResources(A7),h=D(this,Bi,Pf).call(this,e),u=this.xfaFactory?null:hR(a),d=u==null?void 0:u.get(this.pageIndex);let f=Promise.resolve(null),g=null;if(d){const F=this.pdfManager.ensureDoc("annotationGlobals");let H;const T=new Set;for(const{bitmapId:R,bitmap:L}of d)R&&!L&&!T.has(R)&&T.add(R);const{isOffscreenCanvasSupported:z}=this.evaluatorOptions;if(T.size>0){const R=d.slice();for(const[L,Y]of a)L.startsWith(tR)&&Y.bitmap&&T.has(Y.bitmapId)&&R.push(Y);H=F0.generateImages(R,this.xref,z)}else H=F0.generateImages(d,this.xref,z);g=new Zi,f=Promise.all([F,D(this,Bi,k6).call(this,d,g,null)]).then(([R])=>R?F0.printNewAnnotations(R,h,i,d,H):null)}const m=Promise.all([l,c]).then(async([F])=>{const H=await D(this,Bi,C6).call(this,F.dict,A7),T=new Sr(s,t);return e.send("StartRenderPage",{transparency:h.hasBlendModes(H,this.nonBlendModesSet),pageIndex:this.pageIndex,cacheKey:r}),await h.getOperatorList({stream:F,task:i,resources:H,operatorList:T}),T});let[x,p,y]=await Promise.all([m,this._parsedAnnotations,f]);if(y){p=p.filter(F=>!(F.ref&&g.has(F.ref)));for(let F=0,H=y.length;F<H;F++){const T=y[F];if(T.refToReplace){const z=p.findIndex(R=>R.ref&&I3(R.ref,T.refToReplace));z>=0&&(p.splice(z,1,T),y.splice(F--,1),H--)}}p=p.concat(y)}if(p.length===0||s&zr.ANNOTATIONS_DISABLE)return x.flush(!0),{length:x.totalLength};const w=!!(s&zr.ANNOTATIONS_FORMS),_=!!(s&zr.IS_EDITING),v=!!(s&zr.ANY),C=!!(s&zr.DISPLAY),k=!!(s&zr.PRINT),I=[];for(const F of p)(v||C&&F.mustBeViewed(a,w)&&F.mustBeViewedWhenEditing(_,o)||k&&F.mustBePrinted(a))&&I.push(F.getOperatorList(h,i,s,a).catch(function(H){return ce(`getOperatorList - ignoring annotation data during "${i.name}" task: "${H}".`),{opList:null,separateForm:!1,separateCanvas:!1}}));const S=await Promise.all(I);let M=!1,N=!1;for(const{opList:F,separateForm:H,separateCanvas:T}of S)x.addOpList(F),M||(M=H),N||(N=T);return x.flush(!0,{form:M,canvas:N}),{length:x.totalLength}}async extractTextContent({handler:e,task:t,includeMarkedContent:i,disableNormalization:s,sink:r,intersector:a=null}){const o=this.getContentStream(),l=this.loadResources(S7),c=this.pdfManager.ensureCatalog("lang"),[h,,u]=await Promise.all([o,l,c]),d=await D(this,Bi,C6).call(this,h.dict,S7);return D(this,Bi,Pf).call(this,e).getTextContent({stream:h,task:t,resources:d,includeMarkedContent:i,disableNormalization:s,sink:r,viewBox:this.view,lang:u,intersector:a})}async getStructTree(){const e=await this.pdfManager.ensureCatalog("structTreeRoot");if(!e)return null;await this._parsedAnnotations;try{const t=await this.pdfManager.ensure(this,"_parseStructTree",[e]);return await this.pdfManager.ensure(t,"serializable")}catch(t){return ce(`getStructTree: "${t}".`),null}}_parseStructTree(e){const t=new lM(e,this.pageDict);return t.parse(this.ref),t}async getAnnotationsData(e,t,i){const s=await this._parsedAnnotations;if(s.length===0)return s;const r=[],a=[];let o;const l=!!(i&zr.ANY),c=!!(i&zr.DISPLAY),h=!!(i&zr.PRINT),u=[];for(const d of s){const f=l||c&&d.viewable;(f||h&&d.printable)&&r.push(d.data),d.hasTextContent&&f?(o??(o=D(this,Bi,Pf).call(this,e)),a.push(d.extractTextContent(o,t,[-1/0,-1/0,1/0,1/0]).catch(function(g){ce(`getAnnotationsData - ignoring textContent during "${t.name}" task: "${g}".`)}))):d.overlaysTextContent&&f&&u.push(d)}if(u.length>0){const d=new KY(u);a.push(this.extractTextContent({handler:e,task:t,includeMarkedContent:!1,disableNormalization:!1,sink:null,viewBox:this.view,lang:null,intersector:d}).then(()=>{d.setText()}))}return await Promise.all(a),r}get annotations(){const e=D(this,Bi,dp).call(this,"Annots");return Ze(this,"annotations",Array.isArray(e)?e:[])}get _parsedAnnotations(){const e=this.pdfManager.ensure(this,"annotations").then(async t=>{if(t.length===0)return t;const[i,s]=await Promise.all([this.pdfManager.ensureDoc("annotationGlobals"),this.pdfManager.ensureDoc("fieldObjects")]);if(!i)return[];const r=s==null?void 0:s.orphanFields,a=[];for(const h of t)a.push(F0.create(this.xref,h,i,this._localIdFactory,!1,r,this.ref).catch(function(u){return ce(`_parsedAnnotations: "${u}".`),null}));const o=[];let l,c;for(const h of await Promise.all(a))if(h){if(h instanceof il){(c||(c=[])).push(h);continue}if(h instanceof $M){(l||(l=[])).push(h);continue}o.push(h)}return c&&o.push(...c),l&&o.push(...l),o});return Ze(this,"_parsedAnnotations",e)}get jsActions(){const e=ey(this.xref,this.pageDict,cU);return Ze(this,"jsActions",e)}}V5=new WeakMap,Bi=new WeakSet,Pf=function(e){return new Rg({xref:this.xref,handler:e,pageIndex:this.pageIndex,idFactory:this._localIdFactory,fontCache:this.fontCache,builtInCMapCache:this.builtInCMapCache,standardFontDataCache:this.standardFontDataCache,globalColorSpaceCache:this.globalColorSpaceCache,globalImageCache:this.globalImageCache,systemFontCache:this.systemFontCache,options:this.evaluatorOptions})},dp=function(e,t=!1){const i=fo({dict:this.pageDict,key:e,getArray:t,stopWhenFound:!1});return Array.isArray(i)?i.length===1||!(i[0]instanceof fe)?i[0]:fe.merge({xref:this.xref,dictArray:i}):i},v6=function(e){if(this.xfaData)return this.xfaData.bbox;const t=y0(D(this,Bi,dp).call(this,e,!0),null);if(t){if(t[2]-t[0]>0&&t[3]-t[1]>0)return t;ce(`Empty, or invalid, /${e} entry.`)}return null},cP=function(e,t){if(this.evaluatorOptions.ignoreErrors){ce(`getContentStream - ignoring sub-stream (${t}): "${e}".`);return}throw e},k6=async function(e,t,i){const s=[];for(const r of e)if(r.id){const a=st.fromString(r.id);if(!a){ce(`A non-linked annotation cannot be modified: ${r.id}`);continue}if(r.deleted){if(t.put(a,a),r.popupRef){const o=st.fromString(r.popupRef);o&&t.put(o,o)}continue}i==null||i.put(a),r.ref=a,s.push(this.xref.fetchAsync(a).then(o=>{o instanceof fe&&(r.oldAnnotation=o.clone())},()=>{ce(`Cannot fetch \`oldAnnotation\` for: ${a}.`)})),delete r.id}await Promise.all(s)},C6=async function(e,t){const i=e==null?void 0:e.get("Resources");return i instanceof fe&&i.size?(await Pg.load(i,t,this.xref),fe.merge({xref:this.xref,dictArray:[i,this.resources],mergeSubDicts:!0})):this.resources};const bC=new Uint8Array([37,80,68,70,45]),xC=new Uint8Array([115,116,97,114,116,120,114,101,102]),mJ=new Uint8Array([101,110,100,111,98,106]);function Uw(n,e,t=1024,i=!1){const s=e.length,r=n.peekBytes(t),a=r.length-s;if(a<=0)return!1;if(i){const o=s-1;let l=r.length-1;for(;l>=o;){let c=0;for(;c<s&&r[l-c]===e[o-c];)c++;if(c>=s)return n.pos+=l-o,!0;l--}}else{let o=0;for(;o<=a;){let l=0;for(;l<s&&r[o+l]===e[l];)l++;if(l>=s)return n.pos+=o,!0;o++}}return!1}var Ih,tx,Tr,A6,uP,dP,fP,gP,S6;class hP{constructor(e,t){B(this,Tr);B(this,Ih,new Map);B(this,tx,null);if(t.length<=0)throw new Fp("The PDF file is empty, i.e. its size is zero bytes.");this.pdfManager=e,this.stream=t,this.xref=new fJ(t,e);const i={font:0};this._globalIdFactory=class{static getDocId(){return`g_${e.docId}`}static createFontId(){return`f${++i.font}`}static createObjId(){kn("Abstract method `createObjId` called.")}static getPageObjId(){kn("Abstract method `getPageObjId` called.")}}}parse(e){this.xref.parse(e),this.catalog=new Xp(this.pdfManager,this.xref)}get linearization(){let e=null;try{e=QH.create(this.stream)}catch(t){if(t instanceof xi)throw t;gn(t)}return Ze(this,"linearization",e)}get startXRef(){const e=this.stream;let t=0;if(this.linearization){if(e.reset(),Uw(e,mJ)){e.skip(6);let i=e.peekByte();for(;qa(i);)e.pos++,i=e.peekByte();t=e.pos-e.start}}else{const s=xC.length;let r=!1,a=e.end;for(;!r&&a>0;)a-=1024-s,a<0&&(a=0),e.pos=a,r=Uw(e,xC,1024,!0);if(r){e.skip(9);let o;do o=e.getByte();while(qa(o));let l="";for(;o>=32&&o<=57;)l+=String.fromCharCode(o),o=e.getByte();t=parseInt(l,10),isNaN(t)&&(t=0)}}return Ze(this,"startXRef",t)}checkHeader(){const e=this.stream;if(e.reset(),!Uw(e,bC))return;e.moveStart(),e.skip(bC.length);let t="",i;for(;(i=e.getByte())>32&&t.length<7;)t+=String.fromCharCode(i);aR.test(t)?O(this,tx,t):ce(`Invalid PDF header version: ${t}`)}parseStartXRef(){this.xref.setStartXRef(this.startXRef)}get numPages(){let e=0;return this.catalog.hasActualNumPages?e=this.catalog.numPages:this.xfaFactory?e=this.xfaFactory.getNumPages():this.linearization?e=this.linearization.numPages:e=this.catalog.numPages,Ze(this,"numPages",e)}get _xfaStreams(){const{acroForm:e}=this.catalog;if(!e)return null;const t=e.get("XFA"),i=new Map(["xdp:xdp","template","datasets","config","connectionSet","localeSet","stylesheet","/xdp:xdp"].map(s=>[s,null]));if(t instanceof un&&!t.isEmpty)return i.set("xdp:xdp",t),i;if(!Array.isArray(t)||t.length===0)return null;for(let s=0,r=t.length;s<r;s+=2){let a;if(s===0?a="xdp:xdp":s===r-2?a="/xdp:xdp":a=t[s],!i.has(a))continue;const o=this.xref.fetchIfRef(t[s+1]);!(o instanceof un)||o.isEmpty||i.set(a,o)}return i}get xfaDatasets(){const e=this._xfaStreams;if(!e)return Ze(this,"xfaDatasets",null);for(const t of["datasets","xdp:xdp"]){const i=e.get(t);if(i)try{const s=Lp(i.getString()),r={[t]:s};return Ze(this,"xfaDatasets",new qY(r))}catch{ce("XFA - Invalid utf-8 string.");break}}return Ze(this,"xfaDatasets",null)}get xfaData(){const e=this._xfaStreams;if(!e)return null;const t=Object.create(null);for(const[i,s]of e)if(s)try{t[i]=Lp(s.getString())}catch{return ce("XFA - Invalid utf-8 string."),null}return t}get xfaFactory(){let e;return this.pdfManager.enableXfa&&this.catalog.needsRendering&&this.formInfo.hasXfa&&!this.formInfo.hasAcroForm&&(e=this.xfaData),Ze(this,"xfaFactory",e?new bx(e):null)}get isPureXfa(){return this.xfaFactory?this.xfaFactory.isValid():!1}get htmlForXfa(){return this.xfaFactory?this.xfaFactory.getPages():null}loadXfaResources(e,t){return Promise.all([D(this,Tr,fP).call(this,e,t).catch(()=>{}),D(this,Tr,dP).call(this)])}serializeXfaData(e){return this.xfaFactory?this.xfaFactory.serializeData(e):null}get version(){return this.catalog.version||b(this,tx)}get formInfo(){const e={hasFields:!1,hasAcroForm:!1,hasXfa:!1,hasSignatures:!1},{acroForm:t}=this.catalog;if(!t)return Ze(this,"formInfo",e);try{const i=t.get("Fields"),s=Array.isArray(i)&&i.length>0;e.hasFields=s;const r=t.get("XFA");e.hasXfa=Array.isArray(r)&&r.length>0||r instanceof un&&!r.isEmpty;const o=!!(t.get("SigFlags")&1),l=o&&D(this,Tr,A6).call(this,i);e.hasAcroForm=s&&!l,e.hasSignatures=o}catch(i){if(i instanceof xi)throw i;ce(`Cannot fetch form information: "${i}".`)}return Ze(this,"formInfo",e)}get documentInfo(){var a;const{catalog:e,formInfo:t,xref:i}=this,s={PDFFormatVersion:this.version,Language:e.lang,EncryptFilterName:((a=i.encrypt)==null?void 0:a.filterName)??null,IsLinearized:!!this.linearization,IsAcroFormPresent:t.hasAcroForm,IsXFAPresent:t.hasXfa,IsCollectionPresent:!!e.collection,IsSignaturesPresent:t.hasSignatures};let r;try{r=i.trailer.get("Info")}catch(o){if(o instanceof xi)throw o;gn("The document information dictionary is invalid.")}if(!(r instanceof fe))return Ze(this,"documentInfo",s);for(const[o,l]of r){switch(o){case"Title":case"Author":case"Subject":case"Keywords":case"Creator":case"Producer":case"CreationDate":case"ModDate":if(typeof l=="string"){s[o]=Tn(l);continue}break;case"Trapped":if(l instanceof ve){s[o]=l;continue}break;default:let c;switch(typeof l){case"string":c=Tn(l);break;case"number":case"boolean":c=l;break;default:l instanceof ve&&(c=l);break}if(c===void 0){ce(`Bad value, for custom key "${o}", in Info: ${l}.`);continue}s.Custom??(s.Custom=Object.create(null)),s.Custom[o]=c;continue}ce(`Bad value, for key "${o}", in Info: ${l}.`)}return Ze(this,"documentInfo",s)}get fingerprints(){const t="\0".repeat(16);function i(o){return typeof o=="string"&&o.length===16&&o!==t}const s=this.xref.trailer.get("ID");let r,a;return Array.isArray(s)&&i(s[0])?(r=cr(s[0]),s[1]!==s[0]&&i(s[1])&&(a=cr(s[1]))):r=P0(this.stream.getByteRange(0,1024),0,1024),Ze(this,"fingerprints",[Vv(r),a?Vv(a):null])}getPage(e){const t=b(this,Ih).get(e);if(t)return t;const{catalog:i,linearization:s,xfaFactory:r}=this;let a;return r?a=Promise.resolve([fe.empty,null]):(s==null?void 0:s.pageFirst)===e?a=D(this,Tr,gP).call(this,e):a=i.getPageDict(e),a=a.then(([o,l])=>new pC({pdfManager:this.pdfManager,xref:this.xref,pageIndex:e,pageDict:o,ref:l,globalIdFactory:this._globalIdFactory,fontCache:i.fontCache,builtInCMapCache:i.builtInCMapCache,standardFontDataCache:i.standardFontDataCache,globalColorSpaceCache:i.globalColorSpaceCache,globalImageCache:i.globalImageCache,systemFontCache:i.systemFontCache,nonBlendModesSet:i.nonBlendModesSet,xfaFactory:r})),b(this,Ih).set(e,a),a}async checkFirstPage(e=!1){if(!e)try{await this.getPage(0)}catch(t){if(t instanceof Eh)throw b(this,Ih).delete(0),await this.cleanup(),new t1}}async checkLastPage(e=!1){const{catalog:t,pdfManager:i}=this;t.setActualNumPages();let s;try{if(await Promise.all([i.ensureDoc("xfaFactory"),i.ensureDoc("linearization"),i.ensureCatalog("numPages")]),this.xfaFactory)return;if(this.linearization?s=this.linearization.numPages:s=t.numPages,Number.isInteger(s)){if(s<=1)return}else throw new Te("Page count is not an integer.");await this.getPage(s-1)}catch(r){if(b(this,Ih).delete(s-1),await this.cleanup(),r instanceof Eh&&!e)throw new t1;ce(`checkLastPage - invalid /Pages tree /Count: ${s}.`);let a;try{a=await t.getAllPageDicts(e)}catch(o){if(o instanceof Eh&&!e)throw new t1;t.setActualNumPages(1);return}for(const[o,[l,c]]of a){let h;l instanceof Error?(h=Promise.reject(l),h.catch(()=>{})):h=Promise.resolve(new pC({pdfManager:i,xref:this.xref,pageIndex:o,pageDict:l,ref:c,globalIdFactory:this._globalIdFactory,fontCache:t.fontCache,builtInCMapCache:t.builtInCMapCache,standardFontDataCache:t.standardFontDataCache,globalColorSpaceCache:this.globalColorSpaceCache,globalImageCache:t.globalImageCache,systemFontCache:t.systemFontCache,nonBlendModesSet:t.nonBlendModesSet,xfaFactory:null})),b(this,Ih).set(o,h)}t.setActualNumPages(a.size)}}async fontFallback(e,t){const{catalog:i,pdfManager:s}=this;for(const r of await Promise.all(i.fontCache))if(r.loadedName===e){r.fallback(t,s.evaluatorOptions);return}}async cleanup(e=!1){return this.catalog?this.catalog.cleanup(e):F4()}get fieldObjects(){const e=this.pdfManager.ensureDoc("formInfo").then(async t=>{if(!t.hasFields)return null;const i=await this.annotationGlobals;if(!i)return null;const{acroForm:s}=i,r=new Zi,a=Object.create(null),o=new Map,l=new ca;for(const h of s.get("Fields"))await D(this,Tr,S6).call(this,"",null,h,o,i,r,l);const c=[];for(const[h,u]of o)c.push(Promise.all(u).then(d=>{d=d.filter(f=>!!f),d.length>0&&(a[h]=d)}));return await Promise.all(c),{allFields:x4(a)>0?a:null,orphanFields:l}});return Ze(this,"fieldObjects",e)}get hasJSActions(){const e=this.pdfManager.ensureDoc("_parseHasJSActions");return Ze(this,"hasJSActions",e)}async _parseHasJSActions(){const[e,t]=await Promise.all([this.pdfManager.ensureCatalog("jsActions"),this.pdfManager.ensureDoc("fieldObjects")]);return e?!0:t!=null&&t.allFields?Object.values(t.allFields).some(i=>i.some(s=>s.actions!==null)):!1}get calculationOrderIds(){var i;const e=(i=this.catalog.acroForm)==null?void 0:i.get("CO");if(!Array.isArray(e)||e.length===0)return Ze(this,"calculationOrderIds",null);const t=[];for(const s of e)s instanceof st&&t.push(s.toString());return Ze(this,"calculationOrderIds",t.length?t:null)}get annotationGlobals(){return Ze(this,"annotationGlobals",F0.createGlobals(this.pdfManager))}}Ih=new WeakMap,tx=new WeakMap,Tr=new WeakSet,A6=function(e,t=0){return Array.isArray(e)?e.every(s=>{if(s=this.xref.fetchIfRef(s),!(s instanceof fe))return!1;if(s.has("Kids"))return++t>10?(ce("#hasOnlyDocumentSignatures: maximum recursion depth reached"),!1):D(this,Tr,A6).call(this,s.get("Kids"),t);const r=Di(s.get("FT"),"Sig"),a=s.get("Rect"),o=Array.isArray(a)&&a.every(l=>l===0);return r&&o}):!1},uP=function(e,t,i=new Zi){if(Array.isArray(e))for(let s of e){if(s instanceof st){if(i.has(s))continue;i.put(s)}if(s=this.xref.fetchIfRef(s),!(s instanceof fe))continue;if(s.has("Kids")){D(this,Tr,uP).call(this,s.get("Kids"),t,i);continue}if(!Di(s.get("FT"),"Sig"))continue;const a=s.get("V");if(!(a instanceof fe))continue;const o=a.get("SubFilter");o instanceof ve&&t.add(o.name)}},dP=async function(){const e=await this.pdfManager.ensureCatalog("xfaImages");e&&this.xfaFactory.setImages(e)},fP=async function(e,t){const i=await this.pdfManager.ensureCatalog("acroForm");if(!i)return;const s=await i.getAsync("DR");if(!(s instanceof fe))return;await Pg.load(s,["Font"],this.xref);const r=s.get("Font");if(!(r instanceof fe))return;const a=Object.assign(Object.create(null),this.pdfManager.evaluatorOptions,{useSystemFonts:!1}),{builtInCMapCache:o,fontCache:l,standardFontDataCache:c}=this.catalog,h=new Rg({xref:this.xref,handler:e,pageIndex:-1,idFactory:this._globalIdFactory,fontCache:l,builtInCMapCache:o,standardFontDataCache:c,options:a}),u=new Sr,d=[],f={get font(){return d.at(-1)},set font(y){d.push(y)},clone(){return this}},g=(y,w,_)=>h.handleSetFont(s,[ve.get(y),1],null,u,t,f,w,_).catch(v=>(ce(`loadXfaFonts: "${v}".`),null)),m=[];for(const[y,w]of r){const _=w.get("FontDescriptor");if(!(_ instanceof fe))continue;let v=_.get("FontFamily");v=v.replaceAll(/[ ]+(\d)/g,"$1");const C=_.get("FontWeight"),k=-_.get("ItalicAngle"),I={fontFamily:v,fontWeight:C,italicAngle:k};EU(I)&&m.push(g(y,null,I))}await Promise.all(m);const x=this.xfaFactory.setFonts(d);if(!x)return;a.ignoreErrors=!0,m.length=0,d.length=0;const p=new Set;for(const y of x)N4(`${y}-Regular`)||p.add(y);p.size&&x.push("PdfJS-Fallback");for(const y of x)if(!p.has(y))for(const w of[{name:"Regular",fontWeight:400,italicAngle:0},{name:"Bold",fontWeight:700,italicAngle:0},{name:"Italic",fontWeight:400,italicAngle:12},{name:"BoldItalic",fontWeight:700,italicAngle:12}]){const _=`${y}-${w.name}`;m.push(g(_,XR(_),{fontFamily:y,fontWeight:w.fontWeight,italicAngle:w.italicAngle}))}await Promise.all(m),this.xfaFactory.appendFonts(d,p)},gP=async function(e){const{catalog:t,linearization:i,xref:s}=this,r=st.get(i.objectNumberFirst,0);try{const a=await s.fetchAsync(r);if(a instanceof fe){let o=a.getRaw("Type");if(o instanceof st&&(o=await s.fetchAsync(o)),Di(o,"Page")||!a.has("Type")&&!a.has("Kids")&&a.has("Contents"))return t.pageKidsCountCache.has(r)||t.pageKidsCountCache.put(r,1),t.pageIndexCache.has(r)||t.pageIndexCache.put(r,0),[a,r]}throw new Te("The Linearization dictionary doesn't point to a valid Page dictionary.")}catch(a){return ce(`_getLinearizationPage: "${a.message}".`),t.getPageDict(e)}},S6=async function(e,t,i,s,r,a,o){const{xref:l}=this;if(!(i instanceof st)||a.has(i))return;a.put(i);const c=await l.fetchAsync(i);if(!(c instanceof fe))return;let h=await c.getAsync("Subtype");switch(h=h instanceof ve?h.name:null,h){case"Link":return}if(c.has("T")){const d=Tn(await c.getAsync("T"));e=e===""?d:`${e}.${d}`}else{let d=c;for(;;){if(d=d.getRaw("Parent")||t,d instanceof st){if(a.has(d))break;d=await l.fetchAsync(d)}if(!(d instanceof fe))break;if(d.has("T")){const f=Tn(await d.getAsync("T"));e=e===""?f:`${e}.${f}`;break}}}if(t&&!c.has("Parent")&&Di(c.get("Subtype"),"Widget")&&o.put(i,t),s.has(e)||s.set(e,[]),s.get(e).push(F0.create(l,i,r,null,!0,o,null).then(d=>d==null?void 0:d.getFieldObject()).catch(function(d){return ce(`#collectFieldObjects: "${d}".`),null})),!c.has("Kids"))return;const u=await c.getAsync("Kids");if(Array.isArray(u))for(const d of u)await D(this,Tr,S6).call(this,e,i,d,s,r,a,o)};function pJ(n){if(n){const e=S3(n);if(e)return e.href;ce(`Invalid absolute docBaseUrl: "${n}".`)}return null}class mP{constructor({docBaseUrl:e,docId:t,enableXfa:i,evaluatorOptions:s,handler:r,password:a}){this._docBaseUrl=pJ(e),this._docId=t,this._password=a,this.enableXfa=i,s.isOffscreenCanvasSupported&&(s.isOffscreenCanvasSupported=fa.isOffscreenCanvasSupported),s.isImageDecoderSupported&&(s.isImageDecoderSupported=fa.isImageDecoderSupported),this.evaluatorOptions=Object.freeze(s),Ro.setOptions(s),Eg.setOptions(s),Sr.setOptions(s);const o={...s,handler:r};Go.setOptions(o),Kd.setOptions(o),Up.setOptions(o)}get docId(){return this._docId}get password(){return this._password}get docBaseUrl(){return this._docBaseUrl}ensureDoc(e,t){return this.ensure(this.pdfDocument,e,t)}ensureXRef(e,t){return this.ensure(this.pdfDocument.xref,e,t)}ensureCatalog(e,t){return this.ensure(this.pdfDocument.catalog,e,t)}getPage(e){return this.pdfDocument.getPage(e)}fontFallback(e,t){return this.pdfDocument.fontFallback(e,t)}cleanup(e=!1){return this.pdfDocument.cleanup(e)}async ensure(e,t,i){kn("Abstract method `ensure` called")}requestRange(e,t){kn("Abstract method `requestRange` called")}requestLoadedStream(e=!1){kn("Abstract method `requestLoadedStream` called")}sendProgressiveData(e){kn("Abstract method `sendProgressiveData` called")}updatePassword(e){this._password=e}terminate(e){kn("Abstract method `terminate` called")}}class yC extends mP{constructor(e){super(e);const t=new Hi(e.source);this.pdfDocument=new hP(this,t),this._loadedStreamPromise=Promise.resolve(t)}async ensure(e,t,i){const s=e[t];return typeof s=="function"?s.apply(e,i):s}requestRange(e,t){return Promise.resolve()}requestLoadedStream(e=!1){return this._loadedStreamPromise}terminate(e){}}class bJ extends mP{constructor(e){super(e),this.streamManager=new nH(e.source,{msgHandler:e.handler,length:e.length,disableAutoFetch:e.disableAutoFetch,rangeChunkSize:e.rangeChunkSize}),this.pdfDocument=new hP(this,this.streamManager.getStream())}async ensure(e,t,i){try{const s=e[t];return typeof s=="function"?s.apply(e,i):s}catch(s){if(!(s instanceof xi))throw s;return await this.requestRange(s.begin,s.end),this.ensure(e,t,i)}}requestRange(e,t){return this.streamManager.requestRange(e,t)}requestLoadedStream(e=!1){return this.streamManager.requestAllChunks(e)}sendProgressiveData(e){this.streamManager.onReceiveData({chunk:e})}terminate(e){this.streamManager.abort(e)}}const a9={DATA:1,ERROR:2},us={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function wC(){}function ba(n){if(n instanceof rr||n instanceof Fp||n instanceof Dp||n instanceof jv||n instanceof fw)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||kn('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new rr(n.message);case"InvalidPDFException":return new Fp(n.message);case"PasswordException":return new Dp(n.message,n.code);case"ResponseException":return new jv(n.message,n.status,n.missing);case"UnknownErrorException":return new fw(n.message,n.details)}return new fw(n.message,n.toString())}var Cg,xo,pP,bP,xP,h3;class _C{constructor(e,t,i){B(this,xo);B(this,Cg,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),i.addEventListener("message",D(this,xo,pP).bind(this),{signal:b(this,Cg).signal})}on(e,t){const i=this.actionHandler;if(i[e])throw new Error(`There is already an actionName called "${e}"`);i[e]=t}send(e,t,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},i)}sendWithPromise(e,t,i){const s=this.callbackId++,r=Promise.withResolvers();this.callbackCapabilities[s]=r;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:s,data:t},i)}catch(a){r.reject(a)}return r.promise}sendWithStream(e,t,i,s){const r=this.streamId++,a=this.sourceName,o=this.targetName,l=this.comObj;return new ReadableStream({start:c=>{const h=Promise.withResolvers();return this.streamControllers[r]={controller:c,startCall:h,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:a,targetName:o,action:e,streamId:r,data:t,desiredSize:c.desiredSize},s),h.promise},pull:c=>{const h=Promise.withResolvers();return this.streamControllers[r].pullCall=h,l.postMessage({sourceName:a,targetName:o,stream:us.PULL,streamId:r,desiredSize:c.desiredSize}),h.promise},cancel:c=>{Hs(c instanceof Error,"cancel must have a valid reason");const h=Promise.withResolvers();return this.streamControllers[r].cancelCall=h,this.streamControllers[r].isClosed=!0,l.postMessage({sourceName:a,targetName:o,stream:us.CANCEL,streamId:r,reason:ba(c)}),h.promise}},i)}destroy(){var e;(e=b(this,Cg))==null||e.abort(),O(this,Cg,null)}}Cg=new WeakMap,xo=new WeakSet,pP=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){D(this,xo,xP).call(this,e);return}if(e.callback){const i=e.callbackId,s=this.callbackCapabilities[i];if(!s)throw new Error(`Cannot resolve callback ${i}`);if(delete this.callbackCapabilities[i],e.callback===a9.DATA)s.resolve(e.data);else if(e.callback===a9.ERROR)s.reject(ba(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const i=this.sourceName,s=e.sourceName,r=this.comObj;Promise.try(t,e.data).then(function(a){r.postMessage({sourceName:i,targetName:s,callback:a9.DATA,callbackId:e.callbackId,data:a})},function(a){r.postMessage({sourceName:i,targetName:s,callback:a9.ERROR,callbackId:e.callbackId,reason:ba(a)})});return}if(e.streamId){D(this,xo,bP).call(this,e);return}t(e.data)},bP=function(e){const t=e.streamId,i=this.sourceName,s=e.sourceName,r=this.comObj,a=this,o=this.actionHandler[e.action],l={enqueue(c,h=1,u){if(this.isCancelled)return;const d=this.desiredSize;this.desiredSize-=h,d>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),r.postMessage({sourceName:i,targetName:s,stream:us.ENQUEUE,streamId:t,chunk:c},u)},close(){this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:i,targetName:s,stream:us.CLOSE,streamId:t}),delete a.streamSinks[t])},error(c){Hs(c instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,r.postMessage({sourceName:i,targetName:s,stream:us.ERROR,streamId:t,reason:ba(c)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[t]=l,Promise.try(o,e.data,l).then(function(){r.postMessage({sourceName:i,targetName:s,stream:us.START_COMPLETE,streamId:t,success:!0})},function(c){r.postMessage({sourceName:i,targetName:s,stream:us.START_COMPLETE,streamId:t,reason:ba(c)})})},xP=function(e){const t=e.streamId,i=this.sourceName,s=e.sourceName,r=this.comObj,a=this.streamControllers[t],o=this.streamSinks[t];switch(e.stream){case us.START_COMPLETE:e.success?a.startCall.resolve():a.startCall.reject(ba(e.reason));break;case us.PULL_COMPLETE:e.success?a.pullCall.resolve():a.pullCall.reject(ba(e.reason));break;case us.PULL:if(!o){r.postMessage({sourceName:i,targetName:s,stream:us.PULL_COMPLETE,streamId:t,success:!0});break}o.desiredSize<=0&&e.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=e.desiredSize,Promise.try(o.onPull||wC).then(function(){r.postMessage({sourceName:i,targetName:s,stream:us.PULL_COMPLETE,streamId:t,success:!0})},function(c){r.postMessage({sourceName:i,targetName:s,stream:us.PULL_COMPLETE,streamId:t,reason:ba(c)})});break;case us.ENQUEUE:if(Hs(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(e.chunk);break;case us.CLOSE:if(Hs(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),D(this,xo,h3).call(this,a,t);break;case us.ERROR:Hs(a,"error should have stream controller"),a.controller.error(ba(e.reason)),D(this,xo,h3).call(this,a,t);break;case us.CANCEL_COMPLETE:e.success?a.cancelCall.resolve():a.cancelCall.reject(ba(e.reason)),D(this,xo,h3).call(this,a,t);break;case us.CANCEL:if(!o)break;const l=ba(e.reason);Promise.try(o.onCancel||wC,l).then(function(){r.postMessage({sourceName:i,targetName:s,stream:us.CANCEL_COMPLETE,streamId:t,success:!0})},function(c){r.postMessage({sourceName:i,targetName:s,stream:us.CANCEL_COMPLETE,streamId:t,reason:ba(c)})}),o.sinkCapability.reject(l),o.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},h3=async function(e,t){var i,s,r;await Promise.allSettled([(i=e.startCall)==null?void 0:i.promise,(s=e.pullCall)==null?void 0:s.promise,(r=e.cancelCall)==null?void 0:r.promise]),delete this.streamControllers[t]};async function yP(n,e,t,{encrypt:i=null}){const s=i==null?void 0:i.createCipherTransform(n.num,n.gen);t.push(`${n.num} ${n.gen} obj
`),e instanceof fe?await my(e,t,s):e instanceof un?await wP(e,t,s):(Array.isArray(e)||ArrayBuffer.isView(e))&&await _P(e,t,s),t.push(`
endobj
`)}async function my(n,e,t){e.push("<<");for(const i of n.getKeys())e.push(` /${w4(i)} `),await vP(n.getRaw(i),e,t);e.push(">>")}async function wP(n,e,t){let i=n.getBytes();const{dict:s}=n,[r,a]=await Promise.all([s.getAsync("Filter"),s.getAsync("DecodeParms")]),o=Array.isArray(r)?await s.xref.fetchIfRefAsync(r[0]):r,l=Di(o,"FlateDecode");if(i.length>=256||l)try{const u=new CompressionStream("deflate"),d=u.writable.getWriter();await d.ready,d.write(i).then(async()=>{await d.ready,await d.close()}).catch(()=>{});const f=await new Response(u.readable).arrayBuffer();i=new Uint8Array(f);let g,m;r?l||(g=Array.isArray(r)?[ve.get("FlateDecode"),...r]:[ve.get("FlateDecode"),r],a&&(m=Array.isArray(a)?[null,...a]:[null,a])):g=ve.get("FlateDecode"),g&&s.set("Filter",g),m&&s.set("DecodeParms",m)}catch(u){gn(`writeStream - cannot compress data: "${u}".`)}let h=da(i);t&&(h=t.encryptString(h)),s.set("Length",h.length),await my(s,e,t),e.push(` stream
`,h,`
endstream`)}async function _P(n,e,t){e.push("[");let i=!0;for(const s of n)i?i=!1:e.push(" "),await vP(s,e,t);e.push("]")}async function vP(n,e,t){n instanceof ve?e.push(`/${w4(n.name)}`):n instanceof st?e.push(`${n.num} ${n.gen} R`):Array.isArray(n)||ArrayBuffer.isView(n)?await _P(n,e,t):typeof n=="string"?(t&&(n=t.encryptString(n)),e.push(`(${Ig(n)})`)):typeof n=="number"?e.push(vn(n)):typeof n=="boolean"?e.push(n.toString()):n instanceof fe?await my(n,e,t):n instanceof un?await wP(n,e,t):n===null?e.push("null"):ce(`Unhandled value in writer: ${typeof n}, please file a bug.`)}function Hw(n,e,t,i){for(let s=e+t-1;s>t-1;s--)i[s]=n&255,n>>=8;return t+e}function kP(n,e,t){const i=n.length;for(let s=0;s<i;s++)t[e+s]=n.charCodeAt(s)&255;return e+i}function xJ(n,e){const t=Math.floor(Date.now()/1e3),i=e.filename||"",s=[t.toString(),i,n.toString(),...e.infoMap.values()],r=Math.sumPrecise(s.map(l=>l.length)),a=new Uint8Array(r);let o=0;for(const l of s)o=kP(l,o,a);return da(P0(a,0,a.length))}function yJ(n,e){const t=new sy({hasAttributes:!0}).parseFromString(n);for(const{xfa:s}of e){if(!s)continue;const{path:r,value:a}=s;if(!r)continue;const o=lR(r);let l=t.documentElement.searchNode(o,0);!l&&o.length>1&&(l=t.documentElement.searchNode([o.at(-1)],0)),l?l.childNodes=Array.isArray(a)?a.map(c=>new bp("value",c)):[new bp("#text",a)]:ce(`Node not found for path: ${r}`)}const i=[];return t.documentElement.dump(i),i.join("")}async function wJ({xref:n,acroForm:e,acroFormRef:t,hasXfa:i,hasXfaDatasetsEntry:s,xfaDatasetsRef:r,needAppearances:a,changes:o}){if(i&&!s&&!r&&ce("XFA - Cannot save it"),!a&&(!i||!r||s))return;const l=e.clone();if(i&&!s){const c=e.get("XFA").slice();c.splice(2,0,"datasets"),c.splice(3,0,r),l.set("XFA",c)}a&&l.set("NeedAppearances",!0),o.put(t,{data:l})}function _J({xfaData:n,xfaDatasetsRef:e,changes:t,xref:i}){if(n===null){const r=i.fetchIfRef(e);n=yJ(r.getString(),t)}const s=new Jr(n);s.dict=new fe(i),s.dict.set("Type",ve.get("EmbeddedFile")),t.put(e,{data:s})}async function vJ(n,e,t,i,s){s.push(`xref
`);const r=CP(t);let a=0;for(const{ref:o,data:l}of t)o.num===r[a]&&(s.push(`${r[a]} ${r[a+1]}
`),a+=2),l!==null?(s.push(`${e.toString().padStart(10,"0")} ${Math.min(o.gen,65535).toString().padStart(5,"0")} n\r
`),e+=l.length):s.push(`0000000000 ${Math.min(o.gen+1,65535).toString().padStart(5,"0")} f\r
`);AP(e,n,i),s.push(`trailer
`),await my(i,s),s.push(`
startxref
`,e.toString(),`
%%EOF
`)}function CP(n){const e=[];for(const{ref:t}of n)t.num===e.at(-2)+e.at(-1)?e[e.length-1]+=1:e.push(t.num,1);return e}async function kJ(n,e,t,i,s){const r=[];let a=0,o=0;for(const{ref:m,data:x}of t){let p;a=Math.max(a,e),x!==null?(p=Math.min(m.gen,65535),r.push([1,e,p]),e+=x.length):(p=Math.min(m.gen+1,65535),r.push([0,0,p])),o=Math.max(o,p)}i.set("Index",CP(t));const l=qv(a),c=qv(o),h=[1,l,c];i.set("W",h),AP(e,n,i);const u=Math.sumPrecise(h),d=new Uint8Array(u*r.length),f=new Hi(d);f.dict=i;let g=0;for(const[m,x,p]of r)g=Hw(m,h[0],g,d),g=Hw(x,h[1],g,d),g=Hw(p,h[2],g,d);await yP(n.newRef,f,s,{}),s.push(`startxref
`,e.toString(),`
%%EOF
`)}function AP(n,e,t){if(Array.isArray(e.fileIds)&&e.fileIds.length>0){const i=xJ(n,e);t.set("ID",[e.fileIds[0],i])}}function CJ(n,e,t){const i=new fe(null);i.set("Prev",n.startXRef);const s=n.newRef;return t?(e.put(s,{data:""}),i.set("Size",s.num+1),i.set("Type",ve.get("XRef"))):i.set("Size",s.num),n.rootRef!==null&&i.set("Root",n.rootRef),n.infoRef!==null&&i.set("Info",n.infoRef),n.encryptRef!==null&&i.set("Encrypt",n.encryptRef),i}async function AJ(n,e,t=[]){const i=[];for(const[s,{data:r}]of n.items()){if(r===null||typeof r=="string"){i.push({ref:s,data:r});continue}await yP(s,r,t,e),i.push({ref:s,data:t.join("")}),t.length=0}return i.sort((s,r)=>s.ref.num-r.ref.num)}async function SJ({originalData:n,xrefInfo:e,changes:t,xref:i=null,hasXfa:s=!1,xfaDatasetsRef:r=null,hasXfaDatasetsEntry:a=!1,needAppearances:o,acroFormRef:l=null,acroForm:c=null,xfaData:h=null,useXrefStream:u=!1}){await wJ({xref:i,acroForm:c,acroFormRef:l,hasXfa:s,hasXfaDatasetsEntry:a,xfaDatasetsRef:r,needAppearances:o,changes:t}),s&&_J({xfaData:h,xfaDatasetsRef:r,changes:t,xref:i});const d=CJ(e,t,u),f=[],g=await AJ(t,i,f);let m=n.length;const x=n.at(-1);x!==10&&x!==13&&(f.push(`
`),m+=1);for(const{data:_}of g)_!==null&&f.push(_);await(u?kJ(e,m,g,d,f):vJ(e,m,g,d,f));const p=n.length+Math.sumPrecise(f.map(_=>_.length)),y=new Uint8Array(p);y.set(n);let w=n.length;for(const _ of f)w=kP(_,w,y);return y}class IJ{constructor(e){this._msgHandler=e,this._contentLength=null,this._fullRequestReader=null,this._rangeRequestReaders=[]}getFullReader(){return Hs(!this._fullRequestReader,"PDFWorkerStream.getFullReader can only be called once."),this._fullRequestReader=new EJ(this._msgHandler),this._fullRequestReader}getRangeReader(e,t){const i=new TJ(e,t,this._msgHandler);return this._rangeRequestReaders.push(i),i}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const i of this._rangeRequestReaders.slice(0))i.cancel(e)}}class EJ{constructor(e){this._msgHandler=e,this.onProgress=null,this._contentLength=null,this._isRangeSupported=!1,this._isStreamingSupported=!1;const t=this._msgHandler.sendWithStream("GetReader");this._reader=t.getReader(),this._headersReady=this._msgHandler.sendWithPromise("ReaderHeadersReady").then(i=>{this._isStreamingSupported=i.isStreamingSupported,this._isRangeSupported=i.isRangeSupported,this._contentLength=i.contentLength})}get headersReady(){return this._headersReady}get contentLength(){return this._contentLength}get isStreamingSupported(){return this._isStreamingSupported}get isRangeSupported(){return this._isRangeSupported}async read(){const{value:e,done:t}=await this._reader.read();return t?{value:void 0,done:!0}:{value:e.buffer,done:!1}}cancel(e){this._reader.cancel(e)}}class TJ{constructor(e,t,i){this._msgHandler=i,this.onProgress=null;const s=this._msgHandler.sendWithStream("GetRangeReader",{begin:e,end:t});this._reader=s.getReader()}get isStreamingSupported(){return!1}async read(){const{value:e,done:t}=await this._reader.read();return t?{value:void 0,done:!0}:{value:e.buffer,done:!1}}cancel(e){this._reader.cancel(e)}}class iu{constructor(e){this.name=e,this.terminated=!1,this._capability=Promise.withResolvers()}get finished(){return this._capability.promise}finish(){this._capability.resolve()}terminate(){this.terminated=!0}ensureNotTerminated(){if(this.terminated)throw new Error("Worker task was terminated")}}const J_=class J_{static setup(e,t){let i=!1;e.on("test",s=>{i||(i=!0,e.send("test",s instanceof Uint8Array))}),e.on("configure",s=>{hU(s.verbosity)}),e.on("GetDocRequest",s=>this.createDocumentHandler(s,t))}static createDocumentHandler(e,t){let i,s=!1,r=null;const a=new Set,o=uU(),{docId:l,apiVersion:c}=e,h="5.3.93";if(c!==h)throw new Error(`The API version "${c}" does not match the Worker version "${h}".`);const u=(_,v)=>`The \`${_}.prototype\` contains unexpected enumerable property "${v}", thus breaking e.g. \`for...in\` iteration of ${_}s.`;for(const _ in{})throw new Error(u("Object",_));for(const _ in[])throw new Error(u("Array",_));const d=l+"_worker";let f=new _C(d,l,t);function g(){if(s)throw new Error("Worker was terminated")}function m(_){a.add(_)}function x(_){_.finish(),a.delete(_)}async function p(_){await i.ensureDoc("checkHeader"),await i.ensureDoc("parseStartXRef"),await i.ensureDoc("parse",[_]),await i.ensureDoc("checkFirstPage",[_]),await i.ensureDoc("checkLastPage",[_]);const v=await i.ensureDoc("isPureXfa");if(v){const S=new iu("loadXfaResources");m(S),await i.ensureDoc("loadXfaResources",[f,S]),x(S)}const[C,k]=await Promise.all([i.ensureDoc("numPages"),i.ensureDoc("fingerprints")]),I=v?await i.ensureDoc("htmlForXfa"):null;return{numPages:C,fingerprints:k,htmlForXfa:I}}async function y({data:_,password:v,disableAutoFetch:C,rangeChunkSize:k,length:I,docBaseUrl:S,enableXfa:M,evaluatorOptions:N}){const F={source:null,disableAutoFetch:C,docBaseUrl:S,docId:l,enableXfa:M,evaluatorOptions:N,handler:f,length:I,password:v,rangeChunkSize:k};if(_)return F.source=_,new yC(F);const H=new IJ(f),T=H.getFullReader(),z=Promise.withResolvers();let R,L=[],Y=0;return T.headersReady.then(function(){if(T.isRangeSupported){F.source=H,F.length=T.contentLength,F.disableAutoFetch||(F.disableAutoFetch=T.isStreamingSupported),R=new bJ(F);for(const j of L)R.sendProgressiveData(j);L=[],z.resolve(R),r=null}}).catch(function(j){z.reject(j),r=null}),new Promise(function(j,J){const G=function({value:se,done:de}){try{if(g(),de){if(!R){const he=oR(L);L=[],I&&he.length!==I&&ce("reported HTTP length is different from actual"),F.source=he,R=new yC(F),z.resolve(R)}r=null;return}Y+=se.byteLength,T.isStreamingSupported||f.send("DocProgress",{loaded:Y,total:Math.max(Y,T.contentLength||0)}),R?R.sendProgressiveData(se):L.push(se),T.read().then(G,J)}catch(he){J(he)}};T.read().then(G,J)}).catch(function(j){z.reject(j),r=null}),r=j=>{H.cancelAllRequests(j)},z.promise}function w(_){function v(I){g(),f.send("GetDoc",{pdfInfo:I})}function C(I){if(g(),I instanceof Dp){const S=new iu(`PasswordException: response ${I.code}`);m(S),f.sendWithPromise("PasswordRequest",I).then(function({password:M}){x(S),i.updatePassword(M),k()}).catch(function(){x(S),f.send("DocException",I)})}else f.send("DocException",ba(I))}function k(){g(),p(!1).then(v,function(I){if(g(),!(I instanceof t1)){C(I);return}i.requestLoadedStream().then(function(){g(),p(!0).then(v,C)})})}g(),y(_).then(function(I){if(s)throw I.terminate(new rr("Worker was terminated.")),new Error("Worker was terminated");i=I,i.requestLoadedStream(!0).then(S=>{f.send("DataLoaded",{length:S.bytes.byteLength})})}).then(k,C)}return f.on("GetPage",function(_){return i.getPage(_.pageIndex).then(function(v){return Promise.all([i.ensure(v,"rotate"),i.ensure(v,"ref"),i.ensure(v,"userUnit"),i.ensure(v,"view")]).then(function([C,k,I,S]){return{rotate:C,ref:k,refStr:(k==null?void 0:k.toString())??null,userUnit:I,view:S}})})}),f.on("GetPageIndex",function(_){const v=st.get(_.num,_.gen);return i.ensureCatalog("getPageIndex",[v])}),f.on("GetDestinations",function(_){return i.ensureCatalog("destinations")}),f.on("GetDestination",function(_){return i.ensureCatalog("getDestination",[_.id])}),f.on("GetPageLabels",function(_){return i.ensureCatalog("pageLabels")}),f.on("GetPageLayout",function(_){return i.ensureCatalog("pageLayout")}),f.on("GetPageMode",function(_){return i.ensureCatalog("pageMode")}),f.on("GetViewerPreferences",function(_){return i.ensureCatalog("viewerPreferences")}),f.on("GetOpenAction",function(_){return i.ensureCatalog("openAction")}),f.on("GetAttachments",function(_){return i.ensureCatalog("attachments")}),f.on("GetDocJSActions",function(_){return i.ensureCatalog("jsActions")}),f.on("GetPageJSActions",function({pageIndex:_}){return i.getPage(_).then(v=>i.ensure(v,"jsActions"))}),f.on("GetOutline",function(_){return i.ensureCatalog("documentOutline")}),f.on("GetOptionalContentConfig",function(_){return i.ensureCatalog("optionalContentConfig")}),f.on("GetPermissions",function(_){return i.ensureCatalog("permissions")}),f.on("GetMetadata",function(_){return Promise.all([i.ensureDoc("documentInfo"),i.ensureCatalog("metadata")])}),f.on("GetMarkInfo",function(_){return i.ensureCatalog("markInfo")}),f.on("GetData",function(_){return i.requestLoadedStream().then(v=>v.bytes)}),f.on("GetAnnotations",function({pageIndex:_,intent:v}){return i.getPage(_).then(function(C){const k=new iu(`GetAnnotations: page ${_}`);return m(k),C.getAnnotationsData(f,k,v).then(I=>(x(k),I),I=>{throw x(k),I})})}),f.on("GetFieldObjects",function(_){return i.ensureDoc("fieldObjects").then(v=>(v==null?void 0:v.allFields)||null)}),f.on("HasJSActions",function(_){return i.ensureDoc("hasJSActions")}),f.on("GetCalculationOrderIds",function(_){return i.ensureDoc("calculationOrderIds")}),f.on("SaveDocument",async function({isPureXfa:_,numPages:v,annotationStorage:C,filename:k}){const I=[i.requestLoadedStream(),i.ensureCatalog("acroForm"),i.ensureCatalog("acroFormRef"),i.ensureDoc("startXRef"),i.ensureDoc("xref"),i.ensureDoc("linearization"),i.ensureCatalog("structTreeRoot")],S=new ca,M=[],N=_?null:hR(C),[F,H,T,z,R,L,Y]=await Promise.all(I),j=R.trailer.getRaw("Root")||null;let J;if(N){Y?await Y.canUpdateStructTree({pdfManager:i,newAnnotationsByPage:N})&&(J=Y):await Kp.canCreateStructureTree({catalogRef:j,pdfManager:i,newAnnotationsByPage:N})&&(J=null);const V=F0.generateImages(C.values(),R,i.evaluatorOptions.isOffscreenCanvasSupported),re=J===void 0?M:[];for(const[X,ue]of N)re.push(i.getPage(X).then(oe=>{const Q=new iu(`Save (editor): page ${X}`);return m(Q),oe.saveNewAnnotations(f,Q,ue,V,S).finally(function(){x(Q)})}));J===null?M.push(Promise.all(re).then(async()=>{await Kp.createStructureTree({newAnnotationsByPage:N,xref:R,catalogRef:j,pdfManager:i,changes:S})})):J&&M.push(Promise.all(re).then(async()=>{await J.updateStructureTree({newAnnotationsByPage:N,pdfManager:i,changes:S})}))}if(_)M.push(i.ensureDoc("serializeXfaData",[C]));else for(let V=0;V<v;V++)M.push(i.getPage(V).then(function(re){const X=new iu(`Save: page ${V}`);return m(X),re.save(f,X,C,S).finally(function(){x(X)})}));const G=await Promise.all(M);let se=null;if(_){if(se=G[0],!se)return F.bytes}else if(S.size===0)return F.bytes;const de=T&&H instanceof fe&&S.values().some(V=>V.needAppearances),he=H instanceof fe&&H.get("XFA")||null;let we=null,ye=!1;if(Array.isArray(he)){for(let V=0,re=he.length;V<re;V+=2)he[V]==="datasets"&&(we=he[V+1],ye=!0);we===null&&(we=R.getNewTemporaryRef())}else he&&ce("Unsupported XFA type.");let P=Object.create(null);if(R.trailer){const V=new Map,re=R.trailer.get("Info")||null;if(re instanceof fe)for(const[X,ue]of re)typeof ue=="string"&&V.set(X,Tn(ue));P={rootRef:j,encryptRef:R.trailer.getRaw("Encrypt")||null,newRef:R.getNewTemporaryRef(),infoRef:R.trailer.getRaw("Info")||null,infoMap:V,fileIds:R.trailer.get("ID")||null,startXRef:L?z:R.lastXRefStreamPos??z,filename:k}}return SJ({originalData:F.bytes,xrefInfo:P,changes:S,xref:R,hasXfa:!!he,xfaDatasetsRef:we,hasXfaDatasetsEntry:ye,needAppearances:de,acroFormRef:T,acroForm:H,xfaData:se,useXrefStream:rR(R.topDict,"XRef")}).finally(()=>{R.resetNewTemporaryRef()})}),f.on("GetOperatorList",function(_,v){const C=_.pageIndex;i.getPage(C).then(function(k){const I=new iu(`GetOperatorList: page ${C}`);m(I);const S=o>=Op.INFOS?Date.now():0;k.getOperatorList({handler:f,sink:v,task:I,intent:_.intent,cacheKey:_.cacheKey,annotationStorage:_.annotationStorage,modifiedIds:_.modifiedIds}).then(function(M){x(I),S&&gn(`page=${C+1} - getOperatorList: time=${Date.now()-S}ms, len=${M.length}`),v.close()},function(M){x(I),!I.terminated&&v.error(M)})})}),f.on("GetTextContent",function(_,v){const{pageIndex:C,includeMarkedContent:k,disableNormalization:I}=_;i.getPage(C).then(function(S){const M=new iu("GetTextContent: page "+C);m(M);const N=o>=Op.INFOS?Date.now():0;S.extractTextContent({handler:f,task:M,sink:v,includeMarkedContent:k,disableNormalization:I}).then(function(){x(M),N&&gn(`page=${C+1} - getTextContent: time=${Date.now()-N}ms`),v.close()},function(F){x(M),!M.terminated&&v.error(F)})})}),f.on("GetStructTree",function(_){return i.getPage(_.pageIndex).then(v=>i.ensure(v,"getStructTree"))}),f.on("FontFallback",function(_){return i.fontFallback(_.id,f)}),f.on("Cleanup",function(_){return i.cleanup(!0)}),f.on("Terminate",function(_){s=!0;const v=[];if(i){i.terminate(new rr("Worker was terminated."));const C=i.cleanup();v.push(C),i=null}else F4();r==null||r(new rr("Worker was terminated."));for(const C of a)v.push(C.finished),C.terminate();return Promise.all(v).then(function(){f.destroy(),f=null})}),f.on("Ready",function(_){w(e),e=null}),d}static initializeFromPort(e){const t=new _C("worker","main",e);this.setup(t,e),t.send("ready",null)}};typeof window>"u"&&!oU&&typeof self<"u"&&typeof self.postMessage=="function"&&"onmessage"in self&&J_.initializeFromPort(self);let I6=J_;globalThis.pdfjsWorker={WorkerMessageHandler:I6};let e2="",t2="";async function RJ(){var t,i;const n=await fetch("/api/config");if(!n.ok)throw new Error("Failed to fetch Google Drive credentials");const e=await n.json();if(e2=(t=e.google_drive)==null?void 0:t.api_key,t2=(i=e.google_drive)==null?void 0:i.client_id,!e2||!t2)throw new Error("Google Drive API credentials not configured")}const MJ=["https://www.googleapis.com/auth/drive.readonly","https://www.googleapis.com/auth/drive.file"],PJ=()=>{if(!e2||!t2)throw new Error("Google Drive API credentials not configured");if(e2===""||t2==="")throw new Error("Please configure valid Google Drive API credentials")};let o9=null,vC=!1;const NJ=()=>new Promise((n,e)=>{if(typeof gapi>"u"){const t=document.createElement("script");t.src="https://apis.google.com/js/api.js",t.onload=()=>{gapi.load("picker",()=>{n(!0)})},t.onerror=e,document.body.appendChild(t)}else gapi.load("picker",()=>{n(!0)})}),OJ=()=>new Promise((n,e)=>{if(typeof google>"u"){const t=document.createElement("script");t.src="https://accounts.google.com/gsi/client",t.onload=n,t.onerror=e,document.body.appendChild(t)}else n(!0)}),DJ=async()=>o9||new Promise((n,e)=>{google.accounts.oauth2.initTokenClient({client_id:t2,scope:MJ.join(" "),callback:i=>{i.access_token?(o9=i.access_token,n(o9)):e(new Error("Failed to get access token"))},error_callback:i=>{e(new Error(i.message||"OAuth error occurred"))}}).requestAccessToken()}),FJ=async()=>{vC||(await RJ(),PJ(),await Promise.all([NJ(),OJ()]),vC=!0)},LJ=()=>new Promise(async(n,e)=>{try{await FJ();const t=await DJ();if(!t)throw console.error("Failed to get OAuth token"),new Error("Unable to get OAuth token");new google.picker.PickerBuilder().enableFeature(google.picker.Feature.NAV_HIDDEN).enableFeature(google.picker.Feature.MULTISELECT_ENABLED).addView(new google.picker.DocsView().setIncludeFolders(!1).setSelectFolderEnabled(!1).setMimeTypes("application/pdf,text/plain,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.google-apps.document,application/vnd.google-apps.spreadsheet,application/vnd.google-apps.presentation")).setOAuthToken(t).setDeveloperKey(e2).setCallback(async s=>{if(s[google.picker.Response.ACTION]===google.picker.Action.PICKED)try{const r=s[google.picker.Response.DOCUMENTS][0],a=r[google.picker.Document.ID],o=r[google.picker.Document.NAME],l=r[google.picker.Document.URL];if(!a||!o)throw new Error("Required file details missing");const c=r[google.picker.Document.MIME_TYPE];let h,u;c.includes("google-apps")?(c.includes("document")?u="text/plain":c.includes("spreadsheet")?u="text/csv":c.includes("presentation")?u="text/plain":u="application/pdf",h=`https://www.googleapis.com/drive/v3/files/${a}/export?mimeType=${encodeURIComponent(u)}`):h=`https://www.googleapis.com/drive/v3/files/${a}?alt=media`;const d=await fetch(h,{headers:{Authorization:`Bearer ${t}`,Accept:"*/*"}});if(!d.ok){const m=await d.text();throw console.error("Download failed:",{status:d.status,statusText:d.statusText,error:m}),new Error(`Failed to download file (${d.status}): ${m}`)}const f=await d.blob(),g={id:a,name:o,url:h,blob:f,headers:{Authorization:`Bearer ${t}`,Accept:"*/*"}};n(g)}catch(r){e(r)}else s[google.picker.Response.ACTION]===google.picker.Action.CANCEL&&n(null)}).build().setVisible(!0)}catch(t){console.error("Google Drive Picker error:",t),e(t)}});/*! @azure/msal-common v15.2.0 2025-02-18 */const qe={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",NOT_AVAILABLE:"Not Available",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],TOKEN_RESPONSE_TYPE:"token",ID_TOKEN_RESPONSE_TYPE:"id_token",SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},l9={SUCCESS:200,SUCCESS_RANGE_START:200,SUCCESS_RANGE_END:299,REDIRECT:302,CLIENT_ERROR:400,CLIENT_ERROR_RANGE_START:400,BAD_REQUEST:400,UNAUTHORIZED:401,NOT_FOUND:404,REQUEST_TIMEOUT:408,TOO_MANY_REQUESTS:429,CLIENT_ERROR_RANGE_END:499,SERVER_ERROR:500,SERVER_ERROR_RANGE_START:500,SERVICE_UNAVAILABLE:503,GATEWAY_TIMEOUT:504,SERVER_ERROR_RANGE_END:599,MULTI_SIDED_ERROR:600},wx=[qe.OPENID_SCOPE,qe.PROFILE_SCOPE,qe.OFFLINE_ACCESS_SCOPE],kC=[...wx,qe.EMAIL_SCOPE],jr={CONTENT_TYPE:"Content-Type",CONTENT_LENGTH:"Content-Length",RETRY_AFTER:"Retry-After",CCS_HEADER:"X-AnchorMailbox",WWWAuthenticate:"WWW-Authenticate",AuthenticationInfo:"Authentication-Info",X_MS_REQUEST_ID:"x-ms-request-id",X_MS_HTTP_VERSION:"x-ms-httpver"},CC={ACTIVE_ACCOUNT_FILTERS:"active-account-filters"},Dh={COMMON:"common",ORGANIZATIONS:"organizations",CONSUMERS:"consumers"},c9={ACCESS_TOKEN:"access_token",XMS_CC:"xms_cc"},Us={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"},AC={PLAIN:"plain",S256:"S256"},_x={QUERY:"query",FRAGMENT:"fragment"},BJ={..._x,FORM_POST:"form_post"},SP={IMPLICIT_GRANT:"implicit",AUTHORIZATION_CODE_GRANT:"authorization_code",CLIENT_CREDENTIALS_GRANT:"client_credentials",RESOURCE_OWNER_PASSWORD_GRANT:"password",REFRESH_TOKEN_GRANT:"refresh_token",DEVICE_CODE_GRANT:"device_code",JWT_BEARER:"urn:ietf:params:oauth:grant-type:jwt-bearer"},h9={MSSTS_ACCOUNT_TYPE:"MSSTS",ADFS_ACCOUNT_TYPE:"ADFS",MSAV1_ACCOUNT_TYPE:"MSA",GENERIC_ACCOUNT_TYPE:"Generic"},Ar={CACHE_KEY_SEPARATOR:"-",CLIENT_INFO_SEPARATOR:"."},An={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"},$4="appmetadata",UJ="client_info",vp="1",K3={CACHE_KEY:"authority-metadata",REFRESH_TIME_SECONDS:3600*24},xa={CONFIG:"config",CACHE:"cache",NETWORK:"network",HARDCODED_VALUES:"hardcoded_values"},$s={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},gi={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},kp={DEFAULT_THROTTLE_TIME_SECONDS:60,DEFAULT_MAX_THROTTLE_TIME_SECONDS:3600,THROTTLING_PREFIX:"throttling",X_MS_LIB_CAPABILITY_VALUE:"retry-after, h429"},SC={INVALID_GRANT_ERROR:"invalid_grant",CLIENT_MISMATCH_ERROR:"client_mismatch"},IC={username:"username",password:"password"},u9={httpSuccess:200,httpBadRequest:400},xf={FAILED_AUTO_DETECTION:"1",INTERNAL_CACHE:"2",ENVIRONMENT_VARIABLE:"3",IMDS:"4"},zw={CONFIGURED_MATCHES_DETECTED:"1",CONFIGURED_NO_AUTO_DETECTION:"2",CONFIGURED_NOT_DETECTED:"3",AUTO_DETECTION_REQUESTED_SUCCESSFUL:"4",AUTO_DETECTION_REQUESTED_FAILED:"5"},hu={NOT_APPLICABLE:"0",FORCE_REFRESH_OR_CLAIMS:"1",NO_CACHED_ACCESS_TOKEN:"2",CACHED_ACCESS_TOKEN_EXPIRED:"3",PROACTIVELY_REFRESHED:"4"},HJ={Jwt:"JWT",Jwk:"JWK",Pop:"pop"},zJ=300;/*! @azure/msal-common v15.2.0 2025-02-18 */const e_="unexpected_error",jJ="post_request_failed";/*! @azure/msal-common v15.2.0 2025-02-18 */const EC={[e_]:"Unexpected error in authentication.",[jJ]:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."};class Ui extends Error{constructor(e,t,i){const s=t?`${e}: ${t}`:e;super(s),Object.setPrototypeOf(this,Ui.prototype),this.errorCode=e||qe.EMPTY_STRING,this.errorMessage=t||qe.EMPTY_STRING,this.subError=i||qe.EMPTY_STRING,this.name="AuthError"}setCorrelationId(e){this.correlationId=e}}function IP(n,e){return new Ui(n,e?`${EC[n]} ${e}`:EC[n])}/*! @azure/msal-common v15.2.0 2025-02-18 */const t_="client_info_decoding_error",EP="client_info_empty_error",n_="token_parsing_error",TP="null_or_empty_token",pc="endpoints_resolution_error",RP="network_error",MP="openid_config_error",PP="hash_not_deserialized",Lg="invalid_state",NP="state_mismatch",X3="state_not_found",OP="nonce_mismatch",i_="auth_time_not_found",DP="max_age_transpired",GJ="multiple_matching_tokens",VJ="multiple_matching_accounts",FP="multiple_matching_appMetadata",LP="request_cannot_be_made",BP="cannot_remove_empty_scope",UP="cannot_append_scopeset",E6="empty_input_scopeset",qJ="device_code_polling_cancelled",WJ="device_code_expired",KJ="device_code_unknown_error",s_="no_account_in_silent_request",HP="invalid_cache_record",r_="invalid_cache_environment",T6="no_account_found",R6="no_crypto_object",M6="unexpected_credential_type",XJ="invalid_assertion",YJ="invalid_client_credential",Fh="token_refresh_required",JJ="user_timeout_reached",zP="token_claims_cnf_required_for_signedjwt",jP="authorization_code_missing_from_server_response",GP="binding_key_not_removed",VP="end_session_endpoint_not_supported",a_="key_id_missing",ZJ="no_network_connectivity",QJ="user_canceled",$J="missing_tenant_id_error",Pn="method_not_implemented",eZ="nested_app_auth_bridge_disabled";/*! @azure/msal-common v15.2.0 2025-02-18 */const TC={[t_]:"The client info could not be parsed/decoded correctly",[EP]:"The client info was empty",[n_]:"Token cannot be parsed",[TP]:"The token is null or empty",[pc]:"Endpoints cannot be resolved",[RP]:"Network request failed",[MP]:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",[PP]:"The hash parameters could not be deserialized",[Lg]:"State was not the expected format",[NP]:"State mismatch error",[X3]:"State not found",[OP]:"Nonce mismatch error",[i_]:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",[DP]:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",[GJ]:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",[VJ]:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",[FP]:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",[LP]:"Token request cannot be made without authorization code or refresh token.",[BP]:"Cannot remove null or empty scope from ScopeSet",[UP]:"Cannot append ScopeSet",[E6]:"Empty input ScopeSet cannot be processed",[qJ]:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",[WJ]:"Device code is expired.",[KJ]:"Device code stopped polling for unknown reasons.",[s_]:"Please pass an account object, silent flow is not supported without account information",[HP]:"Cache record object was null or undefined.",[r_]:"Invalid environment when attempting to create cache entry",[T6]:"No account found in cache for given key.",[R6]:"No crypto object detected.",[M6]:"Unexpected credential type.",[XJ]:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",[YJ]:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",[Fh]:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",[JJ]:"User defined timeout for device code polling reached",[zP]:"Cannot generate a POP jwt if the token_claims are not populated",[jP]:"Server response does not contain an authorization code to proceed",[GP]:"Could not remove the credential's binding key from storage.",[VP]:"The provided authority does not support logout",[a_]:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",[ZJ]:"No network connectivity. Check your internet connection.",[QJ]:"User cancelled the flow.",[$J]:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow.",[Pn]:"This method has not been implemented",[eZ]:"The nested app auth bridge is disabled"};class o_ extends Ui{constructor(e,t){super(e,t?`${TC[e]}: ${t}`:TC[e]),this.name="ClientAuthError",Object.setPrototypeOf(this,o_.prototype)}}function gt(n,e){return new o_(n,e)}/*! @azure/msal-common v15.2.0 2025-02-18 */const Y3={createNewGuid:()=>{throw gt(Pn)},base64Decode:()=>{throw gt(Pn)},base64Encode:()=>{throw gt(Pn)},base64UrlEncode:()=>{throw gt(Pn)},encodeKid:()=>{throw gt(Pn)},async getPublicKeyThumbprint(){throw gt(Pn)},async removeTokenBindingKey(){throw gt(Pn)},async clearKeystore(){throw gt(Pn)},async signJwt(){throw gt(Pn)},async hashString(){throw gt(Pn)}};/*! @azure/msal-common v15.2.0 2025-02-18 */var Ni;(function(n){n[n.Error=0]="Error",n[n.Warning=1]="Warning",n[n.Info=2]="Info",n[n.Verbose=3]="Verbose",n[n.Trace=4]="Trace"})(Ni||(Ni={}));class jh{constructor(e,t,i){this.level=Ni.Info;const s=()=>{},r=e||jh.createDefaultLoggerOptions();this.localCallback=r.loggerCallback||s,this.piiLoggingEnabled=r.piiLoggingEnabled||!1,this.level=typeof r.logLevel=="number"?r.logLevel:Ni.Info,this.correlationId=r.correlationId||qe.EMPTY_STRING,this.packageName=t||qe.EMPTY_STRING,this.packageVersion=i||qe.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:Ni.Info}}clone(e,t,i){return new jh({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:i||this.correlationId},e,t)}logMessage(e,t){if(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)return;const r=`${`[${new Date().toUTCString()}] : [${t.correlationId||this.correlationId||""}]`} : ${this.packageName}@${this.packageVersion} : ${Ni[t.logLevel]} - ${e}`;this.executeCallback(t.logLevel,r,t.containsPii||!1)}executeCallback(e,t,i){this.localCallback&&this.localCallback(e,t,i)}error(e,t){this.logMessage(e,{logLevel:Ni.Error,containsPii:!1,correlationId:t||qe.EMPTY_STRING})}errorPii(e,t){this.logMessage(e,{logLevel:Ni.Error,containsPii:!0,correlationId:t||qe.EMPTY_STRING})}warning(e,t){this.logMessage(e,{logLevel:Ni.Warning,containsPii:!1,correlationId:t||qe.EMPTY_STRING})}warningPii(e,t){this.logMessage(e,{logLevel:Ni.Warning,containsPii:!0,correlationId:t||qe.EMPTY_STRING})}info(e,t){this.logMessage(e,{logLevel:Ni.Info,containsPii:!1,correlationId:t||qe.EMPTY_STRING})}infoPii(e,t){this.logMessage(e,{logLevel:Ni.Info,containsPii:!0,correlationId:t||qe.EMPTY_STRING})}verbose(e,t){this.logMessage(e,{logLevel:Ni.Verbose,containsPii:!1,correlationId:t||qe.EMPTY_STRING})}verbosePii(e,t){this.logMessage(e,{logLevel:Ni.Verbose,containsPii:!0,correlationId:t||qe.EMPTY_STRING})}trace(e,t){this.logMessage(e,{logLevel:Ni.Trace,containsPii:!1,correlationId:t||qe.EMPTY_STRING})}tracePii(e,t){this.logMessage(e,{logLevel:Ni.Trace,containsPii:!0,correlationId:t||qe.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}}/*! @azure/msal-common v15.2.0 2025-02-18 */const qP="@azure/msal-common",l_="15.2.0";/*! @azure/msal-common v15.2.0 2025-02-18 */const c_={None:"none",AzurePublic:"https://login.microsoftonline.com",AzurePpe:"https://login.windows-ppe.net",AzureChina:"https://login.chinacloudapi.cn",AzureGermany:"https://login.microsoftonline.de",AzureUsGovernment:"https://login.microsoftonline.us"};/*! @azure/msal-common v15.2.0 2025-02-18 */function Qg(n,e){const t=tZ(n);try{const i=e(t);return JSON.parse(i)}catch{throw gt(n_)}}function tZ(n){if(!n)throw gt(TP);const t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(n);if(!t||t.length<4)throw gt(n_);return t[2]}function WP(n,e){if(e===0||Date.now()-3e5>n+e)throw gt(DP)}/*! @azure/msal-common v15.2.0 2025-02-18 */function ac(){return Math.round(new Date().getTime()/1e3)}function P6(n,e){const t=Number(n)||0;return ac()+e>t}function nZ(n){return Number(n)>ac()}/*! @azure/msal-common v15.2.0 2025-02-18 */function Cp(n){return[aZ(n),oZ(n),lZ(n),cZ(n),hZ(n)].join(Ar.CACHE_KEY_SEPARATOR).toLowerCase()}function py(n,e,t,i,s){return{credentialType:An.ID_TOKEN,homeAccountId:n,environment:e,clientId:i,secret:t,realm:s}}function by(n,e,t,i,s,r,a,o,l,c,h,u,d,f,g){var x,p;const m={homeAccountId:n,credentialType:An.ACCESS_TOKEN,secret:t,cachedAt:ac().toString(),expiresOn:a.toString(),extendedExpiresOn:o.toString(),environment:e,clientId:i,realm:s,target:r,tokenType:h||gi.BEARER};if(u&&(m.userAssertionHash=u),c&&(m.refreshOn=c.toString()),f&&(m.requestedClaims=f,m.requestedClaimsHash=g),((x=m.tokenType)==null?void 0:x.toLowerCase())!==gi.BEARER.toLowerCase())switch(m.credentialType=An.ACCESS_TOKEN_WITH_AUTH_SCHEME,m.tokenType){case gi.POP:const y=Qg(t,l);if(!((p=y==null?void 0:y.cnf)!=null&&p.kid))throw gt(zP);m.keyId=y.cnf.kid;break;case gi.SSH:m.keyId=d}return m}function KP(n,e,t,i,s,r,a){const o={credentialType:An.REFRESH_TOKEN,homeAccountId:n,environment:e,clientId:i,secret:t};return r&&(o.userAssertionHash=r),s&&(o.familyId=s),a&&(o.expiresOn=a.toString()),o}function h_(n){return n.hasOwnProperty("homeAccountId")&&n.hasOwnProperty("environment")&&n.hasOwnProperty("credentialType")&&n.hasOwnProperty("clientId")&&n.hasOwnProperty("secret")}function iZ(n){return n?h_(n)&&n.hasOwnProperty("realm")&&n.hasOwnProperty("target")&&(n.credentialType===An.ACCESS_TOKEN||n.credentialType===An.ACCESS_TOKEN_WITH_AUTH_SCHEME):!1}function sZ(n){return n?h_(n)&&n.hasOwnProperty("realm")&&n.credentialType===An.ID_TOKEN:!1}function rZ(n){return n?h_(n)&&n.credentialType===An.REFRESH_TOKEN:!1}function aZ(n){return[n.homeAccountId,n.environment].join(Ar.CACHE_KEY_SEPARATOR).toLowerCase()}function oZ(n){const e=n.credentialType===An.REFRESH_TOKEN&&n.familyId||n.clientId;return[n.credentialType,e,n.realm||""].join(Ar.CACHE_KEY_SEPARATOR).toLowerCase()}function lZ(n){return(n.target||"").toLowerCase()}function cZ(n){return(n.requestedClaimsHash||"").toLowerCase()}function hZ(n){return n.tokenType&&n.tokenType.toLowerCase()!==gi.BEARER.toLowerCase()?n.tokenType.toLowerCase():""}function uZ(n,e){const t=n.indexOf($s.CACHE_KEY)===0;let i=!0;return e&&(i=e.hasOwnProperty("failedRequests")&&e.hasOwnProperty("errors")&&e.hasOwnProperty("cacheHits")),t&&i}function dZ(n,e){let t=!1;n&&(t=n.indexOf(kp.THROTTLING_PREFIX)===0);let i=!0;return e&&(i=e.hasOwnProperty("throttleTime")),t&&i}function fZ({environment:n,clientId:e}){return[$4,n,e].join(Ar.CACHE_KEY_SEPARATOR).toLowerCase()}function gZ(n,e){return e?n.indexOf($4)===0&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("environment"):!1}function mZ(n,e){return e?n.indexOf(K3.CACHE_KEY)===0&&e.hasOwnProperty("aliases")&&e.hasOwnProperty("preferred_cache")&&e.hasOwnProperty("preferred_network")&&e.hasOwnProperty("canonical_authority")&&e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("aliasesFromNetwork")&&e.hasOwnProperty("endpointsFromNetwork")&&e.hasOwnProperty("expiresAt")&&e.hasOwnProperty("jwks_uri"):!1}function RC(){return ac()+K3.REFRESH_TIME_SECONDS}function d9(n,e,t){n.authorization_endpoint=e.authorization_endpoint,n.token_endpoint=e.token_endpoint,n.end_session_endpoint=e.end_session_endpoint,n.issuer=e.issuer,n.endpointsFromNetwork=t,n.jwks_uri=e.jwks_uri}function jw(n,e,t){n.aliases=e.aliases,n.preferred_cache=e.preferred_cache,n.preferred_network=e.preferred_network,n.aliasesFromNetwork=t}function MC(n){return n.expiresAt<=ac()}/*! @azure/msal-common v15.2.0 2025-02-18 */const XP="redirect_uri_empty",pZ="claims_request_parsing_error",YP="authority_uri_insecure",fp="url_parse_error",JP="empty_url_error",ZP="empty_input_scopes_error",QP="invalid_prompt_value",u_="invalid_claims",$P="token_request_empty",eN="logout_request_empty",tN="invalid_code_challenge_method",d_="pkce_params_missing",f_="invalid_cloud_discovery_metadata",nN="invalid_authority_metadata",iN="untrusted_authority",xy="missing_ssh_jwk",sN="missing_ssh_kid",bZ="missing_nonce_authentication_header",xZ="invalid_authentication_header",rN="cannot_set_OIDCOptions",aN="cannot_allow_platform_broker",oN="authority_mismatch";/*! @azure/msal-common v15.2.0 2025-02-18 */const yZ={[XP]:"A redirect URI is required for all calls, and none has been set.",[pZ]:"Could not parse the given claims request object.",[YP]:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",[fp]:"URL could not be parsed into appropriate segments.",[JP]:"URL was empty or null.",[ZP]:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",[QP]:"Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest",[u_]:"Given claims parameter must be a stringified JSON object.",[$P]:"Token request was empty and not found in cache.",[eN]:"The logout request was null or undefined.",[tN]:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".',[d_]:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",[f_]:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",[nN]:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",[iN]:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",[xy]:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",[sN]:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",[bZ]:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",[xZ]:"Invalid authentication header provided",[rN]:"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.",[aN]:"Cannot set allowPlatformBroker parameter to true when not in AAD protocol mode.",[oN]:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority."};class g_ extends Ui{constructor(e){super(e,yZ[e]),this.name="ClientConfigurationError",Object.setPrototypeOf(this,g_.prototype)}}function yi(n){return new g_(n)}/*! @azure/msal-common v15.2.0 2025-02-18 */class tc{static isEmptyObj(e){if(e)try{const t=JSON.parse(e);return Object.keys(t).length===0}catch{}return!0}static startsWith(e,t){return e.indexOf(t)===0}static endsWith(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length}static queryStringToObject(e){const t={},i=e.split("&"),s=r=>decodeURIComponent(r.replace(/\+/g," "));return i.forEach(r=>{if(r.trim()){const[a,o]=r.split(/=(.+)/g,2);a&&o&&(t[s(a)]=s(o))}}),t}static trimArrayEntries(e){return e.map(t=>t.trim())}static removeEmptyStringsFromArray(e){return e.filter(t=>!!t)}static jsonParseHelper(e){try{return JSON.parse(e)}catch{return null}}static matchPattern(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)}}/*! @azure/msal-common v15.2.0 2025-02-18 */class rs{constructor(e){const t=e?tc.trimArrayEntries([...e]):[],i=t?tc.removeEmptyStringsFromArray(t):[];if(!i||!i.length)throw yi(ZP);this.scopes=new Set,i.forEach(s=>this.scopes.add(s))}static fromString(e){const i=(e||qe.EMPTY_STRING).split(" ");return new rs(i)}static createSearchScopes(e){const t=new rs(e);return t.containsOnlyOIDCScopes()?t.removeScope(qe.OFFLINE_ACCESS_SCOPE):t.removeOIDCScopes(),t}containsScope(e){const t=this.printScopesLowerCase().split(" "),i=new rs(t);return e?i.scopes.has(e.toLowerCase()):!1}containsScopeSet(e){return!e||e.scopes.size<=0?!1:this.scopes.size>=e.scopes.size&&e.asArray().every(t=>this.containsScope(t))}containsOnlyOIDCScopes(){let e=0;return kC.forEach(t=>{this.containsScope(t)&&(e+=1)}),this.scopes.size===e}appendScope(e){e&&this.scopes.add(e.trim())}appendScopes(e){try{e.forEach(t=>this.appendScope(t))}catch{throw gt(UP)}}removeScope(e){if(!e)throw gt(BP);this.scopes.delete(e.trim())}removeOIDCScopes(){kC.forEach(e=>{this.scopes.delete(e)})}unionScopeSets(e){if(!e)throw gt(E6);const t=new Set;return e.scopes.forEach(i=>t.add(i.toLowerCase())),this.scopes.forEach(i=>t.add(i.toLowerCase())),t}intersectingScopeSets(e){if(!e)throw gt(E6);e.containsOnlyOIDCScopes()||e.removeOIDCScopes();const t=this.unionScopeSets(e),i=e.getScopeCount(),s=this.getScopeCount();return t.size<s+i}getScopeCount(){return this.scopes.size}asArray(){const e=[];return this.scopes.forEach(t=>e.push(t)),e}printScopes(){return this.scopes?this.asArray().join(" "):qe.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}}/*! @azure/msal-common v15.2.0 2025-02-18 */function J3(n,e){if(!n)throw gt(EP);try{const t=e(n);return JSON.parse(t)}catch{throw gt(t_)}}function Uf(n){if(!n)throw gt(t_);const e=n.split(Ar.CLIENT_INFO_SEPARATOR,2);return{uid:e[0],utid:e.length<2?qe.EMPTY_STRING:e[1]}}/*! @azure/msal-common v15.2.0 2025-02-18 */function PC(n,e){return!!n&&!!e&&n===e.split(".")[1]}function m_(n,e,t,i){if(i){const{oid:s,sub:r,tid:a,name:o,tfp:l,acr:c}=i,h=a||l||c||"";return{tenantId:h,localAccountId:s||r||"",name:o,isHomeTenant:PC(h,n)}}else return{tenantId:t,localAccountId:e,isHomeTenant:PC(t,n)}}function p_(n,e,t,i){let s=n;if(e){const{isHomeTenant:r,...a}=e;s={...n,...a}}if(t){const{isHomeTenant:r,...a}=m_(n.homeAccountId,n.localAccountId,n.tenantId,t);return s={...s,...a,idTokenClaims:t,idToken:i},s}return s}/*! @azure/msal-common v15.2.0 2025-02-18 */const qo={Default:0,Adfs:1,Dsts:2,Ciam:3};/*! @azure/msal-common v15.2.0 2025-02-18 */function lN(n){return n&&(n.tid||n.tfp||n.acr)||null}/*! @azure/msal-common v15.2.0 2025-02-18 */const h0={AAD:"AAD",OIDC:"OIDC"};/*! @azure/msal-common v15.2.0 2025-02-18 */class Xr{generateAccountId(){return[this.homeAccountId,this.environment].join(Ar.CACHE_KEY_SEPARATOR).toLowerCase()}generateAccountKey(){return Xr.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})}getAccountInfo(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,nativeAccountId:this.nativeAccountId,authorityType:this.authorityType,tenantProfiles:new Map((this.tenantProfiles||[]).map(e=>[e.tenantId,e]))}}isSingleTenant(){return!this.tenantProfiles}static generateAccountCacheKey(e){const t=e.homeAccountId.split(".")[1];return[e.homeAccountId,e.environment||"",t||e.tenantId||""].join(Ar.CACHE_KEY_SEPARATOR).toLowerCase()}static createAccount(e,t,i){var c,h,u,d,f,g;const s=new Xr;t.authorityType===qo.Adfs?s.authorityType=h9.ADFS_ACCOUNT_TYPE:t.protocolMode===h0.AAD?s.authorityType=h9.MSSTS_ACCOUNT_TYPE:s.authorityType=h9.GENERIC_ACCOUNT_TYPE;let r;e.clientInfo&&i&&(r=J3(e.clientInfo,i)),s.clientInfo=e.clientInfo,s.homeAccountId=e.homeAccountId,s.nativeAccountId=e.nativeAccountId;const a=e.environment||t&&t.getPreferredCache();if(!a)throw gt(r_);s.environment=a,s.realm=(r==null?void 0:r.utid)||lN(e.idTokenClaims)||"",s.localAccountId=(r==null?void 0:r.uid)||((c=e.idTokenClaims)==null?void 0:c.oid)||((h=e.idTokenClaims)==null?void 0:h.sub)||"";const o=((u=e.idTokenClaims)==null?void 0:u.preferred_username)||((d=e.idTokenClaims)==null?void 0:d.upn),l=(f=e.idTokenClaims)!=null&&f.emails?e.idTokenClaims.emails[0]:null;if(s.username=o||l||"",s.name=((g=e.idTokenClaims)==null?void 0:g.name)||"",s.cloudGraphHostName=e.cloudGraphHostName,s.msGraphHost=e.msGraphHost,e.tenantProfiles)s.tenantProfiles=e.tenantProfiles;else{const m=m_(e.homeAccountId,s.localAccountId,s.realm,e.idTokenClaims);s.tenantProfiles=[m]}return s}static createFromAccountInfo(e,t,i){var r;const s=new Xr;return s.authorityType=e.authorityType||h9.GENERIC_ACCOUNT_TYPE,s.homeAccountId=e.homeAccountId,s.localAccountId=e.localAccountId,s.nativeAccountId=e.nativeAccountId,s.realm=e.tenantId,s.environment=e.environment,s.username=e.username,s.name=e.name,s.cloudGraphHostName=t,s.msGraphHost=i,s.tenantProfiles=Array.from(((r=e.tenantProfiles)==null?void 0:r.values())||[]),s}static generateHomeAccountId(e,t,i,s,r){if(!(t===qo.Adfs||t===qo.Dsts)){if(e)try{const a=J3(e,s.base64Decode);if(a.uid&&a.utid)return`${a.uid}.${a.utid}`}catch{}i.warning("No client info in response")}return(r==null?void 0:r.sub)||""}static isAccountEntity(e){return e?e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"):!1}static accountInfoIsEqual(e,t,i){if(!e||!t)return!1;let s=!0;if(i){const r=e.idTokenClaims||{},a=t.idTokenClaims||{};s=r.iat===a.iat&&r.nonce===a.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&s}}/*! @azure/msal-common v15.2.0 2025-02-18 */function cN(n){return n.startsWith("#/")?n.substring(2):n.startsWith("#")||n.startsWith("?")?n.substring(1):n}function Z3(n){if(!n||n.indexOf("=")<0)return null;try{const e=cN(n),t=Object.fromEntries(new URLSearchParams(e));if(t.code||t.error||t.error_description||t.state)return t}catch{throw gt(PP)}return null}/*! @azure/msal-common v15.2.0 2025-02-18 */class Jn{get urlString(){return this._urlString}constructor(e){if(this._urlString=e,!this._urlString)throw yi(JP);e.includes("#")||(this._urlString=Jn.canonicalizeUri(e))}static canonicalizeUri(e){if(e){let t=e.toLowerCase();return tc.endsWith(t,"?")?t=t.slice(0,-1):tc.endsWith(t,"?/")&&(t=t.slice(0,-2)),tc.endsWith(t,"/")||(t+="/"),t}return e}validateAsUri(){let e;try{e=this.getUrlComponents()}catch{throw yi(fp)}if(!e.HostNameAndPort||!e.PathSegments)throw yi(fp);if(!e.Protocol||e.Protocol.toLowerCase()!=="https:")throw yi(YP)}static appendQueryString(e,t){return t?e.indexOf("?")<0?`${e}?${t}`:`${e}&${t}`:e}static removeHashFromUrl(e){return Jn.canonicalizeUri(e.split("#")[0])}replaceTenantPath(e){const t=this.getUrlComponents(),i=t.PathSegments;return e&&i.length!==0&&(i[0]===Dh.COMMON||i[0]===Dh.ORGANIZATIONS)&&(i[0]=e),Jn.constructAuthorityUriFromObject(t)}getUrlComponents(){const e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw yi(fp);const i={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]};let s=i.AbsolutePath.split("/");return s=s.filter(r=>r&&r.length>0),i.PathSegments=s,i.QueryString&&i.QueryString.endsWith("/")&&(i.QueryString=i.QueryString.substring(0,i.QueryString.length-1)),i}static getDomainFromUrl(e){const t=RegExp("^([^:/?#]+://)?([^/?#]*)"),i=e.match(t);if(!i)throw yi(fp);return i[2]}static getAbsoluteUrl(e,t){if(e[0]===qe.FORWARD_SLASH){const s=new Jn(t).getUrlComponents();return s.Protocol+"//"+s.HostNameAndPort+e}return e}static constructAuthorityUriFromObject(e){return new Jn(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))}static hashContainsKnownProperties(e){return!!Z3(e)}}/*! @azure/msal-common v15.2.0 2025-02-18 */const hN={endpointMetadata:{"login.microsoftonline.com":{token_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.com/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/logout"},"login.chinacloudapi.cn":{token_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.chinacloudapi.cn/{tenantid}/discovery/v2.0/keys",issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",authorization_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/logout"},"login.microsoftonline.us":{token_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.us/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/logout"}},instanceDiscoveryMetadata:{tenant_discovery_endpoint:"https://{canonicalAuthority}/v2.0/.well-known/openid-configuration",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]}},NC=hN.endpointMetadata,b_=hN.instanceDiscoveryMetadata,uN=new Set;b_.metadata.forEach(n=>{n.aliases.forEach(e=>{uN.add(e)})});function wZ(n,e){var s;let t;const i=n.canonicalAuthority;if(i){const r=new Jn(i).getUrlComponents().HostNameAndPort;t=OC(r,(s=n.cloudDiscoveryMetadata)==null?void 0:s.metadata,xa.CONFIG,e)||OC(r,b_.metadata,xa.HARDCODED_VALUES,e)||n.knownAuthorities}return t||[]}function OC(n,e,t,i){if(i==null||i.trace(`getAliasesFromMetadata called with source: ${t}`),n&&e){const s=Q3(e,n);if(s)return i==null||i.trace(`getAliasesFromMetadata: found cloud discovery metadata in ${t}, returning aliases`),s.aliases;i==null||i.trace(`getAliasesFromMetadata: did not find cloud discovery metadata in ${t}`)}return null}function _Z(n){return Q3(b_.metadata,n)}function Q3(n,e){for(let t=0;t<n.length;t++){const i=n[t];if(i.aliases.includes(e))return i}return null}/*! @azure/msal-common v15.2.0 2025-02-18 */const dN="cache_quota_exceeded",x_="cache_error_unknown";/*! @azure/msal-common v15.2.0 2025-02-18 */const Gw={[dN]:"Exceeded cache storage capacity.",[x_]:"Unexpected error occurred when using cache storage."};class o1 extends Error{constructor(e,t){const i=t||(Gw[e]?Gw[e]:Gw[x_]);super(`${e}: ${i}`),Object.setPrototypeOf(this,o1.prototype),this.name="CacheError",this.errorCode=e,this.errorMessage=i}}/*! @azure/msal-common v15.2.0 2025-02-18 */class N6{constructor(e,t,i,s){this.clientId=e,this.cryptoImpl=t,this.commonLogger=i.clone(qP,l_),this.staticAuthorityOptions=s}getAllAccounts(e){return this.buildTenantProfiles(this.getAccountsFilteredBy(e||{}),e)}getAccountInfoFilteredBy(e){const t=this.getAllAccounts(e);return t.length>1?t.sort(s=>s.idTokenClaims?-1:1)[0]:t.length===1?t[0]:null}getBaseAccountInfo(e){const t=this.getAccountsFilteredBy(e);return t.length>0?t[0].getAccountInfo():null}buildTenantProfiles(e,t){return e.flatMap(i=>this.getTenantProfilesFromAccountEntity(i,t==null?void 0:t.tenantId,t))}getTenantedAccountInfoByFilter(e,t,i,s){let r=null,a;if(s&&!this.tenantProfileMatchesFilter(i,s))return null;const o=this.getIdToken(e,t,i.tenantId);return o&&(a=Qg(o.secret,this.cryptoImpl.base64Decode),!this.idTokenClaimsMatchTenantProfileFilter(a,s))?null:(r=p_(e,i,a,o==null?void 0:o.secret),r)}getTenantProfilesFromAccountEntity(e,t,i){const s=e.getAccountInfo();let r=s.tenantProfiles||new Map;const a=this.getTokenKeys();if(t){const l=r.get(t);if(l)r=new Map([[t,l]]);else return[]}const o=[];return r.forEach(l=>{const c=this.getTenantedAccountInfoByFilter(s,a,l,i);c&&o.push(c)}),o}tenantProfileMatchesFilter(e,t){return!(t.localAccountId&&!this.matchLocalAccountIdFromTenantProfile(e,t.localAccountId)||t.name&&e.name!==t.name||t.isHomeTenant!==void 0&&e.isHomeTenant!==t.isHomeTenant)}idTokenClaimsMatchTenantProfileFilter(e,t){return!(t&&(t.localAccountId&&!this.matchLocalAccountIdFromTokenClaims(e,t.localAccountId)||t.loginHint&&!this.matchLoginHintFromTokenClaims(e,t.loginHint)||t.username&&!this.matchUsername(e.preferred_username,t.username)||t.name&&!this.matchName(e,t.name)||t.sid&&!this.matchSid(e,t.sid)))}async saveCacheRecord(e,t,i){var s,r,a,o;if(!e)throw gt(HP);try{e.account&&await this.setAccount(e.account,t),e.idToken&&(i==null?void 0:i.idToken)!==!1&&await this.setIdTokenCredential(e.idToken,t),e.accessToken&&(i==null?void 0:i.accessToken)!==!1&&await this.saveAccessToken(e.accessToken,t),e.refreshToken&&(i==null?void 0:i.refreshToken)!==!1&&await this.setRefreshTokenCredential(e.refreshToken,t),e.appMetadata&&this.setAppMetadata(e.appMetadata)}catch(l){throw(s=this.commonLogger)==null||s.error("CacheManager.saveCacheRecord: failed"),l instanceof Error?((r=this.commonLogger)==null||r.errorPii(`CacheManager.saveCacheRecord: ${l.message}`,t),l.name==="QuotaExceededError"||l.name==="NS_ERROR_DOM_QUOTA_REACHED"||l.message.includes("exceeded the quota")?((a=this.commonLogger)==null||a.error("CacheManager.saveCacheRecord: exceeded storage quota",t),new o1(dN)):new o1(l.name,l.message)):((o=this.commonLogger)==null||o.errorPii(`CacheManager.saveCacheRecord: ${l}`,t),new o1(x_))}}async saveAccessToken(e,t){const i={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},s=this.getTokenKeys(),r=rs.fromString(e.target),a=[];s.accessToken.forEach(o=>{if(!this.accessTokenKeyMatchesFilter(o,i,!1))return;const l=this.getAccessTokenCredential(o);l&&this.credentialMatchesFilter(l,i)&&rs.fromString(l.target).intersectingScopeSets(r)&&a.push(this.removeAccessToken(o))}),await Promise.all(a),await this.setAccessTokenCredential(e,t)}getAccountsFilteredBy(e){const t=this.getAccountKeys(),i=[];return t.forEach(s=>{var l;if(!this.isAccountKey(s,e.homeAccountId))return;const r=this.getAccount(s,this.commonLogger);if(!r||e.homeAccountId&&!this.matchHomeAccountId(r,e.homeAccountId)||e.username&&!this.matchUsername(r.username,e.username)||e.environment&&!this.matchEnvironment(r,e.environment)||e.realm&&!this.matchRealm(r,e.realm)||e.nativeAccountId&&!this.matchNativeAccountId(r,e.nativeAccountId)||e.authorityType&&!this.matchAuthorityType(r,e.authorityType))return;const a={localAccountId:e==null?void 0:e.localAccountId,name:e==null?void 0:e.name},o=(l=r.tenantProfiles)==null?void 0:l.filter(c=>this.tenantProfileMatchesFilter(c,a));o&&o.length===0||i.push(r)}),i}isAccountKey(e,t,i){return!(e.split(Ar.CACHE_KEY_SEPARATOR).length<3||t&&!e.toLowerCase().includes(t.toLowerCase())||i&&!e.toLowerCase().includes(i.toLowerCase()))}isCredentialKey(e){if(e.split(Ar.CACHE_KEY_SEPARATOR).length<6)return!1;const t=e.toLowerCase();if(t.indexOf(An.ID_TOKEN.toLowerCase())===-1&&t.indexOf(An.ACCESS_TOKEN.toLowerCase())===-1&&t.indexOf(An.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())===-1&&t.indexOf(An.REFRESH_TOKEN.toLowerCase())===-1)return!1;if(t.indexOf(An.REFRESH_TOKEN.toLowerCase())>-1){const i=`${An.REFRESH_TOKEN}${Ar.CACHE_KEY_SEPARATOR}${this.clientId}${Ar.CACHE_KEY_SEPARATOR}`,s=`${An.REFRESH_TOKEN}${Ar.CACHE_KEY_SEPARATOR}${vp}${Ar.CACHE_KEY_SEPARATOR}`;if(t.indexOf(i.toLowerCase())===-1&&t.indexOf(s.toLowerCase())===-1)return!1}else if(t.indexOf(this.clientId.toLowerCase())===-1)return!1;return!0}credentialMatchesFilter(e,t){return!(t.clientId&&!this.matchClientId(e,t.clientId)||t.userAssertionHash&&!this.matchUserAssertionHash(e,t.userAssertionHash)||typeof t.homeAccountId=="string"&&!this.matchHomeAccountId(e,t.homeAccountId)||t.environment&&!this.matchEnvironment(e,t.environment)||t.realm&&!this.matchRealm(e,t.realm)||t.credentialType&&!this.matchCredentialType(e,t.credentialType)||t.familyId&&!this.matchFamilyId(e,t.familyId)||t.target&&!this.matchTarget(e,t.target)||(t.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==t.requestedClaimsHash||e.credentialType===An.ACCESS_TOKEN_WITH_AUTH_SCHEME&&(t.tokenType&&!this.matchTokenType(e,t.tokenType)||t.tokenType===gi.SSH&&t.keyId&&!this.matchKeyId(e,t.keyId)))}getAppMetadataFilteredBy(e){const t=this.getKeys(),i={};return t.forEach(s=>{if(!this.isAppMetadata(s))return;const r=this.getAppMetadata(s);r&&(e.environment&&!this.matchEnvironment(r,e.environment)||e.clientId&&!this.matchClientId(r,e.clientId)||(i[s]=r))}),i}getAuthorityMetadataByAlias(e){const t=this.getAuthorityMetadataKeys();let i=null;return t.forEach(s=>{if(!this.isAuthorityMetadata(s)||s.indexOf(this.clientId)===-1)return;const r=this.getAuthorityMetadata(s);r&&r.aliases.indexOf(e)!==-1&&(i=r)}),i}async removeAllAccounts(){const e=this.getAccountKeys(),t=[];e.forEach(i=>{t.push(this.removeAccount(i))}),await Promise.all(t)}async removeAccount(e){const t=this.getAccount(e,this.commonLogger);t&&(await this.removeAccountContext(t),this.removeItem(e))}async removeAccountContext(e){const t=this.getTokenKeys(),i=e.generateAccountId(),s=[];t.idToken.forEach(r=>{r.indexOf(i)===0&&this.removeIdToken(r)}),t.accessToken.forEach(r=>{r.indexOf(i)===0&&s.push(this.removeAccessToken(r))}),t.refreshToken.forEach(r=>{r.indexOf(i)===0&&this.removeRefreshToken(r)}),await Promise.all(s)}async removeAccessToken(e){const t=this.getAccessTokenCredential(e);if(t){if(t.credentialType.toLowerCase()===An.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()&&t.tokenType===gi.POP){const s=t.keyId;if(s)try{await this.cryptoImpl.removeTokenBindingKey(s)}catch{throw gt(GP)}}return this.removeItem(e)}}removeAppMetadata(){return this.getKeys().forEach(t=>{this.isAppMetadata(t)&&this.removeItem(t)}),!0}readAccountFromCache(e){const t=Xr.generateAccountCacheKey(e);return this.getAccount(t,this.commonLogger)}getIdToken(e,t,i,s,r){this.commonLogger.trace("CacheManager - getIdToken called");const a={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:An.ID_TOKEN,clientId:this.clientId,realm:i},o=this.getIdTokensByFilter(a,t),l=o.size;if(l<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(l>1){let c=o;if(!i){const h=new Map;o.forEach((d,f)=>{d.realm===e.tenantId&&h.set(f,d)});const u=h.size;if(u<1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account but none match account entity tenant id, returning first result"),o.values().next().value;if(u===1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account, defaulting to home tenant profile"),h.values().next().value;c=h}return this.commonLogger.info("CacheManager:getIdToken - Multiple matching ID tokens found, clearing them"),c.forEach((h,u)=>{this.removeIdToken(u)}),s&&r&&s.addFields({multiMatchedID:o.size},r),null}return this.commonLogger.info("CacheManager:getIdToken - Returning ID token"),o.values().next().value}getIdTokensByFilter(e,t){const i=t&&t.idToken||this.getTokenKeys().idToken,s=new Map;return i.forEach(r=>{if(!this.idTokenKeyMatchesFilter(r,{clientId:this.clientId,...e}))return;const a=this.getIdTokenCredential(r);a&&this.credentialMatchesFilter(a,e)&&s.set(r,a)}),s}idTokenKeyMatchesFilter(e,t){const i=e.toLowerCase();return!(t.clientId&&i.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&i.indexOf(t.homeAccountId.toLowerCase())===-1)}removeIdToken(e){this.removeItem(e)}removeRefreshToken(e){this.removeItem(e)}getAccessToken(e,t,i,s,r,a){this.commonLogger.trace("CacheManager - getAccessToken called");const o=rs.createSearchScopes(t.scopes),l=t.authenticationScheme||gi.BEARER,c=l&&l.toLowerCase()!==gi.BEARER.toLowerCase()?An.ACCESS_TOKEN_WITH_AUTH_SCHEME:An.ACCESS_TOKEN,h={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:c,clientId:this.clientId,realm:s||e.tenantId,target:o,tokenType:l,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash},u=i&&i.accessToken||this.getTokenKeys().accessToken,d=[];u.forEach(g=>{if(this.accessTokenKeyMatchesFilter(g,h,!0)){const m=this.getAccessTokenCredential(g);m&&this.credentialMatchesFilter(m,h)&&d.push(m)}});const f=d.length;return f<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found"),null):f>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them"),d.forEach(g=>{this.removeAccessToken(Cp(g))}),r&&a&&r.addFields({multiMatchedAT:d.length},a),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token"),d[0])}accessTokenKeyMatchesFilter(e,t,i){const s=e.toLowerCase();if(t.clientId&&s.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&s.indexOf(t.homeAccountId.toLowerCase())===-1||t.realm&&s.indexOf(t.realm.toLowerCase())===-1||t.requestedClaimsHash&&s.indexOf(t.requestedClaimsHash.toLowerCase())===-1)return!1;if(t.target){const r=t.target.asArray();for(let a=0;a<r.length;a++){if(i&&!s.includes(r[a].toLowerCase()))return!1;if(!i&&s.includes(r[a].toLowerCase()))return!0}}return!0}getAccessTokensByFilter(e){const t=this.getTokenKeys(),i=[];return t.accessToken.forEach(s=>{if(!this.accessTokenKeyMatchesFilter(s,e,!0))return;const r=this.getAccessTokenCredential(s);r&&this.credentialMatchesFilter(r,e)&&i.push(r)}),i}getRefreshToken(e,t,i,s,r){this.commonLogger.trace("CacheManager - getRefreshToken called");const a=t?vp:void 0,o={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:An.REFRESH_TOKEN,clientId:this.clientId,familyId:a},l=i&&i.refreshToken||this.getTokenKeys().refreshToken,c=[];l.forEach(u=>{if(this.refreshTokenKeyMatchesFilter(u,o)){const d=this.getRefreshTokenCredential(u);d&&this.credentialMatchesFilter(d,o)&&c.push(d)}});const h=c.length;return h<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(h>1&&s&&r&&s.addFields({multiMatchedRT:h},r),this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),c[0])}refreshTokenKeyMatchesFilter(e,t){const i=e.toLowerCase();return!(t.familyId&&i.indexOf(t.familyId.toLowerCase())===-1||!t.familyId&&t.clientId&&i.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&i.indexOf(t.homeAccountId.toLowerCase())===-1)}readAppMetadataFromCache(e){const t={environment:e,clientId:this.clientId},i=this.getAppMetadataFilteredBy(t),s=Object.keys(i).map(a=>i[a]),r=s.length;if(r<1)return null;if(r>1)throw gt(FP);return s[0]}isAppMetadataFOCI(e){const t=this.readAppMetadataFromCache(e);return!!(t&&t.familyId===vp)}matchHomeAccountId(e,t){return typeof e.homeAccountId=="string"&&t===e.homeAccountId}matchLocalAccountIdFromTokenClaims(e,t){const i=e.oid||e.sub;return t===i}matchLocalAccountIdFromTenantProfile(e,t){return e.localAccountId===t}matchName(e,t){var i;return t.toLowerCase()===((i=e.name)==null?void 0:i.toLowerCase())}matchUsername(e,t){return!!(e&&typeof e=="string"&&(t==null?void 0:t.toLowerCase())===e.toLowerCase())}matchUserAssertionHash(e,t){return!!(e.userAssertionHash&&t===e.userAssertionHash)}matchEnvironment(e,t){if(this.staticAuthorityOptions){const s=wZ(this.staticAuthorityOptions,this.commonLogger);if(s.includes(t)&&s.includes(e.environment))return!0}const i=this.getAuthorityMetadataByAlias(t);return!!(i&&i.aliases.indexOf(e.environment)>-1)}matchCredentialType(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()}matchClientId(e,t){return!!(e.clientId&&t===e.clientId)}matchFamilyId(e,t){return!!(e.familyId&&t===e.familyId)}matchRealm(e,t){var i;return((i=e.realm)==null?void 0:i.toLowerCase())===t.toLowerCase()}matchNativeAccountId(e,t){return!!(e.nativeAccountId&&t===e.nativeAccountId)}matchLoginHintFromTokenClaims(e,t){return e.login_hint===t||e.preferred_username===t||e.upn===t}matchSid(e,t){return e.sid===t}matchAuthorityType(e,t){return!!(e.authorityType&&t.toLowerCase()===e.authorityType.toLowerCase())}matchTarget(e,t){return e.credentialType!==An.ACCESS_TOKEN&&e.credentialType!==An.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target?!1:rs.fromString(e.target).containsScopeSet(t)}matchTokenType(e,t){return!!(e.tokenType&&e.tokenType===t)}matchKeyId(e,t){return!!(e.keyId&&e.keyId===t)}isAppMetadata(e){return e.indexOf($4)!==-1}isAuthorityMetadata(e){return e.indexOf(K3.CACHE_KEY)!==-1}generateAuthorityMetadataCacheKey(e){return`${K3.CACHE_KEY}-${this.clientId}-${e}`}static toObject(e,t){for(const i in t)e[i]=t[i];return e}}class vZ extends N6{async setAccount(){throw gt(Pn)}getAccount(){throw gt(Pn)}async setIdTokenCredential(){throw gt(Pn)}getIdTokenCredential(){throw gt(Pn)}async setAccessTokenCredential(){throw gt(Pn)}getAccessTokenCredential(){throw gt(Pn)}async setRefreshTokenCredential(){throw gt(Pn)}getRefreshTokenCredential(){throw gt(Pn)}setAppMetadata(){throw gt(Pn)}getAppMetadata(){throw gt(Pn)}setServerTelemetry(){throw gt(Pn)}getServerTelemetry(){throw gt(Pn)}setAuthorityMetadata(){throw gt(Pn)}getAuthorityMetadata(){throw gt(Pn)}getAuthorityMetadataKeys(){throw gt(Pn)}setThrottlingCache(){throw gt(Pn)}getThrottlingCache(){throw gt(Pn)}removeItem(){throw gt(Pn)}getKeys(){throw gt(Pn)}getAccountKeys(){throw gt(Pn)}getTokenKeys(){throw gt(Pn)}}/*! @azure/msal-common v15.2.0 2025-02-18 */const fN={tokenRenewalOffsetSeconds:zJ,preventCorsPreflight:!1},kZ={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:Ni.Info,correlationId:qe.EMPTY_STRING},CZ={claimsBasedCachingEnabled:!1},AZ={async sendGetRequestAsync(){throw gt(Pn)},async sendPostRequestAsync(){throw gt(Pn)}},SZ={sku:qe.SKU,version:l_,cpu:qe.EMPTY_STRING,os:qe.EMPTY_STRING},IZ={clientSecret:qe.EMPTY_STRING,clientAssertion:void 0},EZ={azureCloudInstance:c_.None,tenant:`${qe.DEFAULT_COMMON_TENANT}`},TZ={application:{appName:"",appVersion:""}};function RZ({authOptions:n,systemOptions:e,loggerOptions:t,cacheOptions:i,storageInterface:s,networkInterface:r,cryptoInterface:a,clientCredentials:o,libraryInfo:l,telemetry:c,serverTelemetryManager:h,persistencePlugin:u,serializableCache:d}){const f={...kZ,...t};return{authOptions:MZ(n),systemOptions:{...fN,...e},loggerOptions:f,cacheOptions:{...CZ,...i},storageInterface:s||new vZ(n.clientId,Y3,new jh(f)),networkInterface:r||AZ,cryptoInterface:a||Y3,clientCredentials:o||IZ,libraryInfo:{...SZ,...l},telemetry:{...TZ,...c},serverTelemetryManager:h||null,persistencePlugin:u||null,serializableCache:d||null}}function MZ(n){return{clientCapabilities:[],azureCloudOptions:EZ,skipAuthorityMetadataCache:!1,instanceAware:!1,...n}}function O6(n){return n.authOptions.authority.options.protocolMode===h0.OIDC}/*! @azure/msal-common v15.2.0 2025-02-18 */const Va={HOME_ACCOUNT_ID:"home_account_id",UPN:"UPN"};/*! @azure/msal-common v15.2.0 2025-02-18 */const Zd="client_id",gN="redirect_uri",DC="response_type",PZ="response_mode",NZ="grant_type",OZ="claims",DZ="scope",FZ="refresh_token",LZ="state",BZ="nonce",UZ="prompt",HZ="code",zZ="code_challenge",jZ="code_challenge_method",GZ="code_verifier",VZ="client-request-id",qZ="x-client-SKU",WZ="x-client-VER",KZ="x-client-OS",XZ="x-client-CPU",YZ="x-client-current-telemetry",JZ="x-client-last-telemetry",ZZ="x-ms-lib-capability",QZ="x-app-name",$Z="x-app-ver",eQ="post_logout_redirect_uri",tQ="id_token_hint",nQ="device_code",iQ="client_secret",sQ="client_assertion",rQ="client_assertion_type",FC="token_type",LC="req_cnf",aQ="assertion",oQ="requested_token_use",BC="return_spa_code",lQ="nativebroker",cQ="logout_hint",hQ="sid",uQ="login_hint",dQ="domain_hint",fQ="x-client-xtra-sku",y_="brk_client_id",D6="brk_redirect_uri";/*! @azure/msal-common v15.2.0 2025-02-18 */class Nf{static validateRedirectUri(e){if(!e)throw yi(XP)}static validatePrompt(e){const t=[];for(const i in Us)t.push(Us[i]);if(t.indexOf(e)<0)throw yi(QP)}static validateClaims(e){try{JSON.parse(e)}catch{throw yi(u_)}}static validateCodeChallengeParams(e,t){if(!e||!t)throw yi(d_);this.validateCodeChallengeMethod(t)}static validateCodeChallengeMethod(e){if([AC.PLAIN,AC.S256].indexOf(e)<0)throw yi(tN)}}/*! @azure/msal-common v15.2.0 2025-02-18 */function gQ(n,e,t){if(!e)return;const i=n.get(Zd);i&&n.has(y_)&&(t==null||t.addFields({embeddedClientId:i,embeddedRedirectUri:n.get(gN)},e))}class Ap{constructor(e,t){this.parameters=new Map,this.performanceClient=t,this.correlationId=e}addResponseTypeCode(){this.parameters.set(DC,encodeURIComponent(qe.CODE_RESPONSE_TYPE))}addResponseTypeForTokenAndIdToken(){this.parameters.set(DC,encodeURIComponent(`${qe.TOKEN_RESPONSE_TYPE} ${qe.ID_TOKEN_RESPONSE_TYPE}`))}addResponseMode(e){this.parameters.set(PZ,encodeURIComponent(e||BJ.QUERY))}addNativeBroker(){this.parameters.set(lQ,encodeURIComponent("1"))}addScopes(e,t=!0,i=wx){t&&!i.includes("openid")&&!e.includes("openid")&&i.push("openid");const s=t?[...e||[],...i]:e||[],r=new rs(s);this.parameters.set(DZ,encodeURIComponent(r.printScopes()))}addClientId(e){this.parameters.set(Zd,encodeURIComponent(e))}addRedirectUri(e){Nf.validateRedirectUri(e),this.parameters.set(gN,encodeURIComponent(e))}addPostLogoutRedirectUri(e){Nf.validateRedirectUri(e),this.parameters.set(eQ,encodeURIComponent(e))}addIdTokenHint(e){this.parameters.set(tQ,encodeURIComponent(e))}addDomainHint(e){this.parameters.set(dQ,encodeURIComponent(e))}addLoginHint(e){this.parameters.set(uQ,encodeURIComponent(e))}addCcsUpn(e){this.parameters.set(jr.CCS_HEADER,encodeURIComponent(`UPN:${e}`))}addCcsOid(e){this.parameters.set(jr.CCS_HEADER,encodeURIComponent(`Oid:${e.uid}@${e.utid}`))}addSid(e){this.parameters.set(hQ,encodeURIComponent(e))}addClaims(e,t){const i=this.addClientCapabilitiesToClaims(e,t);Nf.validateClaims(i),this.parameters.set(OZ,encodeURIComponent(i))}addCorrelationId(e){this.parameters.set(VZ,encodeURIComponent(e))}addLibraryInfo(e){this.parameters.set(qZ,e.sku),this.parameters.set(WZ,e.version),e.os&&this.parameters.set(KZ,e.os),e.cpu&&this.parameters.set(XZ,e.cpu)}addApplicationTelemetry(e){e!=null&&e.appName&&this.parameters.set(QZ,e.appName),e!=null&&e.appVersion&&this.parameters.set($Z,e.appVersion)}addPrompt(e){Nf.validatePrompt(e),this.parameters.set(`${UZ}`,encodeURIComponent(e))}addState(e){e&&this.parameters.set(LZ,encodeURIComponent(e))}addNonce(e){this.parameters.set(BZ,encodeURIComponent(e))}addCodeChallengeParams(e,t){if(Nf.validateCodeChallengeParams(e,t),e&&t)this.parameters.set(zZ,encodeURIComponent(e)),this.parameters.set(jZ,encodeURIComponent(t));else throw yi(d_)}addAuthorizationCode(e){this.parameters.set(HZ,encodeURIComponent(e))}addDeviceCode(e){this.parameters.set(nQ,encodeURIComponent(e))}addRefreshToken(e){this.parameters.set(FZ,encodeURIComponent(e))}addCodeVerifier(e){this.parameters.set(GZ,encodeURIComponent(e))}addClientSecret(e){this.parameters.set(iQ,encodeURIComponent(e))}addClientAssertion(e){e&&this.parameters.set(sQ,encodeURIComponent(e))}addClientAssertionType(e){e&&this.parameters.set(rQ,encodeURIComponent(e))}addOboAssertion(e){this.parameters.set(aQ,encodeURIComponent(e))}addRequestTokenUse(e){this.parameters.set(oQ,encodeURIComponent(e))}addGrantType(e){this.parameters.set(NZ,encodeURIComponent(e))}addClientInfo(){this.parameters.set(UJ,"1")}addExtraQueryParameters(e){Object.entries(e).forEach(([t,i])=>{!this.parameters.has(t)&&i&&this.parameters.set(t,i)})}addClientCapabilitiesToClaims(e,t){let i;if(!e)i={};else try{i=JSON.parse(e)}catch{throw yi(u_)}return t&&t.length>0&&(i.hasOwnProperty(c9.ACCESS_TOKEN)||(i[c9.ACCESS_TOKEN]={}),i[c9.ACCESS_TOKEN][c9.XMS_CC]={values:t}),JSON.stringify(i)}addUsername(e){this.parameters.set(IC.username,encodeURIComponent(e))}addPassword(e){this.parameters.set(IC.password,encodeURIComponent(e))}addPopToken(e){e&&(this.parameters.set(FC,gi.POP),this.parameters.set(LC,encodeURIComponent(e)))}addSshJwk(e){e&&(this.parameters.set(FC,gi.SSH),this.parameters.set(LC,encodeURIComponent(e)))}addServerTelemetry(e){this.parameters.set(YZ,e.generateCurrentRequestHeaderValue()),this.parameters.set(JZ,e.generateLastRequestHeaderValue())}addThrottling(){this.parameters.set(ZZ,kp.X_MS_LIB_CAPABILITY_VALUE)}addLogoutHint(e){this.parameters.set(cQ,encodeURIComponent(e))}addBrokerParameters(e){const t={};t[y_]=e.brokerClientId,t[D6]=e.brokerRedirectUri,this.addExtraQueryParameters(t)}createQueryString(){const e=new Array;return this.parameters.forEach((t,i)=>{e.push(`${i}=${t}`)}),gQ(this.parameters,this.correlationId,this.performanceClient),e.join("&")}}/*! @azure/msal-common v15.2.0 2025-02-18 */function mQ(n){return n.hasOwnProperty("authorization_endpoint")&&n.hasOwnProperty("token_endpoint")&&n.hasOwnProperty("issuer")&&n.hasOwnProperty("jwks_uri")}/*! @azure/msal-common v15.2.0 2025-02-18 */function pQ(n){return n.hasOwnProperty("tenant_discovery_endpoint")&&n.hasOwnProperty("metadata")}/*! @azure/msal-common v15.2.0 2025-02-18 */function bQ(n){return n.hasOwnProperty("error")&&n.hasOwnProperty("error_description")}/*! @azure/msal-common v15.2.0 2025-02-18 */const Ie={AcquireTokenByCode:"acquireTokenByCode",AcquireTokenByRefreshToken:"acquireTokenByRefreshToken",AcquireTokenSilent:"acquireTokenSilent",AcquireTokenSilentAsync:"acquireTokenSilentAsync",AcquireTokenPopup:"acquireTokenPopup",AcquireTokenPreRedirect:"acquireTokenPreRedirect",AcquireTokenRedirect:"acquireTokenRedirect",CryptoOptsGetPublicKeyThumbprint:"cryptoOptsGetPublicKeyThumbprint",CryptoOptsSignJwt:"cryptoOptsSignJwt",SilentCacheClientAcquireToken:"silentCacheClientAcquireToken",SilentIframeClientAcquireToken:"silentIframeClientAcquireToken",AwaitConcurrentIframe:"awaitConcurrentIframe",SilentRefreshClientAcquireToken:"silentRefreshClientAcquireToken",SsoSilent:"ssoSilent",StandardInteractionClientGetDiscoveredAuthority:"standardInteractionClientGetDiscoveredAuthority",FetchAccountIdWithNativeBroker:"fetchAccountIdWithNativeBroker",NativeInteractionClientAcquireToken:"nativeInteractionClientAcquireToken",BaseClientCreateTokenRequestHeaders:"baseClientCreateTokenRequestHeaders",NetworkClientSendPostRequestAsync:"networkClientSendPostRequestAsync",RefreshTokenClientExecutePostToTokenEndpoint:"refreshTokenClientExecutePostToTokenEndpoint",AuthorizationCodeClientExecutePostToTokenEndpoint:"authorizationCodeClientExecutePostToTokenEndpoint",BrokerHandhshake:"brokerHandshake",AcquireTokenByRefreshTokenInBroker:"acquireTokenByRefreshTokenInBroker",AcquireTokenByBroker:"acquireTokenByBroker",RefreshTokenClientExecuteTokenRequest:"refreshTokenClientExecuteTokenRequest",RefreshTokenClientAcquireToken:"refreshTokenClientAcquireToken",RefreshTokenClientAcquireTokenWithCachedRefreshToken:"refreshTokenClientAcquireTokenWithCachedRefreshToken",RefreshTokenClientAcquireTokenByRefreshToken:"refreshTokenClientAcquireTokenByRefreshToken",RefreshTokenClientCreateTokenRequestBody:"refreshTokenClientCreateTokenRequestBody",AcquireTokenFromCache:"acquireTokenFromCache",SilentFlowClientAcquireCachedToken:"silentFlowClientAcquireCachedToken",SilentFlowClientGenerateResultFromCacheRecord:"silentFlowClientGenerateResultFromCacheRecord",AcquireTokenBySilentIframe:"acquireTokenBySilentIframe",InitializeBaseRequest:"initializeBaseRequest",InitializeSilentRequest:"initializeSilentRequest",InitializeClientApplication:"initializeClientApplication",InitializeCache:"initializeCache",SilentIframeClientTokenHelper:"silentIframeClientTokenHelper",SilentHandlerInitiateAuthRequest:"silentHandlerInitiateAuthRequest",SilentHandlerMonitorIframeForHash:"silentHandlerMonitorIframeForHash",SilentHandlerLoadFrame:"silentHandlerLoadFrame",SilentHandlerLoadFrameSync:"silentHandlerLoadFrameSync",StandardInteractionClientCreateAuthCodeClient:"standardInteractionClientCreateAuthCodeClient",StandardInteractionClientGetClientConfiguration:"standardInteractionClientGetClientConfiguration",StandardInteractionClientInitializeAuthorizationRequest:"standardInteractionClientInitializeAuthorizationRequest",StandardInteractionClientInitializeAuthorizationCodeRequest:"standardInteractionClientInitializeAuthorizationCodeRequest",GetAuthCodeUrl:"getAuthCodeUrl",HandleCodeResponseFromServer:"handleCodeResponseFromServer",HandleCodeResponse:"handleCodeResponse",UpdateTokenEndpointAuthority:"updateTokenEndpointAuthority",AuthClientAcquireToken:"authClientAcquireToken",AuthClientExecuteTokenRequest:"authClientExecuteTokenRequest",AuthClientCreateTokenRequestBody:"authClientCreateTokenRequestBody",AuthClientCreateQueryString:"authClientCreateQueryString",PopTokenGenerateCnf:"popTokenGenerateCnf",PopTokenGenerateKid:"popTokenGenerateKid",HandleServerTokenResponse:"handleServerTokenResponse",DeserializeResponse:"deserializeResponse",AuthorityFactoryCreateDiscoveredInstance:"authorityFactoryCreateDiscoveredInstance",AuthorityResolveEndpointsAsync:"authorityResolveEndpointsAsync",AuthorityResolveEndpointsFromLocalSources:"authorityResolveEndpointsFromLocalSources",AuthorityGetCloudDiscoveryMetadataFromNetwork:"authorityGetCloudDiscoveryMetadataFromNetwork",AuthorityUpdateCloudDiscoveryMetadata:"authorityUpdateCloudDiscoveryMetadata",AuthorityGetEndpointMetadataFromNetwork:"authorityGetEndpointMetadataFromNetwork",AuthorityUpdateEndpointMetadata:"authorityUpdateEndpointMetadata",AuthorityUpdateMetadataWithRegionalInformation:"authorityUpdateMetadataWithRegionalInformation",RegionDiscoveryDetectRegion:"regionDiscoveryDetectRegion",RegionDiscoveryGetRegionFromIMDS:"regionDiscoveryGetRegionFromIMDS",RegionDiscoveryGetCurrentVersion:"regionDiscoveryGetCurrentVersion",AcquireTokenByCodeAsync:"acquireTokenByCodeAsync",GetEndpointMetadataFromNetwork:"getEndpointMetadataFromNetwork",GetCloudDiscoveryMetadataFromNetworkMeasurement:"getCloudDiscoveryMetadataFromNetworkMeasurement",HandleRedirectPromiseMeasurement:"handleRedirectPromise",HandleNativeRedirectPromiseMeasurement:"handleNativeRedirectPromise",UpdateCloudDiscoveryMetadataMeasurement:"updateCloudDiscoveryMetadataMeasurement",UsernamePasswordClientAcquireToken:"usernamePasswordClientAcquireToken",NativeMessageHandlerHandshake:"nativeMessageHandlerHandshake",NativeGenerateAuthResult:"nativeGenerateAuthResult",RemoveHiddenIframe:"removeHiddenIframe",ClearTokensAndKeysWithClaims:"clearTokensAndKeysWithClaims",CacheManagerGetRefreshToken:"cacheManagerGetRefreshToken",ImportExistingCache:"importExistingCache",SetUserData:"setUserData",LocalStorageUpdated:"localStorageUpdated",GeneratePkceCodes:"generatePkceCodes",GenerateCodeVerifier:"generateCodeVerifier",GenerateCodeChallengeFromVerifier:"generateCodeChallengeFromVerifier",Sha256Digest:"sha256Digest",GetRandomValues:"getRandomValues",GenerateHKDF:"generateHKDF",GenerateBaseKey:"generateBaseKey",Base64Decode:"base64Decode",UrlEncodeArr:"urlEncodeArr",Encrypt:"encrypt",Decrypt:"decrypt"},xQ={NotStarted:0,InProgress:1,Completed:2};/*! @azure/msal-common v15.2.0 2025-02-18 */const _0=(n,e,t,i,s)=>(...r)=>{t.trace(`Executing function ${e}`);const a=i==null?void 0:i.startMeasurement(e,s);if(s){const o=e+"CallCount";i==null||i.incrementFields({[o]:1},s)}try{const o=n(...r);return a==null||a.end({success:!0}),t.trace(`Returning result from ${e}`),o}catch(o){t.trace(`Error occurred in ${e}`);try{t.trace(JSON.stringify(o))}catch{t.trace("Unable to print error message.")}throw a==null||a.end({success:!1},o),o}},mt=(n,e,t,i,s)=>(...r)=>{t.trace(`Executing function ${e}`);const a=i==null?void 0:i.startMeasurement(e,s);if(s){const o=e+"CallCount";i==null||i.incrementFields({[o]:1},s)}return i==null||i.setPreQueueTime(e,s),n(...r).then(o=>(t.trace(`Returning result from ${e}`),a==null||a.end({success:!0}),o)).catch(o=>{t.trace(`Error occurred in ${e}`);try{t.trace(JSON.stringify(o))}catch{t.trace("Unable to print error message.")}throw a==null||a.end({success:!1},o),o})};/*! @azure/msal-common v15.2.0 2025-02-18 */class yy{constructor(e,t,i,s){this.networkInterface=e,this.logger=t,this.performanceClient=i,this.correlationId=s}async detectRegion(e,t){var s;(s=this.performanceClient)==null||s.addQueueMeasurement(Ie.RegionDiscoveryDetectRegion,this.correlationId);let i=e;if(i)t.region_source=xf.ENVIRONMENT_VARIABLE;else{const r=yy.IMDS_OPTIONS;try{const a=await mt(this.getRegionFromIMDS.bind(this),Ie.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(qe.IMDS_VERSION,r);if(a.status===u9.httpSuccess&&(i=a.body,t.region_source=xf.IMDS),a.status===u9.httpBadRequest){const o=await mt(this.getCurrentVersion.bind(this),Ie.RegionDiscoveryGetCurrentVersion,this.logger,this.performanceClient,this.correlationId)(r);if(!o)return t.region_source=xf.FAILED_AUTO_DETECTION,null;const l=await mt(this.getRegionFromIMDS.bind(this),Ie.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(o,r);l.status===u9.httpSuccess&&(i=l.body,t.region_source=xf.IMDS)}}catch{return t.region_source=xf.FAILED_AUTO_DETECTION,null}}return i||(t.region_source=xf.FAILED_AUTO_DETECTION),i||null}async getRegionFromIMDS(e,t){var i;return(i=this.performanceClient)==null||i.addQueueMeasurement(Ie.RegionDiscoveryGetRegionFromIMDS,this.correlationId),this.networkInterface.sendGetRequestAsync(`${qe.IMDS_ENDPOINT}?api-version=${e}&format=text`,t,qe.IMDS_TIMEOUT)}async getCurrentVersion(e){var t;(t=this.performanceClient)==null||t.addQueueMeasurement(Ie.RegionDiscoveryGetCurrentVersion,this.correlationId);try{const i=await this.networkInterface.sendGetRequestAsync(`${qe.IMDS_ENDPOINT}?format=json`,e);return i.status===u9.httpBadRequest&&i.body&&i.body["newest-versions"]&&i.body["newest-versions"].length>0?i.body["newest-versions"][0]:null}catch{return null}}}yy.IMDS_OPTIONS={headers:{Metadata:"true"}};/*! @azure/msal-common v15.2.0 2025-02-18 */class Cr{constructor(e,t,i,s,r,a,o,l){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=i,this.authorityOptions=s,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=r,this.performanceClient=o,this.correlationId=a,this.managedIdentity=l||!1,this.regionDiscovery=new yy(t,this.logger,this.performanceClient,this.correlationId)}getAuthorityType(e){if(e.HostNameAndPort.endsWith(qe.CIAM_AUTH_URL))return qo.Ciam;const t=e.PathSegments;if(t.length)switch(t[0].toLowerCase()){case qe.ADFS:return qo.Adfs;case qe.DSTS:return qo.Dsts}return qo.Default}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this._canonicalAuthority.urlString}set canonicalAuthority(e){this._canonicalAuthority=new Jn(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null}get canonicalAuthorityUrlComponents(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw gt(pc)}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw gt(pc)}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw gt(pc)}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw gt(VP);return this.replacePath(this.metadata.end_session_endpoint)}else throw gt(pc)}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw gt(pc)}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw gt(pc)}canReplaceTenant(e){return e.PathSegments.length===1&&!Cr.reservedTenantDomains.has(e.PathSegments[0])&&this.getAuthorityType(e)===qo.Default&&this.protocolMode===h0.AAD}replaceTenant(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(e){let t=e;const s=new Jn(this.metadata.canonical_authority).getUrlComponents(),r=s.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((o,l)=>{let c=r[l];if(l===0&&this.canReplaceTenant(s)){const h=new Jn(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];c!==h&&(this.logger.verbose(`Replacing tenant domain name ${c} with id ${h}`),c=h)}o!==c&&(t=t.replace(`/${c}/`,`/${o}/`))}),this.replaceTenant(t)}get defaultOpenIdConfigurationEndpoint(){const e=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||this.authorityType===qo.Adfs||this.protocolMode!==h0.AAD&&!this.isAliasOfKnownMicrosoftAuthority(e)?`${this.canonicalAuthority}.well-known/openid-configuration`:`${this.canonicalAuthority}v2.0/.well-known/openid-configuration`}discoveryComplete(){return!!this.metadata}async resolveEndpointsAsync(){var s,r;(s=this.performanceClient)==null||s.addQueueMeasurement(Ie.AuthorityResolveEndpointsAsync,this.correlationId);const e=this.getCurrentMetadataEntity(),t=await mt(this.updateCloudDiscoveryMetadata.bind(this),Ie.AuthorityUpdateCloudDiscoveryMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network);const i=await mt(this.updateEndpointMetadata.bind(this),Ie.AuthorityUpdateEndpointMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.updateCachedMetadata(e,t,{source:i}),(r=this.performanceClient)==null||r.addFields({cloudDiscoverySource:t,authorityEndpointSource:i},this.correlationId)}getCurrentMetadataEntity(){let e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);return e||(e={aliases:[],preferred_cache:this.hostnameAndPort,preferred_network:this.hostnameAndPort,canonical_authority:this.canonicalAuthority,authorization_endpoint:"",token_endpoint:"",end_session_endpoint:"",issuer:"",aliasesFromNetwork:!1,endpointsFromNetwork:!1,expiresAt:RC(),jwks_uri:""}),e}updateCachedMetadata(e,t,i){t!==xa.CACHE&&(i==null?void 0:i.source)!==xa.CACHE&&(e.expiresAt=RC(),e.canonical_authority=this.canonicalAuthority);const s=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache);this.cacheManager.setAuthorityMetadata(s,e),this.metadata=e}async updateEndpointMetadata(e){var s,r,a;(s=this.performanceClient)==null||s.addQueueMeasurement(Ie.AuthorityUpdateEndpointMetadata,this.correlationId);const t=this.updateEndpointMetadataFromLocalSources(e);if(t){if(t.source===xa.HARDCODED_VALUES&&(r=this.authorityOptions.azureRegionConfiguration)!=null&&r.azureRegion&&t.metadata){const o=await mt(this.updateMetadataWithRegionalInformation.bind(this),Ie.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(t.metadata);d9(e,o,!1),e.canonical_authority=this.canonicalAuthority}return t.source}let i=await mt(this.getEndpointMetadataFromNetwork.bind(this),Ie.AuthorityGetEndpointMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(i)return(a=this.authorityOptions.azureRegionConfiguration)!=null&&a.azureRegion&&(i=await mt(this.updateMetadataWithRegionalInformation.bind(this),Ie.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(i)),d9(e,i,!0),xa.NETWORK;throw gt(MP,this.defaultOpenIdConfigurationEndpoint)}updateEndpointMetadataFromLocalSources(e){this.logger.verbose("Attempting to get endpoint metadata from authority configuration");const t=this.getEndpointMetadataFromConfig();if(t)return this.logger.verbose("Found endpoint metadata in authority configuration"),d9(e,t,!1),{source:xa.CONFIG};if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{const s=this.getEndpointMetadataFromHardcodedValues();if(s)return d9(e,s,!1),{source:xa.HARDCODED_VALUES,metadata:s};this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}const i=MC(e);return this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!i?(this.logger.verbose("Found endpoint metadata in the cache."),{source:xa.CACHE}):(i&&this.logger.verbose("The metadata entity is expired."),null)}isAuthoritySameType(e){return new Jn(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch{throw yi(nN)}return null}async getEndpointMetadataFromNetwork(){var i;(i=this.performanceClient)==null||i.addQueueMeasurement(Ie.AuthorityGetEndpointMetadataFromNetwork,this.correlationId);const e={},t=this.defaultOpenIdConfigurationEndpoint;this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ${t}`);try{const s=await this.networkInterface.sendGetRequestAsync(t,e);return mQ(s.body)?s.body:(this.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null)}catch(s){return this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: ${s}`),null}}getEndpointMetadataFromHardcodedValues(){return this.hostnameAndPort in NC?NC[this.hostnameAndPort]:null}async updateMetadataWithRegionalInformation(e){var i,s,r;(i=this.performanceClient)==null||i.addQueueMeasurement(Ie.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId);const t=(s=this.authorityOptions.azureRegionConfiguration)==null?void 0:s.azureRegion;if(t){if(t!==qe.AZURE_REGION_AUTO_DISCOVER_FLAG)return this.regionDiscoveryMetadata.region_outcome=zw.CONFIGURED_NO_AUTO_DETECTION,this.regionDiscoveryMetadata.region_used=t,Cr.replaceWithRegionalInformation(e,t);const a=await mt(this.regionDiscovery.detectRegion.bind(this.regionDiscovery),Ie.RegionDiscoveryDetectRegion,this.logger,this.performanceClient,this.correlationId)((r=this.authorityOptions.azureRegionConfiguration)==null?void 0:r.environmentRegion,this.regionDiscoveryMetadata);if(a)return this.regionDiscoveryMetadata.region_outcome=zw.AUTO_DETECTION_REQUESTED_SUCCESSFUL,this.regionDiscoveryMetadata.region_used=a,Cr.replaceWithRegionalInformation(e,a);this.regionDiscoveryMetadata.region_outcome=zw.AUTO_DETECTION_REQUESTED_FAILED}return e}async updateCloudDiscoveryMetadata(e){var s;(s=this.performanceClient)==null||s.addQueueMeasurement(Ie.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId);const t=this.updateCloudDiscoveryMetadataFromLocalSources(e);if(t)return t;const i=await mt(this.getCloudDiscoveryMetadataFromNetwork.bind(this),Ie.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(i)return jw(e,i,!0),xa.NETWORK;throw yi(iN)}updateCloudDiscoveryMetadataFromLocalSources(e){this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii(`Known Authorities: ${this.authorityOptions.knownAuthorities||qe.NOT_APPLICABLE}`),this.logger.verbosePii(`Authority Metadata: ${this.authorityOptions.authorityMetadata||qe.NOT_APPLICABLE}`),this.logger.verbosePii(`Canonical Authority: ${e.canonical_authority||qe.NOT_APPLICABLE}`);const t=this.getCloudDiscoveryMetadataFromConfig();if(t)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),jw(e,t,!1),xa.CONFIG;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{const s=_Z(this.hostnameAndPort);if(s)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),jw(e,s,!1),xa.HARDCODED_VALUES;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}const i=MC(e);return this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!i?(this.logger.verbose("Found cloud discovery metadata in the cache."),xa.CACHE):(i&&this.logger.verbose("The metadata entity is expired."),null)}getCloudDiscoveryMetadataFromConfig(){if(this.authorityType===qo.Ciam)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),Cr.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");const e=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),t=Q3(e.metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),t)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),t;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch{throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),yi(f_)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),Cr.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}async getCloudDiscoveryMetadataFromNetwork(){var s;(s=this.performanceClient)==null||s.addQueueMeasurement(Ie.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId);const e=`${qe.AAD_INSTANCE_DISCOVERY_ENDPT}${this.canonicalAuthority}oauth2/v2.0/authorize`,t={};let i=null;try{const r=await this.networkInterface.sendGetRequestAsync(e,t);let a,o;if(pQ(r.body))a=r.body,o=a.metadata,this.logger.verbosePii(`tenant_discovery_endpoint is: ${a.tenant_discovery_endpoint}`);else if(bQ(r.body)){if(this.logger.warning(`A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ${r.status}`),a=r.body,a.error===qe.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error is ${a.error}`),this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error description is ${a.error_description}`),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),o=[]}else return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),i=Q3(o,this.hostnameAndPort)}catch(r){if(r instanceof Ui)this.logger.error(`There was a network error while attempting to get the cloud discovery instance metadata.
Error: ${r.errorCode}
Error Description: ${r.errorMessage}`);else{const a=r;this.logger.error(`A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.
Error: ${a.name}
Error Description: ${a.message}`)}return null}return i||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),i=Cr.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),i}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter(t=>t&&Jn.getDomainFromUrl(t).toLowerCase()===this.hostnameAndPort).length>0}static generateAuthority(e,t){let i;if(t&&t.azureCloudInstance!==c_.None){const s=t.tenant?t.tenant:qe.DEFAULT_COMMON_TENANT;i=`${t.azureCloudInstance}/${s}/`}return i||e}static createCloudDiscoveryMetadataFromHost(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}}getPreferredCache(){if(this.managedIdentity)return qe.DEFAULT_AUTHORITY_HOST;if(this.discoveryComplete())return this.metadata.preferred_cache;throw gt(pc)}isAlias(e){return this.metadata.aliases.indexOf(e)>-1}isAliasOfKnownMicrosoftAuthority(e){return uN.has(e)}static isPublicCloudAuthority(e){return qe.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0}static buildRegionalAuthorityString(e,t,i){const s=new Jn(e);s.validateAsUri();const r=s.getUrlComponents();let a=`${t}.${r.HostNameAndPort}`;this.isPublicCloudAuthority(r.HostNameAndPort)&&(a=`${t}.${qe.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX}`);const o=Jn.constructAuthorityUriFromObject({...s.getUrlComponents(),HostNameAndPort:a}).urlString;return i?`${o}?${i}`:o}static replaceWithRegionalInformation(e,t){const i={...e};return i.authorization_endpoint=Cr.buildRegionalAuthorityString(i.authorization_endpoint,t),i.token_endpoint=Cr.buildRegionalAuthorityString(i.token_endpoint,t),i.end_session_endpoint&&(i.end_session_endpoint=Cr.buildRegionalAuthorityString(i.end_session_endpoint,t)),i}static transformCIAMAuthority(e){let t=e;const s=new Jn(e).getUrlComponents();if(s.PathSegments.length===0&&s.HostNameAndPort.endsWith(qe.CIAM_AUTH_URL)){const r=s.HostNameAndPort.split(".")[0];t=`${t}${r}${qe.AAD_TENANT_DOMAIN_SUFFIX}`}return t}}Cr.reservedTenantDomains=new Set(["{tenant}","{tenantid}",Dh.COMMON,Dh.CONSUMERS,Dh.ORGANIZATIONS]);function yQ(n){var s;const i=(s=new Jn(n).getUrlComponents().PathSegments.slice(-1)[0])==null?void 0:s.toLowerCase();switch(i){case Dh.COMMON:case Dh.ORGANIZATIONS:case Dh.CONSUMERS:return;default:return i}}function mN(n){return n.endsWith(qe.FORWARD_SLASH)?n:`${n}${qe.FORWARD_SLASH}`}function wQ(n){const e=n.cloudDiscoveryMetadata;let t;if(e)try{t=JSON.parse(e)}catch{throw yi(f_)}return{canonicalAuthority:n.authority?mN(n.authority):void 0,knownAuthorities:n.knownAuthorities,cloudDiscoveryMetadata:t}}/*! @azure/msal-common v15.2.0 2025-02-18 */async function pN(n,e,t,i,s,r,a){a==null||a.addQueueMeasurement(Ie.AuthorityFactoryCreateDiscoveredInstance,r);const o=Cr.transformCIAMAuthority(mN(n)),l=new Cr(o,e,t,i,s,r,a);try{return await mt(l.resolveEndpointsAsync.bind(l),Ie.AuthorityResolveEndpointsAsync,s,a,r)(),l}catch{throw gt(pc)}}/*! @azure/msal-common v15.2.0 2025-02-18 */class Gh extends Ui{constructor(e,t,i,s,r){super(e,t,i),this.name="ServerError",this.errorNo=s,this.status=r,Object.setPrototypeOf(this,Gh.prototype)}}/*! @azure/msal-common v15.2.0 2025-02-18 */class Xl{static generateThrottlingStorageKey(e){return`${kp.THROTTLING_PREFIX}.${JSON.stringify(e)}`}static preProcess(e,t){var r;const i=Xl.generateThrottlingStorageKey(t),s=e.getThrottlingCache(i);if(s){if(s.throttleTime<Date.now()){e.removeItem(i);return}throw new Gh(((r=s.errorCodes)==null?void 0:r.join(" "))||qe.EMPTY_STRING,s.errorMessage,s.subError)}}static postProcess(e,t,i){if(Xl.checkResponseStatus(i)||Xl.checkResponseForRetryAfter(i)){const s={throttleTime:Xl.calculateThrottleTime(parseInt(i.headers[jr.RETRY_AFTER])),error:i.body.error,errorCodes:i.body.error_codes,errorMessage:i.body.error_description,subError:i.body.suberror};e.setThrottlingCache(Xl.generateThrottlingStorageKey(t),s)}}static checkResponseStatus(e){return e.status===429||e.status>=500&&e.status<600}static checkResponseForRetryAfter(e){return e.headers?e.headers.hasOwnProperty(jr.RETRY_AFTER)&&(e.status<200||e.status>=300):!1}static calculateThrottleTime(e){const t=e<=0?0:e,i=Date.now()/1e3;return Math.floor(Math.min(i+(t||kp.DEFAULT_THROTTLE_TIME_SECONDS),i+kp.DEFAULT_MAX_THROTTLE_TIME_SECONDS)*1e3)}static removeThrottle(e,t,i,s){const r={clientId:t,authority:i.authority,scopes:i.scopes,homeAccountIdentifier:s,claims:i.claims,authenticationScheme:i.authenticationScheme,resourceRequestMethod:i.resourceRequestMethod,resourceRequestUri:i.resourceRequestUri,shrClaims:i.shrClaims,sshKid:i.sshKid},a=this.generateThrottlingStorageKey(r);e.removeItem(a)}}/*! @azure/msal-common v15.2.0 2025-02-18 */class wy extends Ui{constructor(e,t,i){super(e.errorCode,e.errorMessage,e.subError),Object.setPrototypeOf(this,wy.prototype),this.name="NetworkError",this.error=e,this.httpStatus=t,this.responseHeaders=i}}function UC(n,e,t){return new wy(n,e,t)}/*! @azure/msal-common v15.2.0 2025-02-18 */class w_{constructor(e,t){this.config=RZ(e),this.logger=new jh(this.config.loggerOptions,qP,l_),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}createTokenRequestHeaders(e){const t={};if(t[jr.CONTENT_TYPE]=qe.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case Va.HOME_ACCOUNT_ID:try{const i=Uf(e.credential);t[jr.CCS_HEADER]=`Oid:${i.uid}@${i.utid}`}catch(i){this.logger.verbose("Could not parse home account ID for CCS Header: "+i)}break;case Va.UPN:t[jr.CCS_HEADER]=`UPN: ${e.credential}`;break}return t}async executePostToTokenEndpoint(e,t,i,s,r,a){var l;a&&((l=this.performanceClient)==null||l.addQueueMeasurement(a,r));const o=await this.sendPostRequest(s,e,{body:t,headers:i},r);return this.config.serverTelemetryManager&&o.status<500&&o.status!==429&&this.config.serverTelemetryManager.clearTelemetryCache(),o}async sendPostRequest(e,t,i,s){var a,o,l;Xl.preProcess(this.cacheManager,e);let r;try{r=await mt(this.networkClient.sendPostRequestAsync.bind(this.networkClient),Ie.NetworkClientSendPostRequestAsync,this.logger,this.performanceClient,s)(t,i);const c=r.headers||{};(o=this.performanceClient)==null||o.addFields({refreshTokenSize:((a=r.body.refresh_token)==null?void 0:a.length)||0,httpVerToken:c[jr.X_MS_HTTP_VERSION]||"",requestId:c[jr.X_MS_REQUEST_ID]||""},s)}catch(c){if(c instanceof wy){const h=c.responseHeaders;throw h&&((l=this.performanceClient)==null||l.addFields({httpVerToken:h[jr.X_MS_HTTP_VERSION]||"",requestId:h[jr.X_MS_REQUEST_ID]||"",contentTypeHeader:h[jr.CONTENT_TYPE]||void 0,contentLengthHeader:h[jr.CONTENT_LENGTH]||void 0,httpStatus:c.httpStatus},s)),c.error}throw c instanceof Ui?c:gt(RP)}return Xl.postProcess(this.cacheManager,e,r),r}async updateAuthority(e,t){var r;(r=this.performanceClient)==null||r.addQueueMeasurement(Ie.UpdateTokenEndpointAuthority,t);const i=`https://${e}/${this.authority.tenant}/`,s=await pN(i,this.networkClient,this.cacheManager,this.authority.options,this.logger,t,this.performanceClient);this.authority=s}createTokenQueryParameters(e){const t=new Ap(e.correlationId,this.performanceClient);return e.embeddedClientId&&t.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.addCorrelationId(e.correlationId),t.createQueryString()}}/*! @azure/msal-common v15.2.0 2025-02-18 */const $3="no_tokens_found",bN="native_account_unavailable",__="refresh_token_expired",_Q="interaction_required",vQ="consent_required",kQ="login_required",_y="bad_token";/*! @azure/msal-common v15.2.0 2025-02-18 */const HC=[_Q,vQ,kQ,_y],CQ=["message_only","additional_action","basic_action","user_password_expired","consent_required","bad_token"],AQ={[$3]:"No refresh token found in the cache. Please sign-in.",[bN]:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API.",[__]:"Refresh token has expired.",[_y]:"Identity provider returned bad_token due to an expired or invalid refresh token. Please invoke an interactive API to resolve."};class sl extends Ui{constructor(e,t,i,s,r,a,o,l){super(e,t,i),Object.setPrototypeOf(this,sl.prototype),this.timestamp=s||qe.EMPTY_STRING,this.traceId=r||qe.EMPTY_STRING,this.correlationId=a||qe.EMPTY_STRING,this.claims=o||qe.EMPTY_STRING,this.name="InteractionRequiredAuthError",this.errorNo=l}}function zC(n,e,t){const i=!!n&&HC.indexOf(n)>-1,s=!!t&&CQ.indexOf(t)>-1,r=!!e&&HC.some(a=>e.indexOf(a)>-1);return i||r||s}function F6(n){return new sl(n,AQ[n])}/*! @azure/msal-common v15.2.0 2025-02-18 */class tl{static setRequestState(e,t,i){const s=tl.generateLibraryState(e,i);return t?`${s}${qe.RESOURCE_DELIM}${t}`:s}static generateLibraryState(e,t){if(!e)throw gt(R6);const i={id:e.createNewGuid()};t&&(i.meta=t);const s=JSON.stringify(i);return e.base64Encode(s)}static parseRequestState(e,t){if(!e)throw gt(R6);if(!t)throw gt(Lg);try{const i=t.split(qe.RESOURCE_DELIM),s=i[0],r=i.length>1?i.slice(1).join(qe.RESOURCE_DELIM):qe.EMPTY_STRING,a=e.base64Decode(s),o=JSON.parse(a);return{userRequestState:r||qe.EMPTY_STRING,libraryState:o}}catch{throw gt(Lg)}}}/*! @azure/msal-common v15.2.0 2025-02-18 */const SQ={SW:"sw",UHW:"uhw"};class Bg{constructor(e,t){this.cryptoUtils=e,this.performanceClient=t}async generateCnf(e,t){var r;(r=this.performanceClient)==null||r.addQueueMeasurement(Ie.PopTokenGenerateCnf,e.correlationId);const i=await mt(this.generateKid.bind(this),Ie.PopTokenGenerateCnf,t,this.performanceClient,e.correlationId)(e),s=this.cryptoUtils.base64UrlEncode(JSON.stringify(i));return{kid:i.kid,reqCnfString:s}}async generateKid(e){var i;return(i=this.performanceClient)==null||i.addQueueMeasurement(Ie.PopTokenGenerateKid,e.correlationId),{kid:await this.cryptoUtils.getPublicKeyThumbprint(e),xms_ksl:SQ.SW}}async signPopToken(e,t,i){return this.signPayload(e,t,i)}async signPayload(e,t,i,s){const{resourceRequestMethod:r,resourceRequestUri:a,shrClaims:o,shrNonce:l,shrOptions:c}=i,h=a?new Jn(a):void 0,u=h==null?void 0:h.getUrlComponents();return this.cryptoUtils.signJwt({at:e,ts:ac(),m:r==null?void 0:r.toUpperCase(),u:u==null?void 0:u.HostNameAndPort,nonce:l||this.cryptoUtils.createNewGuid(),p:u==null?void 0:u.AbsolutePath,q:u!=null&&u.QueryString?[[],u.QueryString]:void 0,client_claims:o||void 0,...s},t,c,i.correlationId)}}/*! @azure/msal-common v15.2.0 2025-02-18 */class IQ{constructor(e,t){this.cache=e,this.hasChanged=t}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}}/*! @azure/msal-common v15.2.0 2025-02-18 */function EQ(n){var i,s;const e="code=",t=(i=n.error_uri)==null?void 0:i.lastIndexOf(e);return t&&t>=0?(s=n.error_uri)==null?void 0:s.substring(t+e.length):void 0}class Qd{constructor(e,t,i,s,r,a,o){this.clientId=e,this.cacheStorage=t,this.cryptoObj=i,this.logger=s,this.serializableCache=r,this.persistencePlugin=a,this.performanceClient=o}validateServerAuthorizationCodeResponse(e,t){if(!e.state||!t)throw e.state?gt(X3,"Cached State"):gt(X3,"Server State");let i,s;try{i=decodeURIComponent(e.state)}catch{throw gt(Lg,e.state)}try{s=decodeURIComponent(t)}catch{throw gt(Lg,e.state)}if(i!==s)throw gt(NP);if(e.error||e.error_description||e.suberror){const r=EQ(e);throw zC(e.error,e.error_description,e.suberror)?new sl(e.error||"",e.error_description,e.suberror,e.timestamp||"",e.trace_id||"",e.correlation_id||"",e.claims||"",r):new Gh(e.error||"",e.error_description,e.suberror,r)}}validateTokenResponse(e,t){var i;if(e.error||e.error_description||e.suberror){const s=`Error(s): ${e.error_codes||qe.NOT_AVAILABLE} - Timestamp: ${e.timestamp||qe.NOT_AVAILABLE} - Description: ${e.error_description||qe.NOT_AVAILABLE} - Correlation ID: ${e.correlation_id||qe.NOT_AVAILABLE} - Trace ID: ${e.trace_id||qe.NOT_AVAILABLE}`,r=(i=e.error_codes)!=null&&i.length?e.error_codes[0]:void 0,a=new Gh(e.error,s,e.suberror,r,e.status);if(t&&e.status&&e.status>=l9.SERVER_ERROR_RANGE_START&&e.status<=l9.SERVER_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.
${a}`);return}else if(t&&e.status&&e.status>=l9.CLIENT_ERROR_RANGE_START&&e.status<=l9.CLIENT_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.
${a}`);return}throw zC(e.error,e.error_description,e.suberror)?new sl(e.error,e.error_description,e.suberror,e.timestamp||qe.EMPTY_STRING,e.trace_id||qe.EMPTY_STRING,e.correlation_id||qe.EMPTY_STRING,e.claims||qe.EMPTY_STRING,r):a}}async handleServerTokenResponse(e,t,i,s,r,a,o,l,c){var g;(g=this.performanceClient)==null||g.addQueueMeasurement(Ie.HandleServerTokenResponse,e.correlation_id);let h;if(e.id_token){if(h=Qg(e.id_token||qe.EMPTY_STRING,this.cryptoObj.base64Decode),r&&r.nonce&&h.nonce!==r.nonce)throw gt(OP);if(s.maxAge||s.maxAge===0){const m=h.auth_time;if(!m)throw gt(i_);WP(m,s.maxAge)}}this.homeAccountIdentifier=Xr.generateHomeAccountId(e.client_info||qe.EMPTY_STRING,t.authorityType,this.logger,this.cryptoObj,h);let u;r&&r.state&&(u=tl.parseRequestState(this.cryptoObj,r.state)),e.key_id=e.key_id||s.sshKid||void 0;const d=this.generateCacheRecord(e,t,i,s,h,a,r);let f;try{if(this.persistencePlugin&&this.serializableCache&&(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),f=new IQ(this.serializableCache,!0),await this.persistencePlugin.beforeCacheAccess(f)),o&&!l&&d.account){const m=d.account.generateAccountKey();if(!this.cacheStorage.getAccount(m))return this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),await Qd.generateAuthenticationResult(this.cryptoObj,t,d,!1,s,h,u,void 0,c)}await this.cacheStorage.saveCacheRecord(d,s.correlationId,s.storeInCache)}finally{this.persistencePlugin&&this.serializableCache&&f&&(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),await this.persistencePlugin.afterCacheAccess(f))}return Qd.generateAuthenticationResult(this.cryptoObj,t,d,!1,s,h,u,e,c)}generateCacheRecord(e,t,i,s,r,a,o){const l=t.getPreferredCache();if(!l)throw gt(r_);const c=lN(r);let h,u;e.id_token&&r&&(h=py(this.homeAccountIdentifier,l,e.id_token,this.clientId,c||""),u=v_(this.cacheStorage,t,this.homeAccountIdentifier,this.cryptoObj.base64Decode,r,e.client_info,l,c,o,void 0,this.logger));let d=null;if(e.access_token){const m=e.scope?rs.fromString(e.scope):new rs(s.scopes||[]),x=(typeof e.expires_in=="string"?parseInt(e.expires_in,10):e.expires_in)||0,p=(typeof e.ext_expires_in=="string"?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,y=(typeof e.refresh_in=="string"?parseInt(e.refresh_in,10):e.refresh_in)||void 0,w=i+x,_=w+p,v=y&&y>0?i+y:void 0;d=by(this.homeAccountIdentifier,l,e.access_token,this.clientId,c||t.tenant||"",m.printScopes(),w,_,this.cryptoObj.base64Decode,v,e.token_type,a,e.key_id,s.claims,s.requestedClaimsHash)}let f=null;if(e.refresh_token){let m;if(e.refresh_token_expires_in){const x=typeof e.refresh_token_expires_in=="string"?parseInt(e.refresh_token_expires_in,10):e.refresh_token_expires_in;m=i+x}f=KP(this.homeAccountIdentifier,l,e.refresh_token,this.clientId,e.foci,a,m)}let g=null;return e.foci&&(g={clientId:this.clientId,environment:l,familyId:e.foci}),{account:u,idToken:h,accessToken:d,refreshToken:f,appMetadata:g}}static async generateAuthenticationResult(e,t,i,s,r,a,o,l,c){var w,_,v,C,k;let h=qe.EMPTY_STRING,u=[],d=null,f,g,m=qe.EMPTY_STRING;if(i.accessToken){if(i.accessToken.tokenType===gi.POP&&!r.popKid){const I=new Bg(e),{secret:S,keyId:M}=i.accessToken;if(!M)throw gt(a_);h=await I.signPopToken(S,M,r)}else h=i.accessToken.secret;u=rs.fromString(i.accessToken.target).asArray(),d=new Date(Number(i.accessToken.expiresOn)*1e3),f=new Date(Number(i.accessToken.extendedExpiresOn)*1e3),i.accessToken.refreshOn&&(g=new Date(Number(i.accessToken.refreshOn)*1e3))}i.appMetadata&&(m=i.appMetadata.familyId===vp?vp:"");const x=(a==null?void 0:a.oid)||(a==null?void 0:a.sub)||"",p=(a==null?void 0:a.tid)||"";l!=null&&l.spa_accountid&&i.account&&(i.account.nativeAccountId=l==null?void 0:l.spa_accountid);const y=i.account?p_(i.account.getAccountInfo(),void 0,a,(w=i.idToken)==null?void 0:w.secret):null;return{authority:t.canonicalAuthority,uniqueId:x,tenantId:p,scopes:u,account:y,idToken:((_=i==null?void 0:i.idToken)==null?void 0:_.secret)||"",idTokenClaims:a||{},accessToken:h,fromCache:s,expiresOn:d,extExpiresOn:f,refreshOn:g,correlationId:r.correlationId,requestId:c||qe.EMPTY_STRING,familyId:m,tokenType:((v=i.accessToken)==null?void 0:v.tokenType)||qe.EMPTY_STRING,state:o?o.userRequestState:qe.EMPTY_STRING,cloudGraphHostName:((C=i.account)==null?void 0:C.cloudGraphHostName)||qe.EMPTY_STRING,msGraphHost:((k=i.account)==null?void 0:k.msGraphHost)||qe.EMPTY_STRING,code:l==null?void 0:l.spa_code,fromNativeBroker:!1}}}function v_(n,e,t,i,s,r,a,o,l,c,h){h==null||h.verbose("setCachedAccount called");const d=n.getAccountKeys().find(p=>p.startsWith(t));let f=null;d&&(f=n.getAccount(d));const g=f||Xr.createAccount({homeAccountId:t,idTokenClaims:s,clientInfo:r,environment:a,cloudGraphHostName:l==null?void 0:l.cloud_graph_host_name,msGraphHost:l==null?void 0:l.msgraph_host,nativeAccountId:c},e,i),m=g.tenantProfiles||[],x=o||g.realm;if(x&&!m.find(p=>p.tenantId===x)){const p=m_(t,g.localAccountId,x,s);m.push(p)}return g.tenantProfiles=m,g}/*! @azure/msal-common v15.2.0 2025-02-18 */async function xN(n,e,t){return typeof n=="string"?n:n({clientId:e,tokenEndpoint:t})}/*! @azure/msal-common v15.2.0 2025-02-18 */class yN extends w_{constructor(e,t){var i;super(e,t),this.includeRedirectUri=!0,this.oidcDefaultScopes=(i=this.config.authOptions.authority.options.OIDCOptions)==null?void 0:i.defaultScopes}async getAuthCodeUrl(e){var i;(i=this.performanceClient)==null||i.addQueueMeasurement(Ie.GetAuthCodeUrl,e.correlationId);const t=await mt(this.createAuthCodeUrlQueryString.bind(this),Ie.AuthClientCreateQueryString,this.logger,this.performanceClient,e.correlationId)(e);return Jn.appendQueryString(this.authority.authorizationEndpoint,t)}async acquireToken(e,t){var o,l;if((o=this.performanceClient)==null||o.addQueueMeasurement(Ie.AuthClientAcquireToken,e.correlationId),!e.code)throw gt(LP);const i=ac(),s=await mt(this.executeTokenRequest.bind(this),Ie.AuthClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(this.authority,e),r=(l=s.headers)==null?void 0:l[jr.X_MS_REQUEST_ID],a=new Qd(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient);return a.validateTokenResponse(s.body),mt(a.handleServerTokenResponse.bind(a),Ie.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(s.body,this.authority,i,e,t,void 0,void 0,void 0,r)}handleFragmentResponse(e,t){if(new Qd(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null).validateServerAuthorizationCodeResponse(e,t),!e.code)throw gt(jP);return e}getLogoutUri(e){if(!e)throw yi(eN);const t=this.createLogoutUrlQueryString(e);return Jn.appendQueryString(this.authority.endSessionEndpoint,t)}async executeTokenRequest(e,t){var c,h;(c=this.performanceClient)==null||c.addQueueMeasurement(Ie.AuthClientExecuteTokenRequest,t.correlationId);const i=this.createTokenQueryParameters(t),s=Jn.appendQueryString(e.tokenEndpoint,i),r=await mt(this.createTokenRequestBody.bind(this),Ie.AuthClientCreateTokenRequestBody,this.logger,this.performanceClient,t.correlationId)(t);let a;if(t.clientInfo)try{const u=J3(t.clientInfo,this.cryptoUtils.base64Decode);a={credential:`${u.uid}${Ar.CLIENT_INFO_SEPARATOR}${u.utid}`,type:Va.HOME_ACCOUNT_ID}}catch(u){this.logger.verbose("Could not parse client info for CCS Header: "+u)}const o=this.createTokenRequestHeaders(a||t.ccsCredential),l={clientId:((h=t.tokenBodyParameters)==null?void 0:h.clientId)||this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid};return mt(this.executePostToTokenEndpoint.bind(this),Ie.AuthorizationCodeClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,t.correlationId)(s,r,o,l,t.correlationId,Ie.AuthorizationCodeClientExecutePostToTokenEndpoint)}async createTokenRequestBody(e){var s,r;(s=this.performanceClient)==null||s.addQueueMeasurement(Ie.AuthClientCreateTokenRequestBody,e.correlationId);const t=new Ap(e.correlationId,this.performanceClient);if(t.addClientId(e.embeddedClientId||((r=e.tokenBodyParameters)==null?void 0:r[Zd])||this.config.authOptions.clientId),this.includeRedirectUri?t.addRedirectUri(e.redirectUri):Nf.validateRedirectUri(e.redirectUri),t.addScopes(e.scopes,!0,this.oidcDefaultScopes),t.addAuthorizationCode(e.code),t.addLibraryInfo(this.config.libraryInfo),t.addApplicationTelemetry(this.config.telemetry.application),t.addThrottling(),this.serverTelemetryManager&&!O6(this.config)&&t.addServerTelemetry(this.serverTelemetryManager),e.codeVerifier&&t.addCodeVerifier(e.codeVerifier),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const a=this.config.clientCredentials.clientAssertion;t.addClientAssertion(await xN(a.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),t.addClientAssertionType(a.assertionType)}if(t.addGrantType(SP.AUTHORIZATION_CODE_GRANT),t.addClientInfo(),e.authenticationScheme===gi.POP){const a=new Bg(this.cryptoUtils,this.performanceClient);let o;e.popKid?o=this.cryptoUtils.encodeKid(e.popKid):o=(await mt(a.generateCnf.bind(a),Ie.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,t.addPopToken(o)}else if(e.authenticationScheme===gi.SSH)if(e.sshJwk)t.addSshJwk(e.sshJwk);else throw yi(xy);(!tc.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities);let i;if(e.clientInfo)try{const a=J3(e.clientInfo,this.cryptoUtils.base64Decode);i={credential:`${a.uid}${Ar.CLIENT_INFO_SEPARATOR}${a.utid}`,type:Va.HOME_ACCOUNT_ID}}catch(a){this.logger.verbose("Could not parse client info for CCS Header: "+a)}else i=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&i)switch(i.type){case Va.HOME_ACCOUNT_ID:try{const a=Uf(i.credential);t.addCcsOid(a)}catch(a){this.logger.verbose("Could not parse home account ID for CCS Header: "+a)}break;case Va.UPN:t.addCcsUpn(i.credential);break}return e.embeddedClientId&&t.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),e.tokenBodyParameters&&t.addExtraQueryParameters(e.tokenBodyParameters),e.enableSpaAuthorizationCode&&(!e.tokenBodyParameters||!e.tokenBodyParameters[BC])&&t.addExtraQueryParameters({[BC]:"1"}),t.createQueryString()}async createAuthCodeUrlQueryString(e){var r,a,o,l,c,h,u,d,f,g;const t=e.correlationId||this.config.cryptoInterface.createNewGuid();(r=this.performanceClient)==null||r.addQueueMeasurement(Ie.AuthClientCreateQueryString,t);const i=new Ap(t,this.performanceClient);i.addClientId(e.embeddedClientId||((a=e.extraQueryParameters)==null?void 0:a[Zd])||this.config.authOptions.clientId);const s=[...e.scopes||[],...e.extraScopesToConsent||[]];if(i.addScopes(s,!0,this.oidcDefaultScopes),i.addRedirectUri(e.redirectUri),i.addCorrelationId(t),i.addResponseMode(e.responseMode),i.addResponseTypeCode(),i.addLibraryInfo(this.config.libraryInfo),O6(this.config)||i.addApplicationTelemetry(this.config.telemetry.application),i.addClientInfo(),e.codeChallenge&&e.codeChallengeMethod&&i.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.prompt&&i.addPrompt(e.prompt),e.domainHint&&(i.addDomainHint(e.domainHint),(o=this.performanceClient)==null||o.addFields({domainHintFromRequest:!0},t)),(l=this.performanceClient)==null||l.addFields({prompt:e.prompt},t),e.prompt!==Us.SELECT_ACCOUNT)if(e.sid&&e.prompt===Us.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),i.addSid(e.sid),(c=this.performanceClient)==null||c.addFields({sidFromRequest:!0},t);else if(e.account){const m=this.extractAccountSid(e.account);let x=this.extractLoginHint(e.account);if(x&&e.domainHint&&(this.logger.warning('AuthorizationCodeClient.createAuthCodeUrlQueryString: "domainHint" param is set, skipping opaque "login_hint" claim. Please consider not passing domainHint'),x=null),x){this.logger.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),i.addLoginHint(x),(h=this.performanceClient)==null||h.addFields({loginHintFromClaim:!0},t);try{const p=Uf(e.account.homeAccountId);i.addCcsOid(p)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(m&&e.prompt===Us.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),i.addSid(m),(u=this.performanceClient)==null||u.addFields({sidFromClaim:!0},t);try{const p=Uf(e.account.homeAccountId);i.addCcsOid(p)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),i.addLoginHint(e.loginHint),i.addCcsUpn(e.loginHint),(d=this.performanceClient)==null||d.addFields({loginHintFromRequest:!0},t);else if(e.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),i.addLoginHint(e.account.username),(f=this.performanceClient)==null||f.addFields({loginHintFromUpn:!0},t);try{const p=Uf(e.account.homeAccountId);i.addCcsOid(p)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else e.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),i.addLoginHint(e.loginHint),i.addCcsUpn(e.loginHint),(g=this.performanceClient)==null||g.addFields({loginHintFromRequest:!0},t));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");if(e.nonce&&i.addNonce(e.nonce),e.state&&i.addState(e.state),(e.claims||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&i.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.embeddedClientId&&i.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),this.addExtraQueryParams(e,i),e.platformBroker&&(i.addNativeBroker(),e.authenticationScheme===gi.POP)){const m=new Bg(this.cryptoUtils);let x;e.popKid?x=this.cryptoUtils.encodeKid(e.popKid):x=(await mt(m.generateCnf.bind(m),Ie.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,i.addPopToken(x)}return i.createQueryString()}createLogoutUrlQueryString(e){const t=new Ap(e.correlationId,this.performanceClient);return e.postLogoutRedirectUri&&t.addPostLogoutRedirectUri(e.postLogoutRedirectUri),e.correlationId&&t.addCorrelationId(e.correlationId),e.idTokenHint&&t.addIdTokenHint(e.idTokenHint),e.state&&t.addState(e.state),e.logoutHint&&t.addLogoutHint(e.logoutHint),this.addExtraQueryParams(e,t),t.createQueryString()}addExtraQueryParams(e,t){!(e.extraQueryParameters&&e.extraQueryParameters.hasOwnProperty("instance_aware"))&&this.config.authOptions.instanceAware&&(e.extraQueryParameters=e.extraQueryParameters||{},e.extraQueryParameters.instance_aware="true"),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters)}extractAccountSid(e){var t;return((t=e.idTokenClaims)==null?void 0:t.sid)||null}extractLoginHint(e){var t;return((t=e.idTokenClaims)==null?void 0:t.login_hint)||null}}/*! @azure/msal-common v15.2.0 2025-02-18 */const TQ=300;class RQ extends w_{constructor(e,t){super(e,t)}async acquireToken(e){var a,o;(a=this.performanceClient)==null||a.addQueueMeasurement(Ie.RefreshTokenClientAcquireToken,e.correlationId);const t=ac(),i=await mt(this.executeTokenRequest.bind(this),Ie.RefreshTokenClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(e,this.authority),s=(o=i.headers)==null?void 0:o[jr.X_MS_REQUEST_ID],r=new Qd(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return r.validateTokenResponse(i.body),mt(r.handleServerTokenResponse.bind(r),Ie.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(i.body,this.authority,t,e,void 0,void 0,!0,e.forceCache,s)}async acquireTokenByRefreshToken(e){var i;if(!e)throw yi($P);if((i=this.performanceClient)==null||i.addQueueMeasurement(Ie.RefreshTokenClientAcquireTokenByRefreshToken,e.correlationId),!e.account)throw gt(s_);if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return await mt(this.acquireTokenWithCachedRefreshToken.bind(this),Ie.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!0)}catch(s){const r=s instanceof sl&&s.errorCode===$3,a=s instanceof Gh&&s.errorCode===SC.INVALID_GRANT_ERROR&&s.subError===SC.CLIENT_MISMATCH_ERROR;if(r||a)return mt(this.acquireTokenWithCachedRefreshToken.bind(this),Ie.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1);throw s}return mt(this.acquireTokenWithCachedRefreshToken.bind(this),Ie.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1)}async acquireTokenWithCachedRefreshToken(e,t){var r,a,o;(r=this.performanceClient)==null||r.addQueueMeasurement(Ie.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId);const i=_0(this.cacheManager.getRefreshToken.bind(this.cacheManager),Ie.CacheManagerGetRefreshToken,this.logger,this.performanceClient,e.correlationId)(e.account,t,void 0,this.performanceClient,e.correlationId);if(!i)throw F6($3);if(i.expiresOn&&P6(i.expiresOn,e.refreshTokenExpirationOffsetSeconds||TQ))throw(a=this.performanceClient)==null||a.addFields({rtExpiresOnMs:Number(i.expiresOn)},e.correlationId),F6(__);const s={...e,refreshToken:i.secret,authenticationScheme:e.authenticationScheme||gi.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:Va.HOME_ACCOUNT_ID}};try{return await mt(this.acquireToken.bind(this),Ie.RefreshTokenClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(s)}catch(l){if(l instanceof sl&&((o=this.performanceClient)==null||o.addFields({rtExpiresOnMs:Number(i.expiresOn)},e.correlationId),l.subError===_y)){this.logger.verbose("acquireTokenWithRefreshToken: bad refresh token, removing from cache");const c=Cp(i);this.cacheManager.removeRefreshToken(c)}throw l}}async executeTokenRequest(e,t){var l,c;(l=this.performanceClient)==null||l.addQueueMeasurement(Ie.RefreshTokenClientExecuteTokenRequest,e.correlationId);const i=this.createTokenQueryParameters(e),s=Jn.appendQueryString(t.tokenEndpoint,i),r=await mt(this.createTokenRequestBody.bind(this),Ie.RefreshTokenClientCreateTokenRequestBody,this.logger,this.performanceClient,e.correlationId)(e),a=this.createTokenRequestHeaders(e.ccsCredential),o={clientId:((c=e.tokenBodyParameters)==null?void 0:c.clientId)||this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid};return mt(this.executePostToTokenEndpoint.bind(this),Ie.RefreshTokenClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,e.correlationId)(s,r,a,o,e.correlationId,Ie.RefreshTokenClientExecutePostToTokenEndpoint)}async createTokenRequestBody(e){var s,r,a;(s=this.performanceClient)==null||s.addQueueMeasurement(Ie.RefreshTokenClientCreateTokenRequestBody,e.correlationId);const t=e.correlationId,i=new Ap(t,this.performanceClient);if(i.addClientId(e.embeddedClientId||((r=e.tokenBodyParameters)==null?void 0:r[Zd])||this.config.authOptions.clientId),e.redirectUri&&i.addRedirectUri(e.redirectUri),i.addScopes(e.scopes,!0,(a=this.config.authOptions.authority.options.OIDCOptions)==null?void 0:a.defaultScopes),i.addGrantType(SP.REFRESH_TOKEN_GRANT),i.addClientInfo(),i.addLibraryInfo(this.config.libraryInfo),i.addApplicationTelemetry(this.config.telemetry.application),i.addThrottling(),this.serverTelemetryManager&&!O6(this.config)&&i.addServerTelemetry(this.serverTelemetryManager),i.addRefreshToken(e.refreshToken),this.config.clientCredentials.clientSecret&&i.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const o=this.config.clientCredentials.clientAssertion;i.addClientAssertion(await xN(o.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),i.addClientAssertionType(o.assertionType)}if(e.authenticationScheme===gi.POP){const o=new Bg(this.cryptoUtils,this.performanceClient);let l;e.popKid?l=this.cryptoUtils.encodeKid(e.popKid):l=(await mt(o.generateCnf.bind(o),Ie.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,i.addPopToken(l)}else if(e.authenticationScheme===gi.SSH)if(e.sshJwk)i.addSshJwk(e.sshJwk);else throw yi(xy);if((!tc.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&i.addClaims(e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case Va.HOME_ACCOUNT_ID:try{const o=Uf(e.ccsCredential.credential);i.addCcsOid(o)}catch(o){this.logger.verbose("Could not parse home account ID for CCS Header: "+o)}break;case Va.UPN:i.addCcsUpn(e.ccsCredential.credential);break}return e.embeddedClientId&&i.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),e.tokenBodyParameters&&i.addExtraQueryParameters(e.tokenBodyParameters),i.createQueryString()}}/*! @azure/msal-common v15.2.0 2025-02-18 */class MQ extends w_{constructor(e,t){super(e,t)}async acquireCachedToken(e){var l;(l=this.performanceClient)==null||l.addQueueMeasurement(Ie.SilentFlowClientAcquireCachedToken,e.correlationId);let t=hu.NOT_APPLICABLE;if(e.forceRefresh||!this.config.cacheOptions.claimsBasedCachingEnabled&&!tc.isEmptyObj(e.claims))throw this.setCacheOutcome(hu.FORCE_REFRESH_OR_CLAIMS,e.correlationId),gt(Fh);if(!e.account)throw gt(s_);const i=e.account.tenantId||yQ(e.authority),s=this.cacheManager.getTokenKeys(),r=this.cacheManager.getAccessToken(e.account,e,s,i,this.performanceClient,e.correlationId);if(r){if(nZ(r.cachedAt)||P6(r.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.setCacheOutcome(hu.CACHED_ACCESS_TOKEN_EXPIRED,e.correlationId),gt(Fh);r.refreshOn&&P6(r.refreshOn,0)&&(t=hu.PROACTIVELY_REFRESHED)}else throw this.setCacheOutcome(hu.NO_CACHED_ACCESS_TOKEN,e.correlationId),gt(Fh);const a=e.authority||this.authority.getPreferredCache(),o={account:this.cacheManager.readAccountFromCache(e.account),accessToken:r,idToken:this.cacheManager.getIdToken(e.account,s,i,this.performanceClient,e.correlationId),refreshToken:null,appMetadata:this.cacheManager.readAppMetadataFromCache(a)};return this.setCacheOutcome(t,e.correlationId),this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[await mt(this.generateResultFromCacheRecord.bind(this),Ie.SilentFlowClientGenerateResultFromCacheRecord,this.logger,this.performanceClient,e.correlationId)(o,e),t]}setCacheOutcome(e,t){var i,s;(i=this.serverTelemetryManager)==null||i.setCacheOutcome(e),(s=this.performanceClient)==null||s.addFields({cacheOutcome:e},t),e!==hu.NOT_APPLICABLE&&this.logger.info(`Token refresh is required due to cache outcome: ${e}`)}async generateResultFromCacheRecord(e,t){var s;(s=this.performanceClient)==null||s.addQueueMeasurement(Ie.SilentFlowClientGenerateResultFromCacheRecord,t.correlationId);let i;if(e.idToken&&(i=Qg(e.idToken.secret,this.config.cryptoInterface.base64Decode)),t.maxAge||t.maxAge===0){const r=i==null?void 0:i.auth_time;if(!r)throw gt(i_);WP(r,t.maxAge)}return Qd.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,i)}}/*! @azure/msal-common v15.2.0 2025-02-18 */const PQ={sendGetRequestAsync:()=>Promise.reject(gt(Pn)),sendPostRequestAsync:()=>Promise.reject(gt(Pn))};/*! @azure/msal-common v15.2.0 2025-02-18 */const jC=",",wN="|";function NQ(n){const{skus:e,libraryName:t,libraryVersion:i,extensionName:s,extensionVersion:r}=n,a=new Map([[0,[t,i]],[2,[s,r]]]);let o=[];if(e!=null&&e.length){if(o=e.split(jC),o.length<4)return e}else o=Array.from({length:4},()=>wN);return a.forEach((l,c)=>{var h,u;l.length===2&&((h=l[0])!=null&&h.length)&&((u=l[1])!=null&&u.length)&&OQ({skuArr:o,index:c,skuName:l[0],skuVersion:l[1]})}),o.join(jC)}function OQ(n){const{skuArr:e,index:t,skuName:i,skuVersion:s}=n;t>=e.length||(e[t]=[i,s].join(wN))}class n2{constructor(e,t){this.cacheOutcome=hu.NOT_APPLICABLE,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||qe.EMPTY_STRING,this.wrapperVer=e.wrapperVer||qe.EMPTY_STRING,this.telemetryCacheKey=$s.CACHE_KEY+Ar.CACHE_KEY_SEPARATOR+e.clientId}generateCurrentRequestHeaderValue(){const e=`${this.apiId}${$s.VALUE_SEPARATOR}${this.cacheOutcome}`,t=[this.wrapperSKU,this.wrapperVer],i=this.getNativeBrokerErrorCode();i!=null&&i.length&&t.push(`broker_error=${i}`);const s=t.join($s.VALUE_SEPARATOR),r=this.getRegionDiscoveryFields(),a=[e,r].join($s.VALUE_SEPARATOR);return[$s.SCHEMA_VERSION,a,s].join($s.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){const e=this.getLastRequests(),t=n2.maxErrorsToSend(e),i=e.failedRequests.slice(0,2*t).join($s.VALUE_SEPARATOR),s=e.errors.slice(0,t).join($s.VALUE_SEPARATOR),r=e.errors.length,a=t<r?$s.OVERFLOW_TRUE:$s.OVERFLOW_FALSE,o=[r,a].join($s.VALUE_SEPARATOR);return[$s.SCHEMA_VERSION,e.cacheHits,i,s,o].join($s.CATEGORY_SEPARATOR)}cacheFailedRequest(e){const t=this.getLastRequests();t.errors.length>=$s.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),e instanceof Error&&e&&e.toString()?e instanceof Ui?e.subError?t.errors.push(e.subError):e.errorCode?t.errors.push(e.errorCode):t.errors.push(e.toString()):t.errors.push(e.toString()):t.errors.push($s.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)}incrementCacheHits(){const e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits}getLastRequests(){const e={failedRequests:[],errors:[],cacheHits:0};return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||e}clearTelemetryCache(){const e=this.getLastRequests(),t=n2.maxErrorsToSend(e),i=e.errors.length;if(t===i)this.cacheManager.removeItem(this.telemetryCacheKey);else{const s={failedRequests:e.failedRequests.slice(t*2),errors:e.errors.slice(t),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,s)}}static maxErrorsToSend(e){let t,i=0,s=0;const r=e.errors.length;for(t=0;t<r;t++){const a=e.failedRequests[2*t]||qe.EMPTY_STRING,o=e.failedRequests[2*t+1]||qe.EMPTY_STRING,l=e.errors[t]||qe.EMPTY_STRING;if(s+=a.toString().length+o.toString().length+l.length+3,s<$s.MAX_LAST_HEADER_BYTES)i+=1;else break}return i}getRegionDiscoveryFields(){const e=[];return e.push(this.regionUsed||qe.EMPTY_STRING),e.push(this.regionSource||qe.EMPTY_STRING),e.push(this.regionOutcome||qe.EMPTY_STRING),e.join(",")}updateRegionDiscoveryMetadata(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome}setCacheOutcome(e){this.cacheOutcome=e}setNativeBrokerErrorCode(e){const t=this.getLastRequests();t.nativeBrokerErrorCode=e,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)}getNativeBrokerErrorCode(){return this.getLastRequests().nativeBrokerErrorCode}clearNativeBrokerErrorCode(){const e=this.getLastRequests();delete e.nativeBrokerErrorCode,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e)}static makeExtraSkuString(e){return NQ(e)}}/*! @azure/msal-common v15.2.0 2025-02-18 */const _N="missing_kid_error",vN="missing_alg_error";/*! @azure/msal-common v15.2.0 2025-02-18 */const DQ={[_N]:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided.",[vN]:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."};class k_ extends Ui{constructor(e,t){super(e,t),this.name="JoseHeaderError",Object.setPrototypeOf(this,k_.prototype)}}function GC(n){return new k_(n,DQ[n])}/*! @azure/msal-common v15.2.0 2025-02-18 */class C_{constructor(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}static getShrHeaderString(e){if(!e.kid)throw GC(_N);if(!e.alg)throw GC(vN);const t=new C_({typ:e.typ||HJ.Pop,kid:e.kid,alg:e.alg});return JSON.stringify(t)}}/*! @azure/msal-common v15.2.0 2025-02-18 */class VC{startMeasurement(){}endMeasurement(){}flushMeasurement(){return null}}class FQ{generateId(){return"callback-id"}startMeasurement(e,t){return{end:()=>null,discard:()=>{},add:()=>{},increment:()=>{},event:{eventId:this.generateId(),status:xQ.InProgress,authority:"",libraryName:"",libraryVersion:"",clientId:"",name:e,startTimeMs:Date.now(),correlationId:t||""},measurement:new VC}}startPerformanceMeasurement(){return new VC}calculateQueuedTime(){return 0}addQueueMeasurement(){}setPreQueueTime(){}endMeasurement(){return null}discardMeasurements(){}removePerformanceCallback(){return!0}addPerformanceCallback(){return""}emitEvents(){}addFields(){}incrementFields(){}cacheEventByCorrelationId(){}}/*! @azure/msal-browser v4.5.0 2025-02-26 */const A_="pkce_not_created",L6="crypto_nonexistent",vy="empty_navigate_uri",kN="hash_empty_error",S_="no_state_in_hash",CN="hash_does_not_contain_known_properties",AN="unable_to_parse_state",SN="state_interaction_type_mismatch",IN="interaction_in_progress",EN="popup_window_error",TN="empty_window_error",$d="user_cancelled",LQ="monitor_popup_timeout",RN="monitor_window_timeout",MN="redirect_in_iframe",PN="block_iframe_reload",NN="block_nested_popups",BQ="iframe_closed_prematurely",ky="silent_logout_unsupported",ON="no_account_error",UQ="silent_prompt_value_error",DN="no_token_request_cache_error",FN="unable_to_parse_token_request_cache_error",I_="no_cached_authority_error",HQ="auth_request_not_set_error",zQ="invalid_cache_type",Cy="non_browser_environment",Of="database_not_open",e5="no_network_connectivity",LN="post_request_failed",BN="get_request_failed",B6="failed_to_parse_response",UN="unable_to_load_token",E_="crypto_key_not_found",HN="auth_code_required",zN="auth_code_or_nativeAccountId_required",jN="spa_code_and_nativeAccountId_present",T_="database_unavailable",GN="unable_to_acquire_token_from_native_platform",VN="native_handshake_timeout",qN="native_extension_not_installed",vx="native_connection_not_established",t5="uninitialized_public_client_application",WN="native_prompt_not_supported",KN="invalid_base64_string",XN="invalid_pop_token_request",YN="failed_to_build_headers",JN="failed_to_parse_headers";/*! @azure/msal-browser v4.5.0 2025-02-26 */const hc="For more visit: aka.ms/msaljs/browser-errors",jQ={[A_]:"The PKCE code challenge and verifier could not be generated.",[L6]:"The crypto object or function is not available.",[vy]:"Navigation URI is empty. Please check stack trace for more info.",[kN]:`Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. ${hc}`,[S_]:"Hash does not contain state. Please verify that the request originated from msal.",[CN]:`Hash does not contain known properites. Please verify that your redirectUri is not changing the hash.  ${hc}`,[AN]:"Unable to parse state. Please verify that the request originated from msal.",[SN]:"Hash contains state but the interaction type does not match the caller.",[IN]:`Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.   ${hc}`,[EN]:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",[TN]:"window.open returned null or undefined window object.",[$d]:"User cancelled the flow.",[LQ]:`Token acquisition in popup failed due to timeout.  ${hc}`,[RN]:`Token acquisition in iframe failed due to timeout.  ${hc}`,[MN]:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs.",[PN]:`Request was blocked inside an iframe because MSAL detected an authentication response.  ${hc}`,[NN]:"Request was blocked inside a popup because MSAL detected it was running in a popup.",[BQ]:"The iframe being monitored was closed prematurely.",[ky]:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead.",[ON]:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request.",[UQ]:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'.",[DN]:"No token request found in cache.",[FN]:"The cached token request could not be parsed.",[I_]:"No cached authority found.",[HQ]:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler",[zQ]:"Invalid cache type",[Cy]:"Login and token requests are not supported in non-browser environments.",[Of]:"Database is not open!",[e5]:"No network connectivity. Check your internet connection.",[LN]:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'",[BN]:"Network request failed. Please check the network trace to determine root cause.",[B6]:"Failed to parse network response. Check network trace.",[UN]:"Error loading token to cache.",[E_]:"Cryptographic Key or Keypair not found in browser storage.",[HN]:"An authorization code must be provided (as the `code` property on the request) to this flow.",[zN]:"An authorization code or nativeAccountId must be provided to this flow.",[jN]:"Request cannot contain both spa code and native account id.",[T_]:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts.",[GN]:`Unable to acquire token from native platform.  ${hc}`,[VN]:"Timed out while attempting to establish connection to browser extension",[qN]:"Native extension is not installed. If you think this is a mistake call the initialize function.",[vx]:`Connection to native platform has not been established. Please install a compatible browser extension and run initialize().  ${hc}`,[t5]:`You must call and await the initialize function before attempting to call any other MSAL API.  ${hc}`,[WN]:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow.",[KN]:"Invalid base64 encoded string.",[XN]:"Invalid PoP token request. The request should not have both a popKid value and signPopToken set to true.",[YN]:"Failed to build request headers object.",[JN]:"Failed to parse response headers"};class kx extends Ui{constructor(e,t){super(e,jQ[e],t),Object.setPrototypeOf(this,kx.prototype),this.name="BrowserAuthError"}}function Ht(n,e){return new kx(n,e)}/*! @azure/msal-browser v4.5.0 2025-02-26 */const za={INTERACTION_IN_PROGRESS_VALUE:"interaction_in_progress",INVALID_GRANT_ERROR:"invalid_grant",POPUP_WIDTH:483,POPUP_HEIGHT:600,POPUP_NAME_PREFIX:"msal",DEFAULT_POLL_INTERVAL_MS:30,MSAL_SKU:"msal.js.browser"},Hf={CHANNEL_ID:"53ee284d-920a-4b59-9d30-a60315b26836",PREFERRED_EXTENSION_ID:"ppnbnpeolgkicgegkbkbjmhlideopiji",MATS_TELEMETRY:"MATS"},_u={HandshakeRequest:"Handshake",HandshakeResponse:"HandshakeResponse",GetToken:"GetToken",Response:"Response"},ur={LocalStorage:"localStorage",SessionStorage:"sessionStorage",MemoryStorage:"memoryStorage"},qC={GET:"GET",POST:"POST"},ci={AUTHORITY:"authority",ACQUIRE_TOKEN_ACCOUNT:"acquireToken.account",SESSION_STATE:"session.state",REQUEST_STATE:"request.state",NONCE_IDTOKEN:"nonce.id_token",ORIGIN_URI:"request.origin",RENEW_STATUS:"token.renew.status",URL_HASH:"urlHash",REQUEST_PARAMS:"request.params",SCOPES:"scopes",INTERACTION_STATUS_KEY:"interaction.status",CCS_CREDENTIAL:"ccs.credential",CORRELATION_ID:"request.correlationId",NATIVE_REQUEST:"request.native",REDIRECT_CONTEXT:"request.redirect.context"},Oh={ACCOUNT_KEYS:"msal.account.keys",TOKEN_KEYS:"msal.token.keys"},f9={WRAPPER_SKU:"wrapper.sku",WRAPPER_VER:"wrapper.version"},Ii={acquireTokenRedirect:861,acquireTokenPopup:862,ssoSilent:863,acquireTokenSilent_authCode:864,handleRedirectPromise:865,acquireTokenByCode:866,acquireTokenSilent_silentFlow:61,logout:961,logoutPopup:962};var rn;(function(n){n.Redirect="redirect",n.Popup="popup",n.Silent="silent",n.None="none"})(rn||(rn={}));const WC={scopes:wx},ZN="jwk",U6="msal.db",GQ=1,VQ=`${U6}.keys`,wa={Default:0,AccessToken:1,AccessTokenAndRefreshToken:2,RefreshToken:3,RefreshTokenAndNetwork:4,Skip:5},qQ=[wa.Default,wa.Skip,wa.RefreshTokenAndNetwork],WQ="msal.browser.log.level",KQ="msal.browser.log.pii";/*! @azure/msal-browser v4.5.0 2025-02-26 */function g9(n){return encodeURIComponent(R_(n).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))}function ef(n){return QN(n).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function R_(n){return QN(new TextEncoder().encode(n))}function QN(n){const e=Array.from(n,t=>String.fromCodePoint(t)).join("");return btoa(e)}/*! @azure/msal-browser v4.5.0 2025-02-26 */function u0(n){return new TextDecoder().decode(n5(n))}function n5(n){let e=n.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw Ht(KN)}const t=atob(e);return Uint8Array.from(t,i=>i.codePointAt(0)||0)}/*! @azure/msal-browser v4.5.0 2025-02-26 */const XQ="RSASSA-PKCS1-v1_5",Ay="AES-GCM",$N="HKDF",M_="SHA-256",YQ=2048,JQ=new Uint8Array([1,0,1]),KC="0123456789abcdef",XC=new Uint32Array(1),eO="raw",tO="encrypt",nO="decrypt",ZQ="deriveKey",QQ="crypto_subtle_undefined",P_={name:XQ,hash:M_,modulusLength:YQ,publicExponent:JQ};function $Q(n){if(!window)throw Ht(Cy);if(!window.crypto)throw Ht(L6);if(!n&&!window.crypto.subtle)throw Ht(L6,QQ)}async function iO(n,e,t){e==null||e.addQueueMeasurement(Ie.Sha256Digest,t);const s=new TextEncoder().encode(n);return window.crypto.subtle.digest(M_,s)}function e$(n){return window.crypto.getRandomValues(n)}function Vw(){return window.crypto.getRandomValues(XC),XC[0]}function rl(){const n=Date.now(),e=Vw()*1024+(Vw()&1023),t=new Uint8Array(16),i=Math.trunc(e/2**30),s=e&2**30-1,r=Vw();t[0]=n/2**40,t[1]=n/2**32,t[2]=n/2**24,t[3]=n/2**16,t[4]=n/2**8,t[5]=n,t[6]=112|i>>>8,t[7]=i,t[8]=128|s>>>24,t[9]=s>>>16,t[10]=s>>>8,t[11]=s,t[12]=r>>>24,t[13]=r>>>16,t[14]=r>>>8,t[15]=r;let a="";for(let o=0;o<t.length;o++)a+=KC.charAt(t[o]>>>4),a+=KC.charAt(t[o]&15),(o===3||o===5||o===7||o===9)&&(a+="-");return a}async function t$(n,e){return window.crypto.subtle.generateKey(P_,n,e)}async function qw(n){return window.crypto.subtle.exportKey(ZN,n)}async function n$(n,e,t){return window.crypto.subtle.importKey(ZN,n,P_,e,t)}async function i$(n,e){return window.crypto.subtle.sign(P_,n,e)}async function s$(){const n=await window.crypto.subtle.generateKey({name:Ay,length:256},!0,[tO,nO]);return window.crypto.subtle.exportKey(eO,n)}async function YC(n){return window.crypto.subtle.importKey(eO,n,$N,!1,[ZQ])}async function sO(n,e,t){return window.crypto.subtle.deriveKey({name:$N,salt:e,hash:M_,info:new TextEncoder().encode(t)},n,{name:Ay,length:256},!1,[tO,nO])}async function r$(n,e,t){const i=new TextEncoder().encode(e),s=window.crypto.getRandomValues(new Uint8Array(16)),r=await sO(n,s,t),a=await window.crypto.subtle.encrypt({name:Ay,iv:new Uint8Array(12)},r,i);return{data:ef(new Uint8Array(a)),nonce:ef(s)}}async function a$(n,e,t,i){const s=n5(i),r=await sO(n,n5(e),t),a=await window.crypto.subtle.decrypt({name:Ay,iv:new Uint8Array(12)},r,s);return new TextDecoder().decode(a)}async function rO(n){const e=await iO(n),t=new Uint8Array(e);return ef(t)}/*! @azure/msal-browser v4.5.0 2025-02-26 */const i2="storage_not_supported",H6="stubbed_public_client_application_called",i5="in_mem_redirect_unavailable";/*! @azure/msal-browser v4.5.0 2025-02-26 */const u3={[i2]:"Given storage configuration option was not supported.",[H6]:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors",[i5]:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."};u3[i2],u3[H6],u3[i5];class N_ extends Ui{constructor(e,t){super(e,t),this.name="BrowserConfigurationAuthError",Object.setPrototypeOf(this,N_.prototype)}}function O_(n){return new N_(n,u3[n])}/*! @azure/msal-browser v4.5.0 2025-02-26 */function o$(n){n.location.hash="",typeof n.history.replaceState=="function"&&n.history.replaceState(null,"",`${n.location.origin}${n.location.pathname}${n.location.search}`)}function l$(n){const e=n.split("#");e.shift(),window.location.hash=e.length>0?e.join("#"):""}function D_(){return window.parent!==window}function c$(){return typeof window<"u"&&!!window.opener&&window.opener!==window&&typeof window.name=="string"&&window.name.indexOf(`${za.POPUP_NAME_PREFIX}.`)===0}function i0(){return typeof window<"u"&&window.location?window.location.href.split("?")[0].split("#")[0]:""}function h$(){const e=new Jn(window.location.href).getUrlComponents();return`${e.Protocol}//${e.HostNameAndPort}/`}function u$(){if(Jn.hashContainsKnownProperties(window.location.hash)&&D_())throw Ht(PN)}function d$(n){if(D_()&&!n)throw Ht(MN)}function f$(){if(c$())throw Ht(NN)}function aO(){if(typeof window>"u")throw Ht(Cy)}function oO(n){if(!n)throw Ht(t5)}function F_(n){aO(),u$(),f$(),oO(n)}function JC(n,e){if(F_(n),d$(e.system.allowRedirectInIframe),e.cache.cacheLocation===ur.MemoryStorage&&!e.cache.storeAuthStateInCookie)throw O_(i5)}function lO(n){const e=document.createElement("link");e.rel="preconnect",e.href=new URL(n).origin,e.crossOrigin="anonymous",document.head.appendChild(e),window.setTimeout(()=>{try{document.head.removeChild(e)}catch{}},1e4)}function g$(){return rl()}/*! @azure/msal-browser v4.5.0 2025-02-26 */class s5{navigateInternal(e,t){return s5.defaultNavigateWindow(e,t)}navigateExternal(e,t){return s5.defaultNavigateWindow(e,t)}static defaultNavigateWindow(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise(i=>{setTimeout(()=>{i(!0)},t.timeout)})}}/*! @azure/msal-browser v4.5.0 2025-02-26 */class m${async sendGetRequestAsync(e,t){let i,s={},r=0;const a=ZC(t);try{i=await fetch(e,{method:qC.GET,headers:a})}catch{throw Ht(window.navigator.onLine?BN:e5)}s=QC(i.headers);try{return r=i.status,{headers:s,body:await i.json(),status:r}}catch{throw UC(Ht(B6),r,s)}}async sendPostRequestAsync(e,t){const i=t&&t.body||"",s=ZC(t);let r,a=0,o={};try{r=await fetch(e,{method:qC.POST,headers:s,body:i})}catch{throw Ht(window.navigator.onLine?LN:e5)}o=QC(r.headers);try{return a=r.status,{headers:o,body:await r.json(),status:a}}catch{throw UC(Ht(B6),a,o)}}}function ZC(n){try{const e=new Headers;if(!(n&&n.headers))return e;const t=n.headers;return Object.entries(t).forEach(([i,s])=>{e.append(i,s)}),e}catch{throw Ht(YN)}}function QC(n){try{const e={};return n.forEach((t,i)=>{e[i]=t}),e}catch{throw Ht(JN)}}/*! @azure/msal-browser v4.5.0 2025-02-26 */const p$=6e4,z6=1e4,b$=3e4,x$=2e3;function y$({auth:n,cache:e,system:t,telemetry:i},s){const r={clientId:qe.EMPTY_STRING,authority:`${qe.DEFAULT_AUTHORITY}`,knownAuthorities:[],cloudDiscoveryMetadata:qe.EMPTY_STRING,authorityMetadata:qe.EMPTY_STRING,redirectUri:typeof window<"u"?i0():"",postLogoutRedirectUri:qe.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:h0.AAD,OIDCOptions:{serverResponseType:_x.FRAGMENT,defaultScopes:[qe.OPENID_SCOPE,qe.PROFILE_SCOPE,qe.OFFLINE_ACCESS_SCOPE]},azureCloudOptions:{azureCloudInstance:c_.None,tenant:qe.EMPTY_STRING},skipAuthorityMetadataCache:!1,supportsNestedAppAuth:!1,instanceAware:!1},a={cacheLocation:ur.SessionStorage,temporaryCacheLocation:ur.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!!(e&&e.cacheLocation===ur.LocalStorage),claimsBasedCachingEnabled:!1},o={loggerCallback:()=>{},logLevel:Ni.Info,piiLoggingEnabled:!1},c={...{...fN,loggerOptions:o,networkClient:s?new m$:PQ,navigationClient:new s5,loadFrameTimeout:0,windowHashTimeout:(t==null?void 0:t.loadFrameTimeout)||p$,iframeHashTimeout:(t==null?void 0:t.loadFrameTimeout)||z6,navigateFrameWait:0,redirectNavigationTimeout:b$,asyncPopups:!1,allowRedirectInIframe:!1,allowPlatformBroker:!1,nativeBrokerHandshakeTimeout:(t==null?void 0:t.nativeBrokerHandshakeTimeout)||x$,pollIntervalMilliseconds:za.DEFAULT_POLL_INTERVAL_MS},...t,loggerOptions:(t==null?void 0:t.loggerOptions)||o},h={application:{appName:qe.EMPTY_STRING,appVersion:qe.EMPTY_STRING},client:new FQ};if((n==null?void 0:n.protocolMode)!==h0.OIDC&&(n!=null&&n.OIDCOptions)&&new jh(c.loggerOptions).warning(JSON.stringify(yi(rN))),n!=null&&n.protocolMode&&n.protocolMode!==h0.AAD&&(c!=null&&c.allowPlatformBroker))throw yi(aN);return{auth:{...r,...n,OIDCOptions:{...r.OIDCOptions,...n==null?void 0:n.OIDCOptions}},cache:{...a,...e},system:c,telemetry:{...h,...i}}}/*! @azure/msal-browser v4.5.0 2025-02-26 */const w$="@azure/msal-browser",Sy="4.5.0";/*! @azure/msal-browser v4.5.0 2025-02-26 */class L_{static loggerCallback(e,t){switch(e){case Ni.Error:console.error(t);return;case Ni.Info:console.info(t);return;case Ni.Verbose:return;case Ni.Warning:console.warn(t);return;default:return}}constructor(e){var l;this.browserEnvironment=typeof window<"u",this.config=y$(e,this.browserEnvironment);let t;try{t=window[ur.SessionStorage]}catch{}const i=t==null?void 0:t.getItem(WQ),s=(l=t==null?void 0:t.getItem(KQ))==null?void 0:l.toLowerCase(),r=s==="true"?!0:s==="false"?!1:void 0,a={...this.config.system.loggerOptions},o=i&&Object.keys(Ni).includes(i)?Ni[i]:void 0;o&&(a.loggerCallback=L_.loggerCallback,a.logLevel=o),r!==void 0&&(a.piiLoggingEnabled=r),this.logger=new jh(a,w$,Sy),this.available=!1}getConfig(){return this.config}getLogger(){return this.logger}isAvailable(){return this.available}isBrowserEnvironment(){return this.browserEnvironment}}/*! @azure/msal-browser v4.5.0 2025-02-26 */class tf extends L_{getModuleName(){return tf.MODULE_NAME}getId(){return tf.ID}async initialize(){return this.available=typeof window<"u",this.available}}tf.MODULE_NAME="";tf.ID="StandardOperatingContext";/*! @azure/msal-browser v4.5.0 2025-02-26 */class _${constructor(){this.dbName=U6,this.version=GQ,this.tableName=VQ,this.dbOpen=!1}async open(){return new Promise((e,t)=>{const i=window.indexedDB.open(this.dbName,this.version);i.addEventListener("upgradeneeded",s=>{s.target.result.createObjectStore(this.tableName)}),i.addEventListener("success",s=>{const r=s;this.db=r.target.result,this.dbOpen=!0,e()}),i.addEventListener("error",()=>t(Ht(T_)))})}closeConnection(){const e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)}async validateDbIsOpen(){if(!this.dbOpen)return this.open()}async getItem(e){return await this.validateDbIsOpen(),new Promise((t,i)=>{if(!this.db)return i(Ht(Of));const a=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).get(e);a.addEventListener("success",o=>{const l=o;this.closeConnection(),t(l.target.result)}),a.addEventListener("error",o=>{this.closeConnection(),i(o)})})}async setItem(e,t){return await this.validateDbIsOpen(),new Promise((i,s)=>{if(!this.db)return s(Ht(Of));const o=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).put(t,e);o.addEventListener("success",()=>{this.closeConnection(),i()}),o.addEventListener("error",l=>{this.closeConnection(),s(l)})})}async removeItem(e){return await this.validateDbIsOpen(),new Promise((t,i)=>{if(!this.db)return i(Ht(Of));const a=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).delete(e);a.addEventListener("success",()=>{this.closeConnection(),t()}),a.addEventListener("error",o=>{this.closeConnection(),i(o)})})}async getKeys(){return await this.validateDbIsOpen(),new Promise((e,t)=>{if(!this.db)return t(Ht(Of));const r=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).getAllKeys();r.addEventListener("success",a=>{const o=a;this.closeConnection(),e(o.target.result)}),r.addEventListener("error",a=>{this.closeConnection(),t(a)})})}async containsKey(e){return await this.validateDbIsOpen(),new Promise((t,i)=>{if(!this.db)return i(Ht(Of));const a=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).count(e);a.addEventListener("success",o=>{const l=o;this.closeConnection(),t(l.target.result===1)}),a.addEventListener("error",o=>{this.closeConnection(),i(o)})})}async deleteDatabase(){return this.db&&this.dbOpen&&this.closeConnection(),new Promise((e,t)=>{const i=window.indexedDB.deleteDatabase(U6),s=setTimeout(()=>t(!1),200);i.addEventListener("success",()=>(clearTimeout(s),e(!0))),i.addEventListener("blocked",()=>(clearTimeout(s),e(!0))),i.addEventListener("error",()=>(clearTimeout(s),t(!1)))})}}/*! @azure/msal-browser v4.5.0 2025-02-26 */class Iy{constructor(){this.cache=new Map}async initialize(){}getItem(e){return this.cache.get(e)||null}getUserData(e){return this.getItem(e)}setItem(e,t){this.cache.set(e,t)}async setUserData(e,t){this.setItem(e,t)}removeItem(e){this.cache.delete(e)}getKeys(){const e=[];return this.cache.forEach((t,i)=>{e.push(i)}),e}containsKey(e){return this.cache.has(e)}clear(){this.cache.clear()}}/*! @azure/msal-browser v4.5.0 2025-02-26 */class v${constructor(e){this.inMemoryCache=new Iy,this.indexedDBCache=new _$,this.logger=e}handleDatabaseAccessError(e){if(e instanceof kx&&e.errorCode===T_)this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.");else throw e}async getItem(e){const t=this.inMemoryCache.getItem(e);if(!t)try{return this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.getItem(e)}catch(i){this.handleDatabaseAccessError(i)}return t}async setItem(e,t){this.inMemoryCache.setItem(e,t);try{await this.indexedDBCache.setItem(e,t)}catch(i){this.handleDatabaseAccessError(i)}}async removeItem(e){this.inMemoryCache.removeItem(e);try{await this.indexedDBCache.removeItem(e)}catch(t){this.handleDatabaseAccessError(t)}}async getKeys(){const e=this.inMemoryCache.getKeys();if(e.length===0)try{return this.logger.verbose("In-memory cache is empty, now querying persistent storage."),await this.indexedDBCache.getKeys()}catch(t){this.handleDatabaseAccessError(t)}return e}async containsKey(e){const t=this.inMemoryCache.containsKey(e);if(!t)try{return this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.containsKey(e)}catch(i){this.handleDatabaseAccessError(i)}return t}clearInMemory(){this.logger.verbose("Deleting in-memory keystore"),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore deleted")}async clearPersistent(){try{this.logger.verbose("Deleting persistent keystore");const e=await this.indexedDBCache.deleteDatabase();return e&&this.logger.verbose("Persistent keystore deleted"),e}catch(e){return this.handleDatabaseAccessError(e),!1}}}/*! @azure/msal-browser v4.5.0 2025-02-26 */class Ug{constructor(e,t,i){this.logger=e,$Q(i??!1),this.cache=new v$(this.logger),this.performanceClient=t}createNewGuid(){return rl()}base64Encode(e){return R_(e)}base64Decode(e){return u0(e)}base64UrlEncode(e){return g9(e)}encodeKid(e){return this.base64UrlEncode(JSON.stringify({kid:e}))}async getPublicKeyThumbprint(e){var h;const t=(h=this.performanceClient)==null?void 0:h.startMeasurement(Ie.CryptoOptsGetPublicKeyThumbprint,e.correlationId),i=await t$(Ug.EXTRACTABLE,Ug.POP_KEY_USAGES),s=await qw(i.publicKey),r={e:s.e,kty:s.kty,n:s.n},a=$C(r),o=await this.hashString(a),l=await qw(i.privateKey),c=await n$(l,!1,["sign"]);return await this.cache.setItem(o,{privateKey:c,publicKey:i.publicKey,requestMethod:e.resourceRequestMethod,requestUri:e.resourceRequestUri}),t&&t.end({success:!0}),o}async removeTokenBindingKey(e){return await this.cache.removeItem(e),!await this.cache.containsKey(e)}async clearKeystore(){this.cache.clearInMemory();try{return await this.cache.clearPersistent(),!0}catch(e){return e instanceof Error?this.logger.error(`Clearing keystore failed with error: ${e.message}`):this.logger.error("Clearing keystore failed with unknown error"),!1}}async signJwt(e,t,i,s){var w;const r=(w=this.performanceClient)==null?void 0:w.startMeasurement(Ie.CryptoOptsSignJwt,s),a=await this.cache.getItem(t);if(!a)throw Ht(E_);const o=await qw(a.publicKey),l=$C(o),c=g9(JSON.stringify({kid:t})),h=C_.getShrHeaderString({...i==null?void 0:i.header,alg:o.alg,kid:c}),u=g9(h);e.cnf={jwk:JSON.parse(l)};const d=g9(JSON.stringify(e)),f=`${u}.${d}`,m=new TextEncoder().encode(f),x=await i$(a.privateKey,m),p=ef(new Uint8Array(x)),y=`${f}.${p}`;return r&&r.end({success:!0}),y}async hashString(e){return rO(e)}}Ug.POP_KEY_USAGES=["sign","verify"];Ug.EXTRACTABLE=!0;function $C(n){return JSON.stringify(n,Object.keys(n).sort())}/*! @azure/msal-browser v4.5.0 2025-02-26 */const k$=24*60*60*1e3,j6={Lax:"Lax",None:"None"};class cO{initialize(){return Promise.resolve()}getItem(e){const t=`${encodeURIComponent(e)}`,i=document.cookie.split(";");for(let s=0;s<i.length;s++){const r=i[s],[a,...o]=decodeURIComponent(r).trim().split("="),l=o.join("=");if(a===t)return l}return""}getUserData(){throw gt(Pn)}setItem(e,t,i,s=!0,r=j6.Lax){let a=`${encodeURIComponent(e)}=${encodeURIComponent(t)};path=/;SameSite=${r};`;if(i){const o=C$(i);a+=`expires=${o};`}(s||r===j6.None)&&(a+="Secure;"),document.cookie=a}async setUserData(){return Promise.reject(gt(Pn))}removeItem(e){this.setItem(e,"",-1)}getKeys(){const e=document.cookie.split(";"),t=[];return e.forEach(i=>{const s=decodeURIComponent(i).trim().split("=");t.push(s[0])}),t}containsKey(e){return this.getKeys().includes(e)}}function C$(n){const e=new Date;return new Date(e.getTime()+n*k$).toUTCString()}/*! @azure/msal-browser v4.5.0 2025-02-26 */function G6(n){const e=n.getItem(Oh.ACCOUNT_KEYS);return e?JSON.parse(e):[]}function V6(n,e){const t=e.getItem(`${Oh.TOKEN_KEYS}.${n}`);if(t){const i=JSON.parse(t);if(i&&i.hasOwnProperty("idToken")&&i.hasOwnProperty("accessToken")&&i.hasOwnProperty("refreshToken"))return i}return{idToken:[],accessToken:[],refreshToken:[]}}/*! @azure/msal-browser v4.5.0 2025-02-26 */const eA="msal.cache.encryption",A$="msal.broadcast.cache";class S${constructor(e,t,i){if(!window.localStorage)throw O_(i2);this.memoryStorage=new Iy,this.initialized=!1,this.clientId=e,this.logger=t,this.performanceClient=i,this.broadcast=new BroadcastChannel(A$)}async initialize(e){this.initialized=!0;const t=new cO,i=t.getItem(eA);let s={key:"",id:""};if(i)try{s=JSON.parse(i)}catch{}if(s.key&&s.id){const r=_0(n5,Ie.Base64Decode,this.logger,this.performanceClient,e)(s.key);this.encryptionCookie={id:s.id,key:await mt(YC,Ie.GenerateHKDF,this.logger,this.performanceClient,e)(r)},await mt(this.importExistingCache.bind(this),Ie.ImportExistingCache,this.logger,this.performanceClient,e)(e)}else{this.clear();const r=rl(),a=await mt(s$,Ie.GenerateBaseKey,this.logger,this.performanceClient,e)(),o=_0(ef,Ie.UrlEncodeArr,this.logger,this.performanceClient,e)(new Uint8Array(a));this.encryptionCookie={id:r,key:await mt(YC,Ie.GenerateHKDF,this.logger,this.performanceClient,e)(a)};const l={id:r,key:o};t.setItem(eA,JSON.stringify(l),0,!0,j6.None)}this.broadcast.addEventListener("message",this.updateCache.bind(this))}getItem(e){return window.localStorage.getItem(e)}getUserData(e){if(!this.initialized)throw Ht(t5);return this.memoryStorage.getItem(e)}setItem(e,t){window.localStorage.setItem(e,t)}async setUserData(e,t,i){if(!this.initialized||!this.encryptionCookie)throw Ht(t5);const{data:s,nonce:r}=await mt(r$,Ie.Encrypt,this.logger,this.performanceClient,i)(this.encryptionCookie.key,t,this.getContext(e)),a={id:this.encryptionCookie.id,nonce:r,data:s};this.memoryStorage.setItem(e,t),this.setItem(e,JSON.stringify(a)),this.broadcast.postMessage({key:e,value:t,context:this.getContext(e)})}removeItem(e){this.memoryStorage.containsKey(e)&&(this.memoryStorage.removeItem(e),this.broadcast.postMessage({key:e,value:null,context:this.getContext(e)})),window.localStorage.removeItem(e)}getKeys(){return Object.keys(window.localStorage)}containsKey(e){return window.localStorage.hasOwnProperty(e)}clear(){this.memoryStorage.clear(),G6(this).forEach(i=>this.removeItem(i));const t=V6(this.clientId,this);t.idToken.forEach(i=>this.removeItem(i)),t.accessToken.forEach(i=>this.removeItem(i)),t.refreshToken.forEach(i=>this.removeItem(i)),this.getKeys().forEach(i=>{(i.startsWith(qe.CACHE_PREFIX)||i.indexOf(this.clientId)!==-1)&&this.removeItem(i)})}async importExistingCache(e){if(!this.encryptionCookie)return;let t=G6(this);t=await this.importArray(t,e),this.setItem(Oh.ACCOUNT_KEYS,JSON.stringify(t));const i=V6(this.clientId,this);i.idToken=await this.importArray(i.idToken,e),i.accessToken=await this.importArray(i.accessToken,e),i.refreshToken=await this.importArray(i.refreshToken,e),this.setItem(`${Oh.TOKEN_KEYS}.${this.clientId}`,JSON.stringify(i))}async getItemFromEncryptedCache(e,t){if(!this.encryptionCookie)return null;const i=this.getItem(e);if(!i)return null;let s;try{s=JSON.parse(i)}catch{return null}return!s.id||!s.nonce||!s.data?(this.performanceClient.incrementFields({unencryptedCacheCount:1},t),null):s.id!==this.encryptionCookie.id?(this.performanceClient.incrementFields({encryptedCacheExpiredCount:1},t),null):mt(a$,Ie.Decrypt,this.logger,this.performanceClient,t)(this.encryptionCookie.key,s.nonce,this.getContext(e),s.data)}async importArray(e,t){const i=[],s=[];return e.forEach(r=>{const a=this.getItemFromEncryptedCache(r,t).then(o=>{o?(this.memoryStorage.setItem(r,o),i.push(r)):this.removeItem(r)});s.push(a)}),await Promise.all(s),i}getContext(e){let t="";return e.includes(this.clientId)&&(t=this.clientId),t}updateCache(e){this.logger.trace("Updating internal cache from broadcast event");const t=this.performanceClient.startMeasurement(Ie.LocalStorageUpdated);t.add({isBackground:!0});const{key:i,value:s,context:r}=e.data;if(!i){this.logger.error("Broadcast event missing key"),t.end({success:!1,errorCode:"noKey"});return}if(r&&r!==this.clientId){this.logger.trace(`Ignoring broadcast event from clientId: ${r}`),t.end({success:!1,errorCode:"contextMismatch"});return}s?(this.memoryStorage.setItem(i,s),this.logger.verbose("Updated item in internal cache")):(this.memoryStorage.removeItem(i),this.logger.verbose("Removed item from internal cache")),t.end({success:!0})}}/*! @azure/msal-browser v4.5.0 2025-02-26 */class I${constructor(){if(!window.sessionStorage)throw O_(i2)}async initialize(){}getItem(e){return window.sessionStorage.getItem(e)}getUserData(e){return this.getItem(e)}setItem(e,t){window.sessionStorage.setItem(e,t)}async setUserData(e,t){this.setItem(e,t)}removeItem(e){window.sessionStorage.removeItem(e)}getKeys(){return Object.keys(window.sessionStorage)}containsKey(e){return window.sessionStorage.hasOwnProperty(e)}}/*! @azure/msal-browser v4.5.0 2025-02-26 */function hO(n,e){if(!e)return null;try{return tl.parseRequestState(n,e).libraryState.meta}catch{throw gt(Lg)}}/*! @azure/msal-browser v4.5.0 2025-02-26 */const on={INITIALIZE_START:"msal:initializeStart",INITIALIZE_END:"msal:initializeEnd",ACCOUNT_ADDED:"msal:accountAdded",ACCOUNT_REMOVED:"msal:accountRemoved",ACTIVE_ACCOUNT_CHANGED:"msal:activeAccountChanged",LOGIN_START:"msal:loginStart",LOGIN_SUCCESS:"msal:loginSuccess",LOGIN_FAILURE:"msal:loginFailure",ACQUIRE_TOKEN_START:"msal:acquireTokenStart",ACQUIRE_TOKEN_SUCCESS:"msal:acquireTokenSuccess",ACQUIRE_TOKEN_FAILURE:"msal:acquireTokenFailure",ACQUIRE_TOKEN_NETWORK_START:"msal:acquireTokenFromNetworkStart",SSO_SILENT_START:"msal:ssoSilentStart",SSO_SILENT_SUCCESS:"msal:ssoSilentSuccess",SSO_SILENT_FAILURE:"msal:ssoSilentFailure",ACQUIRE_TOKEN_BY_CODE_START:"msal:acquireTokenByCodeStart",ACQUIRE_TOKEN_BY_CODE_SUCCESS:"msal:acquireTokenByCodeSuccess",ACQUIRE_TOKEN_BY_CODE_FAILURE:"msal:acquireTokenByCodeFailure",HANDLE_REDIRECT_START:"msal:handleRedirectStart",HANDLE_REDIRECT_END:"msal:handleRedirectEnd",POPUP_OPENED:"msal:popupOpened",LOGOUT_START:"msal:logoutStart",LOGOUT_SUCCESS:"msal:logoutSuccess",LOGOUT_FAILURE:"msal:logoutFailure",LOGOUT_END:"msal:logoutEnd",RESTORE_FROM_BFCACHE:"msal:restoreFromBFCache"};/*! @azure/msal-browser v4.5.0 2025-02-26 */class q6 extends N6{constructor(e,t,i,s,r,a,o){super(e,i,s,o),this.cacheConfig=t,this.logger=s,this.internalStorage=new Iy,this.browserStorage=tA(e,t.cacheLocation,s,r),this.temporaryCacheStorage=tA(e,t.temporaryCacheLocation,s,r),this.cookieStorage=new cO,this.performanceClient=r,this.eventHandler=a}async initialize(e){await this.browserStorage.initialize(e)}validateAndParseJson(e){try{const t=JSON.parse(e);return t&&typeof t=="object"?t:null}catch{return null}}getAccount(e){this.logger.trace("BrowserCacheManager.getAccount called");const t=this.browserStorage.getUserData(e);if(!t)return this.removeAccountKeyFromMap(e),null;const i=this.validateAndParseJson(t);return!i||!Xr.isAccountEntity(i)?(this.removeAccountKeyFromMap(e),null):N6.toObject(new Xr,i)}async setAccount(e,t){this.logger.trace("BrowserCacheManager.setAccount called");const i=e.generateAccountKey();await mt(this.browserStorage.setUserData.bind(this.browserStorage),Ie.SetUserData,this.logger,this.performanceClient)(i,JSON.stringify(e),t);const s=this.addAccountKeyToMap(i);this.cacheConfig.cacheLocation===ur.LocalStorage&&s&&this.eventHandler.emitEvent(on.ACCOUNT_ADDED,void 0,e.getAccountInfo())}getAccountKeys(){return G6(this.browserStorage)}addAccountKeyToMap(e){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii(`BrowserCacheManager.addAccountKeyToMap called with key: ${e}`);const t=this.getAccountKeys();return t.indexOf(e)===-1?(t.push(e),this.browserStorage.setItem(Oh.ACCOUNT_KEYS,JSON.stringify(t)),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added"),!0):(this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map"),!1)}removeAccountKeyFromMap(e){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii(`BrowserCacheManager.removeAccountKeyFromMap called with key: ${e}`);const t=this.getAccountKeys(),i=t.indexOf(e);i>-1?(t.splice(i,1),this.browserStorage.setItem(Oh.ACCOUNT_KEYS,JSON.stringify(t)),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")):this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")}async removeAccount(e){super.removeAccount(e),this.removeAccountKeyFromMap(e)}async removeAccountContext(e){await super.removeAccountContext(e),this.cacheConfig.cacheLocation===ur.LocalStorage&&this.eventHandler.emitEvent(on.ACCOUNT_REMOVED,void 0,e.getAccountInfo())}removeIdToken(e){super.removeIdToken(e),this.removeTokenKey(e,An.ID_TOKEN)}async removeAccessToken(e){super.removeAccessToken(e),this.removeTokenKey(e,An.ACCESS_TOKEN)}removeRefreshToken(e){super.removeRefreshToken(e),this.removeTokenKey(e,An.REFRESH_TOKEN)}getTokenKeys(){return V6(this.clientId,this.browserStorage)}addTokenKey(e,t){this.logger.trace("BrowserCacheManager addTokenKey called");const i=this.getTokenKeys();switch(t){case An.ID_TOKEN:i.idToken.indexOf(e)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),i.idToken.push(e));break;case An.ACCESS_TOKEN:i.accessToken.indexOf(e)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - accessToken added to map"),i.accessToken.push(e));break;case An.REFRESH_TOKEN:i.refreshToken.indexOf(e)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),i.refreshToken.push(e));break;default:throw this.logger.error(`BrowserCacheManager:addTokenKey - CredentialType provided invalid. CredentialType: ${t}`),gt(M6)}this.browserStorage.setItem(`${Oh.TOKEN_KEYS}.${this.clientId}`,JSON.stringify(i))}removeTokenKey(e,t){this.logger.trace("BrowserCacheManager removeTokenKey called");const i=this.getTokenKeys();switch(t){case An.ID_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove idToken with key: ${e} from map`);const s=i.idToken.indexOf(e);s>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - idToken removed from map"),i.idToken.splice(s,1)):this.logger.info("BrowserCacheManager: removeTokenKey - idToken does not exist in map. Either it was previously removed or it was never added.");break;case An.ACCESS_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove accessToken with key: ${e} from map`);const r=i.accessToken.indexOf(e);r>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - accessToken removed from map"),i.accessToken.splice(r,1)):this.logger.info("BrowserCacheManager: removeTokenKey - accessToken does not exist in map. Either it was previously removed or it was never added.");break;case An.REFRESH_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove refreshToken with key: ${e} from map`);const a=i.refreshToken.indexOf(e);a>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken removed from map"),i.refreshToken.splice(a,1)):this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken does not exist in map. Either it was previously removed or it was never added.");break;default:throw this.logger.error(`BrowserCacheManager:removeTokenKey - CredentialType provided invalid. CredentialType: ${t}`),gt(M6)}this.browserStorage.setItem(`${Oh.TOKEN_KEYS}.${this.clientId}`,JSON.stringify(i))}getIdTokenCredential(e){const t=this.browserStorage.getUserData(e);if(!t)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,An.ID_TOKEN),null;const i=this.validateAndParseJson(t);return!i||!sZ(i)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,An.ID_TOKEN),null):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),i)}async setIdTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");const i=Cp(e);await mt(this.browserStorage.setUserData.bind(this.browserStorage),Ie.SetUserData,this.logger,this.performanceClient)(i,JSON.stringify(e),t),this.addTokenKey(i,An.ID_TOKEN)}getAccessTokenCredential(e){const t=this.browserStorage.getUserData(e);if(!t)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,An.ACCESS_TOKEN),null;const i=this.validateAndParseJson(t);return!i||!iZ(i)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,An.ACCESS_TOKEN),null):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),i)}async setAccessTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");const i=Cp(e);await mt(this.browserStorage.setUserData.bind(this.browserStorage),Ie.SetUserData,this.logger,this.performanceClient)(i,JSON.stringify(e),t),this.addTokenKey(i,An.ACCESS_TOKEN)}getRefreshTokenCredential(e){const t=this.browserStorage.getUserData(e);if(!t)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,An.REFRESH_TOKEN),null;const i=this.validateAndParseJson(t);return!i||!rZ(i)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,An.REFRESH_TOKEN),null):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),i)}async setRefreshTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");const i=Cp(e);await mt(this.browserStorage.setUserData.bind(this.browserStorage),Ie.SetUserData,this.logger,this.performanceClient)(i,JSON.stringify(e),t),this.addTokenKey(i,An.REFRESH_TOKEN)}getAppMetadata(e){const t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;const i=this.validateAndParseJson(t);return!i||!gZ(e,i)?(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),i)}setAppMetadata(e){this.logger.trace("BrowserCacheManager.setAppMetadata called");const t=fZ(e);this.browserStorage.setItem(t,JSON.stringify(e))}getServerTelemetry(e){const t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;const i=this.validateAndParseJson(t);return!i||!uZ(e,i)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),i)}setServerTelemetry(e,t){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.browserStorage.setItem(e,JSON.stringify(t))}getAuthorityMetadata(e){const t=this.internalStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;const i=this.validateAndParseJson(t);return i&&mZ(e,i)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),i):null}getAuthorityMetadataKeys(){return this.internalStorage.getKeys().filter(t=>this.isAuthorityMetadata(t))}setWrapperMetadata(e,t){this.internalStorage.setItem(f9.WRAPPER_SKU,e),this.internalStorage.setItem(f9.WRAPPER_VER,t)}getWrapperMetadata(){const e=this.internalStorage.getItem(f9.WRAPPER_SKU)||qe.EMPTY_STRING,t=this.internalStorage.getItem(f9.WRAPPER_VER)||qe.EMPTY_STRING;return[e,t]}setAuthorityMetadata(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))}getActiveAccount(){const e=this.generateCacheKey(CC.ACTIVE_ACCOUNT_FILTERS),t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters found"),null;const i=this.validateAndParseJson(t);return i?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoFilteredBy({homeAccountId:i.homeAccountId,localAccountId:i.localAccountId,tenantId:i.tenantId})):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)}setActiveAccount(e){const t=this.generateCacheKey(CC.ACTIVE_ACCOUNT_FILTERS);if(e){this.logger.verbose("setActiveAccount: Active account set");const i={homeAccountId:e.homeAccountId,localAccountId:e.localAccountId,tenantId:e.tenantId};this.browserStorage.setItem(t,JSON.stringify(i))}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(t);this.eventHandler.emitEvent(on.ACTIVE_ACCOUNT_CHANGED)}getThrottlingCache(e){const t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;const i=this.validateAndParseJson(t);return!i||!dZ(e,i)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),i)}setThrottlingCache(e,t){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.browserStorage.setItem(e,JSON.stringify(t))}getTemporaryCache(e,t){const i=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){const r=this.cookieStorage.getItem(i);if(r)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),r}const s=this.temporaryCacheStorage.getItem(i);if(!s){if(this.cacheConfig.cacheLocation===ur.LocalStorage){const r=this.browserStorage.getItem(i);if(r)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),r}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),s}setTemporaryCache(e,t,i){const s=i?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(s,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.cookieStorage.setItem(s,t,void 0,this.cacheConfig.secureCookies))}removeItem(e){this.browserStorage.removeItem(e)}removeTemporaryItem(e){this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.cookieStorage.removeItem(e))}getKeys(){return this.browserStorage.getKeys()}async clear(){await this.removeAllAccounts(),this.removeAppMetadata(),this.temporaryCacheStorage.getKeys().forEach(e=>{(e.indexOf(qe.CACHE_PREFIX)!==-1||e.indexOf(this.clientId)!==-1)&&this.removeTemporaryItem(e)}),this.browserStorage.getKeys().forEach(e=>{(e.indexOf(qe.CACHE_PREFIX)!==-1||e.indexOf(this.clientId)!==-1)&&this.browserStorage.removeItem(e)}),this.internalStorage.clear()}async clearTokensAndKeysWithClaims(e,t){e.addQueueMeasurement(Ie.ClearTokensAndKeysWithClaims,t);const i=this.getTokenKeys(),s=[];i.accessToken.forEach(r=>{const a=this.getAccessTokenCredential(r);a!=null&&a.requestedClaimsHash&&r.includes(a.requestedClaimsHash.toLowerCase())&&s.push(this.removeAccessToken(r))}),await Promise.all(s),s.length>0&&this.logger.warning(`${s.length} access tokens with claims in the cache keys have been removed from the cache.`)}generateCacheKey(e){return this.validateAndParseJson(e)?JSON.stringify(e):tc.startsWith(e,qe.CACHE_PREFIX)?e:`${qe.CACHE_PREFIX}.${this.clientId}.${e}`}generateAuthorityKey(e){const{libraryState:{id:t}}=tl.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${ci.AUTHORITY}.${t}`)}generateNonceKey(e){const{libraryState:{id:t}}=tl.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${ci.NONCE_IDTOKEN}.${t}`)}generateStateKey(e){const{libraryState:{id:t}}=tl.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${ci.REQUEST_STATE}.${t}`)}getCachedAuthority(e){const t=this.generateStateKey(e),i=this.getTemporaryCache(t);if(!i)return null;const s=this.generateAuthorityKey(i);return this.getTemporaryCache(s)}updateCacheEntries(e,t,i,s,r){this.logger.trace("BrowserCacheManager.updateCacheEntries called");const a=this.generateStateKey(e);this.setTemporaryCache(a,e,!1);const o=this.generateNonceKey(e);this.setTemporaryCache(o,t,!1);const l=this.generateAuthorityKey(e);if(this.setTemporaryCache(l,i,!1),r){const c={credential:r.homeAccountId,type:Va.HOME_ACCOUNT_ID};this.setTemporaryCache(ci.CCS_CREDENTIAL,JSON.stringify(c),!0)}else if(s){const c={credential:s,type:Va.UPN};this.setTemporaryCache(ci.CCS_CREDENTIAL,JSON.stringify(c),!0)}}resetRequestCache(e){this.logger.trace("BrowserCacheManager.resetRequestCache called"),e&&(this.temporaryCacheStorage.getKeys().forEach(t=>{t.indexOf(e)!==-1&&this.removeTemporaryItem(t)}),this.removeTemporaryItem(this.generateStateKey(e)),this.removeTemporaryItem(this.generateNonceKey(e)),this.removeTemporaryItem(this.generateAuthorityKey(e))),this.removeTemporaryItem(this.generateCacheKey(ci.REQUEST_PARAMS)),this.removeTemporaryItem(this.generateCacheKey(ci.ORIGIN_URI)),this.removeTemporaryItem(this.generateCacheKey(ci.URL_HASH)),this.removeTemporaryItem(this.generateCacheKey(ci.CORRELATION_ID)),this.removeTemporaryItem(this.generateCacheKey(ci.CCS_CREDENTIAL)),this.removeTemporaryItem(this.generateCacheKey(ci.NATIVE_REQUEST)),this.setInteractionInProgress(!1)}cleanRequestByState(e){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),e){const t=this.generateStateKey(e),i=this.temporaryCacheStorage.getItem(t);this.logger.infoPii(`BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: ${i}`),this.resetRequestCache(i||qe.EMPTY_STRING)}}cleanRequestByInteractionType(e){this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.temporaryCacheStorage.getKeys().forEach(t=>{if(t.indexOf(ci.REQUEST_STATE)===-1)return;const i=this.temporaryCacheStorage.getItem(t);if(!i)return;const s=hO(this.cryptoImpl,i);s&&s.interactionType===e&&(this.logger.infoPii(`BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: ${i}`),this.resetRequestCache(i))}),this.setInteractionInProgress(!1)}cacheCodeRequest(e){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");const t=R_(JSON.stringify(e));this.setTemporaryCache(ci.REQUEST_PARAMS,t,!0)}getCachedRequest(e){this.logger.trace("BrowserCacheManager.getCachedRequest called");const t=this.getTemporaryCache(ci.REQUEST_PARAMS,!0);if(!t)throw Ht(DN);let i;try{i=JSON.parse(u0(t))}catch(s){throw this.logger.errorPii(`Attempted to parse: ${t}`),this.logger.error(`Parsing cached token request threw with error: ${s}`),Ht(FN)}if(this.removeTemporaryItem(this.generateCacheKey(ci.REQUEST_PARAMS)),!i.authority){const s=this.generateAuthorityKey(e),r=this.getTemporaryCache(s);if(!r)throw Ht(I_);i.authority=r}return i}getCachedNativeRequest(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");const e=this.getTemporaryCache(ci.NATIVE_REQUEST,!0);if(!e)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;const t=this.validateAndParseJson(e);return t||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)}isInteractionInProgress(e){const t=this.getInteractionInProgress();return e?t===this.clientId:!!t}getInteractionInProgress(){const e=`${qe.CACHE_PREFIX}.${ci.INTERACTION_STATUS_KEY}`;return this.getTemporaryCache(e,!1)}setInteractionInProgress(e){const t=`${qe.CACHE_PREFIX}.${ci.INTERACTION_STATUS_KEY}`;if(e){if(this.getInteractionInProgress())throw Ht(IN);this.setTemporaryCache(t,this.clientId,!1)}else!e&&this.getInteractionInProgress()===this.clientId&&this.removeTemporaryItem(t)}async hydrateCache(e,t){var o,l,c;const i=py((o=e.account)==null?void 0:o.homeAccountId,(l=e.account)==null?void 0:l.environment,e.idToken,this.clientId,e.tenantId);let s;t.claims&&(s=await this.cryptoImpl.hashString(t.claims));const r=by((c=e.account)==null?void 0:c.homeAccountId,e.account.environment,e.accessToken,this.clientId,e.tenantId,e.scopes.join(" "),e.expiresOn?e.expiresOn.getTime()/1e3:0,e.extExpiresOn?e.extExpiresOn.getTime()/1e3:0,u0,void 0,e.tokenType,void 0,t.sshKid,t.claims,s),a={idToken:i,accessToken:r};return this.saveCacheRecord(a,e.correlationId)}async saveCacheRecord(e,t,i){try{await super.saveCacheRecord(e,t,i)}catch(s){if(s instanceof o1&&this.performanceClient&&t)try{const r=this.getTokenKeys();this.performanceClient.addFields({cacheRtCount:r.refreshToken.length,cacheIdCount:r.idToken.length,cacheAtCount:r.accessToken.length},t)}catch{}throw s}}}function tA(n,e,t,i){try{switch(e){case ur.LocalStorage:return new S$(n,t,i);case ur.SessionStorage:return new I$;case ur.MemoryStorage:default:break}}catch(s){t.error(s)}return new Iy}const E$=(n,e,t,i)=>{const s={cacheLocation:ur.MemoryStorage,temporaryCacheLocation:ur.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};return new q6(n,s,Y3,e,t,i)};/*! @azure/msal-browser v4.5.0 2025-02-26 */function T$(n,e,t,i){return n.verbose("getAllAccounts called"),t?e.getAllAccounts(i):[]}function R$(n,e,t){if(e.trace("getAccount called"),Object.keys(n).length===0)return e.warning("getAccount: No accountFilter provided"),null;const i=t.getAccountInfoFilteredBy(n);return i?(e.verbose("getAccount: Account matching provided filter found, returning"),i):(e.verbose("getAccount: No matching account found, returning null"),null)}function M$(n,e,t){if(e.trace("getAccountByUsername called"),!n)return e.warning("getAccountByUsername: No username provided"),null;const i=t.getAccountInfoFilteredBy({username:n});return i?(e.verbose("getAccountByUsername: Account matching username found, returning"),e.verbosePii(`getAccountByUsername: Returning signed-in accounts matching username: ${n}`),i):(e.verbose("getAccountByUsername: No matching account found, returning null"),null)}function P$(n,e,t){if(e.trace("getAccountByHomeId called"),!n)return e.warning("getAccountByHomeId: No homeAccountId provided"),null;const i=t.getAccountInfoFilteredBy({homeAccountId:n});return i?(e.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),e.verbosePii(`getAccountByHomeId: Returning signed-in accounts matching homeAccountId: ${n}`),i):(e.verbose("getAccountByHomeId: No matching account found, returning null"),null)}function N$(n,e,t){if(e.trace("getAccountByLocalId called"),!n)return e.warning("getAccountByLocalId: No localAccountId provided"),null;const i=t.getAccountInfoFilteredBy({localAccountId:n});return i?(e.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),e.verbosePii(`getAccountByLocalId: Returning signed-in accounts matching localAccountId: ${n}`),i):(e.verbose("getAccountByLocalId: No matching account found, returning null"),null)}function O$(n,e){e.setActiveAccount(n)}function D$(n){return n.getActiveAccount()}/*! @azure/msal-browser v4.5.0 2025-02-26 */const F$="msal.broadcast.event";class L${constructor(e){this.eventCallbacks=new Map,this.logger=e||new jh({}),this.broadcastChannel=new BroadcastChannel(F$),this.invokeCrossTabCallbacks=this.invokeCrossTabCallbacks.bind(this)}addEventCallback(e,t,i){if(typeof window<"u"){const s=i||g$();return this.eventCallbacks.has(s)?(this.logger.error(`Event callback with id: ${s} is already registered. Please provide a unique id or remove the existing callback and try again.`),null):(this.eventCallbacks.set(s,[e,t||[]]),this.logger.verbose(`Event callback registered with id: ${s}`),s)}return null}removeEventCallback(e){this.eventCallbacks.delete(e),this.logger.verbose(`Event callback ${e} removed.`)}emitEvent(e,t,i,s){const r={eventType:e,interactionType:t||null,payload:i||null,error:s||null,timestamp:Date.now()};switch(e){case on.ACCOUNT_ADDED:case on.ACCOUNT_REMOVED:case on.ACTIVE_ACCOUNT_CHANGED:this.broadcastChannel.postMessage(r);break;default:this.invokeCallbacks(r);break}}invokeCallbacks(e){this.eventCallbacks.forEach(([t,i],s)=>{(i.length===0||i.includes(e.eventType))&&(this.logger.verbose(`Emitting event to callback ${s}: ${e.eventType}`),t.apply(null,[e]))})}invokeCrossTabCallbacks(e){const t=e.data;this.invokeCallbacks(t)}subscribeCrossTab(){this.broadcastChannel.addEventListener("message",this.invokeCrossTabCallbacks)}unsubscribeCrossTab(){this.broadcastChannel.removeEventListener("message",this.invokeCrossTabCallbacks)}}/*! @azure/msal-browser v4.5.0 2025-02-26 */class uO{constructor(e,t,i,s,r,a,o,l,c){this.config=e,this.browserStorage=t,this.browserCrypto=i,this.networkClient=this.config.system.networkClient,this.eventHandler=r,this.navigationClient=a,this.nativeMessageHandler=l,this.correlationId=c||rl(),this.logger=s.clone(za.MSAL_SKU,Sy,this.correlationId),this.performanceClient=o}async clearCacheOnLogout(e){if(e){Xr.accountInfoIsEqual(e,this.browserStorage.getActiveAccount(),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null));try{await this.browserStorage.removeAccount(Xr.generateAccountCacheKey(e)),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request.")}catch{this.logger.error("Account provided in logout request was not found. Local cache unchanged.")}}else try{this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),await this.browserStorage.clear(),await this.browserCrypto.clearKeystore()}catch{this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged.")}}getRedirectUri(e){this.logger.verbose("getRedirectUri called");const t=e||this.config.auth.redirectUri;return Jn.getAbsoluteUrl(t,i0())}initializeServerTelemetryManager(e,t){this.logger.verbose("initializeServerTelemetryManager called");const i={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new n2(i,this.browserStorage)}async getDiscoveredAuthority(e){const{account:t}=e,i=e.requestExtraQueryParameters&&e.requestExtraQueryParameters.hasOwnProperty("instance_aware")?e.requestExtraQueryParameters.instance_aware:void 0;this.performanceClient.addQueueMeasurement(Ie.StandardInteractionClientGetDiscoveredAuthority,this.correlationId);const s={protocolMode:this.config.auth.protocolMode,OIDCOptions:this.config.auth.OIDCOptions,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},r=e.requestAuthority||this.config.auth.authority,a=i!=null&&i.length?i==="true":this.config.auth.instanceAware,o=t&&a?this.config.auth.authority.replace(Jn.getDomainFromUrl(r),t.environment):r,l=Cr.generateAuthority(o,e.requestAzureCloudOptions||this.config.auth.azureCloudOptions),c=await mt(pN,Ie.AuthorityFactoryCreateDiscoveredInstance,this.logger,this.performanceClient,this.correlationId)(l,this.config.system.networkClient,this.browserStorage,s,this.logger,this.correlationId,this.performanceClient);if(t&&!c.isAlias(t.environment))throw yi(oN);return c}}/*! @azure/msal-browser v4.5.0 2025-02-26 */const B$=32;async function dO(n,e,t){n.addQueueMeasurement(Ie.GeneratePkceCodes,t);const i=_0(U$,Ie.GenerateCodeVerifier,e,n,t)(n,e,t),s=await mt(H$,Ie.GenerateCodeChallengeFromVerifier,e,n,t)(i,n,e,t);return{verifier:i,challenge:s}}function U$(n,e,t){try{const i=new Uint8Array(B$);return _0(e$,Ie.GetRandomValues,e,n,t)(i),ef(i)}catch{throw Ht(A_)}}async function H$(n,e,t,i){e.addQueueMeasurement(Ie.GenerateCodeChallengeFromVerifier,i);try{const s=await mt(iO,Ie.Sha256Digest,t,e,i)(n,e,i);return ef(new Uint8Array(s))}catch{throw Ht(A_)}}/*! @azure/msal-browser v4.5.0 2025-02-26 */async function B_(n,e,t,i){t.addQueueMeasurement(Ie.InitializeBaseRequest,n.correlationId);const s=n.authority||e.auth.authority,r=[...n&&n.scopes||[]],a={...n,correlationId:n.correlationId,authority:s,scopes:r};if(!a.authenticationScheme)a.authenticationScheme=gi.BEARER,i.verbose(`Authentication Scheme wasn't explicitly set in request, defaulting to "Bearer" request`);else{if(a.authenticationScheme===gi.SSH){if(!n.sshJwk)throw yi(xy);if(!n.sshKid)throw yi(sN)}i.verbose(`Authentication Scheme set to "${a.authenticationScheme}" as configured in Auth request`)}return e.cache.claimsBasedCachingEnabled&&n.claims&&!tc.isEmptyObj(n.claims)&&(a.requestedClaimsHash=await rO(n.claims)),a}async function z$(n,e,t,i,s){i.addQueueMeasurement(Ie.InitializeSilentRequest,n.correlationId);const r=await mt(B_,Ie.InitializeBaseRequest,s,i,n.correlationId)(n,t,i,s);return{...n,...r,account:e,forceRefresh:n.forceRefresh||!1}}/*! @azure/msal-browser v4.5.0 2025-02-26 */class $g extends uO{async initializeAuthorizationCodeRequest(e,t){this.performanceClient.addQueueMeasurement(Ie.StandardInteractionClientInitializeAuthorizationCodeRequest,this.correlationId);const i=t||await mt(dO,Ie.GeneratePkceCodes,this.logger,this.performanceClient,this.correlationId)(this.performanceClient,this.logger,this.correlationId),s={...e,redirectUri:e.redirectUri,code:qe.EMPTY_STRING,codeVerifier:i.verifier};return e.codeChallenge=i.challenge,e.codeChallengeMethod=qe.S256_CODE_CHALLENGE_METHOD,s}initializeLogoutRequest(e){this.logger.verbose("initializeLogoutRequest called",e==null?void 0:e.correlationId);const t={correlationId:this.correlationId||rl(),...e};if(e)if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){const i=this.getLogoutHintFromIdTokenClaims(e.account);i&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),t.logoutHint=i)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return!e||e.postLogoutRedirectUri!==null?e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",t.correlationId),t.postLogoutRedirectUri=Jn.getAbsoluteUrl(e.postLogoutRedirectUri,i0())):this.config.auth.postLogoutRedirectUri===null?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",t.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",t.correlationId),t.postLogoutRedirectUri=Jn.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,i0())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",t.correlationId),t.postLogoutRedirectUri=Jn.getAbsoluteUrl(i0(),i0())):this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",t.correlationId),t}getLogoutHintFromIdTokenClaims(e){const t=e.idTokenClaims;if(t){if(t.login_hint)return t.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null}async createAuthCodeClient(e){this.performanceClient.addQueueMeasurement(Ie.StandardInteractionClientCreateAuthCodeClient,this.correlationId);const t=await mt(this.getClientConfiguration.bind(this),Ie.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)(e);return new yN(t,this.performanceClient)}async getClientConfiguration(e){const{serverTelemetryManager:t,requestAuthority:i,requestAzureCloudOptions:s,requestExtraQueryParameters:r,account:a}=e;this.performanceClient.addQueueMeasurement(Ie.StandardInteractionClientGetClientConfiguration,this.correlationId);const o=await mt(this.getDiscoveredAuthority.bind(this),Ie.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,this.correlationId)({requestAuthority:i,requestAzureCloudOptions:s,requestExtraQueryParameters:r,account:a}),l=this.config.system.loggerOptions;return{authOptions:{clientId:this.config.auth.clientId,authority:o,clientCapabilities:this.config.auth.clientCapabilities,redirectUri:this.config.auth.redirectUri},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:l.loggerCallback,piiLoggingEnabled:l.piiLoggingEnabled,logLevel:l.logLevel,correlationId:this.correlationId},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:t,libraryInfo:{sku:za.MSAL_SKU,version:Sy,cpu:qe.EMPTY_STRING,os:qe.EMPTY_STRING},telemetry:this.config.telemetry}}async initializeAuthorizationRequest(e,t){this.performanceClient.addQueueMeasurement(Ie.StandardInteractionClientInitializeAuthorizationRequest,this.correlationId);const i=this.getRedirectUri(e.redirectUri),s={interactionType:t},r=tl.setRequestState(this.browserCrypto,e&&e.state||qe.EMPTY_STRING,s),o={...await mt(B_,Ie.InitializeBaseRequest,this.logger,this.performanceClient,this.correlationId)({...e,correlationId:this.correlationId},this.config,this.performanceClient,this.logger),redirectUri:i,state:r,nonce:e.nonce||rl(),responseMode:this.config.auth.OIDCOptions.serverResponseType};if(e.loginHint||e.sid)return o;const l=e.account||this.browserStorage.getActiveAccount();return l&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii(`Setting validated request account: ${l.homeAccountId}`,this.correlationId),o.account=l),o}}/*! @azure/msal-browser v4.5.0 2025-02-26 */const j$="ContentError",fO="user_switch";/*! @azure/msal-browser v4.5.0 2025-02-26 */const G$="USER_INTERACTION_REQUIRED",V$="USER_CANCEL",q$="NO_NETWORK",W$="PERSISTENT_ERROR",K$="DISABLED",X$="ACCOUNT_UNAVAILABLE";/*! @azure/msal-browser v4.5.0 2025-02-26 */const Y$=-2147186943,J$={[fO]:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."};class Yl extends Ui{constructor(e,t,i){super(e,t),Object.setPrototypeOf(this,Yl.prototype),this.name="NativeAuthError",this.ext=i}}function Df(n){if(n.ext&&n.ext.status&&(n.ext.status===W$||n.ext.status===K$)||n.ext&&n.ext.error&&n.ext.error===Y$)return!0;switch(n.errorCode){case j$:return!0;default:return!1}}function W6(n,e,t){if(t&&t.status)switch(t.status){case X$:return F6(bN);case G$:return new sl(n,e);case V$:return Ht($d);case q$:return Ht(e5)}return new Yl(n,J$[n]||e,t)}/*! @azure/msal-browser v4.5.0 2025-02-26 */class gO extends $g{async acquireToken(e){this.performanceClient.addQueueMeasurement(Ie.SilentCacheClientAcquireToken,e.correlationId);const t=this.initializeServerTelemetryManager(Ii.acquireTokenSilent_silentFlow),i=await mt(this.getClientConfiguration.bind(this),Ie.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:t,requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,account:e.account}),s=new MQ(i,this.performanceClient);this.logger.verbose("Silent auth client created");try{const a=(await mt(s.acquireCachedToken.bind(s),Ie.SilentFlowClientAcquireCachedToken,this.logger,this.performanceClient,e.correlationId)(e))[0];return this.performanceClient.addFields({fromCache:!0},e.correlationId),a}catch(r){throw r instanceof kx&&r.errorCode===E_&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),r}}logout(e){this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e);return this.clearCacheOnLogout(t==null?void 0:t.account)}}/*! @azure/msal-browser v4.5.0 2025-02-26 */class l1 extends uO{constructor(e,t,i,s,r,a,o,l,c,h,u,d){var g;super(e,t,i,s,r,a,l,c,d),this.apiId=o,this.accountId=h,this.nativeMessageHandler=c,this.nativeStorageManager=u,this.silentCacheClient=new gO(e,this.nativeStorageManager,i,s,r,a,l,c,d);const f=this.nativeMessageHandler.getExtensionId()===Hf.PREFERRED_EXTENSION_ID?"chrome":(g=this.nativeMessageHandler.getExtensionId())!=null&&g.length?"unknown":void 0;this.skus=n2.makeExtraSkuString({libraryName:za.MSAL_SKU,libraryVersion:Sy,extensionName:f,extensionVersion:this.nativeMessageHandler.getExtensionVersion()})}addRequestSKUs(e){e.extraParameters={...e.extraParameters,[fQ]:this.skus}}async acquireToken(e){this.performanceClient.addQueueMeasurement(Ie.NativeInteractionClientAcquireToken,e.correlationId),this.logger.trace("NativeInteractionClient - acquireToken called.");const t=this.performanceClient.startMeasurement(Ie.NativeInteractionClientAcquireToken,e.correlationId),i=ac(),s=this.initializeServerTelemetryManager(this.apiId);try{const r=await this.initializeNativeRequest(e);try{const h=await this.acquireTokensFromCache(this.accountId,r);return t.end({success:!0,isNativeBroker:!1,fromCache:!0}),h}catch{this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call")}const{...a}=r,o={method:_u.GetToken,request:a},l=await this.nativeMessageHandler.sendMessage(o),c=this.validateNativeResponse(l);return await this.handleNativeResponse(c,r,i).then(h=>(t.end({success:!0,isNativeBroker:!0,requestId:h.requestId}),s.clearNativeBrokerErrorCode(),h)).catch(h=>{throw t.end({success:!1,errorCode:h.errorCode,subErrorCode:h.subError,isNativeBroker:!0}),h})}catch(r){throw r instanceof Yl&&s.setNativeBrokerErrorCode(r.errorCode),r}}createSilentCacheRequest(e,t){return{authority:e.authority,correlationId:this.correlationId,scopes:rs.fromString(e.scope).asArray(),account:t,forceRefresh:!1}}async acquireTokensFromCache(e,t){if(!e)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),gt(T6);const i=this.browserStorage.getBaseAccountInfo({nativeAccountId:e});if(!i)throw gt(T6);try{const s=this.createSilentCacheRequest(t,i),r=await this.silentCacheClient.acquireToken(s),a={...i,idTokenClaims:r==null?void 0:r.idTokenClaims,idToken:r==null?void 0:r.idToken};return{...r,account:a}}catch(s){throw s}}async acquireTokenRedirect(e,t){this.logger.trace("NativeInteractionClient - acquireTokenRedirect called.");const{...i}=e;delete i.onRedirectNavigate;const s=await this.initializeNativeRequest(i),r={method:_u.GetToken,request:s};try{const l=await this.nativeMessageHandler.sendMessage(r);this.validateNativeResponse(l)}catch(l){if(l instanceof Yl&&(this.initializeServerTelemetryManager(this.apiId).setNativeBrokerErrorCode(l.errorCode),Df(l)))throw l}this.browserStorage.setTemporaryCache(ci.NATIVE_REQUEST,JSON.stringify(s),!0);const a={apiId:Ii.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},o=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(e.redirectUri);t.end({success:!0}),await this.navigationClient.navigateExternal(o,a)}async handleRedirectPromise(e,t){if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const i=this.browserStorage.getCachedNativeRequest();if(!i)return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),e&&t&&(e==null||e.addFields({errorCode:"no_cached_request"},t)),null;const{prompt:s,...r}=i;s&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(ci.NATIVE_REQUEST));const a={method:_u.GetToken,request:r},o=ac();try{this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker.");const l=await this.nativeMessageHandler.sendMessage(a);this.validateNativeResponse(l);const c=this.handleNativeResponse(l,r,o);this.browserStorage.setInteractionInProgress(!1);const h=await c;return this.initializeServerTelemetryManager(this.apiId).clearNativeBrokerErrorCode(),h}catch(l){throw this.browserStorage.setInteractionInProgress(!1),l}}logout(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")}async handleNativeResponse(e,t,i){var h;this.logger.trace("NativeInteractionClient - handleNativeResponse called.");const s=Qg(e.id_token,u0),r=this.createHomeAccountIdentifier(e,s),a=(h=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:t.accountId}))==null?void 0:h.homeAccountId;if(r!==a&&e.account.id!==t.accountId)throw W6(fO);const o=await this.getDiscoveredAuthority({requestAuthority:t.authority}),l=v_(this.browserStorage,o,r,u0,s,e.client_info,void 0,s.tid,void 0,e.account.id,this.logger),c=await this.generateAuthenticationResult(e,t,s,l,o.canonicalAuthority,i);return await this.cacheAccount(l),await this.cacheNativeTokens(e,t,r,s,e.access_token,c.tenantId,i),c}createHomeAccountIdentifier(e,t){return Xr.generateHomeAccountId(e.client_info||qe.EMPTY_STRING,qo.Default,this.logger,this.browserCrypto,t)}generateScopes(e,t){return e.scope?rs.fromString(e.scope):rs.fromString(t.scope)}async generatePopAccessToken(e,t){if(t.tokenType===gi.POP&&t.signPopToken){if(e.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),e.shr;const i=new Bg(this.browserCrypto),s={resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,shrNonce:t.shrNonce};if(!t.keyId)throw gt(a_);return i.signPopToken(e.access_token,t.keyId,s)}else return e.access_token}async generateAuthenticationResult(e,t,i,s,r,a){const o=this.addTelemetryFromNativeResponse(e),l=e.scope?rs.fromString(e.scope):rs.fromString(t.scope),c=e.account.properties||{},h=c.UID||i.oid||i.sub||qe.EMPTY_STRING,u=c.TenantId||i.tid||qe.EMPTY_STRING,d=p_(s.getAccountInfo(),void 0,i,e.id_token);d.nativeAccountId!==e.account.id&&(d.nativeAccountId=e.account.id);const f=await this.generatePopAccessToken(e,t),g=t.tokenType===gi.POP?gi.POP:gi.BEARER;return{authority:r,uniqueId:h,tenantId:u,scopes:l.asArray(),account:d,idToken:e.id_token,idTokenClaims:i,accessToken:f,fromCache:o?this.isResponseFromCache(o):!1,expiresOn:new Date(Number(a+e.expires_in)*1e3),tokenType:g,correlationId:this.correlationId,state:e.state,fromNativeBroker:!0}}async cacheAccount(e){await this.browserStorage.setAccount(e,this.correlationId),this.browserStorage.removeAccountContext(e).catch(t=>{this.logger.error(`Error occurred while removing account context from browser storage. ${t}`)})}cacheNativeTokens(e,t,i,s,r,a,o){const l=py(i,t.authority,e.id_token||"",t.clientId,s.tid||""),c=t.tokenType===gi.POP?qe.SHR_NONCE_VALIDITY:(typeof e.expires_in=="string"?parseInt(e.expires_in,10):e.expires_in)||0,h=o+c,u=this.generateScopes(e,t),d=by(i,t.authority,r,t.clientId,s.tid||a,u.printScopes(),h,0,u0,void 0,t.tokenType,void 0,t.keyId),f={idToken:l,accessToken:d};return this.nativeStorageManager.saveCacheRecord(f,this.correlationId,t.storeInCache)}addTelemetryFromNativeResponse(e){const t=this.getMATSFromResponse(e);return t?(this.performanceClient.addFields({extensionId:this.nativeMessageHandler.getExtensionId(),extensionVersion:this.nativeMessageHandler.getExtensionVersion(),matsBrokerVersion:t.broker_version,matsAccountJoinOnStart:t.account_join_on_start,matsAccountJoinOnEnd:t.account_join_on_end,matsDeviceJoin:t.device_join,matsPromptBehavior:t.prompt_behavior,matsApiErrorCode:t.api_error_code,matsUiVisible:t.ui_visible,matsSilentCode:t.silent_code,matsSilentBiSubCode:t.silent_bi_sub_code,matsSilentMessage:t.silent_message,matsSilentStatus:t.silent_status,matsHttpStatus:t.http_status,matsHttpEventCount:t.http_event_count},this.correlationId),t):null}validateNativeResponse(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scope")&&e.hasOwnProperty("expires_in"))return e;throw IP(e_,"Response missing expected properties.")}getMATSFromResponse(e){if(e.properties.MATS)try{return JSON.parse(e.properties.MATS)}catch{this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null}isResponseFromCache(e){return typeof e.is_cached>"u"?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached}async initializeNativeRequest(e){this.logger.trace("NativeInteractionClient - initializeNativeRequest called");const t=e.authority||this.config.auth.authority;e.account&&await this.getDiscoveredAuthority({requestAuthority:t,requestAzureCloudOptions:e.azureCloudOptions,account:e.account});const i=new Jn(t);i.validateAsUri();const{scopes:s,...r}=e,a=new rs(s||[]);a.appendScopes(wx);const o=()=>{switch(this.apiId){case Ii.ssoSilent:case Ii.acquireTokenSilent_silentFlow:return this.logger.trace("initializeNativeRequest: silent request sets prompt to none"),Us.NONE}if(!e.prompt){this.logger.trace("initializeNativeRequest: prompt was not provided");return}switch(e.prompt){case Us.NONE:case Us.CONSENT:case Us.LOGIN:return this.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),e.prompt;default:throw this.logger.trace(`initializeNativeRequest: prompt = ${e.prompt} is not compatible with native flow`),Ht(WN)}},l={...r,accountId:this.accountId,clientId:this.config.auth.clientId,authority:i.urlString,scope:a.printScopes(),redirectUri:this.getRedirectUri(e.redirectUri),prompt:o(),correlationId:this.correlationId,tokenType:e.authenticationScheme,windowTitleSubstring:document.title,extraParameters:{...e.extraQueryParameters,...e.tokenQueryParameters},extendedExpiryToken:!1,keyId:e.popKid};if(l.signPopToken&&e.popKid)throw Ht(XN);if(this.handleExtraBrokerParams(l),l.extraParameters=l.extraParameters||{},l.extraParameters.telemetry=Hf.MATS_TELEMETRY,e.authenticationScheme===gi.POP){const c={resourceRequestUri:e.resourceRequestUri,resourceRequestMethod:e.resourceRequestMethod,shrClaims:e.shrClaims,shrNonce:e.shrNonce},h=new Bg(this.browserCrypto);let u;if(l.keyId)u=this.browserCrypto.base64UrlEncode(JSON.stringify({kid:l.keyId})),l.signPopToken=!1;else{const d=await mt(h.generateCnf.bind(h),Ie.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(c,this.logger);u=d.reqCnfString,l.keyId=d.kid,l.signPopToken=!0}l.reqCnf=u}return this.addRequestSKUs(l),l}handleExtraBrokerParams(e){var r;const t=e.extraParameters&&e.extraParameters.hasOwnProperty(y_)&&e.extraParameters.hasOwnProperty(D6)&&e.extraParameters.hasOwnProperty(Zd);if(!e.embeddedClientId&&!t)return;let i="";const s=e.redirectUri;e.embeddedClientId?(e.redirectUri=this.config.auth.redirectUri,i=e.embeddedClientId):e.extraParameters&&(e.redirectUri=e.extraParameters[D6],i=e.extraParameters[Zd]),e.extraParameters={child_client_id:i,child_redirect_uri:s},(r=this.performanceClient)==null||r.addFields({embeddedClientId:i,embeddedRedirectUri:s},e.correlationId)}}/*! @azure/msal-browser v4.5.0 2025-02-26 */class Jl{constructor(e,t,i,s){this.logger=e,this.handshakeTimeoutMs=t,this.extensionId=s,this.resolvers=new Map,this.handshakeResolvers=new Map,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=i,this.handshakeEvent=i.startMeasurement(Ie.NativeMessageHandlerHandshake)}async sendMessage(e){this.logger.trace("NativeMessageHandler - sendMessage called.");const t={channel:Hf.CHANNEL_ID,extensionId:this.extensionId,responseId:rl(),body:e};return this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii(`NativeMessageHandler - Sending request to browser extension: ${JSON.stringify(t)}`),this.messageChannel.port1.postMessage(t),new Promise((i,s)=>{this.resolvers.set(t.responseId,{resolve:i,reject:s})})}static async createProvider(e,t,i){e.trace("NativeMessageHandler - createProvider called.");try{const s=new Jl(e,t,i,Hf.PREFERRED_EXTENSION_ID);return await s.sendHandshakeRequest(),s}catch{const r=new Jl(e,t,i);return await r.sendHandshakeRequest(),r}}async sendHandshakeRequest(){this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1);const e={channel:Hf.CHANNEL_ID,extensionId:this.extensionId,responseId:rl(),body:{method:_u.HandshakeRequest}};return this.handshakeEvent.add({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=t=>{this.onChannelMessage(t)},window.postMessage(e,window.origin,[this.messageChannel.port2]),new Promise((t,i)=>{this.handshakeResolvers.set(e.responseId,{resolve:t,reject:i}),this.timeoutId=window.setTimeout(()=>{window.removeEventListener("message",this.windowListener,!1),this.messageChannel.port1.close(),this.messageChannel.port2.close(),this.handshakeEvent.end({extensionHandshakeTimedOut:!0,success:!1}),i(Ht(VN)),this.handshakeResolvers.delete(e.responseId)},this.handshakeTimeoutMs)})}onWindowMessage(e){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),e.source!==window)return;const t=e.data;if(!(!t.channel||t.channel!==Hf.CHANNEL_ID)&&!(t.extensionId&&t.extensionId!==this.extensionId)&&t.body.method===_u.HandshakeRequest){const i=this.handshakeResolvers.get(t.responseId);if(!i){this.logger.trace(`NativeMessageHandler.onWindowMessage - resolver can't be found for request ${t.responseId}`);return}this.logger.verbose(t.extensionId?`Extension with id: ${t.extensionId} not installed`:"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1),this.handshakeEvent.end({success:!1,extensionInstalled:!1}),i.reject(Ht(qN))}}onChannelMessage(e){this.logger.trace("NativeMessageHandler - onChannelMessage called.");const t=e.data,i=this.resolvers.get(t.responseId),s=this.handshakeResolvers.get(t.responseId);try{const r=t.body.method;if(r===_u.Response){if(!i)return;const a=t.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii(`NativeMessageHandler - Received response from browser extension: ${JSON.stringify(a)}`),a.status!=="Success")i.reject(W6(a.code,a.description,a.ext));else if(a.result)a.result.code&&a.result.description?i.reject(W6(a.result.code,a.result.description,a.result.ext)):i.resolve(a.result);else throw IP(e_,"Event does not contain result.");this.resolvers.delete(t.responseId)}else if(r===_u.HandshakeResponse){if(!s){this.logger.trace(`NativeMessageHandler.onChannelMessage - resolver can't be found for request ${t.responseId}`);return}clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=t.extensionId,this.extensionVersion=t.body.version,this.logger.verbose(`NativeMessageHandler - Received HandshakeResponse from extension: ${this.extensionId}`),this.handshakeEvent.end({extensionInstalled:!0,success:!0}),s.resolve(),this.handshakeResolvers.delete(t.responseId)}}catch(r){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii(`Error parsing response from WAM Extension: ${r}`),this.logger.errorPii(`Unable to parse ${e}`),i?i.reject(r):s&&s.reject(r)}}getExtensionId(){return this.extensionId}getExtensionVersion(){return this.extensionVersion}static isPlatformBrokerAvailable(e,t,i,s){if(t.trace("isPlatformBrokerAvailable called"),!e.system.allowPlatformBroker)return t.trace("isPlatformBrokerAvailable: allowPlatformBroker is not enabled, returning false"),!1;if(!i)return t.trace("isPlatformBrokerAvailable: Platform extension provider is not initialized, returning false"),!1;if(s)switch(s){case gi.BEARER:case gi.POP:return t.trace("isPlatformBrokerAvailable: authenticationScheme is supported, returning true"),!0;default:return t.trace("isPlatformBrokerAvailable: authenticationScheme is not supported, returning false"),!1}return!0}}/*! @azure/msal-browser v4.5.0 2025-02-26 */class U_{constructor(e,t,i,s,r){this.authModule=e,this.browserStorage=t,this.authCodeRequest=i,this.logger=s,this.performanceClient=r}async handleCodeResponse(e,t){this.performanceClient.addQueueMeasurement(Ie.HandleCodeResponse,t.correlationId);let i;try{i=this.authModule.handleFragmentResponse(e,t.state)}catch(s){throw s instanceof Gh&&s.subError===$d?Ht($d):s}return mt(this.handleCodeResponseFromServer.bind(this),Ie.HandleCodeResponseFromServer,this.logger,this.performanceClient,t.correlationId)(i,t)}async handleCodeResponseFromServer(e,t,i=!0){if(this.performanceClient.addQueueMeasurement(Ie.HandleCodeResponseFromServer,t.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),this.authCodeRequest.code=e.code,e.cloud_instance_host_name&&await mt(this.authModule.updateAuthority.bind(this.authModule),Ie.UpdateTokenEndpointAuthority,this.logger,this.performanceClient,t.correlationId)(e.cloud_instance_host_name,t.correlationId),i&&(e.nonce=t.nonce||void 0),e.state=t.state,e.client_info)this.authCodeRequest.clientInfo=e.client_info;else{const r=this.createCcsCredentials(t);r&&(this.authCodeRequest.ccsCredential=r)}return await mt(this.authModule.acquireToken.bind(this.authModule),Ie.AuthClientAcquireToken,this.logger,this.performanceClient,t.correlationId)(this.authCodeRequest,e)}createCcsCredentials(e){return e.account?{credential:e.account.homeAccountId,type:Va.HOME_ACCOUNT_ID}:e.loginHint?{credential:e.loginHint,type:Va.UPN}:null}}/*! @azure/msal-browser v4.5.0 2025-02-26 */function mO(n,e,t){const i=Z3(n);if(!i)throw cN(n)?(t.error(`A ${e} is present in the iframe but it does not contain known properties. It's likely that the ${e} has been replaced by code running on the redirectUri page.`),t.errorPii(`The ${e} detected is: ${n}`),Ht(CN)):(t.error(`The request has returned to the redirectUri but a ${e} is not present. It's likely that the ${e} has been removed or the page has been redirected by code running on the redirectUri page.`),Ht(kN));return i}function Z$(n,e,t){if(!n.state)throw Ht(S_);const i=hO(e,n.state);if(!i)throw Ht(AN);if(i.interactionType!==t)throw Ht(SN)}/*! @azure/msal-browser v4.5.0 2025-02-26 */class Q$ extends $g{constructor(e,t,i,s,r,a,o,l,c,h){super(e,t,i,s,r,a,o,c,h),this.unloadWindow=this.unloadWindow.bind(this),this.nativeStorage=l}acquireToken(e,t){try{const s={popupName:this.generatePopupName(e.scopes||wx,e.authority||this.config.auth.authority),popupWindowAttributes:e.popupWindowAttributes||{},popupWindowParent:e.popupWindowParent??window};return this.performanceClient.addFields({isAsyncPopup:this.config.system.asyncPopups},this.correlationId),this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,s,t)):(this.logger.verbose("asyncPopup set to false, opening popup before acquiring token"),s.popup=this.openSizedPopup("about:blank",s),this.acquireTokenPopupAsync(e,s,t))}catch(i){return Promise.reject(i)}}logout(e){try{this.logger.verbose("logoutPopup called");const t=this.initializeLogoutRequest(e),i={popupName:this.generateLogoutPopupName(t),popupWindowAttributes:(e==null?void 0:e.popupWindowAttributes)||{},popupWindowParent:(e==null?void 0:e.popupWindowParent)??window},s=e&&e.authority,r=e&&e.mainWindowRedirectUri;return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(t,i,s,r)):(this.logger.verbose("asyncPopup set to false, opening popup"),i.popup=this.openSizedPopup("about:blank",i),this.logoutPopupAsync(t,i,s,r))}catch(t){return Promise.reject(t)}}async acquireTokenPopupAsync(e,t,i){var a;this.logger.verbose("acquireTokenPopupAsync called");const s=this.initializeServerTelemetryManager(Ii.acquireTokenPopup),r=await mt(this.initializeAuthorizationRequest.bind(this),Ie.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(e,rn.Popup);t.popup&&lO(r.authority);try{const o=await mt(this.initializeAuthorizationCodeRequest.bind(this),Ie.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,this.correlationId)(r,i),l=await mt(this.createAuthCodeClient.bind(this),Ie.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:s,requestAuthority:r.authority,requestAzureCloudOptions:r.azureCloudOptions,requestExtraQueryParameters:r.extraQueryParameters,account:r.account}),c=Jl.isPlatformBrokerAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme);let h;c&&(h=this.performanceClient.startMeasurement(Ie.FetchAccountIdWithNativeBroker,e.correlationId));const u=await l.getAuthCodeUrl({...r,platformBroker:c}),d=new U_(l,this.browserStorage,o,this.logger,this.performanceClient),f=this.initiateAuthRequest(u,t);this.eventHandler.emitEvent(on.POPUP_OPENED,rn.Popup,{popupWindow:f},null);const g=await this.monitorPopupForHash(f,t.popupWindowParent),m=_0(mO,Ie.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(g,this.config.auth.OIDCOptions.serverResponseType,this.logger);if(Xl.removeThrottle(this.browserStorage,this.config.auth.clientId,o),m.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),h&&h.end({success:!0,isNativeBroker:!0}),!this.nativeMessageHandler)throw Ht(vx);const p=new l1(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Ii.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,m.accountId,this.nativeStorage,r.correlationId),{userRequestState:y}=tl.parseRequestState(this.browserCrypto,r.state);return await p.acquireToken({...r,state:y,prompt:void 0})}return await d.handleCodeResponse(m,r)}catch(o){throw(a=t.popup)==null||a.close(),o instanceof Ui&&(o.setCorrelationId(this.correlationId),s.cacheFailedRequest(o)),o}}async logoutPopupAsync(e,t,i,s){var a,o,l,c;this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(on.LOGOUT_START,rn.Popup,e);const r=this.initializeServerTelemetryManager(Ii.logoutPopup);try{await this.clearCacheOnLogout(e.account);const h=await mt(this.createAuthCodeClient.bind(this),Ie.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:i,account:e.account||void 0});try{h.authority.endSessionEndpoint}catch{if((a=e.account)!=null&&a.homeAccountId&&e.postLogoutRedirectUri&&h.authority.protocolMode===h0.OIDC){if(this.browserStorage.removeAccount((o=e.account)==null?void 0:o.homeAccountId),this.eventHandler.emitEvent(on.LOGOUT_SUCCESS,rn.Popup,e),s){const f={apiId:Ii.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},g=Jn.getAbsoluteUrl(s,i0());await this.navigationClient.navigateInternal(g,f)}(l=t.popup)==null||l.close();return}}const u=h.getLogoutUri(e);this.eventHandler.emitEvent(on.LOGOUT_SUCCESS,rn.Popup,e);const d=this.openPopup(u,t);if(this.eventHandler.emitEvent(on.POPUP_OPENED,rn.Popup,{popupWindow:d},null),await this.monitorPopupForHash(d,t.popupWindowParent).catch(()=>{}),s){const f={apiId:Ii.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},g=Jn.getAbsoluteUrl(s,i0());this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii(`Redirecting main window to: ${g}`),await this.navigationClient.navigateInternal(g,f)}else this.logger.verbose("No main window navigation requested")}catch(h){throw(c=t.popup)==null||c.close(),h instanceof Ui&&(h.setCorrelationId(this.correlationId),r.cacheFailedRequest(h)),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(on.LOGOUT_FAILURE,rn.Popup,null,h),this.eventHandler.emitEvent(on.LOGOUT_END,rn.Popup),h}this.eventHandler.emitEvent(on.LOGOUT_END,rn.Popup)}initiateAuthRequest(e,t){if(e)return this.logger.infoPii(`Navigate to: ${e}`),this.openPopup(e,t);throw this.logger.error("Navigate url is empty"),Ht(vy)}monitorPopupForHash(e,t){return new Promise((i,s)=>{this.logger.verbose("PopupHandler.monitorPopupForHash - polling started");const r=setInterval(()=>{if(e.closed){this.logger.error("PopupHandler.monitorPopupForHash - window closed"),clearInterval(r),s(Ht($d));return}let a="";try{a=e.location.href}catch{}if(!a||a==="about:blank")return;clearInterval(r);let o="";const l=this.config.auth.OIDCOptions.serverResponseType;e&&(l===_x.QUERY?o=e.location.search:o=e.location.hash),this.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),i(o)},this.config.system.pollIntervalMilliseconds)}).finally(()=>{this.cleanPopup(e,t)})}openPopup(e,t){try{let i;if(t.popup?(i=t.popup,this.logger.verbosePii(`Navigating popup window to: ${e}`),i.location.assign(e)):typeof t.popup>"u"&&(this.logger.verbosePii(`Opening popup window to: ${e}`),i=this.openSizedPopup(e,t)),!i)throw Ht(TN);return i.focus&&i.focus(),this.currentWindow=i,t.popupWindowParent.addEventListener("beforeunload",this.unloadWindow),i}catch(i){throw this.logger.error("error opening popup "+i.message),this.browserStorage.setInteractionInProgress(!1),Ht(EN)}}openSizedPopup(e,{popupName:t,popupWindowAttributes:i,popupWindowParent:s}){var f,g,m,x;const r=s.screenLeft?s.screenLeft:s.screenX,a=s.screenTop?s.screenTop:s.screenY,o=s.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,l=s.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;let c=(f=i.popupSize)==null?void 0:f.width,h=(g=i.popupSize)==null?void 0:g.height,u=(m=i.popupPosition)==null?void 0:m.top,d=(x=i.popupPosition)==null?void 0:x.left;return(!c||c<0||c>o)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),c=za.POPUP_WIDTH),(!h||h<0||h>l)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),h=za.POPUP_HEIGHT),(!u||u<0||u>l)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),u=Math.max(0,l/2-za.POPUP_HEIGHT/2+a)),(!d||d<0||d>o)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),d=Math.max(0,o/2-za.POPUP_WIDTH/2+r)),s.open(e,t,`width=${c}, height=${h}, top=${u}, left=${d}, scrollbars=yes`)}unloadWindow(e){this.browserStorage.cleanRequestByInteractionType(rn.Popup),this.currentWindow&&this.currentWindow.close(),e.preventDefault()}cleanPopup(e,t){e.close(),t.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)}generatePopupName(e,t){return`${za.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${e.join("-")}.${t}.${this.correlationId}`}generateLogoutPopupName(e){const t=e.account&&e.account.homeAccountId;return`${za.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${t}.${this.correlationId}`}}/*! @azure/msal-browser v4.5.0 2025-02-26 */class nA{constructor(e,t,i,s,r){this.authModule=e,this.browserStorage=t,this.authCodeRequest=i,this.logger=s,this.performanceClient=r}async initiateAuthRequest(e,t){if(this.logger.verbose("RedirectHandler.initiateAuthRequest called"),e){t.redirectStartPage&&(this.logger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(ci.ORIGIN_URI,t.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(ci.CORRELATION_ID,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest),this.logger.infoPii(`RedirectHandler.initiateAuthRequest: Navigate to: ${e}`);const i={apiId:Ii.acquireTokenRedirect,timeout:t.redirectTimeout,noHistory:!1};if(typeof t.onRedirectNavigate=="function")if(this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),t.onRedirectNavigate(e)!==!1){this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),await t.navigationClient.navigateExternal(e,i);return}else{this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation");return}else{this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),await t.navigationClient.navigateExternal(e,i);return}}else throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),Ht(vy)}async handleCodeResponse(e,t){this.logger.verbose("RedirectHandler.handleCodeResponse called"),this.browserStorage.setInteractionInProgress(!1);const i=this.browserStorage.generateStateKey(t),s=this.browserStorage.getTemporaryCache(i);if(!s)throw gt(X3,"Cached State");let r;try{r=this.authModule.handleFragmentResponse(e,s)}catch(c){throw c instanceof Gh&&c.subError===$d?Ht($d):c}const a=this.browserStorage.generateNonceKey(s),o=this.browserStorage.getTemporaryCache(a);if(this.authCodeRequest.code=r.code,r.cloud_instance_host_name&&await mt(this.authModule.updateAuthority.bind(this.authModule),Ie.UpdateTokenEndpointAuthority,this.logger,this.performanceClient,this.authCodeRequest.correlationId)(r.cloud_instance_host_name,this.authCodeRequest.correlationId),r.nonce=o||void 0,r.state=s,r.client_info)this.authCodeRequest.clientInfo=r.client_info;else{const c=this.checkCcsCredentials();c&&(this.authCodeRequest.ccsCredential=c)}const l=await this.authModule.acquireToken(this.authCodeRequest,r);return this.browserStorage.cleanRequestByState(t),l}checkCcsCredentials(){const e=this.browserStorage.getTemporaryCache(ci.CCS_CREDENTIAL,!0);if(e)try{return JSON.parse(e)}catch{this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii(`Cache credential could not be parsed: ${e}`)}return null}}/*! @azure/msal-browser v4.5.0 2025-02-26 */function $$(){if(typeof window>"u"||typeof window.performance>"u"||typeof window.performance.getEntriesByType!="function")return;const n=window.performance.getEntriesByType("navigation"),e=n.length?n[0]:void 0;return e==null?void 0:e.type}class eee extends $g{constructor(e,t,i,s,r,a,o,l,c,h){super(e,t,i,s,r,a,o,c,h),this.nativeStorage=l}async acquireToken(e){const t=await mt(this.initializeAuthorizationRequest.bind(this),Ie.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(e,rn.Redirect);this.browserStorage.updateCacheEntries(t.state,t.nonce,t.authority,t.loginHint||"",t.account||null);const i=this.initializeServerTelemetryManager(Ii.acquireTokenRedirect),s=r=>{r.persisted&&(this.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),this.browserStorage.cleanRequestByState(t.state),this.eventHandler.emitEvent(on.RESTORE_FROM_BFCACHE,rn.Redirect))};try{const r=await mt(this.initializeAuthorizationCodeRequest.bind(this),Ie.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,this.correlationId)(t),a=await mt(this.createAuthCodeClient.bind(this),Ie.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:i,requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account}),o=new nA(a,this.browserStorage,r,this.logger,this.performanceClient),l=await a.getAuthCodeUrl({...t,platformBroker:Jl.isPlatformBrokerAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme)}),c=this.getRedirectStartPage(e.redirectStartPage);return this.logger.verbosePii(`Redirect start page: ${c}`),window.addEventListener("pageshow",s),await o.initiateAuthRequest(l,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:c,onRedirectNavigate:e.onRedirectNavigate||this.config.auth.onRedirectNavigate})}catch(r){throw r instanceof Ui&&(r.setCorrelationId(this.correlationId),i.cacheFailedRequest(r)),window.removeEventListener("pageshow",s),this.browserStorage.cleanRequestByState(t.state),r}}async handleRedirectPromise(e="",t){const i=this.initializeServerTelemetryManager(Ii.handleRedirectPromise);try{if(!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const[s,r]=this.getRedirectResponse(e||"");if(!s)return this.logger.info("handleRedirectPromise did not detect a response as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(rn.Redirect),$$()!=="back_forward"?t.event.errorCode="no_server_response":this.logger.verbose("Back navigation event detected. Muting no_server_response error"),null;const a=this.browserStorage.getTemporaryCache(ci.ORIGIN_URI,!0)||qe.EMPTY_STRING,o=Jn.removeHashFromUrl(a),l=Jn.removeHashFromUrl(window.location.href);if(o===l&&this.config.auth.navigateToLoginRequestUrl)return this.logger.verbose("Current page is loginRequestUrl, handling response"),a.indexOf("#")>-1&&l$(a),await this.handleResponse(s,i);if(this.config.auth.navigateToLoginRequestUrl){if(!D_()||this.config.system.allowRedirectInIframe){this.browserStorage.setTemporaryCache(ci.URL_HASH,r,!0);const c={apiId:Ii.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0};let h=!0;if(!a||a==="null"){const u=h$();this.browserStorage.setTemporaryCache(ci.ORIGIN_URI,u,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),h=await this.navigationClient.navigateInternal(u,c)}else this.logger.verbose(`Navigating to loginRequestUrl: ${a}`),h=await this.navigationClient.navigateInternal(a,c);if(!h)return await this.handleResponse(s,i)}}else return this.logger.verbose("NavigateToLoginRequestUrl set to false, handling response"),await this.handleResponse(s,i);return null}catch(s){throw s instanceof Ui&&(s.setCorrelationId(this.correlationId),i.cacheFailedRequest(s)),this.browserStorage.cleanRequestByInteractionType(rn.Redirect),s}}getRedirectResponse(e){this.logger.verbose("getRedirectResponseHash called");let t=e;t||(this.config.auth.OIDCOptions.serverResponseType===_x.QUERY?t=window.location.search:t=window.location.hash);let i=Z3(t);if(i){try{Z$(i,this.browserCrypto,rn.Redirect)}catch(r){return r instanceof Ui&&this.logger.error(`Interaction type validation failed due to ${r.errorCode}: ${r.errorMessage}`),[null,""]}return o$(window),this.logger.verbose("Hash contains known properties, returning response hash"),[i,t]}const s=this.browserStorage.getTemporaryCache(ci.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(ci.URL_HASH)),s&&(i=Z3(s),i)?(this.logger.verbose("Hash does not contain known properties, returning cached hash"),[i,s]):[null,""]}async handleResponse(e,t){const i=e.state;if(!i)throw Ht(S_);const s=this.browserStorage.getCachedRequest(i);if(this.logger.verbose("handleResponse called, retrieved cached request"),e.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw Ht(vx);const l=new l1(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Ii.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,e.accountId,this.nativeStorage,s.correlationId),{userRequestState:c}=tl.parseRequestState(this.browserCrypto,i);return l.acquireToken({...s,state:c,prompt:void 0}).finally(()=>{this.browserStorage.cleanRequestByState(i)})}const r=this.browserStorage.getCachedAuthority(i);if(!r)throw Ht(I_);const a=await mt(this.createAuthCodeClient.bind(this),Ie.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:t,requestAuthority:r});return Xl.removeThrottle(this.browserStorage,this.config.auth.clientId,s),new nA(a,this.browserStorage,s,this.logger,this.performanceClient).handleCodeResponse(e,i)}async logout(e){var s,r;this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e),i=this.initializeServerTelemetryManager(Ii.logout);try{this.eventHandler.emitEvent(on.LOGOUT_START,rn.Redirect,e),await this.clearCacheOnLogout(t.account);const a={apiId:Ii.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},o=await mt(this.createAuthCodeClient.bind(this),Ie.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:i,requestAuthority:e&&e.authority,requestExtraQueryParameters:e==null?void 0:e.extraQueryParameters,account:e&&e.account||void 0});if(o.authority.protocolMode===h0.OIDC)try{o.authority.endSessionEndpoint}catch{if((s=t.account)!=null&&s.homeAccountId){this.browserStorage.removeAccount((r=t.account)==null?void 0:r.homeAccountId),this.eventHandler.emitEvent(on.LOGOUT_SUCCESS,rn.Redirect,t);return}}const l=o.getLogoutUri(t);if(this.eventHandler.emitEvent(on.LOGOUT_SUCCESS,rn.Redirect,t),e&&typeof e.onRedirectNavigate=="function")if(e.onRedirectNavigate(l)!==!1){this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),await this.navigationClient.navigateExternal(l,a);return}else this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation");else{this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),await this.navigationClient.navigateExternal(l,a);return}}catch(a){throw a instanceof Ui&&(a.setCorrelationId(this.correlationId),i.cacheFailedRequest(a)),this.eventHandler.emitEvent(on.LOGOUT_FAILURE,rn.Redirect,null,a),this.eventHandler.emitEvent(on.LOGOUT_END,rn.Redirect),a}this.eventHandler.emitEvent(on.LOGOUT_END,rn.Redirect)}getRedirectStartPage(e){const t=e||window.location.href;return Jn.getAbsoluteUrl(t,i0())}}/*! @azure/msal-browser v4.5.0 2025-02-26 */async function tee(n,e,t,i,s){if(e.addQueueMeasurement(Ie.SilentHandlerInitiateAuthRequest,i),!n)throw t.info("Navigate url is empty"),Ht(vy);return s?mt(iee,Ie.SilentHandlerLoadFrame,t,e,i)(n,s,e,i):_0(see,Ie.SilentHandlerLoadFrameSync,t,e,i)(n)}async function nee(n,e,t,i,s,r,a){return i.addQueueMeasurement(Ie.SilentHandlerMonitorIframeForHash,r),new Promise((o,l)=>{e<z6&&s.warning(`system.loadFrameTimeout or system.iframeHashTimeout set to lower (${e}ms) than the default (${z6}ms). This may result in timeouts.`);const c=window.setTimeout(()=>{window.clearInterval(h),l(Ht(RN))},e),h=window.setInterval(()=>{let u="";const d=n.contentWindow;try{u=d?d.location.href:""}catch{}if(!u||u==="about:blank")return;let f="";d&&(a===_x.QUERY?f=d.location.search:f=d.location.hash),window.clearTimeout(c),window.clearInterval(h),o(f)},t)}).finally(()=>{_0(ree,Ie.RemoveHiddenIframe,s,i,r)(n)})}function iee(n,e,t,i){return t.addQueueMeasurement(Ie.SilentHandlerLoadFrame,i),new Promise((s,r)=>{const a=pO();window.setTimeout(()=>{if(!a){r("Unable to load iframe");return}a.src=n,s(a)},e)})}function see(n){const e=pO();return e.src=n,e}function pO(){const n=document.createElement("iframe");return n.className="msalSilentIframe",n.style.visibility="hidden",n.style.position="absolute",n.style.width=n.style.height="0",n.style.border="0",n.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.body.appendChild(n),n}function ree(n){document.body===n.parentNode&&document.body.removeChild(n)}/*! @azure/msal-browser v4.5.0 2025-02-26 */class aee extends $g{constructor(e,t,i,s,r,a,o,l,c,h,u){super(e,t,i,s,r,a,l,h,u),this.apiId=o,this.nativeStorage=c}async acquireToken(e){this.performanceClient.addQueueMeasurement(Ie.SilentIframeClientAcquireToken,e.correlationId),!e.loginHint&&!e.sid&&(!e.account||!e.account.username)&&this.logger.warning("No user hint provided. The authorization server may need more information to complete this request.");const t={...e};t.prompt?t.prompt!==Us.NONE&&t.prompt!==Us.NO_SESSION&&(this.logger.warning(`SilentIframeClient. Replacing invalid prompt ${t.prompt} with ${Us.NONE}`),t.prompt=Us.NONE):t.prompt=Us.NONE;const i=await mt(this.initializeAuthorizationRequest.bind(this),Ie.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(t,rn.Silent);lO(i.authority);const s=this.initializeServerTelemetryManager(this.apiId);let r;try{return r=await mt(this.createAuthCodeClient.bind(this),Ie.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:s,requestAuthority:i.authority,requestAzureCloudOptions:i.azureCloudOptions,requestExtraQueryParameters:i.extraQueryParameters,account:i.account}),await mt(this.silentTokenHelper.bind(this),Ie.SilentIframeClientTokenHelper,this.logger,this.performanceClient,e.correlationId)(r,i)}catch(a){if(a instanceof Ui&&(a.setCorrelationId(this.correlationId),s.cacheFailedRequest(a)),!r||!(a instanceof Ui)||a.errorCode!==za.INVALID_GRANT_ERROR)throw a;this.performanceClient.addFields({retryError:a.errorCode},this.correlationId);const o=await mt(this.initializeAuthorizationRequest.bind(this),Ie.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(t,rn.Silent);return await mt(this.silentTokenHelper.bind(this),Ie.SilentIframeClientTokenHelper,this.logger,this.performanceClient,this.correlationId)(r,o)}}logout(){return Promise.reject(Ht(ky))}async silentTokenHelper(e,t){const i=t.correlationId;this.performanceClient.addQueueMeasurement(Ie.SilentIframeClientTokenHelper,i);const s=await mt(this.initializeAuthorizationCodeRequest.bind(this),Ie.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,i)(t),r=await mt(e.getAuthCodeUrl.bind(e),Ie.GetAuthCodeUrl,this.logger,this.performanceClient,i)({...t,platformBroker:Jl.isPlatformBrokerAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme)}),a=new U_(e,this.browserStorage,s,this.logger,this.performanceClient),o=await mt(tee,Ie.SilentHandlerInitiateAuthRequest,this.logger,this.performanceClient,i)(r,this.performanceClient,this.logger,i,this.config.system.navigateFrameWait),l=this.config.auth.OIDCOptions.serverResponseType,c=await mt(nee,Ie.SilentHandlerMonitorIframeForHash,this.logger,this.performanceClient,i)(o,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,i,l),h=_0(mO,Ie.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(c,l,this.logger);if(h.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw Ht(vx);const u=new l1(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.apiId,this.performanceClient,this.nativeMessageHandler,h.accountId,this.browserStorage,i),{userRequestState:d}=tl.parseRequestState(this.browserCrypto,t.state);return mt(u.acquireToken.bind(u),Ie.NativeInteractionClientAcquireToken,this.logger,this.performanceClient,i)({...t,state:d,prompt:t.prompt||Us.NONE})}return mt(a.handleCodeResponse.bind(a),Ie.HandleCodeResponse,this.logger,this.performanceClient,i)(h,t)}}/*! @azure/msal-browser v4.5.0 2025-02-26 */class oee extends $g{async acquireToken(e){this.performanceClient.addQueueMeasurement(Ie.SilentRefreshClientAcquireToken,e.correlationId);const t=await mt(B_,Ie.InitializeBaseRequest,this.logger,this.performanceClient,e.correlationId)(e,this.config,this.performanceClient,this.logger),i={...e,...t};e.redirectUri&&(i.redirectUri=this.getRedirectUri(e.redirectUri));const s=this.initializeServerTelemetryManager(Ii.acquireTokenSilent_silentFlow),r=await this.createRefreshTokenClient({serverTelemetryManager:s,authorityUrl:i.authority,azureCloudOptions:i.azureCloudOptions,account:i.account});return mt(r.acquireTokenByRefreshToken.bind(r),Ie.RefreshTokenClientAcquireTokenByRefreshToken,this.logger,this.performanceClient,e.correlationId)(i).catch(a=>{throw a.setCorrelationId(this.correlationId),s.cacheFailedRequest(a),a})}logout(){return Promise.reject(Ht(ky))}async createRefreshTokenClient(e){const t=await mt(this.getClientConfiguration.bind(this),Ie.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:e.serverTelemetryManager,requestAuthority:e.authorityUrl,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account});return new RQ(t,this.performanceClient)}}/*! @azure/msal-browser v4.5.0 2025-02-26 */class lee{constructor(e,t,i,s){this.isBrowserEnvironment=typeof window<"u",this.config=e,this.storage=t,this.logger=i,this.cryptoObj=s}async loadExternalTokens(e,t,i){if(!this.isBrowserEnvironment)throw Ht(Cy);const s=e.correlationId||rl(),r=t.id_token?Qg(t.id_token,u0):void 0,a={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},o=e.authority?new Cr(Cr.generateAuthority(e.authority,e.azureCloudOptions),this.config.system.networkClient,this.storage,a,this.logger,e.correlationId||rl()):void 0,l=await this.loadAccount(e,i.clientInfo||t.client_info||"",s,r,o),c=await this.loadIdToken(t,l.homeAccountId,l.environment,l.realm,s),h=await this.loadAccessToken(e,t,l.homeAccountId,l.environment,l.realm,i,s),u=await this.loadRefreshToken(t,l.homeAccountId,l.environment,s);return this.generateAuthenticationResult(e,{account:l,idToken:c,accessToken:h,refreshToken:u},r,o)}async loadAccount(e,t,i,s,r){if(this.logger.verbose("TokenCache - loading account"),e.account){const c=Xr.createFromAccountInfo(e.account);return await this.storage.setAccount(c,i),c}else if(!r||!t&&!s)throw this.logger.error("TokenCache - if an account is not provided on the request, authority and either clientInfo or idToken must be provided instead."),Ht(UN);const a=Xr.generateHomeAccountId(t,r.authorityType,this.logger,this.cryptoObj,s),o=s==null?void 0:s.tid,l=v_(this.storage,r,a,u0,s,t,r.hostnameAndPort,o,void 0,void 0,this.logger);return await this.storage.setAccount(l,i),l}async loadIdToken(e,t,i,s,r){if(!e.id_token)return this.logger.verbose("TokenCache - no id token found in response"),null;this.logger.verbose("TokenCache - loading id token");const a=py(t,i,e.id_token,this.config.auth.clientId,s);return await this.storage.setIdTokenCredential(a,r),a}async loadAccessToken(e,t,i,s,r,a,o){if(t.access_token)if(t.expires_in){if(!t.scope&&(!e.scopes||!e.scopes.length))return this.logger.error("TokenCache - scopes not specified in the request or response. Cannot add token to the cache."),null}else return this.logger.error("TokenCache - no expiration set on the access token. Cannot add it to the cache."),null;else return this.logger.verbose("TokenCache - no access token found in response"),null;this.logger.verbose("TokenCache - loading access token");const l=t.scope?rs.fromString(t.scope):new rs(e.scopes),c=a.expiresOn||t.expires_in+new Date().getTime()/1e3,h=a.extendedExpiresOn||(t.ext_expires_in||t.expires_in)+new Date().getTime()/1e3,u=by(i,s,t.access_token,this.config.auth.clientId,r,l.printScopes(),c,h,u0);return await this.storage.setAccessTokenCredential(u,o),u}async loadRefreshToken(e,t,i,s){if(!e.refresh_token)return this.logger.verbose("TokenCache - no refresh token found in response"),null;this.logger.verbose("TokenCache - loading refresh token");const r=KP(t,i,e.refresh_token,this.config.auth.clientId,e.foci,void 0,e.refresh_token_expires_in);return await this.storage.setRefreshTokenCredential(r,s),r}generateAuthenticationResult(e,t,i,s){var h,u,d;let r="",a=[],o=null,l;t!=null&&t.accessToken&&(r=t.accessToken.secret,a=rs.fromString(t.accessToken.target).asArray(),o=new Date(Number(t.accessToken.expiresOn)*1e3),l=new Date(Number(t.accessToken.extendedExpiresOn)*1e3));const c=t.account;return{authority:s?s.canonicalAuthority:"",uniqueId:t.account.localAccountId,tenantId:t.account.realm,scopes:a,account:c.getAccountInfo(),idToken:((h=t.idToken)==null?void 0:h.secret)||"",idTokenClaims:i||{},accessToken:r,fromCache:!0,expiresOn:o,correlationId:e.correlationId||"",requestId:"",extExpiresOn:l,familyId:((u=t.refreshToken)==null?void 0:u.familyId)||"",tokenType:((d=t==null?void 0:t.accessToken)==null?void 0:d.tokenType)||"",state:e.state||"",cloudGraphHostName:c.cloudGraphHostName||"",msGraphHost:c.msGraphHost||"",fromNativeBroker:!1}}}/*! @azure/msal-browser v4.5.0 2025-02-26 */class cee extends yN{constructor(e){super(e),this.includeRedirectUri=!1}}/*! @azure/msal-browser v4.5.0 2025-02-26 */class hee extends $g{constructor(e,t,i,s,r,a,o,l,c,h){super(e,t,i,s,r,a,l,c,h),this.apiId=o}async acquireToken(e){if(!e.code)throw Ht(HN);const t=await mt(this.initializeAuthorizationRequest.bind(this),Ie.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(e,rn.Silent),i=this.initializeServerTelemetryManager(this.apiId);try{const s={...t,code:e.code},r=await mt(this.getClientConfiguration.bind(this),Ie.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:i,requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account}),a=new cee(r);this.logger.verbose("Auth code client created");const o=new U_(a,this.browserStorage,s,this.logger,this.performanceClient);return await mt(o.handleCodeResponseFromServer.bind(o),Ie.HandleCodeResponseFromServer,this.logger,this.performanceClient,e.correlationId)({code:e.code,msgraph_host:e.msGraphHost,cloud_graph_host_name:e.cloudGraphHostName,cloud_instance_host_name:e.cloudInstanceHostName},t,!1)}catch(s){throw s instanceof Ui&&(s.setCorrelationId(this.correlationId),i.cacheFailedRequest(s)),s}}logout(){return Promise.reject(Ht(ky))}}/*! @azure/msal-browser v4.5.0 2025-02-26 */function xl(n){const e=n==null?void 0:n.idTokenClaims;if(e!=null&&e.tfp||e!=null&&e.acr)return"B2C";if(e!=null&&e.tid){if((e==null?void 0:e.tid)==="9188040d-6c67-4c5b-b112-36a304b66dad")return"MSA"}else return;return"AAD"}function m9(n,e){try{F_(n)}catch(t){throw e.end({success:!1},t),t}}class Ey{constructor(e){this.operatingContext=e,this.isBrowserEnvironment=this.operatingContext.isBrowserEnvironment(),this.config=e.getConfig(),this.initialized=!1,this.logger=this.operatingContext.getLogger(),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.config.telemetry.client,this.browserCrypto=this.isBrowserEnvironment?new Ug(this.logger,this.performanceClient):Y3,this.eventHandler=new L$(this.logger),this.browserStorage=this.isBrowserEnvironment?new q6(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger,this.performanceClient,this.eventHandler,wQ(this.config.auth)):E$(this.config.auth.clientId,this.logger,this.performanceClient,this.eventHandler);const t={cacheLocation:ur.MemoryStorage,temporaryCacheLocation:ur.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};this.nativeInternalStorage=new q6(this.config.auth.clientId,t,this.browserCrypto,this.logger,this.performanceClient,this.eventHandler),this.tokenCache=new lee(this.config,this.browserStorage,this.logger,this.browserCrypto),this.activeSilentTokenRequests=new Map,this.trackPageVisibility=this.trackPageVisibility.bind(this),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this)}static async createController(e,t){const i=new Ey(e);return await i.initialize(t),i}trackPageVisibility(e){e&&(this.logger.info("Perf: Visibility change detected"),this.performanceClient.incrementFields({visibilityChangeCount:1},e))}async initialize(e){if(this.logger.trace("initialize called"),this.initialized){this.logger.info("initialize has already been called, exiting early.");return}if(!this.isBrowserEnvironment){this.logger.info("in non-browser environment, exiting early."),this.initialized=!0,this.eventHandler.emitEvent(on.INITIALIZE_END);return}const t=(e==null?void 0:e.correlationId)||this.getRequestCorrelationId(),i=this.config.system.allowPlatformBroker,s=this.performanceClient.startMeasurement(Ie.InitializeClientApplication,t);if(this.eventHandler.emitEvent(on.INITIALIZE_START),await mt(this.browserStorage.initialize.bind(this.browserStorage),Ie.InitializeCache,this.logger,this.performanceClient,t)(t),i)try{this.nativeExtensionProvider=await Jl.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout,this.performanceClient)}catch(r){this.logger.verbose(r)}this.config.cache.claimsBasedCachingEnabled||(this.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),await mt(this.browserStorage.clearTokensAndKeysWithClaims.bind(this.browserStorage),Ie.ClearTokensAndKeysWithClaims,this.logger,this.performanceClient,t)(this.performanceClient,t)),this.config.system.asyncPopups&&await this.preGeneratePkceCodes(t),this.initialized=!0,this.eventHandler.emitEvent(on.INITIALIZE_END),s.end({allowPlatformBroker:i,success:!0})}async handleRedirectPromise(e){if(this.logger.verbose("handleRedirectPromise called"),oO(this.initialized),this.isBrowserEnvironment){const t=e||"";let i=this.redirectResponse.get(t);return typeof i>"u"?(i=this.handleRedirectPromiseInternal(e),this.redirectResponse.set(t,i),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise")):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),i}return this.logger.verbose("handleRedirectPromise returns null, not browser environment"),null}async handleRedirectPromiseInternal(e){const t=this.getAllAccounts(),i=this.browserStorage.getCachedNativeRequest(),s=i&&Jl.isPlatformBrokerAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!e,r=s?i==null?void 0:i.correlationId:this.browserStorage.getTemporaryCache(ci.CORRELATION_ID,!0)||"",a=this.performanceClient.startMeasurement(Ie.AcquireTokenRedirect,r);this.eventHandler.emitEvent(on.HANDLE_REDIRECT_START,rn.Redirect);let o;if(s&&this.nativeExtensionProvider){this.logger.trace("handleRedirectPromise - acquiring token from native platform");const l=new l1(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Ii.handleRedirectPromise,this.performanceClient,this.nativeExtensionProvider,i.accountId,this.nativeInternalStorage,i.correlationId);o=mt(l.handleRedirectPromise.bind(l),Ie.HandleNativeRedirectPromiseMeasurement,this.logger,this.performanceClient,a.event.correlationId)(this.performanceClient,a.event.correlationId)}else{this.logger.trace("handleRedirectPromise - acquiring token from web flow");const l=this.createRedirectClient(r);o=mt(l.handleRedirectPromise.bind(l),Ie.HandleRedirectPromiseMeasurement,this.logger,this.performanceClient,a.event.correlationId)(e,a)}return o.then(l=>(l?(t.length<this.getAllAccounts().length?(this.eventHandler.emitEvent(on.LOGIN_SUCCESS,rn.Redirect,l),this.logger.verbose("handleRedirectResponse returned result, login success")):(this.eventHandler.emitEvent(on.ACQUIRE_TOKEN_SUCCESS,rn.Redirect,l),this.logger.verbose("handleRedirectResponse returned result, acquire token success")),a.end({success:!0,accountType:xl(l.account)})):a.event.errorCode?a.end({success:!1}):a.discard(),this.eventHandler.emitEvent(on.HANDLE_REDIRECT_END,rn.Redirect),l)).catch(l=>{const c=l;throw t.length>0?this.eventHandler.emitEvent(on.ACQUIRE_TOKEN_FAILURE,rn.Redirect,null,c):this.eventHandler.emitEvent(on.LOGIN_FAILURE,rn.Redirect,null,c),this.eventHandler.emitEvent(on.HANDLE_REDIRECT_END,rn.Redirect),a.end({success:!1},c),l})}async acquireTokenRedirect(e){const t=this.getRequestCorrelationId(e);this.logger.verbose("acquireTokenRedirect called",t);const i=this.performanceClient.startMeasurement(Ie.AcquireTokenPreRedirect,t);i.add({accountType:xl(e.account),scenarioId:e.scenarioId});const s=e.onRedirectNavigate;if(s)e.onRedirectNavigate=a=>{const o=typeof s=="function"?s(a):void 0;return o!==!1?i.end({success:!0}):i.discard(),o};else{const a=this.config.auth.onRedirectNavigate;this.config.auth.onRedirectNavigate=o=>{const l=typeof a=="function"?a(o):void 0;return l!==!1?i.end({success:!0}):i.discard(),l}}const r=this.getAllAccounts().length>0;try{JC(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0),r?this.eventHandler.emitEvent(on.ACQUIRE_TOKEN_START,rn.Redirect,e):this.eventHandler.emitEvent(on.LOGIN_START,rn.Redirect,e);let a;return this.nativeExtensionProvider&&this.canUsePlatformBroker(e)?a=new l1(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Ii.acquireTokenRedirect,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(e),this.nativeInternalStorage,t).acquireTokenRedirect(e,i).catch(l=>{if(l instanceof Yl&&Df(l))return this.nativeExtensionProvider=void 0,this.createRedirectClient(t).acquireToken(e);if(l instanceof sl)return this.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createRedirectClient(t).acquireToken(e);throw this.browserStorage.setInteractionInProgress(!1),l}):a=this.createRedirectClient(t).acquireToken(e),await a}catch(a){throw i.end({success:!1},a),r?this.eventHandler.emitEvent(on.ACQUIRE_TOKEN_FAILURE,rn.Redirect,null,a):this.eventHandler.emitEvent(on.LOGIN_FAILURE,rn.Redirect,null,a),a}}acquireTokenPopup(e){const t=this.getRequestCorrelationId(e),i=this.performanceClient.startMeasurement(Ie.AcquireTokenPopup,t);i.add({scenarioId:e.scenarioId,accountType:xl(e.account)});try{this.logger.verbose("acquireTokenPopup called",t),m9(this.initialized,i),this.browserStorage.setInteractionInProgress(!0)}catch(o){return Promise.reject(o)}const s=this.getAllAccounts();s.length>0?this.eventHandler.emitEvent(on.ACQUIRE_TOKEN_START,rn.Popup,e):this.eventHandler.emitEvent(on.LOGIN_START,rn.Popup,e);let r;const a=this.getPreGeneratedPkceCodes(t);return this.canUsePlatformBroker(e)?r=this.acquireTokenNative({...e,correlationId:t},Ii.acquireTokenPopup).then(o=>(this.browserStorage.setInteractionInProgress(!1),i.end({success:!0,isNativeBroker:!0,accountType:xl(o.account)}),o)).catch(o=>{if(o instanceof Yl&&Df(o))return this.nativeExtensionProvider=void 0,this.createPopupClient(t).acquireToken(e,a);if(o instanceof sl)return this.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createPopupClient(t).acquireToken(e,a);throw this.browserStorage.setInteractionInProgress(!1),o}):r=this.createPopupClient(t).acquireToken(e,a),r.then(o=>(s.length<this.getAllAccounts().length?this.eventHandler.emitEvent(on.LOGIN_SUCCESS,rn.Popup,o):this.eventHandler.emitEvent(on.ACQUIRE_TOKEN_SUCCESS,rn.Popup,o),i.end({success:!0,accessTokenSize:o.accessToken.length,idTokenSize:o.idToken.length,accountType:xl(o.account)}),o)).catch(o=>(s.length>0?this.eventHandler.emitEvent(on.ACQUIRE_TOKEN_FAILURE,rn.Popup,null,o):this.eventHandler.emitEvent(on.LOGIN_FAILURE,rn.Popup,null,o),i.end({success:!1},o),Promise.reject(o))).finally(()=>this.config.system.asyncPopups&&this.preGeneratePkceCodes(t))}trackPageVisibilityWithMeasurement(){const e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))}async ssoSilent(e){var r,a;const t=this.getRequestCorrelationId(e),i={...e,prompt:e.prompt,correlationId:t};this.ssoSilentMeasurement=this.performanceClient.startMeasurement(Ie.SsoSilent,t),(r=this.ssoSilentMeasurement)==null||r.add({scenarioId:e.scenarioId,accountType:xl(e.account)}),m9(this.initialized,this.ssoSilentMeasurement),(a=this.ssoSilentMeasurement)==null||a.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",t),this.eventHandler.emitEvent(on.SSO_SILENT_START,rn.Silent,i);let s;return this.canUsePlatformBroker(i)?s=this.acquireTokenNative(i,Ii.ssoSilent).catch(o=>{if(o instanceof Yl&&Df(o))return this.nativeExtensionProvider=void 0,this.createSilentIframeClient(i.correlationId).acquireToken(i);throw o}):s=this.createSilentIframeClient(i.correlationId).acquireToken(i),s.then(o=>{var l;return this.eventHandler.emitEvent(on.SSO_SILENT_SUCCESS,rn.Silent,o),(l=this.ssoSilentMeasurement)==null||l.end({success:!0,isNativeBroker:o.fromNativeBroker,accessTokenSize:o.accessToken.length,idTokenSize:o.idToken.length,accountType:xl(o.account)}),o}).catch(o=>{var l;throw this.eventHandler.emitEvent(on.SSO_SILENT_FAILURE,rn.Silent,null,o),(l=this.ssoSilentMeasurement)==null||l.end({success:!1},o),o}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenByCode(e){const t=this.getRequestCorrelationId(e);this.logger.trace("acquireTokenByCode called",t);const i=this.performanceClient.startMeasurement(Ie.AcquireTokenByCode,t);m9(this.initialized,i),this.eventHandler.emitEvent(on.ACQUIRE_TOKEN_BY_CODE_START,rn.Silent,e),i.add({scenarioId:e.scenarioId});try{if(e.code&&e.nativeAccountId)throw Ht(jN);if(e.code){const s=e.code;let r=this.hybridAuthCodeResponses.get(s);return r?(this.logger.verbose("Existing acquireTokenByCode request found",t),i.discard()):(this.logger.verbose("Initiating new acquireTokenByCode request",t),r=this.acquireTokenByCodeAsync({...e,correlationId:t}).then(a=>(this.eventHandler.emitEvent(on.ACQUIRE_TOKEN_BY_CODE_SUCCESS,rn.Silent,a),this.hybridAuthCodeResponses.delete(s),i.end({success:!0,isNativeBroker:a.fromNativeBroker,accessTokenSize:a.accessToken.length,idTokenSize:a.idToken.length,accountType:xl(a.account)}),a)).catch(a=>{throw this.hybridAuthCodeResponses.delete(s),this.eventHandler.emitEvent(on.ACQUIRE_TOKEN_BY_CODE_FAILURE,rn.Silent,null,a),i.end({success:!1},a),a}),this.hybridAuthCodeResponses.set(s,r)),await r}else if(e.nativeAccountId)if(this.canUsePlatformBroker(e,e.nativeAccountId)){const s=await this.acquireTokenNative({...e,correlationId:t},Ii.acquireTokenByCode,e.nativeAccountId).catch(r=>{throw r instanceof Yl&&Df(r)&&(this.nativeExtensionProvider=void 0),r});return i.end({accountType:xl(s.account),success:!0}),s}else throw Ht(GN);else throw Ht(zN)}catch(s){throw this.eventHandler.emitEvent(on.ACQUIRE_TOKEN_BY_CODE_FAILURE,rn.Silent,null,s),i.end({success:!1},s),s}}async acquireTokenByCodeAsync(e){var s;return this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(Ie.AcquireTokenByCodeAsync,e.correlationId),(s=this.acquireTokenByCodeAsyncMeasurement)==null||s.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),await this.createSilentAuthCodeClient(e.correlationId).acquireToken(e).then(r=>{var a;return(a=this.acquireTokenByCodeAsyncMeasurement)==null||a.end({success:!0,fromCache:r.fromCache,isNativeBroker:r.fromNativeBroker}),r}).catch(r=>{var a;throw(a=this.acquireTokenByCodeAsyncMeasurement)==null||a.end({success:!1},r),r}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenFromCache(e,t){switch(this.performanceClient.addQueueMeasurement(Ie.AcquireTokenFromCache,e.correlationId),t){case wa.Default:case wa.AccessToken:case wa.AccessTokenAndRefreshToken:const i=this.createSilentCacheClient(e.correlationId);return mt(i.acquireToken.bind(i),Ie.SilentCacheClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e);default:throw gt(Fh)}}async acquireTokenByRefreshToken(e,t){switch(this.performanceClient.addQueueMeasurement(Ie.AcquireTokenByRefreshToken,e.correlationId),t){case wa.Default:case wa.AccessTokenAndRefreshToken:case wa.RefreshToken:case wa.RefreshTokenAndNetwork:const i=this.createSilentRefreshClient(e.correlationId);return mt(i.acquireToken.bind(i),Ie.SilentRefreshClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e);default:throw gt(Fh)}}async acquireTokenBySilentIframe(e){this.performanceClient.addQueueMeasurement(Ie.AcquireTokenBySilentIframe,e.correlationId);const t=this.createSilentIframeClient(e.correlationId);return mt(t.acquireToken.bind(t),Ie.SilentIframeClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e)}async logout(e){const t=this.getRequestCorrelationId(e);return this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",t),this.logoutRedirect({correlationId:t,...e})}async logoutRedirect(e){const t=this.getRequestCorrelationId(e);return JC(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0),this.createRedirectClient(t).logout(e)}logoutPopup(e){try{const t=this.getRequestCorrelationId(e);return F_(this.initialized),this.browserStorage.setInteractionInProgress(!0),this.createPopupClient(t).logout(e)}catch(t){return Promise.reject(t)}}async clearCache(e){if(!this.isBrowserEnvironment){this.logger.info("in non-browser environment, returning early.");return}const t=this.getRequestCorrelationId(e);return this.createSilentCacheClient(t).logout(e)}getAllAccounts(e){return T$(this.logger,this.browserStorage,this.isBrowserEnvironment,e)}getAccount(e){return R$(e,this.logger,this.browserStorage)}getAccountByUsername(e){return M$(e,this.logger,this.browserStorage)}getAccountByHomeId(e){return P$(e,this.logger,this.browserStorage)}getAccountByLocalId(e){return N$(e,this.logger,this.browserStorage)}setActiveAccount(e){O$(e,this.browserStorage)}getActiveAccount(){return D$(this.browserStorage)}async hydrateCache(e,t){this.logger.verbose("hydrateCache called");const i=Xr.createFromAccountInfo(e.account,e.cloudGraphHostName,e.msGraphHost);return await this.browserStorage.setAccount(i,e.correlationId),e.fromNativeBroker?(this.logger.verbose("Response was from native broker, storing in-memory"),this.nativeInternalStorage.hydrateCache(e,t)):this.browserStorage.hydrateCache(e,t)}async acquireTokenNative(e,t,i){if(this.logger.trace("acquireTokenNative called"),!this.nativeExtensionProvider)throw Ht(vx);return new l1(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t,this.performanceClient,this.nativeExtensionProvider,i||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId).acquireToken(e)}canUsePlatformBroker(e,t){if(this.logger.trace("canUsePlatformBroker called"),!Jl.isPlatformBrokerAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme))return this.logger.trace("canUsePlatformBroker: isPlatformBrokerAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case Us.NONE:case Us.CONSENT:case Us.LOGIN:this.logger.trace("canUsePlatformBroker: prompt is compatible with platform broker flow");break;default:return this.logger.trace(`canUsePlatformBroker: prompt = ${e.prompt} is not compatible with platform broker flow, returning false`),!1}return!t&&!this.getNativeAccountId(e)?(this.logger.trace("canUsePlatformBroker: nativeAccountId is not available, returning false"),!1):!0}getNativeAccountId(e){const t=e.account||this.getAccount({loginHint:e.loginHint,sid:e.sid})||this.getActiveAccount();return t&&t.nativeAccountId||""}createPopupClient(e){return new Q$(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createRedirectClient(e){return new eee(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentIframeClient(e){return new aee(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Ii.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentCacheClient(e){return new gO(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentRefreshClient(e){return new oee(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentAuthCodeClient(e){return new hee(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Ii.acquireTokenByCode,this.performanceClient,this.nativeExtensionProvider,e)}addEventCallback(e,t){return this.eventHandler.addEventCallback(e,t)}removeEventCallback(e){this.eventHandler.removeEventCallback(e)}addPerformanceCallback(e){return aO(),this.performanceClient.addPerformanceCallback(e)}removePerformanceCallback(e){return this.performanceClient.removePerformanceCallback(e)}enableAccountStorageEvents(){if(this.config.cache.cacheLocation!==ur.LocalStorage){this.logger.info("Account storage events are only available when cacheLocation is set to localStorage");return}this.eventHandler.subscribeCrossTab()}disableAccountStorageEvents(){if(this.config.cache.cacheLocation!==ur.LocalStorage){this.logger.info("Account storage events are only available when cacheLocation is set to localStorage");return}this.eventHandler.unsubscribeCrossTab()}getTokenCache(){return this.tokenCache}getLogger(){return this.logger}setLogger(e){this.logger=e}initializeWrapperLibrary(e,t){this.browserStorage.setWrapperMetadata(e,t)}setNavigationClient(e){this.navigationClient=e}getConfiguration(){return this.config}getPerformanceClient(){return this.performanceClient}isBrowserEnv(){return this.isBrowserEnvironment}getRequestCorrelationId(e){return e!=null&&e.correlationId?e.correlationId:this.isBrowserEnvironment?rl():qe.EMPTY_STRING}async loginRedirect(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginRedirect called",t),this.acquireTokenRedirect({correlationId:t,...e||WC})}loginPopup(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",t),this.acquireTokenPopup({correlationId:t,...e||WC})}async acquireTokenSilent(e){const t=this.getRequestCorrelationId(e),i=this.performanceClient.startMeasurement(Ie.AcquireTokenSilent,t);i.add({cacheLookupPolicy:e.cacheLookupPolicy,scenarioId:e.scenarioId}),m9(this.initialized,i),this.logger.verbose("acquireTokenSilent called",t);const s=e.account||this.getActiveAccount();if(!s)throw Ht(ON);i.add({accountType:xl(s)});const r={clientId:this.config.auth.clientId,authority:e.authority||qe.EMPTY_STRING,scopes:e.scopes,homeAccountIdentifier:s.homeAccountId,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid,shrOptions:e.shrOptions},a=JSON.stringify(r),o=this.activeSilentTokenRequests.get(a);if(typeof o>"u"){this.logger.verbose("acquireTokenSilent called for the first time, storing active request",t);const l=mt(this.acquireTokenSilentAsync.bind(this),Ie.AcquireTokenSilentAsync,this.logger,this.performanceClient,t)({...e,correlationId:t},s).then(c=>(this.activeSilentTokenRequests.delete(a),i.end({success:!0,fromCache:c.fromCache,isNativeBroker:c.fromNativeBroker,cacheLookupPolicy:e.cacheLookupPolicy,accessTokenSize:c.accessToken.length,idTokenSize:c.idToken.length}),c)).catch(c=>{throw this.activeSilentTokenRequests.delete(a),i.end({success:!1},c),c});return this.activeSilentTokenRequests.set(a,l),{...await l,state:e.state}}else return this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",t),i.discard(),{...await o,state:e.state}}async acquireTokenSilentAsync(e,t){const i=()=>this.trackPageVisibility(e.correlationId);this.performanceClient.addQueueMeasurement(Ie.AcquireTokenSilentAsync,e.correlationId),this.eventHandler.emitEvent(on.ACQUIRE_TOKEN_START,rn.Silent,e),e.correlationId&&this.performanceClient.incrementFields({visibilityChangeCount:0},e.correlationId),document.addEventListener("visibilitychange",i);const s=await mt(z$,Ie.InitializeSilentRequest,this.logger,this.performanceClient,e.correlationId)(e,t,this.config,this.performanceClient,this.logger),r=e.cacheLookupPolicy||wa.Default;return this.acquireTokenSilentNoIframe(s,r).catch(async o=>{if(uee(o,r))if(this.activeIframeRequest)if(r!==wa.Skip){const[c,h]=this.activeIframeRequest;this.logger.verbose(`Iframe request is already in progress, awaiting resolution for request with correlationId: ${h}`,s.correlationId);const u=this.performanceClient.startMeasurement(Ie.AwaitConcurrentIframe,s.correlationId);u.add({awaitIframeCorrelationId:h});const d=await c;if(u.end({success:d}),d)return this.logger.verbose(`Parallel iframe request with correlationId: ${h} succeeded. Retrying cache and/or RT redemption`,s.correlationId),this.acquireTokenSilentNoIframe(s,r);throw this.logger.info(`Iframe request with correlationId: ${h} failed. Interaction is required.`),o}else return this.logger.warning("Another iframe request is currently in progress and CacheLookupPolicy is set to Skip. This may result in degraded performance and/or reliability for both calls. Please consider changing the CacheLookupPolicy to take advantage of request queuing and token cache.",s.correlationId),mt(this.acquireTokenBySilentIframe.bind(this),Ie.AcquireTokenBySilentIframe,this.logger,this.performanceClient,s.correlationId)(s);else{let c;return this.activeIframeRequest=[new Promise(h=>{c=h}),s.correlationId],this.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",s.correlationId),mt(this.acquireTokenBySilentIframe.bind(this),Ie.AcquireTokenBySilentIframe,this.logger,this.performanceClient,s.correlationId)(s).then(h=>(c(!0),h)).catch(h=>{throw c(!1),h}).finally(()=>{this.activeIframeRequest=void 0})}else throw o}).then(o=>(this.eventHandler.emitEvent(on.ACQUIRE_TOKEN_SUCCESS,rn.Silent,o),e.correlationId&&this.performanceClient.addFields({fromCache:o.fromCache,isNativeBroker:o.fromNativeBroker},e.correlationId),o)).catch(o=>{throw this.eventHandler.emitEvent(on.ACQUIRE_TOKEN_FAILURE,rn.Silent,null,o),o}).finally(()=>{document.removeEventListener("visibilitychange",i)})}async acquireTokenSilentNoIframe(e,t){return Jl.isPlatformBrokerAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme)&&e.account.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),this.acquireTokenNative(e,Ii.acquireTokenSilent_silentFlow).catch(async i=>{throw i instanceof Yl&&Df(i)?(this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,gt(Fh)):i})):(this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),mt(this.acquireTokenFromCache.bind(this),Ie.AcquireTokenFromCache,this.logger,this.performanceClient,e.correlationId)(e,t).catch(i=>{if(t===wa.AccessToken)throw i;return this.eventHandler.emitEvent(on.ACQUIRE_TOKEN_NETWORK_START,rn.Silent,e),mt(this.acquireTokenByRefreshToken.bind(this),Ie.AcquireTokenByRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,t)}))}async preGeneratePkceCodes(e){return this.logger.verbose("Generating new PKCE codes"),this.pkceCode=await mt(dO,Ie.GeneratePkceCodes,this.logger,this.performanceClient,e)(this.performanceClient,this.logger,e),Promise.resolve()}getPreGeneratedPkceCodes(e){this.logger.verbose("Attempting to pick up pre-generated PKCE codes");const t=this.pkceCode?{...this.pkceCode}:void 0;return this.pkceCode=void 0,this.logger.verbose(`${t?"Found":"Did not find"} pre-generated PKCE codes`),this.performanceClient.addFields({usePreGeneratedPkce:!!t},e),t}}function uee(n,e){const t=!(n instanceof sl&&n.subError!==_y),i=n.errorCode===za.INVALID_GRANT_ERROR||n.errorCode===Fh,s=t&&i||n.errorCode===$3||n.errorCode===__,r=qQ.includes(e);return s&&r}/*! @azure/msal-browser v4.5.0 2025-02-26 */async function dee(n,e){const t=new tf(n);return await t.initialize(),Ey.createController(t,e)}/*! @azure/msal-browser v4.5.0 2025-02-26 */class H_{static async createPublicClientApplication(e){const t=await dee(e);return new H_(e,t)}constructor(e,t){this.controller=t||new Ey(new tf(e))}async initialize(e){return this.controller.initialize(e)}async acquireTokenPopup(e){return this.controller.acquireTokenPopup(e)}acquireTokenRedirect(e){return this.controller.acquireTokenRedirect(e)}acquireTokenSilent(e){return this.controller.acquireTokenSilent(e)}acquireTokenByCode(e){return this.controller.acquireTokenByCode(e)}addEventCallback(e,t){return this.controller.addEventCallback(e,t)}removeEventCallback(e){return this.controller.removeEventCallback(e)}addPerformanceCallback(e){return this.controller.addPerformanceCallback(e)}removePerformanceCallback(e){return this.controller.removePerformanceCallback(e)}enableAccountStorageEvents(){this.controller.enableAccountStorageEvents()}disableAccountStorageEvents(){this.controller.disableAccountStorageEvents()}getAccount(e){return this.controller.getAccount(e)}getAccountByHomeId(e){return this.controller.getAccountByHomeId(e)}getAccountByLocalId(e){return this.controller.getAccountByLocalId(e)}getAccountByUsername(e){return this.controller.getAccountByUsername(e)}getAllAccounts(e){return this.controller.getAllAccounts(e)}handleRedirectPromise(e){return this.controller.handleRedirectPromise(e)}loginPopup(e){return this.controller.loginPopup(e)}loginRedirect(e){return this.controller.loginRedirect(e)}logout(e){return this.controller.logout(e)}logoutRedirect(e){return this.controller.logoutRedirect(e)}logoutPopup(e){return this.controller.logoutPopup(e)}ssoSilent(e){return this.controller.ssoSilent(e)}getTokenCache(){return this.controller.getTokenCache()}getLogger(){return this.controller.getLogger()}setLogger(e){this.controller.setLogger(e)}setActiveAccount(e){this.controller.setActiveAccount(e)}getActiveAccount(){return this.controller.getActiveAccount()}initializeWrapperLibrary(e,t){return this.controller.initializeWrapperLibrary(e,t)}setNavigationClient(e){this.controller.setNavigationClient(e)}getConfiguration(){return this.controller.getConfiguration()}async hydrateCache(e,t){return this.controller.hydrateCache(e,t)}clearCache(e){return this.controller.clearCache(e)}}const yu=class yu{constructor(){He(this,"clientId","");He(this,"sharepointUrl","");He(this,"sharepointTenantId","");He(this,"msalInstance",null);He(this,"currentAuthorityType","personal")}static getInstance(){return yu.instance||(yu.instance=new yu),yu.instance}async initialize(e){e&&this.currentAuthorityType!==e&&(this.currentAuthorityType=e,this.msalInstance=null),await this.getCredentials()}async ensureInitialized(e){await this.initialize(e)}async getCredentials(){var o,l,c;const t=await fetch("/api/config",{headers:{"Content-Type":"application/json"},credentials:"include"});if(!t.ok)throw new Error("Failed to fetch OneDrive credentials");const i=await t.json(),s=(o=i.onedrive)==null?void 0:o.client_id,r=(l=i.onedrive)==null?void 0:l.sharepoint_url,a=(c=i.onedrive)==null?void 0:c.sharepoint_tenant_id;if(!s)throw new Error("OneDrive configuration is incomplete");this.clientId=s,this.sharepointUrl=r,this.sharepointTenantId=a}async getMsalInstance(e){if(await this.ensureInitialized(e),!this.msalInstance){const i={auth:{authority:`https://login.microsoftonline.com/${this.currentAuthorityType==="organizations"?this.sharepointTenantId||"common":"consumers"}`,clientId:this.clientId}};this.msalInstance=new H_(i),this.msalInstance.initialize&&await this.msalInstance.initialize()}return this.msalInstance}getAuthorityType(){return this.currentAuthorityType}getSharepointUrl(){return this.sharepointUrl}getSharepointTenantId(){return this.sharepointTenantId}getBaseUrl(){if(this.currentAuthorityType==="organizations"){if(!this.sharepointUrl||this.sharepointUrl==="")throw new Error("Sharepoint URL not configured");let e=this.sharepointUrl.replace(/^https?:\/\//,"");return e=e.replace(/\/$/,""),`https://${e}`}else return"https://onedrive.live.com/picker"}};He(yu,"instance");let s2=yu;async function K6(n,e){const t=s2.getInstance();await t.ensureInitialized(e);const r={scopes:t.getAuthorityType()==="organizations"?[`${n||t.getBaseUrl()}/.default`]:["OneDrive.ReadWrite"]};let a="";try{a=(await(await t.getMsalInstance(e)).acquireTokenSilent(r)).accessToken}catch{const l=await t.getMsalInstance(e);try{const c=await l.loginPopup(r);l.setActiveAccount(c.account),c.idToken&&(a=(await l.acquireTokenSilent(r)).accessToken)}catch(c){throw new Error("Failed to login: "+(c instanceof Error?c.message:String(c)))}}if(!a)throw new Error("Failed to acquire access token");return a}function fee(){var i;const n=Cl(),e=s2.getInstance(),t={sdk:"8.0",entry:{oneDrive:{}},authentication:{},messaging:{origin:((i=window==null?void 0:window.location)==null?void 0:i.origin)||"",channelId:n},typesAndSources:{mode:"files",pivots:{oneDrive:!0,recent:!0}}};return e.getAuthorityType()!=="organizations"&&(t.entry.oneDrive={files:{}}),t}async function gee(n,e){const t=await K6(void 0,e);if(!t)throw new Error("Unable to retrieve OneDrive access token.");const i=`${n["@sharePoint.endpoint"]}/drives/${n.parentReference.driveId}/items/${n.id}`,s=await fetch(i,{headers:{Authorization:`Bearer ${t}`}});if(!s.ok)throw new Error(`Failed to fetch file information: ${s.status} ${s.statusText}`);const a=(await s.json())["@content.downloadUrl"];if(!a)throw new Error("Download URL not found in file data");const o=await fetch(a);if(!o.ok)throw new Error(`Failed to download file: ${o.status} ${o.statusText}`);return await o.blob()}async function mee(n){if(typeof window>"u")throw new Error("Not in browser environment");const e=s2.getInstance();return await e.initialize(n),new Promise((t,i)=>{let s=null,r=null;const a=fee(),o=e.getBaseUrl(),l=d=>{var g;if(d.source!==s)return;const f=d.data;if((f==null?void 0:f.type)==="initialize"&&(f==null?void 0:f.channelId)===a.messaging.channelId){if(r=(g=d.ports)==null?void 0:g[0],!r)return;r.addEventListener("message",c),r.start(),r.postMessage({type:"activate"})}},c=async d=>{const f=d.data;switch(f.type){case"notification":break;case"command":{r==null||r.postMessage({type:"acknowledge",id:f.id});const g=f.data;switch(g.command){case"authenticate":{try{const m=e.getAuthorityType()==="organizations"?g.resource:void 0,x=await K6(m,n);if(x)r==null||r.postMessage({type:"result",id:f.id,data:{result:"token",token:x}});else throw new Error("Could not retrieve auth token")}catch{r==null||r.postMessage({type:"result",id:f.id,data:{result:"error",error:{code:"tokenError",message:"Failed to get token"}}})}break}case"close":{h(),t(null);break}case"pick":{r==null||r.postMessage({type:"result",id:f.id,data:{result:"success"}}),h(),t(g);break}default:{r==null||r.postMessage({result:"error",error:{code:"unsupportedCommand",message:g.command},isExpected:!0});break}}break}}};function h(){window.removeEventListener("message",l),r&&r.removeEventListener("message",c),s&&(s.close(),s=null)}(async()=>{try{const d=await K6(void 0,n);if(!d)return i(new Error("Failed to acquire access token"));if(s=window.open("","OneDrivePicker","width=800,height=600"),!s)return i(new Error("Failed to open OneDrive picker window"));const f=new URLSearchParams({filePicker:JSON.stringify(a)});let g="";e.getAuthorityType()==="organizations"?g=o+`/_layouts/15/FilePicker.aspx?${f}`:g=o+`?${f}`;const m=s.document.createElement("form");m.setAttribute("action",g),m.setAttribute("method","POST");const x=s.document.createElement("input");x.setAttribute("type","hidden"),x.setAttribute("name","access_token"),x.setAttribute("value",d),m.appendChild(x),s.document.body.appendChild(m),m.submit(),window.addEventListener("message",l)}catch(d){s&&s.close(),i(d)}})()})}async function pee(n){const e=await mee(n);if(!e||!e.items||e.items.length===0)return null;const t=e.items[0];return{blob:await gee(t,n),name:t.name}}function iA(n,e,t){const i=n.slice();return i[34]=e[t],i}function bee(n){let e;const t=n[20].default,i=Gs(t,n,n[31],null);return{c(){i&&i.c()},l(s){i&&i.l(s)},m(s,r){i&&i.m(s,r),e=!0},p(s,r){i&&i.p&&(!e||r[1]&1)&&Vs(i,t,s,s[31],e?Ws(t,s[31],r,null):qs(s[31]),null)},i(s){e||(U(i,s),e=!0)},o(s){W(i,s),e=!1},d(s){i&&i.d(s)}}}function xee(n){let e,t;return e=new wi({props:{content:n[12].t("More"),$$slots:{default:[bee]},$$scope:{ctx:n}}}),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p(i,s){const r={};s[0]&4096&&(r.content=i[12].t("More")),s[1]&1&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function sA(n){let e,t,i,s=Object.keys(n[9]).length>3,r,a,o,l=Zn(Object.keys(n[9])),c=[];for(let d=0;d<l.length;d+=1)c[d]=rA(iA(n,l,d));const h=d=>W(c[d],1,1,()=>{c[d]=null});let u=s&&aA(n);return{c(){e=ee("div");for(let d=0;d<c.length;d+=1)c[d].c();i=Ce(),u&&u.c(),r=Ce(),a=ee("hr"),this.h()},l(d){e=te(d,"DIV",{class:!0});var f=q(e);for(let g=0;g<c.length;g+=1)c[g].l(f);f.forEach(E),i=Ae(d),u&&u.l(d),r=Ae(d),a=te(d,"HR",{class:!0}),this.h()},h(){A(e,"class",t=(n[10]?"":"max-h-28")+" overflow-y-auto scrollbar-thin"),A(a,"class","border-black/5 dark:border-white/5 my-1")},m(d,f){$(d,e,f);for(let g=0;g<c.length;g+=1)c[g]&&c[g].m(e,null);$(d,i,f),u&&u.m(d,f),$(d,r,f),$(d,a,f),o=!0},p(d,f){if(f[0]&513){l=Zn(Object.keys(d[9]));let g;for(g=0;g<l.length;g+=1){const m=iA(d,l,g);c[g]?(c[g].p(m,f),U(c[g],1)):(c[g]=rA(m),c[g].c(),U(c[g],1),c[g].m(e,null))}for(bt(),g=l.length;g<c.length;g+=1)h(g);xt()}(!o||f[0]&1024&&t!==(t=(d[10]?"":"max-h-28")+" overflow-y-auto scrollbar-thin"))&&A(e,"class",t),f[0]&512&&(s=Object.keys(d[9]).length>3),s?u?u.p(d,f):(u=aA(d),u.c(),u.m(r.parentNode,r)):u&&(u.d(1),u=null)},i(d){if(!o){for(let f=0;f<l.length;f+=1)U(c[f]);o=!0}},o(d){c=c.filter(Boolean);for(let f=0;f<c.length;f+=1)W(c[f]);o=!1},d(d){d&&(E(e),E(i),E(r),E(a)),vo(c,d),u&&u.d(d)}}}function yee(n){let e,t,i,s,r=n[9][n[34]].name+"",a,o;return t=new uF({}),{c(){e=ee("div"),me(t.$$.fragment),i=Ce(),s=ee("div"),a=vt(r),this.h()},l(l){e=te(l,"DIV",{class:!0});var c=q(e);xe(t.$$.fragment,c),c.forEach(E),i=Ae(l),s=te(l,"DIV",{class:!0});var h=q(s);a=kt(h,r),h.forEach(E),this.h()},h(){A(e,"class","shrink-0"),A(s,"class","truncate")},m(l,c){$(l,e,c),pe(t,e,null),$(l,i,c),$(l,s,c),K(s,a),o=!0},p(l,c){(!o||c[0]&512)&&r!==(r=l[9][l[34]].name+"")&&Et(a,r)},i(l){o||(U(t.$$.fragment,l),o=!0)},o(l){W(t.$$.fragment,l),o=!1},d(l){l&&(E(e),E(i),E(s)),be(t)}}}function rA(n){var f;let e,t,i,s,r,a,o,l,c,h;i=new wi({props:{content:((f=n[9][n[34]])==null?void 0:f.description)??"",placement:"top-start",className:"flex flex-1 gap-2 items-center",$$slots:{default:[yee]},$$scope:{ctx:n}}});function u(...g){return n[21](n[34],...g)}a=new hF({props:{state:n[9][n[34]].enabled}}),a.$on("change",u);function d(){return n[22](n[34])}return{c(){e=ee("button"),t=ee("div"),me(i.$$.fragment),s=Ce(),r=ee("div"),me(a.$$.fragment),o=Ce(),this.h()},l(g){e=te(g,"BUTTON",{class:!0});var m=q(e);t=te(m,"DIV",{class:!0});var x=q(t);xe(i.$$.fragment,x),x.forEach(E),s=Ae(m),r=te(m,"DIV",{class:!0});var p=q(r);xe(a.$$.fragment,p),p.forEach(E),o=Ae(m),m.forEach(E),this.h()},h(){A(t,"class","flex-1 truncate"),A(r,"class","shrink-0"),A(e,"class","flex w-full justify-between gap-2 items-center px-3 py-2 text-sm font-medium cursor-pointer rounded-xl")},m(g,m){$(g,e,m),K(e,t),pe(i,t,null),K(e,s),K(e,r),pe(a,r,null),K(e,o),l=!0,c||(h=yt(e,"click",d),c=!0)},p(g,m){var y;n=g;const x={};m[0]&512&&(x.content=((y=n[9][n[34]])==null?void 0:y.description)??""),m[0]&512|m[1]&1&&(x.$$scope={dirty:m,ctx:n}),i.$set(x);const p={};m[0]&512&&(p.state=n[9][n[34]].enabled),a.$set(p)},i(g){l||(U(i.$$.fragment,g),U(a.$$.fragment,g),l=!0)},o(g){W(i.$$.fragment,g),W(a.$$.fragment,g),l=!1},d(g){g&&E(e),be(i),be(a),c=!1,h()}}}function aA(n){let e,t,i,s,r,a,o;return{c(){e=ee("button"),t=at("svg"),i=at("path"),this.h()},l(l){e=te(l,"BUTTON",{class:!0,title:!0});var c=q(e);t=ot(c,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var h=q(t);i=ot(h,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),q(i).forEach(E),h.forEach(E),c.forEach(E),this.h()},h(){A(i,"stroke-linecap","round"),A(i,"stroke-linejoin","round"),A(i,"d","m19.5 8.25-7.5 7.5-7.5-7.5"),A(t,"xmlns","http://www.w3.org/2000/svg"),A(t,"fill","none"),A(t,"viewBox","0 0 24 24"),A(t,"stroke-width","2.5"),A(t,"stroke","currentColor"),A(t,"class",s="size-3 transition-transform duration-200 "+(n[10]?"rotate-180":"")+" text-gray-300 dark:text-gray-600"),A(e,"class","flex w-full justify-center items-center text-sm font-medium cursor-pointer rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800"),A(e,"title",r=n[10]?n[12].t("Show Less"):n[12].t("Show All"))},m(l,c){$(l,e,c),K(e,t),K(t,i),a||(o=yt(e,"click",n[23]),a=!0)},p(l,c){c[0]&1024&&s!==(s="size-3 transition-transform duration-200 "+(l[10]?"rotate-180":"")+" text-gray-300 dark:text-gray-600")&&A(t,"class",s),c[0]&5120&&r!==(r=l[10]?l[12].t("Show Less"):l[12].t("Show All"))&&A(e,"title",r)},d(l){l&&E(e),a=!1,o()}}}function wee(n){let e,t,i,s=n[12].t("Capture")+"",r,a;return e=new mD({}),{c(){me(e.$$.fragment),t=Ce(),i=ee("div"),r=vt(s),this.h()},l(o){xe(e.$$.fragment,o),t=Ae(o),i=te(o,"DIV",{class:!0});var l=q(i);r=kt(l,s),l.forEach(E),this.h()},h(){A(i,"class","line-clamp-1")},m(o,l){pe(e,o,l),$(o,t,l),$(o,i,l),K(i,r),a=!0},p(o,l){(!a||l[0]&4096)&&s!==(s=o[12].t("Capture")+"")&&Et(r,s)},i(o){a||(U(e.$$.fragment,o),a=!0)},o(o){W(e.$$.fragment,o),a=!1},d(o){o&&(E(t),E(i)),be(e,o)}}}function _ee(n){let e,t;return e=new ua({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800  rounded-xl "+(n[11]?"":"opacity-50"),$$slots:{default:[wee]},$$scope:{ctx:n}}}),e.$on("click",n[24]),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p(i,s){const r={};s[0]&2048&&(r.class="flex gap-2 items-center px-3 py-2 text-sm  font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800  rounded-xl "+(i[11]?"":"opacity-50")),s[0]&4096|s[1]&1&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function vee(n){let e,t,i,s=n[12].t("Upload Files")+"",r,a;return e=new pD({}),{c(){me(e.$$.fragment),t=Ce(),i=ee("div"),r=vt(s),this.h()},l(o){xe(e.$$.fragment,o),t=Ae(o),i=te(o,"DIV",{class:!0});var l=q(i);r=kt(l,s),l.forEach(E),this.h()},h(){A(i,"class","line-clamp-1")},m(o,l){pe(e,o,l),$(o,t,l),$(o,i,l),K(i,r),a=!0},p(o,l){(!a||l[0]&4096)&&s!==(s=o[12].t("Upload Files")+"")&&Et(r,s)},i(o){a||(U(e.$$.fragment,o),a=!0)},o(o){W(e.$$.fragment,o),a=!1},d(o){o&&(E(t),E(i)),be(e,o)}}}function kee(n){let e,t;return e=new ua({props:{class:"flex gap-2 items-center px-3 py-2 text-sm font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl "+(n[11]?"":"opacity-50"),$$slots:{default:[vee]},$$scope:{ctx:n}}}),e.$on("click",n[25]),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p(i,s){const r={};s[0]&2048&&(r.class="flex gap-2 items-center px-3 py-2 text-sm font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl "+(i[11]?"":"opacity-50")),s[0]&4096|s[1]&1&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function oA(n){var a,o,l,c;let e,t,i,s=((o=(a=n[13])==null?void 0:a.features)==null?void 0:o.enable_google_drive_integration)&&lA(n),r=((c=(l=n[13])==null?void 0:l.features)==null?void 0:c.enable_onedrive_integration)&&cA(n);return{c(){s&&s.c(),e=Ce(),r&&r.c(),t=zt()},l(h){s&&s.l(h),e=Ae(h),r&&r.l(h),t=zt()},m(h,u){s&&s.m(h,u),$(h,e,u),r&&r.m(h,u),$(h,t,u),i=!0},p(h,u){var d,f,g,m;(f=(d=h[13])==null?void 0:d.features)!=null&&f.enable_google_drive_integration?s?(s.p(h,u),u[0]&8192&&U(s,1)):(s=lA(h),s.c(),U(s,1),s.m(e.parentNode,e)):s&&(bt(),W(s,1,1,()=>{s=null}),xt()),(m=(g=h[13])==null?void 0:g.features)!=null&&m.enable_onedrive_integration?r?(r.p(h,u),u[0]&8192&&U(r,1)):(r=cA(h),r.c(),U(r,1),r.m(t.parentNode,t)):r&&(bt(),W(r,1,1,()=>{r=null}),xt())},i(h){i||(U(s),U(r),i=!0)},o(h){W(s),W(r),i=!1},d(h){h&&(E(e),E(t)),s&&s.d(h),r&&r.d(h)}}}function lA(n){let e,t;return e=new ua({props:{class:"flex gap-2 items-center px-3 py-2 text-sm font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl",$$slots:{default:[Cee]},$$scope:{ctx:n}}}),e.$on("click",n[26]),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p(i,s){const r={};s[0]&4096|s[1]&1&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function Cee(n){let e,t,i,s,r,a,o,l,c,h=n[12].t("Google Drive")+"",u;return{c(){e=at("svg"),t=at("path"),i=at("path"),s=at("path"),r=at("path"),a=at("path"),o=at("path"),l=Ce(),c=ee("div"),u=vt(h),this.h()},l(d){e=ot(d,"svg",{xmlns:!0,viewBox:!0,class:!0});var f=q(e);t=ot(f,"path",{d:!0,fill:!0}),q(t).forEach(E),i=ot(f,"path",{d:!0,fill:!0}),q(i).forEach(E),s=ot(f,"path",{d:!0,fill:!0}),q(s).forEach(E),r=ot(f,"path",{d:!0,fill:!0}),q(r).forEach(E),a=ot(f,"path",{d:!0,fill:!0}),q(a).forEach(E),o=ot(f,"path",{d:!0,fill:!0}),q(o).forEach(E),f.forEach(E),l=Ae(d),c=te(d,"DIV",{class:!0});var g=q(c);u=kt(g,h),g.forEach(E),this.h()},h(){A(t,"d","m6.6 66.85 3.85 6.65c.8 1.4 1.95 2.5 3.3 3.3l13.75-23.8h-27.5c0 1.55.4 3.1 1.2 4.5z"),A(t,"fill","#0066da"),A(i,"d","m43.65 25-13.75-23.8c-1.35.8-2.5 1.9-3.3 3.3l-25.4 44a9.06 9.06 0 0 0 -1.2 4.5h27.5z"),A(i,"fill","#00ac47"),A(s,"d","m73.55 76.8c1.35-.8 2.5-1.9 3.3-3.3l1.6-2.75 7.65-13.25c.8-1.4 1.2-2.95 1.2-4.5h-27.502l5.852 11.5z"),A(s,"fill","#ea4335"),A(r,"d","m43.65 25 13.75-23.8c-1.35-.8-2.9-1.2-4.5-1.2h-18.5c-1.6 0-3.15.45-4.5 1.2z"),A(r,"fill","#00832d"),A(a,"d","m59.8 53h-32.3l-13.75 23.8c1.35.8 2.9 1.2 4.5 1.2h50.8c1.6 0 3.15-.45 4.5-1.2z"),A(a,"fill","#2684fc"),A(o,"d","m73.4 26.5-12.7-22c-.8-1.4-1.95-2.5-3.3-3.3l-13.75 23.8 16.15 28h27.45c0-1.55-.4-3.1-1.2-4.5z"),A(o,"fill","#ffba00"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"viewBox","0 0 87.3 78"),A(e,"class","w-5 h-5"),A(c,"class","line-clamp-1")},m(d,f){$(d,e,f),K(e,t),K(e,i),K(e,s),K(e,r),K(e,a),K(e,o),$(d,l,f),$(d,c,f),K(c,u)},p(d,f){f[0]&4096&&h!==(h=d[12].t("Google Drive")+"")&&Et(u,h)},d(d){d&&(E(e),E(l),E(c))}}}function cA(n){let e,t;return e=new DI({props:{$$slots:{default:[Tee]},$$scope:{ctx:n}}}),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p(i,s){const r={};s[0]&20544|s[1]&1&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function Aee(n){let e,t,i,s,r,a,o,l,c,h,u,d,f,g,m,x,p,y,w,_,v,C,k,I=n[12].t("Microsoft OneDrive")+"",S;return{c(){e=at("svg"),t=at("mask"),i=at("path"),s=at("g"),r=at("path"),a=at("path"),o=at("path"),l=at("path"),c=at("defs"),h=at("linearGradient"),u=at("stop"),d=at("stop"),f=at("linearGradient"),g=at("stop"),m=at("stop"),x=at("linearGradient"),p=at("stop"),y=at("stop"),w=at("linearGradient"),_=at("stop"),v=at("stop"),C=Ce(),k=ee("div"),S=vt(I),this.h()},l(M){e=ot(M,"svg",{xmlns:!0,viewBox:!0,class:!0,fill:!0});var N=q(e);t=ot(N,"mask",{id:!0,style:!0,maskUnits:!0,x:!0,y:!0,width:!0,height:!0});var F=q(t);i=ot(F,"path",{d:!0,fill:!0}),q(i).forEach(E),F.forEach(E),s=ot(N,"g",{mask:!0});var H=q(s);r=ot(H,"path",{d:!0,fill:!0}),q(r).forEach(E),a=ot(H,"path",{d:!0,fill:!0}),q(a).forEach(E),o=ot(H,"path",{d:!0,fill:!0}),q(o).forEach(E),l=ot(H,"path",{d:!0,fill:!0}),q(l).forEach(E),H.forEach(E),c=ot(N,"defs",{});var T=q(c);h=ot(T,"linearGradient",{id:!0,x1:!0,y1:!0,x2:!0,y2:!0,gradientUnits:!0});var z=q(h);u=ot(z,"stop",{"stop-color":!0}),q(u).forEach(E),d=ot(z,"stop",{offset:!0,"stop-color":!0}),q(d).forEach(E),z.forEach(E),f=ot(T,"linearGradient",{id:!0,x1:!0,y1:!0,x2:!0,y2:!0,gradientUnits:!0});var R=q(f);g=ot(R,"stop",{"stop-color":!0}),q(g).forEach(E),m=ot(R,"stop",{offset:!0,"stop-color":!0}),q(m).forEach(E),R.forEach(E),x=ot(T,"linearGradient",{id:!0,x1:!0,y1:!0,x2:!0,y2:!0,gradientUnits:!0});var L=q(x);p=ot(L,"stop",{"stop-color":!0}),q(p).forEach(E),y=ot(L,"stop",{offset:!0,"stop-color":!0}),q(y).forEach(E),L.forEach(E),w=ot(T,"linearGradient",{id:!0,x1:!0,y1:!0,x2:!0,y2:!0,gradientUnits:!0});var Y=q(w);_=ot(Y,"stop",{"stop-color":!0}),q(_).forEach(E),v=ot(Y,"stop",{offset:!0,"stop-color":!0}),q(v).forEach(E),Y.forEach(E),T.forEach(E),N.forEach(E),C=Ae(M),k=te(M,"DIV",{class:!0});var j=q(k);S=kt(j,I),j.forEach(E),this.h()},h(){A(i,"d","M7.82979 26C3.50549 26 0 22.5675 0 18.3333C0 14.1921 3.35322 10.8179 7.54613 10.6716C9.27535 7.87166 12.4144 6 16 6C20.6308 6 24.5169 9.12183 25.5829 13.3335C29.1316 13.3603 32 16.1855 32 19.6667C32 23.0527 29 26 25.8723 25.9914L7.82979 26Z"),A(i,"fill","#C4C4C4"),A(t,"id","mask0_87_7796"),nn(t,"mask-type","alpha"),A(t,"maskUnits","userSpaceOnUse"),A(t,"x","0"),A(t,"y","6"),A(t,"width","32"),A(t,"height","20"),A(r,"d","M7.83017 26.0001C5.37824 26.0001 3.18957 24.8966 1.75391 23.1691L18.0429 16.3335L30.7089 23.4647C29.5926 24.9211 27.9066 26.0001 26.0004 25.9915C23.1254 26.0001 12.0629 26.0001 7.83017 26.0001Z"),A(r,"fill","url(#paint0_linear_87_7796)"),A(a,"d","M25.5785 13.3149L18.043 16.3334L30.709 23.4647C31.5199 22.4065 32.0004 21.0916 32.0004 19.6669C32.0004 16.1857 29.1321 13.3605 25.5833 13.3337C25.5817 13.3274 25.5801 13.3212 25.5785 13.3149Z"),A(a,"fill","url(#paint1_linear_87_7796)"),A(o,"d","M7.06445 10.7028L18.0423 16.3333L25.5779 13.3148C24.5051 9.11261 20.6237 6 15.9997 6C12.4141 6 9.27508 7.87166 7.54586 10.6716C7.3841 10.6773 7.22358 10.6877 7.06445 10.7028Z"),A(o,"fill","url(#paint2_linear_87_7796)"),A(l,"d","M1.7535 23.1687L18.0425 16.3331L7.06471 10.7026C3.09947 11.0792 0 14.3517 0 18.3331C0 20.1665 0.657197 21.8495 1.7535 23.1687Z"),A(l,"fill","url(#paint3_linear_87_7796)"),A(s,"mask","url(#mask0_87_7796)"),A(u,"stop-color","#2086B8"),A(d,"offset","1"),A(d,"stop-color","#46D3F6"),A(h,"id","paint0_linear_87_7796"),A(h,"x1","4.42591"),A(h,"y1","24.6668"),A(h,"x2","27.2309"),A(h,"y2","23.2764"),A(h,"gradientUnits","userSpaceOnUse"),A(g,"stop-color","#1694DB"),A(m,"offset","1"),A(m,"stop-color","#62C3FE"),A(f,"id","paint1_linear_87_7796"),A(f,"x1","23.8302"),A(f,"y1","19.6668"),A(f,"x2","30.2108"),A(f,"y2","15.2082"),A(f,"gradientUnits","userSpaceOnUse"),A(p,"stop-color","#0D3D78"),A(y,"offset","1"),A(y,"stop-color","#063B83"),A(x,"id","paint2_linear_87_7796"),A(x,"x1","8.51037"),A(x,"y1","7.33333"),A(x,"x2","23.3335"),A(x,"y2","15.9348"),A(x,"gradientUnits","userSpaceOnUse"),A(_,"stop-color","#16589B"),A(v,"offset","1"),A(v,"stop-color","#1464B7"),A(w,"id","paint3_linear_87_7796"),A(w,"x1","-0.340429"),A(w,"y1","19.9998"),A(w,"x2","14.5634"),A(w,"y2","14.4649"),A(w,"gradientUnits","userSpaceOnUse"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"viewBox","0 0 32 32"),A(e,"class","w-5 h-5"),A(e,"fill","none"),A(k,"class","line-clamp-1")},m(M,N){$(M,e,N),K(e,t),K(t,i),K(e,s),K(s,r),K(s,a),K(s,o),K(s,l),K(e,c),K(c,h),K(h,u),K(h,d),K(c,f),K(f,g),K(f,m),K(c,x),K(x,p),K(x,y),K(c,w),K(w,_),K(w,v),$(M,C,N),$(M,k,N),K(k,S)},p(M,N){N[0]&4096&&I!==(I=M[12].t("Microsoft OneDrive")+"")&&Et(S,I)},d(M){M&&(E(e),E(C),E(k))}}}function See(n){let e,t=n[12].t("Microsoft OneDrive (personal)")+"",i;return{c(){e=ee("div"),i=vt(t),this.h()},l(s){e=te(s,"DIV",{class:!0});var r=q(e);i=kt(r,t),r.forEach(E),this.h()},h(){A(e,"class","line-clamp-1")},m(s,r){$(s,e,r),K(e,i)},p(s,r){r[0]&4096&&t!==(t=s[12].t("Microsoft OneDrive (personal)")+"")&&Et(i,t)},d(s){s&&E(e)}}}function Iee(n){let e,t,i=n[12].t("Microsoft OneDrive (work/school)")+"",s,r,a,o="Includes SharePoint";return{c(){e=ee("div"),t=ee("div"),s=vt(i),r=Ce(),a=ee("div"),a.textContent=o,this.h()},l(l){e=te(l,"DIV",{class:!0});var c=q(e);t=te(c,"DIV",{class:!0});var h=q(t);s=kt(h,i),h.forEach(E),r=Ae(c),a=te(c,"DIV",{class:!0,"data-svelte-h":!0}),ko(a)!=="svelte-1rwtj43"&&(a.textContent=o),c.forEach(E),this.h()},h(){A(t,"class","line-clamp-1"),A(a,"class","text-xs text-gray-500"),A(e,"class","flex flex-col")},m(l,c){$(l,e,c),K(e,t),K(t,s),K(e,r),K(e,a)},p(l,c){c[0]&4096&&i!==(i=l[12].t("Microsoft OneDrive (work/school)")+"")&&Et(s,i)},d(l){l&&E(e)}}}function Eee(n){let e,t,i,s;return e=new ua({props:{class:"flex gap-2 items-center px-3 py-2 text-sm font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl",$$slots:{default:[See]},$$scope:{ctx:n}}}),e.$on("click",n[27]),i=new ua({props:{class:"flex gap-2 items-center px-3 py-2 text-sm font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl",$$slots:{default:[Iee]},$$scope:{ctx:n}}}),i.$on("click",n[28]),{c(){me(e.$$.fragment),t=Ce(),me(i.$$.fragment)},l(r){xe(e.$$.fragment,r),t=Ae(r),xe(i.$$.fragment,r)},m(r,a){pe(e,r,a),$(r,t,a),pe(i,r,a),s=!0},p(r,a){const o={};a[0]&4096|a[1]&1&&(o.$$scope={dirty:a,ctx:r}),e.$set(o);const l={};a[0]&4096|a[1]&1&&(l.$$scope={dirty:a,ctx:r}),i.$set(l)},i(r){s||(U(e.$$.fragment,r),U(i.$$.fragment,r),s=!0)},o(r){W(e.$$.fragment,r),W(i.$$.fragment,r),s=!1},d(r){r&&E(t),be(e,r),be(i,r)}}}function Tee(n){let e,t,i,s;return e=new FI({props:{class:"flex gap-2 items-center px-3 py-2 text-sm font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl w-full",$$slots:{default:[Aee]},$$scope:{ctx:n}}}),i=new LI({props:{class:"w-[calc(100vw-2rem)] max-w-[280px] rounded-xl px-1 py-1 border border-gray-300/30 dark:border-gray-700/50 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-sm",side:n[14]?"bottom":"right",sideOffset:n[14]?5:0,alignOffset:n[14]?0:-8,$$slots:{default:[Eee]},$$scope:{ctx:n}}}),{c(){me(e.$$.fragment),t=Ce(),me(i.$$.fragment)},l(r){xe(e.$$.fragment,r),t=Ae(r),xe(i.$$.fragment,r)},m(r,a){pe(e,r,a),$(r,t,a),pe(i,r,a),s=!0},p(r,a){const o={};a[0]&4096|a[1]&1&&(o.$$scope={dirty:a,ctx:r}),e.$set(o);const l={};a[0]&16384&&(l.side=r[14]?"bottom":"right"),a[0]&16384&&(l.sideOffset=r[14]?5:0),a[0]&16384&&(l.alignOffset=r[14]?0:-8),a[0]&4160|a[1]&1&&(l.$$scope={dirty:a,ctx:r}),i.$set(l)},i(r){s||(U(e.$$.fragment,r),U(i.$$.fragment,r),s=!0)},o(r){W(e.$$.fragment,r),W(i.$$.fragment,r),s=!1},d(r){r&&E(t),be(e,r),be(i,r)}}}function Ree(n){let e=Object.keys(n[9]).length>0,t,i,s,r,a,o,l,c=e&&sA(n);i=new wi({props:{content:n[2].length!==n[1].length?n[12].t("Model(s) do not support file upload"):n[11]?"":n[12].t("You do not have permission to upload files."),className:"w-full",$$slots:{default:[_ee]},$$scope:{ctx:n}}}),r=new wi({props:{content:n[2].length!==n[1].length?n[12].t("Model(s) do not support file upload"):n[11]?"":n[12].t("You do not have permission to upload files."),className:"w-full",$$slots:{default:[kee]},$$scope:{ctx:n}}});let h=n[11]&&oA(n);return{c(){c&&c.c(),t=Ce(),me(i.$$.fragment),s=Ce(),me(r.$$.fragment),a=Ce(),h&&h.c(),o=zt()},l(u){c&&c.l(u),t=Ae(u),xe(i.$$.fragment,u),s=Ae(u),xe(r.$$.fragment,u),a=Ae(u),h&&h.l(u),o=zt()},m(u,d){c&&c.m(u,d),$(u,t,d),pe(i,u,d),$(u,s,d),pe(r,u,d),$(u,a,d),h&&h.m(u,d),$(u,o,d),l=!0},p(u,d){d[0]&512&&(e=Object.keys(u[9]).length>0),e?c?(c.p(u,d),d[0]&512&&U(c,1)):(c=sA(u),c.c(),U(c,1),c.m(t.parentNode,t)):c&&(bt(),W(c,1,1,()=>{c=null}),xt());const f={};d[0]&6150&&(f.content=u[2].length!==u[1].length?u[12].t("Model(s) do not support file upload"):u[11]?"":u[12].t("You do not have permission to upload files.")),d[0]&6152|d[1]&1&&(f.$$scope={dirty:d,ctx:u}),i.$set(f);const g={};d[0]&6150&&(g.content=u[2].length!==u[1].length?u[12].t("Model(s) do not support file upload"):u[11]?"":u[12].t("You do not have permission to upload files.")),d[0]&6160|d[1]&1&&(g.$$scope={dirty:d,ctx:u}),r.$set(g),u[11]?h?(h.p(u,d),d[0]&2048&&U(h,1)):(h=oA(u),h.c(),U(h,1),h.m(o.parentNode,o)):h&&(bt(),W(h,1,1,()=>{h=null}),xt())},i(u){l||(U(c),U(i.$$.fragment,u),U(r.$$.fragment,u),U(h),l=!0)},o(u){W(c),W(i.$$.fragment,u),W(r.$$.fragment,u),W(h),l=!1},d(u){u&&(E(t),E(s),E(a),E(o)),c&&c.d(u),be(i,u),be(r,u),h&&h.d(u)}}}function Mee(n){let e,t,i;return t=new i4({props:{class:"w-full max-w-[200px] rounded-xl px-1 py-1 border border-gray-300/30 dark:border-gray-700/50 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-sm",sideOffset:10,alignOffset:-8,side:"top",align:"start",transition:W5,$$slots:{default:[Ree]},$$scope:{ctx:n}}}),{c(){e=ee("div"),me(t.$$.fragment),this.h()},l(s){e=te(s,"DIV",{slot:!0});var r=q(e);xe(t.$$.fragment,r),r.forEach(E),this.h()},h(){A(e,"slot","content")},m(s,r){$(s,e,r),pe(t,e,null),i=!0},p(s,r){const a={};r[0]&32383|r[1]&1&&(a.$$scope={dirty:r,ctx:s}),t.$set(a)},i(s){i||(U(t.$$.fragment,s),i=!0)},o(s){W(t.$$.fragment,s),i=!1},d(s){s&&E(e),be(t)}}}function Pee(n){let e,t,i,s,r,a,o;function l(h){n[29](h)}let c={$$slots:{content:[Mee],default:[xee]},$$scope:{ctx:n}};return n[8]!==void 0&&(c.show=n[8]),i=new s4({props:c}),It.push(()=>Wt(i,"show",l)),i.$on("change",n[30]),{c(){e=ee("input"),t=Ce(),me(i.$$.fragment),this.h()},l(h){e=te(h,"INPUT",{id:!0,type:!0,accept:!0,capture:!0,style:!0}),t=Ae(h),xe(i.$$.fragment,h),this.h()},h(){A(e,"id","camera-input"),A(e,"type","file"),A(e,"accept","image/*"),A(e,"capture","environment"),nn(e,"display","none")},m(h,u){$(h,e,u),$(h,t,u),pe(i,h,u),r=!0,a||(o=yt(e,"change",n[17]),a=!0)},p(h,u){const d={};u[0]&32383|u[1]&1&&(d.$$scope={dirty:u,ctx:h}),!s&&u[0]&256&&(s=!0,d.show=h[8],qt(()=>s=!1)),i.$set(d)},i(h){r||(U(i.$$.fragment,h),r=!0)},o(h){W(i.$$.fragment,h),r=!1},d(h){h&&(E(e),E(t)),be(i,h),a=!1,o()}}}function Nee(n,e,t){let i,s,r,a,o;Pe(n,Gd,G=>t(32,i=G)),Pe(n,k0,G=>t(19,s=G)),Pe(n,Kg,G=>t(13,a=G)),Pe(n,nx,G=>t(14,o=G));let{$$slots:l={},$$scope:c}=e;const h=as("i18n");Pe(n,h,G=>t(12,r=G));let{selectedToolIds:u=[]}=e,{selectedModels:d=[]}=e,{fileUploadCapableModels:f=[]}=e,{screenCaptureHandler:g}=e,{uploadFilesHandler:m}=e,{inputFilesHandler:x}=e,{uploadGoogleDriveHandler:p}=e,{uploadOneDriveHandler:y}=e,{onClose:w}=e,_={},v=!1,C=!1,k=!0;const I=async()=>{i===null&&await Gd.set(await n4(localStorage.token)),t(9,_=i.reduce((G,se,de,he)=>(G[se.id]={name:se.name,description:se.meta.description,enabled:u.includes(se.id)},G),{}))},S=()=>{const G=navigator.userAgent||navigator.vendor||window.opera;return/android|iphone|ipad|ipod|windows phone/i.test(G)};function M(G){var de;const se=Array.from((de=G.target)==null?void 0:de.files);se&&se.length>0&&x(se)}const N=async(G,se)=>{const de=se.detail;await hn(),de?t(0,u=[...u,G]):t(0,u=u.filter(he=>he!==G))},F=G=>{t(9,_[G].enabled=!_[G].enabled,_)},H=()=>{t(10,C=!C)},T=()=>{if(k)if(!S())g();else{const G=document.getElementById("camera-input");G&&G.click()}},z=()=>{k&&m()},R=()=>{p()},L=()=>{y("personal")},Y=()=>{y("organizations")};function j(G){v=G,t(8,v)}const J=G=>{G.detail===!1&&w()};return n.$$set=G=>{"selectedToolIds"in G&&t(0,u=G.selectedToolIds),"selectedModels"in G&&t(1,d=G.selectedModels),"fileUploadCapableModels"in G&&t(2,f=G.fileUploadCapableModels),"screenCaptureHandler"in G&&t(3,g=G.screenCaptureHandler),"uploadFilesHandler"in G&&t(4,m=G.uploadFilesHandler),"inputFilesHandler"in G&&t(18,x=G.inputFilesHandler),"uploadGoogleDriveHandler"in G&&t(5,p=G.uploadGoogleDriveHandler),"uploadOneDriveHandler"in G&&t(6,y=G.uploadOneDriveHandler),"onClose"in G&&t(7,w=G.onClose),"$$scope"in G&&t(31,c=G.$$scope)},n.$$.update=()=>{var G,se;n.$$.dirty[0]&256&&v&&I(),n.$$.dirty[0]&524294&&t(11,k=f.length===d.length&&((s==null?void 0:s.role)==="admin"||((se=(G=s==null?void 0:s.permissions)==null?void 0:G.chat)==null?void 0:se.file_upload)))},[u,d,f,g,m,p,y,w,v,_,C,k,r,a,o,h,S,M,x,s,l,N,F,H,T,z,R,L,Y,j,J,c]}class Oee extends Nt{constructor(e){super(),Ot(this,e,Nee,Pee,Ut,{selectedToolIds:0,selectedModels:1,fileUploadCapableModels:2,screenCaptureHandler:3,uploadFilesHandler:4,inputFilesHandler:18,uploadGoogleDriveHandler:5,uploadOneDriveHandler:6,onClose:7},null,[-1,-1])}}function hA(n,e,t){const i=n.slice();return i[9]=e[t],i}function uA(n,e,t){const i=n.slice();return i[12]=e[t],i}function dA(n,e,t){const i=n.slice();return i[15]=e[t],i}function fA(n){let e,t,i,s,r=n[3].length>0&&gA(n),a=Zn(n[1]),o=[];for(let c=0;c<a.length;c+=1)o[c]=pA(dA(n,a,c));const l=c=>W(o[c],1,1,()=>{o[c]=null});return{c(){r&&r.c(),e=Ce(),t=ee("div"),i=ee("div");for(let c=0;c<o.length;c+=1)o[c].c();this.h()},l(c){r&&r.l(c),e=Ae(c),t=te(c,"DIV",{class:!0});var h=q(t);i=te(h,"DIV",{class:!0});var u=q(i);for(let d=0;d<o.length;d+=1)o[d].l(u);u.forEach(E),h.forEach(E),this.h()},h(){A(i,"class","text-sm dark:text-gray-300 mb-1"),A(t,"class","px-5 pb-3 w-full flex flex-col justify-center")},m(c,h){r&&r.m(c,h),$(c,e,h),$(c,t,h),K(t,i);for(let u=0;u<o.length;u+=1)o[u]&&o[u].m(i,null);s=!0},p(c,h){if(c[3].length>0?r?r.p(c,h):(r=gA(c),r.c(),r.m(e.parentNode,e)):r&&(r.d(1),r=null),h&2){a=Zn(c[1]);let u;for(u=0;u<a.length;u+=1){const d=dA(c,a,u);o[u]?(o[u].p(d,h),U(o[u],1)):(o[u]=pA(d),o[u].c(),U(o[u],1),o[u].m(i,null))}for(bt(),u=a.length;u<o.length;u+=1)l(u);xt()}},i(c){if(!s){for(let h=0;h<a.length;h+=1)U(o[h]);s=!0}},o(c){o=o.filter(Boolean);for(let h=0;h<o.length;h+=1)W(o[h]);s=!1},d(c){c&&(E(e),E(t)),r&&r.d(c),vo(o,c)}}}function gA(n){let e,t,i=n[2].t("Tools")+"",s;return{c(){e=ee("div"),t=ee("div"),s=vt(i),this.h()},l(r){e=te(r,"DIV",{class:!0});var a=q(e);t=te(a,"DIV",{class:!0});var o=q(t);s=kt(o,i),o.forEach(E),a.forEach(E),this.h()},h(){A(t,"class","text-base font-medium self-center"),A(e,"class","flex justify-between dark:text-gray-300 px-5 pb-1")},m(r,a){$(r,e,a),K(e,t),K(t,s)},p(r,a){a&4&&i!==(i=r[2].t("Tools")+"")&&Et(s,i)},d(r){r&&E(e)}}}function mA(n){var s,r;let e,t=((r=(s=n[15])==null?void 0:s.meta)==null?void 0:r.description)+"",i;return{c(){e=ee("div"),i=vt(t),this.h()},l(a){e=te(a,"DIV",{class:!0});var o=q(e);i=kt(o,t),o.forEach(E),this.h()},h(){A(e,"class","text-xs text-gray-500")},m(a,o){$(a,e,o),K(e,i)},p(a,o){var l,c;o&2&&t!==(t=((c=(l=a[15])==null?void 0:l.meta)==null?void 0:c.description)+"")&&Et(i,t)},d(a){a&&E(e)}}}function Dee(n){var l,c,h;let e,t,i=((l=n[15])==null?void 0:l.name)+"",s,r,a,o=((h=(c=n[15])==null?void 0:c.meta)==null?void 0:h.description)&&mA(n);return{c(){e=ee("div"),t=ee("div"),s=vt(i),r=Ce(),o&&o.c(),a=Ce(),this.h()},l(u){e=te(u,"DIV",{});var d=q(e);t=te(d,"DIV",{class:!0});var f=q(t);s=kt(f,i),f.forEach(E),r=Ae(d),o&&o.l(d),d.forEach(E),a=Ae(u),this.h()},h(){A(t,"class","text-sm font-medium dark:text-gray-100 text-gray-800")},m(u,d){$(u,e,d),K(e,t),K(t,s),K(e,r),o&&o.m(e,null),$(u,a,d)},p(u,d){var f,g,m;d&2&&i!==(i=((f=u[15])==null?void 0:f.name)+"")&&Et(s,i),(m=(g=u[15])==null?void 0:g.meta)!=null&&m.description?o?o.p(u,d):(o=mA(u),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},d(u){u&&(E(e),E(a)),o&&o.d()}}}function pA(n){let e,t;return e=new Wg({props:{buttonClassName:"w-full mb-0.5",$$slots:{default:[Dee]},$$scope:{ctx:n}}}),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p(i,s){const r={};s&262146&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function bA(n){let e,t,i=n[2].t("Tool Servers")+"",s,r,a,o,l=n[2].t("Open WebUI can use tools provided by any OpenAPI server.")+"",c,h,u,d,f=n[2].t("Learn more about OpenAPI tool servers.")+"",g,m,x,p,y=Zn(n[3]),w=[];for(let v=0;v<y.length;v+=1)w[v]=yA(hA(n,y,v));const _=v=>W(w[v],1,1,()=>{w[v]=null});return{c(){e=ee("div"),t=ee("div"),s=vt(i),r=Ce(),a=ee("div"),o=ee("div"),c=vt(l),h=Ce(),u=ee("br"),d=ee("a"),g=vt(f),m=Ce(),x=ee("div");for(let v=0;v<w.length;v+=1)w[v].c();this.h()},l(v){e=te(v,"DIV",{class:!0});var C=q(e);t=te(C,"DIV",{class:!0});var k=q(t);s=kt(k,i),k.forEach(E),C.forEach(E),r=Ae(v),a=te(v,"DIV",{class:!0});var I=q(a);o=te(I,"DIV",{class:!0});var S=q(o);c=kt(S,l),h=Ae(S),u=te(S,"BR",{}),d=te(S,"A",{class:!0,href:!0,target:!0});var M=q(d);g=kt(M,f),M.forEach(E),S.forEach(E),m=Ae(I),x=te(I,"DIV",{class:!0});var N=q(x);for(let F=0;F<w.length;F+=1)w[F].l(N);N.forEach(E),I.forEach(E),this.h()},h(){A(t,"class","text-base font-medium self-center"),A(e,"class","flex justify-between dark:text-gray-300 px-5 pb-0.5"),A(d,"class","underline"),A(d,"href","https://github.com/open-webui/openapi-servers"),A(d,"target","_blank"),A(o,"class","text-xs text-gray-600 dark:text-gray-300 mb-2"),A(x,"class","text-sm dark:text-gray-300 mb-1"),A(a,"class","px-5 pb-5 w-full flex flex-col justify-center")},m(v,C){$(v,e,C),K(e,t),K(t,s),$(v,r,C),$(v,a,C),K(a,o),K(o,c),K(o,h),K(o,u),K(o,d),K(d,g),K(a,m),K(a,x);for(let k=0;k<w.length;k+=1)w[k]&&w[k].m(x,null);p=!0},p(v,C){if((!p||C&4)&&i!==(i=v[2].t("Tool Servers")+"")&&Et(s,i),(!p||C&4)&&l!==(l=v[2].t("Open WebUI can use tools provided by any OpenAPI server.")+"")&&Et(c,l),(!p||C&4)&&f!==(f=v[2].t("Learn more about OpenAPI tool servers.")+"")&&Et(g,f),C&8){y=Zn(v[3]);let k;for(k=0;k<y.length;k+=1){const I=hA(v,y,k);w[k]?(w[k].p(I,C),U(w[k],1)):(w[k]=yA(I),w[k].c(),U(w[k],1),w[k].m(x,null))}for(bt(),k=y.length;k<w.length;k+=1)_(k);xt()}},i(v){if(!p){for(let C=0;C<y.length;C+=1)U(w[C]);p=!0}},o(v){w=w.filter(Boolean);for(let C=0;C<w.length;C+=1)W(w[C]);p=!1},d(v){v&&(E(e),E(r),E(a)),vo(w,v)}}}function Fee(n){var p,y,w,_,v,C,k,I,S,M;let e,t,i=((w=(y=(p=n[9])==null?void 0:p.openapi)==null?void 0:y.info)==null?void 0:w.title)+"",s,r,a=((C=(v=(_=n[9])==null?void 0:_.openapi)==null?void 0:v.info)==null?void 0:C.version)+"",o,l,c,h=((S=(I=(k=n[9])==null?void 0:k.openapi)==null?void 0:I.info)==null?void 0:S.description)+"",u,d,f,g=((M=n[9])==null?void 0:M.url)+"",m,x;return{c(){e=ee("div"),t=ee("div"),s=vt(i),r=vt(" - v"),o=vt(a),l=Ce(),c=ee("div"),u=vt(h),d=Ce(),f=ee("div"),m=vt(g),x=Ce(),this.h()},l(N){e=te(N,"DIV",{});var F=q(e);t=te(F,"DIV",{class:!0});var H=q(t);s=kt(H,i),r=kt(H," - v"),o=kt(H,a),H.forEach(E),l=Ae(F),c=te(F,"DIV",{class:!0});var T=q(c);u=kt(T,h),T.forEach(E),d=Ae(F),f=te(F,"DIV",{class:!0});var z=q(f);m=kt(z,g),z.forEach(E),F.forEach(E),x=Ae(N),this.h()},h(){A(t,"class","text-sm font-medium dark:text-gray-100 text-gray-800"),A(c,"class","text-xs text-gray-500"),A(f,"class","text-xs text-gray-500")},m(N,F){$(N,e,F),K(e,t),K(t,s),K(t,r),K(t,o),K(e,l),K(e,c),K(c,u),K(e,d),K(e,f),K(f,m),$(N,x,F)},p(N,F){var H,T,z,R,L,Y,j,J,G,se;F&8&&i!==(i=((z=(T=(H=N[9])==null?void 0:H.openapi)==null?void 0:T.info)==null?void 0:z.title)+"")&&Et(s,i),F&8&&a!==(a=((Y=(L=(R=N[9])==null?void 0:R.openapi)==null?void 0:L.info)==null?void 0:Y.version)+"")&&Et(o,a),F&8&&h!==(h=((G=(J=(j=N[9])==null?void 0:j.openapi)==null?void 0:J.info)==null?void 0:G.description)+"")&&Et(u,h),F&8&&g!==(g=((se=N[9])==null?void 0:se.url)+"")&&Et(m,g)},d(N){N&&(E(e),E(x))}}}function xA(n){var c,h;let e,t,i=((c=n[12])==null?void 0:c.name)+"",s,r,a,o=((h=n[12])==null?void 0:h.description)+"",l;return{c(){e=ee("div"),t=ee("div"),s=vt(i),r=Ce(),a=ee("div"),l=vt(o),this.h()},l(u){e=te(u,"DIV",{class:!0});var d=q(e);t=te(d,"DIV",{class:!0});var f=q(t);s=kt(f,i),f.forEach(E),r=Ae(d),a=te(d,"DIV",{});var g=q(a);l=kt(g,o),g.forEach(E),d.forEach(E),this.h()},h(){A(t,"class","font-medium text-gray-800 dark:text-gray-100"),A(e,"class","my-1")},m(u,d){$(u,e,d),K(e,t),K(t,s),K(e,r),K(e,a),K(a,l)},p(u,d){var f,g;d&8&&i!==(i=((f=u[12])==null?void 0:f.name)+"")&&Et(s,i),d&8&&o!==(o=((g=u[12])==null?void 0:g.description)+"")&&Et(l,o)},d(u){u&&E(e)}}}function Lee(n){var r;let e,t,i=Zn(((r=n[9])==null?void 0:r.specs)??[]),s=[];for(let a=0;a<i.length;a+=1)s[a]=xA(uA(n,i,a));return{c(){e=ee("div");for(let a=0;a<s.length;a+=1)s[a].c();t=Ce(),this.h()},l(a){e=te(a,"DIV",{slot:!0});var o=q(e);for(let l=0;l<s.length;l+=1)s[l].l(o);t=Ae(o),o.forEach(E),this.h()},h(){A(e,"slot","content")},m(a,o){$(a,e,o);for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(e,null);K(e,t)},p(a,o){var l;if(o&8){i=Zn(((l=a[9])==null?void 0:l.specs)??[]);let c;for(c=0;c<i.length;c+=1){const h=uA(a,i,c);s[c]?s[c].p(h,o):(s[c]=xA(h),s[c].c(),s[c].m(e,t))}for(;c<s.length;c+=1)s[c].d(1);s.length=i.length}},d(a){a&&E(e),vo(s,a)}}}function yA(n){let e,t;return e=new Wg({props:{buttonClassName:"w-full",chevron:!0,$$slots:{content:[Lee],default:[Fee]},$$scope:{ctx:n}}}),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p(i,s){const r={};s&262152&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function Bee(n){let e,t,i,s=n[2].t("Available Tools")+"",r,a,o,l,c,h,u,d,f;l=new sx({props:{className:"size-5"}});let g=n[1].length>0&&fA(n),m=n[3].length>0&&bA(n);return{c(){e=ee("div"),t=ee("div"),i=ee("div"),r=vt(s),a=Ce(),o=ee("button"),me(l.$$.fragment),c=Ce(),g&&g.c(),h=Ce(),m&&m.c(),this.h()},l(x){e=te(x,"DIV",{});var p=q(e);t=te(p,"DIV",{class:!0});var y=q(t);i=te(y,"DIV",{class:!0});var w=q(i);r=kt(w,s),w.forEach(E),a=Ae(y),o=te(y,"BUTTON",{class:!0});var _=q(o);xe(l.$$.fragment,_),_.forEach(E),y.forEach(E),c=Ae(p),g&&g.l(p),h=Ae(p),m&&m.l(p),p.forEach(E),this.h()},h(){A(i,"class","text-lg font-medium self-center"),A(o,"class","self-center"),A(t,"class","flex justify-between dark:text-gray-300 px-5 pt-4 pb-0.5")},m(x,p){$(x,e,p),K(e,t),K(t,i),K(i,r),K(t,a),K(t,o),pe(l,o,null),K(e,c),g&&g.m(e,null),K(e,h),m&&m.m(e,null),u=!0,d||(f=yt(o,"click",n[7]),d=!0)},p(x,p){(!u||p&4)&&s!==(s=x[2].t("Available Tools")+"")&&Et(r,s),x[1].length>0?g?(g.p(x,p),p&2&&U(g,1)):(g=fA(x),g.c(),U(g,1),g.m(e,h)):g&&(bt(),W(g,1,1,()=>{g=null}),xt()),x[3].length>0?m?(m.p(x,p),p&8&&U(m,1)):(m=bA(x),m.c(),U(m,1),m.m(e,null)):m&&(bt(),W(m,1,1,()=>{m=null}),xt())},i(x){u||(U(l.$$.fragment,x),U(g),U(m),u=!0)},o(x){W(l.$$.fragment,x),W(g),W(m),u=!1},d(x){x&&E(e),be(l),g&&g.d(),m&&m.d(),d=!1,f()}}}function Uee(n){let e,t,i;function s(a){n[8](a)}let r={size:"md",$$slots:{default:[Bee]},$$scope:{ctx:n}};return n[0]!==void 0&&(r.show=n[0]),e=new pF({props:r}),It.push(()=>Wt(e,"show",s)),{c(){me(e.$$.fragment)},l(a){xe(e.$$.fragment,a)},m(a,o){pe(e,a,o),i=!0},p(a,[o]){const l={};o&262159&&(l.$$scope={dirty:o,ctx:a}),!t&&o&1&&(t=!0,l.show=a[0],qt(()=>t=!1)),e.$set(l)},i(a){i||(U(e.$$.fragment,a),i=!0)},o(a){W(e.$$.fragment,a),i=!1},d(a){be(e,a)}}}function Hee(n,e,t){let i,s,r;Pe(n,Gd,d=>t(6,i=d)),Pe(n,NI,d=>t(3,r=d));let{show:a=!1}=e,{selectedToolIds:o=[]}=e,l=[];const c=as("i18n");Pe(n,c,d=>t(2,s=d));const h=()=>{t(0,a=!1)};function u(d){a=d,t(0,a)}return n.$$set=d=>{"show"in d&&t(0,a=d.show),"selectedToolIds"in d&&t(5,o=d.selectedToolIds)},n.$$.update=()=>{n.$$.dirty&96&&t(1,l=(i??[]).filter(d=>o.includes(d.id)))},[a,l,s,r,c,o,i,h,u]}class zee extends Nt{constructor(e){super(),Ot(this,e,Hee,Uee,Ut,{show:0,selectedToolIds:5})}}function jee(n){let e,t;return{c(){e=at("svg"),t=at("path"),this.h()},l(i){e=ot(i,"svg",{"aria-hidden":!0,xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=q(e);t=ot(s,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),q(t).forEach(E),s.forEach(E),this.h()},h(){A(t,"fill-rule","evenodd"),A(t,"d","M12 5a7 7 0 0 0-7 7v1.17c.313-.11.65-.17 1-.17h2a1 1 0 0 1 1 1v6a1 1 0 0 1-1 1H6a3 3 0 0 1-3-3v-6a9 9 0 0 1 18 0v6a3 3 0 0 1-3 3h-2a1 1 0 0 1-1-1v-6a1 1 0 0 1 1-1h2c.35 0 .687.06 1 .17V12a7 7 0 0 0-7-7Z"),A(t,"clip-rule","evenodd"),A(e,"aria-hidden","true"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"fill","currentColor"),A(e,"viewBox","0 0 24 24"),A(e,"stroke-width",n[1]),A(e,"stroke","currentColor"),A(e,"class",n[0])},m(i,s){$(i,e,s),K(e,t)},p(i,[s]){s&2&&A(e,"stroke-width",i[1]),s&1&&A(e,"class",i[0])},i:Ct,o:Ct,d(i){i&&E(e)}}}function Gee(n,e,t){let{className:i="w-4 h-4"}=e,{strokeWidth:s="0"}=e;return n.$$set=r=>{"className"in r&&t(0,i=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[i,s]}class Vee extends Nt{constructor(e){super(),Ot(this,e,Gee,jee,Ut,{className:0,strokeWidth:1})}}function qee(n){let e,t;return{c(){e=at("svg"),t=at("path"),this.h()},l(i){e=ot(i,"svg",{class:!0,"stroke-width":!0,"aria-hidden":!0,xmlns:!0,fill:!0,viewBox:!0});var s=q(e);t=ot(s,"path",{stroke:!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),q(t).forEach(E),s.forEach(E),this.h()},h(){A(t,"stroke","currentColor"),A(t,"stroke-linecap","round"),A(t,"stroke-linejoin","round"),A(t,"stroke-width","2"),A(t,"d","m3 16 5-7 6 6.5m6.5 2.5L16 13l-4.286 6M14 10h.01M4 19h16a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1Z"),A(e,"class",n[0]),A(e,"stroke-width",n[1]),A(e,"aria-hidden","true"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"fill","none"),A(e,"viewBox","0 0 24 24")},m(i,s){$(i,e,s),K(e,t)},p(i,[s]){s&1&&A(e,"class",i[0]),s&2&&A(e,"stroke-width",i[1])},i:Ct,o:Ct,d(i){i&&E(e)}}}function Wee(n,e,t){let{className:i="size-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,i=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[i,s]}class Kee extends Nt{constructor(e){super(),Ot(this,e,Wee,qee,Ut,{className:0,strokeWidth:1})}}function Xee(n){let e,t,i;return{c(){e=at("svg"),t=at("path"),i=at("path"),this.h()},l(s){e=ot(s,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,"aria-hidden":!0,stroke:!0,class:!0});var r=q(e);t=ot(r,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),q(t).forEach(E),i=ot(r,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),q(i).forEach(E),r.forEach(E),this.h()},h(){A(t,"stroke-linecap","round"),A(t,"stroke-linejoin","round"),A(t,"d","M21.75 6.75a4.5 4.5 0 0 1-4.884 4.484c-1.076-.091-2.264.071-2.95.904l-7.152 8.684a2.548 2.548 0 1 1-3.586-3.586l8.684-7.152c.833-.686.995-1.874.904-2.95a4.5 4.5 0 0 1 6.336-4.486l-3.276 3.276a3.004 3.004 0 0 0 2.25 2.25l3.276-3.276c.256.565.398 1.192.398 1.852Z"),A(i,"stroke-linecap","round"),A(i,"stroke-linejoin","round"),A(i,"d","M4.867 19.125h.008v.008h-.008v-.008Z"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"fill","none"),A(e,"viewBox","0 0 24 24"),A(e,"stroke-width",n[1]),A(e,"aria-hidden","true"),A(e,"stroke","currentColor"),A(e,"class",n[0])},m(s,r){$(s,e,r),K(e,t),K(e,i)},p(s,[r]){r&2&&A(e,"stroke-width",s[1]),r&1&&A(e,"class",s[0])},i:Ct,o:Ct,d(s){s&&E(e)}}}function Yee(n,e,t){let{className:i="w-4 h-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,i=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[i,s]}class Jee extends Nt{constructor(e){super(),Ot(this,e,Yee,Xee,Ut,{className:0,strokeWidth:1})}}function wA(n,e,t){const i=n.slice();return i[125]=e[t],i[127]=t,i}function _A(n,e,t){const i=n.slice();return i[128]=e[t],i[130]=t,i}function vA(n){var z;let e,t,i,s,r,a,o,l,c,h,u,d,f,g,m,x,p,y,w,_,v,C,k,I=n[8]===!1&&((z=n[14])==null?void 0:z.currentId)&&kA(n),S=n[0]!==void 0&&CA(n);function M(R){n[70](R)}let N={show:n[9],command:n[18],insertTextHandler:n[51],onUpload:n[67],onSelect:n[68]};n[2]!==void 0&&(N.files=n[2]),l=new xD({props:N}),n[69](l),It.push(()=>Wt(l,"files",M));const F=[Qee,Zee],H=[];function T(R,L){return R[28]?0:1}return p=T(n),y=H[p]=F[p](n),{c(){e=ee("div"),t=ee("div"),i=ee("div"),s=ee("div"),I&&I.c(),r=Ce(),a=ee("div"),S&&S.c(),o=Ce(),me(l.$$.fragment),u=Ce(),d=ee("div"),f=ee("div"),g=ee("div"),m=ee("input"),x=Ce(),y.c(),this.h()},l(R){e=te(R,"DIV",{class:!0});var L=q(e);t=te(L,"DIV",{class:!0});var Y=q(t);i=te(Y,"DIV",{class:!0});var j=q(i);s=te(j,"DIV",{class:!0});var J=q(s);I&&I.l(J),J.forEach(E),r=Ae(j),a=te(j,"DIV",{class:!0});var G=q(a);S&&S.l(G),o=Ae(G),xe(l.$$.fragment,G),G.forEach(E),j.forEach(E),Y.forEach(E),u=Ae(L),d=te(L,"DIV",{class:!0});var se=q(d);f=te(se,"DIV",{class:!0});var de=q(f);g=te(de,"DIV",{class:!0});var he=q(g);m=te(he,"INPUT",{type:!0}),x=Ae(he),y.l(he),he.forEach(E),de.forEach(E),se.forEach(E),L.forEach(E),this.h()},h(){var R,L;A(s,"class","relative"),A(a,"class","w-full relative"),A(i,"class",h="flex flex-col px-3 "+(((R=n[43])==null?void 0:R.widescreenMode)??null?"max-w-full":"max-w-6xl")+" w-full"),A(t,"class","mx-auto inset-x-0 bg-transparent flex justify-center"),A(m,"type","file"),m.hidden=!0,m.multiple=!0,A(g,"class",""),A(f,"class",w=(((L=n[43])==null?void 0:L.widescreenMode)??null?"max-w-full":"max-w-6xl")+" px-2.5 mx-auto inset-x-0"),A(d,"class",_=n[10]?"bg-transparent":"bg-white dark:bg-gray-900"),A(e,"class","w-full font-primary")},m(R,L){$(R,e,L),K(e,t),K(t,i),K(i,s),I&&I.m(s,null),K(i,r),K(i,a),S&&S.m(a,null),K(a,o),pe(l,a,null),K(e,u),K(e,d),K(d,f),K(f,g),K(g,m),n[71](m),K(g,x),H[p].m(g,null),v=!0,C||(k=[yt(m,"change",n[72]),yt(m,"change",n[73])],C=!0)},p(R,L){var J,G,se;R[8]===!1&&((J=R[14])!=null&&J.currentId)?I?I.p(R,L):(I=kA(R),I.c(),I.m(s,null)):I&&(I.d(1),I=null),R[0]!==void 0?S?(S.p(R,L),L[0]&1&&U(S,1)):(S=CA(R),S.c(),U(S,1),S.m(a,o)):S&&(bt(),W(S,1,1,()=>{S=null}),xt());const Y={};L[0]&512&&(Y.show=R[9]),L[0]&262144&&(Y.command=R[18]),L[0]&4&&(Y.onUpload=R[67]),L[0]&1&&(Y.onSelect=R[68]),!c&&L[0]&4&&(c=!0,Y.files=R[2],qt(()=>c=!1)),l.$set(Y),(!v||L[1]&4096&&h!==(h="flex flex-col px-3 "+(((G=R[43])==null?void 0:G.widescreenMode)??null?"max-w-full":"max-w-6xl")+" w-full"))&&A(i,"class",h);let j=p;p=T(R),p===j?H[p].p(R,L):(bt(),W(H[j],1,1,()=>{H[j]=null}),xt(),y=H[p],y?y.p(R,L):(y=H[p]=F[p](R),y.c()),U(y,1),y.m(g,null)),(!v||L[1]&4096&&w!==(w=(((se=R[43])==null?void 0:se.widescreenMode)??null?"max-w-full":"max-w-6xl")+" px-2.5 mx-auto inset-x-0"))&&A(f,"class",w),(!v||L[0]&1024&&_!==(_=R[10]?"bg-transparent":"bg-white dark:bg-gray-900"))&&A(d,"class",_)},i(R){v||(U(S),U(l.$$.fragment,R),U(y),v=!0)},o(R){W(S),W(l.$$.fragment,R),W(y),v=!1},d(R){R&&E(e),I&&I.d(),S&&S.d(),n[69](null),be(l),n[71](null),H[p].d(),C=!1,Qr(k)}}}function kA(n){let e,t,i='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path fill-rule="evenodd" d="M10 3a.75.75 0 01.75.75v10.638l3.96-4.158a.75.75 0 111.08 1.04l-5.25 5.5a.75.75 0 01-1.08 0l-5.25-5.5a.75.75 0 111.08-1.04l3.96 4.158V3.75A.75.75 0 0110 3z" clip-rule="evenodd"></path></svg>',s,r;return{c(){e=ee("div"),t=ee("button"),t.innerHTML=i,this.h()},l(a){e=te(a,"DIV",{class:!0});var o=q(e);t=te(o,"BUTTON",{class:!0,"data-svelte-h":!0}),ko(t)!=="svelte-h8r9o0"&&(t.innerHTML=i),o.forEach(E),this.h()},h(){A(t,"class","bg-white border border-gray-100 dark:border-none dark:bg-white/20 p-1.5 rounded-full pointer-events-auto"),A(e,"class","absolute -top-12 left-0 right-0 flex justify-center z-30 pointer-events-none")},m(a,o){$(a,e,o),K(e,t),s||(r=yt(t,"click",n[64]),s=!0)},p:Ct,d(a){a&&E(e),s=!1,r()}}}function CA(n){let e,t,i,s,r,a,o,l,c,h=n[0].name+"",u,d,f,g,m,x,p,y;return m=new sx({}),{c(){e=ee("div"),t=ee("div"),i=ee("div"),s=ee("img"),a=Ce(),o=ee("div"),l=vt("Talking to "),c=ee("span"),u=vt(h),d=Ce(),f=ee("div"),g=ee("button"),me(m.$$.fragment),this.h()},l(w){e=te(w,"DIV",{class:!0});var _=q(e);t=te(_,"DIV",{class:!0});var v=q(t);i=te(v,"DIV",{class:!0});var C=q(i);s=te(C,"IMG",{crossorigin:!0,alt:!0,class:!0,src:!0}),a=Ae(C),o=te(C,"DIV",{class:!0});var k=q(o);l=kt(k,"Talking to "),c=te(k,"SPAN",{class:!0});var I=q(c);u=kt(I,h),I.forEach(E),k.forEach(E),C.forEach(E),d=Ae(v),f=te(v,"DIV",{});var S=q(f);g=te(S,"BUTTON",{class:!0});var M=q(g);xe(m.$$.fragment,M),M.forEach(E),S.forEach(E),v.forEach(E),_.forEach(E),this.h()},h(){var w,_,v;A(s,"crossorigin","anonymous"),A(s,"alt","model profile"),A(s,"class","size-3.5 max-w-[28px] object-cover rounded-full"),b0(s.src,r=((v=(_=(w=n[21].find(n[65]))==null?void 0:w.info)==null?void 0:_.meta)==null?void 0:v.profile_image_url)??(n[44].language==="dg-DG"?`${Yo}/doge.png`:`${Yo}/static/favicon.png`))||A(s,"src",r),A(c,"class","font-medium"),A(o,"class","translate-y-[0.5px]"),A(i,"class","pl-[1px] flex items-center gap-2 text-sm dark:text-gray-500"),A(g,"class","flex items-center dark:text-gray-500"),A(t,"class","flex items-center justify-between w-full"),A(e,"class","px-3 pb-0.5 pt-1.5 text-left w-full flex flex-col absolute bottom-0 left-0 right-0 bg-linear-to-t from-white dark:from-gray-900 z-10")},m(w,_){$(w,e,_),K(e,t),K(t,i),K(i,s),K(i,a),K(i,o),K(o,l),K(o,c),K(c,u),K(t,d),K(t,f),K(f,g),pe(m,g,null),x=!0,p||(y=yt(g,"click",n[66]),p=!0)},p(w,_){var v,C,k;(!x||_[0]&2097153|_[1]&8192&&!b0(s.src,r=((k=(C=(v=w[21].find(w[65]))==null?void 0:v.info)==null?void 0:C.meta)==null?void 0:k.profile_image_url)??(w[44].language==="dg-DG"?`${Yo}/doge.png`:`${Yo}/static/favicon.png`)))&&A(s,"src",r),(!x||_[0]&1)&&h!==(h=w[0].name+"")&&Et(u,h)},i(w){x||(U(m.$$.fragment,w),x=!0)},o(w){W(m.$$.fragment,w),x=!1},d(w){w&&E(e),be(m),p=!1,y()}}}function Zee(n){var G,se,de,he,we,ye;let e,t,i,s,r,a,o,l,c,h,u,d,f,g,m,x,p,y,w,_,v,C,k=n[2].length>0&&AA(n);const I=[ite,nte],S=[];function M(P,V){var re;return((re=P[43])==null?void 0:re.richTextInput)??!0?0:1}r=M(n),a=S[r]=I[r](n);function N(P){n[102](P)}let F={selectedModels:n[0]?[n[0].id]:n[13],fileUploadCapableModels:n[37],screenCaptureHandler:n[53],inputFilesHandler:n[55],uploadFilesHandler:n[98],uploadGoogleDriveHandler:n[99],uploadOneDriveHandler:n[100],onClose:n[101],$$slots:{default:[ste]},$$scope:{ctx:n}};n[3]!==void 0&&(F.selectedToolIds=n[3]),h=new Oee({props:F}),It.push(()=>Wt(h,"selectedToolIds",N));let H=n[20]&&(n[39]||n[38]&&n[38].length>0||n[40]||n[41]||n[42])&&EA(n),T=(!((G=n[14])!=null&&G.currentId)||((se=n[14].messages[n[14].currentId])==null?void 0:se.done)==!0)&&(((de=n[20])==null?void 0:de.role)==="admin"||(((ye=(we=(he=n[20])==null?void 0:he.permissions)==null?void 0:we.chat)==null?void 0:ye.stt)??!0))&&OA(n);const z=[mte,gte,fte],R=[];function L(P,V){var re,X,ue,oe,Q;return P[15]&&P[15].length>0||P[14].currentId&&((re=P[14].messages[P[14].currentId])==null?void 0:re.done)!=!0?0:P[1]===""&&P[2].length===0&&(((X=P[20])==null?void 0:X.role)==="admin"||(((Q=(oe=(ue=P[20])==null?void 0:ue.permissions)==null?void 0:oe.chat)==null?void 0:Q.call)??!0))?1:2}x=L(n),p=R[x]=z[x](n);function Y(P,V){var re,X;return(X=(re=P[19])==null?void 0:re.license_metadata)!=null&&X.input_footer?wte:yte}let j=Y(n),J=j(n);return{c(){e=ee("form"),t=ee("div"),k&&k.c(),i=Ce(),s=ee("div"),a.c(),o=Ce(),l=ee("div"),c=ee("div"),me(h.$$.fragment),d=Ce(),H&&H.c(),f=Ce(),g=ee("div"),T&&T.c(),m=Ce(),p.c(),w=Ce(),J.c(),this.h()},l(P){e=te(P,"FORM",{class:!0});var V=q(e);t=te(V,"DIV",{class:!0,dir:!0});var re=q(t);k&&k.l(re),i=Ae(re),s=te(re,"DIV",{class:!0});var X=q(s);a.l(X),X.forEach(E),o=Ae(re),l=te(re,"DIV",{class:!0,dir:!0});var ue=q(l);c=te(ue,"DIV",{class:!0});var oe=q(c);xe(h.$$.fragment,oe),d=Ae(oe),H&&H.l(oe),oe.forEach(E),f=Ae(ue),g=te(ue,"DIV",{class:!0});var Q=q(g);T&&T.l(Q),m=Ae(Q),p.l(Q),Q.forEach(E),ue.forEach(E),re.forEach(E),w=Ae(V),J.l(V),V.forEach(E),this.h()},h(){var P;A(s,"class","px-2.5"),A(c,"class","ml-1 self-end flex items-center flex-1 max-w-[80%]"),A(g,"class","self-end flex space-x-1 mr-1 shrink-0"),A(l,"class","flex justify-between mt-0.5 mb-2.5 mx-0.5 max-w-full"),A(l,"dir","ltr"),A(t,"class","flex-1 flex flex-col relative w-full shadow-lg rounded-3xl border border-gray-50 dark:border-gray-850 hover:border-gray-100 focus-within:border-gray-100 hover:dark:border-gray-800 focus-within:dark:border-gray-800 transition px-1 bg-white/90 dark:bg-gray-400/5 dark:text-gray-100"),A(t,"dir",y=((P=n[43])==null?void 0:P.chatDirection)??"auto"),A(e,"class","w-full flex flex-col gap-1.5")},m(P,V){$(P,e,V),K(e,t),k&&k.m(t,null),K(t,i),K(t,s),S[r].m(s,null),K(t,o),K(t,l),K(l,c),pe(h,c,null),K(c,d),H&&H.m(c,null),K(l,f),K(l,g),T&&T.m(g,null),K(g,m),R[x].m(g,null),K(e,w),J.m(e,null),_=!0,v||(C=yt(e,"submit",qg(n[111])),v=!0)},p(P,V){var oe,Q,ae,Ke,Ue,De,je;P[2].length>0?k?(k.p(P,V),V[0]&4&&U(k,1)):(k=AA(P),k.c(),U(k,1),k.m(t,i)):k&&(bt(),W(k,1,1,()=>{k=null}),xt());let re=r;r=M(P),r===re?S[r].p(P,V):(bt(),W(S[re],1,1,()=>{S[re]=null}),xt(),a=S[r],a?a.p(P,V):(a=S[r]=I[r](P),a.c()),U(a,1),a.m(s,null));const X={};V[0]&8193&&(X.selectedModels=P[0]?[P[0].id]:P[13]),V[1]&64&&(X.fileUploadCapableModels=P[37]),V[1]&1&&(X.uploadFilesHandler=P[98]),V[1]&8192&&(X.uploadGoogleDriveHandler=P[99]),V[4]&128&&(X.$$scope={dirty:V,ctx:P}),!u&&V[0]&8&&(u=!0,X.selectedToolIds=P[3],qt(()=>u=!1)),h.$set(X),P[20]&&(P[39]||P[38]&&P[38].length>0||P[40]||P[41]||P[42])?H?(H.p(P,V),V[0]&1048576|V[1]&3968&&U(H,1)):(H=EA(P),H.c(),U(H,1),H.m(c,null)):H&&(bt(),W(H,1,1,()=>{H=null}),xt()),(!((oe=P[14])!=null&&oe.currentId)||((Q=P[14].messages[P[14].currentId])==null?void 0:Q.done)==!0)&&(((ae=P[20])==null?void 0:ae.role)==="admin"||(((De=(Ue=(Ke=P[20])==null?void 0:Ke.permissions)==null?void 0:Ue.chat)==null?void 0:De.stt)??!0))?T?(T.p(P,V),V[0]&1064960&&U(T,1)):(T=OA(P),T.c(),U(T,1),T.m(g,m)):T&&(bt(),W(T,1,1,()=>{T=null}),xt());let ue=x;x=L(P),x===ue?R[x].p(P,V):(bt(),W(R[ue],1,1,()=>{R[ue]=null}),xt(),p=R[x],p?p.p(P,V):(p=R[x]=z[x](P),p.c()),U(p,1),p.m(g,null)),(!_||V[1]&4096&&y!==(y=((je=P[43])==null?void 0:je.chatDirection)??"auto"))&&A(t,"dir",y),j===(j=Y(P))&&J?J.p(P,V):(J.d(1),J=j(P),J&&(J.c(),J.m(e,null)))},i(P){_||(U(k),U(a),U(h.$$.fragment,P),U(H),U(T),U(p),_=!0)},o(P){W(k),W(a),W(h.$$.fragment,P),W(H),W(T),W(p),_=!1},d(P){P&&E(e),k&&k.d(),S[r].d(),be(h),H&&H.d(),T&&T.d(),R[x].d(),J.d(),v=!1,C()}}}function Qee(n){let e,t,i;function s(a){n[76](a)}let r={onCancel:n[74],onConfirm:n[75]};return n[28]!==void 0&&(r.recording=n[28]),e=new dF({props:r}),It.push(()=>Wt(e,"recording",s)),{c(){me(e.$$.fragment)},l(a){xe(e.$$.fragment,a)},m(a,o){pe(e,a,o),i=!0},p(a,o){const l={};o[0]&268435456&&(l.onCancel=a[74]),o[0]&268435458|o[1]&4096&&(l.onConfirm=a[75]),!t&&o[0]&268435456&&(t=!0,l.recording=a[28],qt(()=>t=!1)),e.$set(l)},i(a){i||(U(e.$$.fragment,a),i=!0)},o(a){W(e.$$.fragment,a),i=!1},d(a){be(e,a)}}}function AA(n){let e,t,i=Zn(n[2]),s=[];for(let a=0;a<i.length;a+=1)s[a]=IA(_A(n,i,a));const r=a=>W(s[a],1,1,()=>{s[a]=null});return{c(){e=ee("div");for(let a=0;a<s.length;a+=1)s[a].c();this.h()},l(a){e=te(a,"DIV",{class:!0});var o=q(e);for(let l=0;l<s.length;l+=1)s[l].l(o);o.forEach(E),this.h()},h(){A(e,"class","mx-2 mt-2.5 -mb-1 flex items-center flex-wrap gap-2")},m(a,o){$(a,e,o);for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(e,null);t=!0},p(a,o){if(o[0]&8197|o[1]&12320){i=Zn(a[2]);let l;for(l=0;l<i.length;l+=1){const c=_A(a,i,l);s[l]?(s[l].p(c,o),U(s[l],1)):(s[l]=IA(c),s[l].c(),U(s[l],1),s[l].m(e,null))}for(bt(),l=i.length;l<s.length;l+=1)r(l);xt()}},i(a){if(!t){for(let o=0;o<i.length;o+=1)U(s[o]);t=!0}},o(a){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)W(s[o]);t=!1},d(a){a&&E(e),vo(s,a)}}}function $ee(n){var r,a;let e,t;function i(){return n[79](n[130])}function s(){return n[80](n[128])}return e=new BI({props:{item:n[128],name:n[128].name,type:n[128].type,size:(r=n[128])==null?void 0:r.size,loading:n[128].status==="uploading",dismissible:!0,edit:!0,modal:["file","collection"].includes((a=n[128])==null?void 0:a.type)}}),e.$on("dismiss",i),e.$on("click",s),{c(){me(e.$$.fragment)},l(o){xe(e.$$.fragment,o)},m(o,l){pe(e,o,l),t=!0},p(o,l){var h,u;n=o;const c={};l[0]&4&&(c.item=n[128]),l[0]&4&&(c.name=n[128].name),l[0]&4&&(c.type=n[128].type),l[0]&4&&(c.size=(h=n[128])==null?void 0:h.size),l[0]&4&&(c.loading=n[128].status==="uploading"),l[0]&4&&(c.modal=["file","collection"].includes((u=n[128])==null?void 0:u.type)),e.$set(c)},i(o){t||(U(e.$$.fragment,o),t=!0)},o(o){W(e.$$.fragment,o),t=!1},d(o){be(e,o)}}}function ete(n){let e,t,i,s,r,a,o,l,c,h,u,d,f,g,m;i=new hD({props:{src:n[128].url,alt:"",imageClassName:" size-14 rounded-xl object-cover"}});let x=(n[0]?n[36].length===0:n[13].length!==n[36].length)&&SA(n);function p(){return n[78](n[130])}return{c(){e=ee("div"),t=ee("div"),me(i.$$.fragment),s=Ce(),x&&x.c(),r=Ce(),a=ee("div"),o=ee("button"),l=at("svg"),c=at("path"),d=Ce(),this.h()},l(y){e=te(y,"DIV",{class:!0});var w=q(e);t=te(w,"DIV",{class:!0});var _=q(t);xe(i.$$.fragment,_),s=Ae(_),x&&x.l(_),_.forEach(E),r=Ae(w),a=te(w,"DIV",{class:!0});var v=q(a);o=te(v,"BUTTON",{class:!0,type:!0,"aria-label":!0});var C=q(o);l=ot(C,"svg",{xmlns:!0,viewBox:!0,fill:!0,"aria-hidden":!0,class:!0});var k=q(l);c=ot(k,"path",{d:!0}),q(c).forEach(E),k.forEach(E),C.forEach(E),v.forEach(E),d=Ae(w),w.forEach(E),this.h()},h(){var y;A(t,"class","relative flex items-center"),A(c,"d","M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"),A(l,"xmlns","http://www.w3.org/2000/svg"),A(l,"viewBox","0 0 20 20"),A(l,"fill","currentColor"),A(l,"aria-hidden","true"),A(l,"class","size-4"),A(o,"class",h="bg-white text-black border border-white rounded-full "+(((y=n[43])==null?void 0:y.highContrastMode)??!1?"":"outline-hidden focus:outline-hidden group-hover:visible invisible transition")),A(o,"type","button"),A(o,"aria-label",u=n[44].t("Remove file")),A(a,"class","absolute -top-1 -right-1"),A(e,"class","relative group")},m(y,w){$(y,e,w),K(e,t),pe(i,t,null),K(t,s),x&&x.m(t,null),K(e,r),K(e,a),K(a,o),K(o,l),K(l,c),K(e,d),f=!0,g||(m=yt(o,"click",p),g=!0)},p(y,w){var v;n=y;const _={};w[0]&4&&(_.src=n[128].url),i.$set(_),(n[0]?n[36].length===0:n[13].length!==n[36].length)?x?(x.p(n,w),w[0]&8193|w[1]&32&&U(x,1)):(x=SA(n),x.c(),U(x,1),x.m(t,null)):x&&(bt(),W(x,1,1,()=>{x=null}),xt()),(!f||w[1]&4096&&h!==(h="bg-white text-black border border-white rounded-full "+(((v=n[43])==null?void 0:v.highContrastMode)??!1?"":"outline-hidden focus:outline-hidden group-hover:visible invisible transition")))&&A(o,"class",h),(!f||w[1]&8192&&u!==(u=n[44].t("Remove file")))&&A(o,"aria-label",u)},i(y){f||(U(i.$$.fragment,y),U(x),f=!0)},o(y){W(i.$$.fragment,y),W(x),f=!1},d(y){y&&E(e),be(i),x&&x.d(),g=!1,m()}}}function SA(n){let e,t;return e=new wi({props:{className:" absolute top-1 left-1",content:n[44].t("{{ models }}",{models:[...n[0]?[n[0]]:n[13]].filter(n[77]).join(", ")}),$$slots:{default:[tte]},$$scope:{ctx:n}}}),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p(i,s){const r={};s[0]&8193|s[1]&8224&&(r.content=i[44].t("{{ models }}",{models:[...i[0]?[i[0]]:i[13]].filter(i[77]).join(", ")})),s[4]&128&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function tte(n){let e,t;return{c(){e=at("svg"),t=at("path"),this.h()},l(i){e=ot(i,"svg",{xmlns:!0,viewBox:!0,fill:!0,"aria-hidden":!0,class:!0});var s=q(e);t=ot(s,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),q(t).forEach(E),s.forEach(E),this.h()},h(){A(t,"fill-rule","evenodd"),A(t,"d","M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003ZM12 8.25a.75.75 0 0 1 .75.75v3.75a.75.75 0 0 1-1.5 0V9a.75.75 0 0 1 .75-.75Zm0 8.25a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z"),A(t,"clip-rule","evenodd"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"viewBox","0 0 24 24"),A(e,"fill","currentColor"),A(e,"aria-hidden","true"),A(e,"class","size-4 fill-yellow-300")},m(i,s){$(i,e,s),K(e,t)},p:Ct,d(i){i&&E(e)}}}function IA(n){let e,t,i,s;const r=[ete,$ee],a=[];function o(l,c){return l[128].type==="image"?0:1}return e=o(n),t=a[e]=r[e](n),{c(){t.c(),i=zt()},l(l){t.l(l),i=zt()},m(l,c){a[e].m(l,c),$(l,i,c),s=!0},p(l,c){let h=e;e=o(l),e===h?a[e].p(l,c):(bt(),W(a[h],1,1,()=>{a[h]=null}),xt(),t=a[e],t?t.p(l,c):(t=a[e]=r[e](l),t.c()),U(t,1),t.m(i.parentNode,i))},i(l){s||(U(t),s=!0)},o(l){W(t),s=!1},d(l){l&&E(i),a[e].d(l)}}}function nte(n){let e,t,i,s,r;return{c(){e=ee("textarea"),this.h()},l(a){e=te(a,"TEXTAREA",{id:!0,dir:!0,class:!0,placeholder:!0,rows:!0}),q(e).forEach(E),this.h()},h(){var a;A(e,"id","chat-input"),A(e,"dir",t=((a=n[43])==null?void 0:a.chatDirection)??"auto"),A(e,"class","scrollbar-hidden bg-transparent dark:text-gray-200 outline-hidden w-full pt-3 px-1 resize-none"),A(e,"placeholder",i=n[17]?n[17]:n[44].t("Send a Message")),A(e,"rows","1")},m(a,o){$(a,e,o),n[88](e),yo(e,n[1]),s||(r=[yt(e,"input",n[89]),yt(e,"input",n[90]),yt(e,"click",n[91]),yt(e,"compositionstart",n[92]),yt(e,"compositionend",n[93]),yt(e,"keydown",n[94]),yt(e,"input",n[95]),yt(e,"focus",n[96]),yt(e,"paste",n[97])],s=!0)},p(a,o){var l;o[1]&4096&&t!==(t=((l=a[43])==null?void 0:l.chatDirection)??"auto")&&A(e,"dir",t),o[0]&131072|o[1]&8192&&i!==(i=a[17]?a[17]:a[44].t("Send a Message"))&&A(e,"placeholder",i),o[0]&2&&yo(e,a[1])},i:Ct,o:Ct,d(a){a&&E(e),n[88](null),s=!1,Qr(r)}}}function ite(n){var r,a,o,l,c,h;let e,t,i,s={id:"chat-input",onChange:n[81],json:!0,messageInput:!0,showFormattingButtons:!1,insertPromptAsRichText:((r=n[43])==null?void 0:r.insertPromptAsRichText)??!1,shiftEnter:!(((a=n[43])==null?void 0:a.ctrlEnterToSend)??!1)&&(!n[45]||!("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0)),placeholder:n[17]?n[17]:n[44].t("Send a Message"),largeTextAsFile:(((o=n[43])==null?void 0:o.largeTextAsFile)??!1)&&!n[35],autocomplete:((c=(l=n[19])==null?void 0:l.features)==null?void 0:c.enable_autocomplete_generation)&&(((h=n[43])==null?void 0:h.promptAutocomplete)??!1),generateAutoCompletion:n[82],oncompositionstart:n[83],oncompositionend:n[84]};return t=new fF({props:s}),n[85](t),t.$on("keydown",n[86]),t.$on("paste",n[87]),{c(){e=ee("div"),me(t.$$.fragment),this.h()},l(u){e=te(u,"DIV",{class:!0,id:!0});var d=q(e);xe(t.$$.fragment,d),d.forEach(E),this.h()},h(){A(e,"class","scrollbar-hidden rtl:text-right ltr:text-left bg-transparent dark:text-gray-100 outline-hidden w-full pt-2.5 pb-[5px] px-1 resize-none h-fit max-h-80 overflow-auto"),A(e,"id","chat-input-container")},m(u,d){$(u,e,d),pe(t,e,null),i=!0},p(u,d){var g,m,x,p,y,w;const f={};d[0]&262146&&(f.onChange=u[81]),d[1]&4096&&(f.insertPromptAsRichText=((g=u[43])==null?void 0:g.insertPromptAsRichText)??!1),d[1]&20480&&(f.shiftEnter=!(((m=u[43])==null?void 0:m.ctrlEnterToSend)??!1)&&(!u[45]||!("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0))),d[0]&131072|d[1]&8192&&(f.placeholder=u[17]?u[17]:u[44].t("Send a Message")),d[1]&4112&&(f.largeTextAsFile=(((x=u[43])==null?void 0:x.largeTextAsFile)??!1)&&!u[35]),d[0]&524288|d[1]&4096&&(f.autocomplete=((y=(p=u[19])==null?void 0:p.features)==null?void 0:y.enable_autocomplete_generation)&&(((w=u[43])==null?void 0:w.promptAutocomplete)??!1)),d[0]&4210688|d[1]&8192&&(f.generateAutoCompletion=u[82]),d[0]&536870912&&(f.oncompositionstart=u[83]),d[0]&536870912&&(f.oncompositionend=u[84]),t.$set(f)},i(u){i||(U(t.$$.fragment,u),i=!0)},o(u){W(t.$$.fragment,u),i=!1},d(u){u&&E(e),n[85](null),be(t)}}}function ste(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" aria-hidden="true" fill="currentColor" class="size-5"><path d="M10.75 4.75a.75.75 0 0 0-1.5 0v4.5h-4.5a.75.75 0 0 0 0 1.5h4.5v4.5a.75.75 0 0 0 1.5 0v-4.5h4.5a.75.75 0 0 0 0-1.5h-4.5v-4.5Z"></path></svg>';return{c(){e=ee("div"),e.innerHTML=t,this.h()},l(i){e=te(i,"DIV",{class:!0,"data-svelte-h":!0}),ko(e)!=="svelte-cdbbcu"&&(e.innerHTML=t),this.h()},h(){A(e,"class","bg-transparent hover:bg-gray-100 text-gray-800 dark:text-white dark:hover:bg-gray-800 rounded-full p-1.5 outline-hidden focus:outline-hidden")},m(i,s){$(i,e,s)},p:Ct,d(i){i&&E(e)}}}function EA(n){let e,t,i,s,r=[],a=new Map,o,l,c,h,u=n[39]&&TA(n),d=Zn(n[38]);const f=p=>p[125].id;for(let p=0;p<d.length;p+=1){let y=wA(n,d,p),w=f(y);a.set(w,r[p]=RA(w,y))}let g=n[40]&&MA(n),m=n[41]&&PA(n),x=n[42]&&NA(n);return{c(){e=ee("div"),t=Ce(),i=ee("div"),u&&u.c(),s=Ce();for(let p=0;p<r.length;p+=1)r[p].c();o=Ce(),g&&g.c(),l=Ce(),m&&m.c(),c=Ce(),x&&x.c(),this.h()},l(p){e=te(p,"DIV",{class:!0}),q(e).forEach(E),t=Ae(p),i=te(p,"DIV",{class:!0});var y=q(i);u&&u.l(y),s=Ae(y);for(let w=0;w<r.length;w+=1)r[w].l(y);o=Ae(y),g&&g.l(y),l=Ae(y),m&&m.l(y),c=Ae(y),x&&x.l(y),y.forEach(E),this.h()},h(){A(e,"class","flex self-center w-[1px] h-4 mx-1.5 bg-gray-50 dark:bg-gray-800"),A(i,"class","flex gap-1 items-center overflow-x-auto scrollbar-none flex-1")},m(p,y){$(p,e,y),$(p,t,y),$(p,i,y),u&&u.m(i,null),K(i,s);for(let w=0;w<r.length;w+=1)r[w]&&r[w].m(i,null);K(i,o),g&&g.m(i,null),K(i,l),m&&m.m(i,null),K(i,c),x&&x.m(i,null),h=!0},p(p,y){p[39]?u?(u.p(p,y),y[1]&256&&U(u,1)):(u=TA(p),u.c(),U(u,1),u.m(i,s)):u&&(bt(),W(u,1,1,()=>{u=null}),xt()),y[0]&16|y[1]&128&&(d=Zn(p[38]),bt(),r=ix(r,y,f,1,p,d,a,i,q5,RA,o,wA),xt()),p[40]?g?(g.p(p,y),y[1]&512&&U(g,1)):(g=MA(p),g.c(),U(g,1),g.m(i,l)):g&&(bt(),W(g,1,1,()=>{g=null}),xt()),p[41]?m?(m.p(p,y),y[1]&1024&&U(m,1)):(m=PA(p),m.c(),U(m,1),m.m(i,c)):m&&(bt(),W(m,1,1,()=>{m=null}),xt()),p[42]?x?(x.p(p,y),y[1]&2048&&U(x,1)):(x=NA(p),x.c(),U(x,1),x.m(i,null)):x&&(bt(),W(x,1,1,()=>{x=null}),xt())},i(p){if(!h){U(u);for(let y=0;y<d.length;y+=1)U(r[y]);U(g),U(m),U(x),h=!0}},o(p){W(u);for(let y=0;y<r.length;y+=1)W(r[y]);W(g),W(m),W(x),h=!1},d(p){p&&(E(e),E(t),E(i)),u&&u.d();for(let y=0;y<r.length;y+=1)r[y].d();g&&g.d(),m&&m.d(),x&&x.d()}}}function TA(n){let e,t;return e=new wi({props:{content:n[44].t("{{COUNT}} Available Tools",{COUNT:n[16].length+n[3].length}),$$slots:{default:[rte]},$$scope:{ctx:n}}}),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p(i,s){const r={};s[0]&65544|s[1]&8192&&(r.content=i[44].t("{{COUNT}} Available Tools",{COUNT:i[16].length+i[3].length})),s[0]&67174408|s[4]&128&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function rte(n){let e,t,i,s,r=n[16].length+n[3].length+"",a,o,l,c;return t=new Jee({props:{className:"size-4",strokeWidth:"1.75"}}),{c(){e=ee("button"),me(t.$$.fragment),i=Ce(),s=ee("span"),a=vt(r),this.h()},l(h){e=te(h,"BUTTON",{class:!0,"aria-label":!0,type:!0});var u=q(e);xe(t.$$.fragment,u),i=Ae(u),s=te(u,"SPAN",{class:!0});var d=q(s);a=kt(d,r),d.forEach(E),u.forEach(E),this.h()},h(){A(s,"class","text-sm font-medium text-gray-600 dark:text-gray-300"),A(e,"class","translate-y-[0.5px] flex gap-1 items-center text-gray-600 dark:text-gray-300 hover:text-gray-700 dark:hover:text-gray-200 rounded-lg p-1 self-center transition"),A(e,"aria-label","Available Tools"),A(e,"type","button")},m(h,u){$(h,e,u),pe(t,e,null),K(e,i),K(e,s),K(s,a),o=!0,l||(c=yt(e,"click",n[103]),l=!0)},p(h,u){(!o||u[0]&65544)&&r!==(r=h[16].length+h[3].length+"")&&Et(a,r)},i(h){o||(U(t.$$.fragment,h),o=!0)},o(h){W(t.$$.fragment,h),o=!1},d(h){h&&E(e),be(t),l=!1,c()}}}function ate(n){let e,t;return e=new xF({props:{className:"size-4",strokeWidth:"1.75"}}),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p:Ct,i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function ote(n){let e,t,i,s,r;return{c(){e=ee("div"),t=ee("img"),this.h()},l(a){e=te(a,"DIV",{class:!0});var o=q(e);t=te(o,"IMG",{src:!0,class:!0,style:!0,alt:!0}),o.forEach(E),this.h()},h(){b0(t.src,i=n[125].icon)||A(t,"src",i),A(t,"class",s="size-3.5 "+(n[125].icon.includes("svg")?"dark:invert-[80%]":"")),nn(t,"fill","currentColor"),A(t,"alt",r=n[125].name),A(e,"class","size-4 items-center flex justify-center")},m(a,o){$(a,e,o),K(e,t)},p(a,o){o[1]&128&&!b0(t.src,i=a[125].icon)&&A(t,"src",i),o[1]&128&&s!==(s="size-3.5 "+(a[125].icon.includes("svg")?"dark:invert-[80%]":""))&&A(t,"class",s),o[1]&128&&r!==(r=a[125].name)&&A(t,"alt",r)},i:Ct,o:Ct,d(a){a&&E(e)}}}function lte(n){var x;let e,t,i,s,r,a=((x=n[125])==null?void 0:x.name)+"",o,l,c,h,u;const d=[ote,ate],f=[];function g(p,y){var w;return(w=p[125])!=null&&w.icon?0:1}t=g(n),i=f[t]=d[t](n);function m(){return n[104](n[125])}return{c(){e=ee("button"),i.c(),s=Ce(),r=ee("span"),o=vt(a),this.h()},l(p){e=te(p,"BUTTON",{type:!0,class:!0});var y=q(e);i.l(y),s=Ae(y),r=te(y,"SPAN",{class:!0});var w=q(r);o=kt(w,a),w.forEach(E),y.forEach(E),this.h()},h(){A(r,"class","hidden @xl:block whitespace-nowrap overflow-hidden text-ellipsis leading-none pr-0.5"),A(e,"type","button"),A(e,"class",l="px-2 @xl:px-2.5 py-2 flex gap-1.5 items-center text-sm rounded-full transition-colors duration-300 focus:outline-hidden max-w-full overflow-hidden hover:bg-gray-50 dark:hover:bg-gray-800 "+(n[4].includes(n[125].id)?"text-sky-500 dark:text-sky-300 bg-sky-50 dark:bg-sky-200/5":"bg-transparent text-gray-600 dark:text-gray-300  ")+" capitalize")},m(p,y){$(p,e,y),f[t].m(e,null),K(e,s),K(e,r),K(r,o),c=!0,h||(u=yt(e,"click",qg(m)),h=!0)},p(p,y){var _;n=p;let w=t;t=g(n),t===w?f[t].p(n,y):(bt(),W(f[w],1,1,()=>{f[w]=null}),xt(),i=f[t],i?i.p(n,y):(i=f[t]=d[t](n),i.c()),U(i,1),i.m(e,s)),(!c||y[1]&128)&&a!==(a=((_=n[125])==null?void 0:_.name)+"")&&Et(o,a),(!c||y[0]&16|y[1]&128&&l!==(l="px-2 @xl:px-2.5 py-2 flex gap-1.5 items-center text-sm rounded-full transition-colors duration-300 focus:outline-hidden max-w-full overflow-hidden hover:bg-gray-50 dark:hover:bg-gray-800 "+(n[4].includes(n[125].id)?"text-sky-500 dark:text-sky-300 bg-sky-50 dark:bg-sky-200/5":"bg-transparent text-gray-600 dark:text-gray-300  ")+" capitalize"))&&A(e,"class",l)},i(p){c||(U(i),c=!0)},o(p){W(i),c=!1},d(p){p&&E(e),f[t].d(),h=!1,u()}}}function RA(n,e){var r;let t,i,s;return i=new wi({props:{content:(r=e[125])==null?void 0:r.description,placement:"top",$$slots:{default:[lte]},$$scope:{ctx:e}}}),{key:n,first:null,c(){t=zt(),me(i.$$.fragment),this.h()},l(a){t=zt(),xe(i.$$.fragment,a),this.h()},h(){this.first=t},m(a,o){$(a,t,o),pe(i,a,o),s=!0},p(a,o){var c;e=a;const l={};o[1]&128&&(l.content=(c=e[125])==null?void 0:c.description),o[0]&16|o[1]&128|o[4]&128&&(l.$$scope={dirty:o,ctx:e}),i.$set(l)},i(a){s||(U(i.$$.fragment,a),s=!0)},o(a){W(i.$$.fragment,a),s=!1},d(a){a&&E(t),be(i,a)}}}function MA(n){let e,t;return e=new wi({props:{content:n[44].t("Search the internet"),placement:"top",$$slots:{default:[cte]},$$scope:{ctx:n}}}),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p(i,s){const r={};s[1]&8192&&(r.content=i[44].t("Search the internet")),s[0]&64|s[1]&12288|s[4]&128&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function cte(n){let e,t,i,s,r=n[44].t("Web Search")+"",a,o,l,c,h;return t=new bF({props:{className:"size-4",strokeWidth:"1.75"}}),{c(){e=ee("button"),me(t.$$.fragment),i=Ce(),s=ee("span"),a=vt(r),this.h()},l(u){e=te(u,"BUTTON",{type:!0,class:!0});var d=q(e);xe(t.$$.fragment,d),i=Ae(d),s=te(d,"SPAN",{class:!0});var f=q(s);a=kt(f,r),f.forEach(E),d.forEach(E),this.h()},h(){var u;A(s,"class","hidden @xl:block whitespace-nowrap overflow-hidden text-ellipsis leading-none pr-0.5"),A(e,"type","button"),A(e,"class",o="px-2 @xl:px-2.5 py-2 flex gap-1.5 items-center text-sm rounded-full transition-colors duration-300 focus:outline-hidden max-w-full overflow-hidden hover:bg-gray-50 dark:hover:bg-gray-800 "+(n[6]||(((u=n[43])==null?void 0:u.webSearch)??!1)==="always"?" text-sky-500 dark:text-sky-300 bg-sky-50 dark:bg-sky-200/5":"bg-transparent text-gray-600 dark:text-gray-300 "))},m(u,d){$(u,e,d),pe(t,e,null),K(e,i),K(e,s),K(s,a),l=!0,c||(h=yt(e,"click",qg(n[105])),c=!0)},p(u,d){var f;(!l||d[1]&8192)&&r!==(r=u[44].t("Web Search")+"")&&Et(a,r),(!l||d[0]&64|d[1]&4096&&o!==(o="px-2 @xl:px-2.5 py-2 flex gap-1.5 items-center text-sm rounded-full transition-colors duration-300 focus:outline-hidden max-w-full overflow-hidden hover:bg-gray-50 dark:hover:bg-gray-800 "+(u[6]||(((f=u[43])==null?void 0:f.webSearch)??!1)==="always"?" text-sky-500 dark:text-sky-300 bg-sky-50 dark:bg-sky-200/5":"bg-transparent text-gray-600 dark:text-gray-300 ")))&&A(e,"class",o)},i(u){l||(U(t.$$.fragment,u),l=!0)},o(u){W(t.$$.fragment,u),l=!1},d(u){u&&E(e),be(t),c=!1,h()}}}function PA(n){let e,t;return e=new wi({props:{content:n[44].t("Generate an image"),placement:"top",$$slots:{default:[hte]},$$scope:{ctx:n}}}),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p(i,s){const r={};s[1]&8192&&(r.content=i[44].t("Generate an image")),s[0]&32|s[1]&8192|s[4]&128&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function hte(n){let e,t,i,s,r=n[44].t("Image")+"",a,o,l,c,h;return t=new Kee({props:{className:"size-4",strokeWidth:"1.75"}}),{c(){e=ee("button"),me(t.$$.fragment),i=Ce(),s=ee("span"),a=vt(r),this.h()},l(u){e=te(u,"BUTTON",{type:!0,class:!0});var d=q(e);xe(t.$$.fragment,d),i=Ae(d),s=te(d,"SPAN",{class:!0});var f=q(s);a=kt(f,r),f.forEach(E),d.forEach(E),this.h()},h(){A(s,"class","hidden @xl:block whitespace-nowrap overflow-hidden text-ellipsis leading-none pr-0.5"),A(e,"type","button"),A(e,"class",o="px-2 @xl:px-2.5 py-2 flex gap-1.5 items-center text-sm rounded-full transition-colors duration-300 focus:outline-hidden max-w-full overflow-hidden hover:bg-gray-50 dark:hover:bg-gray-800 "+(n[5]?" text-sky-500 dark:text-sky-300 bg-sky-50 dark:bg-sky-200/5":"bg-transparent text-gray-600 dark:text-gray-300 "))},m(u,d){$(u,e,d),pe(t,e,null),K(e,i),K(e,s),K(s,a),l=!0,c||(h=yt(e,"click",qg(n[106])),c=!0)},p(u,d){(!l||d[1]&8192)&&r!==(r=u[44].t("Image")+"")&&Et(a,r),(!l||d[0]&32&&o!==(o="px-2 @xl:px-2.5 py-2 flex gap-1.5 items-center text-sm rounded-full transition-colors duration-300 focus:outline-hidden max-w-full overflow-hidden hover:bg-gray-50 dark:hover:bg-gray-800 "+(u[5]?" text-sky-500 dark:text-sky-300 bg-sky-50 dark:bg-sky-200/5":"bg-transparent text-gray-600 dark:text-gray-300 ")))&&A(e,"class",o)},i(u){l||(U(t.$$.fragment,u),l=!0)},o(u){W(t.$$.fragment,u),l=!1},d(u){u&&E(e),be(t),c=!1,h()}}}function NA(n){let e,t;return e=new wi({props:{content:n[44].t("Execute code for analysis"),placement:"top",$$slots:{default:[ute]},$$scope:{ctx:n}}}),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p(i,s){const r={};s[1]&8192&&(r.content=i[44].t("Execute code for analysis")),s[0]&128|s[1]&12288|s[4]&128&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function ute(n){let e,t,i,s,r=n[44].t("Code Interpreter")+"",a,o,l,c,h,u;return t=new cD({props:{className:"size-4",strokeWidth:"1.75"}}),{c(){e=ee("button"),me(t.$$.fragment),i=Ce(),s=ee("span"),a=vt(r),this.h()},l(d){e=te(d,"BUTTON",{"aria-label":!0,"aria-pressed":!0,type:!0,class:!0});var f=q(e);xe(t.$$.fragment,f),i=Ae(f),s=te(f,"SPAN",{class:!0});var g=q(s);a=kt(g,r),g.forEach(E),f.forEach(E),this.h()},h(){var d;A(s,"class","hidden @xl:block whitespace-nowrap overflow-hidden text-ellipsis leading-none pr-0.5"),A(e,"aria-label",o=n[7]?n[44].t("Disable Code Interpreter"):n[44].t("Enable Code Interpreter")),A(e,"aria-pressed",n[7]),A(e,"type","button"),A(e,"class",l="px-2 @xl:px-2.5 py-2 flex gap-1.5 items-center text-sm transition-colors duration-300 max-w-full overflow-hidden hover:bg-gray-50 dark:hover:bg-gray-800 "+(n[7]?" text-sky-500 dark:text-sky-300 bg-sky-50 dark:bg-sky-200/5":"bg-transparent text-gray-600 dark:text-gray-300 ")+" "+(((d=n[43])==null?void 0:d.highContrastMode)??!1?"m-1":"focus:outline-hidden rounded-full"))},m(d,f){$(d,e,f),pe(t,e,null),K(e,i),K(e,s),K(s,a),c=!0,h||(u=yt(e,"click",qg(n[107])),h=!0)},p(d,f){var g;(!c||f[1]&8192)&&r!==(r=d[44].t("Code Interpreter")+"")&&Et(a,r),(!c||f[0]&128|f[1]&8192&&o!==(o=d[7]?d[44].t("Disable Code Interpreter"):d[44].t("Enable Code Interpreter")))&&A(e,"aria-label",o),(!c||f[0]&128)&&A(e,"aria-pressed",d[7]),(!c||f[0]&128|f[1]&4096&&l!==(l="px-2 @xl:px-2.5 py-2 flex gap-1.5 items-center text-sm transition-colors duration-300 max-w-full overflow-hidden hover:bg-gray-50 dark:hover:bg-gray-800 "+(d[7]?" text-sky-500 dark:text-sky-300 bg-sky-50 dark:bg-sky-200/5":"bg-transparent text-gray-600 dark:text-gray-300 ")+" "+(((g=d[43])==null?void 0:g.highContrastMode)??!1?"m-1":"focus:outline-hidden rounded-full")))&&A(e,"class",l)},i(d){c||(U(t.$$.fragment,d),c=!0)},o(d){W(t.$$.fragment,d),c=!1},d(d){d&&E(e),be(t),h=!1,u()}}}function OA(n){let e,t;return e=new wi({props:{content:n[44].t("Dictate"),$$slots:{default:[dte]},$$scope:{ctx:n}}}),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p(i,s){const r={};s[1]&8192&&(r.content=i[44].t("Dictate")),s[0]&268435456|s[1]&8192|s[4]&128&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function dte(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5 translate-y-[0.5px]"><path d="M7 4a3 3 0 016 0v6a3 3 0 11-6 0V4z"></path><path d="M5.5 9.643a.75.75 0 00-1.5 0V10c0 3.06 2.29 5.585 5.25 5.954V17.5h-1.5a.75.75 0 000 1.5h4.5a.75.75 0 000-1.5h-1.5v-1.546A6.001 6.001 0 0016 10v-.357a.75.75 0 00-1.5 0V10a4.5 4.5 0 01-9 0v-.357z"></path></svg>',i,s;return{c(){e=ee("button"),e.innerHTML=t,this.h()},l(r){e=te(r,"BUTTON",{id:!0,class:!0,type:!0,"aria-label":!0,"data-svelte-h":!0}),ko(e)!=="svelte-4nqm9k"&&(e.innerHTML=t),this.h()},h(){A(e,"id","voice-input-button"),A(e,"class","text-gray-600 dark:text-gray-300 hover:text-gray-700 dark:hover:text-gray-200 transition rounded-full p-1.5 mr-0.5 self-center"),A(e,"type","button"),A(e,"aria-label","Voice Input")},m(r,a){$(r,e,a),i||(s=yt(e,"click",n[108]),i=!0)},p:Ct,d(r){r&&E(e),i=!1,s()}}}function fte(n){let e,t,i;return t=new wi({props:{content:n[44].t("Send message"),$$slots:{default:[pte]},$$scope:{ctx:n}}}),{c(){e=ee("div"),me(t.$$.fragment),this.h()},l(s){e=te(s,"DIV",{class:!0});var r=q(e);xe(t.$$.fragment,r),r.forEach(E),this.h()},h(){A(e,"class","flex items-center")},m(s,r){$(s,e,r),pe(t,e,null),i=!0},p(s,r){const a={};r[1]&8192&&(a.content=s[44].t("Send message")),r[0]&6|r[4]&128&&(a.$$scope={dirty:r,ctx:s}),t.$set(a)},i(s){i||(U(t.$$.fragment,s),i=!0)},o(s){W(t.$$.fragment,s),i=!1},d(s){s&&E(e),be(t)}}}function gte(n){let e,t,i;return t=new wi({props:{content:n[44].t("Voice mode"),$$slots:{default:[bte]},$$scope:{ctx:n}}}),{c(){e=ee("div"),me(t.$$.fragment),this.h()},l(s){e=te(s,"DIV",{class:!0});var r=q(e);xe(t.$$.fragment,r),r.forEach(E),this.h()},h(){A(e,"class","flex items-center")},m(s,r){$(s,e,r),pe(t,e,null),i=!0},p(s,r){const a={};r[1]&8192&&(a.content=s[44].t("Voice mode")),r[0]&532480|r[1]&45056|r[4]&128&&(a.$$scope={dirty:r,ctx:s}),t.$set(a)},i(s){i||(U(t.$$.fragment,s),i=!0)},o(s){W(t.$$.fragment,s),i=!1},d(s){s&&E(e),be(t)}}}function mte(n){let e,t,i;return t=new wi({props:{content:n[44].t("Stop"),$$slots:{default:[xte]},$$scope:{ctx:n}}}),{c(){e=ee("div"),me(t.$$.fragment),this.h()},l(s){e=te(s,"DIV",{class:!0});var r=q(e);xe(t.$$.fragment,r),r.forEach(E),this.h()},h(){A(e,"class","flex items-center")},m(s,r){$(s,e,r),pe(t,e,null),i=!0},p(s,r){const a={};r[1]&8192&&(a.content=s[44].t("Stop")),r[0]&4096|r[4]&128&&(a.$$scope={dirty:r,ctx:s}),t.$set(a)},i(s){i||(U(t.$$.fragment,s),i=!0)},o(s){W(t.$$.fragment,s),i=!1},d(s){s&&E(e),be(t)}}}function pte(n){let e,t,i,s,r;return{c(){e=ee("button"),t=at("svg"),i=at("path"),this.h()},l(a){e=te(a,"BUTTON",{id:!0,class:!0,type:!0});var o=q(e);t=ot(o,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var l=q(t);i=ot(l,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),q(i).forEach(E),l.forEach(E),o.forEach(E),this.h()},h(){A(i,"fill-rule","evenodd"),A(i,"d","M8 14a.75.75 0 0 1-.75-.75V4.56L4.03 7.78a.75.75 0 0 1-1.06-1.06l4.5-4.5a.75.75 0 0 1 1.06 0l4.5 4.5a.75.75 0 0 1-1.06 1.06L8.75 4.56v8.69A.75.75 0 0 1 8 14Z"),A(i,"clip-rule","evenodd"),A(t,"xmlns","http://www.w3.org/2000/svg"),A(t,"viewBox","0 0 16 16"),A(t,"fill","currentColor"),A(t,"class","size-5"),A(e,"id","send-message-button"),A(e,"class",s=(n[1]===""&&n[2].length===0?"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled":"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ")+" transition rounded-full p-1.5 self-center"),A(e,"type","submit"),e.disabled=r=n[1]===""&&n[2].length===0},m(a,o){$(a,e,o),K(e,t),K(t,i)},p(a,o){o[0]&6&&s!==(s=(a[1]===""&&a[2].length===0?"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled":"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ")+" transition rounded-full p-1.5 self-center")&&A(e,"class",s),o[0]&6&&r!==(r=a[1]===""&&a[2].length===0)&&(e.disabled=r)},d(a){a&&E(e)}}}function bte(n){let e,t,i,s,r,a;return t=new Vee({props:{className:"size-5"}}),{c(){e=ee("button"),me(t.$$.fragment),this.h()},l(o){e=te(o,"BUTTON",{class:!0,type:!0,"aria-label":!0});var l=q(e);xe(t.$$.fragment,l),l.forEach(E),this.h()},h(){A(e,"class","bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full p-1.5 self-center"),A(e,"type","button"),A(e,"aria-label",i=n[44].t("Voice mode"))},m(o,l){$(o,e,l),pe(t,e,null),s=!0,r||(a=yt(e,"click",n[110]),r=!0)},p(o,l){(!s||l[1]&8192&&i!==(i=o[44].t("Voice mode")))&&A(e,"aria-label",i)},i(o){s||(U(t.$$.fragment,o),s=!0)},o(o){W(t.$$.fragment,o),s=!1},d(o){o&&E(e),be(t),r=!1,a()}}}function xte(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-5"><path fill-rule="evenodd" d="M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm6-2.438c0-.724.588-1.312 1.313-1.312h4.874c.725 0 1.313.588 1.313 1.313v4.874c0 .725-.588 1.313-1.313 1.313H9.564a1.312 1.312 0 01-1.313-1.313V9.564z" clip-rule="evenodd"></path></svg>',i,s;return{c(){e=ee("button"),e.innerHTML=t,this.h()},l(r){e=te(r,"BUTTON",{class:!0,"data-svelte-h":!0}),ko(e)!=="svelte-nqxd5x"&&(e.innerHTML=t),this.h()},h(){A(e,"class","bg-white hover:bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-800 transition rounded-full p-1.5")},m(r,a){$(r,e,a),i||(s=yt(e,"click",n[109]),i=!0)},p:Ct,d(r){r&&E(e),i=!1,s()}}}function yte(n){let e;return{c(){e=ee("div"),this.h()},l(t){e=te(t,"DIV",{class:!0}),q(e).forEach(E),this.h()},h(){A(e,"class","mb-1")},m(t,i){$(t,e,i)},p:Ct,d(t){t&&E(e)}}}function wte(n){var s,r;let e,t,i=g3.sanitize(Sg((r=(s=n[19])==null?void 0:s.license_metadata)==null?void 0:r.input_footer))+"";return{c(){e=ee("div"),t=new Q6(!1),this.h()},l(a){e=te(a,"DIV",{class:!0});var o=q(e);t=$6(o,!1),o.forEach(E),this.h()},h(){t.a=null,A(e,"class","text-xs text-gray-500 text-center line-clamp-1 marked")},m(a,o){$(a,e,o),t.m(i,e)},p(a,o){var l,c;o[0]&524288&&i!==(i=g3.sanitize(Sg((c=(l=a[19])==null?void 0:l.license_metadata)==null?void 0:c.input_footer))+"")&&t.p(i)},d(a){a&&E(e)}}}function _te(n){let e,t,i,s,r,a,o,l,c,h;e=new mF({props:{show:n[34]}});function u(x){n[61](x)}let d={selectedToolIds:n[3]};n[26]!==void 0&&(d.show=n[26]),i=new zee({props:d}),It.push(()=>Wt(i,"show",u));function f(x){n[63](x)}let g={variables:n[24],onSave:n[62]};n[23]!==void 0&&(g.show=n[23]),a=new bD({props:g}),It.push(()=>Wt(a,"show",f));let m=n[27]&&vA(n);return{c(){me(e.$$.fragment),t=Ce(),me(i.$$.fragment),r=Ce(),me(a.$$.fragment),l=Ce(),m&&m.c(),c=zt()},l(x){xe(e.$$.fragment,x),t=Ae(x),xe(i.$$.fragment,x),r=Ae(x),xe(a.$$.fragment,x),l=Ae(x),m&&m.l(x),c=zt()},m(x,p){pe(e,x,p),$(x,t,p),pe(i,x,p),$(x,r,p),pe(a,x,p),$(x,l,p),m&&m.m(x,p),$(x,c,p),h=!0},p(x,p){const y={};p[1]&8&&(y.show=x[34]),e.$set(y);const w={};p[0]&8&&(w.selectedToolIds=x[3]),!s&&p[0]&67108864&&(s=!0,w.show=x[26],qt(()=>s=!1)),i.$set(w);const _={};p[0]&16777216&&(_.variables=x[24]),p[0]&33554432&&(_.onSave=x[62]),!o&&p[0]&8388608&&(o=!0,_.show=x[23],qt(()=>o=!1)),a.$set(_),x[27]?m?(m.p(x,p),p[0]&134217728&&U(m,1)):(m=vA(x),m.c(),U(m,1),m.m(c.parentNode,c)):m&&(bt(),W(m,1,1,()=>{m=null}),xt())},i(x){h||(U(e.$$.fragment,x),U(i.$$.fragment,x),U(a.$$.fragment,x),U(m),h=!0)},o(x){W(e.$$.fragment,x),W(i.$$.fragment,x),W(a.$$.fragment,x),W(m),h=!1},d(x){x&&(E(t),E(r),E(l),E(c)),be(e,x),be(i,x),be(a,x),m&&m.d(x)}}}function vte(n,e,t){let i,s,r,a,o,l,c,h;Pe(n,Kg,Z=>t(19,i=Z)),Pe(n,Ga,Z=>t(43,s=Z)),Pe(n,Fd,Z=>t(113,a=Z)),Pe(n,k0,Z=>t(20,o=Z)),Pe(n,Xg,Z=>t(21,l=Z)),Pe(n,nx,Z=>t(45,c=Z)),Pe(n,Qw,Z=>t(46,h=Z)),Wl.workerSrc=import.meta.url+"pdfjs-dist/build/pdf.worker.mjs";const u=Xa(),d=as("i18n");Pe(n,d,Z=>t(44,r=Z));let{transparentBackground:f=!1}=e,{onChange:g=()=>{}}=e,{createMessagePair:m}=e,{stopResponse:x}=e,{autoScroll:p=!1}=e,{atSelectedModel:y=void 0}=e,{selectedModels:w}=e,_=[],{history:v}=e,{taskIds:C=null}=e,{prompt:k=""}=e,{files:I=[]}=e,{toolServers:S=[]}=e,{selectedToolIds:M=[]}=e,{selectedFilterIds:N=[]}=e,{imageGenerationEnabled:F=!1}=e,{webSearchEnabled:H=!1}=e,{codeInterpreterEnabled:T=!1}=e,z=!1,R={},L={};const Y=async Z=>{t(24,R=LD(Z)),Object.keys(R).length>0&&t(23,z=!0)},j=async Z=>{if(Z.includes("{{CLIPBOARD}}")){const Xe=await navigator.clipboard.readText().catch(tt=>(Jt.error(r.t("Failed to read clipboard contents")),"{{CLIPBOARD}}")),wt=await navigator.clipboard.read();let _t=null;for(const tt of wt)for(const Rt of tt.types)if(Rt.startsWith("image/")){const ni=await tt.getType(Rt);_t=URL.createObjectURL(ni)}_t&&t(2,I=[...I,{type:"image",url:_t}]),Z=Z.replaceAll("{{CLIPBOARD}}",Xe)}if(Z.includes("{{USER_LOCATION}}")){let Xe;try{Xe=await RD()}catch{Jt.error(r.t("Location access not allowed")),Xe="LOCATION_UNKNOWN"}Z=Z.replaceAll("{{USER_LOCATION}}",String(Xe))}if(Z.includes("{{USER_NAME}}")){const Xe=(o==null?void 0:o.name)||"User";Z=Z.replaceAll("{{USER_NAME}}",Xe)}if(Z.includes("{{USER_LANGUAGE}}")){const Xe=localStorage.getItem("locale")||"en-US";Z=Z.replaceAll("{{USER_LANGUAGE}}",Xe)}if(Z.includes("{{CURRENT_DATE}}")){const Xe=MD();Z=Z.replaceAll("{{CURRENT_DATE}}",Xe)}if(Z.includes("{{CURRENT_TIME}}")){const Xe=PD();Z=Z.replaceAll("{{CURRENT_TIME}}",Xe)}if(Z.includes("{{CURRENT_DATETIME}}")){const Xe=ND();Z=Z.replaceAll("{{CURRENT_DATETIME}}",Xe)}if(Z.includes("{{CURRENT_TIMEZONE}}")){const Xe=OD();Z=Z.replaceAll("{{CURRENT_TIMEZONE}}",Xe)}if(Z.includes("{{CURRENT_WEEKDAY}}")){const Xe=DD();Z=Z.replaceAll("{{CURRENT_WEEKDAY}}",Xe)}return Y(Z),Z},J=Z=>{const Xe=document.getElementById("chat-input");if(Xe)if((s==null?void 0:s.richTextInput)??!0)ue.replaceVariables(Z),ue.focus();else{const _t=(Xe.value||"").replace(/{{\s*([^|}]+)(?:\|[^}]*)?\s*}}/g,(tt,Rt)=>{const ni=Rt.trim();return Z.hasOwnProperty(ni)?String(Z[ni]):tt});Xe.value=_t,Xe.focus(),Xe.dispatchEvent(new Event("input",{bubbles:!0}))}},G=async Z=>{const Xe=document.getElementById("chat-input");Xe&&(Z=await j(Z||""),(s==null?void 0:s.richTextInput)??!0?(ue==null||ue.setText(Z),ue==null||ue.focus()):(Xe.value=Z,t(1,k=Z),Xe.focus(),Xe.dispatchEvent(new Event("input"))))},se=()=>{const Z=(_t,tt)=>{var Ee,it;if(typeof _t!="string"||tt==null)return"";const Rt=_t.slice(0,tt),ni=_t.slice(tt),ne=((Ee=Rt.match(/(?:^|\s)([^\s]*)$/))==null?void 0:Ee[1])||"",Re=((it=ni.match(/^([^\s]*)/))==null?void 0:it[1])||"";return ne+Re},Xe=document.getElementById("chat-input");let wt="";if(Xe)if((s==null?void 0:s.richTextInput)??!0)wt=ue==null?void 0:ue.getWordAtDocPos();else{const _t=Xe?Xe.selectionStart:k.length;wt=Z(k,_t)}return wt},de=Z=>{const Xe=(_t,tt)=>{let Rt=tt,ni=tt;for(;Rt>0&&!/\s/.test(_t[Rt-1]);)--Rt;for(;ni<_t.length&&!/\s/.test(_t[ni]);)++ni;return{start:Rt,end:ni}},wt=document.getElementById("chat-input");if(wt)if((s==null?void 0:s.richTextInput)??!0)ue==null||ue.replaceCommandWithText(Z);else{const _t=wt.selectionStart,{start:tt,end:Rt}=Xe(k,_t);t(1,k=k.slice(0,tt)+Z+k.slice(Rt)),wt.focus(),wt.setSelectionRange(tt+Z.length,tt+Z.length)}},he=async Z=>{const Xe=document.getElementById("chat-input");if(!Xe)return;if(Z=await j(Z),we)de(Z);else if((s==null?void 0:s.richTextInput)??!0)ue==null||ue.insertContent(Z);else{const _t=Xe.selectionStart;t(1,k=k.slice(0,_t)+Z+k.slice(_t)),Xe.focus(),Xe.setSelectionRange(_t+Z.length,_t+Z.length)}await hn();const wt=document.getElementById("chat-input-container");if(wt&&(wt.scrollTop=wt.scrollHeight),await hn(),Xe){Xe.focus(),Xe.dispatchEvent(new Event("input"));const _t=uv(k);if(_t.length>0){const tt=_t.at(0);if(await hn(),!((s==null?void 0:s.richTextInput)??!0)){Xe.setSelectionRange(tt.startIndex,tt.endIndex+1),Xe.focus();const Rt=((tt==null?void 0:tt.startIndex)-(tt==null?void 0:tt.startIndex)%Xe.cols)/Xe.cols,ni=Xe.clientHeight/Xe.rows;Xe.scrollTop=ni*Rt}}else Xe.scrollTop=Xe.scrollHeight}};let we="",{showCommands:ye=!1}=e,P=!1,V=!1,re=!1,X=!1,ue,oe,Q,ae,Ke=!1,Ue=!1,{placeholder:De=""}=e,je=[],ze=[],Qe=[],ft=[],ut=[],Je=[],rt=!1,ge=!1,Pt=!1,lt=!1;const ct=()=>{const Z=document.getElementById("messages-container");Z.scrollTo({top:Z.scrollHeight,behavior:"smooth"})},Ge=async()=>{try{const Z=await navigator.mediaDevices.getDisplayMedia({video:{cursor:"never"},audio:!1}),Xe=document.createElement("video");Xe.srcObject=Z,await Xe.play();const wt=document.createElement("canvas");wt.width=Xe.videoWidth,wt.height=Xe.videoHeight,wt.getContext("2d").drawImage(Xe,0,0,wt.width,wt.height),Z.getTracks().forEach(Rt=>Rt.stop()),window.focus();const tt=wt.toDataURL("image/png");t(2,I=[...I,{type:"image",url:tt}]),Xe.srcObject=null}catch(Z){console.error("Error capturing screen:",Z)}},Ft=async(Z,Xe=!1)=>{var tt,Rt,ni,ne,Re,Ee,it,We;if((o==null?void 0:o.role)!=="admin"&&!(((Rt=(tt=o==null?void 0:o.permissions)==null?void 0:tt.chat)==null?void 0:Rt.file_upload)??!0))return Jt.error(r.t("You do not have permission to upload files.")),null;if(ze.length!==w.length)return Jt.error(r.t("Model(s) do not support file upload")),null;const wt=Cl(),_t={type:"file",file:"",id:null,url:"",name:Z.name,collection_name:"",status:"uploading",size:Z.size,error:"",itemId:wt,...Xe?{context:"full"}:{}};if(_t.size==0)return Jt.error(r.t("You cannot upload an empty file.")),null;if(t(2,I=[...I,_t]),a){const Le=await TD(Z,pdfjsLib).catch(Ye=>(Jt.error(r.t("Failed to extract content from the file: {{error}}",{error:Ye})),null));if(Le===null)return Jt.error(r.t("Failed to extract content from the file.")),t(2,I=I.filter(Ye=>(Ye==null?void 0:Ye.itemId)!==wt)),null;Z.name,Z.size,_t.status="uploaded",_t.type="text",_t.content=Le,_t.id=Cl(),t(2,I)}else try{let Le=null;(Z.type.startsWith("audio/")||Z.type.startsWith("video/"))&&((ne=(ni=s==null?void 0:s.audio)==null?void 0:ni.stt)!=null&&ne.language)&&(Le={language:(Ee=(Re=s==null?void 0:s.audio)==null?void 0:Re.stt)==null?void 0:Ee.language});const Ye=await cF(localStorage.token,Z,Le);Ye?(Ye.id,_t.name,(it=Ye==null?void 0:Ye.meta)==null||it.collection_name,Ye.error&&(console.warn("File upload warning:",Ye.error),Jt.warning(Ye.error)),_t.status="uploaded",_t.file=Ye,_t.id=Ye.id,_t.collection_name=((We=Ye==null?void 0:Ye.meta)==null?void 0:We.collection_name)||(Ye==null?void 0:Ye.collection_name),_t.url=`${vD}/files/${Ye.id}`,t(2,I)):t(2,I=I.filter(At=>(At==null?void 0:At.itemId)!==wt))}catch(Le){Jt.error(`${Le}`),t(2,I=I.filter(Ye=>(Ye==null?void 0:Ye.itemId)!==wt))}},sn=async Z=>{var Xe,wt,_t;if((((Xe=i==null?void 0:i.file)==null?void 0:Xe.max_count)??null)!==null&&I.length+Z.length>((wt=i==null?void 0:i.file)==null?void 0:wt.max_count)){Jt.error(r.t("You can only chat with a maximum of {{maxCount}} file(s) at a time.",{maxCount:(_t=i==null?void 0:i.file)==null?void 0:_t.max_count}));return}Z.forEach(async tt=>{var Rt,ni,ne,Re;if(tt.name,tt.type,tt.size,tt.name.split(".").at(-1),(((Rt=i==null?void 0:i.file)==null?void 0:Rt.max_size)??null)!==null&&tt.size>(((ni=i==null?void 0:i.file)==null?void 0:ni.max_size)??0)*1024*1024){tt.size,(((ne=i==null?void 0:i.file)==null?void 0:ne.max_size)??0)*1024*1024,Jt.error(r.t("File size should not exceed {{maxSize}} MB.",{maxSize:(Re=i==null?void 0:i.file)==null?void 0:Re.max_size}));return}if(tt.type.startsWith("image/")){if(je.length===0){Jt.error(r.t("Selected model(s) do not support image inputs"));return}const Ee=async(We,Le={},Ye={})=>{var ii,Ai,mr,cs,Ao,fl;const At=(Le==null?void 0:Le.imageCompression)??!1,Mt=((Ai=(ii=Ye==null?void 0:Ye.file)==null?void 0:ii.image_compression)==null?void 0:Ai.width)??null,En=((cs=(mr=Ye==null?void 0:Ye.file)==null?void 0:mr.image_compression)==null?void 0:cs.height)??null;if(!At&&!Mt&&!En)return We;let xn=null,cn=null;return At&&(xn=((Ao=Le==null?void 0:Le.imageCompressionSize)==null?void 0:Ao.width)??null,cn=((fl=Le==null?void 0:Le.imageCompressionSize)==null?void 0:fl.height)??null),Mt&&(xn===null||xn>Mt)&&(xn=Mt),En&&(cn===null||cn>En)&&(cn=En),xn||cn?await FD(We,xn,cn):We};let it=new FileReader;it.onload=async We=>{let Le=We.target.result;Le=await Ee(Le,s,i),t(2,I=[...I,{type:"image",url:`${Le}`}])},it.readAsDataURL(tt.type==="image/heic"?await yD({blob:tt,toType:"image/jpeg"}):tt)}else Ft(tt)})},Me=Z=>{var Xe,wt;Z.preventDefault(),(wt=(Xe=Z.dataTransfer)==null?void 0:Xe.types)!=null&&wt.includes("Files")?t(34,Ke=!0):t(34,Ke=!1)},Lt=()=>{t(34,Ke=!1)},dt=async Z=>{var Xe,wt;if(Z.preventDefault(),(Xe=Z.dataTransfer)!=null&&Xe.files){const _t=Array.from((wt=Z.dataTransfer)==null?void 0:wt.files);_t&&_t.length>0&&sn(_t)}t(34,Ke=!1)},Vt=Z=>{Z.key==="Shift"&&t(35,Ue=!0),Z.key==="Escape"&&t(34,Ke=!1)},Ln=Z=>{Z.key==="Shift"&&t(35,Ue=!1)},Wn=()=>{},hi=()=>{t(35,Ue=!1)};ol(async()=>{t(27,V=!0),window.setTimeout(()=>{const Xe=document.getElementById("chat-input");Xe==null||Xe.focus()},0),window.addEventListener("keydown",Vt),window.addEventListener("keyup",Ln),window.addEventListener("focus",Wn),window.addEventListener("blur",hi),await hn();const Z=document.getElementById("chat-container");Z==null||Z.addEventListener("dragover",Me),Z==null||Z.addEventListener("drop",dt),Z==null||Z.addEventListener("dragleave",Lt)}),Kh(()=>{window.removeEventListener("keydown",Vt),window.removeEventListener("keyup",Ln),window.removeEventListener("focus",Wn),window.removeEventListener("blur",hi);const Z=document.getElementById("chat-container");Z&&(Z==null||Z.removeEventListener("dragover",Me),Z==null||Z.removeEventListener("drop",dt),Z==null||Z.removeEventListener("dragleave",Lt))});function Gi(Z){P=Z,t(26,P)}const ws=Z=>{t(25,L={...L,...Z}),J(L)};function ui(Z){z=Z,t(23,z)}const Wi=()=>{t(8,p=!0),ct()},_s=Z=>Z.id===y.id,Ci=()=>{t(0,y=void 0)},Rr=Z=>{const{type:Xe,data:wt}=Z;if(Xe==="file"){if(I.find(_t=>_t.id===wt.id))return;t(2,I=[...I,{...wt,status:"processed"}])}else u("upload",Z)},Xs=Z=>{var _t;const{type:Xe,data:wt}=Z;Xe==="model"&&t(0,y=wt),(_t=document.getElementById("chat-input"))==null||_t.focus()};function Es(Z){It[Z?"unshift":"push"](()=>{Q=Z,t(32,Q)})}function Ne(Z){I=Z,t(2,I)}function Ve(Z){It[Z?"unshift":"push"](()=>{oe=Z,t(31,oe)})}function ht(){ae=this.files,t(33,ae)}const Xt=async()=>{if(ae&&ae.length>0){const Z=Array.from(ae);sn(Z)}else Jt.error(r.t("File not found."));t(31,oe.value="",oe)},an=async()=>{var Z;t(28,re=!1),await hn(),(Z=document.getElementById("chat-input"))==null||Z.focus()},Bn=async Z=>{var _t;const{text:Xe,filename:wt}=Z;t(28,re=!1),await hn(),he(Xe),await hn(),(_t=document.getElementById("chat-input"))==null||_t.focus(),((s==null?void 0:s.speechAutoSend)??!1)&&u("submit",k)};function Cn(Z){re=Z,t(28,re)}const Un=Z=>!je.includes(Z),zn=Z=>{I.splice(Z,1),t(2,I)},dl=async Z=>{I.splice(Z,1),t(2,I)},gr=Z=>{},tm=Z=>{t(1,k=Z.md),t(18,we=se())},nm=async Z=>{(_.length===0||!_.at(0))&&Jt.error(r.t("Please select a model first."));const Xe=await QD(localStorage.token,_.at(0),Z,v!=null&&v.currentId?Da(v,v.currentId):null).catch(wt=>null);return Xe},im=()=>t(29,X=!0),sm=()=>t(29,X=!1);function rm(Z){It[Z?"unshift":"push"](()=>{ue=Z,t(30,ue)})}const am=async Z=>{var _t;Z=Z.detail.event;const Xe=Z.ctrlKey||Z.metaKey,wt=document.getElementById("commands-container");if(Z.key==="Escape"&&x(),Xe&&Z.key==="Enter"&&Z.shiftKey&&(Z.preventDefault(),m(k)),k===""&&Xe&&Z.key.toLowerCase()==="r"){Z.preventDefault();const tt=[...document.getElementsByClassName("regenerate-response-button")].at(-1);tt==null||tt.click()}if(k===""&&Z.key=="ArrowUp"){Z.preventDefault();const tt=[...document.getElementsByClassName("user-message")].at(-1);if(tt){tt.scrollIntoView({block:"center"});const Rt=[...document.getElementsByClassName("edit-user-message-button")].at(-1);Rt==null||Rt.click()}}if(wt){if(wt&&Z.key==="ArrowUp"&&(Z.preventDefault(),Q.selectUp(),[...document.getElementsByClassName("selected-command-option-button")].at(-1).scrollIntoView({block:"center"})),wt&&Z.key==="ArrowDown"&&(Z.preventDefault(),Q.selectDown(),[...document.getElementsByClassName("selected-command-option-button")].at(-1).scrollIntoView({block:"center"})),wt&&Z.key==="Tab"){Z.preventDefault();const tt=[...document.getElementsByClassName("selected-command-option-button")].at(-1);tt==null||tt.click()}if(wt&&Z.key==="Enter"){Z.preventDefault();const tt=[...document.getElementsByClassName("selected-command-option-button")].at(-1);tt?tt==null||tt.click():(_t=document.getElementById("send-message-button"))==null||_t.click()}}else if(!c||!("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0)){if(X)return;((s==null?void 0:s.ctrlEnterToSend)??!1?(Z.key==="Enter"||Z.keyCode===13)&&Xe:(Z.key==="Enter"||Z.keyCode===13)&&!Z.shiftKey)&&(Z.preventDefault(),(k!==""||I.length>0)&&u("submit",k))}Z.key==="Escape"&&(t(0,y=void 0),t(3,M=[]),t(4,N=[]),t(6,H=!1),t(5,F=!1),t(7,T=!1))},om=async Z=>{Z=Z.detail.event;const Xe=Z.clipboardData||window.clipboardData;if(Xe&&Xe.items){for(const wt of Xe.items)if(wt.type.indexOf("image")!==-1){const _t=wt.getAsFile(),tt=new FileReader;tt.onload=function(Rt){t(2,I=[...I,{type:"image",url:`${Rt.target.result}`}])},tt.readAsDataURL(_t)}else if((wt==null?void 0:wt.kind)==="file"){const _t=wt.getAsFile();_t&&(await sn([_t]),Z.preventDefault())}else if(wt.type==="text/plain"&&((s==null?void 0:s.largeTextAsFile)??!1)&&!Ue){const _t=Xe.getData("text/plain");if(_t.length>cv){Z.preventDefault();const tt=new Blob([_t],{type:"text/plain"}),Rt=new File([tt],`Pasted_Text_${Date.now()}.txt`,{type:"text/plain"});await Ft(Rt,!0)}}}};function lm(Z){It[Z?"unshift":"push"](()=>{ue=Z,t(30,ue)})}function cm(){k=this.value,t(1,k)}const hm=()=>{t(18,we=se())},um=()=>{t(18,we=se())},dm=()=>t(29,X=!0),fm=()=>t(29,X=!1),gm=async Z=>{var _t;const Xe=Z.ctrlKey||Z.metaKey,wt=document.getElementById("commands-container");if(Z.key==="Escape"&&x(),Xe&&Z.key==="Enter"&&Z.shiftKey&&(Z.preventDefault(),m(k)),k===""&&Xe&&Z.key.toLowerCase()==="r"){Z.preventDefault();const tt=[...document.getElementsByClassName("regenerate-response-button")].at(-1);tt==null||tt.click()}if(k===""&&Z.key=="ArrowUp"){Z.preventDefault();const tt=[...document.getElementsByClassName("user-message")].at(-1),Rt=[...document.getElementsByClassName("edit-user-message-button")].at(-1);tt==null||tt.scrollIntoView({block:"center"}),Rt==null||Rt.click()}if(wt){if(wt&&Z.key==="ArrowUp"){Z.preventDefault(),Q.selectUp();const tt=document.getElementById("command-options-container"),Rt=[...document.getElementsByClassName("selected-command-option-button")].at(-1);if(Rt&&tt){const ni=Rt.offsetTop,ne=Rt.offsetHeight,Re=tt.clientHeight;tt.scrollTop=ni-Re/2+ne/2}}if(wt&&Z.key==="ArrowDown"){Z.preventDefault(),Q.selectDown();const tt=document.getElementById("command-options-container"),Rt=[...document.getElementsByClassName("selected-command-option-button")].at(-1);if(Rt&&tt){const ni=Rt.offsetTop,ne=Rt.offsetHeight,Re=tt.clientHeight;tt.scrollTop=ni-Re/2+ne/2}}if(wt&&Z.key==="Enter"){Z.preventDefault();const tt=[...document.getElementsByClassName("selected-command-option-button")].at(-1);Z.shiftKey?t(1,k=`${k}
`):tt?tt==null||tt.click():(_t=document.getElementById("send-message-button"))==null||_t.click()}if(wt&&Z.key==="Tab"){Z.preventDefault();const tt=[...document.getElementsByClassName("selected-command-option-button")].at(-1);tt==null||tt.click()}}else if(!c||!("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0)){if(X)return;const tt=Z.ctrlKey||Z.metaKey,Rt=(s==null?void 0:s.ctrlEnterToSend)??!1?(Z.key==="Enter"||Z.keyCode===13)&&tt:(Z.key==="Enter"||Z.keyCode===13)&&!Z.shiftKey;Rt&&Z.preventDefault(),(k!==""||I.length>0)&&Rt&&u("submit",k)}if(Z.key==="Tab"){const tt=uv(k);if(tt.length>0){const Rt=tt.at(0);if(Rt&&Z.target instanceof HTMLTextAreaElement){Z.preventDefault(),Z.target.setSelectionRange(Rt==null?void 0:Rt.startIndex,Rt.endIndex+1),Z.target.focus();const ni=((Rt==null?void 0:Rt.startIndex)-(Rt==null?void 0:Rt.startIndex)%Z.target.cols)/Z.target.cols,ne=Z.target.clientHeight/Z.target.rows;Z.target.scrollTop=ne*ni}}Z.target.style.height="",Z.target.style.height=Math.min(Z.target.scrollHeight,320)+"px"}Z.key==="Escape"&&(t(0,y=void 0),t(3,M=[]),t(4,N=[]),t(6,H=!1),t(5,F=!1),t(7,T=!1))},mm=async Z=>{Z.target.style.height="",Z.target.style.height=Math.min(Z.target.scrollHeight,320)+"px"},ke=async Z=>{Z.target.style.height="",Z.target.style.height=Math.min(Z.target.scrollHeight,320)+"px"},Fy=async Z=>{const Xe=Z.clipboardData||window.clipboardData;if(Xe&&Xe.items){for(const wt of Xe.items)if(wt.type.indexOf("image")!==-1){const _t=wt.getAsFile(),tt=new FileReader;tt.onload=function(Rt){t(2,I=[...I,{type:"image",url:`${Rt.target.result}`}])},tt.readAsDataURL(_t)}else if((wt==null?void 0:wt.kind)==="file"){const _t=wt.getAsFile();_t&&(await sn([_t]),Z.preventDefault())}else if(wt.type==="text/plain"&&((s==null?void 0:s.largeTextAsFile)??!1)&&!Ue){const _t=Xe.getData("text/plain");if(_t.length>cv){Z.preventDefault();const tt=new Blob([_t],{type:"text/plain"}),Rt=new File([tt],`Pasted_Text_${Date.now()}.txt`,{type:"text/plain"});await Ft(Rt,!0)}}}},Ly=()=>{oe.click()},By=async()=>{try{const Z=await LJ();if(Z){const Xe=new File([Z.blob],Z.name,{type:Z.blob.type});await Ft(Xe)}}catch(Z){console.error("Google Drive Error:",Z),Jt.error(r.t("Error accessing Google Drive: {{error}}",{error:Z.message}))}},Uy=async Z=>{try{const Xe=await pee(Z);if(Xe){const wt=new File([Xe.blob],Xe.name,{type:Xe.blob.type||"application/octet-stream"});await Ft(wt)}}catch(Xe){console.error("OneDrive Error:",Xe)}},Hy=async()=>{await hn();const Z=document.getElementById("chat-input");Z==null||Z.focus()};function zy(Z){M=Z,t(3,M)}const jy=()=>{t(26,P=!P)},Gy=Z=>{N.includes(Z.id)?t(4,N=N.filter(Xe=>Xe!==Z.id)):t(4,N=[...N,Z.id])},Vy=()=>t(6,H=!H),qy=()=>t(5,F=!F),Wy=()=>t(7,T=!T),Ky=async()=>{try{let Z=await navigator.mediaDevices.getUserMedia({audio:!0}).catch(function(Xe){return Jt.error(r.t("Permission denied when accessing microphone: {{error}}",{error:Xe})),null});Z&&(t(28,re=!0),Z.getTracks().forEach(wt=>wt.stop())),Z=null}catch{Jt.error(r.t("Permission denied when accessing microphone"))}},Xy=()=>{x()},Yy=async()=>{var Z,Xe,wt,_t,tt;if(w.length>1){Jt.error(r.t("Select only one model to call"));return}if(i.audio.stt.engine==="web"){Jt.error(r.t("Call feature is not supported when using Web STT engine"));return}try{let Rt=await navigator.mediaDevices.getUserMedia({audio:!0});Rt&&Rt.getTracks().forEach(ne=>ne.stop()),Rt=null,((Xe=(Z=s.audio)==null?void 0:Z.tts)==null?void 0:Xe.engine)==="browser-kokoro"&&(h||(await Qw.set(new yF({dtype:((tt=(_t=(wt=s.audio)==null?void 0:wt.tts)==null?void 0:_t.engineConfig)==null?void 0:tt.dtype)??"fp32"})),await h.init())),Ba.set(!0),Xi.set(!0)}catch{Jt.error(r.t("Permission denied when accessing media devices"))}},Jy=()=>{u("submit",k)};return n.$$set=Z=>{"transparentBackground"in Z&&t(10,f=Z.transparentBackground),"onChange"in Z&&t(56,g=Z.onChange),"createMessagePair"in Z&&t(11,m=Z.createMessagePair),"stopResponse"in Z&&t(12,x=Z.stopResponse),"autoScroll"in Z&&t(8,p=Z.autoScroll),"atSelectedModel"in Z&&t(0,y=Z.atSelectedModel),"selectedModels"in Z&&t(13,w=Z.selectedModels),"history"in Z&&t(14,v=Z.history),"taskIds"in Z&&t(15,C=Z.taskIds),"prompt"in Z&&t(1,k=Z.prompt),"files"in Z&&t(2,I=Z.files),"toolServers"in Z&&t(16,S=Z.toolServers),"selectedToolIds"in Z&&t(3,M=Z.selectedToolIds),"selectedFilterIds"in Z&&t(4,N=Z.selectedFilterIds),"imageGenerationEnabled"in Z&&t(5,F=Z.imageGenerationEnabled),"webSearchEnabled"in Z&&t(6,H=Z.webSearchEnabled),"codeInterpreterEnabled"in Z&&t(7,T=Z.codeInterpreterEnabled),"showCommands"in Z&&t(9,ye=Z.showCommands),"placeholder"in Z&&t(17,De=Z.placeholder)},n.$$.update=()=>{var Z,Xe,wt,_t,tt,Rt,ni,ne,Re;n.$$.dirty[0]&8193&&t(22,_=y!==void 0?[y.id]:w),n.$$.dirty[0]&254|n.$$.dirty[1]&33554432&&g({prompt:k,files:I.filter(Ee=>Ee.type!=="image").map(Ee=>({...Ee,user:void 0,access_control:void 0})),selectedToolIds:M,selectedFilterIds:N,imageGenerationEnabled:F,webSearchEnabled:H,codeInterpreterEnabled:T}),n.$$.dirty[0]&262144&&t(9,ye=["/","#","@"].includes(we==null?void 0:we.charAt(0))||(we==null?void 0:we.slice(0,2))==="\\#"),n.$$.dirty[0]&2105345&&t(36,je=(y!=null&&y.id?[y.id]:w).filter(Ee=>{var it,We,Le,Ye;return((Ye=(Le=(We=(it=l.find(At=>At.id===Ee))==null?void 0:it.info)==null?void 0:We.meta)==null?void 0:Le.capabilities)==null?void 0:Ye.vision)??!0})),n.$$.dirty[0]&2105345&&t(37,ze=(y!=null&&y.id?[y.id]:w).filter(Ee=>{var it,We,Le,Ye;return((Ye=(Le=(We=(it=l.find(At=>At.id===Ee))==null?void 0:it.info)==null?void 0:We.meta)==null?void 0:Le.capabilities)==null?void 0:Ye.file_upload)??!0})),n.$$.dirty[0]&2105345&&t(58,Qe=(y!=null&&y.id?[y.id]:w).filter(Ee=>{var it,We,Le,Ye;return((Ye=(Le=(We=(it=l.find(At=>At.id===Ee))==null?void 0:it.info)==null?void 0:We.meta)==null?void 0:Le.capabilities)==null?void 0:Ye.web_search)??!0})),n.$$.dirty[0]&2105345&&t(59,ft=(y!=null&&y.id?[y.id]:w).filter(Ee=>{var it,We,Le,Ye;return((Ye=(Le=(We=(it=l.find(At=>At.id===Ee))==null?void 0:it.info)==null?void 0:We.meta)==null?void 0:Le.capabilities)==null?void 0:Ye.image_generation)??!0})),n.$$.dirty[0]&2105345&&t(60,ut=(y!=null&&y.id?[y.id]:w).filter(Ee=>{var it,We,Le,Ye;return((Ye=(Le=(We=(it=l.find(At=>At.id===Ee))==null?void 0:it.info)==null?void 0:We.meta)==null?void 0:Le.capabilities)==null?void 0:Ye.code_interpreter)??!0})),n.$$.dirty[0]&2105345&&t(38,Je=(y!=null&&y.id?[y.id]:w).map(Ee=>{var it;return((it=l.find(We=>We.id===Ee)||{})==null?void 0:it.filters)??[]}).reduce((Ee,it)=>Ee.filter(We=>it.some(Le=>Le.id===We.id)))),n.$$.dirty[0]&65544&&t(39,rt=S.length+M.length>0),n.$$.dirty[0]&1581057|n.$$.dirty[1]&134217728&&t(40,ge=(y!=null&&y.id?[y.id]:w).length===Qe.length&&((Z=i==null?void 0:i.features)==null?void 0:Z.enable_web_search)&&(o.role==="admin"||((wt=(Xe=o==null?void 0:o.permissions)==null?void 0:Xe.features)==null?void 0:wt.web_search))),n.$$.dirty[0]&1581057|n.$$.dirty[1]&268435456&&t(41,Pt=(y!=null&&y.id?[y.id]:w).length===ft.length&&((_t=i==null?void 0:i.features)==null?void 0:_t.enable_image_generation)&&(o.role==="admin"||((Rt=(tt=o==null?void 0:o.permissions)==null?void 0:tt.features)==null?void 0:Rt.image_generation))),n.$$.dirty[0]&1581057|n.$$.dirty[1]&536870912&&t(42,lt=(y!=null&&y.id?[y.id]:w).length===ut.length&&((ni=i==null?void 0:i.features)==null?void 0:ni.enable_code_interpreter)&&(o.role==="admin"||((Re=(ne=o==null?void 0:o.permissions)==null?void 0:ne.features)==null?void 0:Re.code_interpreter)))},[y,k,I,M,N,F,H,T,p,ye,f,m,x,w,v,C,S,De,we,i,o,l,_,z,R,L,P,V,re,X,ue,oe,Q,ae,Ke,Ue,je,ze,Je,rt,ge,Pt,lt,s,r,c,h,u,d,J,se,he,ct,Ge,Ft,sn,g,G,Qe,ft,ut,Gi,ws,ui,Wi,_s,Ci,Rr,Xs,Es,Ne,Ve,ht,Xt,an,Bn,Cn,Un,zn,dl,gr,tm,nm,im,sm,rm,am,om,lm,cm,hm,um,dm,fm,gm,mm,ke,Fy,Ly,By,Uy,Hy,zy,jy,Gy,Vy,qy,Wy,Ky,Xy,Yy,Jy]}class bO extends Nt{constructor(e){super(),Ot(this,e,vte,_te,Ut,{transparentBackground:10,onChange:56,createMessagePair:11,stopResponse:12,autoScroll:8,atSelectedModel:0,selectedModels:13,history:14,taskIds:15,prompt:1,files:2,toolServers:16,selectedToolIds:3,selectedFilterIds:4,imageGenerationEnabled:5,webSearchEnabled:6,codeInterpreterEnabled:7,setText:57,showCommands:9,placeholder:17},null,[-1,-1,-1,-1,-1])}get setText(){return this.$$.ctx[57]}}function DA(n,e,t){const i=n.slice();return i[13]=e[t],i[14]=e,i[15]=t,i}function FA(n){let e,t,i,s;const r=[Cte,kte],a=[];function o(l,c){return l[15]===0?0:1}return e=o(n),t=a[e]=r[e](n),{c(){t.c(),i=zt()},l(l){t.l(l),i=zt()},m(l,c){a[e].m(l,c),$(l,i,c),s=!0},p(l,c){t.p(l,c)},i(l){s||(U(t),s=!0)},o(l){W(t),s=!1},d(l){l&&E(i),a[e].d(l)}}}function kte(n){let e,t,i;return t=new wi({props:{content:n[5].t("Remove Model"),$$slots:{default:[Ate]},$$scope:{ctx:n}}}),{c(){e=ee("div"),me(t.$$.fragment),this.h()},l(s){e=te(s,"DIV",{class:!0});var r=q(e);xe(t.$$.fragment,r),r.forEach(E),this.h()},h(){A(e,"class","self-center mx-1 disabled:text-gray-600 disabled:hover:text-gray-600 -translate-y-[0.5px]")},m(s,r){$(s,e,r),pe(t,e,null),i=!0},p(s,r){const a={};r&32&&(a.content=s[5].t("Remove Model")),r&65539&&(a.$$scope={dirty:r,ctx:s}),t.$set(a)},i(s){i||(U(t.$$.fragment,s),i=!0)},o(s){W(t.$$.fragment,s),i=!1},d(s){s&&E(e),be(t)}}}function Cte(n){let e,t,i;return t=new wi({props:{content:n[5].t("Add Model"),$$slots:{default:[Ste]},$$scope:{ctx:n}}}),{c(){e=ee("div"),me(t.$$.fragment),this.h()},l(s){e=te(s,"DIV",{class:!0});var r=q(e);xe(t.$$.fragment,r),r.forEach(E),this.h()},h(){A(e,"class","self-center mx-1 disabled:text-gray-600 disabled:hover:text-gray-600 -translate-y-[0.5px]")},m(s,r){$(s,e,r),pe(t,e,null),i=!0},p(s,r){const a={};r&32&&(a.content=s[5].t("Add Model")),r&65539&&(a.$$scope={dirty:r,ctx:s}),t.$set(a)},i(s){i||(U(t.$$.fragment,s),i=!0)},o(s){W(t.$$.fragment,s),i=!1},d(s){s&&E(e),be(t)}}}function Ate(n){let e,t,i,s,r;function a(){return n[12](n[15])}return{c(){e=ee("button"),t=at("svg"),i=at("path"),this.h()},l(o){e=te(o,"BUTTON",{"aria-label":!0});var l=q(e);t=ot(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var c=q(t);i=ot(c,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),q(i).forEach(E),c.forEach(E),l.forEach(E),this.h()},h(){A(i,"stroke-linecap","round"),A(i,"stroke-linejoin","round"),A(i,"d","M19.5 12h-15"),A(t,"xmlns","http://www.w3.org/2000/svg"),A(t,"fill","none"),A(t,"viewBox","0 0 24 24"),A(t,"stroke-width","2"),A(t,"stroke","currentColor"),A(t,"class","size-3"),e.disabled=n[1],A(e,"aria-label","Remove Model")},m(o,l){$(o,e,l),K(e,t),K(t,i),s||(r=yt(e,"click",a),s=!0)},p(o,l){n=o,l&2&&(e.disabled=n[1])},d(o){o&&E(e),s=!1,r()}}}function Ste(n){let e,t,i,s,r;return{c(){e=ee("button"),t=at("svg"),i=at("path"),this.h()},l(a){e=te(a,"BUTTON",{class:!0,"aria-label":!0});var o=q(e);t=ot(o,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var l=q(t);i=ot(l,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),q(i).forEach(E),l.forEach(E),o.forEach(E),this.h()},h(){A(i,"stroke-linecap","round"),A(i,"stroke-linejoin","round"),A(i,"d","M12 6v12m6-6H6"),A(t,"xmlns","http://www.w3.org/2000/svg"),A(t,"fill","none"),A(t,"viewBox","0 0 24 24"),A(t,"stroke-width","2"),A(t,"stroke","currentColor"),A(t,"class","size-3.5"),A(e,"class",""),e.disabled=n[1],A(e,"aria-label","Add Model")},m(a,o){$(a,e,o),K(e,t),K(t,i),s||(r=yt(e,"click",n[11]),s=!0)},p(a,o){o&2&&(e.disabled=a[1])},d(a){a&&E(e),s=!1,r()}}}function LA(n){var f,g,m,x,p,y,w,_,v,C,k;let e,t,i,s,r,a,o,l,c;function h(I){n[10](I,n[13],n[14],n[15])}let u={id:`${n[15]}`,placeholder:n[5].t("Select a model"),items:n[3].map(UA),showTemporaryChatControl:((f=n[6])==null?void 0:f.role)==="user"?(((x=(m=(g=n[6])==null?void 0:g.permissions)==null?void 0:m.chat)==null?void 0:x.temporary)??!0)&&!(((w=(y=(p=n[6])==null?void 0:p.permissions)==null?void 0:y.chat)==null?void 0:w.temporary_enforced)??!1):!0,pinModelHandler:n[9]};n[13]!==void 0&&(u.value=n[13]),s=new EF({props:u}),It.push(()=>Wt(s,"value",h));let d=(((_=n[6])==null?void 0:_.role)==="admin"||(((k=(C=(v=n[6])==null?void 0:v.permissions)==null?void 0:C.chat)==null?void 0:k.multiple_models)??!0))&&FA(n);return{c(){e=ee("div"),t=ee("div"),i=ee("div"),me(s.$$.fragment),o=Ce(),d&&d.c(),l=Ce(),this.h()},l(I){e=te(I,"DIV",{class:!0});var S=q(e);t=te(S,"DIV",{class:!0});var M=q(t);i=te(M,"DIV",{class:!0});var N=q(i);xe(s.$$.fragment,N),N.forEach(E),M.forEach(E),o=Ae(S),d&&d.l(S),l=Ae(S),S.forEach(E),this.h()},h(){var I;A(i,"class",a="max-w-full "+(((I=n[4])==null?void 0:I.highContrastMode)??!1?"m-1":"mr-1")),A(t,"class","overflow-hidden w-full"),A(e,"class","flex w-full max-w-fit")},m(I,S){$(I,e,S),K(e,t),K(t,i),pe(s,i,null),K(e,o),d&&d.m(e,null),K(e,l),c=!0},p(I,S){var N,F,H,T,z,R,L,Y,j,J,G,se;n=I;const M={};S&32&&(M.placeholder=n[5].t("Select a model")),S&8&&(M.items=n[3].map(UA)),S&64&&(M.showTemporaryChatControl=((N=n[6])==null?void 0:N.role)==="user"?(((T=(H=(F=n[6])==null?void 0:F.permissions)==null?void 0:H.chat)==null?void 0:T.temporary)??!0)&&!(((L=(R=(z=n[6])==null?void 0:z.permissions)==null?void 0:R.chat)==null?void 0:L.temporary_enforced)??!1):!0),!r&&S&1&&(r=!0,M.value=n[13],qt(()=>r=!1)),s.$set(M),(!c||S&16&&a!==(a="max-w-full "+(((Y=n[4])==null?void 0:Y.highContrastMode)??!1?"m-1":"mr-1")))&&A(i,"class",a),((j=n[6])==null?void 0:j.role)==="admin"||(((se=(G=(J=n[6])==null?void 0:J.permissions)==null?void 0:G.chat)==null?void 0:se.multiple_models)??!0)?d?(d.p(n,S),S&64&&U(d,1)):(d=FA(n),d.c(),U(d,1),d.m(e,l)):d&&(bt(),W(d,1,1,()=>{d=null}),xt())},i(I){c||(U(s.$$.fragment,I),U(d),c=!0)},o(I){W(s.$$.fragment,I),W(d),c=!1},d(I){I&&E(e),be(s),d&&d.d()}}}function BA(n){let e,t,i=n[5].t("Set as default")+"",s,r,a;return{c(){e=ee("div"),t=ee("button"),s=vt(i),this.h()},l(o){e=te(o,"DIV",{class:!0});var l=q(e);t=te(l,"BUTTON",{});var c=q(t);s=kt(c,i),c.forEach(E),l.forEach(E),this.h()},h(){A(e,"class","absolute text-left mt-[1px] ml-1 text-[0.7rem] text-gray-600 dark:text-gray-400 font-primary")},m(o,l){$(o,e,l),K(e,t),K(t,s),r||(a=yt(t,"click",n[8]),r=!0)},p(o,l){l&32&&i!==(i=o[5].t("Set as default")+"")&&Et(s,i)},d(o){o&&E(e),r=!1,a()}}}function Ite(n){let e,t,i,s,r=Zn(n[0]),a=[];for(let c=0;c<r.length;c+=1)a[c]=LA(DA(n,r,c));const o=c=>W(a[c],1,1,()=>{a[c]=null});let l=n[2]&&BA(n);return{c(){e=ee("div");for(let c=0;c<a.length;c+=1)a[c].c();t=Ce(),l&&l.c(),i=zt(),this.h()},l(c){e=te(c,"DIV",{class:!0});var h=q(e);for(let u=0;u<a.length;u+=1)a[u].l(h);h.forEach(E),t=Ae(c),l&&l.l(c),i=zt(),this.h()},h(){A(e,"class","flex flex-col w-full items-start")},m(c,h){$(c,e,h);for(let u=0;u<a.length;u+=1)a[u]&&a[u].m(e,null);$(c,t,h),l&&l.m(c,h),$(c,i,h),s=!0},p(c,[h]){if(h&635){r=Zn(c[0]);let u;for(u=0;u<r.length;u+=1){const d=DA(c,r,u);a[u]?(a[u].p(d,h),U(a[u],1)):(a[u]=LA(d),a[u].c(),U(a[u],1),a[u].m(e,null))}for(bt(),u=r.length;u<a.length;u+=1)o(u);xt()}c[2]?l?l.p(c,h):(l=BA(c),l.c(),l.m(i.parentNode,i)):l&&(l.d(1),l=null)},i(c){if(!s){for(let h=0;h<r.length;h+=1)U(a[h]);s=!0}},o(c){a=a.filter(Boolean);for(let h=0;h<a.length;h+=1)W(a[h]);s=!1},d(c){c&&(E(e),E(t),E(i)),vo(a,c),l&&l.d(c)}}}const UA=n=>({value:n.id,label:n.name,model:n});function Ete(n,e,t){let i,s,r,a;Pe(n,Xg,x=>t(3,i=x)),Pe(n,Ga,x=>t(4,s=x)),Pe(n,k0,x=>t(6,a=x));const o=as("i18n");Pe(n,o,x=>t(5,r=x));let{selectedModels:l=[""]}=e,{disabled:c=!1}=e,{showSetDefault:h=!0}=e;const u=async()=>{if(l.filter(p=>p==="").length){Jt.error(r.t("Choose a model before saving..."));return}Ga.set({...s,models:l}),await dv(localStorage.token,{ui:s}),Jt.success(r.t("Default model updated"))},d=async x=>{let p=(s==null?void 0:s.pinnedModels)??[];p.includes(x)?p=p.filter(y=>y!==x):p=[...new Set([...p,x])],Ga.set({...s,pinnedModels:p}),await dv(localStorage.token,{ui:s})};function f(x,p,y,w){y[w]=x,t(0,l),t(3,i)}const g=()=>{t(0,l=[...l,""])},m=x=>{l.splice(x,1),t(0,l),t(3,i)};return n.$$set=x=>{"selectedModels"in x&&t(0,l=x.selectedModels),"disabled"in x&&t(1,c=x.disabled),"showSetDefault"in x&&t(2,h=x.showSetDefault)},n.$$.update=()=>{n.$$.dirty&9&&l.length>0&&i.length>0&&t(0,l=l.map(x=>i.map(p=>p.id).includes(x)?x:""))},[l,c,h,i,s,r,a,o,u,d,f,g,m]}class Tte extends Nt{constructor(e){super(),Ot(this,e,Ete,Ite,Ut,{selectedModels:0,disabled:1,showSetDefault:2})}}function Rte(n){let e,t;return{c(){e=at("svg"),t=at("path"),this.h()},l(i){e=ot(i,"svg",{xmlns:!0,viewBox:!0,stroke:!0,fill:!0,class:!0,"stroke-width":!0});var s=q(e);t=ot(s,"path",{d:!0}),q(t).forEach(E),s.forEach(E),this.h()},h(){A(t,"d","M18.75 12.75h1.5a.75.75 0 0 0 0-1.5h-1.5a.75.75 0 0 0 0 1.5ZM12 6a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 12 6ZM12 18a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 12 18ZM3.75 6.75h1.5a.75.75 0 1 0 0-1.5h-1.5a.75.75 0 0 0 0 1.5ZM5.25 18.75h-1.5a.75.75 0 0 1 0-1.5h1.5a.75.75 0 0 1 0 1.5ZM3 12a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 3 12ZM9 3.75a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5ZM12.75 12a2.25 2.25 0 1 1 4.5 0 2.25 2.25 0 0 1-4.5 0ZM9 15.75a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5Z"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"viewBox","0 0 24 24"),A(e,"stroke","currentColor"),A(e,"fill","currentColor"),A(e,"class",n[0]),A(e,"stroke-width",n[1])},m(i,s){$(i,e,s),K(e,t)},p(i,[s]){s&1&&A(e,"class",i[0]),s&2&&A(e,"stroke-width",i[1])},i:Ct,o:Ct,d(i){i&&E(e)}}}function Mte(n,e,t){let{className:i="w-4 h-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,i=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[i,s]}class xO extends Nt{constructor(e){super(),Ot(this,e,Mte,Rte,Ut,{className:0,strokeWidth:1})}}function Pte(n){let e;const t=n[14].default,i=Gs(t,n,n[24],null);return{c(){i&&i.c()},l(s){i&&i.l(s)},m(s,r){i&&i.m(s,r),e=!0},p(s,r){i&&i.p&&(!e||r&16777216)&&Vs(i,t,s,s[24],e?Ws(t,s[24],r,null):qs(s[24]),null)},i(s){e||(U(i,s),e=!0)},o(s){W(i,s),e=!1},d(s){i&&i.d(s)}}}function HA(n){let e,t;return e=new ua({props:{class:"flex gap-2 items-center px-3 py-2 text-sm cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md select-none w-full",id:"chat-controls-button",$$slots:{default:[Nte]},$$scope:{ctx:n}}}),e.$on("click",n[15]),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p(i,s){const r={};s&16777248&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function Nte(n){let e,t,i,s=n[5].t("Controls")+"",r,a;return e=new xO({props:{className:" size-4",strokeWidth:"0.5"}}),{c(){me(e.$$.fragment),t=Ce(),i=ee("div"),r=vt(s),this.h()},l(o){xe(e.$$.fragment,o),t=Ae(o),i=te(o,"DIV",{class:!0});var l=q(i);r=kt(l,s),l.forEach(E),this.h()},h(){A(i,"class","flex items-center")},m(o,l){pe(e,o,l),$(o,t,l),$(o,i,l),K(i,r),a=!0},p(o,l){(!a||l&32)&&s!==(s=o[5].t("Controls")+"")&&Et(r,s)},i(o){a||(U(e.$$.fragment,o),a=!0)},o(o){W(e.$$.fragment,o),a=!1},d(o){o&&(E(t),E(i)),be(e,o)}}}function zA(n){let e,t;return e=new ua({props:{class:"flex gap-2 items-center px-3 py-2 text-sm cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md select-none w-full",id:"chat-share-button",$$slots:{default:[Ote]},$$scope:{ctx:n}}}),e.$on("click",n[16]),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p(i,s){const r={};s&16777248&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function Ote(n){let e,t,i,s,r=n[5].t("Share")+"",a;return{c(){e=at("svg"),t=at("path"),i=Ce(),s=ee("div"),a=vt(r),this.h()},l(o){e=ot(o,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var l=q(e);t=ot(l,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),q(t).forEach(E),l.forEach(E),i=Ae(o),s=te(o,"DIV",{class:!0});var c=q(s);a=kt(c,r),c.forEach(E),this.h()},h(){A(t,"fill-rule","evenodd"),A(t,"d","M15.75 4.5a3 3 0 1 1 .825 2.066l-8.421 4.679a3.002 3.002 0 0 1 0 1.51l8.421 4.679a3 3 0 1 1-.729 1.31l-8.421-4.678a3 3 0 1 1 0-4.132l8.421-4.679a3 3 0 0 1-.096-.755Z"),A(t,"clip-rule","evenodd"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"viewBox","0 0 24 24"),A(e,"fill","currentColor"),A(e,"class","size-4"),A(s,"class","flex items-center")},m(o,l){$(o,e,l),K(e,t),$(o,i,l),$(o,s,l),K(s,a)},p(o,l){l&32&&r!==(r=o[5].t("Share")+"")&&Et(a,r)},d(o){o&&(E(e),E(i),E(s))}}}function Dte(n){let e,t,i,s=n[5].t("Overview")+"",r,a;return e=new RF({props:{className:" size-4",strokeWidth:"1.5"}}),{c(){me(e.$$.fragment),t=Ce(),i=ee("div"),r=vt(s),this.h()},l(o){xe(e.$$.fragment,o),t=Ae(o),i=te(o,"DIV",{class:!0});var l=q(i);r=kt(l,s),l.forEach(E),this.h()},h(){A(i,"class","flex items-center")},m(o,l){pe(e,o,l),$(o,t,l),$(o,i,l),K(i,r),a=!0},p(o,l){(!a||l&32)&&s!==(s=o[5].t("Overview")+"")&&Et(r,s)},i(o){a||(U(e.$$.fragment,o),a=!0)},o(o){W(e.$$.fragment,o),a=!1},d(o){o&&(E(t),E(i)),be(e,o)}}}function Fte(n){let e,t,i,s=n[5].t("Artifacts")+"",r,a;return e=new uD({props:{className:" size-4",strokeWidth:"1.5"}}),{c(){me(e.$$.fragment),t=Ce(),i=ee("div"),r=vt(s),this.h()},l(o){xe(e.$$.fragment,o),t=Ae(o),i=te(o,"DIV",{class:!0});var l=q(i);r=kt(l,s),l.forEach(E),this.h()},h(){A(i,"class","flex items-center")},m(o,l){pe(e,o,l),$(o,t,l),$(o,i,l),K(i,r),a=!0},p(o,l){(!a||l&32)&&s!==(s=o[5].t("Artifacts")+"")&&Et(r,s)},i(o){a||(U(e.$$.fragment,o),a=!0)},o(o){W(e.$$.fragment,o),a=!1},d(o){o&&(E(t),E(i)),be(e,o)}}}function Lte(n){let e,t,i,s,r=n[5].t("Download")+"",a;return{c(){e=at("svg"),t=at("path"),i=Ce(),s=ee("div"),a=vt(r),this.h()},l(o){e=ot(o,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var l=q(e);t=ot(l,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),q(t).forEach(E),l.forEach(E),i=Ae(o),s=te(o,"DIV",{class:!0});var c=q(s);a=kt(c,r),c.forEach(E),this.h()},h(){A(t,"stroke-linecap","round"),A(t,"stroke-linejoin","round"),A(t,"d","M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"fill","none"),A(e,"viewBox","0 0 24 24"),A(e,"stroke-width","1.5"),A(e,"stroke","currentColor"),A(e,"class","size-4"),A(s,"class","flex items-center")},m(o,l){$(o,e,l),K(e,t),$(o,i,l),$(o,s,l),K(s,a)},p(o,l){l&32&&r!==(r=o[5].t("Download")+"")&&Et(a,r)},d(o){o&&(E(e),E(i),E(s))}}}function jA(n){let e,t;return e=new ua({props:{class:"flex gap-2 items-center px-3 py-2 text-sm cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md select-none w-full",$$slots:{default:[Bte]},$$scope:{ctx:n}}}),e.$on("click",n[19]),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p(i,s){const r={};s&16777248&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function Bte(n){let e,t=n[5].t("Export chat (.json)")+"",i;return{c(){e=ee("div"),i=vt(t),this.h()},l(s){e=te(s,"DIV",{class:!0});var r=q(e);i=kt(r,t),r.forEach(E),this.h()},h(){A(e,"class","flex items-center line-clamp-1")},m(s,r){$(s,e,r),K(e,i)},p(s,r){r&32&&t!==(t=s[5].t("Export chat (.json)")+"")&&Et(i,t)},d(s){s&&E(e)}}}function Ute(n){let e,t=n[5].t("Plain text (.txt)")+"",i;return{c(){e=ee("div"),i=vt(t),this.h()},l(s){e=te(s,"DIV",{class:!0});var r=q(e);i=kt(r,t),r.forEach(E),this.h()},h(){A(e,"class","flex items-center line-clamp-1")},m(s,r){$(s,e,r),K(e,i)},p(s,r){r&32&&t!==(t=s[5].t("Plain text (.txt)")+"")&&Et(i,t)},d(s){s&&E(e)}}}function Hte(n){let e,t=n[5].t("PDF document (.pdf)")+"",i;return{c(){e=ee("div"),i=vt(t),this.h()},l(s){e=te(s,"DIV",{class:!0});var r=q(e);i=kt(r,t),r.forEach(E),this.h()},h(){A(e,"class","flex items-center line-clamp-1")},m(s,r){$(s,e,r),K(e,i)},p(s,r){r&32&&t!==(t=s[5].t("PDF document (.pdf)")+"")&&Et(i,t)},d(s){s&&E(e)}}}function zte(n){var o,l,c;let e,t,i,s,r,a=(((o=n[6])==null?void 0:o.role)==="admin"||(((c=(l=n[6].permissions)==null?void 0:l.chat)==null?void 0:c.export)??!0))&&jA(n);return t=new ua({props:{class:"flex gap-2 items-center px-3 py-2 text-sm cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md select-none w-full",$$slots:{default:[Ute]},$$scope:{ctx:n}}}),t.$on("click",n[20]),s=new ua({props:{class:"flex gap-2 items-center px-3 py-2 text-sm cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md select-none w-full",$$slots:{default:[Hte]},$$scope:{ctx:n}}}),s.$on("click",n[21]),{c(){a&&a.c(),e=Ce(),me(t.$$.fragment),i=Ce(),me(s.$$.fragment)},l(h){a&&a.l(h),e=Ae(h),xe(t.$$.fragment,h),i=Ae(h),xe(s.$$.fragment,h)},m(h,u){a&&a.m(h,u),$(h,e,u),pe(t,h,u),$(h,i,u),pe(s,h,u),r=!0},p(h,u){var g,m,x;((g=h[6])==null?void 0:g.role)==="admin"||(((x=(m=h[6].permissions)==null?void 0:m.chat)==null?void 0:x.export)??!0)?a?(a.p(h,u),u&64&&U(a,1)):(a=jA(h),a.c(),U(a,1),a.m(e.parentNode,e)):a&&(bt(),W(a,1,1,()=>{a=null}),xt());const d={};u&16777248&&(d.$$scope={dirty:u,ctx:h}),t.$set(d);const f={};u&16777248&&(f.$$scope={dirty:u,ctx:h}),s.$set(f)},i(h){r||(U(a),U(t.$$.fragment,h),U(s.$$.fragment,h),r=!0)},o(h){W(a),W(t.$$.fragment,h),W(s.$$.fragment,h),r=!1},d(h){h&&(E(e),E(i)),a&&a.d(h),be(t,h),be(s,h)}}}function jte(n){let e,t,i,s;return e=new FI({props:{class:"flex gap-2 items-center px-3 py-2 text-sm cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md select-none w-full",$$slots:{default:[Lte]},$$scope:{ctx:n}}}),i=new LI({props:{class:"w-full rounded-xl px-1 py-1.5 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg",transition:W5,sideOffset:8,$$slots:{default:[zte]},$$scope:{ctx:n}}}),{c(){me(e.$$.fragment),t=Ce(),me(i.$$.fragment)},l(r){xe(e.$$.fragment,r),t=Ae(r),xe(i.$$.fragment,r)},m(r,a){pe(e,r,a),$(r,t,a),pe(i,r,a),s=!0},p(r,a){const o={};a&16777248&&(o.$$scope={dirty:a,ctx:r}),e.$set(o);const l={};a&16777312&&(l.$$scope={dirty:a,ctx:r}),i.$set(l)},i(r){s||(U(e.$$.fragment,r),U(i.$$.fragment,r),s=!0)},o(r){W(e.$$.fragment,r),W(i.$$.fragment,r),s=!1},d(r){r&&E(t),be(e,r),be(i,r)}}}function Gte(n){let e,t,i,s=n[5].t("Copy")+"",r,a;return e=new dD({props:{className:" size-4",strokeWidth:"1.5"}}),{c(){me(e.$$.fragment),t=Ce(),i=ee("div"),r=vt(s),this.h()},l(o){xe(e.$$.fragment,o),t=Ae(o),i=te(o,"DIV",{class:!0});var l=q(i);r=kt(l,s),l.forEach(E),this.h()},h(){A(i,"class","flex items-center")},m(o,l){pe(e,o,l),$(o,t,l),$(o,i,l),K(i,r),a=!0},p(o,l){(!a||l&32)&&s!==(s=o[5].t("Copy")+"")&&Et(r,s)},i(o){a||(U(e.$$.fragment,o),a=!0)},o(o){W(e.$$.fragment,o),a=!1},d(o){o&&(E(t),E(i)),be(e,o)}}}function GA(n){let e,t,i,s,r;return s=new vF({props:{chatId:n[1].id}}),{c(){e=ee("hr"),t=Ce(),i=ee("div"),me(s.$$.fragment),this.h()},l(a){e=te(a,"HR",{class:!0}),t=Ae(a),i=te(a,"DIV",{class:!0});var o=q(i);xe(s.$$.fragment,o),o.forEach(E),this.h()},h(){A(e,"class","border-gray-100 dark:border-gray-850 my-0.5"),A(i,"class","flex p-1")},m(a,o){$(a,e,o),$(a,t,o),$(a,i,o),pe(s,i,null),r=!0},p(a,o){const l={};o&2&&(l.chatId=a[1].id),s.$set(l)},i(a){r||(U(s.$$.fragment,a),r=!0)},o(a){W(s.$$.fragment,a),r=!1},d(a){a&&(E(e),E(t),E(i)),be(s)}}}function Vte(n){var x,p,y;let e,t,i,s,r,a,o,l,c,h,u,d,f=n[4]&&HA(n),g=!n[3]&&(((x=n[6])==null?void 0:x.role)==="admin"||(((y=(p=n[6].permissions)==null?void 0:p.chat)==null?void 0:y.share)??!0))&&zA(n);i=new ua({props:{class:"flex gap-2 items-center px-3 py-2 text-sm cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md select-none w-full",id:"chat-overview-button",$$slots:{default:[Dte]},$$scope:{ctx:n}}}),i.$on("click",n[17]),r=new ua({props:{class:"flex gap-2 items-center px-3 py-2 text-sm cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md select-none w-full",id:"chat-overview-button",$$slots:{default:[Fte]},$$scope:{ctx:n}}}),r.$on("click",n[18]),o=new DI({props:{$$slots:{default:[jte]},$$scope:{ctx:n}}}),c=new ua({props:{class:"flex gap-2 items-center px-3 py-2 text-sm cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md select-none w-full",id:"chat-copy-button",$$slots:{default:[Gte]},$$scope:{ctx:n}}}),c.$on("click",n[22]);let m=!n[3]&&GA(n);return{c(){f&&f.c(),e=Ce(),g&&g.c(),t=Ce(),me(i.$$.fragment),s=Ce(),me(r.$$.fragment),a=Ce(),me(o.$$.fragment),l=Ce(),me(c.$$.fragment),h=Ce(),m&&m.c(),u=zt()},l(w){f&&f.l(w),e=Ae(w),g&&g.l(w),t=Ae(w),xe(i.$$.fragment,w),s=Ae(w),xe(r.$$.fragment,w),a=Ae(w),xe(o.$$.fragment,w),l=Ae(w),xe(c.$$.fragment,w),h=Ae(w),m&&m.l(w),u=zt()},m(w,_){f&&f.m(w,_),$(w,e,_),g&&g.m(w,_),$(w,t,_),pe(i,w,_),$(w,s,_),pe(r,w,_),$(w,a,_),pe(o,w,_),$(w,l,_),pe(c,w,_),$(w,h,_),m&&m.m(w,_),$(w,u,_),d=!0},p(w,_){var S,M,N;w[4]?f?(f.p(w,_),_&16&&U(f,1)):(f=HA(w),f.c(),U(f,1),f.m(e.parentNode,e)):f&&(bt(),W(f,1,1,()=>{f=null}),xt()),!w[3]&&(((S=w[6])==null?void 0:S.role)==="admin"||(((N=(M=w[6].permissions)==null?void 0:M.chat)==null?void 0:N.share)??!0))?g?(g.p(w,_),_&72&&U(g,1)):(g=zA(w),g.c(),U(g,1),g.m(t.parentNode,t)):g&&(bt(),W(g,1,1,()=>{g=null}),xt());const v={};_&16777248&&(v.$$scope={dirty:_,ctx:w}),i.$set(v);const C={};_&16777248&&(C.$$scope={dirty:_,ctx:w}),r.$set(C);const k={};_&16777312&&(k.$$scope={dirty:_,ctx:w}),o.$set(k);const I={};_&16777248&&(I.$$scope={dirty:_,ctx:w}),c.$set(I),w[3]?m&&(bt(),W(m,1,1,()=>{m=null}),xt()):m?(m.p(w,_),_&8&&U(m,1)):(m=GA(w),m.c(),U(m,1),m.m(u.parentNode,u))},i(w){d||(U(f),U(g),U(i.$$.fragment,w),U(r.$$.fragment,w),U(o.$$.fragment,w),U(c.$$.fragment,w),U(m),d=!0)},o(w){W(f),W(g),W(i.$$.fragment,w),W(r.$$.fragment,w),W(o.$$.fragment,w),W(c.$$.fragment,w),W(m),d=!1},d(w){w&&(E(e),E(t),E(s),E(a),E(l),E(h),E(u)),f&&f.d(w),g&&g.d(w),be(i,w),be(r,w),be(o,w),be(c,w),m&&m.d(w)}}}function qte(n){let e,t,i;return t=new i4({props:{class:"w-full max-w-[200px] rounded-xl px-1 py-1.5  z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg",sideOffset:8,side:"bottom",align:"end",transition:W5,$$slots:{default:[Vte]},$$scope:{ctx:n}}}),{c(){e=ee("div"),me(t.$$.fragment),this.h()},l(s){e=te(s,"DIV",{slot:!0});var r=q(e);xe(t.$$.fragment,r),r.forEach(E),this.h()},h(){A(e,"slot","content")},m(s,r){$(s,e,r),pe(t,e,null),i=!0},p(s,r){const a={};r&16777339&&(a.$$scope={dirty:r,ctx:s}),t.$set(a)},i(s){i||(U(t.$$.fragment,s),i=!0)},o(s){W(t.$$.fragment,s),i=!1},d(s){s&&E(e),be(t)}}}function Wte(n){let e,t;return e=new s4({props:{$$slots:{content:[qte],default:[Pte]},$$scope:{ctx:n}}}),e.$on("change",n[23]),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p(i,[s]){const r={};s&16777339&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function Kte(n,e,t){let i,s,r,a,o;Pe(n,Fd,T=>t(3,i=T)),Pe(n,Ga,T=>t(25,s=T)),Pe(n,nx,T=>t(4,r=T)),Pe(n,k0,T=>t(6,o=T));let{$$slots:l={},$$scope:c}=e;const{saveAs:h}=UI,u=as("i18n");Pe(n,u,T=>t(5,a=T));let{shareEnabled:d=!1}=e,{shareHandler:f}=e,{downloadHandler:g}=e,{chat:m}=e,{onClose:x=()=>{}}=e;const p=async()=>{const T=m.chat.history;return Da(T,T.currentId).reduce((L,Y,j,J)=>`${L}### ${Y.role.toUpperCase()}
${Y.content}

`,"").trim()},y=async()=>{const T=await p();let z=new Blob([T],{type:"text/plain"});h(z,`chat-${m.chat.title}.txt`)},w=async()=>{if((s==null?void 0:s.stylizedPdfExport)??!0){const T=document.getElementById("messages-container");if(T)try{const z=document.documentElement.classList.contains("dark"),R=800,L=1200,Y=T.cloneNode(!0);Y.classList.add("text-black"),Y.classList.add("dark:text-white"),Y.style.width=`${R}px`,Y.style.position="absolute",Y.style.left="-9999px",Y.style.height="auto",document.body.appendChild(Y);const j=Y.scrollHeight;let J=0,G=0;const se=new mv("p","mm","a4"),de=210,he=297;for(;J<j;){Y.scrollTop=J,Y.style.maxHeight=`${L}px`;const we=await TF(Y,{backgroundColor:z?"#000":"#fff",useCORS:!0,scale:2,width:R,height:Math.min(L,j-J),windowWidth:R}),ye=we.toDataURL("image/png"),P=we.height*de/we.width,V=0;G>0&&se.addPage(),z&&(se.setFillColor(0,0,0),se.rect(0,0,de,he,"F")),se.addImage(ye,"PNG",0,V,de,P),J+=L,G++}document.body.removeChild(Y),se.save(`chat-${m.chat.title}.pdf`)}catch(z){console.error("Error generating PDF",z)}}else{const T=await p(),z=new mv,R=15,L=20,Y=15,j=20,J=z.internal.pageSize.getWidth(),G=z.internal.pageSize.getHeight(),se=J-R-Y,de=8;z.setFontSize(de);const he=de*1,we=T.split(`
`);let ye=L;for(let P of we){const V=z.splitTextToSize(P,se);for(let re of V)ye+he>G-j&&(z.addPage(),ye=L),z.text(re,R,ye),ye+=he*.5;ye+=he*.1}z.save(`chat-${m.chat.title}.pdf`)}},_=async()=>{if(m.id){let T=null;m.id==="local"||i?T=m:T=await e8(localStorage.token,m.id);let z=new Blob([JSON.stringify([T])],{type:"application/json"});h(z,`chat-export-${Date.now()}.json`)}},v=async()=>{await Xi.set(!0),await r0.set(!1),await Zl.set(!1)},C=()=>{f()},k=async()=>{await Xi.set(!0),await r0.set(!0),await Zl.set(!1)},I=async()=>{await Xi.set(!0),await Zl.set(!0),await r0.set(!1)},S=()=>{_()},M=()=>{y()},N=()=>{w()},F=async()=>{await t4(await p()).catch(z=>{console.error(z)})&&Jt.success(a.t("Copied to clipboard"))},H=T=>{T.detail===!1&&x()};return n.$$set=T=>{"shareEnabled"in T&&t(12,d=T.shareEnabled),"shareHandler"in T&&t(0,f=T.shareHandler),"downloadHandler"in T&&t(13,g=T.downloadHandler),"chat"in T&&t(1,m=T.chat),"onClose"in T&&t(2,x=T.onClose),"$$scope"in T&&t(24,c=T.$$scope)},[f,m,x,i,r,a,o,u,p,y,w,_,d,g,l,v,C,k,I,S,M,N,F,H,c]}class Xte extends Nt{constructor(e){super(),Ot(this,e,Kte,Wte,Ut,{shareEnabled:12,shareHandler:0,downloadHandler:13,chat:1,onClose:2})}}function VA(n,e,t){const i=n.slice();return i[34]=e[t],i}function qA(n){let e,t;return e=new wi({props:{content:n[13].t("New Chat"),$$slots:{default:[Yte]},$$scope:{ctx:n}}}),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p(i,s){const r={};s[0]&8192&&(r.content=i[13].t("New Chat")),s[0]&2050|s[1]&64&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function Yte(n){let e,t,i,s,r,a,o;return i=new HI({props:{className:" size-5",strokeWidth:"2"}}),{c(){e=ee("button"),t=ee("div"),me(i.$$.fragment),this.h()},l(l){e=te(l,"BUTTON",{class:!0,"aria-label":!0});var c=q(e);t=te(c,"DIV",{class:!0});var h=q(t);xe(i.$$.fragment,h),h.forEach(E),c.forEach(E),this.h()},h(){A(t,"class","m-auto self-center"),A(e,"class",s="flex "+(n[11]?"md:hidden":"")+" cursor-pointer px-2 py-2 rounded-xl text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-850 transition"),A(e,"aria-label","New Chat")},m(l,c){$(l,e,c),K(e,t),pe(i,t,null),r=!0,a||(o=yt(e,"click",n[24]),a=!0)},p(l,c){(!r||c[0]&2048&&s!==(s="flex "+(l[11]?"md:hidden":"")+" cursor-pointer px-2 py-2 rounded-xl text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-850 transition"))&&A(e,"class",s)},i(l){r||(U(i.$$.fragment,l),r=!0)},o(l){W(i.$$.fragment,l),r=!1},d(l){l&&E(e),be(i),a=!1,o()}}}function WA(n){let e,t,i;function s(a){n[25](a)}let r={showSetDefault:!n[2]};return n[0]!==void 0&&(r.selectedModels=n[0]),e=new Tte({props:r}),It.push(()=>Wt(e,"selectedModels",s)),{c(){me(e.$$.fragment)},l(a){xe(e.$$.fragment,a)},m(a,o){pe(e,a,o),i=!0},p(a,o){const l={};o[0]&4&&(l.showSetDefault=!a[2]),!t&&o[0]&1&&(t=!0,l.selectedModels=a[0],qt(()=>t=!1)),e.$set(l)},i(a){i||(U(e.$$.fragment,a),i=!0)},o(a){W(e.$$.fragment,a),i=!1},d(a){be(e,a)}}}function KA(n){let e,t;return e=new Xte({props:{chat:n[3],shareEnabled:n[2],shareHandler:n[26],downloadHandler:n[27],$$slots:{default:[Jte]},$$scope:{ctx:n}}}),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p(i,s){const r={};s[0]&8&&(r.chat=i[3]),s[0]&4&&(r.shareEnabled=i[2]),s[0]&256&&(r.shareHandler=i[26]),s[0]&512&&(r.downloadHandler=i[27]),s[1]&64&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function Jte(n){let e,t='<div class="m-auto self-center"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5"><path stroke-linecap="round" stroke-linejoin="round" d="M6.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM12.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM18.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z"></path></svg></div>';return{c(){e=ee("button"),e.innerHTML=t,this.h()},l(i){e=te(i,"BUTTON",{class:!0,id:!0,"data-svelte-h":!0}),ko(e)!=="svelte-1cq3yl7"&&(e.innerHTML=t),this.h()},h(){A(e,"class","flex cursor-pointer px-2 py-2 rounded-xl hover:bg-gray-50 dark:hover:bg-gray-850 transition"),A(e,"id","chat-context-menu-button")},m(i,s){$(i,e,s)},p:Ct,d(i){i&&E(e)}}}function Zte(n){let e,t,i,s,r,a;return i=new xO({props:{className:" size-5",strokeWidth:"0.5"}}),{c(){e=ee("button"),t=ee("div"),me(i.$$.fragment),this.h()},l(o){e=te(o,"BUTTON",{class:!0,"aria-label":!0});var l=q(e);t=te(l,"DIV",{class:!0});var c=q(t);xe(i.$$.fragment,c),c.forEach(E),l.forEach(E),this.h()},h(){A(t,"class","m-auto self-center"),A(e,"class","flex cursor-pointer px-2 py-2 rounded-xl hover:bg-gray-50 dark:hover:bg-gray-850 transition"),A(e,"aria-label","Controls")},m(o,l){$(o,e,l),K(e,t),pe(i,t,null),s=!0,r||(a=yt(e,"click",n[28]),r=!0)},p:Ct,i(o){s||(U(i.$$.fragment,o),s=!0)},o(o){W(i.$$.fragment,o),s=!1},d(o){o&&E(e),be(i),r=!1,a()}}}function XA(n){let e,t;return e=new wi({props:{content:n[13].t("New Chat"),$$slots:{default:[Qte]},$$scope:{ctx:n}}}),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p(i,s){const r={};s[0]&8192&&(r.content=i[13].t("New Chat")),s[0]&2050|s[1]&64&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function Qte(n){let e,t,i,s,r,a,o;return i=new HI({props:{className:" size-5",strokeWidth:"2"}}),{c(){e=ee("button"),t=ee("div"),me(i.$$.fragment),this.h()},l(l){e=te(l,"BUTTON",{class:!0,"aria-label":!0});var c=q(e);t=te(c,"DIV",{class:!0});var h=q(t);xe(i.$$.fragment,h),h.forEach(E),c.forEach(E),this.h()},h(){A(t,"class","m-auto self-center"),A(e,"class",s="flex "+(n[11]?"md:hidden":"")+" cursor-pointer px-2 py-2 rounded-xl text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-850 transition"),A(e,"aria-label","New Chat")},m(l,c){$(l,e,c),K(e,t),pe(i,t,null),r=!0,a||(o=yt(e,"click",n[29]),a=!0)},p(l,c){(!r||c[0]&2048&&s!==(s="flex "+(l[11]?"md:hidden":"")+" cursor-pointer px-2 py-2 rounded-xl text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-850 transition"))&&A(e,"class",s)},i(l){r||(U(i.$$.fragment,l),r=!0)},o(l){W(i.$$.fragment,l),r=!1},d(l){l&&E(e),be(i),a=!1,o()}}}function YA(n){var i;let e,t;return e=new MF({props:{className:"max-w-[240px]",role:(i=n[16])==null?void 0:i.role,help:!0,$$slots:{default:[$te]},$$scope:{ctx:n}}}),e.$on("show",n[30]),{c(){me(e.$$.fragment)},l(s){xe(e.$$.fragment,s)},m(s,r){pe(e,s,r),t=!0},p(s,r){var o;const a={};r[0]&65536&&(a.role=(o=s[16])==null?void 0:o.role),r[0]&73728|r[1]&64&&(a.$$scope={dirty:r,ctx:s}),e.$set(a)},i(s){t||(U(e.$$.fragment,s),t=!0)},o(s){W(e.$$.fragment,s),t=!1},d(s){be(e,s)}}}function $te(n){let e,t,i,s=n[13].t("User menu")+"",r,a,o,l;return{c(){e=ee("div"),t=ee("div"),i=ee("span"),r=vt(s),a=Ce(),o=ee("img"),this.h()},l(c){e=te(c,"DIV",{class:!0});var h=q(e);t=te(h,"DIV",{class:!0});var u=q(t);i=te(u,"SPAN",{class:!0});var d=q(i);r=kt(d,s),d.forEach(E),a=Ae(u),o=te(u,"IMG",{src:!0,class:!0,alt:!0,draggable:!0}),u.forEach(E),h.forEach(E),this.h()},h(){var c;A(i,"class","sr-only"),b0(o.src,l=(c=n[16])==null?void 0:c.profile_image_url)||A(o,"src",l),A(o,"class","size-6 object-cover rounded-full"),A(o,"alt",""),A(o,"draggable","false"),A(t,"class","self-center"),A(e,"class","select-none flex rounded-xl p-1.5 w-full hover:bg-gray-50 dark:hover:bg-gray-850 transition")},m(c,h){$(c,e,h),K(e,t),K(t,i),K(i,r),K(t,a),K(t,o)},p(c,h){var u;h[0]&8192&&s!==(s=c[13].t("User menu")+"")&&Et(r,s),h[0]&65536&&!b0(o.src,l=(u=c[16])==null?void 0:u.profile_image_url)&&A(o,"src",l)},d(c){c&&E(e)}}}function JA(n){let e,t,i=n[13].t("Temporary Chat")+"",s;return{c(){e=ee("div"),t=ee("div"),s=vt(i),this.h()},l(r){e=te(r,"DIV",{class:!0});var a=q(e);t=te(a,"DIV",{class:!0});var o=q(t);s=kt(o,i),o.forEach(E),a.forEach(E),this.h()},h(){A(t,"class","text-xs text-gray-500"),A(e,"class","w-full z-30 text-center")},m(r,a){$(r,e,a),K(e,t),K(t,s)},p(r,a){a[0]&8192&&i!==(i=r[13].t("Temporary Chat")+"")&&Et(s,i)},d(r){r&&E(e)}}}function ZA(n){var c,h,u,d,f,g,m;let e,t,i,s,r,a=(((h=(c=n[18])==null?void 0:c.license_metadata)==null?void 0:h.type)??null)==="trial"&&QA(n),o=(((d=(u=n[18])==null?void 0:u.license_metadata)==null?void 0:d.seats)??null)!==null&&((f=n[18])==null?void 0:f.user_count)>((m=(g=n[18])==null?void 0:g.license_metadata)==null?void 0:m.seats)&&$A(n),l=n[6]&&eS(n);return{c(){e=ee("div"),t=ee("div"),a&&a.c(),i=Ce(),o&&o.c(),s=Ce(),l&&l.c(),this.h()},l(x){e=te(x,"DIV",{class:!0});var p=q(e);t=te(p,"DIV",{class:!0});var y=q(t);a&&a.l(y),i=Ae(y),o&&o.l(y),s=Ae(y),l&&l.l(y),y.forEach(E),p.forEach(E),this.h()},h(){A(t,"class","flex flex-col gap-1 w-full"),A(e,"class","w-full z-30 mt-5")},m(x,p){$(x,e,p),K(e,t),a&&a.m(t,null),K(t,i),o&&o.m(t,null),K(t,s),l&&l.m(t,null),r=!0},p(x,p){var y,w,_,v,C,k,I;(((w=(y=x[18])==null?void 0:y.license_metadata)==null?void 0:w.type)??null)==="trial"?a?(a.p(x,p),p[0]&262144&&U(a,1)):(a=QA(x),a.c(),U(a,1),a.m(t,i)):a&&(bt(),W(a,1,1,()=>{a=null}),xt()),(((v=(_=x[18])==null?void 0:_.license_metadata)==null?void 0:v.seats)??null)!==null&&((C=x[18])==null?void 0:C.user_count)>((I=(k=x[18])==null?void 0:k.license_metadata)==null?void 0:I.seats)?o?(o.p(x,p),p[0]&262144&&U(o,1)):(o=$A(x),o.c(),U(o,1),o.m(t,s)):o&&(bt(),W(o,1,1,()=>{o=null}),xt()),x[6]?l?(l.p(x,p),p[0]&64&&U(l,1)):(l=eS(x),l.c(),U(l,1),l.m(t,null)):l&&(bt(),W(l,1,1,()=>{l=null}),xt())},i(x){r||(U(a),U(o),U(l),r=!0)},o(x){W(a),W(o),W(l),r=!1},d(x){x&&E(e),a&&a.d(),o&&o.d(),l&&l.d()}}}function QA(n){let e,t;return e=new r4({props:{banner:{type:"info",title:"Trial License",content:n[13].t("You are currently using a trial license. Please contact support to upgrade your license.")}}}),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p(i,s){const r={};s[0]&8192&&(r.banner={type:"info",title:"Trial License",content:i[13].t("You are currently using a trial license. Please contact support to upgrade your license.")}),e.$set(r)},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function $A(n){let e,t;return e=new r4({props:{banner:{type:"error",title:"License Error",content:n[13].t("Exceeded the number of seats in your license. Please contact support to increase the number of seats.")}}}),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p(i,s){const r={};s[0]&8192&&(r.banner={type:"error",title:"License Error",content:i[13].t("Exceeded the number of seats in your license. Please contact support to increase the number of seats.")}),e.$set(r)},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function eS(n){let e,t,i=Zn(n[17].filter(n[31])),s=[];for(let a=0;a<i.length;a+=1)s[a]=tS(VA(n,i,a));const r=a=>W(s[a],1,1,()=>{s[a]=null});return{c(){for(let a=0;a<s.length;a+=1)s[a].c();e=zt()},l(a){for(let o=0;o<s.length;o+=1)s[o].l(a);e=zt()},m(a,o){for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(a,o);$(a,e,o),t=!0},p(a,o){if(o[0]&131200){i=Zn(a[17].filter(a[31]));let l;for(l=0;l<i.length;l+=1){const c=VA(a,i,l);s[l]?(s[l].p(c,o),U(s[l],1)):(s[l]=tS(c),s[l].c(),U(s[l],1),s[l].m(e.parentNode,e))}for(bt(),l=i.length;l<s.length;l+=1)r(l);xt()}},i(a){if(!t){for(let o=0;o<i.length;o+=1)U(s[o]);t=!0}},o(a){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)W(s[o]);t=!1},d(a){a&&E(e),vo(s,a)}}}function tS(n){let e,t;function i(...s){return n[32](n[34],...s)}return e=new r4({props:{banner:n[34]}}),e.$on("dismiss",i),{c(){me(e.$$.fragment)},l(s){xe(e.$$.fragment,s)},m(s,r){pe(e,s,r),t=!0},p(s,r){n=s;const a={};r[0]&131200&&(a.banner=n[34]),e.$set(a)},i(s){t||(U(e.$$.fragment,s),t=!0)},o(s){W(e.$$.fragment,s),t=!1},d(s){be(e,s)}}}function ene(n){var ye,P,V,re,X,ue,oe;let e,t,i,s,r,a,o,l,c,h,u,d,f,g,m,x,p,y,w,_,v,C,k,I,S,M,N,F,H,T,z,R;function L(Q){n[21](Q)}let Y={chatId:n[10]};n[8]!==void 0&&(Y.show=n[8]),e=new kF({props:Y}),It.push(()=>Wt(e,"show",L)),m=new PF({});let j=!n[12]&&qA(n),J=n[5]&&WA(n),G=n[2]&&n[3]&&(n[3].id||n[14])&&KA(n);I=new wi({props:{content:n[13].t("Controls"),$$slots:{default:[Zte]},$$scope:{ctx:n}}});let se=n[12]&&XA(n),de=n[16]!==void 0&&n[16]!==null&&YA(n),he=n[14]&&n[10]==="local"&&JA(n),we=!n[4].currentId&&!n[10]&&(n[17].length>0||(((P=(ye=n[18])==null?void 0:ye.license_metadata)==null?void 0:P.type)??null)==="trial"||(((re=(V=n[18])==null?void 0:V.license_metadata)==null?void 0:re.seats)??null)!==null&&((X=n[18])==null?void 0:X.user_count)>((oe=(ue=n[18])==null?void 0:ue.license_metadata)==null?void 0:oe.seats))&&ZA(n);return{c(){me(e.$$.fragment),i=Ce(),s=ee("button"),r=Ce(),a=ee("nav"),o=ee("div"),l=ee("div"),c=Ce(),h=ee("div"),u=ee("div"),d=ee("div"),f=ee("button"),g=ee("div"),me(m.$$.fragment),x=Ce(),j&&j.c(),y=Ce(),w=ee("div"),J&&J.c(),v=Ce(),C=ee("div"),G&&G.c(),k=Ce(),me(I.$$.fragment),S=Ce(),se&&se.c(),M=Ce(),de&&de.c(),N=Ce(),he&&he.c(),F=Ce(),H=ee("div"),we&&we.c(),this.h()},l(Q){xe(e.$$.fragment,Q),i=Ae(Q),s=te(Q,"BUTTON",{id:!0,class:!0,"aria-label":!0}),q(s).forEach(E),r=Ae(Q),a=te(Q,"NAV",{class:!0});var ae=q(a);o=te(ae,"DIV",{class:!0});var Ke=q(o);l=te(Ke,"DIV",{class:!0}),q(l).forEach(E),c=Ae(Ke),h=te(Ke,"DIV",{class:!0});var Ue=q(h);u=te(Ue,"DIV",{class:!0});var De=q(u);d=te(De,"DIV",{class:!0});var je=q(d);f=te(je,"BUTTON",{id:!0,class:!0,"aria-label":!0});var ze=q(f);g=te(ze,"DIV",{class:!0});var Qe=q(g);xe(m.$$.fragment,Qe),Qe.forEach(E),ze.forEach(E),x=Ae(je),j&&j.l(je),je.forEach(E),y=Ae(De),w=te(De,"DIV",{class:!0});var ft=q(w);J&&J.l(ft),ft.forEach(E),v=Ae(De),C=te(De,"DIV",{class:!0});var ut=q(C);G&&G.l(ut),k=Ae(ut),xe(I.$$.fragment,ut),S=Ae(ut),se&&se.l(ut),M=Ae(ut),de&&de.l(ut),ut.forEach(E),De.forEach(E),Ue.forEach(E),Ke.forEach(E),N=Ae(ae),he&&he.l(ae),F=Ae(ae),H=te(ae,"DIV",{class:!0});var Je=q(H);we&&we.l(Je),Je.forEach(E),ae.forEach(E),this.h()},h(){A(s,"id","new-chat-button"),A(s,"class","hidden"),A(s,"aria-label","New Chat"),A(l,"class","bg-linear-to-b via-50% from-white via-white to-transparent dark:from-gray-900 dark:via-gray-900 dark:to-transparent pointer-events-none absolute inset-0 -bottom-7 z-[-1]"),A(g,"class","m-auto self-center"),A(f,"id","sidebar-toggle-button"),A(f,"class","cursor-pointer px-2 py-2 flex rounded-xl hover:bg-gray-50 dark:hover:bg-gray-850 transition"),A(f,"aria-label","Toggle Sidebar"),A(d,"class",p=(n[11]?"md:hidden":"")+" mr-1 self-start flex flex-none items-center text-gray-600 dark:text-gray-400"),A(w,"class",_="flex-1 overflow-hidden max-w-full py-0.5 "+(n[11]?"ml-1":"")),A(C,"class","self-start flex flex-none items-center text-gray-600 dark:text-gray-400"),A(u,"class","flex items-center w-full max-w-full"),A(h,"class","flex max-w-full w-full mx-auto px-1 pt-0.5 bg-transparent"),A(o,"class","flex items-center w-full pl-1.5 pr-1"),A(H,"class","absolute top-[100%] left-0 right-0 h-fit"),A(a,"class","sticky top-0 z-30 w-full py-1 -mb-8 flex flex-col items-center drag-region")},m(Q,ae){pe(e,Q,ae),$(Q,i,ae),$(Q,s,ae),$(Q,r,ae),$(Q,a,ae),K(a,o),K(o,l),K(o,c),K(o,h),K(h,u),K(u,d),K(d,f),K(f,g),pe(m,g,null),K(d,x),j&&j.m(d,null),K(u,y),K(u,w),J&&J.m(w,null),K(u,v),K(u,C),G&&G.m(C,null),K(C,k),pe(I,C,null),K(C,S),se&&se.m(C,null),K(C,M),de&&de.m(C,null),K(a,N),he&&he.m(a,null),K(a,F),K(a,H),we&&we.m(H,null),T=!0,z||(R=[yt(s,"click",n[22]),yt(f,"click",n[23])],z=!0)},p(Q,ae){var De,je,ze,Qe,ft,ut,Je;const Ke={};ae[0]&1024&&(Ke.chatId=Q[10]),!t&&ae[0]&256&&(t=!0,Ke.show=Q[8],qt(()=>t=!1)),e.$set(Ke),Q[12]?j&&(bt(),W(j,1,1,()=>{j=null}),xt()):j?(j.p(Q,ae),ae[0]&4096&&U(j,1)):(j=qA(Q),j.c(),U(j,1),j.m(d,null)),(!T||ae[0]&2048&&p!==(p=(Q[11]?"md:hidden":"")+" mr-1 self-start flex flex-none items-center text-gray-600 dark:text-gray-400"))&&A(d,"class",p),Q[5]?J?(J.p(Q,ae),ae[0]&32&&U(J,1)):(J=WA(Q),J.c(),U(J,1),J.m(w,null)):J&&(bt(),W(J,1,1,()=>{J=null}),xt()),(!T||ae[0]&2048&&_!==(_="flex-1 overflow-hidden max-w-full py-0.5 "+(Q[11]?"ml-1":"")))&&A(w,"class",_),Q[2]&&Q[3]&&(Q[3].id||Q[14])?G?(G.p(Q,ae),ae[0]&16396&&U(G,1)):(G=KA(Q),G.c(),U(G,1),G.m(C,k)):G&&(bt(),W(G,1,1,()=>{G=null}),xt());const Ue={};ae[0]&8192&&(Ue.content=Q[13].t("Controls")),ae[0]&32768|ae[1]&64&&(Ue.$$scope={dirty:ae,ctx:Q}),I.$set(Ue),Q[12]?se?(se.p(Q,ae),ae[0]&4096&&U(se,1)):(se=XA(Q),se.c(),U(se,1),se.m(C,M)):se&&(bt(),W(se,1,1,()=>{se=null}),xt()),Q[16]!==void 0&&Q[16]!==null?de?(de.p(Q,ae),ae[0]&65536&&U(de,1)):(de=YA(Q),de.c(),U(de,1),de.m(C,null)):de&&(bt(),W(de,1,1,()=>{de=null}),xt()),Q[14]&&Q[10]==="local"?he?he.p(Q,ae):(he=JA(Q),he.c(),he.m(a,F)):he&&(he.d(1),he=null),!Q[4].currentId&&!Q[10]&&(Q[17].length>0||(((je=(De=Q[18])==null?void 0:De.license_metadata)==null?void 0:je.type)??null)==="trial"||(((Qe=(ze=Q[18])==null?void 0:ze.license_metadata)==null?void 0:Qe.seats)??null)!==null&&((ft=Q[18])==null?void 0:ft.user_count)>((Je=(ut=Q[18])==null?void 0:ut.license_metadata)==null?void 0:Je.seats))?we?(we.p(Q,ae),ae[0]&394256&&U(we,1)):(we=ZA(Q),we.c(),U(we,1),we.m(H,null)):we&&(bt(),W(we,1,1,()=>{we=null}),xt())},i(Q){T||(U(e.$$.fragment,Q),U(m.$$.fragment,Q),U(j),U(J),U(G),U(I.$$.fragment,Q),U(se),U(de),U(we),T=!0)},o(Q){W(e.$$.fragment,Q),W(m.$$.fragment,Q),W(j),W(J),W(G),W(I.$$.fragment,Q),W(se),W(de),W(we),T=!1},d(Q){Q&&(E(i),E(s),E(r),E(a)),be(e,Q),be(m),j&&j.d(),J&&J.d(),G&&G.d(),be(I),se&&se.d(),de&&de.d(),he&&he.d(),we&&we.d(),z=!1,Qr(R)}}}function tne(n,e,t){let i,s,r,a,o,l,c,h,u,d;Pe(n,OI,G=>t(33,i=G)),Pe(n,uu,G=>t(10,s=G)),Pe(n,$w,G=>t(11,r=G)),Pe(n,nx,G=>t(12,a=G)),Pe(n,Fd,G=>t(14,l=G)),Pe(n,Xi,G=>t(15,c=G)),Pe(n,k0,G=>t(16,h=G)),Pe(n,kD,G=>t(17,u=G)),Pe(n,Kg,G=>t(18,d=G));const f=as("i18n");Pe(n,f,G=>t(13,o=G));let{initNewChat:g}=e,{title:m=i}=e,{shareEnabled:x=!1}=e,{chat:p}=e,{history:y}=e,{selectedModels:w}=e,{showModelSelector:_=!0}=e,{showBanners:v=!0}=e,C=[],k=!1,I=!1;function S(G){k=G,t(8,k)}const M=()=>{g()},N=()=>{$w.set(!r)},F=()=>{g()};function H(G){w=G,t(0,w)}const T=()=>{t(8,k=!k)},z=()=>{t(9,I=!I)},R=async()=>{await Xi.set(!c)},L=()=>{g()},Y=G=>{G.detail==="archived-chat"&&CD.set(!0)},j=G=>![...JSON.parse(localStorage.getItem("dismissedBannerIds")??"[]"),...C].includes(G.id),J=(G,se)=>{const de=se.detail;G.dismissible?localStorage.setItem("dismissedBannerIds",JSON.stringify([de,...JSON.parse(localStorage.getItem("dismissedBannerIds")??"[]")].filter(he=>u.find(we=>we.id===he)))):t(7,C=[...C,de])};return n.$$set=G=>{"initNewChat"in G&&t(1,g=G.initNewChat),"title"in G&&t(20,m=G.title),"shareEnabled"in G&&t(2,x=G.shareEnabled),"chat"in G&&t(3,p=G.chat),"history"in G&&t(4,y=G.history),"selectedModels"in G&&t(0,w=G.selectedModels),"showModelSelector"in G&&t(5,_=G.showModelSelector),"showBanners"in G&&t(6,v=G.showBanners)},[w,g,x,p,y,_,v,C,k,I,s,r,a,o,l,c,h,u,d,f,m,S,M,N,F,H,T,z,R,L,Y,j,J]}class nne extends Nt{constructor(e){super(),Ot(this,e,tne,ene,Ut,{initNewChat:1,title:20,shareEnabled:2,chat:3,history:4,selectedModels:0,showModelSelector:5,showBanners:6},null,[-1,-1])}}function Ei(n){if(typeof n=="string"||typeof n=="number")return""+n;let e="";if(Array.isArray(n))for(let t=0,i;t<n.length;t++)(i=Ei(n[t]))!==""&&(e+=(e&&" ")+i);else for(let t in n)n[t]&&(e+=(e&&" ")+t);return e}const Cx={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:n=>`Node type "${n}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:n=>`The old edge with id=${n} does not exist.`,error009:n=>`Marker type "${n}" doesn't exist.`,error008:(n,{id:e,sourceHandle:t,targetHandle:i})=>`Couldn't create edge for ${n} handle id: "${n==="source"?t:i}", edge id: ${e}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:n=>`Edge type "${n}" not found. Using fallback type "default".`,error012:n=>`Node with id "${n}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(n="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${n}/dist/style.css' or base.css to make sure everything is working properly.`},r5=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]];var nf;(function(n){n.Strict="strict",n.Loose="loose"})(nf||(nf={}));var nc;(function(n){n.Free="free",n.Vertical="vertical",n.Horizontal="horizontal"})(nc||(nc={}));var a5;(function(n){n.Partial="partial",n.Full="full"})(a5||(a5={}));const X6={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null};var c1;(function(n){n.Bezier="default",n.Straight="straight",n.Step="step",n.SmoothStep="smoothstep",n.SimpleBezier="simplebezier"})(c1||(c1={}));var o5;(function(n){n.Arrow="arrow",n.ArrowClosed="arrowclosed"})(o5||(o5={}));var pn;(function(n){n.Left="left",n.Top="top",n.Right="right",n.Bottom="bottom"})(pn||(pn={}));const nS={[pn.Left]:pn.Right,[pn.Right]:pn.Left,[pn.Top]:pn.Bottom,[pn.Bottom]:pn.Top};function ine(n,e){if(!n&&!e)return!0;if(!n||!e||n.size!==e.size)return!1;if(!n.size&&!e.size)return!0;for(const t of n.keys())if(!e.has(t))return!1;return!0}function iS(n,e,t){if(!t)return;const i=[];n.forEach((s,r)=>{e!=null&&e.has(r)||i.push(s)}),i.length&&t(i)}function sS(n){return n===null?null:n?"valid":"invalid"}const sne=n=>"id"in n&&"source"in n&&"target"in n,rne=n=>"id"in n&&"position"in n&&!("source"in n)&&!("target"in n),z_=n=>"id"in n&&"internals"in n&&!("source"in n)&&!("target"in n),Ty=(n,e=[0,0])=>{const{width:t,height:i}=em(n),s=n.origin??e,r=t*s[0],a=i*s[1];return{x:n.position.x-r,y:n.position.y-a}},ane=(n,e={nodeOrigin:[0,0],nodeLookup:void 0})=>{if(n.length===0)return{x:0,y:0,width:0,height:0};const t=n.reduce((i,s)=>{const r=typeof s=="string";let a=!e.nodeLookup&&!r?s:void 0;e.nodeLookup&&(a=r?e.nodeLookup.get(s):z_(s)?s:e.nodeLookup.get(s.id));const o=a?l5(a,e.nodeOrigin):{x:0,y:0,x2:0,y2:0};return My(i,o)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return Py(t)},Ry=(n,e={})=>{if(n.size===0)return{x:0,y:0,width:0,height:0};let t={x:1/0,y:1/0,x2:-1/0,y2:-1/0};return n.forEach(i=>{if(e.filter===void 0||e.filter(i)){const s=l5(i);t=My(t,s)}}),Py(t)},yO=(n,e,[t,i,s]=[0,0,1],r=!1,a=!1)=>{const o={...Ax(e,[t,i,s]),width:e.width/s,height:e.height/s},l=[];for(const c of n.values()){const{measured:h,selectable:u=!0,hidden:d=!1}=c;if(a&&!u||d)continue;const f=h.width??c.width??c.initialWidth??null,g=h.height??c.height??c.initialHeight??null,m=r2(o,jg(c)),x=(f??0)*(g??0),p=r&&m>0;(!c.internals.handleBounds||p||m>=x||c.dragging)&&l.push(c)}return l},Y6=(n,e)=>{const t=new Set;return n.forEach(i=>{t.add(i.id)}),e.filter(i=>t.has(i.source)||t.has(i.target))};function rS(n,e){const t=new Map,i=e!=null&&e.nodes?new Set(e.nodes.map(s=>s.id)):null;return n.forEach(s=>{s.measured.width&&s.measured.height&&((e==null?void 0:e.includeHiddenNodes)||!s.hidden)&&(!i||i.has(s.id))&&t.set(s.id,s)}),t}async function aS({nodes:n,width:e,height:t,panZoom:i,minZoom:s,maxZoom:r},a){if(n.size===0)return Promise.resolve(!1);const o=Ry(n),l=G_(o,e,t,(a==null?void 0:a.minZoom)??s,(a==null?void 0:a.maxZoom)??r,(a==null?void 0:a.padding)??.1);return await i.setViewport(l,{duration:a==null?void 0:a.duration}),Promise.resolve(!0)}function one({nodeId:n,nextPosition:e,nodeLookup:t,nodeOrigin:i=[0,0],nodeExtent:s,onError:r}){const a=t.get(n),o=a.parentId?t.get(a.parentId):void 0,{x:l,y:c}=o?o.internals.positionAbsolute:{x:0,y:0},h=a.origin??i;let u=s;if(a.extent==="parent"&&!a.expandParent)if(!o)r==null||r("005",Cx.error005());else{const f=o.measured.width,g=o.measured.height;f&&g&&(u=[[l,c],[l+f,c+g]])}else o&&a2(a.extent)&&(u=[[a.extent[0][0]+l,a.extent[0][1]+c],[a.extent[1][0]+l,a.extent[1][1]+c]]);const d=a2(u)?zg(e,u,a.measured):e;return{position:{x:d.x-l+a.measured.width*h[0],y:d.y-c+a.measured.height*h[1]},positionAbsolute:d}}async function wO({nodesToRemove:n=[],edgesToRemove:e=[],nodes:t,edges:i,onBeforeDelete:s}){const r=new Set(n.map(d=>d.id)),a=[];for(const d of t){if(d.deletable===!1)continue;const f=r.has(d.id),g=!f&&d.parentId&&a.find(m=>m.id===d.parentId);(f||g)&&a.push(d)}const o=new Set(e.map(d=>d.id)),l=i.filter(d=>d.deletable!==!1),h=Y6(a,l);for(const d of l)o.has(d.id)&&!h.find(g=>g.id===d.id)&&h.push(d);if(!s)return{edges:h,nodes:a};const u=await s({nodes:a,edges:h});return typeof u=="boolean"?u?{edges:h,nodes:a}:{edges:[],nodes:[]}:u}const Hg=(n,e=0,t=1)=>Math.min(Math.max(n,e),t),zg=(n={x:0,y:0},e,t)=>({x:Hg(n.x,e[0][0],e[1][0]-((t==null?void 0:t.width)??0)),y:Hg(n.y,e[0][1],e[1][1]-((t==null?void 0:t.height)??0))});function _O(n,e,t){const{width:i,height:s}=em(t),{x:r,y:a}=t.internals.positionAbsolute;return zg(n,[[r,a],[r+i,a+s]],e)}const oS=(n,e,t)=>n<e?Hg(Math.abs(n-e),1,e)/e:n>t?-Hg(Math.abs(n-t),1,e)/e:0,vO=(n,e,t=15,i=40)=>{const s=oS(n.x,i,e.width-i)*t,r=oS(n.y,i,e.height-i)*t;return[s,r]},My=(n,e)=>({x:Math.min(n.x,e.x),y:Math.min(n.y,e.y),x2:Math.max(n.x2,e.x2),y2:Math.max(n.y2,e.y2)}),J6=({x:n,y:e,width:t,height:i})=>({x:n,y:e,x2:n+t,y2:e+i}),Py=({x:n,y:e,x2:t,y2:i})=>({x:n,y:e,width:t-n,height:i-e}),jg=(n,e=[0,0])=>{var s,r;const{x:t,y:i}=z_(n)?n.internals.positionAbsolute:Ty(n,e);return{x:t,y:i,width:((s=n.measured)==null?void 0:s.width)??n.width??n.initialWidth??0,height:((r=n.measured)==null?void 0:r.height)??n.height??n.initialHeight??0}},l5=(n,e=[0,0])=>{var s,r;const{x:t,y:i}=z_(n)?n.internals.positionAbsolute:Ty(n,e);return{x:t,y:i,x2:t+(((s=n.measured)==null?void 0:s.width)??n.width??n.initialWidth??0),y2:i+(((r=n.measured)==null?void 0:r.height)??n.height??n.initialHeight??0)}},lne=(n,e)=>Py(My(J6(n),J6(e))),r2=(n,e)=>{const t=Math.max(0,Math.min(n.x+n.width,e.x+e.width)-Math.max(n.x,e.x)),i=Math.max(0,Math.min(n.y+n.height,e.y+e.height)-Math.max(n.y,e.y));return Math.ceil(t*i)},lS=n=>Zo(n.width)&&Zo(n.height)&&Zo(n.x)&&Zo(n.y),Zo=n=>!isNaN(n)&&isFinite(n),cne=(n,e)=>{},j_=(n,e=[1,1])=>({x:e[0]*Math.round(n.x/e[0]),y:e[1]*Math.round(n.y/e[1])}),Ax=({x:n,y:e},[t,i,s],r=!1,a=[1,1])=>{const o={x:(n-t)/s,y:(e-i)/s};return r?j_(o,a):o},kO=({x:n,y:e},[t,i,s])=>({x:n*s+t,y:e*s+i}),G_=(n,e,t,i,s,r)=>{const a=e/(n.width*(1+r)),o=t/(n.height*(1+r)),l=Math.min(a,o),c=Hg(l,i,s),h=n.x+n.width/2,u=n.y+n.height/2,d=e/2-h*c,f=t/2-u*c;return{x:d,y:f,zoom:c}},c5=()=>{var n;return typeof navigator<"u"&&((n=navigator==null?void 0:navigator.userAgent)==null?void 0:n.indexOf("Mac"))>=0};function a2(n){return n!==void 0&&n!=="parent"}function em(n){var e,t;return{width:((e=n.measured)==null?void 0:e.width)??n.width??n.initialWidth??0,height:((t=n.measured)==null?void 0:t.height)??n.height??n.initialHeight??0}}function cS(n){var e,t;return(((e=n.measured)==null?void 0:e.width)??n.width??n.initialWidth)!==void 0&&(((t=n.measured)==null?void 0:t.height)??n.height??n.initialHeight)!==void 0}function hne(n,e={width:0,height:0},t,i,s){let r=t;const a={...n};for(;r;){const o=i.get(r);if(r=o==null?void 0:o.parentId,o){const l=o.origin||s;a.x+=o.internals.positionAbsolute.x-(e.width??0)*l[0],a.y+=o.internals.positionAbsolute.y-(e.height??0)*l[1]}}return a}function Ww(n,{snapGrid:e=[0,0],snapToGrid:t=!1,transform:i}){const{x:s,y:r}=d0(n),a=Ax({x:s,y:r},i),{x:o,y:l}=t?j_(a,e):a;return{xSnapped:o,ySnapped:l,...a}}const CO=n=>({width:n.offsetWidth,height:n.offsetHeight}),une=n=>{var e;return((e=n.getRootNode)==null?void 0:e.call(n))||(window==null?void 0:window.document)},dne=["INPUT","SELECT","TEXTAREA"];function fne(n){var i,s;const e=((s=(i=n.composedPath)==null?void 0:i.call(n))==null?void 0:s[0])||n.target;return dne.includes(e==null?void 0:e.nodeName)||(e==null?void 0:e.hasAttribute("contenteditable"))||!!(e!=null&&e.closest(".nokey"))}const AO=n=>"clientX"in n,d0=(n,e)=>{var r,a;const t=AO(n),i=t?n.clientX:(r=n.touches)==null?void 0:r[0].clientX,s=t?n.clientY:(a=n.touches)==null?void 0:a[0].clientY;return{x:i-((e==null?void 0:e.left)??0),y:s-((e==null?void 0:e.top)??0)}},hS=(n,e,t,i,s)=>{const r=e.querySelectorAll(`.${n}`);return!r||!r.length?null:Array.from(r).map(a=>{const o=a.getBoundingClientRect();return{id:a.getAttribute("data-handleid"),type:n,nodeId:s,position:a.getAttribute("data-handlepos"),x:(o.left-t.left)/i,y:(o.top-t.top)/i,...CO(a)}})};function gne({sourceX:n,sourceY:e,targetX:t,targetY:i,sourceControlX:s,sourceControlY:r,targetControlX:a,targetControlY:o}){const l=n*.125+s*.375+a*.375+t*.125,c=e*.125+r*.375+o*.375+i*.125,h=Math.abs(l-n),u=Math.abs(c-e);return[l,c,h,u]}function p9(n,e){return n>=0?.5*n:e*25*Math.sqrt(-n)}function uS({pos:n,x1:e,y1:t,x2:i,y2:s,c:r}){switch(n){case pn.Left:return[e-p9(e-i,r),t];case pn.Right:return[e+p9(i-e,r),t];case pn.Top:return[e,t-p9(t-s,r)];case pn.Bottom:return[e,t+p9(s-t,r)]}}function SO({sourceX:n,sourceY:e,sourcePosition:t=pn.Bottom,targetX:i,targetY:s,targetPosition:r=pn.Top,curvature:a=.25}){const[o,l]=uS({pos:t,x1:n,y1:e,x2:i,y2:s,c:a}),[c,h]=uS({pos:r,x1:i,y1:s,x2:n,y2:e,c:a}),[u,d,f,g]=gne({sourceX:n,sourceY:e,targetX:i,targetY:s,sourceControlX:o,sourceControlY:l,targetControlX:c,targetControlY:h});return[`M${n},${e} C${o},${l} ${c},${h} ${i},${s}`,u,d,f,g]}function IO({sourceX:n,sourceY:e,targetX:t,targetY:i}){const s=Math.abs(t-n)/2,r=t<n?t+s:t-s,a=Math.abs(i-e)/2,o=i<e?i+a:i-a;return[r,o,s,a]}function mne({sourceNode:n,targetNode:e,selected:t=!1,zIndex:i=0,elevateOnSelect:s=!1}){if(!s)return i;const r=t||e.selected||n.selected,a=Math.max(n.internals.z||0,e.internals.z||0,1e3);return i+(r?a:0)}function pne({sourceNode:n,targetNode:e,width:t,height:i,transform:s}){const r=My(l5(n),l5(e));r.x===r.x2&&(r.x2+=1),r.y===r.y2&&(r.y2+=1);const a={x:-s[0]/s[2],y:-s[1]/s[2],width:t/s[2],height:i/s[2]};return r2(a,Py(r))>0}const bne=({source:n,sourceHandle:e,target:t,targetHandle:i})=>`xy-edge__${n}${e||""}-${t}${i||""}`,xne=(n,e)=>e.some(t=>t.source===n.source&&t.target===n.target&&(t.sourceHandle===n.sourceHandle||!t.sourceHandle&&!n.sourceHandle)&&(t.targetHandle===n.targetHandle||!t.targetHandle&&!n.targetHandle)),yne=(n,e)=>{if(!n.source||!n.target)return e;let t;return sne(n)?t={...n}:t={...n,id:bne(n)},xne(t,e)?e:(t.sourceHandle===null&&delete t.sourceHandle,t.targetHandle===null&&delete t.targetHandle,e.concat(t))};function EO({sourceX:n,sourceY:e,targetX:t,targetY:i}){const[s,r,a,o]=IO({sourceX:n,sourceY:e,targetX:t,targetY:i});return[`M ${n},${e}L ${t},${i}`,s,r,a,o]}const dS={[pn.Left]:{x:-1,y:0},[pn.Right]:{x:1,y:0},[pn.Top]:{x:0,y:-1},[pn.Bottom]:{x:0,y:1}},wne=({source:n,sourcePosition:e=pn.Bottom,target:t})=>e===pn.Left||e===pn.Right?n.x<t.x?{x:1,y:0}:{x:-1,y:0}:n.y<t.y?{x:0,y:1}:{x:0,y:-1},fS=(n,e)=>Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2));function _ne({source:n,sourcePosition:e=pn.Bottom,target:t,targetPosition:i=pn.Top,center:s,offset:r}){const a=dS[e],o=dS[i],l={x:n.x+a.x*r,y:n.y+a.y*r},c={x:t.x+o.x*r,y:t.y+o.y*r},h=wne({source:l,sourcePosition:e,target:c}),u=h.x!==0?"x":"y",d=h[u];let f=[],g,m;const x={x:0,y:0},p={x:0,y:0},[y,w,_,v]=IO({sourceX:n.x,sourceY:n.y,targetX:t.x,targetY:t.y});if(a[u]*o[u]===-1){g=s.x??y,m=s.y??w;const k=[{x:g,y:l.y},{x:g,y:c.y}],I=[{x:l.x,y:m},{x:c.x,y:m}];a[u]===d?f=u==="x"?k:I:f=u==="x"?I:k}else{const k=[{x:l.x,y:c.y}],I=[{x:c.x,y:l.y}];if(u==="x"?f=a.x===d?I:k:f=a.y===d?k:I,e===i){const H=Math.abs(n[u]-t[u]);if(H<=r){const T=Math.min(r-1,r-H);a[u]===d?x[u]=(l[u]>n[u]?-1:1)*T:p[u]=(c[u]>t[u]?-1:1)*T}}if(e!==i){const H=u==="x"?"y":"x",T=a[u]===o[H],z=l[H]>c[H],R=l[H]<c[H];(a[u]===1&&(!T&&z||T&&R)||a[u]!==1&&(!T&&R||T&&z))&&(f=u==="x"?k:I)}const S={x:l.x+x.x,y:l.y+x.y},M={x:c.x+p.x,y:c.y+p.y},N=Math.max(Math.abs(S.x-f[0].x),Math.abs(M.x-f[0].x)),F=Math.max(Math.abs(S.y-f[0].y),Math.abs(M.y-f[0].y));N>=F?(g=(S.x+M.x)/2,m=f[0].y):(g=f[0].x,m=(S.y+M.y)/2)}return[[n,{x:l.x+x.x,y:l.y+x.y},...f,{x:c.x+p.x,y:c.y+p.y},t],g,m,_,v]}function vne(n,e,t,i){const s=Math.min(fS(n,e)/2,fS(e,t)/2,i),{x:r,y:a}=e;if(n.x===r&&r===t.x||n.y===a&&a===t.y)return`L${r} ${a}`;if(n.y===a){const c=n.x<t.x?-1:1,h=n.y<t.y?1:-1;return`L ${r+s*c},${a}Q ${r},${a} ${r},${a+s*h}`}const o=n.x<t.x?1:-1,l=n.y<t.y?-1:1;return`L ${r},${a+s*l}Q ${r},${a} ${r+s*o},${a}`}function h5({sourceX:n,sourceY:e,sourcePosition:t=pn.Bottom,targetX:i,targetY:s,targetPosition:r=pn.Top,borderRadius:a=5,centerX:o,centerY:l,offset:c=20}){const[h,u,d,f,g]=_ne({source:{x:n,y:e},sourcePosition:t,target:{x:i,y:s},targetPosition:r,center:{x:o,y:l},offset:c});return[h.reduce((x,p,y)=>{let w="";return y>0&&y<h.length-1?w=vne(h[y-1],p,h[y+1],a):w=`${y===0?"M":"L"}${p.x} ${p.y}`,x+=w,x},""),u,d,f,g]}function gS(n){var e;return n&&!!(n.internals.handleBounds||(e=n.handles)!=null&&e.length)&&!!(n.measured.width||n.width||n.initialWidth)}function kne(n){var u;const{sourceNode:e,targetNode:t}=n;if(!gS(e)||!gS(t))return null;const i=e.internals.handleBounds||mS(e.handles),s=t.internals.handleBounds||mS(t.handles),r=pS((i==null?void 0:i.source)??[],n.sourceHandle),a=pS(n.connectionMode===nf.Strict?(s==null?void 0:s.target)??[]:((s==null?void 0:s.target)??[]).concat((s==null?void 0:s.source)??[]),n.targetHandle);if(!r||!a)return(u=n.onError)==null||u.call(n,"008",Cx.error008(r?"target":"source",{id:n.id,sourceHandle:n.sourceHandle,targetHandle:n.targetHandle})),null;const o=(r==null?void 0:r.position)||pn.Bottom,l=(a==null?void 0:a.position)||pn.Top,c=o2(e,r,o),h=o2(t,a,l);return{sourceX:c.x,sourceY:c.y,targetX:h.x,targetY:h.y,sourcePosition:o,targetPosition:l}}function mS(n){if(!n)return null;const e=[],t=[];for(const i of n)i.width=i.width??1,i.height=i.height??1,i.type==="source"?e.push(i):i.type==="target"&&t.push(i);return{source:e,target:t}}function o2(n,e,t=pn.Left,i=!1){const s=((e==null?void 0:e.x)??0)+n.internals.positionAbsolute.x,r=((e==null?void 0:e.y)??0)+n.internals.positionAbsolute.y,{width:a,height:o}=e??em(n);if(i)return{x:s+a/2,y:r+o/2};switch((e==null?void 0:e.position)??t){case pn.Top:return{x:s+a/2,y:r};case pn.Right:return{x:s+a,y:r+o/2};case pn.Bottom:return{x:s+a/2,y:r+o};case pn.Left:return{x:s,y:r+o/2}}}function pS(n,e){return n&&(e?n.find(t=>t.id===e):n[0])||null}function Z6(n,e){return n?typeof n=="string"?n:`${e?`${e}__`:""}${Object.keys(n).sort().map(i=>`${i}=${n[i]}`).join("&")}`:""}function Cne(n,{id:e,defaultColor:t,defaultMarkerStart:i,defaultMarkerEnd:s}){const r=new Set;return n.reduce((a,o)=>([o.markerStart||i,o.markerEnd||s].forEach(l=>{if(l&&typeof l=="object"){const c=Z6(l,e);r.has(c)||(a.push({id:c,color:l.color||t,...l}),r.add(c))}}),a),[]).sort((a,o)=>a.id.localeCompare(o.id))}const TO={nodeOrigin:[0,0],nodeExtent:r5,elevateNodesOnSelect:!0,defaults:{}},Ane={...TO,checkEquality:!0};function RO(n,e){const t={...n};for(const i in e)e[i]!==void 0&&(t[i]=e[i]);return t}function MO(n,e,t,i){var o,l;const s=RO(Ane,i),r=new Map(e),a=s!=null&&s.elevateNodesOnSelect?1e3:0;e.clear(),t.clear();for(const c of n){let h=r.get(c.id);if(s.checkEquality&&c===(h==null?void 0:h.internals.userNode))e.set(c.id,h);else{const u=Ty(c,s.nodeOrigin),d=a2(c.extent)?c.extent:s.nodeExtent,f=zg(u,d,em(c));h={...s.defaults,...c,measured:{width:(o=c.measured)==null?void 0:o.width,height:(l=c.measured)==null?void 0:l.height},internals:{positionAbsolute:f,handleBounds:c.measured?h==null?void 0:h.internals.handleBounds:void 0,z:NO(c,a),userNode:c}},e.set(c.id,h)}c.parentId&&PO(h,e,t,i)}}function Sne(n,e){if(!n.parentId)return;const t=e.get(n.parentId);t?t.set(n.id,n):e.set(n.parentId,new Map([[n.id,n]]))}function PO(n,e,t,i){const{elevateNodesOnSelect:s,nodeOrigin:r,nodeExtent:a}=RO(TO,i),o=n.parentId,l=e.get(o);if(!l){console.warn(`Parent node ${o} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}Sne(n,t);const c=s?1e3:0,{x:h,y:u,z:d}=Ine(n,l,r,a,c),{positionAbsolute:f}=n.internals,g=h!==f.x||u!==f.y;(g||d!==n.internals.z)&&(n.internals={...n.internals,positionAbsolute:g?{x:h,y:u}:f,z:d})}function NO(n,e){return(Zo(n.zIndex)?n.zIndex:0)+(n.selected?e:0)}function Ine(n,e,t,i,s){const{x:r,y:a}=e.internals.positionAbsolute,o=em(n),l=Ty(n,t),c=a2(n.extent)?zg(l,n.extent,o):l;let h=zg({x:r+c.x,y:a+c.y},i,o);n.extent==="parent"&&(h=_O(h,o,e));const u=NO(n,s),d=e.internals.z??0;return{x:h.x,y:h.y,z:d>u?d:u}}function Ene(n,e,t,i=[0,0]){var a;const s=[],r=new Map;for(const o of n){const l=e.get(o.parentId);if(!l)continue;const c=((a=r.get(o.parentId))==null?void 0:a.expandedRect)??jg(l),h=lne(c,o.rect);r.set(o.parentId,{expandedRect:h,parent:l})}return r.size>0&&r.forEach(({expandedRect:o,parent:l},c)=>{var w;const h=l.internals.positionAbsolute,u=em(l),d=l.origin??i,f=o.x<h.x?Math.round(Math.abs(h.x-o.x)):0,g=o.y<h.y?Math.round(Math.abs(h.y-o.y)):0,m=Math.max(u.width,Math.round(o.width)),x=Math.max(u.height,Math.round(o.height)),p=(m-u.width)*d[0],y=(x-u.height)*d[1];(f>0||g>0||p||y)&&(s.push({id:c,type:"position",position:{x:l.position.x-f+p,y:l.position.y-g+y}}),(w=t.get(c))==null||w.forEach(_=>{n.some(v=>v.id===_.id)||s.push({id:_.id,type:"position",position:{x:_.position.x+f,y:_.position.y+g}})})),(u.width<o.width||u.height<o.height||f||g)&&s.push({id:c,type:"dimensions",setAttributes:!0,dimensions:{width:m+(f?d[0]*f-p:0),height:x+(g?d[1]*g-y:0)}})}),s}function Tne(n,e,t,i,s,r){const a=i==null?void 0:i.querySelector(".xyflow__viewport");let o=!1;if(!a)return{changes:[],updatedInternals:o};const l=[],c=window.getComputedStyle(a),{m22:h}=new window.DOMMatrixReadOnly(c.transform),u=[];for(const d of n.values()){const f=e.get(d.id);if(f)if(f.hidden)f.internals={...f.internals,handleBounds:void 0},o=!0;else{const g=CO(d.nodeElement),m=f.measured.width!==g.width||f.measured.height!==g.height;if(!!(g.width&&g.height&&(m||!f.internals.handleBounds||d.force))){const p=d.nodeElement.getBoundingClientRect(),y=a2(f.extent)?f.extent:r;let{positionAbsolute:w}=f.internals;f.parentId&&f.extent==="parent"?w=_O(w,g,e.get(f.parentId)):y&&(w=zg(w,y,g)),f.measured=g,f.internals={...f.internals,positionAbsolute:w,handleBounds:{source:hS("source",d.nodeElement,p,h,f.id),target:hS("target",d.nodeElement,p,h,f.id)}},f.parentId&&PO(f,e,t,{nodeOrigin:s}),o=!0,m&&(l.push({id:f.id,type:"dimensions",dimensions:g}),f.expandParent&&f.parentId&&u.push({id:f.id,parentId:f.parentId,rect:jg(f,s)}))}}}if(u.length>0){const d=Ene(u,e,t,s);l.push(...d)}return{changes:l,updatedInternals:o}}async function Rne({delta:n,panZoom:e,transform:t,translateExtent:i,width:s,height:r}){if(!e||!n.x&&!n.y)return Promise.resolve(!1);const a=await e.setViewportConstrained({x:t[0]+n.x,y:t[1]+n.y,zoom:t[2]},[[0,0],[s,r]],i),o=!!a&&(a.x!==t[0]||a.y!==t[1]||a.k!==t[2]);return Promise.resolve(o)}function OO(n,e,t){n.clear(),e.clear();for(const i of t){const{source:s,target:r,sourceHandle:a=null,targetHandle:o=null}=i,l=`${s}-source-${a}`,c=`${r}-target-${o}`,h=n.get(l)||new Map,u=n.get(c)||new Map,d={edgeId:i.id,source:s,target:r,sourceHandle:a,targetHandle:o};e.set(i.id,i),n.set(l,h.set(`${r}-${o}`,d)),n.set(c,u.set(`${s}-${a}`,d))}}function DO(n,e){if(!n.parentId)return!1;const t=e.get(n.parentId);return t?t.selected?!0:DO(t,e):!1}function bS(n,e,t){let i=n;do{if(i!=null&&i.matches(e))return!0;if(i===t)return!1;i=i.parentElement}while(i);return!1}function Mne(n,e,t,i){const s=new Map;for(const[r,a]of n)if((a.selected||a.id===i)&&(!a.parentId||!DO(a,n))&&(a.draggable||e&&typeof a.draggable>"u")){const o=n.get(r);o&&s.set(r,{id:r,position:o.position||{x:0,y:0},distance:{x:t.x-o.internals.positionAbsolute.x,y:t.y-o.internals.positionAbsolute.y},extent:o.extent,parentId:o.parentId,origin:o.origin,expandParent:o.expandParent,internals:{positionAbsolute:o.internals.positionAbsolute||{x:0,y:0}},measured:{width:o.measured.width??0,height:o.measured.height??0}})}return s}function Kw({nodeId:n,dragItems:e,nodeLookup:t,dragging:i=!0}){var a,o;const s=[];for(const[l,c]of e){const h=(a=t.get(l))==null?void 0:a.internals.userNode;h&&s.push({...h,position:c.position,dragging:i})}if(!n)return[s[0],s];const r=t.get(n).internals.userNode;return[{...r,position:((o=e.get(n))==null?void 0:o.position)||r.position,dragging:i},s]}function Pne({onNodeMouseDown:n,getStoreItems:e,onDragStart:t,onDrag:i,onDragStop:s}){let r={x:null,y:null},a=0,o=new Map,l=!1,c={x:0,y:0},h=null,u=!1,d=null,f=!1;function g({noDragClassName:x,handleSelector:p,domNode:y,isSelectable:w,nodeId:_,nodeClickDistance:v=0}){d=Ko(y);function C({x:M,y:N},F){const{nodeLookup:H,nodeExtent:T,snapGrid:z,snapToGrid:R,nodeOrigin:L,onNodeDrag:Y,onSelectionDrag:j,onError:J,updateNodePositions:G}=e();r={x:M,y:N};let se=!1,de={x:0,y:0,x2:0,y2:0};if(o.size>1&&T){const he=Ry(o);de=J6(he)}for(const[he,we]of o){let ye={x:M-we.distance.x,y:N-we.distance.y};R&&(ye=j_(ye,z));let P=[[T[0][0],T[0][1]],[T[1][0],T[1][1]]];if(o.size>1&&T&&!we.extent){const{positionAbsolute:X}=we.internals,ue=X.x-de.x+T[0][0],oe=X.x+we.measured.width-de.x2+T[1][0],Q=X.y-de.y+T[0][1],ae=X.y+we.measured.height-de.y2+T[1][1];P=[[ue,Q],[oe,ae]]}const{position:V,positionAbsolute:re}=one({nodeId:he,nextPosition:ye,nodeLookup:H,nodeExtent:P,nodeOrigin:L,onError:J});se=se||we.position.x!==V.x||we.position.y!==V.y,we.position=V,we.internals.positionAbsolute=re}if(se&&(G(o,!0),F&&(i||Y||!_&&j))){const[he,we]=Kw({nodeId:_,dragItems:o,nodeLookup:H});i==null||i(F,o,he,we),Y==null||Y(F,he,we),_||j==null||j(F,we)}}async function k(){if(!h)return;const{transform:M,panBy:N,autoPanSpeed:F}=e(),[H,T]=vO(c,h,F);(H!==0||T!==0)&&(r.x=(r.x??0)-H/M[2],r.y=(r.y??0)-T/M[2],await N({x:H,y:T})&&C(r,null)),a=requestAnimationFrame(k)}function I(M){var se;const{nodeLookup:N,multiSelectionActive:F,nodesDraggable:H,transform:T,snapGrid:z,snapToGrid:R,selectNodesOnDrag:L,onNodeDragStart:Y,onSelectionDragStart:j,unselectNodesAndEdges:J}=e();u=!0,(!L||!w)&&!F&&_&&((se=N.get(_))!=null&&se.selected||J()),w&&L&&_&&(n==null||n(_));const G=Ww(M.sourceEvent,{transform:T,snapGrid:z,snapToGrid:R});if(r=G,o=Mne(N,H,G,_),o.size>0&&(t||Y||!_&&j)){const[de,he]=Kw({nodeId:_,dragItems:o,nodeLookup:N});t==null||t(M.sourceEvent,o,de,he),Y==null||Y(M.sourceEvent,de,he),_||j==null||j(M.sourceEvent,he)}}const S=QF().clickDistance(v).on("start",M=>{const{domNode:N,nodeDragThreshold:F,transform:H,snapGrid:T,snapToGrid:z}=e();f=!1,F===0&&I(M),r=Ww(M.sourceEvent,{transform:H,snapGrid:T,snapToGrid:z}),h=(N==null?void 0:N.getBoundingClientRect())||null,c=d0(M.sourceEvent,h)}).on("drag",M=>{const{autoPanOnNodeDrag:N,transform:F,snapGrid:H,snapToGrid:T,nodeDragThreshold:z}=e(),R=Ww(M.sourceEvent,{transform:F,snapGrid:H,snapToGrid:T});if(M.sourceEvent.type==="touchmove"&&M.sourceEvent.touches.length>1&&(f=!0),!f){if(!l&&N&&u&&(l=!0,k()),!u){const L=R.xSnapped-(r.x??0),Y=R.ySnapped-(r.y??0);Math.sqrt(L*L+Y*Y)>z&&I(M)}(r.x!==R.xSnapped||r.y!==R.ySnapped)&&o&&u&&(c=d0(M.sourceEvent,h),C(R,M.sourceEvent))}}).on("end",M=>{if(!(!u||f)&&(l=!1,u=!1,cancelAnimationFrame(a),o.size>0)){const{nodeLookup:N,updateNodePositions:F,onNodeDragStop:H,onSelectionDragStop:T}=e();if(F(o,!1),s||H||!_&&T){const[z,R]=Kw({nodeId:_,dragItems:o,nodeLookup:N,dragging:!1});s==null||s(M.sourceEvent,o,z,R),H==null||H(M.sourceEvent,z,R),_||T==null||T(M.sourceEvent,R)}}}).filter(M=>{const N=M.target;return!M.button&&(!x||!bS(N,`.${x}`,y))&&(!p||bS(N,p,y))});d.call(S)}function m(){d==null||d.on(".drag",null)}return{update:g,destroy:m}}function Nne(n,e,t){const i=[],s={x:n.x-t,y:n.y-t,width:t*2,height:t*2};for(const r of e.values())r2(s,jg(r))>0&&i.push(r);return i}const One=250;function Dne(n,e,t,i){var o,l;let s=[],r=1/0;const a=Nne(n,t,e+One);for(const c of a){const h=[...((o=c.internals.handleBounds)==null?void 0:o.source)??[],...((l=c.internals.handleBounds)==null?void 0:l.target)??[]];for(const u of h){if(i.nodeId===u.nodeId&&i.type===u.type&&i.id===u.id)continue;const{x:d,y:f}=o2(c,u,u.position,!0),g=Math.sqrt(Math.pow(d-n.x,2)+Math.pow(f-n.y,2));g>e||(g<r?(s=[{...u,x:d,y:f}],r=g):g===r&&s.push({...u,x:d,y:f}))}}if(!s.length)return null;if(s.length>1){const c=i.type==="source"?"target":"source";return s.find(h=>h.type===c)??s[0]}return s[0]}function FO(n,e,t,i,s,r=!1){var c,h,u;const a=i.get(n);if(!a)return null;const o=s==="strict"?(c=a.internals.handleBounds)==null?void 0:c[e]:[...((h=a.internals.handleBounds)==null?void 0:h.source)??[],...((u=a.internals.handleBounds)==null?void 0:u.target)??[]],l=(t?o==null?void 0:o.find(d=>d.id===t):o==null?void 0:o[0])??null;return l&&r?{...l,...o2(a,l,l.position,!0)}:l}function LO(n,e){return n||(e!=null&&e.classList.contains("target")?"target":e!=null&&e.classList.contains("source")?"source":null)}function Fne(n,e){let t=null;return e?t=!0:n&&!e&&(t=!1),t}const BO=()=>!0;function Lne(n,{connectionMode:e,connectionRadius:t,handleId:i,nodeId:s,edgeUpdaterType:r,isTarget:a,domNode:o,nodeLookup:l,lib:c,autoPanOnConnect:h,flowId:u,panBy:d,cancelConnection:f,onConnectStart:g,onConnect:m,onConnectEnd:x,isValidConnection:p=BO,onReconnectEnd:y,updateConnection:w,getTransform:_,getFromHandle:v,autoPanSpeed:C}){const k=une(n.target);let I=0,S;const{x:M,y:N}=d0(n),F=k==null?void 0:k.elementFromPoint(M,N),H=LO(r,F),T=o==null?void 0:o.getBoundingClientRect();if(!T||!H)return;const z=FO(s,H,i,l,e);if(!z)return;let R=d0(n,T),L=!1,Y=null,j=!1,J=null;function G(){if(!h||!T)return;const[re,X]=vO(R,T,C);d({x:re,y:X}),I=requestAnimationFrame(G)}const se={...z,nodeId:s,type:H,position:z.position},de=l.get(s),we={inProgress:!0,isValid:null,from:o2(de,se,pn.Left,!0),fromHandle:se,fromPosition:se.position,fromNode:de,to:R,toHandle:null,toPosition:nS[se.position],toNode:null};w(we);let ye=we;g==null||g(n,{nodeId:s,handleId:i,handleType:H});function P(re){if(!v()||!se){V(re);return}const X=_();R=d0(re,T),S=Dne(Ax(R,X,!1,[1,1]),t,l,se),L||(G(),L=!0);const ue=UO(re,{handle:S,connectionMode:e,fromNodeId:s,fromHandleId:i,fromType:a?"target":"source",isValidConnection:p,doc:k,lib:c,flowId:u,nodeLookup:l});J=ue.handleDomNode,Y=ue.connection,j=Fne(!!S,ue.isValid);const oe={...ye,isValid:j,to:S&&j?kO({x:S.x,y:S.y},X):R,toHandle:ue.toHandle,toPosition:j&&ue.toHandle?ue.toHandle.position:nS[se.position],toNode:ue.toHandle?l.get(ue.toHandle.nodeId):null};j&&S&&ye.toHandle&&oe.toHandle&&ye.toHandle.type===oe.toHandle.type&&ye.toHandle.nodeId===oe.toHandle.nodeId&&ye.toHandle.id===oe.toHandle.id&&ye.to.x===oe.to.x&&ye.to.y===oe.to.y||(w(oe),ye=oe)}function V(re){(S||J)&&Y&&j&&(m==null||m(Y));const{inProgress:X,...ue}=ye,oe={...ue,toPosition:ye.toHandle?ye.toPosition:null};x==null||x(re,oe),r&&(y==null||y(re,oe)),f(),cancelAnimationFrame(I),L=!1,j=!1,Y=null,J=null,k.removeEventListener("mousemove",P),k.removeEventListener("mouseup",V),k.removeEventListener("touchmove",P),k.removeEventListener("touchend",V)}k.addEventListener("mousemove",P),k.addEventListener("mouseup",V),k.addEventListener("touchmove",P),k.addEventListener("touchend",V)}function UO(n,{handle:e,connectionMode:t,fromNodeId:i,fromHandleId:s,fromType:r,doc:a,lib:o,flowId:l,isValidConnection:c=BO,nodeLookup:h}){const u=r==="target",d=e?a.querySelector(`.${o}-flow__handle[data-id="${l}-${e==null?void 0:e.nodeId}-${e==null?void 0:e.id}-${e==null?void 0:e.type}"]`):null,{x:f,y:g}=d0(n),m=a.elementFromPoint(f,g),x=m!=null&&m.classList.contains(`${o}-flow__handle`)?m:d,p={handleDomNode:x,isValid:!1,connection:null,toHandle:null};if(x){const y=LO(void 0,x),w=x.getAttribute("data-nodeid"),_=x.getAttribute("data-handleid"),v=x.classList.contains("connectable"),C=x.classList.contains("connectableend");if(!w||!y)return p;const k={source:u?w:i,sourceHandle:u?_:s,target:u?i:w,targetHandle:u?s:_};p.connection=k;const S=v&&C&&(t===nf.Strict?u&&y==="source"||!u&&y==="target":w!==i||_!==s);p.isValid=S&&c(k),p.toHandle=FO(w,y,_,h,t,!1)}return p}const Bne={onPointerDown:Lne,isValid:UO},Une=(n,e)=>n.x!==e.x||n.y!==e.y||n.zoom!==e.k,Ny=n=>({x:n.x,y:n.y,zoom:n.k}),Xw=({x:n,y:e,zoom:t})=>e4.translate(n,e).scale(t),zf=(n,e)=>n.target.closest(`.${e}`),HO=(n,e)=>e===2&&Array.isArray(n)&&n.includes(2),Yw=(n,e=0,t=()=>{})=>{const i=typeof e=="number"&&e>0;return i||t(),i?n.transition().duration(e).on("end",t):n},zO=n=>{const e=n.ctrlKey&&c5()?10:1;return-n.deltaY*(n.deltaMode===1?.05:n.deltaMode?1:.002)*e};function Hne({zoomPanValues:n,noWheelClassName:e,d3Selection:t,d3Zoom:i,panOnScrollMode:s,panOnScrollSpeed:r,zoomOnPinch:a,onPanZoomStart:o,onPanZoom:l,onPanZoomEnd:c}){return h=>{if(zf(h,e))return!1;h.preventDefault(),h.stopImmediatePropagation();const u=t.property("__zoom").k||1;if(h.ctrlKey&&a){const x=Al(h),p=zO(h),y=u*Math.pow(2,p);i.scaleTo(t,y,x,h);return}const d=h.deltaMode===1?20:1;let f=s===nc.Vertical?0:h.deltaX*d,g=s===nc.Horizontal?0:h.deltaY*d;!c5()&&h.shiftKey&&s!==nc.Vertical&&(f=h.deltaY*d,g=0),i.translateBy(t,-(f/u)*r,-(g/u)*r,{internal:!0});const m=Ny(t.property("__zoom"));clearTimeout(n.panScrollTimeout),n.isPanScrolling||(n.isPanScrolling=!0,o==null||o(h,m)),n.isPanScrolling&&(l==null||l(h,m),n.panScrollTimeout=setTimeout(()=>{c==null||c(h,m),n.isPanScrolling=!1},150))}}function zne({noWheelClassName:n,preventScrolling:e,d3ZoomHandler:t}){return function(i,s){if(!e&&i.type==="wheel"&&!i.ctrlKey||zf(i,n))return null;i.preventDefault(),t.call(this,i,s)}}function jne({zoomPanValues:n,onDraggingChange:e,onPanZoomStart:t}){return i=>{var r,a,o;if((r=i.sourceEvent)!=null&&r.internal)return;const s=Ny(i.transform);n.mouseButton=((a=i.sourceEvent)==null?void 0:a.button)||0,n.isZoomingOrPanning=!0,n.prevViewport=s,((o=i.sourceEvent)==null?void 0:o.type)==="mousedown"&&e(!0),t&&(t==null||t(i.sourceEvent,s))}}function Gne({zoomPanValues:n,panOnDrag:e,onPaneContextMenu:t,onTransformChange:i,onPanZoom:s}){return r=>{var a,o;n.usedRightMouseButton=!!(t&&HO(e,n.mouseButton??0)),(a=r.sourceEvent)!=null&&a.sync||i([r.transform.x,r.transform.y,r.transform.k]),s&&!((o=r.sourceEvent)!=null&&o.internal)&&(s==null||s(r.sourceEvent,Ny(r.transform)))}}function Vne({zoomPanValues:n,panOnDrag:e,panOnScroll:t,onDraggingChange:i,onPanZoomEnd:s,onPaneContextMenu:r}){return a=>{var o;if(!((o=a.sourceEvent)!=null&&o.internal)&&(n.isZoomingOrPanning=!1,r&&HO(e,n.mouseButton??0)&&!n.usedRightMouseButton&&a.sourceEvent&&r(a.sourceEvent),n.usedRightMouseButton=!1,i(!1),s&&Une(n.prevViewport,a.transform))){const l=Ny(a.transform);n.prevViewport=l,clearTimeout(n.timerId),n.timerId=setTimeout(()=>{s==null||s(a.sourceEvent,l)},t?150:0)}}}function qne({zoomActivationKeyPressed:n,zoomOnScroll:e,zoomOnPinch:t,panOnDrag:i,panOnScroll:s,zoomOnDoubleClick:r,userSelectionActive:a,noWheelClassName:o,noPanClassName:l,lib:c}){return h=>{var g;const u=n||e,d=t&&h.ctrlKey;if(h.button===1&&h.type==="mousedown"&&(zf(h,`${c}-flow__node`)||zf(h,`${c}-flow__edge`)))return!0;if(!i&&!u&&!s&&!r&&!t||a||zf(h,o)&&h.type==="wheel"||zf(h,l)&&(h.type!=="wheel"||s&&h.type==="wheel"&&!n)||!t&&h.ctrlKey&&h.type==="wheel")return!1;if(!t&&h.type==="touchstart"&&((g=h.touches)==null?void 0:g.length)>1)return h.preventDefault(),!1;if(!u&&!s&&!d&&h.type==="wheel"||!i&&(h.type==="mousedown"||h.type==="touchstart")||Array.isArray(i)&&!i.includes(h.button)&&h.type==="mousedown")return!1;const f=Array.isArray(i)&&i.includes(h.button)||!h.button||h.button<=1;return(!h.ctrlKey||h.type==="wheel")&&f}}function Wne({domNode:n,minZoom:e,maxZoom:t,paneClickDistance:i,translateExtent:s,viewport:r,onPanZoom:a,onPanZoomStart:o,onPanZoomEnd:l,onDraggingChange:c}){const h={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},u=n.getBoundingClientRect(),d=cL().clickDistance(!Zo(i)||i<0?0:i).scaleExtent([e,t]).translateExtent(s),f=Ko(n).call(d);w({x:r.x,y:r.y,zoom:Hg(r.zoom,e,t)},[[0,0],[u.width,u.height]],s);const g=f.on("wheel.zoom"),m=f.on("dblclick.zoom");d.wheelDelta(zO);function x(F,H){return f?new Promise(T=>{d==null||d.transform(Yw(f,H==null?void 0:H.duration,()=>T(!0)),F)}):Promise.resolve(!1)}function p({noWheelClassName:F,noPanClassName:H,onPaneContextMenu:T,userSelectionActive:z,panOnScroll:R,panOnDrag:L,panOnScrollMode:Y,panOnScrollSpeed:j,preventScrolling:J,zoomOnPinch:G,zoomOnScroll:se,zoomOnDoubleClick:de,zoomActivationKeyPressed:he,lib:we,onTransformChange:ye}){z&&!h.isZoomingOrPanning&&y();const V=R&&!he&&!z?Hne({zoomPanValues:h,noWheelClassName:F,d3Selection:f,d3Zoom:d,panOnScrollMode:Y,panOnScrollSpeed:j,zoomOnPinch:G,onPanZoomStart:o,onPanZoom:a,onPanZoomEnd:l}):zne({noWheelClassName:F,preventScrolling:J,d3ZoomHandler:g});if(f.on("wheel.zoom",V,{passive:!1}),!z){const X=jne({zoomPanValues:h,onDraggingChange:c,onPanZoomStart:o});d.on("start",X);const ue=Gne({zoomPanValues:h,panOnDrag:L,onPaneContextMenu:!!T,onPanZoom:a,onTransformChange:ye});d.on("zoom",ue);const oe=Vne({zoomPanValues:h,panOnDrag:L,panOnScroll:R,onPaneContextMenu:T,onPanZoomEnd:l,onDraggingChange:c});d.on("end",oe)}const re=qne({zoomActivationKeyPressed:he,panOnDrag:L,zoomOnScroll:se,panOnScroll:R,zoomOnDoubleClick:de,zoomOnPinch:G,userSelectionActive:z,noPanClassName:H,noWheelClassName:F,lib:we});d.filter(re),de?f.on("dblclick.zoom",m):f.on("dblclick.zoom",null)}function y(){d.on("zoom",null)}async function w(F,H,T){const z=Xw(F),R=d==null?void 0:d.constrain()(z,H,T);return R&&await x(R),new Promise(L=>L(R))}async function _(F,H){const T=Xw(F);return await x(T,H),new Promise(z=>z(T))}function v(F){if(f){const H=Xw(F),T=f.property("__zoom");(T.k!==F.zoom||T.x!==F.x||T.y!==F.y)&&(d==null||d.transform(f,H,null,{sync:!0}))}}function C(){const F=f?fD(f.node()):{x:0,y:0,k:1};return{x:F.x,y:F.y,zoom:F.k}}function k(F,H){return f?new Promise(T=>{d==null||d.scaleTo(Yw(f,H==null?void 0:H.duration,()=>T(!0)),F)}):Promise.resolve(!1)}function I(F,H){return f?new Promise(T=>{d==null||d.scaleBy(Yw(f,H==null?void 0:H.duration,()=>T(!0)),F)}):Promise.resolve(!1)}function S(F){d==null||d.scaleExtent(F)}function M(F){d==null||d.translateExtent(F)}function N(F){const H=!Zo(F)||F<0?0:F;d==null||d.clickDistance(H)}return{update:p,destroy:y,setViewport:_,setViewportConstrained:w,getViewport:C,scaleTo:k,scaleBy:I,setScaleExtent:S,setTranslateExtent:M,syncViewport:v,setClickDistance:N}}var xS;(function(n){n.Line="line",n.Handle="handle"})(xS||(xS={}));function Kne(n){let e,t,i,s,r,a;const o=n[45].default,l=Gs(o,n,n[44],null);return{c(){e=ee("div"),l&&l.c(),this.h()},l(c){e=te(c,"DIV",{"data-handleid":!0,"data-nodeid":!0,"data-handlepos":!0,"data-id":!0,class:!0,style:!0,role:!0,tabindex:!0});var h=q(e);l&&l.l(h),h.forEach(E),this.h()},h(){A(e,"data-handleid",n[6]),A(e,"data-nodeid",n[14]),A(e,"data-handlepos",n[2]),A(e,"data-id",t=n[13]+"-"+n[14]+"-"+(n[0]||null)+"-"+n[1]),A(e,"class",i=Ei(["svelte-flow__handle",`svelte-flow__handle-${n[2]}`,"nodrag","nopan",n[2],n[4]])),A(e,"style",n[3]),A(e,"role","button"),A(e,"tabindex","-1"),mn(e,"valid",n[7]),mn(e,"connectingto",n[5]),mn(e,"connectingfrom",n[9]),mn(e,"source",!n[11]),mn(e,"target",n[11]),mn(e,"connectablestart",n[12]),mn(e,"connectableend",n[12]),mn(e,"connectable",n[12]),mn(e,"connectionindicator",n[12]&&(!n[10]||n[8]))},m(c,h){$(c,e,h),l&&l.m(e,null),s=!0,r||(a=[yt(e,"mousedown",n[32]),yt(e,"touchstart",n[32])],r=!0)},p(c,h){l&&l.p&&(!s||h[1]&8192)&&Vs(l,o,c,c[44],s?Ws(o,c[44],h,null):qs(c[44]),null),(!s||h[0]&64)&&A(e,"data-handleid",c[6]),(!s||h[0]&4)&&A(e,"data-handlepos",c[2]),(!s||h[0]&8195&&t!==(t=c[13]+"-"+c[14]+"-"+(c[0]||null)+"-"+c[1]))&&A(e,"data-id",t),(!s||h[0]&20&&i!==(i=Ei(["svelte-flow__handle",`svelte-flow__handle-${c[2]}`,"nodrag","nopan",c[2],c[4]])))&&A(e,"class",i),(!s||h[0]&8)&&A(e,"style",c[3]),(!s||h[0]&148)&&mn(e,"valid",c[7]),(!s||h[0]&52)&&mn(e,"connectingto",c[5]),(!s||h[0]&532)&&mn(e,"connectingfrom",c[9]),(!s||h[0]&2068)&&mn(e,"source",!c[11]),(!s||h[0]&2068)&&mn(e,"target",c[11]),(!s||h[0]&4116)&&mn(e,"connectablestart",c[12]),(!s||h[0]&4116)&&mn(e,"connectableend",c[12]),(!s||h[0]&4116)&&mn(e,"connectable",c[12]),(!s||h[0]&5396)&&mn(e,"connectionindicator",c[12]&&(!c[10]||c[8]))},i(c){s||(U(l,c),s=!0)},o(c){W(l,c),s=!1},d(c){c&&E(e),l&&l.d(c),r=!1,Qr(a)}}}function Xne(n,e,t){let i,s,r,a,o,l,c,h,u,d,f,g,m,x,p,y,w,_,v,C,k,I,S,M,N,{$$slots:F={},$$scope:H}=e,{id:T=void 0}=e,{type:z="source"}=e,{position:R=pn.Top}=e,{style:L=void 0}=e,{isValidConnection:Y=void 0}=e,{onconnect:j=void 0}=e,{ondisconnect:J=void 0}=e,{isConnectable:G=void 0}=e,{class:se=void 0}=e;const de=as("svelteflow__node_id"),he=as("svelteflow__node_connectable");Pe(n,he,Ge=>t(43,N=Ge));const we=ts(),{connectionMode:ye,domNode:P,nodeLookup:V,connectionRadius:re,viewport:X,isValidConnection:ue,lib:oe,addEdge:Q,onedgecreate:ae,panBy:Ke,cancelConnection:Ue,updateConnection:De,autoPanOnConnect:je,edges:ze,connectionLookup:Qe,onconnect:ft,onconnectstart:ut,onconnectend:Je,flowId:rt,connection:ge}=we;Pe(n,ye,Ge=>t(40,d=Ge)),Pe(n,P,Ge=>t(55,S=Ge)),Pe(n,V,Ge=>t(54,I=Ge)),Pe(n,re,Ge=>t(56,M=Ge)),Pe(n,X,Ge=>t(46,m=Ge)),Pe(n,ue,Ge=>t(51,_=Ge)),Pe(n,oe,Ge=>t(53,k=Ge)),Pe(n,ae,Ge=>t(50,w=Ge)),Pe(n,je,Ge=>t(52,C=Ge)),Pe(n,ze,Ge=>t(42,g=Ge)),Pe(n,Qe,Ge=>t(41,f=Ge)),Pe(n,ft,Ge=>t(49,y=Ge)),Pe(n,ut,Ge=>t(48,p=Ge)),Pe(n,Je,Ge=>t(47,x=Ge)),Pe(n,rt,Ge=>t(13,v=Ge)),Pe(n,ge,Ge=>t(39,u=Ge));function Pt(Ge){const Ft=AO(Ge);(Ft&&Ge.button===0||!Ft)&&Bne.onPointerDown(Ge,{handleId:r,nodeId:de,isTarget:i,connectionRadius:M,domNode:S,nodeLookup:I,connectionMode:d,lib:k,autoPanOnConnect:C,flowId:v,isValidConnection:Y??_,updateConnection:De,cancelConnection:Ue,panBy:Ke,onConnect:sn=>{const Me=w?w(sn):sn;Me&&(Q(Me),y==null||y(sn))},onConnectStart:(sn,Me)=>{p==null||p(sn,{nodeId:Me.nodeId,handleId:Me.handleId,handleType:Me.handleType})},onConnectEnd:(sn,Me)=>{x==null||x(sn,Me)},getTransform:()=>[m.x,m.y,m.zoom],getFromHandle:()=>u.fromHandle})}let lt=null,ct;return n.$$set=Ge=>{"id"in Ge&&t(0,T=Ge.id),"type"in Ge&&t(1,z=Ge.type),"position"in Ge&&t(2,R=Ge.position),"style"in Ge&&t(3,L=Ge.style),"isValidConnection"in Ge&&t(33,Y=Ge.isValidConnection),"onconnect"in Ge&&t(34,j=Ge.onconnect),"ondisconnect"in Ge&&t(35,J=Ge.ondisconnect),"isConnectable"in Ge&&t(36,G=Ge.isConnectable),"class"in Ge&&t(4,se=Ge.class),"$$scope"in Ge&&t(44,H=Ge.$$scope)},n.$$.update=()=>{var Ge,Ft,sn,Me,Lt,dt,Vt,Ln,Wn;if(n.$$.dirty[0]&2&&t(11,i=z==="target"),n.$$.dirty[1]&4128&&t(12,s=G!==void 0?G:N),n.$$.dirty[0]&1&&t(6,r=T||null),n.$$.dirty[0]&3|n.$$.dirty[1]&3096&&(j||J)&&t(38,ct=f.get(`${de}-${z}-${T||null}`)),n.$$.dirty[1]&216){if(lt&&!ine(ct,lt)){const hi=ct??new Map;iS(lt,hi,J),iS(hi,lt,j)}t(37,lt=ct??new Map)}n.$$.dirty[1]&256&&t(10,a=!!u.fromHandle),n.$$.dirty[0]&66|n.$$.dirty[1]&256&&t(9,o=((Ge=u.fromHandle)==null?void 0:Ge.nodeId)===de&&((Ft=u.fromHandle)==null?void 0:Ft.type)===z&&((sn=u.fromHandle)==null?void 0:sn.id)===r),n.$$.dirty[0]&66|n.$$.dirty[1]&256&&t(5,l=((Me=u.toHandle)==null?void 0:Me.nodeId)===de&&((Lt=u.toHandle)==null?void 0:Lt.type)===z&&((dt=u.toHandle)==null?void 0:dt.id)===r),n.$$.dirty[0]&66|n.$$.dirty[1]&768&&t(8,c=d===nf.Strict?((Vt=u.fromHandle)==null?void 0:Vt.type)!==z:de!==((Ln=u.fromHandle)==null?void 0:Ln.nodeId)||r!==((Wn=u.fromHandle)==null?void 0:Wn.id)),n.$$.dirty[0]&32|n.$$.dirty[1]&256&&t(7,h=l&&u.isValid)},[T,z,R,L,se,l,r,h,c,o,a,i,s,v,de,he,ye,P,V,re,X,ue,oe,ae,je,ze,Qe,ft,ut,Je,rt,ge,Pt,Y,j,J,G,lt,ct,u,d,f,g,N,H,F]}class Gg extends Nt{constructor(e){super(),Ot(this,e,Xne,Kne,Ut,{id:0,type:1,position:2,style:3,isValidConnection:33,onconnect:34,ondisconnect:35,isConnectable:36,class:4},null,[-1,-1])}}function Yne(n){var l;let e,t,i=((l=n[0])==null?void 0:l.label)+"",s,r,a,o;return e=new Gg({props:{type:"target",position:n[1]??pn.Top}}),a=new Gg({props:{type:"source",position:n[2]??pn.Bottom}}),{c(){me(e.$$.fragment),t=Ce(),s=vt(i),r=Ce(),me(a.$$.fragment)},l(c){xe(e.$$.fragment,c),t=Ae(c),s=kt(c,i),r=Ae(c),xe(a.$$.fragment,c)},m(c,h){pe(e,c,h),$(c,t,h),$(c,s,h),$(c,r,h),pe(a,c,h),o=!0},p(c,[h]){var f;const u={};h&2&&(u.position=c[1]??pn.Top),e.$set(u),(!o||h&1)&&i!==(i=((f=c[0])==null?void 0:f.label)+"")&&Et(s,i);const d={};h&4&&(d.position=c[2]??pn.Bottom),a.$set(d)},i(c){o||(U(e.$$.fragment,c),U(a.$$.fragment,c),o=!0)},o(c){W(e.$$.fragment,c),W(a.$$.fragment,c),o=!1},d(c){c&&(E(t),E(s),E(r)),be(e,c),be(a,c)}}}function Jne(n,e,t){const i=["data","targetPosition","sourcePosition"];$i(e,i);let{data:s={label:"Node"}}=e,{targetPosition:r=void 0}=e,{sourcePosition:a=void 0}=e;return n.$$set=o=>{e=oi(oi({},e),ll(o)),t(3,$i(e,i)),"data"in o&&t(0,s=o.data),"targetPosition"in o&&t(1,r=o.targetPosition),"sourcePosition"in o&&t(2,a=o.sourcePosition)},[s,r,a]}class jO extends Nt{constructor(e){super(),Ot(this,e,Jne,Yne,Ut,{data:0,targetPosition:1,sourcePosition:2})}}function Zne(n){var a;let e=((a=n[0])==null?void 0:a.label)+"",t,i,s,r;return s=new Gg({props:{type:"source",position:n[1]??pn.Bottom}}),{c(){t=vt(e),i=Ce(),me(s.$$.fragment)},l(o){t=kt(o,e),i=Ae(o),xe(s.$$.fragment,o)},m(o,l){$(o,t,l),$(o,i,l),pe(s,o,l),r=!0},p(o,[l]){var h;(!r||l&1)&&e!==(e=((h=o[0])==null?void 0:h.label)+"")&&Et(t,e);const c={};l&2&&(c.position=o[1]??pn.Bottom),s.$set(c)},i(o){r||(U(s.$$.fragment,o),r=!0)},o(o){W(s.$$.fragment,o),r=!1},d(o){o&&(E(t),E(i)),be(s,o)}}}function Qne(n,e,t){const i=["data","sourcePosition"];$i(e,i);let{data:s={label:"Node"}}=e,{sourcePosition:r=void 0}=e;return n.$$set=a=>{e=oi(oi({},e),ll(a)),t(2,$i(e,i)),"data"in a&&t(0,s=a.data),"sourcePosition"in a&&t(1,r=a.sourcePosition)},[s,r]}class $ne extends Nt{constructor(e){super(),Ot(this,e,Qne,Zne,Ut,{data:0,sourcePosition:1})}}function eie(n){var a;let e=((a=n[0])==null?void 0:a.label)+"",t,i,s,r;return s=new Gg({props:{type:"target",position:n[1]??pn.Top}}),{c(){t=vt(e),i=Ce(),me(s.$$.fragment)},l(o){t=kt(o,e),i=Ae(o),xe(s.$$.fragment,o)},m(o,l){$(o,t,l),$(o,i,l),pe(s,o,l),r=!0},p(o,[l]){var h;(!r||l&1)&&e!==(e=((h=o[0])==null?void 0:h.label)+"")&&Et(t,e);const c={};l&2&&(c.position=o[1]??pn.Top),s.$set(c)},i(o){r||(U(s.$$.fragment,o),r=!0)},o(o){W(s.$$.fragment,o),r=!1},d(o){o&&(E(t),E(i)),be(s,o)}}}function tie(n,e,t){const i=["data","targetPosition"];$i(e,i);let{data:s={label:"Node"}}=e,{targetPosition:r=void 0}=e;return n.$$set=a=>{e=oi(oi({},e),ll(a)),t(2,$i(e,i)),"data"in a&&t(0,s=a.data),"targetPosition"in a&&t(1,r=a.targetPosition)},[s,r]}class nie extends Nt{constructor(e){super(),Ot(this,e,tie,eie,Ut,{data:0,targetPosition:1})}}function iie(n,e,t){const i=[];return $i(e,i),n.$$set=s=>{e=oi(oi({},e),ll(s)),t(0,$i(e,i))},[]}class sie extends Nt{constructor(e){super(),Ot(this,e,iie,null,Ut,{})}}function yS(n,e,t){if(!e)return;const i=t?e.querySelector(t):e;i&&i.appendChild(n)}function rie(n,{target:e,domNode:t}){return yS(n,t,e),{async update({target:i,domNode:s}){yS(n,s,i)},destroy(){n.parentNode&&n.parentNode.removeChild(n)}}}function aie(n){let e,t,i,s,r;const a=n[3].default,o=Gs(a,n,n[2],null);return{c(){e=ee("div"),o&&o.c()},l(l){e=te(l,"DIV",{});var c=q(e);o&&o.l(c),c.forEach(E)},m(l,c){$(l,e,c),o&&o.m(e,null),i=!0,s||(r=aa(t=rie.call(null,e,{target:".svelte-flow__edgelabel-renderer",domNode:n[0]})),s=!0)},p(l,[c]){o&&o.p&&(!i||c&4)&&Vs(o,a,l,l[2],i?Ws(a,l[2],c,null):qs(l[2]),null),t&&Ls(t.update)&&c&1&&t.update.call(null,{target:".svelte-flow__edgelabel-renderer",domNode:l[0]})},i(l){i||(U(o,l),i=!0)},o(l){W(o,l),i=!1},d(l){l&&E(e),o&&o.d(l),s=!1,r()}}}function oie(n,e,t){let i,{$$slots:s={},$$scope:r}=e;const{domNode:a}=ts();return Pe(n,a,o=>t(0,i=o)),n.$$set=o=>{"$$scope"in o&&t(2,r=o.$$scope)},[i,a,r,s]}class lie extends Nt{constructor(e){super(),Ot(this,e,oie,aie,Ut,{})}}function GO(){const{edgeLookup:n,selectionRect:e,selectionRectMode:t,multiselectionKeyPressed:i,addSelectedEdges:s,unselectNodesAndEdges:r,elementsSelectable:a}=ts();return o=>{const l=$e(n).get(o);if(!l){console.warn("012",Cx.error012(o));return}(l.selectable||$e(a)&&typeof l.selectable>"u")&&(e.set(null),t.set(null),l.selected?l.selected&&$e(i)&&r({nodes:[],edges:[l]}):s([o]))}}function cie(n){let e,t,i=`translate(-50%, -50%) translate(${n[1]}px,${n[2]}px)`,s,r,a;const o=n[5].default,l=Gs(o,n,n[7],null);return{c(){e=ee("div"),l&&l.c(),this.h()},l(c){e=te(c,"DIV",{class:!0,style:!0,role:!0,tabindex:!0});var h=q(e);l&&l.l(h),h.forEach(E),this.h()},h(){A(e,"class","svelte-flow__edge-label"),A(e,"style",t="pointer-events: all;"+n[0]),A(e,"role","button"),A(e,"tabindex","-1"),nn(e,"transform",i)},m(c,h){$(c,e,h),l&&l.m(e,null),s=!0,r||(a=[yt(e,"keyup",uie),yt(e,"click",n[6])],r=!0)},p(c,h){l&&l.p&&(!s||h&128)&&Vs(l,o,c,c[7],s?Ws(o,c[7],h,null):qs(c[7]),null),(!s||h&1&&t!==(t="pointer-events: all;"+c[0]))&&A(e,"style",t);const u=h&1;(h&7&&i!==(i=`translate(-50%, -50%) translate(${c[1]}px,${c[2]}px)`)||u)&&nn(e,"transform",i)},i(c){s||(U(l,c),s=!0)},o(c){W(l,c),s=!1},d(c){c&&E(e),l&&l.d(c),r=!1,Qr(a)}}}function hie(n){let e,t;return e=new lie({props:{$$slots:{default:[cie]},$$scope:{ctx:n}}}),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p(i,[s]){const r={};s&135&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}const uie=()=>{};function die(n,e,t){let{$$slots:i={},$$scope:s}=e,{style:r=void 0}=e,{x:a=void 0}=e,{y:o=void 0}=e;const l=GO(),c=as("svelteflow__edge_id"),h=()=>{c&&l(c)};return n.$$set=u=>{"style"in u&&t(0,r=u.style),"x"in u&&t(1,a=u.x),"y"in u&&t(2,o=u.y),"$$scope"in u&&t(7,s=u.$$scope)},[r,a,o,l,c,i,h,s]}class fie extends Nt{constructor(e){super(),Ot(this,e,die,hie,Ut,{style:0,x:1,y:2})}}function gie(n){let e;return{c(){e=at("path"),this.h()},l(t){e=ot(t,"path",{d:!0,"stroke-opacity":!0,"stroke-width":!0,fill:!0,class:!0}),q(e).forEach(E),this.h()},h(){A(e,"d",n[1]),A(e,"stroke-opacity",0),A(e,"stroke-width",n[10]),A(e,"fill","none"),A(e,"class","svelte-flow__edge-interaction")},m(t,i){$(t,e,i)},p(t,i){i&2&&A(e,"d",t[1])},d(t){t&&E(e)}}}function wS(n){let e,t;return e=new fie({props:{x:n[3],y:n[4],style:n[5],$$slots:{default:[mie]},$$scope:{ctx:n}}}),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p(i,s){const r={};s&8&&(r.x=i[3]),s&16&&(r.y=i[4]),s&32&&(r.style=i[5]),s&4100&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function mie(n){let e;return{c(){e=vt(n[2])},l(t){e=kt(t,n[2])},m(t,i){$(t,e,i)},p(t,i){i&4&&Et(e,t[2])},d(t){t&&E(e)}}}function pie(n){let e,t,i,s,r,a,o=n[10]&&gie(n),l=n[2]&&wS(n);return{c(){e=at("path"),i=Ce(),o&&o.c(),s=Ce(),l&&l.c(),r=zt(),this.h()},l(c){e=ot(c,"path",{id:!0,d:!0,class:!0,"marker-start":!0,"marker-end":!0,fill:!0,style:!0}),q(e).forEach(E),i=Ae(c),o&&o.l(c),s=Ae(c),l&&l.l(c),r=zt(),this.h()},h(){A(e,"id",n[0]),A(e,"d",n[1]),A(e,"class",t=Ei(["svelte-flow__edge-path",n[9]])),A(e,"marker-start",n[6]),A(e,"marker-end",n[7]),A(e,"fill","none"),A(e,"style",n[8])},m(c,h){$(c,e,h),$(c,i,h),o&&o.m(c,h),$(c,s,h),l&&l.m(c,h),$(c,r,h),a=!0},p(c,[h]){(!a||h&1)&&A(e,"id",c[0]),(!a||h&2)&&A(e,"d",c[1]),(!a||h&512&&t!==(t=Ei(["svelte-flow__edge-path",c[9]])))&&A(e,"class",t),(!a||h&64)&&A(e,"marker-start",c[6]),(!a||h&128)&&A(e,"marker-end",c[7]),(!a||h&256)&&A(e,"style",c[8]),c[10]&&o.p(c,h),c[2]?l?(l.p(c,h),h&4&&U(l,1)):(l=wS(c),l.c(),U(l,1),l.m(r.parentNode,r)):l&&(bt(),W(l,1,1,()=>{l=null}),xt())},i(c){a||(U(l),a=!0)},o(c){W(l),a=!1},d(c){c&&(E(e),E(i),E(s),E(r)),o&&o.d(c),l&&l.d(c)}}}function bie(n,e,t){let{id:i=void 0}=e,{path:s}=e,{label:r=void 0}=e,{labelX:a=void 0}=e,{labelY:o=void 0}=e,{labelStyle:l=void 0}=e,{markerStart:c=void 0}=e,{markerEnd:h=void 0}=e,{style:u=void 0}=e,{interactionWidth:d=20}=e,{class:f=void 0}=e,g=d===void 0?20:d;return n.$$set=m=>{"id"in m&&t(0,i=m.id),"path"in m&&t(1,s=m.path),"label"in m&&t(2,r=m.label),"labelX"in m&&t(3,a=m.labelX),"labelY"in m&&t(4,o=m.labelY),"labelStyle"in m&&t(5,l=m.labelStyle),"markerStart"in m&&t(6,c=m.markerStart),"markerEnd"in m&&t(7,h=m.markerEnd),"style"in m&&t(8,u=m.style),"interactionWidth"in m&&t(11,d=m.interactionWidth),"class"in m&&t(9,f=m.class)},[i,s,r,a,o,l,c,h,u,f,g,d]}class Oy extends Nt{constructor(e){super(),Ot(this,e,bie,pie,Ut,{id:0,path:1,label:2,labelX:3,labelY:4,labelStyle:5,markerStart:6,markerEnd:7,style:8,interactionWidth:11,class:9})}}function xie(n){let e,t;return e=new Oy({props:{path:n[8],labelX:n[7],labelY:n[6],label:n[0],labelStyle:n[1],markerStart:n[3],markerEnd:n[4],interactionWidth:n[5],style:n[2]}}),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p(i,[s]){const r={};s&256&&(r.path=i[8]),s&128&&(r.labelX=i[7]),s&64&&(r.labelY=i[6]),s&1&&(r.label=i[0]),s&2&&(r.labelStyle=i[1]),s&8&&(r.markerStart=i[3]),s&16&&(r.markerEnd=i[4]),s&32&&(r.interactionWidth=i[5]),s&4&&(r.style=i[2]),e.$set(r)},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function yie(n,e,t){let i,s,r;const a=["label","labelStyle","style","markerStart","markerEnd","interactionWidth","sourceX","sourceY","sourcePosition","targetX","targetY","targetPosition"];$i(e,a);let{label:o=void 0}=e,{labelStyle:l=void 0}=e,{style:c=void 0}=e,{markerStart:h=void 0}=e,{markerEnd:u=void 0}=e,{interactionWidth:d=void 0}=e,{sourceX:f}=e,{sourceY:g}=e,{sourcePosition:m}=e,{targetX:x}=e,{targetY:p}=e,{targetPosition:y}=e;return n.$$set=w=>{e=oi(oi({},e),ll(w)),t(15,$i(e,a)),"label"in w&&t(0,o=w.label),"labelStyle"in w&&t(1,l=w.labelStyle),"style"in w&&t(2,c=w.style),"markerStart"in w&&t(3,h=w.markerStart),"markerEnd"in w&&t(4,u=w.markerEnd),"interactionWidth"in w&&t(5,d=w.interactionWidth),"sourceX"in w&&t(9,f=w.sourceX),"sourceY"in w&&t(10,g=w.sourceY),"sourcePosition"in w&&t(11,m=w.sourcePosition),"targetX"in w&&t(12,x=w.targetX),"targetY"in w&&t(13,p=w.targetY),"targetPosition"in w&&t(14,y=w.targetPosition)},n.$$.update=()=>{n.$$.dirty&32256&&t(8,[i,s,r]=SO({sourceX:f,sourceY:g,targetX:x,targetY:p,sourcePosition:m,targetPosition:y}),i,(t(7,s),t(9,f),t(10,g),t(12,x),t(13,p),t(11,m),t(14,y)),(t(6,r),t(9,f),t(10,g),t(12,x),t(13,p),t(11,m),t(14,y)))},[o,l,c,h,u,d,r,s,i,f,g,m,x,p,y]}class VO extends Nt{constructor(e){super(),Ot(this,e,yie,xie,Ut,{label:0,labelStyle:1,style:2,markerStart:3,markerEnd:4,interactionWidth:5,sourceX:9,sourceY:10,sourcePosition:11,targetX:12,targetY:13,targetPosition:14})}}function wie(n){let e,t;return e=new Oy({props:{path:n[8],labelX:n[7],labelY:n[6],label:n[0],labelStyle:n[1],markerStart:n[3],markerEnd:n[4],interactionWidth:n[5],style:n[2]}}),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p(i,[s]){const r={};s&256&&(r.path=i[8]),s&128&&(r.labelX=i[7]),s&64&&(r.labelY=i[6]),s&1&&(r.label=i[0]),s&2&&(r.labelStyle=i[1]),s&8&&(r.markerStart=i[3]),s&16&&(r.markerEnd=i[4]),s&32&&(r.interactionWidth=i[5]),s&4&&(r.style=i[2]),e.$set(r)},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function _ie(n,e,t){let i,s,r;const a=["label","labelStyle","style","markerStart","markerEnd","interactionWidth","sourceX","sourceY","sourcePosition","targetX","targetY","targetPosition"];$i(e,a);let{label:o=void 0}=e,{labelStyle:l=void 0}=e,{style:c=void 0}=e,{markerStart:h=void 0}=e,{markerEnd:u=void 0}=e,{interactionWidth:d=void 0}=e,{sourceX:f}=e,{sourceY:g}=e,{sourcePosition:m}=e,{targetX:x}=e,{targetY:p}=e,{targetPosition:y}=e;return n.$$set=w=>{e=oi(oi({},e),ll(w)),t(15,$i(e,a)),"label"in w&&t(0,o=w.label),"labelStyle"in w&&t(1,l=w.labelStyle),"style"in w&&t(2,c=w.style),"markerStart"in w&&t(3,h=w.markerStart),"markerEnd"in w&&t(4,u=w.markerEnd),"interactionWidth"in w&&t(5,d=w.interactionWidth),"sourceX"in w&&t(9,f=w.sourceX),"sourceY"in w&&t(10,g=w.sourceY),"sourcePosition"in w&&t(11,m=w.sourcePosition),"targetX"in w&&t(12,x=w.targetX),"targetY"in w&&t(13,p=w.targetY),"targetPosition"in w&&t(14,y=w.targetPosition)},n.$$.update=()=>{n.$$.dirty&32256&&t(8,[i,s,r]=h5({sourceX:f,sourceY:g,targetX:x,targetY:p,sourcePosition:m,targetPosition:y}),i,(t(7,s),t(9,f),t(10,g),t(12,x),t(13,p),t(11,m),t(14,y)),(t(6,r),t(9,f),t(10,g),t(12,x),t(13,p),t(11,m),t(14,y)))},[o,l,c,h,u,d,r,s,i,f,g,m,x,p,y]}class vie extends Nt{constructor(e){super(),Ot(this,e,_ie,wie,Ut,{label:0,labelStyle:1,style:2,markerStart:3,markerEnd:4,interactionWidth:5,sourceX:9,sourceY:10,sourcePosition:11,targetX:12,targetY:13,targetPosition:14})}}function kie(n){let e,t;return e=new Oy({props:{path:n[8],labelX:n[7],labelY:n[6],label:n[0],labelStyle:n[1],markerStart:n[3],markerEnd:n[4],interactionWidth:n[5],style:n[2]}}),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p(i,[s]){const r={};s&256&&(r.path=i[8]),s&128&&(r.labelX=i[7]),s&64&&(r.labelY=i[6]),s&1&&(r.label=i[0]),s&2&&(r.labelStyle=i[1]),s&8&&(r.markerStart=i[3]),s&16&&(r.markerEnd=i[4]),s&32&&(r.interactionWidth=i[5]),s&4&&(r.style=i[2]),e.$set(r)},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function Cie(n,e,t){let i,s,r;const a=["label","labelStyle","style","markerStart","markerEnd","interactionWidth","sourceX","sourceY","targetX","targetY"];$i(e,a);let{label:o=void 0}=e,{labelStyle:l=void 0}=e,{style:c=void 0}=e,{markerStart:h=void 0}=e,{markerEnd:u=void 0}=e,{interactionWidth:d=void 0}=e,{sourceX:f}=e,{sourceY:g}=e,{targetX:m}=e,{targetY:x}=e;return n.$$set=p=>{e=oi(oi({},e),ll(p)),t(13,$i(e,a)),"label"in p&&t(0,o=p.label),"labelStyle"in p&&t(1,l=p.labelStyle),"style"in p&&t(2,c=p.style),"markerStart"in p&&t(3,h=p.markerStart),"markerEnd"in p&&t(4,u=p.markerEnd),"interactionWidth"in p&&t(5,d=p.interactionWidth),"sourceX"in p&&t(9,f=p.sourceX),"sourceY"in p&&t(10,g=p.sourceY),"targetX"in p&&t(11,m=p.targetX),"targetY"in p&&t(12,x=p.targetY)},n.$$.update=()=>{n.$$.dirty&7680&&t(8,[i,s,r]=EO({sourceX:f,sourceY:g,targetX:m,targetY:x}),i,(t(7,s),t(9,f),t(10,g),t(11,m),t(12,x)),(t(6,r),t(9,f),t(10,g),t(11,m),t(12,x)))},[o,l,c,h,u,d,r,s,i,f,g,m,x]}class Aie extends Nt{constructor(e){super(),Ot(this,e,Cie,kie,Ut,{label:0,labelStyle:1,style:2,markerStart:3,markerEnd:4,interactionWidth:5,sourceX:9,sourceY:10,targetX:11,targetY:12})}}function Sie(n){let e,t;return e=new Oy({props:{path:n[8],labelX:n[7],labelY:n[6],label:n[0],labelStyle:n[1],markerStart:n[3],markerEnd:n[4],interactionWidth:n[5],style:n[2]}}),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p(i,[s]){const r={};s&256&&(r.path=i[8]),s&128&&(r.labelX=i[7]),s&64&&(r.labelY=i[6]),s&1&&(r.label=i[0]),s&2&&(r.labelStyle=i[1]),s&8&&(r.markerStart=i[3]),s&16&&(r.markerEnd=i[4]),s&32&&(r.interactionWidth=i[5]),s&4&&(r.style=i[2]),e.$set(r)},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function Iie(n,e,t){let i,s,r;const a=["label","labelStyle","style","markerStart","markerEnd","interactionWidth","sourceX","sourceY","sourcePosition","targetX","targetY","targetPosition"];$i(e,a);let{label:o=void 0}=e,{labelStyle:l=void 0}=e,{style:c=void 0}=e,{markerStart:h=void 0}=e,{markerEnd:u=void 0}=e,{interactionWidth:d=void 0}=e,{sourceX:f}=e,{sourceY:g}=e,{sourcePosition:m}=e,{targetX:x}=e,{targetY:p}=e,{targetPosition:y}=e;return n.$$set=w=>{e=oi(oi({},e),ll(w)),t(15,$i(e,a)),"label"in w&&t(0,o=w.label),"labelStyle"in w&&t(1,l=w.labelStyle),"style"in w&&t(2,c=w.style),"markerStart"in w&&t(3,h=w.markerStart),"markerEnd"in w&&t(4,u=w.markerEnd),"interactionWidth"in w&&t(5,d=w.interactionWidth),"sourceX"in w&&t(9,f=w.sourceX),"sourceY"in w&&t(10,g=w.sourceY),"sourcePosition"in w&&t(11,m=w.sourcePosition),"targetX"in w&&t(12,x=w.targetX),"targetY"in w&&t(13,p=w.targetY),"targetPosition"in w&&t(14,y=w.targetPosition)},n.$$.update=()=>{n.$$.dirty&32256&&t(8,[i,s,r]=h5({sourceX:f,sourceY:g,targetX:x,targetY:p,sourcePosition:m,targetPosition:y,borderRadius:0}),i,(t(7,s),t(9,f),t(10,g),t(12,x),t(13,p),t(11,m),t(14,y)),(t(6,r),t(9,f),t(10,g),t(12,x),t(13,p),t(11,m),t(14,y)))},[o,l,c,h,u,d,r,s,i,f,g,m,x,p,y]}class Eie extends Nt{constructor(e){super(),Ot(this,e,Iie,Sie,Ut,{label:0,labelStyle:1,style:2,markerStart:3,markerEnd:4,interactionWidth:5,sourceX:9,sourceY:10,sourcePosition:11,targetX:12,targetY:13,targetPosition:14})}}function Tie(n,e){const t=n.set,i=e.set,s=$e(n),r=$e(e);let o=s.length===0&&r.length>0?r:s;n.set(o);const l=c=>{const h=t(c);return o=h,i(o),h};n.set=e.set=l,n.update=e.update=c=>l(c(o))}function Rie(n,e){const t=n.set,i=e.set;let s=$e(e);n.set(s);const r=a=>{t(a),i(a),s=a};n.set=e.set=r,n.update=e.update=a=>r(a(s))}const Mie=(n,e,t)=>{if(!t)return;const i=$e(n),s=e.set,r=t.set;let a=t?$e(t):{x:0,y:0,zoom:1};e.set(a),e.set=o=>(s(o),r(o),a=o,o),t.set=o=>(i==null||i.syncViewport(o),s(o),r(o),a=o,o),e.update=o=>{e.set(o(a))},t.update=o=>{t.set(o(a))}},Pie=(n,e,t,i=[0,0],s=r5)=>{const{subscribe:r,set:a,update:o}=en([]);let l=n,c={},h=!0;const u=m=>(MO(m,e,t,{elevateNodesOnSelect:h,nodeOrigin:i,nodeExtent:s,defaults:c,checkEquality:!1}),l=m,a(l),l),d=m=>u(m(l)),f=m=>{c=m},g=m=>{h=m.elevateNodesOnSelect??h};return u(l),{subscribe:r,set:u,update:d,setDefaultOptions:f,setOptions:g}},Nie=(n,e,t,i)=>{const{subscribe:s,set:r,update:a}=en([]);let o=n,l={};const c=d=>{const f=l?d.map(g=>({...l,...g})):d;OO(e,t,f),o=f,r(o)},h=d=>c(d(o)),u=d=>{l=d};return c(o),{subscribe:s,set:c,update:h,setDefaultOptions:u}},qO={input:$ne,output:nie,default:jO,group:sie},WO={straight:Aie,smoothstep:vie,default:VO,step:Eie},Oie=({nodes:n=[],edges:e=[],width:t,height:i,fitView:s,nodeOrigin:r,nodeExtent:a})=>{const o=new Map,l=new Map,c=new Map,h=new Map,u=r??[0,0],d=a??r5;MO(n,o,l,{nodeExtent:d,nodeOrigin:u,elevateNodesOnSelect:!1,checkEquality:!1}),OO(c,h,e);let f={x:0,y:0,zoom:1};if(s&&t&&i){const g=Ry(o,{filter:m=>!!((m.width||m.initialWidth)&&(m.height||m.initialHeight))});f=G_(g,t,i,.5,2,.1)}return{flowId:en(null),nodes:Pie(n,o,l,u,d),nodeLookup:Io(o),parentLookup:Io(l),edgeLookup:Io(h),visibleNodes:Io([]),edges:Nie(e,c,h),visibleEdges:Io([]),connectionLookup:Io(c),height:en(500),width:en(500),minZoom:en(.5),maxZoom:en(2),nodeOrigin:en(u),nodeDragThreshold:en(1),nodeExtent:en(d),translateExtent:en(r5),autoPanOnNodeDrag:en(!0),autoPanOnConnect:en(!0),fitViewOnInit:en(!1),fitViewOnInitDone:en(!1),fitViewOptions:en(void 0),panZoom:en(null),snapGrid:en(null),dragging:en(!1),selectionRect:en(null),selectionKeyPressed:en(!1),multiselectionKeyPressed:en(!1),deleteKeyPressed:en(!1),panActivationKeyPressed:en(!1),zoomActivationKeyPressed:en(!1),selectionRectMode:en(null),selectionMode:en(a5.Partial),nodeTypes:en(qO),edgeTypes:en(WO),viewport:en(f),connectionMode:en(nf.Strict),domNode:en(null),connection:Io(X6),connectionLineType:en(c1.Bezier),connectionRadius:en(20),isValidConnection:en(()=>!0),nodesDraggable:en(!0),nodesConnectable:en(!0),elementsSelectable:en(!0),selectNodesOnDrag:en(!0),markers:Io([]),defaultMarkerColor:en("#b1b1b7"),lib:Io("svelte"),onlyRenderVisibleElements:en(!1),onerror:en(cne),ondelete:en(void 0),onedgecreate:en(void 0),onconnect:en(void 0),onconnectstart:en(void 0),onconnectend:en(void 0),onbeforedelete:en(void 0),nodesInitialized:en(!1),edgesInitialized:en(!1),viewportInitialized:en(!1),initialized:Io(!1)}};function Die(n){const e=Yf([n.edges,n.nodes,n.nodeLookup,n.onlyRenderVisibleElements,n.viewport,n.width,n.height],([t,,i,s,r,a,o])=>s&&a&&o?t.filter(c=>{const h=i.get(c.source),u=i.get(c.target);return h&&u&&pne({sourceNode:h,targetNode:u,width:a,height:o,transform:[r.x,r.y,r.zoom]})}):t);return Yf([e,n.nodes,n.nodeLookup,n.connectionMode,n.onerror],([t,,i,s,r])=>t.reduce((o,l)=>{const c=i.get(l.source),h=i.get(l.target);if(!c||!h)return o;const u=kne({id:l.id,sourceNode:c,targetNode:h,sourceHandle:l.sourceHandle||null,targetHandle:l.targetHandle||null,connectionMode:s,onError:r});return u&&o.push({...l,zIndex:mne({selected:l.selected,zIndex:l.zIndex,sourceNode:c,targetNode:h,elevateOnSelect:!1}),...u}),o},[]))}function Fie(n){return Yf([n.nodeLookup,n.onlyRenderVisibleElements,n.width,n.height,n.viewport,n.nodes],([e,t,i,s,r])=>{const a=[r.x,r.y,r.zoom];return t?yO(e,{x:0,y:0,width:i,height:s},a,!0):Array.from(e.values())})}const Dy=Symbol();function KO({nodes:n,edges:e,width:t,height:i,fitView:s,nodeOrigin:r,nodeExtent:a}){const o=Oie({nodes:n,edges:e,width:t,height:i,fitView:s,nodeOrigin:r,nodeExtent:a});function l(R){o.nodeTypes.set({...qO,...R})}function c(R){o.edgeTypes.set({...WO,...R})}function h(R){const L=$e(o.edges);o.edges.set(yne(R,L))}const u=(R,L=!1)=>{var j;const Y=$e(o.nodeLookup);for(const[J,G]of R){const se=(j=Y.get(J))==null?void 0:j.internals.userNode;se&&(se.position=G.position,se.dragging=L)}o.nodes.update(J=>J)};function d(R){var J,G,se;const L=$e(o.nodeLookup),{changes:Y,updatedInternals:j}=Tne(R,L,$e(o.parentLookup),$e(o.domNode),$e(o.nodeOrigin));if(j){if(!$e(o.fitViewOnInitDone)&&$e(o.fitViewOnInit)){const de=$e(o.fitViewOptions),he=g({...de,nodes:de==null?void 0:de.nodes});o.fitViewOnInitDone.set(he)}for(const de of Y){const he=(J=L.get(de.id))==null?void 0:J.internals.userNode;if(he)switch(de.type){case"dimensions":{const we={...he.measured,...de.dimensions};de.setAttributes&&(he.width=((G=de.dimensions)==null?void 0:G.width)??he.width,he.height=((se=de.dimensions)==null?void 0:se.height)??he.height),he.measured=we;break}case"position":he.position=de.position??he.position;break}}o.nodes.update(de=>de),$e(o.nodesInitialized)||o.nodesInitialized.set(!0)}}function f(R){const L=$e(o.panZoom);if(!L)return Promise.resolve(!1);const Y=rS($e(o.nodeLookup),R);return aS({nodes:Y,width:$e(o.width),height:$e(o.height),minZoom:$e(o.minZoom),maxZoom:$e(o.maxZoom),panZoom:L},R)}function g(R){const L=$e(o.panZoom);if(!L)return!1;const Y=rS($e(o.nodeLookup),R);return aS({nodes:Y,width:$e(o.width),height:$e(o.height),minZoom:$e(o.minZoom),maxZoom:$e(o.maxZoom),panZoom:L},R),Y.size>0}function m(R,L){const Y=$e(o.panZoom);return Y?Y.scaleBy(R,L):Promise.resolve(!1)}function x(R){return m(1.2,R)}function p(R){return m(1/1.2,R)}function y(R){const L=$e(o.panZoom);L&&(L.setScaleExtent([R,$e(o.maxZoom)]),o.minZoom.set(R))}function w(R){const L=$e(o.panZoom);L&&(L.setScaleExtent([$e(o.minZoom),R]),o.maxZoom.set(R))}function _(R){const L=$e(o.panZoom);L&&(L.setTranslateExtent(R),o.translateExtent.set(R))}function v(R){let L=!1;return R.forEach(Y=>{Y.selected&&(Y.selected=!1,L=!0)}),L}function C(R){var L;(L=$e(o.panZoom))==null||L.setClickDistance(R)}function k(R){v((R==null?void 0:R.nodes)||$e(o.nodes))&&o.nodes.set($e(o.nodes)),v((R==null?void 0:R.edges)||$e(o.edges))&&o.edges.set($e(o.edges))}o.deleteKeyPressed.subscribe(async R=>{var L;if(R){const Y=$e(o.nodes),j=$e(o.edges),J=Y.filter(he=>he.selected),G=j.filter(he=>he.selected),{nodes:se,edges:de}=await wO({nodesToRemove:J,edgesToRemove:G,nodes:Y,edges:j,onBeforeDelete:$e(o.onbeforedelete)});(se.length||de.length)&&(o.nodes.update(he=>he.filter(we=>!se.some(ye=>ye.id===we.id))),o.edges.update(he=>he.filter(we=>!de.some(ye=>ye.id===we.id))),(L=$e(o.ondelete))==null||L({nodes:se,edges:de}))}});function I(R){const L=$e(o.multiselectionKeyPressed);o.nodes.update(Y=>Y.map(j=>{const J=R.includes(j.id),G=L&&j.selected||J;return j.selected=G,j})),L||o.edges.update(Y=>Y.map(j=>(j.selected=!1,j)))}function S(R){const L=$e(o.multiselectionKeyPressed);o.edges.update(Y=>Y.map(j=>{const J=R.includes(j.id),G=L&&j.selected||J;return j.selected=G,j})),L||o.nodes.update(Y=>Y.map(j=>(j.selected=!1,j)))}function M(R){var Y;const L=(Y=$e(o.nodes))==null?void 0:Y.find(j=>j.id===R);if(!L){console.warn("012",Cx.error012(R));return}o.selectionRect.set(null),o.selectionRectMode.set(null),L.selected?L.selected&&$e(o.multiselectionKeyPressed)&&k({nodes:[L],edges:[]}):I([R])}function N(R){const L=$e(o.viewport);return Rne({delta:R,panZoom:$e(o.panZoom),transform:[L.x,L.y,L.zoom],translateExtent:$e(o.translateExtent),width:$e(o.width),height:$e(o.height)})}const F=en(X6),H=R=>{F.set({...R})};function T(){F.set(X6)}function z(){o.fitViewOnInitDone.set(!1),o.selectionRect.set(null),o.selectionRectMode.set(null),o.snapGrid.set(null),o.isValidConnection.set(()=>!0),k(),T()}return{...o,visibleEdges:Die(o),visibleNodes:Fie(o),connection:Yf([F,o.viewport],([R,L])=>R.inProgress?{...R,to:Ax(R.to,[L.x,L.y,L.zoom])}:{...R}),markers:Yf([o.edges,o.defaultMarkerColor,o.flowId],([R,L,Y])=>Cne(R,{defaultColor:L,id:Y})),initialized:(()=>{let R=!1;const L=$e(o.nodes).length,Y=$e(o.edges).length;return Yf([o.nodesInitialized,o.edgesInitialized,o.viewportInitialized],([j,J,G])=>R||(L===0?R=G:Y===0?R=G&&j:R=G&&j&&J,R))})(),syncNodeStores:R=>Tie(o.nodes,R),syncEdgeStores:R=>Rie(o.edges,R),syncViewport:R=>Mie(o.panZoom,o.viewport,R),setNodeTypes:l,setEdgeTypes:c,addEdge:h,updateNodePositions:u,updateNodeInternals:d,zoomIn:x,zoomOut:p,fitView:R=>f(R),setMinZoom:y,setMaxZoom:w,setTranslateExtent:_,setPaneClickDistance:C,unselectNodesAndEdges:k,addSelectedNodes:I,addSelectedEdges:S,handleNodeSelection:M,panBy:N,updateConnection:H,cancelConnection:T,reset:z}}function ts(){const n=as(Dy);if(!n)throw new Error("In order to use useStore you need to wrap your component in a <SvelteFlowProvider />");return n.getStore()}function Lie({nodes:n,edges:e,width:t,height:i,fitView:s,nodeOrigin:r,nodeExtent:a}){const o=KO({nodes:n,edges:e,width:t,height:i,fitView:s,nodeOrigin:r,nodeExtent:a});return Ep(Dy,{getStore:()=>o}),o}function Bie(n,e){const{panZoom:t,minZoom:i,maxZoom:s,initialViewport:r,viewport:a,dragging:o,translateExtent:l,paneClickDistance:c}=e,h=Wne({domNode:n,minZoom:i,maxZoom:s,translateExtent:l,viewport:r,paneClickDistance:c,onDraggingChange:o.set}),u=h.getViewport();return a.set(u),t.set(h),h.update(e),{update(d){h.update(d)}}}function Uie(n){let e,t,i,s,r;const a=n[35].default,o=Gs(a,n,n[34],null);return{c(){e=ee("div"),o&&o.c(),this.h()},l(l){e=te(l,"DIV",{class:!0});var c=q(e);o&&o.l(c),c.forEach(E),this.h()},h(){A(e,"class","svelte-flow__zoom svelte-4xkw84")},m(l,c){$(l,e,c),o&&o.m(e,null),i=!0,s||(r=aa(t=Bie.call(null,e,{viewport:n[18],minZoom:n[12],maxZoom:n[13],initialViewport:n[11],dragging:n[23],panZoom:n[19],onPanZoomStart:n[0],onPanZoom:n[1],onPanZoomEnd:n[2],zoomOnScroll:n[5],zoomOnDoubleClick:n[6],zoomOnPinch:n[7],panOnScroll:n[9],panOnDrag:n[10],panOnScrollSpeed:.5,panOnScrollMode:n[3]||nc.Free,zoomActivationKeyPressed:n[14],preventScrolling:typeof n[4]=="boolean"?n[4]:!0,noPanClassName:"nopan",noWheelClassName:"nowheel",userSelectionActive:!!n[15],translateExtent:n[16],lib:n[17],paneClickDistance:n[8],onTransformChange:n[29]})),s=!0)},p(l,c){o&&o.p&&(!i||c[1]&8)&&Vs(o,a,l,l[34],i?Ws(a,l[34],c,null):qs(l[34]),null),t&&Ls(t.update)&&c[0]&262143&&t.update.call(null,{viewport:l[18],minZoom:l[12],maxZoom:l[13],initialViewport:l[11],dragging:l[23],panZoom:l[19],onPanZoomStart:l[0],onPanZoom:l[1],onPanZoomEnd:l[2],zoomOnScroll:l[5],zoomOnDoubleClick:l[6],zoomOnPinch:l[7],panOnScroll:l[9],panOnDrag:l[10],panOnScrollSpeed:.5,panOnScrollMode:l[3]||nc.Free,zoomActivationKeyPressed:l[14],preventScrolling:typeof l[4]=="boolean"?l[4]:!0,noPanClassName:"nopan",noWheelClassName:"nowheel",userSelectionActive:!!l[15],translateExtent:l[16],lib:l[17],paneClickDistance:l[8],onTransformChange:l[29]})},i(l){i||(U(o,l),i=!0)},o(l){W(o,l),i=!1},d(l){l&&E(e),o&&o.d(l),s=!1,r()}}}function Hie(n,e,t){let i,s,r,a,o,l,c,h,u,d,f,{$$slots:g={},$$scope:m}=e,{initialViewport:x=void 0}=e,{onMoveStart:p=void 0}=e,{onMove:y=void 0}=e,{onMoveEnd:w=void 0}=e,{panOnScrollMode:_}=e,{preventScrolling:v}=e,{zoomOnScroll:C}=e,{zoomOnDoubleClick:k}=e,{zoomOnPinch:I}=e,{panOnDrag:S}=e,{panOnScroll:M}=e,{paneClickDistance:N}=e;const{viewport:F,panZoom:H,selectionRect:T,minZoom:z,maxZoom:R,dragging:L,translateExtent:Y,lib:j,panActivationKeyPressed:J,zoomActivationKeyPressed:G,viewportInitialized:se}=ts();Pe(n,T,he=>t(15,u=he)),Pe(n,z,he=>t(12,l=he)),Pe(n,R,he=>t(13,c=he)),Pe(n,Y,he=>t(16,d=he)),Pe(n,j,he=>t(17,f=he)),Pe(n,J,he=>t(33,o=he)),Pe(n,G,he=>t(14,h=he)),Pe(n,se,he=>t(36,a=he));const de=he=>F.set({x:he[0],y:he[1],zoom:he[2]});return ol(()=>{d3(se,a=!0,a)}),n.$$set=he=>{"initialViewport"in he&&t(30,x=he.initialViewport),"onMoveStart"in he&&t(0,p=he.onMoveStart),"onMove"in he&&t(1,y=he.onMove),"onMoveEnd"in he&&t(2,w=he.onMoveEnd),"panOnScrollMode"in he&&t(3,_=he.panOnScrollMode),"preventScrolling"in he&&t(4,v=he.preventScrolling),"zoomOnScroll"in he&&t(5,C=he.zoomOnScroll),"zoomOnDoubleClick"in he&&t(6,k=he.zoomOnDoubleClick),"zoomOnPinch"in he&&t(7,I=he.zoomOnPinch),"panOnDrag"in he&&t(31,S=he.panOnDrag),"panOnScroll"in he&&t(32,M=he.panOnScroll),"paneClickDistance"in he&&t(8,N=he.paneClickDistance),"$$scope"in he&&t(34,m=he.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&1073741824&&t(11,i=x||{x:0,y:0,zoom:1}),n.$$.dirty[1]&5&&t(10,s=o||S),n.$$.dirty[1]&6&&t(9,r=o||M)},[p,y,w,_,v,C,k,I,N,r,s,i,l,c,h,u,d,f,F,H,T,z,R,L,Y,j,J,G,se,de,x,S,M,o,m,g]}class zie extends Nt{constructor(e){super(),Ot(this,e,Hie,Uie,Ut,{initialViewport:30,onMoveStart:0,onMove:1,onMoveEnd:2,panOnScrollMode:3,preventScrolling:4,zoomOnScroll:5,zoomOnDoubleClick:6,zoomOnPinch:7,panOnDrag:31,panOnScroll:32,paneClickDistance:8},null,[-1,-1])}}function jie(n){let e,t,i,s;const r=n[28].default,a=Gs(r,n,n[27],null);return{c(){e=ee("div"),a&&a.c(),this.h()},l(o){e=te(o,"DIV",{class:!0});var l=q(e);a&&a.l(l),l.forEach(E),this.h()},h(){A(e,"class","svelte-flow__pane svelte-1esy7hx"),mn(e,"draggable",n[0]===!0||Array.isArray(n[0])&&n[0].includes(0)),mn(e,"dragging",n[4]),mn(e,"selection",n[1])},m(o,l){$(o,e,l),a&&a.m(e,null),n[29](e),t=!0,i||(s=[yt(e,"click",function(){Ls(n[3]?void 0:b9(n[15],n[2]))&&(n[3]?void 0:b9(n[15],n[2])).apply(this,arguments)}),yt(e,"pointerdown",function(){Ls(n[3]?n[16]:void 0)&&(n[3]?n[16]:void 0).apply(this,arguments)}),yt(e,"pointermove",function(){Ls(n[3]?n[17]:void 0)&&(n[3]?n[17]:void 0).apply(this,arguments)}),yt(e,"pointerup",function(){Ls(n[3]?n[18]:void 0)&&(n[3]?n[18]:void 0).apply(this,arguments)}),yt(e,"contextmenu",function(){Ls(b9(n[19],n[2]))&&b9(n[19],n[2]).apply(this,arguments)})],i=!0)},p(o,l){n=o,a&&a.p&&(!t||l[0]&134217728)&&Vs(a,r,n,n[27],t?Ws(r,n[27],l,null):qs(n[27]),null),(!t||l[0]&1)&&mn(e,"draggable",n[0]===!0||Array.isArray(n[0])&&n[0].includes(0)),(!t||l[0]&16)&&mn(e,"dragging",n[4]),(!t||l[0]&2)&&mn(e,"selection",n[1])},i(o){t||(U(a,o),t=!0)},o(o){W(a,o),t=!1},d(o){o&&E(e),a&&a.d(o),n[29](null),i=!1,Qr(s)}}}function b9(n,e){return t=>{t.target===e&&(n==null||n(t))}}function _S(n){return e=>{const t=n.includes(e.id);return e.selected!==t&&(e.selected=t),e}}function Gie(n,e,t){let i,s,r,a,o,l,c,h,u,d,f,g,m,{$$slots:x={},$$scope:p}=e,{panOnDrag:y=void 0}=e,{selectionOnDrag:w=void 0}=e;const _=Xa(),{nodes:v,nodeLookup:C,edges:k,viewport:I,dragging:S,elementsSelectable:M,selectionRect:N,selectionRectMode:F,selectionKeyPressed:H,selectionMode:T,panActivationKeyPressed:z,unselectNodesAndEdges:R}=ts();Pe(n,C,P=>t(36,u=P)),Pe(n,k,P=>t(33,l=P)),Pe(n,I,P=>t(35,h=P)),Pe(n,S,P=>t(4,m=P)),Pe(n,M,P=>t(25,f=P)),Pe(n,N,P=>t(24,d=P)),Pe(n,F,P=>t(23,o=P)),Pe(n,H,P=>t(22,a=P)),Pe(n,T,P=>t(34,c=P)),Pe(n,z,P=>t(26,g=P));let L,Y=null,j=[],J=!1;function G(P){if(J){J=!1;return}_("paneclick",{event:P}),R(),F.set(null)}function se(P){var X,ue;if(Y=L.getBoundingClientRect(),!M||!s||P.button!==0||P.target!==L||!Y)return;(ue=(X=P.target)==null?void 0:X.setPointerCapture)==null||ue.call(X,P.pointerId);const{x:V,y:re}=d0(P,Y);R(),N.set({width:0,height:0,startX:V,startY:re,x:V,y:re})}function de(P){if(!s||!Y||!d)return;J=!0;const V=d0(P,Y),re=d.startX??0,X=d.startY??0,ue={...d,x:V.x<re?V.x:re,y:V.y<X?V.y:X,width:Math.abs(V.x-re),height:Math.abs(V.y-X)},oe=j.map(Ue=>Ue.id),Q=Y6(j,l).map(Ue=>Ue.id);j=yO(u,ue,[h.x,h.y,h.zoom],c===a5.Partial,!0);const ae=Y6(j,l).map(Ue=>Ue.id),Ke=j.map(Ue=>Ue.id);(oe.length!==Ke.length||Ke.some(Ue=>!oe.includes(Ue)))&&v.update(Ue=>Ue.map(_S(Ke))),(Q.length!==ae.length||ae.some(Ue=>!Q.includes(Ue)))&&k.update(Ue=>Ue.map(_S(ae))),F.set("user"),N.set(ue)}function he(P){var V,re;P.button===0&&((re=(V=P.target)==null?void 0:V.releasePointerCapture)==null||re.call(V,P.pointerId),!s&&o==="user"&&P.target===L&&(G==null||G(P)),N.set(null),j.length>0&&d3(F,o="nodes",o),a&&(J=!1))}const we=P=>{if(Array.isArray(i)&&(i!=null&&i.includes(2))){P.preventDefault();return}_("panecontextmenu",{event:P})};function ye(P){It[P?"unshift":"push"](()=>{L=P,t(2,L)})}return n.$$set=P=>{"panOnDrag"in P&&t(0,y=P.panOnDrag),"selectionOnDrag"in P&&t(20,w=P.selectionOnDrag),"$$scope"in P&&t(27,p=P.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&67108865&&t(21,i=g||y),n.$$.dirty[0]&24117248&&t(1,s=a||d||w&&i!==!0),n.$$.dirty[0]&41943042&&t(3,r=f&&(s||o==="user"))},[y,s,L,r,m,C,k,I,S,M,N,F,H,T,z,G,se,de,he,we,w,i,a,o,d,f,g,p,x,ye]}class Vie extends Nt{constructor(e){super(),Ot(this,e,Gie,jie,Ut,{panOnDrag:0,selectionOnDrag:20},null,[-1,-1])}}function qie(n){let e,t;const i=n[3].default,s=Gs(i,n,n[2],null);return{c(){e=ee("div"),s&&s.c(),this.h()},l(r){e=te(r,"DIV",{class:!0,style:!0});var a=q(e);s&&s.l(a),a.forEach(E),this.h()},h(){A(e,"class","svelte-flow__viewport xyflow__viewport svelte-1floaup"),nn(e,"transform","translate("+n[0].x+"px, "+n[0].y+"px) scale("+n[0].zoom+")")},m(r,a){$(r,e,a),s&&s.m(e,null),t=!0},p(r,[a]){s&&s.p&&(!t||a&4)&&Vs(s,i,r,r[2],t?Ws(i,r[2],a,null):qs(r[2]),null),(!t||a&1)&&nn(e,"transform","translate("+r[0].x+"px, "+r[0].y+"px) scale("+r[0].zoom+")")},i(r){t||(U(s,r),t=!0)},o(r){W(s,r),t=!1},d(r){r&&E(e),s&&s.d(r)}}}function Wie(n,e,t){let i,{$$slots:s={},$$scope:r}=e;const{viewport:a}=ts();return Pe(n,a,o=>t(0,i=o)),n.$$set=o=>{"$$scope"in o&&t(2,r=o.$$scope)},[i,a,r,s]}class Kie extends Nt{constructor(e){super(),Ot(this,e,Wie,qie,Ut,{})}}function XO(n,e){const{store:t,onDrag:i,onDragStart:s,onDragStop:r,onNodeMouseDown:a}=e,o=Pne({onDrag:i,onDragStart:s,onDragStop:r,onNodeMouseDown:a,getStoreItems:()=>{const c=$e(t.snapGrid),h=$e(t.viewport);return{nodes:$e(t.nodes),nodeLookup:$e(t.nodeLookup),edges:$e(t.edges),nodeExtent:$e(t.nodeExtent),snapGrid:c||[0,0],snapToGrid:!!c,nodeOrigin:$e(t.nodeOrigin),multiSelectionActive:$e(t.multiselectionKeyPressed),domNode:$e(t.domNode),transform:[h.x,h.y,h.zoom],autoPanOnNodeDrag:$e(t.autoPanOnNodeDrag),nodesDraggable:$e(t.nodesDraggable),selectNodesOnDrag:$e(t.selectNodesOnDrag),nodeDragThreshold:$e(t.nodeDragThreshold),unselectNodesAndEdges:t.unselectNodesAndEdges,updateNodePositions:t.updateNodePositions,panBy:t.panBy}}});function l(c,h){if(h.disabled){o.destroy();return}o.update({domNode:c,noDragClassName:h.noDragClass,handleSelector:h.handleSelector,nodeId:h.nodeId,isSelectable:h.isSelectable,nodeClickDistance:h.nodeClickDistance})}return l(n,e),{update(c){l(n,c)},destroy(){o.destroy()}}}function Xie({width:n,height:e,initialWidth:t,initialHeight:i,measuredWidth:s,measuredHeight:r}){if(s===void 0&&r===void 0){const a=n??t,o=e??i;return{width:a?`width:${a}px;`:"",height:o?`height:${o}px;`:""}}return{width:n?`width:${n}px;`:"",height:e?`height:${e}px;`:""}}function vS(n){let e,t,i,s,r,a=`translate(${n[12]}px, ${n[13]}px)`,o,l,c;var h=n[27];function u(d,f){return{props:{data:d[2],id:d[1],selected:d[3],selectable:d[5],deletable:d[7],sourcePosition:d[14],targetPosition:d[15],zIndex:d[16],dragging:d[9],draggable:d[4],dragHandle:d[19],parentId:d[21],type:d[25],isConnectable:d[28],positionAbsoluteX:d[12],positionAbsoluteY:d[13],width:d[17],height:d[18]}}}return h&&(t=f3(h,u(n))),{c(){e=ee("div"),t&&me(t.$$.fragment),this.h()},l(d){e=te(d,"DIV",{"data-id":!0,class:!0,style:!0});var f=q(e);t&&xe(t.$$.fragment,f),f.forEach(E),this.h()},h(){A(e,"data-id",n[1]),A(e,"class",i=Ei(["svelte-flow__node",`svelte-flow__node-${n[25]}`,n[23]])),A(e,"style",s=(n[10]??"")+";"+n[26].width+n[26].height),mn(e,"dragging",n[9]),mn(e,"selected",n[3]),mn(e,"draggable",n[4]),mn(e,"connectable",n[6]),mn(e,"selectable",n[5]),mn(e,"nopan",n[4]),mn(e,"parent",n[11]),nn(e,"z-index",n[16]),nn(e,"transform",a),nn(e,"visibility",n[20]?"visible":"hidden")},m(d,f){$(d,e,f),t&&pe(t,e,null),n[50](e),o=!0,l||(c=[aa(r=XO.call(null,e,{nodeId:n[1],isSelectable:n[5],disabled:!1,handleSelector:n[19],noDragClass:"nodrag",nodeClickDistance:n[22],onNodeMouseDown:n[31],onDrag:n[47],onDragStart:n[48],onDragStop:n[49],store:n[29]})),yt(e,"click",n[34]),yt(e,"mouseenter",n[51]),yt(e,"mouseleave",n[52]),yt(e,"mousemove",n[53]),yt(e,"contextmenu",n[54])],l=!0)},p(d,f){if(f[0]&134217728&&h!==(h=d[27])){if(t){bt();const m=t;W(m.$$.fragment,1,0,()=>{be(m,1)}),xt()}h?(t=f3(h,u(d)),me(t.$$.fragment),U(t.$$.fragment,1),pe(t,e,null)):t=null}else if(h){const m={};f[0]&4&&(m.data=d[2]),f[0]&2&&(m.id=d[1]),f[0]&8&&(m.selected=d[3]),f[0]&32&&(m.selectable=d[5]),f[0]&128&&(m.deletable=d[7]),f[0]&16384&&(m.sourcePosition=d[14]),f[0]&32768&&(m.targetPosition=d[15]),f[0]&65536&&(m.zIndex=d[16]),f[0]&512&&(m.dragging=d[9]),f[0]&16&&(m.draggable=d[4]),f[0]&524288&&(m.dragHandle=d[19]),f[0]&2097152&&(m.parentId=d[21]),f[0]&33554432&&(m.type=d[25]),f[0]&268435456&&(m.isConnectable=d[28]),f[0]&4096&&(m.positionAbsoluteX=d[12]),f[0]&8192&&(m.positionAbsoluteY=d[13]),f[0]&131072&&(m.width=d[17]),f[0]&262144&&(m.height=d[18]),t.$set(m)}(!o||f[0]&2)&&A(e,"data-id",d[1]),(!o||f[0]&41943040&&i!==(i=Ei(["svelte-flow__node",`svelte-flow__node-${d[25]}`,d[23]])))&&A(e,"class",i),(!o||f[0]&67109888&&s!==(s=(d[10]??"")+";"+d[26].width+d[26].height))&&A(e,"style",s),r&&Ls(r.update)&&f[0]&4718626&&r.update.call(null,{nodeId:d[1],isSelectable:d[5],disabled:!1,handleSelector:d[19],noDragClass:"nodrag",nodeClickDistance:d[22],onNodeMouseDown:d[31],onDrag:d[47],onDragStart:d[48],onDragStop:d[49],store:d[29]}),(!o||f[0]&41943552)&&mn(e,"dragging",d[9]),(!o||f[0]&41943048)&&mn(e,"selected",d[3]),(!o||f[0]&41943056)&&mn(e,"draggable",d[4]),(!o||f[0]&41943104)&&mn(e,"connectable",d[6]),(!o||f[0]&41943072)&&mn(e,"selectable",d[5]),(!o||f[0]&41943056)&&mn(e,"nopan",d[4]),(!o||f[0]&41945088)&&mn(e,"parent",d[11]);const g=f[0]&67109888;(f[0]&67175424||g)&&nn(e,"z-index",d[16]),(f[0]&67122176&&a!==(a=`translate(${d[12]}px, ${d[13]}px)`)||g)&&nn(e,"transform",a),(f[0]&68158464||g)&&nn(e,"visibility",d[20]?"visible":"hidden")},i(d){o||(t&&U(t.$$.fragment,d),o=!0)},o(d){t&&W(t.$$.fragment,d),o=!1},d(d){d&&E(e),t&&be(t),n[50](null),l=!1,Qr(c)}}}function Yie(n){let e,t,i=!n[8]&&vS(n);return{c(){i&&i.c(),e=zt()},l(s){i&&i.l(s),e=zt()},m(s,r){i&&i.m(s,r),$(s,e,r),t=!0},p(s,r){s[8]?i&&(bt(),W(i,1,1,()=>{i=null}),xt()):i?(i.p(s,r),r[0]&256&&U(i,1)):(i=vS(s),i.c(),U(i,1),i.m(e.parentNode,e))},i(s){t||(U(i),t=!0)},o(s){W(i),t=!1},d(s){s&&E(e),i&&i.d(s)}}}function Jie(n,e,t){let i,s,r,a,o,l,{node:c}=e,{id:h}=e,{data:u={}}=e,{selected:d=!1}=e,{draggable:f=void 0}=e,{selectable:g=void 0}=e,{connectable:m=!0}=e,{deletable:x=!0}=e,{hidden:p=!1}=e,{dragging:y=!1}=e,{resizeObserver:w=null}=e,{style:_=void 0}=e,{type:v="default"}=e,{isParent:C=!1}=e,{positionX:k}=e,{positionY:I}=e,{sourcePosition:S=void 0}=e,{targetPosition:M=void 0}=e,{zIndex:N}=e,{measuredWidth:F=void 0}=e,{measuredHeight:H=void 0}=e,{initialWidth:T=void 0}=e,{initialHeight:z=void 0}=e,{width:R=void 0}=e,{height:L=void 0}=e,{dragHandle:Y=void 0}=e,{initialized:j=!1}=e,{parentId:J=void 0}=e,{nodeClickDistance:G=void 0}=e,{class:se=""}=e;const de=ts(),{nodeTypes:he,nodeDragThreshold:we,selectNodesOnDrag:ye,handleNodeSelection:P,updateNodeInternals:V}=de;Pe(n,he,ge=>t(46,o=ge));let re,X=null;const ue=Xa(),oe=en(m);Pe(n,oe,ge=>t(28,l=ge));let Q,ae,Ke;Ep("svelteflow__node_id",h),Ep("svelteflow__node_connectable",oe),Kh(()=>{X&&(w==null||w.unobserve(X))});function Ue(ge){g&&(!$e(ye)||!f||$e(we)>0)&&P(h),ue("nodeclick",{node:c.internals.userNode,event:ge})}const De=(ge,Pt,lt,ct)=>{ue("nodedrag",{event:ge,targetNode:lt,nodes:ct})},je=(ge,Pt,lt,ct)=>{ue("nodedragstart",{event:ge,targetNode:lt,nodes:ct})},ze=(ge,Pt,lt,ct)=>{ue("nodedragstop",{event:ge,targetNode:lt,nodes:ct})};function Qe(ge){It[ge?"unshift":"push"](()=>{re=ge,t(24,re)})}const ft=ge=>ue("nodemouseenter",{node:c,event:ge}),ut=ge=>ue("nodemouseleave",{node:c,event:ge}),Je=ge=>ue("nodemousemove",{node:c,event:ge}),rt=ge=>ue("nodecontextmenu",{node:c,event:ge});return n.$$set=ge=>{"node"in ge&&t(0,c=ge.node),"id"in ge&&t(1,h=ge.id),"data"in ge&&t(2,u=ge.data),"selected"in ge&&t(3,d=ge.selected),"draggable"in ge&&t(4,f=ge.draggable),"selectable"in ge&&t(5,g=ge.selectable),"connectable"in ge&&t(6,m=ge.connectable),"deletable"in ge&&t(7,x=ge.deletable),"hidden"in ge&&t(8,p=ge.hidden),"dragging"in ge&&t(9,y=ge.dragging),"resizeObserver"in ge&&t(35,w=ge.resizeObserver),"style"in ge&&t(10,_=ge.style),"type"in ge&&t(36,v=ge.type),"isParent"in ge&&t(11,C=ge.isParent),"positionX"in ge&&t(12,k=ge.positionX),"positionY"in ge&&t(13,I=ge.positionY),"sourcePosition"in ge&&t(14,S=ge.sourcePosition),"targetPosition"in ge&&t(15,M=ge.targetPosition),"zIndex"in ge&&t(16,N=ge.zIndex),"measuredWidth"in ge&&t(37,F=ge.measuredWidth),"measuredHeight"in ge&&t(38,H=ge.measuredHeight),"initialWidth"in ge&&t(39,T=ge.initialWidth),"initialHeight"in ge&&t(40,z=ge.initialHeight),"width"in ge&&t(17,R=ge.width),"height"in ge&&t(18,L=ge.height),"dragHandle"in ge&&t(19,Y=ge.dragHandle),"initialized"in ge&&t(20,j=ge.initialized),"parentId"in ge&&t(21,J=ge.parentId),"nodeClickDistance"in ge&&t(22,G=ge.nodeClickDistance),"class"in ge&&t(23,se=ge.class)},n.$$.update=()=>{n.$$.dirty[1]&32&&t(25,i=v||"default"),n.$$.dirty[0]&33554432|n.$$.dirty[1]&32768&&t(45,s=!!o[i]),n.$$.dirty[0]&33554432|n.$$.dirty[1]&32768&&t(27,r=o[i]||jO),n.$$.dirty[1]&16416&&(s||console.warn("003",Cx.error003(v))),n.$$.dirty[0]&393216|n.$$.dirty[1]&960&&t(26,a=Xie({width:R,height:L,initialWidth:T,initialHeight:z,measuredWidth:F,measuredHeight:H})),n.$$.dirty[0]&64&&oe.set(!!m),n.$$.dirty[0]&50380802|n.$$.dirty[1]&14336&&((Q&&i!==Q||ae&&S!==ae||Ke&&M!==Ke)&&requestAnimationFrame(()=>V(new Map([[h,{id:h,nodeElement:re,force:!0}]]))),t(42,Q=i),t(43,ae=S),t(44,Ke=M)),n.$$.dirty[0]&17825792|n.$$.dirty[1]&1040&&w&&(re!==X||!j)&&(X&&w.unobserve(X),re&&w.observe(re),t(41,X=re))},[c,h,u,d,f,g,m,x,p,y,_,C,k,I,S,M,N,R,L,Y,j,J,G,se,re,i,a,r,l,de,he,P,ue,oe,Ue,w,v,F,H,T,z,X,Q,ae,Ke,s,o,De,je,ze,Qe,ft,ut,Je,rt]}class Zie extends Nt{constructor(e){super(),Ot(this,e,Jie,Yie,TI,{node:0,id:1,data:2,selected:3,draggable:4,selectable:5,connectable:6,deletable:7,hidden:8,dragging:9,resizeObserver:35,style:10,type:36,isParent:11,positionX:12,positionY:13,sourcePosition:14,targetPosition:15,zIndex:16,measuredWidth:37,measuredHeight:38,initialWidth:39,initialHeight:40,width:17,height:18,dragHandle:19,initialized:20,parentId:21,nodeClickDistance:22,class:23},null,[-1,-1])}}const{Map:Qie}=RI;function kS(n,e,t){const i=n.slice();return i[21]=e[t],i}function CS(n,e){let t,i,s;return i=new Zie({props:{node:e[21],id:e[21].id,data:e[21].data,selected:!!e[21].selected,hidden:!!e[21].hidden,draggable:!!(e[21].draggable||e[2]&&typeof e[21].draggable>"u"),selectable:!!(e[21].selectable||e[3]&&typeof e[21].selectable>"u"),connectable:!!(e[21].connectable||e[4]&&typeof e[21].connectable>"u"),deletable:e[21].deletable??!0,positionX:e[21].internals.positionAbsolute.x,positionY:e[21].internals.positionAbsolute.y,isParent:e[5].has(e[21].id),style:e[21].style,class:e[21].class,type:e[21].type??"default",sourcePosition:e[21].sourcePosition,targetPosition:e[21].targetPosition,dragging:e[21].dragging,zIndex:e[21].internals.z??0,dragHandle:e[21].dragHandle,initialized:cS(e[21]),width:e[21].width,height:e[21].height,initialWidth:e[21].initialWidth,initialHeight:e[21].initialHeight,measuredWidth:e[21].measured.width,measuredHeight:e[21].measured.height,parentId:e[21].parentId,resizeObserver:e[11],nodeClickDistance:e[0]}}),i.$on("nodeclick",e[12]),i.$on("nodemouseenter",e[13]),i.$on("nodemousemove",e[14]),i.$on("nodemouseleave",e[15]),i.$on("nodedrag",e[16]),i.$on("nodedragstart",e[17]),i.$on("nodedragstop",e[18]),i.$on("nodecontextmenu",e[19]),{key:n,first:null,c(){t=zt(),me(i.$$.fragment),this.h()},l(r){t=zt(),xe(i.$$.fragment,r),this.h()},h(){this.first=t},m(r,a){$(r,t,a),pe(i,r,a),s=!0},p(r,a){e=r;const o={};a&2&&(o.node=e[21]),a&2&&(o.id=e[21].id),a&2&&(o.data=e[21].data),a&2&&(o.selected=!!e[21].selected),a&2&&(o.hidden=!!e[21].hidden),a&6&&(o.draggable=!!(e[21].draggable||e[2]&&typeof e[21].draggable>"u")),a&10&&(o.selectable=!!(e[21].selectable||e[3]&&typeof e[21].selectable>"u")),a&18&&(o.connectable=!!(e[21].connectable||e[4]&&typeof e[21].connectable>"u")),a&2&&(o.deletable=e[21].deletable??!0),a&2&&(o.positionX=e[21].internals.positionAbsolute.x),a&2&&(o.positionY=e[21].internals.positionAbsolute.y),a&34&&(o.isParent=e[5].has(e[21].id)),a&2&&(o.style=e[21].style),a&2&&(o.class=e[21].class),a&2&&(o.type=e[21].type??"default"),a&2&&(o.sourcePosition=e[21].sourcePosition),a&2&&(o.targetPosition=e[21].targetPosition),a&2&&(o.dragging=e[21].dragging),a&2&&(o.zIndex=e[21].internals.z??0),a&2&&(o.dragHandle=e[21].dragHandle),a&2&&(o.initialized=cS(e[21])),a&2&&(o.width=e[21].width),a&2&&(o.height=e[21].height),a&2&&(o.initialWidth=e[21].initialWidth),a&2&&(o.initialHeight=e[21].initialHeight),a&2&&(o.measuredWidth=e[21].measured.width),a&2&&(o.measuredHeight=e[21].measured.height),a&2&&(o.parentId=e[21].parentId),a&1&&(o.nodeClickDistance=e[0]),i.$set(o)},i(r){s||(U(i.$$.fragment,r),s=!0)},o(r){W(i.$$.fragment,r),s=!1},d(r){r&&E(t),be(i,r)}}}function $ie(n){let e,t=[],i=new Qie,s,r=Zn(n[1]);const a=o=>o[21].id;for(let o=0;o<r.length;o+=1){let l=kS(n,r,o),c=a(l);i.set(c,t[o]=CS(c,l))}return{c(){e=ee("div");for(let o=0;o<t.length;o+=1)t[o].c();this.h()},l(o){e=te(o,"DIV",{class:!0});var l=q(e);for(let c=0;c<t.length;c+=1)t[c].l(l);l.forEach(E),this.h()},h(){A(e,"class","svelte-flow__nodes svelte-tf4uy4")},m(o,l){$(o,e,l);for(let c=0;c<t.length;c+=1)t[c]&&t[c].m(e,null);s=!0},p(o,[l]){l&2111&&(r=Zn(o[1]),bt(),t=ix(t,l,a,1,o,r,i,e,q5,CS,null,kS),xt())},i(o){if(!s){for(let l=0;l<r.length;l+=1)U(t[l]);s=!0}},o(o){for(let l=0;l<t.length;l+=1)W(t[l]);s=!1},d(o){o&&E(e);for(let l=0;l<t.length;l+=1)t[l].d()}}}function ese(n,e,t){let i,s,r,a,o,{nodeClickDistance:l=0}=e;const{visibleNodes:c,nodesDraggable:h,nodesConnectable:u,elementsSelectable:d,updateNodeInternals:f,parentLookup:g}=ts();Pe(n,c,I=>t(1,i=I)),Pe(n,h,I=>t(2,s=I)),Pe(n,u,I=>t(4,a=I)),Pe(n,d,I=>t(3,r=I)),Pe(n,g,I=>t(5,o=I));const m=typeof ResizeObserver>"u"?null:new ResizeObserver(I=>{const S=new Map;I.forEach(M=>{const N=M.target.getAttribute("data-id");S.set(N,{id:N,nodeElement:M.target,force:!0})}),f(S)});Kh(()=>{m==null||m.disconnect()});function x(I){Xn.call(this,n,I)}function p(I){Xn.call(this,n,I)}function y(I){Xn.call(this,n,I)}function w(I){Xn.call(this,n,I)}function _(I){Xn.call(this,n,I)}function v(I){Xn.call(this,n,I)}function C(I){Xn.call(this,n,I)}function k(I){Xn.call(this,n,I)}return n.$$set=I=>{"nodeClickDistance"in I&&t(0,l=I.nodeClickDistance)},[l,i,s,r,a,o,c,h,u,d,g,m,x,p,y,w,_,v,C,k]}class tse extends Nt{constructor(e){super(),Ot(this,e,ese,$ie,Ut,{nodeClickDistance:0})}}function AS(n){let e,t,i,s,r,a,o,l;var c=n[27];function h(u,d){return{props:{id:u[0],source:u[1],target:u[2],sourceX:u[14],sourceY:u[15],targetX:u[16],targetY:u[17],sourcePosition:u[18],targetPosition:u[19],animated:u[6],selected:u[7],label:u[10],labelStyle:u[11],data:u[3],style:u[4],interactionWidth:u[21],selectable:u[24],deletable:u[8]??!0,type:u[23],sourceHandleId:u[12],targetHandleId:u[13],markerStart:u[26],markerEnd:u[25]}}}return c&&(i=f3(c,h(n))),{c(){e=at("svg"),t=at("g"),i&&me(i.$$.fragment),this.h()},l(u){e=ot(u,"svg",{});var d=q(e);t=ot(d,"g",{class:!0,"data-id":!0,"aria-label":!0,role:!0});var f=q(t);i&&xe(i.$$.fragment,f),f.forEach(E),d.forEach(E),this.h()},h(){A(t,"class",s=Ei(["svelte-flow__edge",n[22]])),A(t,"data-id",n[0]),A(t,"aria-label",r=n[20]===null?void 0:n[20]?n[20]:`Edge from ${n[1]} to ${n[2]}`),A(t,"role","img"),mn(t,"animated",n[6]),mn(t,"selected",n[7]),mn(t,"selectable",n[24]),nn(e,"z-index",n[5])},m(u,d){$(u,e,d),K(e,t),i&&pe(i,t,null),a=!0,o||(l=[yt(t,"click",n[32]),yt(t,"contextmenu",n[41]),yt(t,"mouseenter",n[42]),yt(t,"mouseleave",n[43])],o=!0)},p(u,d){if(d[0]&134217728&&c!==(c=u[27])){if(i){bt();const f=i;W(f.$$.fragment,1,0,()=>{be(f,1)}),xt()}c?(i=f3(c,h(u)),me(i.$$.fragment),U(i.$$.fragment,1),pe(i,t,null)):i=null}else if(c){const f={};d[0]&1&&(f.id=u[0]),d[0]&2&&(f.source=u[1]),d[0]&4&&(f.target=u[2]),d[0]&16384&&(f.sourceX=u[14]),d[0]&32768&&(f.sourceY=u[15]),d[0]&65536&&(f.targetX=u[16]),d[0]&131072&&(f.targetY=u[17]),d[0]&262144&&(f.sourcePosition=u[18]),d[0]&524288&&(f.targetPosition=u[19]),d[0]&64&&(f.animated=u[6]),d[0]&128&&(f.selected=u[7]),d[0]&1024&&(f.label=u[10]),d[0]&2048&&(f.labelStyle=u[11]),d[0]&8&&(f.data=u[3]),d[0]&16&&(f.style=u[4]),d[0]&2097152&&(f.interactionWidth=u[21]),d[0]&16777216&&(f.selectable=u[24]),d[0]&256&&(f.deletable=u[8]??!0),d[0]&8388608&&(f.type=u[23]),d[0]&4096&&(f.sourceHandleId=u[12]),d[0]&8192&&(f.targetHandleId=u[13]),d[0]&67108864&&(f.markerStart=u[26]),d[0]&33554432&&(f.markerEnd=u[25]),i.$set(f)}(!a||d[0]&4194304&&s!==(s=Ei(["svelte-flow__edge",u[22]])))&&A(t,"class",s),(!a||d[0]&1)&&A(t,"data-id",u[0]),(!a||d[0]&1048582&&r!==(r=u[20]===null?void 0:u[20]?u[20]:`Edge from ${u[1]} to ${u[2]}`))&&A(t,"aria-label",r),(!a||d[0]&4194368)&&mn(t,"animated",u[6]),(!a||d[0]&4194432)&&mn(t,"selected",u[7]),(!a||d[0]&20971520)&&mn(t,"selectable",u[24]),d[0]&32&&nn(e,"z-index",u[5])},i(u){a||(i&&U(i.$$.fragment,u),a=!0)},o(u){i&&W(i.$$.fragment,u),a=!1},d(u){u&&E(e),i&&be(i),o=!1,Qr(l)}}}function nse(n){let e,t,i=!n[9]&&AS(n);return{c(){i&&i.c(),e=zt()},l(s){i&&i.l(s),e=zt()},m(s,r){i&&i.m(s,r),$(s,e,r),t=!0},p(s,r){s[9]?i&&(bt(),W(i,1,1,()=>{i=null}),xt()):i?(i.p(s,r),r[0]&512&&U(i,1)):(i=AS(s),i.c(),U(i,1),i.m(e.parentNode,e))},i(s){t||(U(i),t=!0)},o(s){W(i),t=!1},d(s){s&&E(e),i&&i.d(s)}}}function ise(n,e,t){let i,s,r,a,o,l,c,h,u,{id:d}=e,{type:f="default"}=e,{source:g=""}=e,{target:m=""}=e,{data:x={}}=e,{style:p=void 0}=e,{zIndex:y=void 0}=e,{animated:w=!1}=e,{selected:_=!1}=e,{selectable:v=void 0}=e,{deletable:C=void 0}=e,{hidden:k=!1}=e,{label:I=void 0}=e,{labelStyle:S=void 0}=e,{markerStart:M=void 0}=e,{markerEnd:N=void 0}=e,{sourceHandle:F=void 0}=e,{targetHandle:H=void 0}=e,{sourceX:T}=e,{sourceY:z}=e,{targetX:R}=e,{targetY:L}=e,{sourcePosition:Y}=e,{targetPosition:j}=e,{ariaLabel:J=void 0}=e,{interactionWidth:G=void 0}=e,{class:se=""}=e;Ep("svelteflow__edge_id",d);const{edgeLookup:de,edgeTypes:he,flowId:we,elementsSelectable:ye}=ts();Pe(n,de,ae=>t(44,l=ae)),Pe(n,he,ae=>t(40,u=ae)),Pe(n,we,ae=>t(39,h=ae)),Pe(n,ye,ae=>t(38,c=ae));const P=Xa(),V=GO();function re(ae){const Ke=l.get(d);Ke&&(V(d),P("edgeclick",{event:ae,edge:Ke}))}function X(ae,Ke){const Ue=l.get(d);Ue&&P(Ke,{event:ae,edge:Ue})}const ue=ae=>{X(ae,"edgecontextmenu")},oe=ae=>{X(ae,"edgemouseenter")},Q=ae=>{X(ae,"edgemouseleave")};return n.$$set=ae=>{"id"in ae&&t(0,d=ae.id),"type"in ae&&t(34,f=ae.type),"source"in ae&&t(1,g=ae.source),"target"in ae&&t(2,m=ae.target),"data"in ae&&t(3,x=ae.data),"style"in ae&&t(4,p=ae.style),"zIndex"in ae&&t(5,y=ae.zIndex),"animated"in ae&&t(6,w=ae.animated),"selected"in ae&&t(7,_=ae.selected),"selectable"in ae&&t(35,v=ae.selectable),"deletable"in ae&&t(8,C=ae.deletable),"hidden"in ae&&t(9,k=ae.hidden),"label"in ae&&t(10,I=ae.label),"labelStyle"in ae&&t(11,S=ae.labelStyle),"markerStart"in ae&&t(36,M=ae.markerStart),"markerEnd"in ae&&t(37,N=ae.markerEnd),"sourceHandle"in ae&&t(12,F=ae.sourceHandle),"targetHandle"in ae&&t(13,H=ae.targetHandle),"sourceX"in ae&&t(14,T=ae.sourceX),"sourceY"in ae&&t(15,z=ae.sourceY),"targetX"in ae&&t(16,R=ae.targetX),"targetY"in ae&&t(17,L=ae.targetY),"sourcePosition"in ae&&t(18,Y=ae.sourcePosition),"targetPosition"in ae&&t(19,j=ae.targetPosition),"ariaLabel"in ae&&t(20,J=ae.ariaLabel),"interactionWidth"in ae&&t(21,G=ae.interactionWidth),"class"in ae&&t(22,se=ae.class)},n.$$.update=()=>{n.$$.dirty[1]&8&&t(23,i=f||"default"),n.$$.dirty[0]&8388608|n.$$.dirty[1]&512&&t(27,s=u[i]||VO),n.$$.dirty[1]&288&&t(26,r=M?`url('#${Z6(M,h)}')`:void 0),n.$$.dirty[1]&320&&t(25,a=N?`url('#${Z6(N,h)}')`:void 0),n.$$.dirty[1]&144&&t(24,o=v??c)},[d,g,m,x,p,y,w,_,C,k,I,S,F,H,T,z,R,L,Y,j,J,G,se,i,o,a,r,s,de,he,we,ye,re,X,f,v,M,N,c,h,u,ue,oe,Q]}class sse extends Nt{constructor(e){super(),Ot(this,e,ise,nse,TI,{id:0,type:34,source:1,target:2,data:3,style:4,zIndex:5,animated:6,selected:7,selectable:35,deletable:8,hidden:9,label:10,labelStyle:11,markerStart:36,markerEnd:37,sourceHandle:12,targetHandle:13,sourceX:14,sourceY:15,targetX:16,targetY:17,sourcePosition:18,targetPosition:19,ariaLabel:20,interactionWidth:21,class:22},null,[-1,-1])}}function rse(n,e,t){let{onMount:i=void 0}=e,{onDestroy:s=void 0}=e;return ol(()=>(i==null||i(),s)),n.$$set=r=>{"onMount"in r&&t(0,i=r.onMount),"onDestroy"in r&&t(1,s=r.onDestroy)},[i,s]}class ase extends Nt{constructor(e){super(),Ot(this,e,rse,null,Ut,{onMount:0,onDestroy:1})}}function SS(n,e,t){const i=n.slice();return i[2]=e[t],i}function IS(n,e){let t,i,s;const r=[e[2]];let a={};for(let o=0;o<r.length;o+=1)a=oi(a,r[o]);return i=new gse({props:a}),{key:n,first:null,c(){t=zt(),me(i.$$.fragment),this.h()},l(o){t=zt(),xe(i.$$.fragment,o),this.h()},h(){this.first=t},m(o,l){$(o,t,l),pe(i,o,l),s=!0},p(o,l){e=o;const c=l&1?Lh(r,[Tp(e[2])]):{};i.$set(c)},i(o){s||(U(i.$$.fragment,o),s=!0)},o(o){W(i.$$.fragment,o),s=!1},d(o){o&&E(t),be(i,o)}}}function ose(n){let e,t=[],i=new Map,s,r=Zn(n[0]);const a=o=>o[2].id;for(let o=0;o<r.length;o+=1){let l=SS(n,r,o),c=a(l);i.set(c,t[o]=IS(c,l))}return{c(){e=at("defs");for(let o=0;o<t.length;o+=1)t[o].c()},l(o){e=ot(o,"defs",{});var l=q(e);for(let c=0;c<t.length;c+=1)t[c].l(l);l.forEach(E)},m(o,l){$(o,e,l);for(let c=0;c<t.length;c+=1)t[c]&&t[c].m(e,null);s=!0},p(o,[l]){l&1&&(r=Zn(o[0]),bt(),t=ix(t,l,a,1,o,r,i,e,q5,IS,null,SS),xt())},i(o){if(!s){for(let l=0;l<r.length;l+=1)U(t[l]);s=!0}},o(o){for(let l=0;l<t.length;l+=1)W(t[l]);s=!1},d(o){o&&E(e);for(let l=0;l<t.length;l+=1)t[l].d()}}}function lse(n,e,t){let i;const{markers:s}=ts();return Pe(n,s,r=>t(0,i=r)),[i,s]}class cse extends Nt{constructor(e){super(),Ot(this,e,lse,ose,Ut,{})}}function hse(n){let e;return{c(){e=at("polyline"),this.h()},l(t){e=ot(t,"polyline",{stroke:!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,fill:!0,points:!0}),q(e).forEach(E),this.h()},h(){A(e,"stroke",n[6]),A(e,"stroke-linecap","round"),A(e,"stroke-linejoin","round"),A(e,"stroke-width",n[7]),A(e,"fill",n[6]),A(e,"points","-5,-4 0,0 -5,4 -5,-4")},m(t,i){$(t,e,i)},p(t,i){i&64&&A(e,"stroke",t[6]),i&128&&A(e,"stroke-width",t[7]),i&64&&A(e,"fill",t[6])},d(t){t&&E(e)}}}function use(n){let e;return{c(){e=at("polyline"),this.h()},l(t){e=ot(t,"polyline",{stroke:!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,fill:!0,points:!0}),q(e).forEach(E),this.h()},h(){A(e,"stroke",n[6]),A(e,"stroke-linecap","round"),A(e,"stroke-linejoin","round"),A(e,"stroke-width",n[7]),A(e,"fill","none"),A(e,"points","-5,-4 0,0 -5,4")},m(t,i){$(t,e,i)},p(t,i){i&64&&A(e,"stroke",t[6]),i&128&&A(e,"stroke-width",t[7])},d(t){t&&E(e)}}}function dse(n){let e,t,i;function s(o,l){if(o[1]===o5.Arrow)return use;if(o[1]===o5.ArrowClosed)return hse}let r=s(n),a=r&&r(n);return{c(){e=at("marker"),a&&a.c(),this.h()},l(o){e=ot(o,"marker",{class:!0,id:!0,markerWidth:!0,markerHeight:!0,viewBox:!0,markerUnits:!0,orient:!0,refX:!0,refY:!0});var l=q(e);a&&a.l(l),l.forEach(E),this.h()},h(){A(e,"class","svelte-flow__arrowhead"),A(e,"id",n[0]),A(e,"markerWidth",t=`${n[2]}`),A(e,"markerHeight",i=`${n[3]}`),A(e,"viewBox","-10 -10 20 20"),A(e,"markerUnits",n[4]),A(e,"orient",n[5]),A(e,"refX","0"),A(e,"refY","0")},m(o,l){$(o,e,l),a&&a.m(e,null)},p(o,[l]){r===(r=s(o))&&a?a.p(o,l):(a&&a.d(1),a=r&&r(o),a&&(a.c(),a.m(e,null))),l&1&&A(e,"id",o[0]),l&4&&t!==(t=`${o[2]}`)&&A(e,"markerWidth",t),l&8&&i!==(i=`${o[3]}`)&&A(e,"markerHeight",i),l&16&&A(e,"markerUnits",o[4]),l&32&&A(e,"orient",o[5])},i:Ct,o:Ct,d(o){o&&E(e),a&&a.d()}}}function fse(n,e,t){let{id:i}=e,{type:s}=e,{width:r=12.5}=e,{height:a=12.5}=e,{markerUnits:o="strokeWidth"}=e,{orient:l="auto-start-reverse"}=e,{color:c=void 0}=e,{strokeWidth:h=void 0}=e;return n.$$set=u=>{"id"in u&&t(0,i=u.id),"type"in u&&t(1,s=u.type),"width"in u&&t(2,r=u.width),"height"in u&&t(3,a=u.height),"markerUnits"in u&&t(4,o=u.markerUnits),"orient"in u&&t(5,l=u.orient),"color"in u&&t(6,c=u.color),"strokeWidth"in u&&t(7,h=u.strokeWidth)},[i,s,r,a,o,l,c,h]}class gse extends Nt{constructor(e){super(),Ot(this,e,fse,dse,Ut,{id:0,type:1,width:2,height:3,markerUnits:4,orient:5,color:6,strokeWidth:7})}}function ES(n,e,t){const i=n.slice();return i[14]=e[t],i}function TS(n,e){let t,i,s;return i=new sse({props:{id:e[14].id,source:e[14].source,target:e[14].target,data:e[14].data,style:e[14].style,animated:e[14].animated,selected:e[14].selected,selectable:e[14].selectable??e[1],deletable:e[14].deletable,hidden:e[14].hidden,label:e[14].label,labelStyle:e[14].labelStyle,markerStart:e[14].markerStart,markerEnd:e[14].markerEnd,sourceHandle:e[14].sourceHandle,targetHandle:e[14].targetHandle,sourceX:e[14].sourceX,sourceY:e[14].sourceY,targetX:e[14].targetX,targetY:e[14].targetY,sourcePosition:e[14].sourcePosition,targetPosition:e[14].targetPosition,ariaLabel:e[14].ariaLabel,interactionWidth:e[14].interactionWidth,class:e[14].class,type:e[14].type||"default",zIndex:e[14].zIndex}}),i.$on("edgeclick",e[7]),i.$on("edgecontextmenu",e[8]),i.$on("edgemouseenter",e[9]),i.$on("edgemouseleave",e[10]),{key:n,first:null,c(){t=zt(),me(i.$$.fragment),this.h()},l(r){t=zt(),xe(i.$$.fragment,r),this.h()},h(){this.first=t},m(r,a){$(r,t,a),pe(i,r,a),s=!0},p(r,a){e=r;const o={};a&1&&(o.id=e[14].id),a&1&&(o.source=e[14].source),a&1&&(o.target=e[14].target),a&1&&(o.data=e[14].data),a&1&&(o.style=e[14].style),a&1&&(o.animated=e[14].animated),a&1&&(o.selected=e[14].selected),a&3&&(o.selectable=e[14].selectable??e[1]),a&1&&(o.deletable=e[14].deletable),a&1&&(o.hidden=e[14].hidden),a&1&&(o.label=e[14].label),a&1&&(o.labelStyle=e[14].labelStyle),a&1&&(o.markerStart=e[14].markerStart),a&1&&(o.markerEnd=e[14].markerEnd),a&1&&(o.sourceHandle=e[14].sourceHandle),a&1&&(o.targetHandle=e[14].targetHandle),a&1&&(o.sourceX=e[14].sourceX),a&1&&(o.sourceY=e[14].sourceY),a&1&&(o.targetX=e[14].targetX),a&1&&(o.targetY=e[14].targetY),a&1&&(o.sourcePosition=e[14].sourcePosition),a&1&&(o.targetPosition=e[14].targetPosition),a&1&&(o.ariaLabel=e[14].ariaLabel),a&1&&(o.interactionWidth=e[14].interactionWidth),a&1&&(o.class=e[14].class),a&1&&(o.type=e[14].type||"default"),a&1&&(o.zIndex=e[14].zIndex),i.$set(o)},i(r){s||(U(i.$$.fragment,r),s=!0)},o(r){W(i.$$.fragment,r),s=!1},d(r){r&&E(t),be(i,r)}}}function RS(n){let e,t;return e=new ase({props:{onMount:n[11],onDestroy:n[12]}}),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p(i,s){const r={};s&4&&(r.onMount=i[11]),s&4&&(r.onDestroy=i[12]),e.$set(r)},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function mse(n){let e,t,i,s,r=[],a=new Map,o,l;i=new cse({});let c=Zn(n[0]);const h=d=>d[14].id;for(let d=0;d<c.length;d+=1){let f=ES(n,c,d),g=h(f);a.set(g,r[d]=TS(g,f))}let u=n[0].length>0&&RS(n);return{c(){e=ee("div"),t=at("svg"),me(i.$$.fragment),s=Ce();for(let d=0;d<r.length;d+=1)r[d].c();o=Ce(),u&&u.c(),this.h()},l(d){e=te(d,"DIV",{class:!0});var f=q(e);t=ot(f,"svg",{class:!0});var g=q(t);xe(i.$$.fragment,g),g.forEach(E),s=Ae(f);for(let m=0;m<r.length;m+=1)r[m].l(f);o=Ae(f),u&&u.l(f),f.forEach(E),this.h()},h(){A(t,"class","svelte-flow__marker"),A(e,"class","svelte-flow__edges")},m(d,f){$(d,e,f),K(e,t),pe(i,t,null),K(e,s);for(let g=0;g<r.length;g+=1)r[g]&&r[g].m(e,null);K(e,o),u&&u.m(e,null),l=!0},p(d,[f]){f&3&&(c=Zn(d[0]),bt(),r=ix(r,f,h,1,d,c,a,e,q5,TS,o,ES),xt()),d[0].length>0?u?(u.p(d,f),f&1&&U(u,1)):(u=RS(d),u.c(),U(u,1),u.m(e,null)):u&&(bt(),W(u,1,1,()=>{u=null}),xt())},i(d){if(!l){U(i.$$.fragment,d);for(let f=0;f<c.length;f+=1)U(r[f]);U(u),l=!0}},o(d){W(i.$$.fragment,d);for(let f=0;f<r.length;f+=1)W(r[f]);W(u),l=!1},d(d){d&&E(e),be(i);for(let f=0;f<r.length;f+=1)r[f].d();u&&u.d()}}}function pse(n,e,t){let i,s,r,{defaultEdgeOptions:a}=e;const{visibleEdges:o,edgesInitialized:l,edges:{setDefaultOptions:c},elementsSelectable:h}=ts();Pe(n,o,p=>t(0,i=p)),Pe(n,l,p=>t(2,r=p)),Pe(n,h,p=>t(1,s=p)),ol(()=>{a&&c(a)});function u(p){Xn.call(this,n,p)}function d(p){Xn.call(this,n,p)}function f(p){Xn.call(this,n,p)}function g(p){Xn.call(this,n,p)}const m=()=>{d3(l,r=!0,r)},x=()=>{d3(l,r=!1,r)};return n.$$set=p=>{"defaultEdgeOptions"in p&&t(6,a=p.defaultEdgeOptions)},[i,s,r,o,l,h,a,u,d,f,g,m,x]}class bse extends Nt{constructor(e){super(),Ot(this,e,pse,mse,Ut,{defaultEdgeOptions:6})}}function MS(n){let e;return{c(){e=ee("div"),this.h()},l(t){e=te(t,"DIV",{class:!0}),q(e).forEach(E),this.h()},h(){A(e,"class","svelte-flow__selection svelte-1iugwpu"),nn(e,"width",typeof n[2]=="string"?n[2]:`${n[2]}px`),nn(e,"height",typeof n[3]=="string"?n[3]:`${n[3]}px`),nn(e,"transform",`translate(${n[0]}px, ${n[1]}px)`)},m(t,i){$(t,e,i)},p(t,i){i&4&&nn(e,"width",typeof t[2]=="string"?t[2]:`${t[2]}px`),i&8&&nn(e,"height",typeof t[3]=="string"?t[3]:`${t[3]}px`),i&3&&nn(e,"transform",`translate(${t[0]}px, ${t[1]}px)`)},d(t){t&&E(e)}}}function xse(n){let e,t=n[4]&&MS(n);return{c(){t&&t.c(),e=zt()},l(i){t&&t.l(i),e=zt()},m(i,s){t&&t.m(i,s),$(i,e,s)},p(i,[s]){i[4]?t?t.p(i,s):(t=MS(i),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:Ct,o:Ct,d(i){i&&E(e),t&&t.d(i)}}}function yse(n,e,t){let{x:i=0}=e,{y:s=0}=e,{width:r=0}=e,{height:a=0}=e,{isVisible:o=!0}=e;return n.$$set=l=>{"x"in l&&t(0,i=l.x),"y"in l&&t(1,s=l.y),"width"in l&&t(2,r=l.width),"height"in l&&t(3,a=l.height),"isVisible"in l&&t(4,o=l.isVisible)},[i,s,r,a,o]}class YO extends Nt{constructor(e){super(),Ot(this,e,yse,xse,Ut,{x:0,y:1,width:2,height:3,isVisible:4})}}function wse(n){var i,s,r,a;let e,t;return e=new YO({props:{isVisible:!!(n[0]&&n[1]==="user"),width:(i=n[0])==null?void 0:i.width,height:(s=n[0])==null?void 0:s.height,x:(r=n[0])==null?void 0:r.x,y:(a=n[0])==null?void 0:a.y}}),{c(){me(e.$$.fragment)},l(o){xe(e.$$.fragment,o)},m(o,l){pe(e,o,l),t=!0},p(o,[l]){var h,u,d,f;const c={};l&3&&(c.isVisible=!!(o[0]&&o[1]==="user")),l&1&&(c.width=(h=o[0])==null?void 0:h.width),l&1&&(c.height=(u=o[0])==null?void 0:u.height),l&1&&(c.x=(d=o[0])==null?void 0:d.x),l&1&&(c.y=(f=o[0])==null?void 0:f.y),e.$set(c)},i(o){t||(U(e.$$.fragment,o),t=!0)},o(o){W(e.$$.fragment,o),t=!1},d(o){be(e,o)}}}function _se(n,e,t){let i,s;const{selectionRect:r,selectionRectMode:a}=ts();return Pe(n,r,o=>t(0,i=o)),Pe(n,a,o=>t(1,s=o)),[i,s,r,a]}class vse extends Nt{constructor(e){super(),Ot(this,e,_se,wse,Ut,{})}}function PS(n){let e,t,i,s,r;return t=new YO({props:{width:"100%",height:"100%",x:0,y:0}}),{c(){e=ee("div"),me(t.$$.fragment),this.h()},l(a){e=te(a,"DIV",{class:!0,style:!0,role:!0,tabindex:!0});var o=q(e);xe(t.$$.fragment,o),o.forEach(E),this.h()},h(){A(e,"class","selection-wrapper nopan svelte-5pxri"),nn(e,"width",n[1].width+"px"),nn(e,"height",n[1].height+"px"),nn(e,"transform","translate("+n[1].x+"px, "+n[1].y+"px)"),A(e,"role","button"),A(e,"tabindex","-1")},m(a,o){$(a,e,o),pe(t,e,null),i=!0,s||(r=[aa(XO.call(null,e,{disabled:!1,store:n[2],onDrag:n[11],onDragStart:n[12],onDragStop:n[13]})),yt(e,"contextmenu",n[7]),yt(e,"click",n[8]),yt(e,"keyup",Cse)],s=!0)},p(a,o){(!i||o&2)&&nn(e,"width",a[1].width+"px"),(!i||o&2)&&nn(e,"height",a[1].height+"px"),(!i||o&2)&&nn(e,"transform","translate("+a[1].x+"px, "+a[1].y+"px)")},i(a){i||(U(t.$$.fragment,a),i=!0)},o(a){W(t.$$.fragment,a),i=!1},d(a){a&&E(e),be(t),s=!1,Qr(r)}}}function kse(n){let e=n[0]==="nodes"&&n[1]&&Zo(n[1].x)&&Zo(n[1].y),t,i,s=e&&PS(n);return{c(){s&&s.c(),t=zt()},l(r){s&&s.l(r),t=zt()},m(r,a){s&&s.m(r,a),$(r,t,a),i=!0},p(r,[a]){a&3&&(e=r[0]==="nodes"&&r[1]&&Zo(r[1].x)&&Zo(r[1].y)),e?s?(s.p(r,a),a&3&&U(s,1)):(s=PS(r),s.c(),U(s,1),s.m(t.parentNode,t)):s&&(bt(),W(s,1,1,()=>{s=null}),xt())},i(r){i||(U(s),i=!0)},o(r){W(s),i=!1},d(r){r&&E(t),s&&s.d(r)}}}const Cse=()=>{};function Ase(n,e,t){let i,s,r;const a=ts(),{selectionRectMode:o,nodes:l,nodeLookup:c}=a;Pe(n,o,p=>t(0,r=p)),Pe(n,l,p=>t(9,i=p)),Pe(n,c,p=>t(10,s=p));const h=Xa();let u=null;function d(p){const y=i.filter(w=>w.selected);h("selectioncontextmenu",{nodes:y,event:p})}function f(p){const y=i.filter(w=>w.selected);h("selectionclick",{nodes:y,event:p})}const g=(p,y,w,_)=>{h("nodedrag",{event:p,targetNode:null,nodes:_})},m=(p,y,w,_)=>{h("nodedragstart",{event:p,targetNode:null,nodes:_})},x=(p,y,w,_)=>{h("nodedragstop",{event:p,targetNode:null,nodes:_})};return n.$$.update=()=>{n.$$.dirty&1537&&r==="nodes"&&t(1,u=Ry(s,{filter:p=>!!p.selected}))},[r,u,a,o,l,c,h,d,f,i,s,g,m,x]}class Sse extends Nt{constructor(e){super(),Ot(this,e,Ase,kse,Ut,{})}}function yl(n,e){let{enabled:t=!0,trigger:i,type:s="keydown"}=e;function r(a){const o=Array.isArray(i)?i:[i],l={alt:a.altKey,ctrl:a.ctrlKey,shift:a.shiftKey,meta:a.metaKey};for(const c of o){const h={modifier:[],preventDefault:!1,enabled:!0,...c},{modifier:u,key:d,callback:f,preventDefault:g,enabled:m}=h;if(m){if(u.length&&!(Array.isArray(u)?u:[u]).map(y=>typeof y=="string"?[y]:y).some(y=>y.every(w=>l[w])))continue;if(a.key===d){g&&a.preventDefault();const x={node:n,trigger:h,originalEvent:a};n.dispatchEvent(new CustomEvent("shortcut",{detail:x})),f==null||f(x)}}}}return t&&n.addEventListener(s,r),{update:a=>{const{enabled:o=!0,type:l="keydown"}=a;t&&(!o||s!==l)?n.removeEventListener(s,r):!t&&o&&n.addEventListener(l,r),t=o,s=l,i=a.trigger},destroy:()=>{n.removeEventListener(s,r)}}}function Ise(n){let e,t,i,s,r,a,o,l,c,h,u,d;return{c:Ct,l:Ct,m(f,g){u||(d=[aa(e=yl.call(null,window,{trigger:ds(n[0],n[11]),type:"keydown"})),aa(t=yl.call(null,window,{trigger:ds(n[0],n[12]),type:"keyup"})),aa(i=yl.call(null,window,{trigger:ds(n[1],n[13]),type:"keydown"})),aa(s=yl.call(null,window,{trigger:ds(n[1],n[14]),type:"keyup"})),aa(r=yl.call(null,window,{trigger:ds(n[2],n[15]),type:"keydown"})),aa(a=yl.call(null,window,{trigger:ds(n[2],n[16]),type:"keyup"})),aa(o=yl.call(null,window,{trigger:ds(n[3],n[17]),type:"keydown"})),aa(l=yl.call(null,window,{trigger:ds(n[3],n[18]),type:"keyup"})),aa(c=yl.call(null,window,{trigger:ds(n[4],n[19]),type:"keydown"})),aa(h=yl.call(null,window,{trigger:ds(n[4],n[20]),type:"keyup"})),yt(window,"blur",n[10]),yt(window,"contextmenu",n[10])],u=!0)},p(f,[g]){e&&Ls(e.update)&&g&1&&e.update.call(null,{trigger:ds(f[0],f[11]),type:"keydown"}),t&&Ls(t.update)&&g&1&&t.update.call(null,{trigger:ds(f[0],f[12]),type:"keyup"}),i&&Ls(i.update)&&g&2&&i.update.call(null,{trigger:ds(f[1],f[13]),type:"keydown"}),s&&Ls(s.update)&&g&2&&s.update.call(null,{trigger:ds(f[1],f[14]),type:"keyup"}),r&&Ls(r.update)&&g&4&&r.update.call(null,{trigger:ds(f[2],f[15]),type:"keydown"}),a&&Ls(a.update)&&g&4&&a.update.call(null,{trigger:ds(f[2],f[16]),type:"keyup"}),o&&Ls(o.update)&&g&8&&o.update.call(null,{trigger:ds(f[3],f[17]),type:"keydown"}),l&&Ls(l.update)&&g&8&&l.update.call(null,{trigger:ds(f[3],f[18]),type:"keyup"}),c&&Ls(c.update)&&g&16&&c.update.call(null,{trigger:ds(f[4],f[19]),type:"keydown"}),h&&Ls(h.update)&&g&16&&h.update.call(null,{trigger:ds(f[4],f[20]),type:"keyup"})},i:Ct,o:Ct,d(f){u=!1,Qr(d)}}}function JO(n){return n!==null&&typeof n=="object"}function Ese(n){return JO(n)?n.modifier||[]:[]}function Tse(n){return n==null?"":JO(n)?n.key:n}function ds(n,e){return(Array.isArray(n)?n:[n]).map(i=>{const s=Tse(i);return{key:s,modifier:Ese(i),enabled:s!==null,callback:e}})}function Rse(n,e,t){let{selectionKey:i="Shift"}=e,{multiSelectionKey:s=c5()?"Meta":"Control"}=e,{deleteKey:r="Backspace"}=e,{panActivationKey:a=" "}=e,{zoomActivationKey:o=c5()?"Meta":"Control"}=e;const{selectionKeyPressed:l,multiselectionKeyPressed:c,deleteKeyPressed:h,panActivationKeyPressed:u,zoomActivationKeyPressed:d,selectionRect:f}=ts();function g(){f.set(null),l.set(!1),c.set(!1),h.set(!1),u.set(!1),d.set(!1)}const m=()=>l.set(!0),x=()=>l.set(!1),p=()=>c.set(!0),y=()=>c.set(!1),w=S=>{!(S.originalEvent.ctrlKey||S.originalEvent.metaKey||S.originalEvent.shiftKey)&&!fne(S.originalEvent)&&h.set(!0)},_=()=>h.set(!1),v=()=>u.set(!0),C=()=>u.set(!1),k=()=>d.set(!0),I=()=>d.set(!1);return n.$$set=S=>{"selectionKey"in S&&t(0,i=S.selectionKey),"multiSelectionKey"in S&&t(1,s=S.multiSelectionKey),"deleteKey"in S&&t(2,r=S.deleteKey),"panActivationKey"in S&&t(3,a=S.panActivationKey),"zoomActivationKey"in S&&t(4,o=S.zoomActivationKey)},[i,s,r,a,o,l,c,h,u,d,g,m,x,p,y,w,_,v,C,k,I]}class Mse extends Nt{constructor(e){super(),Ot(this,e,Rse,Ise,Ut,{selectionKey:0,multiSelectionKey:1,deleteKey:2,panActivationKey:3,zoomActivationKey:4})}}const Pse=n=>({}),NS=n=>({});function OS(n){let e,t,i,s;const r=n[13].connectionLine,a=Gs(r,n,n[12],NS);let o=!n[2]&&DS(n);return{c(){e=at("svg"),t=at("g"),a&&a.c(),o&&o.c(),this.h()},l(l){e=ot(l,"svg",{width:!0,height:!0,class:!0,style:!0});var c=q(e);t=ot(c,"g",{class:!0});var h=q(t);a&&a.l(h),o&&o.l(h),h.forEach(E),c.forEach(E),this.h()},h(){A(t,"class",i=Ei(["svelte-flow__connection",sS(n[3].isValid)])),A(e,"width",n[5]),A(e,"height",n[6]),A(e,"class","svelte-flow__connectionline"),A(e,"style",n[0])},m(l,c){$(l,e,c),K(e,t),a&&a.m(t,null),o&&o.m(t,null),s=!0},p(l,c){a&&a.p&&(!s||c&4096)&&Vs(a,r,l,l[12],s?Ws(r,l[12],c,Pse):qs(l[12]),NS),l[2]?o&&(o.d(1),o=null):o?o.p(l,c):(o=DS(l),o.c(),o.m(t,null)),(!s||c&8&&i!==(i=Ei(["svelte-flow__connection",sS(l[3].isValid)])))&&A(t,"class",i),(!s||c&32)&&A(e,"width",l[5]),(!s||c&64)&&A(e,"height",l[6]),(!s||c&1)&&A(e,"style",l[0])},i(l){s||(U(a,l),s=!0)},o(l){W(a,l),s=!1},d(l){l&&E(e),a&&a.d(l),o&&o.d()}}}function DS(n){let e;return{c(){e=at("path"),this.h()},l(t){e=ot(t,"path",{d:!0,style:!0,fill:!0,class:!0}),q(e).forEach(E),this.h()},h(){A(e,"d",n[4]),A(e,"style",n[1]),A(e,"fill","none"),A(e,"class","svelte-flow__connection-path")},m(t,i){$(t,e,i)},p(t,i){i&16&&A(e,"d",t[4]),i&2&&A(e,"style",t[1])},d(t){t&&E(e)}}}function Nse(n){let e,t,i=n[3].inProgress&&OS(n);return{c(){i&&i.c(),e=zt()},l(s){i&&i.l(s),e=zt()},m(s,r){i&&i.m(s,r),$(s,e,r),t=!0},p(s,[r]){s[3].inProgress?i?(i.p(s,r),r&8&&U(i,1)):(i=OS(s),i.c(),U(i,1),i.m(e.parentNode,e)):i&&(bt(),W(i,1,1,()=>{i=null}),xt())},i(s){t||(U(i),t=!0)},o(s){W(i),t=!1},d(s){s&&E(e),i&&i.d(s)}}}function Ose(n,e,t){let i,s,r,a,{$$slots:o={},$$scope:l}=e,{containerStyle:c=""}=e,{style:h=""}=e,{isCustomComponent:u=!1}=e;const{width:d,height:f,connection:g,connectionLineType:m}=ts();Pe(n,d,p=>t(5,r=p)),Pe(n,f,p=>t(6,a=p)),Pe(n,g,p=>t(3,s=p)),Pe(n,m,p=>t(11,i=p));let x=null;return n.$$set=p=>{"containerStyle"in p&&t(0,c=p.containerStyle),"style"in p&&t(1,h=p.style),"isCustomComponent"in p&&t(2,u=p.isCustomComponent),"$$scope"in p&&t(12,l=p.$$scope)},n.$$.update=()=>{if(n.$$.dirty&2060&&s.inProgress&&!u){const{from:p,to:y,fromPosition:w,toPosition:_}=s,v={sourceX:p.x,sourceY:p.y,sourcePosition:w,targetX:y.x,targetY:y.y,targetPosition:_};switch(i){case c1.Bezier:t(4,[x]=SO(v),x);break;case c1.Step:t(4,[x]=h5({...v,borderRadius:0}),x);break;case c1.SmoothStep:t(4,[x]=h5(v),x);break;default:t(4,[x]=EO(v),x)}}},[c,h,u,s,x,r,a,d,f,g,m,i,l,o]}class Dse extends Nt{constructor(e){super(),Ot(this,e,Ose,Nse,Ut,{containerStyle:0,style:1,isCustomComponent:2})}}function Fse(n){let e,t,i;const s=n[8].default,r=Gs(s,n,n[7],null);let a=[{class:t=Ei(["svelte-flow__panel",n[1],...n[2]])},{style:n[0]},n[5]],o={};for(let l=0;l<a.length;l+=1)o=oi(o,a[l]);return{c(){e=ee("div"),r&&r.c(),this.h()},l(l){e=te(l,"DIV",{class:!0,style:!0});var c=q(e);r&&r.l(c),c.forEach(E),this.h()},h(){Ag(e,o),nn(e,"pointer-events",n[3]?"none":"")},m(l,c){$(l,e,c),r&&r.m(e,null),i=!0},p(l,[c]){r&&r.p&&(!i||c&128)&&Vs(r,s,l,l[7],i?Ws(s,l[7],c,null):qs(l[7]),null),Ag(e,o=Lh(a,[(!i||c&6&&t!==(t=Ei(["svelte-flow__panel",l[1],...l[2]])))&&{class:t},(!i||c&1)&&{style:l[0]},c&32&&l[5]])),nn(e,"pointer-events",l[3]?"none":"")},i(l){i||(U(r,l),i=!0)},o(l){W(r,l),i=!1},d(l){l&&E(e),r&&r.d(l)}}}function Lse(n,e,t){let i;const s=["position","style","class"];let r=$i(e,s),a,{$$slots:o={},$$scope:l}=e,{position:c="top-right"}=e,{style:h=void 0}=e,{class:u=void 0}=e;const{selectionRectMode:d}=ts();return Pe(n,d,f=>t(3,a=f)),n.$$set=f=>{e=oi(oi({},e),ll(f)),t(5,r=$i(e,s)),"position"in f&&t(6,c=f.position),"style"in f&&t(0,h=f.style),"class"in f&&t(1,u=f.class),"$$scope"in f&&t(7,l=f.$$scope)},n.$$.update=()=>{n.$$.dirty&64&&t(2,i=`${c}`.split("-"))},[h,u,i,a,d,r,c,l,o]}class ZO extends Nt{constructor(e){super(),Ot(this,e,Lse,Fse,Ut,{position:6,style:0,class:1})}}function FS(n){let e,t;return e=new ZO({props:{position:n[1],class:"svelte-flow__attribution","data-message":"Feel free to remove the attribution or check out how you could support us: https://svelteflow.dev/support-us",$$slots:{default:[Bse]},$$scope:{ctx:n}}}),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p(i,s){const r={};s&2&&(r.position=i[1]),s&4&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function Bse(n){let e,t="Svelte Flow";return{c(){e=ee("a"),e.textContent=t,this.h()},l(i){e=te(i,"A",{href:!0,target:!0,rel:!0,"aria-label":!0,"data-svelte-h":!0}),ko(e)!=="svelte-2vm8e4"&&(e.textContent=t),this.h()},h(){A(e,"href","https://svelteflow.dev"),A(e,"target","_blank"),A(e,"rel","noopener noreferrer"),A(e,"aria-label","Svelte Flow attribution")},m(i,s){$(i,e,s)},p:Ct,d(i){i&&E(e)}}}function Use(n){var s;let e,t,i=!((s=n[0])!=null&&s.hideAttribution)&&FS(n);return{c(){i&&i.c(),e=zt()},l(r){i&&i.l(r),e=zt()},m(r,a){i&&i.m(r,a),$(r,e,a),t=!0},p(r,[a]){var o;(o=r[0])!=null&&o.hideAttribution?i&&(bt(),W(i,1,1,()=>{i=null}),xt()):i?(i.p(r,a),a&1&&U(i,1)):(i=FS(r),i.c(),U(i,1),i.m(e.parentNode,e))},i(r){t||(U(i),t=!0)},o(r){W(i),t=!1},d(r){r&&E(e),i&&i.d(r)}}}function Hse(n,e,t){let{proOptions:i=void 0}=e,{position:s="bottom-right"}=e;return n.$$set=r=>{"proOptions"in r&&t(0,i=r.proOptions),"position"in r&&t(1,s=r.position)},[i,s]}class zse extends Nt{constructor(e){super(),Ot(this,e,Hse,Use,Ut,{proOptions:0,position:1})}}function LS(n,{nodeTypes:e,edgeTypes:t,minZoom:i,maxZoom:s,translateExtent:r,paneClickDistance:a}){e!==void 0&&n.setNodeTypes(e),t!==void 0&&n.setEdgeTypes(t),i!==void 0&&n.setMinZoom(i),s!==void 0&&n.setMaxZoom(s),r!==void 0&&n.setTranslateExtent(r),a!==void 0&&n.setPaneClickDistance(a)}const jse=n=>Object.keys(n);function Gse(n,e){jse(e).forEach(t=>{const i=e[t];i!==void 0&&n[t].set(i)})}function Vse(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function qse(n="light"){return Io("light",t=>{if(n!=="system"){t(n);return}const i=Vse(),s=()=>t(i!=null&&i.matches?"dark":"light");return t(i!=null&&i.matches?"dark":"light"),i==null||i.addEventListener("change",s),()=>{i==null||i.removeEventListener("change",s)}})}const Wse=n=>({}),BS=n=>({slot:"connectionLine"});function Kse(n){let e;const t=n[75].connectionLine,i=Gs(t,n,n[99],BS);return{c(){i&&i.c()},l(s){i&&i.l(s)},m(s,r){i&&i.m(s,r),e=!0},p(s,r){i&&i.p&&(!e||r[3]&64)&&Vs(i,t,s,s[99],e?Ws(t,s[99],r,Wse):qs(s[99]),BS)},i(s){e||(U(i,s),e=!0)},o(s){W(i,s),e=!1},d(s){i&&i.d(s)}}}function Xse(n){let e,t,i,s,r,a,o,l,c,h,u,d;return e=new bse({props:{defaultEdgeOptions:n[21]}}),e.$on("edgeclick",n[78]),e.$on("edgecontextmenu",n[79]),e.$on("edgemouseenter",n[80]),e.$on("edgemouseleave",n[81]),i=new Dse({props:{containerStyle:n[7],style:n[6],isCustomComponent:n[34].connectionLine,$$slots:{connectionLine:[Kse]},$$scope:{ctx:n}}}),c=new tse({props:{nodeClickDistance:n[23]}}),c.$on("nodeclick",n[82]),c.$on("nodemouseenter",n[83]),c.$on("nodemousemove",n[84]),c.$on("nodemouseleave",n[85]),c.$on("nodedragstart",n[86]),c.$on("nodedrag",n[87]),c.$on("nodedragstop",n[88]),c.$on("nodecontextmenu",n[89]),u=new Sse({}),u.$on("selectionclick",n[90]),u.$on("selectioncontextmenu",n[91]),u.$on("nodedragstart",n[92]),u.$on("nodedrag",n[93]),u.$on("nodedragstop",n[94]),{c(){me(e.$$.fragment),t=Ce(),me(i.$$.fragment),s=Ce(),r=ee("div"),a=Ce(),o=ee("div"),l=Ce(),me(c.$$.fragment),h=Ce(),me(u.$$.fragment),this.h()},l(f){xe(e.$$.fragment,f),t=Ae(f),xe(i.$$.fragment,f),s=Ae(f),r=te(f,"DIV",{class:!0}),q(r).forEach(E),a=Ae(f),o=te(f,"DIV",{class:!0}),q(o).forEach(E),l=Ae(f),xe(c.$$.fragment,f),h=Ae(f),xe(u.$$.fragment,f),this.h()},h(){A(r,"class","svelte-flow__edgelabel-renderer"),A(o,"class","svelte-flow__viewport-portal")},m(f,g){pe(e,f,g),$(f,t,g),pe(i,f,g),$(f,s,g),$(f,r,g),$(f,a,g),$(f,o,g),$(f,l,g),pe(c,f,g),$(f,h,g),pe(u,f,g),d=!0},p(f,g){const m={};g[0]&2097152&&(m.defaultEdgeOptions=f[21]),e.$set(m);const x={};g[0]&128&&(x.containerStyle=f[7]),g[0]&64&&(x.style=f[6]),g[1]&8&&(x.isCustomComponent=f[34].connectionLine),g[3]&64&&(x.$$scope={dirty:g,ctx:f}),i.$set(x);const p={};g[0]&8388608&&(p.nodeClickDistance=f[23]),c.$set(p)},i(f){d||(U(e.$$.fragment,f),U(i.$$.fragment,f),U(c.$$.fragment,f),U(u.$$.fragment,f),d=!0)},o(f){W(e.$$.fragment,f),W(i.$$.fragment,f),W(c.$$.fragment,f),W(u.$$.fragment,f),d=!1},d(f){f&&(E(t),E(s),E(r),E(a),E(o),E(l),E(h)),be(e,f),be(i,f),be(c,f),be(u,f)}}}function Yse(n){let e,t,i,s;return e=new Kie({props:{$$slots:{default:[Xse]},$$scope:{ctx:n}}}),i=new vse({}),{c(){me(e.$$.fragment),t=Ce(),me(i.$$.fragment)},l(r){xe(e.$$.fragment,r),t=Ae(r),xe(i.$$.fragment,r)},m(r,a){pe(e,r,a),$(r,t,a),pe(i,r,a),s=!0},p(r,a){const o={};a[0]&10485952|a[1]&8|a[3]&64&&(o.$$scope={dirty:a,ctx:r}),e.$set(o)},i(r){s||(U(e.$$.fragment,r),U(i.$$.fragment,r),s=!0)},o(r){W(e.$$.fragment,r),W(i.$$.fragment,r),s=!1},d(r){r&&E(t),be(e,r),be(i,r)}}}function Jse(n){let e,t;return e=new Vie({props:{panOnDrag:n[17]===void 0?!0:n[17],selectionOnDrag:n[18],$$slots:{default:[Yse]},$$scope:{ctx:n}}}),e.$on("paneclick",n[95]),e.$on("panecontextmenu",n[96]),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p(i,s){const r={};s[0]&131072&&(r.panOnDrag=i[17]===void 0?!0:i[17]),s[0]&262144&&(r.selectionOnDrag=i[18]),s[0]&10485952|s[1]&8|s[3]&64&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function Zse(n){let e,t,i,s,r,a,o,l,c,h,u,d;t=new Mse({props:{selectionKey:n[1],deleteKey:n[5],panActivationKey:n[2],multiSelectionKey:n[3],zoomActivationKey:n[4]}}),s=new zie({props:{initialViewport:n[31],onMoveStart:n[8],onMove:n[9],onMoveEnd:n[10],panOnScrollMode:n[11]===void 0?nc.Free:n[11],preventScrolling:n[12]===void 0?!0:n[12],zoomOnScroll:n[13]===void 0?!0:n[13],zoomOnDoubleClick:n[14]===void 0?!0:n[14],zoomOnPinch:n[15]===void 0?!0:n[15],panOnScroll:n[16]===void 0?!1:n[16],panOnDrag:n[17]===void 0?!0:n[17],paneClickDistance:n[22]===void 0?0:n[22],$$slots:{default:[Jse]},$$scope:{ctx:n}}}),a=new zse({props:{proOptions:n[20],position:n[19]}});const f=n[75].default,g=Gs(f,n,n[99],null);let m=[{style:n[24]},{class:l=Ei(["svelte-flow",n[25],n[30]])},{"data-testid":"svelte-flow__wrapper"},n[33],{role:"application"}],x={};for(let p=0;p<m.length;p+=1)x=oi(x,m[p]);return{c(){e=ee("div"),me(t.$$.fragment),i=Ce(),me(s.$$.fragment),r=Ce(),me(a.$$.fragment),o=Ce(),g&&g.c(),this.h()},l(p){e=te(p,"DIV",{style:!0,class:!0,"data-testid":!0,role:!0});var y=q(e);xe(t.$$.fragment,y),i=Ae(y),xe(s.$$.fragment,y),r=Ae(y),xe(a.$$.fragment,y),o=Ae(y),g&&g.l(y),y.forEach(E),this.h()},h(){Ag(e,x),s0(()=>n[98].call(e)),mn(e,"svelte-12wlba6",!0)},m(p,y){$(p,e,y),pe(t,e,null),K(e,i),pe(s,e,null),K(e,r),pe(a,e,null),K(e,o),g&&g.m(e,null),n[97](e),c=rD(e,n[98].bind(e)),h=!0,u||(d=[yt(e,"dragover",n[76]),yt(e,"drop",n[77])],u=!0)},p(p,y){const w={};y[0]&2&&(w.selectionKey=p[1]),y[0]&32&&(w.deleteKey=p[5]),y[0]&4&&(w.panActivationKey=p[2]),y[0]&8&&(w.multiSelectionKey=p[3]),y[0]&16&&(w.zoomActivationKey=p[4]),t.$set(w);const _={};y[0]&256&&(_.onMoveStart=p[8]),y[0]&512&&(_.onMove=p[9]),y[0]&1024&&(_.onMoveEnd=p[10]),y[0]&2048&&(_.panOnScrollMode=p[11]===void 0?nc.Free:p[11]),y[0]&4096&&(_.preventScrolling=p[12]===void 0?!0:p[12]),y[0]&8192&&(_.zoomOnScroll=p[13]===void 0?!0:p[13]),y[0]&16384&&(_.zoomOnDoubleClick=p[14]===void 0?!0:p[14]),y[0]&32768&&(_.zoomOnPinch=p[15]===void 0?!0:p[15]),y[0]&65536&&(_.panOnScroll=p[16]===void 0?!1:p[16]),y[0]&131072&&(_.panOnDrag=p[17]===void 0?!0:p[17]),y[0]&4194304&&(_.paneClickDistance=p[22]===void 0?0:p[22]),y[0]&10879168|y[1]&8|y[3]&64&&(_.$$scope={dirty:y,ctx:p}),s.$set(_);const v={};y[0]&1048576&&(v.proOptions=p[20]),y[0]&524288&&(v.position=p[19]),a.$set(v),g&&g.p&&(!h||y[3]&64)&&Vs(g,f,p,p[99],h?Ws(f,p[99],y,null):qs(p[99]),null),Ag(e,x=Lh(m,[(!h||y[0]&16777216)&&{style:p[24]},(!h||y[0]&1107296256&&l!==(l=Ei(["svelte-flow",p[25],p[30]])))&&{class:l},{"data-testid":"svelte-flow__wrapper"},y[1]&4&&p[33],{role:"application"}])),mn(e,"svelte-12wlba6",!0)},i(p){h||(U(t.$$.fragment,p),U(s.$$.fragment,p),U(a.$$.fragment,p),U(g,p),h=!0)},o(p){W(t.$$.fragment,p),W(s.$$.fragment,p),W(a.$$.fragment,p),W(g,p),h=!1},d(p){p&&E(e),be(t),be(s),be(a),g&&g.d(p),n[97](null),c(),u=!1,Qr(d)}}}function Qse(n,e,t){let i;const s=["id","nodes","edges","fitView","fitViewOptions","minZoom","maxZoom","initialViewport","viewport","nodeTypes","edgeTypes","selectionKey","selectionMode","panActivationKey","multiSelectionKey","zoomActivationKey","nodesDraggable","nodesConnectable","nodeDragThreshold","elementsSelectable","snapGrid","deleteKey","connectionRadius","connectionLineType","connectionMode","connectionLineStyle","connectionLineContainerStyle","onMoveStart","onMove","onMoveEnd","isValidConnection","translateExtent","nodeExtent","onlyRenderVisibleElements","panOnScrollMode","preventScrolling","zoomOnScroll","zoomOnDoubleClick","zoomOnPinch","panOnScroll","panOnDrag","selectionOnDrag","autoPanOnConnect","autoPanOnNodeDrag","onerror","ondelete","onedgecreate","attributionPosition","proOptions","defaultEdgeOptions","width","height","colorMode","onconnect","onconnectstart","onconnectend","onbeforedelete","oninit","nodeOrigin","paneClickDistance","nodeClickDistance","defaultMarkerColor","style","class"];let r=$i(e,s),a,o,l=Ct,c=()=>(l(),l=sv(I,ke=>t(100,o=ke)),I),h,u=Ct,d=()=>(u(),u=sv(i,ke=>t(30,h=ke)),i);n.$$.on_destroy.push(()=>l()),n.$$.on_destroy.push(()=>u());let{$$slots:f={},$$scope:g}=e;const m=aD(f);let{id:x="1"}=e,{nodes:p}=e,{edges:y}=e,{fitView:w=void 0}=e,{fitViewOptions:_=void 0}=e,{minZoom:v=void 0}=e,{maxZoom:C=void 0}=e,{initialViewport:k=void 0}=e,{viewport:I=void 0}=e;c();let{nodeTypes:S=void 0}=e,{edgeTypes:M=void 0}=e,{selectionKey:N=void 0}=e,{selectionMode:F=void 0}=e,{panActivationKey:H=void 0}=e,{multiSelectionKey:T=void 0}=e,{zoomActivationKey:z=void 0}=e,{nodesDraggable:R=void 0}=e,{nodesConnectable:L=void 0}=e,{nodeDragThreshold:Y=void 0}=e,{elementsSelectable:j=void 0}=e,{snapGrid:J=void 0}=e,{deleteKey:G=void 0}=e,{connectionRadius:se=void 0}=e,{connectionLineType:de=void 0}=e,{connectionMode:he=nf.Strict}=e,{connectionLineStyle:we=""}=e,{connectionLineContainerStyle:ye=""}=e,{onMoveStart:P=void 0}=e,{onMove:V=void 0}=e,{onMoveEnd:re=void 0}=e,{isValidConnection:X=void 0}=e,{translateExtent:ue=void 0}=e,{nodeExtent:oe=void 0}=e,{onlyRenderVisibleElements:Q=void 0}=e,{panOnScrollMode:ae=nc.Free}=e,{preventScrolling:Ke=!0}=e,{zoomOnScroll:Ue=!0}=e,{zoomOnDoubleClick:De=!0}=e,{zoomOnPinch:je=!0}=e,{panOnScroll:ze=!1}=e,{panOnDrag:Qe=!0}=e,{selectionOnDrag:ft=void 0}=e,{autoPanOnConnect:ut=!0}=e,{autoPanOnNodeDrag:Je=!0}=e,{onerror:rt=void 0}=e,{ondelete:ge=void 0}=e,{onedgecreate:Pt=void 0}=e,{attributionPosition:lt=void 0}=e,{proOptions:ct=void 0}=e,{defaultEdgeOptions:Ge=void 0}=e,{width:Ft=void 0}=e,{height:sn=void 0}=e,{colorMode:Me="light"}=e,{onconnect:Lt=void 0}=e,{onconnectstart:dt=void 0}=e,{onconnectend:Vt=void 0}=e,{onbeforedelete:Ln=void 0}=e,{oninit:Wn=void 0}=e,{nodeOrigin:hi=void 0}=e,{paneClickDistance:Gi=0}=e,{nodeClickDistance:ws=0}=e,{defaultMarkerColor:ui="#b1b1b7"}=e,{style:Wi=void 0}=e,{class:_s=void 0}=e,Ci,Rr,Xs;const Es=o||k,Ne=oD(Dy)?ts():Lie({nodes:$e(p),edges:$e(y),width:Ft,height:sn,fitView:w,nodeOrigin:hi,nodeExtent:oe});ol(()=>(Ne.width.set(Rr),Ne.height.set(Xs),Ne.domNode.set(Ci),Ne.syncNodeStores(p),Ne.syncEdgeStores(y),Ne.syncViewport(I),w!==void 0&&Ne.fitViewOnInit.set(w),_&&Ne.fitViewOptions.set(_),LS(Ne,{nodeTypes:S,edgeTypes:M,minZoom:v,maxZoom:C,translateExtent:ue,paneClickDistance:Gi}),()=>{Ne.reset()}));const{initialized:Ve}=Ne;Pe(n,Ve,ke=>t(74,a=ke));let ht=!1;function Xt(ke){Xn.call(this,n,ke)}function an(ke){Xn.call(this,n,ke)}function Bn(ke){Xn.call(this,n,ke)}function Cn(ke){Xn.call(this,n,ke)}function Un(ke){Xn.call(this,n,ke)}function zn(ke){Xn.call(this,n,ke)}function dl(ke){Xn.call(this,n,ke)}function gr(ke){Xn.call(this,n,ke)}function tm(ke){Xn.call(this,n,ke)}function nm(ke){Xn.call(this,n,ke)}function im(ke){Xn.call(this,n,ke)}function sm(ke){Xn.call(this,n,ke)}function rm(ke){Xn.call(this,n,ke)}function am(ke){Xn.call(this,n,ke)}function om(ke){Xn.call(this,n,ke)}function lm(ke){Xn.call(this,n,ke)}function cm(ke){Xn.call(this,n,ke)}function hm(ke){Xn.call(this,n,ke)}function um(ke){Xn.call(this,n,ke)}function dm(ke){Xn.call(this,n,ke)}function fm(ke){Xn.call(this,n,ke)}function gm(ke){It[ke?"unshift":"push"](()=>{Ci=ke,t(28,Ci)})}function mm(){Rr=this.clientWidth,Xs=this.clientHeight,t(26,Rr),t(27,Xs)}return n.$$set=ke=>{e=oi(oi({},e),ll(ke)),t(33,r=$i(e,s)),"id"in ke&&t(35,x=ke.id),"nodes"in ke&&t(36,p=ke.nodes),"edges"in ke&&t(37,y=ke.edges),"fitView"in ke&&t(38,w=ke.fitView),"fitViewOptions"in ke&&t(39,_=ke.fitViewOptions),"minZoom"in ke&&t(40,v=ke.minZoom),"maxZoom"in ke&&t(41,C=ke.maxZoom),"initialViewport"in ke&&t(42,k=ke.initialViewport),"viewport"in ke&&c(t(0,I=ke.viewport)),"nodeTypes"in ke&&t(43,S=ke.nodeTypes),"edgeTypes"in ke&&t(44,M=ke.edgeTypes),"selectionKey"in ke&&t(1,N=ke.selectionKey),"selectionMode"in ke&&t(45,F=ke.selectionMode),"panActivationKey"in ke&&t(2,H=ke.panActivationKey),"multiSelectionKey"in ke&&t(3,T=ke.multiSelectionKey),"zoomActivationKey"in ke&&t(4,z=ke.zoomActivationKey),"nodesDraggable"in ke&&t(46,R=ke.nodesDraggable),"nodesConnectable"in ke&&t(47,L=ke.nodesConnectable),"nodeDragThreshold"in ke&&t(48,Y=ke.nodeDragThreshold),"elementsSelectable"in ke&&t(49,j=ke.elementsSelectable),"snapGrid"in ke&&t(50,J=ke.snapGrid),"deleteKey"in ke&&t(5,G=ke.deleteKey),"connectionRadius"in ke&&t(51,se=ke.connectionRadius),"connectionLineType"in ke&&t(52,de=ke.connectionLineType),"connectionMode"in ke&&t(53,he=ke.connectionMode),"connectionLineStyle"in ke&&t(6,we=ke.connectionLineStyle),"connectionLineContainerStyle"in ke&&t(7,ye=ke.connectionLineContainerStyle),"onMoveStart"in ke&&t(8,P=ke.onMoveStart),"onMove"in ke&&t(9,V=ke.onMove),"onMoveEnd"in ke&&t(10,re=ke.onMoveEnd),"isValidConnection"in ke&&t(54,X=ke.isValidConnection),"translateExtent"in ke&&t(55,ue=ke.translateExtent),"nodeExtent"in ke&&t(56,oe=ke.nodeExtent),"onlyRenderVisibleElements"in ke&&t(57,Q=ke.onlyRenderVisibleElements),"panOnScrollMode"in ke&&t(11,ae=ke.panOnScrollMode),"preventScrolling"in ke&&t(12,Ke=ke.preventScrolling),"zoomOnScroll"in ke&&t(13,Ue=ke.zoomOnScroll),"zoomOnDoubleClick"in ke&&t(14,De=ke.zoomOnDoubleClick),"zoomOnPinch"in ke&&t(15,je=ke.zoomOnPinch),"panOnScroll"in ke&&t(16,ze=ke.panOnScroll),"panOnDrag"in ke&&t(17,Qe=ke.panOnDrag),"selectionOnDrag"in ke&&t(18,ft=ke.selectionOnDrag),"autoPanOnConnect"in ke&&t(58,ut=ke.autoPanOnConnect),"autoPanOnNodeDrag"in ke&&t(59,Je=ke.autoPanOnNodeDrag),"onerror"in ke&&t(60,rt=ke.onerror),"ondelete"in ke&&t(61,ge=ke.ondelete),"onedgecreate"in ke&&t(62,Pt=ke.onedgecreate),"attributionPosition"in ke&&t(19,lt=ke.attributionPosition),"proOptions"in ke&&t(20,ct=ke.proOptions),"defaultEdgeOptions"in ke&&t(21,Ge=ke.defaultEdgeOptions),"width"in ke&&t(63,Ft=ke.width),"height"in ke&&t(64,sn=ke.height),"colorMode"in ke&&t(65,Me=ke.colorMode),"onconnect"in ke&&t(66,Lt=ke.onconnect),"onconnectstart"in ke&&t(67,dt=ke.onconnectstart),"onconnectend"in ke&&t(68,Vt=ke.onconnectend),"onbeforedelete"in ke&&t(69,Ln=ke.onbeforedelete),"oninit"in ke&&t(70,Wn=ke.oninit),"nodeOrigin"in ke&&t(71,hi=ke.nodeOrigin),"paneClickDistance"in ke&&t(22,Gi=ke.paneClickDistance),"nodeClickDistance"in ke&&t(23,ws=ke.nodeClickDistance),"defaultMarkerColor"in ke&&t(72,ui=ke.defaultMarkerColor),"style"in ke&&t(24,Wi=ke.style),"class"in ke&&t(25,_s=ke.class),"$$scope"in ke&&t(99,g=ke.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&201326592&&Rr!==void 0&&Xs!==void 0&&(Ne.width.set(Rr),Ne.height.set(Xs)),n.$$.dirty[2]&6400&&!ht&&a&&(Wn==null||Wn(),t(73,ht=!0)),n.$$.dirty[1]&2097135632|n.$$.dirty[2]&1777&&Gse(Ne,{flowId:x,connectionLineType:de,connectionRadius:se,selectionMode:F,snapGrid:J,defaultMarkerColor:ui,nodesDraggable:R,nodesConnectable:L,elementsSelectable:j,onlyRenderVisibleElements:Q,isValidConnection:X,autoPanOnConnect:ut,autoPanOnNodeDrag:Je,onerror:rt,ondelete:ge,onedgecreate:Pt,connectionMode:he,nodeDragThreshold:Y,onconnect:Lt,onconnectstart:dt,onconnectend:Vt,onbeforedelete:Ln,nodeOrigin:hi}),n.$$.dirty[0]&4194304|n.$$.dirty[1]&16791040&&LS(Ne,{nodeTypes:S,edgeTypes:M,minZoom:v,maxZoom:C,translateExtent:ue,paneClickDistance:Gi}),n.$$.dirty[2]&8&&d(t(29,i=qse(Me)))},[I,N,H,T,z,G,we,ye,P,V,re,ae,Ke,Ue,De,je,ze,Qe,ft,lt,ct,Ge,Gi,ws,Wi,_s,Rr,Xs,Ci,i,h,Es,Ve,r,m,x,p,y,w,_,v,C,k,S,M,F,R,L,Y,j,J,se,de,he,X,ue,oe,Q,ut,Je,rt,ge,Pt,Ft,sn,Me,Lt,dt,Vt,Ln,Wn,hi,ui,ht,a,f,Xt,an,Bn,Cn,Un,zn,dl,gr,tm,nm,im,sm,rm,am,om,lm,cm,hm,um,dm,fm,gm,mm,g]}class $se extends Nt{constructor(e){super(),Ot(this,e,Qse,Zse,Ut,{id:35,nodes:36,edges:37,fitView:38,fitViewOptions:39,minZoom:40,maxZoom:41,initialViewport:42,viewport:0,nodeTypes:43,edgeTypes:44,selectionKey:1,selectionMode:45,panActivationKey:2,multiSelectionKey:3,zoomActivationKey:4,nodesDraggable:46,nodesConnectable:47,nodeDragThreshold:48,elementsSelectable:49,snapGrid:50,deleteKey:5,connectionRadius:51,connectionLineType:52,connectionMode:53,connectionLineStyle:6,connectionLineContainerStyle:7,onMoveStart:8,onMove:9,onMoveEnd:10,isValidConnection:54,translateExtent:55,nodeExtent:56,onlyRenderVisibleElements:57,panOnScrollMode:11,preventScrolling:12,zoomOnScroll:13,zoomOnDoubleClick:14,zoomOnPinch:15,panOnScroll:16,panOnDrag:17,selectionOnDrag:18,autoPanOnConnect:58,autoPanOnNodeDrag:59,onerror:60,ondelete:61,onedgecreate:62,attributionPosition:19,proOptions:20,defaultEdgeOptions:21,width:63,height:64,colorMode:65,onconnect:66,onconnectstart:67,onconnectend:68,onbeforedelete:69,oninit:70,nodeOrigin:71,paneClickDistance:22,nodeClickDistance:23,defaultMarkerColor:72,style:24,class:25},null,[-1,-1,-1,-1])}}function ere(n){let e;const t=n[7].default,i=Gs(t,n,n[6],null);return{c(){i&&i.c()},l(s){i&&i.l(s)},m(s,r){i&&i.m(s,r),e=!0},p(s,[r]){i&&i.p&&(!e||r&64)&&Vs(i,t,s,s[6],e?Ws(t,s[6],r,null):qs(s[6]),null)},i(s){e||(U(i,s),e=!0)},o(s){W(i,s),e=!1},d(s){i&&i.d(s)}}}function tre(n,e,t){let{$$slots:i={},$$scope:s}=e,{initialNodes:r=void 0}=e,{initialEdges:a=void 0}=e,{initialWidth:o=void 0}=e,{initialHeight:l=void 0}=e,{fitView:c=void 0}=e,{nodeOrigin:h=void 0}=e;const u=KO({nodes:r,edges:a,width:o,height:l,nodeOrigin:h,fitView:c});return Ep(Dy,{getStore:()=>u}),Kh(()=>{u.reset()}),n.$$set=d=>{"initialNodes"in d&&t(0,r=d.initialNodes),"initialEdges"in d&&t(1,a=d.initialEdges),"initialWidth"in d&&t(2,o=d.initialWidth),"initialHeight"in d&&t(3,l=d.initialHeight),"fitView"in d&&t(4,c=d.fitView),"nodeOrigin"in d&&t(5,h=d.nodeOrigin),"$$scope"in d&&t(6,s=d.$$scope)},[r,a,o,l,c,h,s,i]}class nre extends Nt{constructor(e){super(),Ot(this,e,tre,ere,Ut,{initialNodes:0,initialEdges:1,initialWidth:2,initialHeight:3,fitView:4,nodeOrigin:5})}}const ire=n=>({}),US=n=>({class:"button-svg"});function sre(n){let e,t,i,s,r;const a=n[8].default,o=Gs(a,n,n[7],US);let l=[{type:"button"},{class:t=Ei(["svelte-flow__controls-button",n[0]])},n[6]],c={};for(let h=0;h<l.length;h+=1)c=oi(c,l[h]);return{c(){e=ee("button"),o&&o.c(),this.h()},l(h){e=te(h,"BUTTON",{type:!0,class:!0});var u=q(e);o&&o.l(u),u.forEach(E),this.h()},h(){Ag(e,c),nn(e,"--xy-controls-button-background-color-props",n[1]),nn(e,"--xy-controls-button-background-color-hover-props",n[2]),nn(e,"--xy-controls-button-color-props",n[3]),nn(e,"--xy-controls-button-color-hover-props",n[4]),nn(e,"--xy-controls-button-border-color-props",n[5])},m(h,u){$(h,e,u),o&&o.m(e,null),e.autofocus&&e.focus(),i=!0,s||(r=yt(e,"click",n[9]),s=!0)},p(h,[u]){o&&o.p&&(!i||u&128)&&Vs(o,a,h,h[7],i?Ws(a,h[7],u,ire):qs(h[7]),US),Ag(e,c=Lh(l,[{type:"button"},(!i||u&1&&t!==(t=Ei(["svelte-flow__controls-button",h[0]])))&&{class:t},u&64&&h[6]])),nn(e,"--xy-controls-button-background-color-props",h[1]),nn(e,"--xy-controls-button-background-color-hover-props",h[2]),nn(e,"--xy-controls-button-color-props",h[3]),nn(e,"--xy-controls-button-color-hover-props",h[4]),nn(e,"--xy-controls-button-border-color-props",h[5])},i(h){i||(U(o,h),i=!0)},o(h){W(o,h),i=!1},d(h){h&&E(e),o&&o.d(h),s=!1,r()}}}function rre(n,e,t){const i=["class"];let s=$i(e,i),{$$slots:r={},$$scope:a}=e,{class:o=void 0}=e,l,c,h,u,d;function f(g){Xn.call(this,n,g)}return n.$$set=g=>{e=oi(oi({},e),ll(g)),t(6,s=$i(e,i)),"class"in g&&t(0,o=g.class),"$$scope"in g&&t(7,a=g.$$scope)},[o,l,c,h,u,d,s,a,r,f]}class u5 extends Nt{constructor(e){super(),Ot(this,e,rre,sre,Ut,{class:0})}}function are(n){let e,t;return{c(){e=at("svg"),t=at("path"),this.h()},l(i){e=ot(i,"svg",{xmlns:!0,viewBox:!0});var s=q(e);t=ot(s,"path",{d:!0}),q(t).forEach(E),s.forEach(E),this.h()},h(){A(t,"d","M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"viewBox","0 0 32 32")},m(i,s){$(i,e,s),K(e,t)},p:Ct,i:Ct,o:Ct,d(i){i&&E(e)}}}class ore extends Nt{constructor(e){super(),Ot(this,e,null,are,Ut,{})}}function lre(n){let e,t;return{c(){e=at("svg"),t=at("path"),this.h()},l(i){e=ot(i,"svg",{xmlns:!0,viewBox:!0});var s=q(e);t=ot(s,"path",{d:!0}),q(t).forEach(E),s.forEach(E),this.h()},h(){A(t,"d","M0 0h32v4.2H0z"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"viewBox","0 0 32 5")},m(i,s){$(i,e,s),K(e,t)},p:Ct,i:Ct,o:Ct,d(i){i&&E(e)}}}class cre extends Nt{constructor(e){super(),Ot(this,e,null,lre,Ut,{})}}function hre(n){let e,t;return{c(){e=at("svg"),t=at("path"),this.h()},l(i){e=ot(i,"svg",{xmlns:!0,viewBox:!0});var s=q(e);t=ot(s,"path",{d:!0}),q(t).forEach(E),s.forEach(E),this.h()},h(){A(t,"d","M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"viewBox","0 0 32 30")},m(i,s){$(i,e,s),K(e,t)},p:Ct,i:Ct,o:Ct,d(i){i&&E(e)}}}class ure extends Nt{constructor(e){super(),Ot(this,e,null,hre,Ut,{})}}function dre(n){let e,t;return{c(){e=at("svg"),t=at("path"),this.h()},l(i){e=ot(i,"svg",{xmlns:!0,viewBox:!0});var s=q(e);t=ot(s,"path",{d:!0}),q(t).forEach(E),s.forEach(E),this.h()},h(){A(t,"d","M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"viewBox","0 0 25 32")},m(i,s){$(i,e,s),K(e,t)},p:Ct,i:Ct,o:Ct,d(i){i&&E(e)}}}class fre extends Nt{constructor(e){super(),Ot(this,e,null,dre,Ut,{})}}function gre(n){let e,t;return{c(){e=at("svg"),t=at("path"),this.h()},l(i){e=ot(i,"svg",{xmlns:!0,viewBox:!0});var s=q(e);t=ot(s,"path",{d:!0}),q(t).forEach(E),s.forEach(E),this.h()},h(){A(t,"d","M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"viewBox","0 0 25 32")},m(i,s){$(i,e,s),K(e,t)},p:Ct,i:Ct,o:Ct,d(i){i&&E(e)}}}class mre extends Nt{constructor(e){super(),Ot(this,e,null,gre,Ut,{})}}const pre=n=>({}),HS=n=>({}),bre=n=>({}),zS=n=>({});function jS(n){let e,t,i,s;const r=[{class:"svelte-flow__controls-zoomin"},{title:"zoom in"},{"aria-label":"zoom in"},{disabled:n[9]},n[17]];let a={$$slots:{default:[xre]},$$scope:{ctx:n}};for(let c=0;c<r.length;c+=1)a=oi(a,r[c]);e=new u5({props:a}),e.$on("click",n[18]);const o=[{class:"svelte-flow__controls-zoomout"},{title:"zoom out"},{"aria-label":"zoom out"},{disabled:n[10]},n[17]];let l={$$slots:{default:[yre]},$$scope:{ctx:n}};for(let c=0;c<o.length;c+=1)l=oi(l,o[c]);return i=new u5({props:l}),i.$on("click",n[19]),{c(){me(e.$$.fragment),t=Ce(),me(i.$$.fragment)},l(c){xe(e.$$.fragment,c),t=Ae(c),xe(i.$$.fragment,c)},m(c,h){pe(e,c,h),$(c,t,h),pe(i,c,h),s=!0},p(c,h){const u=h[0]&131584?Lh(r,[r[0],r[1],r[2],h[0]&512&&{disabled:c[9]},h[0]&131072&&Tp(c[17])]):{};h[1]&32&&(u.$$scope={dirty:h,ctx:c}),e.$set(u);const d=h[0]&132096?Lh(o,[o[0],o[1],o[2],h[0]&1024&&{disabled:c[10]},h[0]&131072&&Tp(c[17])]):{};h[1]&32&&(d.$$scope={dirty:h,ctx:c}),i.$set(d)},i(c){s||(U(e.$$.fragment,c),U(i.$$.fragment,c),s=!0)},o(c){W(e.$$.fragment,c),W(i.$$.fragment,c),s=!1},d(c){c&&E(t),be(e,c),be(i,c)}}}function xre(n){let e,t;return e=new ore({}),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function yre(n){let e,t;return e=new cre({}),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function GS(n){let e,t;const i=[{class:"svelte-flow__controls-fitview"},{title:"fit view"},{"aria-label":"fit view"},n[17]];let s={$$slots:{default:[wre]},$$scope:{ctx:n}};for(let r=0;r<i.length;r+=1)s=oi(s,i[r]);return e=new u5({props:s}),e.$on("click",n[20]),{c(){me(e.$$.fragment)},l(r){xe(e.$$.fragment,r)},m(r,a){pe(e,r,a),t=!0},p(r,a){const o=a[0]&131072?Lh(i,[i[0],i[1],i[2],Tp(r[17])]):{};a[1]&32&&(o.$$scope={dirty:a,ctx:r}),e.$set(o)},i(r){t||(U(e.$$.fragment,r),t=!0)},o(r){W(e.$$.fragment,r),t=!1},d(r){be(e,r)}}}function wre(n){let e,t;return e=new ure({}),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function VS(n){let e,t;const i=[{class:"svelte-flow__controls-interactive"},{title:"toggle interactivity"},{"aria-label":"toggle interactivity"},n[17]];let s={$$slots:{default:[kre]},$$scope:{ctx:n}};for(let r=0;r<i.length;r+=1)s=oi(s,i[r]);return e=new u5({props:s}),e.$on("click",n[21]),{c(){me(e.$$.fragment)},l(r){xe(e.$$.fragment,r)},m(r,a){pe(e,r,a),t=!0},p(r,a){const o=a[0]&131072?Lh(i,[i[0],i[1],i[2],Tp(r[17])]):{};a[0]&256|a[1]&32&&(o.$$scope={dirty:a,ctx:r}),e.$set(o)},i(r){t||(U(e.$$.fragment,r),t=!0)},o(r){W(e.$$.fragment,r),t=!1},d(r){be(e,r)}}}function _re(n){let e,t;return e=new fre({}),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function vre(n){let e,t;return e=new mre({}),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function kre(n){let e,t,i,s;const r=[vre,_re],a=[];function o(l,c){return l[8]?0:1}return e=o(n),t=a[e]=r[e](n),{c(){t.c(),i=zt()},l(l){t.l(l),i=zt()},m(l,c){a[e].m(l,c),$(l,i,c),s=!0},p(l,c){let h=e;e=o(l),e!==h&&(bt(),W(a[h],1,1,()=>{a[h]=null}),xt(),t=a[e],t||(t=a[e]=r[e](l),t.c()),U(t,1),t.m(i.parentNode,i))},i(l){s||(U(t),s=!0)},o(l){W(t),s=!1},d(l){l&&E(i),a[e].d(l)}}}function Cre(n){let e,t,i,s,r,a;const o=n[35].before,l=Gs(o,n,n[36],zS);let c=n[1]&&jS(n),h=n[2]&&GS(n),u=n[3]&&VS(n);const d=n[35].default,f=Gs(d,n,n[36],null),g=n[35].after,m=Gs(g,n,n[36],HS);return{c(){l&&l.c(),e=Ce(),c&&c.c(),t=Ce(),h&&h.c(),i=Ce(),u&&u.c(),s=Ce(),f&&f.c(),r=Ce(),m&&m.c()},l(x){l&&l.l(x),e=Ae(x),c&&c.l(x),t=Ae(x),h&&h.l(x),i=Ae(x),u&&u.l(x),s=Ae(x),f&&f.l(x),r=Ae(x),m&&m.l(x)},m(x,p){l&&l.m(x,p),$(x,e,p),c&&c.m(x,p),$(x,t,p),h&&h.m(x,p),$(x,i,p),u&&u.m(x,p),$(x,s,p),f&&f.m(x,p),$(x,r,p),m&&m.m(x,p),a=!0},p(x,p){l&&l.p&&(!a||p[1]&32)&&Vs(l,o,x,x[36],a?Ws(o,x[36],p,bre):qs(x[36]),zS),x[1]?c?(c.p(x,p),p[0]&2&&U(c,1)):(c=jS(x),c.c(),U(c,1),c.m(t.parentNode,t)):c&&(bt(),W(c,1,1,()=>{c=null}),xt()),x[2]?h?(h.p(x,p),p[0]&4&&U(h,1)):(h=GS(x),h.c(),U(h,1),h.m(i.parentNode,i)):h&&(bt(),W(h,1,1,()=>{h=null}),xt()),x[3]?u?(u.p(x,p),p[0]&8&&U(u,1)):(u=VS(x),u.c(),U(u,1),u.m(s.parentNode,s)):u&&(bt(),W(u,1,1,()=>{u=null}),xt()),f&&f.p&&(!a||p[1]&32)&&Vs(f,d,x,x[36],a?Ws(d,x[36],p,null):qs(x[36]),null),m&&m.p&&(!a||p[1]&32)&&Vs(m,g,x,x[36],a?Ws(g,x[36],p,pre):qs(x[36]),HS)},i(x){a||(U(l,x),U(c),U(h),U(u),U(f,x),U(m,x),a=!0)},o(x){W(l,x),W(c),W(h),W(u),W(f,x),W(m,x),a=!1},d(x){x&&(E(e),E(t),E(i),E(s),E(r)),l&&l.d(x),c&&c.d(x),h&&h.d(x),u&&u.d(x),f&&f.d(x),m&&m.d(x)}}}function Are(n){let e,t;return e=new ZO({props:{class:Ei(["svelte-flow__controls",n[7],n[6]]),position:n[0],"data-testid":"svelte-flow__controls","aria-label":n[4]??"Svelte Flow controls",style:n[5],$$slots:{default:[Cre]},$$scope:{ctx:n}}}),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p(i,s){const r={};s[0]&192&&(r.class=Ei(["svelte-flow__controls",i[7],i[6]])),s[0]&1&&(r.position=i[0]),s[0]&16&&(r["aria-label"]=i[4]??"Svelte Flow controls"),s[0]&32&&(r.style=i[5]),s[0]&1806|s[1]&32&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function Sre(n,e,t){let i,s,r,a,o,l,c,h,u,d,{$$slots:f={},$$scope:g}=e,{position:m="bottom-left"}=e,{showZoom:x=!0}=e,{showFitView:p=!0}=e,{showLock:y=!0}=e,{buttonBgColor:w=void 0}=e,{buttonBgColorHover:_=void 0}=e,{buttonColor:v=void 0}=e,{buttonColorHover:C=void 0}=e,{buttonBorderColor:k=void 0}=e,{ariaLabel:I=void 0}=e,{style:S=void 0}=e,{orientation:M="vertical"}=e,{fitViewOptions:N=void 0}=e,{class:F=""}=e;const{zoomIn:H,zoomOut:T,fitView:z,viewport:R,minZoom:L,maxZoom:Y,nodesDraggable:j,nodesConnectable:J,elementsSelectable:G}=ts();Pe(n,R,P=>t(30,l=P)),Pe(n,L,P=>t(31,c=P)),Pe(n,Y,P=>t(29,o=P)),Pe(n,j,P=>t(34,d=P)),Pe(n,J,P=>t(33,u=P)),Pe(n,G,P=>t(32,h=P));const se={bgColor:w,bgColorHover:_,color:v,colorHover:C,borderColor:k},de=()=>{H()},he=()=>{T()},we=()=>{z(N)},ye=()=>{t(8,i=!i),j.set(i),J.set(i),G.set(i)};return n.$$set=P=>{"position"in P&&t(0,m=P.position),"showZoom"in P&&t(1,x=P.showZoom),"showFitView"in P&&t(2,p=P.showFitView),"showLock"in P&&t(3,y=P.showLock),"buttonBgColor"in P&&t(22,w=P.buttonBgColor),"buttonBgColorHover"in P&&t(23,_=P.buttonBgColorHover),"buttonColor"in P&&t(24,v=P.buttonColor),"buttonColorHover"in P&&t(25,C=P.buttonColorHover),"buttonBorderColor"in P&&t(26,k=P.buttonBorderColor),"ariaLabel"in P&&t(4,I=P.ariaLabel),"style"in P&&t(5,S=P.style),"orientation"in P&&t(27,M=P.orientation),"fitViewOptions"in P&&t(28,N=P.fitViewOptions),"class"in P&&t(6,F=P.class),"$$scope"in P&&t(36,g=P.$$scope)},n.$$.update=()=>{n.$$.dirty[1]&14&&t(8,i=d||u||h),n.$$.dirty[0]&1073741824|n.$$.dirty[1]&1&&t(10,s=l.zoom<=c),n.$$.dirty[0]&1610612736&&t(9,r=l.zoom>=o),n.$$.dirty[0]&134217728&&t(7,a=M==="horizontal"?"horizontal":"vertical")},[m,x,p,y,I,S,F,a,i,r,s,R,L,Y,j,J,G,se,de,he,we,ye,w,_,v,C,k,M,N,o,l,c,h,u,d,f,g]}let Ire=class extends Nt{constructor(e){super(),Ot(this,e,Sre,Are,Ut,{position:0,showZoom:1,showFitView:2,showLock:3,buttonBgColor:22,buttonBgColorHover:23,buttonColor:24,buttonColorHover:25,buttonBorderColor:26,ariaLabel:4,style:5,orientation:27,fitViewOptions:28,class:6},null,[-1,-1])}};var f0;(function(n){n.Lines="lines",n.Dots="dots",n.Cross="cross"})(f0||(f0={}));function Ere(n){let e,t;return{c(){e=at("circle"),this.h()},l(i){e=ot(i,"circle",{cx:!0,cy:!0,r:!0,class:!0}),q(e).forEach(E),this.h()},h(){A(e,"cx",n[0]),A(e,"cy",n[0]),A(e,"r",n[0]),A(e,"class",t=Ei(["svelte-flow__background-pattern","dots",n[1]]))},m(i,s){$(i,e,s)},p(i,[s]){s&1&&A(e,"cx",i[0]),s&1&&A(e,"cy",i[0]),s&1&&A(e,"r",i[0]),s&2&&t!==(t=Ei(["svelte-flow__background-pattern","dots",i[1]]))&&A(e,"class",t)},i:Ct,o:Ct,d(i){i&&E(e)}}}function Tre(n,e,t){let{radius:i=5}=e,{class:s=""}=e;return n.$$set=r=>{"radius"in r&&t(0,i=r.radius),"class"in r&&t(1,s=r.class)},[i,s]}class Rre extends Nt{constructor(e){super(),Ot(this,e,Tre,Ere,Ut,{radius:0,class:1})}}function Mre(n){let e,t,i;return{c(){e=at("path"),this.h()},l(s){e=ot(s,"path",{"stroke-width":!0,d:!0,class:!0}),q(e).forEach(E),this.h()},h(){A(e,"stroke-width",n[0]),A(e,"d",t=`M${n[1][0]/2} 0 V${n[1][1]} M0 ${n[1][1]/2} H${n[1][0]}`),A(e,"class",i=Ei(["svelte-flow__background-pattern",n[2],n[3]]))},m(s,r){$(s,e,r)},p(s,[r]){r&1&&A(e,"stroke-width",s[0]),r&2&&t!==(t=`M${s[1][0]/2} 0 V${s[1][1]} M0 ${s[1][1]/2} H${s[1][0]}`)&&A(e,"d",t),r&12&&i!==(i=Ei(["svelte-flow__background-pattern",s[2],s[3]]))&&A(e,"class",i)},i:Ct,o:Ct,d(s){s&&E(e)}}}function Pre(n,e,t){let{lineWidth:i=1}=e,{dimensions:s}=e,{variant:r=void 0}=e,{class:a=""}=e;return n.$$set=o=>{"lineWidth"in o&&t(0,i=o.lineWidth),"dimensions"in o&&t(1,s=o.dimensions),"variant"in o&&t(2,r=o.variant),"class"in o&&t(3,a=o.class)},[i,s,r,a]}class Nre extends Nt{constructor(e){super(),Ot(this,e,Pre,Mre,Ut,{lineWidth:0,dimensions:1,variant:2,class:3})}}function Ore(n){let e,t;return e=new Nre({props:{dimensions:n[6],variant:n[0],lineWidth:n[1],class:n[4]}}),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p(i,s){const r={};s&64&&(r.dimensions=i[6]),s&1&&(r.variant=i[0]),s&2&&(r.lineWidth=i[1]),s&16&&(r.class=i[4]),e.$set(r)},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function Dre(n){let e,t;return e=new Rre({props:{radius:n[7]/2,class:n[4]}}),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p(i,s){const r={};s&128&&(r.radius=i[7]/2),s&16&&(r.class=i[4]),e.$set(r)},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function Fre(n){let e,t,i,s,r,a,o,l,c,h,u,d,f;const g=[Dre,Ore],m=[];function x(p,y){return p[14]?0:1}return i=x(n),s=m[i]=g[i](n),{c(){e=at("svg"),t=at("pattern"),s.c(),h=at("rect"),this.h()},l(p){e=ot(p,"svg",{class:!0,"data-testid":!0});var y=q(e);t=ot(y,"pattern",{id:!0,x:!0,y:!0,width:!0,height:!0,patternUnits:!0,patternTransform:!0});var w=q(t);s.l(w),w.forEach(E),h=ot(y,"rect",{x:!0,y:!0,width:!0,height:!0,fill:!0}),q(h).forEach(E),y.forEach(E),this.h()},h(){A(t,"id",n[11]),A(t,"x",r=n[9].x%n[8][0]),A(t,"y",a=n[9].y%n[8][1]),A(t,"width",o=n[8][0]),A(t,"height",l=n[8][1]),A(t,"patternUnits","userSpaceOnUse"),A(t,"patternTransform",c=`translate(-${n[10][0]},-${n[10][1]})`),A(h,"x","0"),A(h,"y","0"),A(h,"width","100%"),A(h,"height","100%"),A(h,"fill",u=`url(#${n[11]})`),A(e,"class",d=rv(Ei(["svelte-flow__background",n[5]]))+" svelte-1r7pe8d"),A(e,"data-testid","svelte-flow__background"),nn(e,"--xy-background-color-props",n[2]),nn(e,"--xy-background-pattern-color-props",n[3])},m(p,y){$(p,e,y),K(e,t),m[i].m(t,null),K(e,h),f=!0},p(p,[y]){s.p(p,y),(!f||y&2048)&&A(t,"id",p[11]),(!f||y&768&&r!==(r=p[9].x%p[8][0]))&&A(t,"x",r),(!f||y&768&&a!==(a=p[9].y%p[8][1]))&&A(t,"y",a),(!f||y&256&&o!==(o=p[8][0]))&&A(t,"width",o),(!f||y&256&&l!==(l=p[8][1]))&&A(t,"height",l),(!f||y&1024&&c!==(c=`translate(-${p[10][0]},-${p[10][1]})`))&&A(t,"patternTransform",c),(!f||y&2048&&u!==(u=`url(#${p[11]})`))&&A(h,"fill",u),(!f||y&32&&d!==(d=rv(Ei(["svelte-flow__background",p[5]]))+" svelte-1r7pe8d"))&&A(e,"class",d),y&4&&nn(e,"--xy-background-color-props",p[2]),y&8&&nn(e,"--xy-background-pattern-color-props",p[3])},i(p){f||(U(s),f=!0)},o(p){W(s),f=!1},d(p){p&&E(e),m[i].d()}}}const Lre={[f0.Dots]:1,[f0.Lines]:1,[f0.Cross]:6};function Bre(n,e,t){let i,s,r,a,o,l,c,{id:h=void 0}=e,{variant:u=f0.Dots}=e,{gap:d=20}=e,{size:f=1}=e,{lineWidth:g=1}=e,{bgColor:m=void 0}=e,{patternColor:x=void 0}=e,{patternClass:p=void 0}=e,{class:y=""}=e;const{viewport:w,flowId:_}=ts();Pe(n,w,S=>t(9,l=S)),Pe(n,_,S=>t(18,c=S));const v=f||Lre[u],C=u===f0.Dots,k=u===f0.Cross,I=Array.isArray(d)?d:[d,d];return n.$$set=S=>{"id"in S&&t(15,h=S.id),"variant"in S&&t(0,u=S.variant),"gap"in S&&t(16,d=S.gap),"size"in S&&t(17,f=S.size),"lineWidth"in S&&t(1,g=S.lineWidth),"bgColor"in S&&t(2,m=S.bgColor),"patternColor"in S&&t(3,x=S.patternColor),"patternClass"in S&&t(4,p=S.patternClass),"class"in S&&t(5,y=S.class)},n.$$.update=()=>{n.$$.dirty&294912&&t(11,i=`background-pattern-${c}-${h||""}`),n.$$.dirty&512&&t(8,s=[I[0]*l.zoom||1,I[1]*l.zoom||1]),n.$$.dirty&512&&t(7,r=v*l.zoom),n.$$.dirty&384&&t(6,a=k?[r,r]:s),n.$$.dirty&192&&t(10,o=C?[r/2,r/2]:[a[0]/2,a[1]/2])},[u,g,m,x,p,y,a,r,s,l,o,i,w,_,C,h,d,f,c]}class Ure extends Nt{constructor(e){super(),Ot(this,e,Bre,Fre,Ut,{id:15,variant:0,gap:16,size:17,lineWidth:1,bgColor:2,patternColor:3,patternClass:4,class:5})}}const qS=n=>rne(n);function Hre(){const{zoomIn:n,zoomOut:e,fitView:t,onbeforedelete:i,snapGrid:s,viewport:r,width:a,height:o,minZoom:l,maxZoom:c,panZoom:h,nodes:u,edges:d,domNode:f,nodeLookup:g,nodeOrigin:m,edgeLookup:x,connectionLookup:p}=ts(),y=v=>{var M,N;const C=$e(g),k=qS(v)?v:C.get(v.id),I=k.parentId?hne(k.position,k.measured,k.parentId,C,$e(m)):k.position,S={id:k.id,position:I,width:((M=k.measured)==null?void 0:M.width)??k.width,height:((N=k.measured)==null?void 0:N.height)??k.height,data:k.data};return jg(S)},w=(v,C,k={replace:!1})=>{var M;const I=(M=$e(g).get(v))==null?void 0:M.internals.userNode;if(!I)return;const S=typeof C=="function"?C(I):C;k.replace?u.update(N=>N.map(F=>F.id===v?qS(S)?S:{...F,...S}:F)):(Object.assign(I,S),u.update(N=>N))},_=v=>$e(g).get(v);return{zoomIn:n,zoomOut:e,getInternalNode:_,getNode:v=>{var C;return(C=_(v))==null?void 0:C.internals.userNode},getNodes:v=>v===void 0?$e(u):WS($e(g),v),getEdge:v=>$e(x).get(v),getEdges:v=>v===void 0?$e(d):WS($e(x),v),setZoom:(v,C)=>{const k=$e(h);return k?k.scaleTo(v,{duration:C==null?void 0:C.duration}):Promise.resolve(!1)},getZoom:()=>$e(r).zoom,setViewport:async(v,C)=>{const k=$e(r),I=$e(h);return I?(await I.setViewport({x:v.x??k.x,y:v.y??k.y,zoom:v.zoom??k.zoom},{duration:C==null?void 0:C.duration}),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>$e(r),setCenter:async(v,C,k)=>{const I=typeof(k==null?void 0:k.zoom)<"u"?k.zoom:$e(c),S=$e(h);return S?(await S.setViewport({x:$e(a)/2-v*I,y:$e(o)/2-C*I,zoom:I},{duration:k==null?void 0:k.duration}),Promise.resolve(!0)):Promise.resolve(!1)},fitView:t,fitBounds:async(v,C)=>{const k=$e(h);if(!k)return Promise.resolve(!1);const I=G_(v,$e(a),$e(o),$e(l),$e(c),(C==null?void 0:C.padding)??.1);return await k.setViewport(I,{duration:C==null?void 0:C.duration}),Promise.resolve(!0)},getIntersectingNodes:(v,C=!0,k)=>{const I=lS(v),S=I?v:y(v);return S?(k||$e(u)).filter(M=>{const N=$e(g).get(M.id);if(!N||!I&&M.id===v.id)return!1;const F=jg(N),H=r2(F,S);return C&&H>0||H>=S.width*S.height}):[]},isNodeIntersecting:(v,C,k=!0)=>{const S=lS(v)?v:y(v);if(!S)return!1;const M=r2(S,C);return k&&M>0||M>=S.width*S.height},deleteElements:async({nodes:v=[],edges:C=[]})=>{const{nodes:k,edges:I}=await wO({nodesToRemove:v,edgesToRemove:C,nodes:$e(u),edges:$e(d),onBeforeDelete:$e(i)});return k&&u.update(S=>S.filter(M=>!k.some(({id:N})=>N===M.id))),I&&d.update(S=>S.filter(M=>!I.some(({id:N})=>N===M.id))),{deletedNodes:k,deletedEdges:I}},screenToFlowPosition:(v,C={snapToGrid:!0})=>{const k=$e(f);if(!k)return v;const I=C.snapToGrid?$e(s):!1,{x:S,y:M,zoom:N}=$e(r),{x:F,y:H}=k.getBoundingClientRect(),T={x:v.x-F,y:v.y-H};return Ax(T,[S,M,N],I!==null,I||[1,1])},flowToScreenPosition:v=>{const C=$e(f);if(!C)return v;const{x:k,y:I,zoom:S}=$e(r),{x:M,y:N}=C.getBoundingClientRect(),F=kO(v,[k,I,S]);return{x:F.x+M,y:F.y+N}},toObject:()=>({nodes:$e(u).map(v=>({...v,position:{...v.position},data:{...v.data}})),edges:$e(d).map(v=>({...v})),viewport:{...$e(r)}}),updateNode:w,updateNodeData:(v,C,k)=>{var M;const I=(M=$e(g).get(v))==null?void 0:M.internals.userNode;if(!I)return;const S=typeof C=="function"?C(I):C;I.data=k!=null&&k.replace?S:{...I.data,...S},u.update(N=>N)},getNodesBounds:v=>{const C=$e(g),k=$e(m);return ane(v,{nodeLookup:C,nodeOrigin:k})},getHandleConnections:({type:v,id:C,nodeId:k})=>{var I;return Array.from(((I=$e(p).get(`${k}-${v}-${C??null}`))==null?void 0:I.values())??[])},viewport:r}}function WS(n,e){var i;const t=[];for(const s of e){const r=n.get(s);if(r){const a="internals"in r?(i=r.internals)==null?void 0:i.userNode:r;t.push(a)}}return t}function zre(){const{nodesInitialized:n}=ts();return{subscribe:n.subscribe}}function KS(n,e,t){const i=n.slice();return i[25]=e[t],i[27]=t,i}function XS(n,e,t){const i=n.slice();return i[22]=e[t],i[24]=t,i}function jre(n){let e,t;return e=new a4({props:{className:"size-4"}}),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p:Ct,i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function Gre(n){let e,t,i,s,r,a,o,l=n[8].t("Tools")+"",c,h,u=n[8].t("Functions")+"",d,f,g,m,x,p,y,w;function _(I,S){if(I[1]==="tools")return qre;if(I[1]==="functions")return Vre}let v=_(n),C=v&&v(n),k=n[2]&&ZS(n);return{c(){e=ee("form"),t=ee("div"),i=ee("div"),s=ee("div"),r=ee("div"),a=ee("select"),o=ee("option"),c=vt(l),h=ee("option"),d=vt(u),f=Ce(),g=ee("div"),m=ee("select"),C&&C.c(),x=Ce(),k&&k.c(),this.h()},l(I){e=te(I,"FORM",{class:!0});var S=q(e);t=te(S,"DIV",{class:!0});var M=q(t);i=te(M,"DIV",{class:!0});var N=q(i);s=te(N,"DIV",{class:!0});var F=q(s);r=te(F,"DIV",{class:!0});var H=q(r);a=te(H,"SELECT",{class:!0,placeholder:!0});var T=q(a);o=te(T,"OPTION",{class:!0});var z=q(o);c=kt(z,l),z.forEach(E),h=te(T,"OPTION",{class:!0});var R=q(h);d=kt(R,u),R.forEach(E),T.forEach(E),H.forEach(E),f=Ae(F),g=te(F,"DIV",{class:!0});var L=q(g);m=te(L,"SELECT",{class:!0});var Y=q(m);C&&C.l(Y),Y.forEach(E),L.forEach(E),F.forEach(E),N.forEach(E),x=Ae(M),k&&k.l(M),M.forEach(E),S.forEach(E),this.h()},h(){o.__value="tools",yo(o,o.__value),A(o,"class","bg-gray-100 dark:bg-gray-800"),h.__value="functions",yo(h,h.__value),A(h,"class","bg-gray-100 dark:bg-gray-800"),A(a,"class","w-full rounded-sm text-xs py-2 px-1 bg-transparent outline-hidden"),A(a,"placeholder","Select"),n[1]===void 0&&s0(()=>n[13].call(a)),A(r,"class","flex-1"),A(m,"class","w-full rounded-sm py-2 px-1 text-xs bg-transparent outline-hidden"),n[2]===void 0&&s0(()=>n[14].call(m)),A(g,"class","flex-1"),A(s,"class","flex gap-2"),A(i,"class","space-y-1"),A(t,"class","flex flex-col"),A(e,"class","flex flex-col h-full justify-between space-y-3 text-sm")},m(I,S){$(I,e,S),K(e,t),K(t,i),K(i,s),K(s,r),K(r,a),K(a,o),K(o,c),K(a,h),K(h,d),Ex(a,n[1],!0),K(s,f),K(s,g),K(g,m),C&&C.m(m,null),Ex(m,n[2],!0),K(t,x),k&&k.m(t,null),p=!0,y||(w=[yt(a,"change",n[13]),yt(m,"change",n[14]),yt(m,"change",n[15]),yt(e,"submit",qg(n[18]))],y=!0)},p(I,S){(!p||S&256)&&l!==(l=I[8].t("Tools")+"")&&Et(c,l),(!p||S&256)&&u!==(u=I[8].t("Functions")+"")&&Et(d,u),S&2&&Ex(a,I[1]),v===(v=_(I))&&C?C.p(I,S):(C&&C.d(1),C=v&&v(I),C&&(C.c(),C.m(m,null))),S&196&&Ex(m,I[2]),I[2]?k?(k.p(I,S),S&4&&U(k,1)):(k=ZS(I),k.c(),U(k,1),k.m(t,null)):k&&(bt(),W(k,1,1,()=>{k=null}),xt())},i(I){p||(U(k),p=!0)},o(I){W(k),p=!1},d(I){I&&E(e),C&&C.d(),k&&k.d(),y=!1,Qr(w)}}}function Vre(n){let e,t=n[8].t("Select a function")+"",i,s,r=Zn(n[7]),a=[];for(let o=0;o<r.length;o+=1)a[o]=YS(KS(n,r,o));return{c(){e=ee("option"),i=vt(t);for(let o=0;o<a.length;o+=1)a[o].c();s=zt(),this.h()},l(o){e=te(o,"OPTION",{class:!0});var l=q(e);i=kt(l,t),l.forEach(E);for(let c=0;c<a.length;c+=1)a[c].l(o);s=zt(),this.h()},h(){e.__value="",yo(e,e.__value),e.selected=!0,e.disabled=!0,A(e,"class","bg-gray-100 dark:bg-gray-800")},m(o,l){$(o,e,l),K(e,i);for(let c=0;c<a.length;c+=1)a[c]&&a[c].m(o,l);$(o,s,l)},p(o,l){if(l&256&&t!==(t=o[8].t("Select a function")+"")&&Et(i,t),l&128){r=Zn(o[7]);let c;for(c=0;c<r.length;c+=1){const h=KS(o,r,c);a[c]?a[c].p(h,l):(a[c]=YS(h),a[c].c(),a[c].m(s.parentNode,s))}for(;c<a.length;c+=1)a[c].d(1);a.length=r.length}},d(o){o&&(E(e),E(s)),vo(a,o)}}}function qre(n){let e,t=n[8].t("Select a tool")+"",i,s,r=Zn(n[6]),a=[];for(let o=0;o<r.length;o+=1)a[o]=JS(XS(n,r,o));return{c(){e=ee("option"),i=vt(t);for(let o=0;o<a.length;o+=1)a[o].c();s=zt(),this.h()},l(o){e=te(o,"OPTION",{class:!0});var l=q(e);i=kt(l,t),l.forEach(E);for(let c=0;c<a.length;c+=1)a[c].l(o);s=zt(),this.h()},h(){e.__value="",yo(e,e.__value),e.selected=!0,e.disabled=!0,A(e,"class","bg-gray-100 dark:bg-gray-800")},m(o,l){$(o,e,l),K(e,i);for(let c=0;c<a.length;c+=1)a[c]&&a[c].m(o,l);$(o,s,l)},p(o,l){if(l&256&&t!==(t=o[8].t("Select a tool")+"")&&Et(i,t),l&64){r=Zn(o[6]);let c;for(c=0;c<r.length;c+=1){const h=XS(o,r,c);a[c]?a[c].p(h,l):(a[c]=JS(h),a[c].c(),a[c].m(s.parentNode,s))}for(;c<a.length;c+=1)a[c].d(1);a.length=r.length}},d(o){o&&(E(e),E(s)),vo(a,o)}}}function YS(n){let e,t=n[25].name+"",i,s;return{c(){e=ee("option"),i=vt(t),this.h()},l(r){e=te(r,"OPTION",{class:!0});var a=q(e);i=kt(a,t),a.forEach(E),this.h()},h(){e.__value=s=n[25].id,yo(e,e.__value),A(e,"class","bg-gray-100 dark:bg-gray-800")},m(r,a){$(r,e,a),K(e,i)},p(r,a){a&128&&t!==(t=r[25].name+"")&&Et(i,t),a&128&&s!==(s=r[25].id)&&(e.__value=s,yo(e,e.__value))},d(r){r&&E(e)}}}function JS(n){let e,t=n[22].name+"",i,s;return{c(){e=ee("option"),i=vt(t),this.h()},l(r){e=te(r,"OPTION",{class:!0});var a=q(e);i=kt(a,t),a.forEach(E),this.h()},h(){e.__value=s=n[22].id,yo(e,e.__value),A(e,"class","bg-gray-100 dark:bg-gray-800")},m(r,a){$(r,e,a),K(e,i)},p(r,a){a&64&&t!==(t=r[22].name+"")&&Et(i,t),a&64&&s!==(s=r[22].id)&&(e.__value=s,yo(e,e.__value))},d(r){r&&E(e)}}}function ZS(n){let e,t,i,s,r,a;const o=[Kre,Wre],l=[];function c(h,u){return h[3]?1:0}return s=c(n),r=l[s]=o[s](n),{c(){e=ee("hr"),t=Ce(),i=ee("div"),r.c(),this.h()},l(h){e=te(h,"HR",{class:!0}),t=Ae(h),i=te(h,"DIV",{class:!0});var u=q(i);r.l(u),u.forEach(E),this.h()},h(){A(e,"class","border-gray-50 dark:border-gray-800 my-1 w-full"),A(i,"class","my-2 text-xs")},m(h,u){$(h,e,u),$(h,t,u),$(h,i,u),l[s].m(i,null),a=!0},p(h,u){let d=s;s=c(h),s===d?l[s].p(h,u):(bt(),W(l[d],1,1,()=>{l[d]=null}),xt(),r=l[s],r?r.p(h,u):(r=l[s]=o[s](h),r.c()),U(r,1),r.m(i,null))},i(h){a||(U(r),a=!0)},o(h){W(r),a=!1},d(h){h&&(E(e),E(t),E(i)),l[s].d()}}}function Wre(n){let e,t;return e=new a4({props:{className:"size-5"}}),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p:Ct,i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function Kre(n){let e,t,i;function s(a){n[16](a)}let r={valvesSpec:n[4]};return n[5]!==void 0&&(r.valves=n[5]),e=new BF({props:r}),It.push(()=>Wt(e,"valves",s)),e.$on("change",n[17]),{c(){me(e.$$.fragment)},l(a){xe(e.$$.fragment,a)},m(a,o){pe(e,a,o),i=!0},p(a,o){const l={};o&16&&(l.valvesSpec=a[4]),!t&&o&32&&(t=!0,l.valves=a[5],qt(()=>t=!1)),e.$set(l)},i(a){i||(U(e.$$.fragment,a),i=!0)},o(a){W(e.$$.fragment,a),i=!1},d(a){be(e,a)}}}function Xre(n){let e,t,i,s;const r=[Gre,jre],a=[];function o(l,c){return l[0]&&!l[3]?0:1}return e=o(n),t=a[e]=r[e](n),{c(){t.c(),i=zt()},l(l){t.l(l),i=zt()},m(l,c){a[e].m(l,c),$(l,i,c),s=!0},p(l,[c]){let h=e;e=o(l),e===h?a[e].p(l,c):(bt(),W(a[h],1,1,()=>{a[h]=null}),xt(),t=a[e],t?t.p(l,c):(t=a[e]=r[e](l),t.c()),U(t,1),t.m(i.parentNode,i))},i(l){s||(U(t),s=!0)},o(l){W(t),s=!1},d(l){l&&E(i),a[e].d(l)}}}function Yre(n,e,t){let i,s,r;Pe(n,Gd,S=>t(6,i=S)),Pe(n,hv,S=>t(7,s=S));const a=Xa(),o=as("i18n");Pe(n,o,S=>t(8,r=S));let{show:l=!1}=e,c="tools",h="",u=!1,d=null,f={},g;const m=async()=>{g&&clearTimeout(g),g=setTimeout(()=>{p()},500)},x=async()=>{var S;if(t(3,u=!0),c==="tools"?(t(5,f=await rF(localStorage.token,h)),t(4,d=await aF(localStorage.token,h))):c==="functions"&&(t(5,f=await DF(localStorage.token,h)),t(4,d=await FF(localStorage.token,h))),d)for(const M in d.properties)((S=d.properties[M])==null?void 0:S.type)==="array"&&t(5,f[M]=(f[M]??[]).join(","),f);t(3,u=!1)},p=async()=>{var S;if(d){for(const M in d.properties)((S=d.properties[M])==null?void 0:S.type)==="array"&&t(5,f[M]=(f[M]??"").split(",").map(N=>N.trim()),f);if(c==="tools"){const M=await oF(localStorage.token,h,f).catch(N=>(Jt.error(`${N}`),null));M&&(Jt.success(r.t("Valves updated")),t(5,f=M))}else if(c==="functions"){const M=await LF(localStorage.token,h,f).catch(N=>(Jt.error(`${N}`),null));M&&(Jt.success(r.t("Valves updated")),t(5,f=M))}}},y=async()=>{t(3,u=!0),s===null&&hv.set(await OF(localStorage.token)),i===null&&Gd.set(await n4(localStorage.token)),t(3,u=!1)};function w(){c=av(this),t(1,c)}function _(){h=av(this),t(2,h),t(1,c)}const v=async()=>{await hn()};function C(S){f=S,t(5,f)}const k=()=>{m()},I=()=>{p(),a("save")};return n.$$set=S=>{"show"in S&&t(0,l=S.show)},n.$$.update=()=>{n.$$.dirty&2&&c&&t(2,h=""),n.$$.dirty&4&&h&&x(),n.$$.dirty&1&&l&&y()},[l,c,h,u,d,f,i,s,r,a,o,m,p,w,_,v,C,k,I]}class Jre extends Nt{constructor(e){super(),Ot(this,e,Yre,Xre,Ut,{show:0})}}function QS(n,e,t){const i=n.slice();return i[15]=e[t],i[17]=t,i}function $S(n){let e,t,i,s;return e=new Wg({props:{title:n[3].t("Files"),open:!0,buttonClassName:"w-full",$$slots:{content:[Zre]},$$scope:{ctx:n}}}),{c(){me(e.$$.fragment),t=Ce(),i=ee("hr"),this.h()},l(r){xe(e.$$.fragment,r),t=Ae(r),i=te(r,"HR",{class:!0}),this.h()},h(){A(i,"class","my-2 border-gray-50 dark:border-gray-700/10")},m(r,a){pe(e,r,a),$(r,t,a),$(r,i,a),s=!0},p(r,a){const o={};a&8&&(o.title=r[3].t("Files")),a&262145&&(o.$$scope={dirty:a,ctx:r}),e.$set(o)},i(r){s||(U(e.$$.fragment,r),s=!0)},o(r){W(e.$$.fragment,r),s=!1},d(r){r&&(E(t),E(i)),be(e,r)}}}function eI(n){var r,a;let e,t;function i(){return n[10](n[17])}function s(){return n[11](n[15])}return e=new BI({props:{className:"w-full",item:n[15],edit:!0,url:(r=n[15])!=null&&r.url?n[15].url:null,name:n[15].name,type:n[15].type,size:(a=n[15])==null?void 0:a.size,dismissible:!0}}),e.$on("dismiss",i),e.$on("click",s),{c(){me(e.$$.fragment)},l(o){xe(e.$$.fragment,o)},m(o,l){pe(e,o,l),t=!0},p(o,l){var h,u;n=o;const c={};l&1&&(c.item=n[15]),l&1&&(c.url=(h=n[15])!=null&&h.url?n[15].url:null),l&1&&(c.name=n[15].name),l&1&&(c.type=n[15].type),l&1&&(c.size=(u=n[15])==null?void 0:u.size),e.$set(c)},i(o){t||(U(e.$$.fragment,o),t=!0)},o(o){W(e.$$.fragment,o),t=!1},d(o){be(e,o)}}}function Zre(n){let e,t,i=Zn(n[0]),s=[];for(let a=0;a<i.length;a+=1)s[a]=eI(QS(n,i,a));const r=a=>W(s[a],1,1,()=>{s[a]=null});return{c(){e=ee("div");for(let a=0;a<s.length;a+=1)s[a].c();this.h()},l(a){e=te(a,"DIV",{class:!0,slot:!0});var o=q(e);for(let l=0;l<s.length;l+=1)s[l].l(o);o.forEach(E),this.h()},h(){A(e,"class","flex flex-col gap-1 mt-1.5"),A(e,"slot","content")},m(a,o){$(a,e,o);for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(e,null);t=!0},p(a,o){if(o&1){i=Zn(a[0]);let l;for(l=0;l<i.length;l+=1){const c=QS(a,i,l);s[l]?(s[l].p(c,o),U(s[l],1)):(s[l]=eI(c),s[l].c(),U(s[l],1),s[l].m(e,null))}for(bt(),l=i.length;l<s.length;l+=1)r(l);xt()}},i(a){if(!t){for(let o=0;o<i.length;o+=1)U(s[o]);t=!0}},o(a){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)W(s[o]);t=!1},d(a){a&&E(e),vo(s,a)}}}function Qre(n){let e,t,i;return t=new Jre({props:{show:n[2]}}),{c(){e=ee("div"),me(t.$$.fragment),this.h()},l(s){e=te(s,"DIV",{class:!0,slot:!0});var r=q(e);xe(t.$$.fragment,r),r.forEach(E),this.h()},h(){A(e,"class","text-sm"),A(e,"slot","content")},m(s,r){$(s,e,r),pe(t,e,null),i=!0},p(s,r){const a={};r&4&&(a.show=s[2]),t.$set(a)},i(s){i||(U(t.$$.fragment,s),i=!0)},o(s){W(t.$$.fragment,s),i=!1},d(s){s&&E(e),be(t)}}}function tI(n){let e,t,i,s;return i=new Wg({props:{title:n[3].t("System Prompt"),open:!0,buttonClassName:"w-full",$$slots:{content:[$re]},$$scope:{ctx:n}}}),{c(){e=ee("hr"),t=Ce(),me(i.$$.fragment),this.h()},l(r){e=te(r,"HR",{class:!0}),t=Ae(r),xe(i.$$.fragment,r),this.h()},h(){A(e,"class","my-2 border-gray-50 dark:border-gray-700/10")},m(r,a){$(r,e,a),$(r,t,a),pe(i,r,a),s=!0},p(r,a){const o={};a&8&&(o.title=r[3].t("System Prompt")),a&262186&&(o.$$scope={dirty:a,ctx:r}),i.$set(o)},i(r){s||(U(i.$$.fragment,r),s=!0)},o(r){W(i.$$.fragment,r),s=!1},d(r){r&&(E(e),E(t)),be(i,r)}}}function $re(n){let e,t,i,s,r,a;return{c(){e=ee("div"),t=ee("textarea"),this.h()},l(o){e=te(o,"DIV",{class:!0,slot:!0});var l=q(e);t=te(l,"TEXTAREA",{class:!0,rows:!0,placeholder:!0}),q(t).forEach(E),l.forEach(E),this.h()},h(){A(t,"class",i="w-full text-xs outline-hidden resize-vertical "+(n[5].highContrastMode?"border-2 border-gray-300 dark:border-gray-700 rounded-lg bg-gray-50 dark:bg-gray-800 p-2.5":"py-1.5 bg-transparent")),A(t,"rows","4"),A(t,"placeholder",s=n[3].t("Enter system prompt")),A(e,"class",""),A(e,"slot","content")},m(o,l){$(o,e,l),K(e,t),yo(t,n[1].system),r||(a=yt(t,"input",n[13]),r=!0)},p(o,l){l&32&&i!==(i="w-full text-xs outline-hidden resize-vertical "+(o[5].highContrastMode?"border-2 border-gray-300 dark:border-gray-700 rounded-lg bg-gray-50 dark:bg-gray-800 p-2.5":"py-1.5 bg-transparent"))&&A(t,"class",i),l&8&&s!==(s=o[3].t("Enter system prompt"))&&A(t,"placeholder",s),l&2&&yo(t,o[1].system)},d(o){o&&E(e),r=!1,a()}}}function nI(n){let e,t,i,s;return i=new Wg({props:{title:n[3].t("Advanced Params"),open:!0,buttonClassName:"w-full",$$slots:{content:[eae]},$$scope:{ctx:n}}}),{c(){e=ee("hr"),t=Ce(),me(i.$$.fragment),this.h()},l(r){e=te(r,"HR",{class:!0}),t=Ae(r),xe(i.$$.fragment,r),this.h()},h(){A(e,"class","my-2 border-gray-50 dark:border-gray-700/10")},m(r,a){$(r,e,a),$(r,t,a),pe(i,r,a),s=!0},p(r,a){const o={};a&8&&(o.title=r[3].t("Advanced Params")),a&262162&&(o.$$scope={dirty:a,ctx:r}),i.$set(o)},i(r){s||(U(i.$$.fragment,r),s=!0)},o(r){W(i.$$.fragment,r),s=!1},d(r){r&&(E(e),E(t)),be(i,r)}}}function eae(n){var l;let e,t,i,s,r;function a(c){n[14](c)}let o={admin:((l=n[4])==null?void 0:l.role)==="admin",custom:!0};return n[1]!==void 0&&(o.params=n[1]),i=new NF({props:o}),It.push(()=>Wt(i,"params",a)),{c(){e=ee("div"),t=ee("div"),me(i.$$.fragment),this.h()},l(c){e=te(c,"DIV",{class:!0,slot:!0});var h=q(e);t=te(h,"DIV",{});var u=q(t);xe(i.$$.fragment,u),u.forEach(E),h.forEach(E),this.h()},h(){A(e,"class","text-sm mt-1.5"),A(e,"slot","content")},m(c,h){$(c,e,h),K(e,t),pe(i,t,null),r=!0},p(c,h){var d;const u={};h&16&&(u.admin=((d=c[4])==null?void 0:d.role)==="admin"),!s&&h&2&&(s=!0,u.params=c[1],qt(()=>s=!1)),i.$set(u)},i(c){r||(U(i.$$.fragment,c),r=!0)},o(c){W(i.$$.fragment,c),r=!1},d(c){c&&E(e),be(i)}}}function tae(n){var I,S,M,N,F,H;let e,t,i,s=n[3].t("Chat Controls")+"",r,a,o,l,c,h,u,d,f,g,m,x,p,y;l=new sx({props:{className:"size-3.5"}});let w=n[0].length>0&&$S(n);function _(T){n[12](T)}let v={title:n[3].t("Valves"),buttonClassName:"w-full",$$slots:{content:[Qre]},$$scope:{ctx:n}};n[2]!==void 0&&(v.open=n[2]),d=new Wg({props:v}),It.push(()=>Wt(d,"open",_));let C=(((I=n[4])==null?void 0:I.role)==="admin"||(((M=(S=n[4])==null?void 0:S.permissions.chat)==null?void 0:M.system_prompt)??!0))&&tI(n),k=(((N=n[4])==null?void 0:N.role)==="admin"||(((H=(F=n[4])==null?void 0:F.permissions.chat)==null?void 0:H.controls)??!0))&&nI(n);return{c(){e=ee("div"),t=ee("div"),i=ee("div"),r=vt(s),a=Ce(),o=ee("button"),me(l.$$.fragment),c=Ce(),h=ee("div"),w&&w.c(),u=Ce(),me(d.$$.fragment),g=Ce(),C&&C.c(),m=Ce(),k&&k.c(),this.h()},l(T){e=te(T,"DIV",{class:!0});var z=q(e);t=te(z,"DIV",{class:!0});var R=q(t);i=te(R,"DIV",{class:!0});var L=q(i);r=kt(L,s),L.forEach(E),a=Ae(R),o=te(R,"BUTTON",{class:!0});var Y=q(o);xe(l.$$.fragment,Y),Y.forEach(E),R.forEach(E),c=Ae(z),h=te(z,"DIV",{class:!0});var j=q(h);w&&w.l(j),u=Ae(j),xe(d.$$.fragment,j),g=Ae(j),C&&C.l(j),m=Ae(j),k&&k.l(j),j.forEach(E),z.forEach(E),this.h()},h(){A(i,"class","text-lg font-medium self-center font-primary"),A(o,"class","self-center"),A(t,"class","flex items-center justify-between dark:text-gray-100 mb-2"),A(h,"class","dark:text-gray-200 text-sm font-primary py-0.5 px-0.5"),A(e,"class","dark:text-white")},m(T,z){$(T,e,z),K(e,t),K(t,i),K(i,r),K(t,a),K(t,o),pe(l,o,null),K(e,c),K(e,h),w&&w.m(h,null),K(h,u),pe(d,h,null),K(h,g),C&&C.m(h,null),K(h,m),k&&k.m(h,null),x=!0,p||(y=yt(o,"click",n[9]),p=!0)},p(T,[z]){var L,Y,j,J,G,se;(!x||z&8)&&s!==(s=T[3].t("Chat Controls")+"")&&Et(r,s),T[0].length>0?w?(w.p(T,z),z&1&&U(w,1)):(w=$S(T),w.c(),U(w,1),w.m(h,u)):w&&(bt(),W(w,1,1,()=>{w=null}),xt());const R={};z&8&&(R.title=T[3].t("Valves")),z&262148&&(R.$$scope={dirty:z,ctx:T}),!f&&z&4&&(f=!0,R.open=T[2],qt(()=>f=!1)),d.$set(R),((L=T[4])==null?void 0:L.role)==="admin"||(((j=(Y=T[4])==null?void 0:Y.permissions.chat)==null?void 0:j.system_prompt)??!0)?C?(C.p(T,z),z&16&&U(C,1)):(C=tI(T),C.c(),U(C,1),C.m(h,m)):C&&(bt(),W(C,1,1,()=>{C=null}),xt()),((J=T[4])==null?void 0:J.role)==="admin"||(((se=(G=T[4])==null?void 0:G.permissions.chat)==null?void 0:se.controls)??!0)?k?(k.p(T,z),z&16&&U(k,1)):(k=nI(T),k.c(),U(k,1),k.m(h,null)):k&&(bt(),W(k,1,1,()=>{k=null}),xt())},i(T){x||(U(l.$$.fragment,T),U(w),U(d.$$.fragment,T),U(C),U(k),x=!0)},o(T){W(l.$$.fragment,T),W(w),W(d.$$.fragment,T),W(C),W(k),x=!1},d(T){T&&E(e),be(l),w&&w.d(),be(d),C&&C.d(),k&&k.d(),p=!1,y()}}}function nae(n,e,t){let i,s,r;Pe(n,k0,y=>t(4,s=y)),Pe(n,Ga,y=>t(5,r=y));const a=Xa(),o=as("i18n");Pe(n,o,y=>t(3,i=y));let{models:l=[]}=e,{chatFiles:c=[]}=e,{params:h={}}=e,u=!1;const d=()=>{a("close")},f=y=>{c.splice(y,1),t(0,c)},g=y=>{};function m(y){u=y,t(2,u)}function x(){h.system=this.value,t(1,h)}function p(y){h=y,t(1,h)}return n.$$set=y=>{"models"in y&&t(8,l=y.models),"chatFiles"in y&&t(0,c=y.chatFiles),"params"in y&&t(1,h=y.params)},[c,h,u,i,s,r,a,o,l,d,f,g,m,x,p]}class QO extends Nt{constructor(e){super(),Ot(this,e,nae,tae,Ut,{models:8,chatFiles:0,params:1})}}function iI(n,e,t){const i=n.slice();return i[10]=e[t],i}function iae(n){let e;const t=n[4].default,i=Gs(t,n,n[8],null);return{c(){i&&i.c()},l(s){i&&i.l(s)},m(s,r){i&&i.m(s,r),e=!0},p(s,r){i&&i.p&&(!e||r&256)&&Vs(i,t,s,s[8],e?Ws(t,s[8],r,null):qs(s[8]),null)},i(s){e||(U(i,s),e=!0)},o(s){W(i,s),e=!1},d(s){i&&i.d(s)}}}function sae(n){var a;let e,t,i=(((a=n[10])==null?void 0:a.label)??"Camera")+"",s,r;return{c(){e=ee("div"),t=ee("div"),s=vt(i),r=Ce(),this.h()},l(o){e=te(o,"DIV",{class:!0});var l=q(e);t=te(l,"DIV",{class:!0});var c=q(t);s=kt(c,i),c.forEach(E),l.forEach(E),r=Ae(o),this.h()},h(){A(t,"class","line-clamp-1"),A(e,"class","flex items-center")},m(o,l){$(o,e,l),K(e,t),K(t,s),$(o,r,l)},p(o,l){var c;l&2&&i!==(i=(((c=o[10])==null?void 0:c.label)??"Camera")+"")&&Et(s,i)},d(o){o&&(E(e),E(r))}}}function sI(n){let e,t;function i(){return n[5](n[10])}return e=new ua({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",$$slots:{default:[sae]},$$scope:{ctx:n}}}),e.$on("click",i),{c(){me(e.$$.fragment)},l(s){xe(e.$$.fragment,s)},m(s,r){pe(e,s,r),t=!0},p(s,r){n=s;const a={};r&258&&(a.$$scope={dirty:r,ctx:n}),e.$set(a)},i(s){t||(U(e.$$.fragment,s),t=!0)},o(s){W(e.$$.fragment,s),t=!1},d(s){be(e,s)}}}function rae(n){let e,t,i=Zn(n[1]),s=[];for(let a=0;a<i.length;a+=1)s[a]=sI(iI(n,i,a));const r=a=>W(s[a],1,1,()=>{s[a]=null});return{c(){for(let a=0;a<s.length;a+=1)s[a].c();e=zt()},l(a){for(let o=0;o<s.length;o+=1)s[o].l(a);e=zt()},m(a,o){for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(a,o);$(a,e,o),t=!0},p(a,o){if(o&10){i=Zn(a[1]);let l;for(l=0;l<i.length;l+=1){const c=iI(a,i,l);s[l]?(s[l].p(c,o),U(s[l],1)):(s[l]=sI(c),s[l].c(),U(s[l],1),s[l].m(e.parentNode,e))}for(bt(),l=i.length;l<s.length;l+=1)r(l);xt()}},i(a){if(!t){for(let o=0;o<i.length;o+=1)U(s[o]);t=!0}},o(a){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)W(s[o]);t=!1},d(a){a&&E(e),vo(s,a)}}}function aae(n){let e,t,i;return t=new i4({props:{class:"w-full max-w-[180px] rounded-lg px-1 py-1.5 border border-gray-300/30 dark:border-gray-700/50 z-9999 bg-white dark:bg-gray-900 dark:text-white shadow-xs",sideOffset:6,side:"top",align:"start",transition:W5,$$slots:{default:[rae]},$$scope:{ctx:n}}}),{c(){e=ee("div"),me(t.$$.fragment),this.h()},l(s){e=te(s,"DIV",{slot:!0});var r=q(e);xe(t.$$.fragment,r),r.forEach(E),this.h()},h(){A(e,"slot","content")},m(s,r){$(s,e,r),pe(t,e,null),i=!0},p(s,r){const a={};r&258&&(a.$$scope={dirty:r,ctx:s}),t.$set(a)},i(s){i||(U(t.$$.fragment,s),i=!0)},o(s){W(t.$$.fragment,s),i=!1},d(s){s&&E(e),be(t)}}}function oae(n){let e,t,i;function s(a){n[6](a)}let r={$$slots:{content:[aae],default:[iae]},$$scope:{ctx:n}};return n[2]!==void 0&&(r.show=n[2]),e=new s4({props:r}),It.push(()=>Wt(e,"show",s)),e.$on("change",n[7]),{c(){me(e.$$.fragment)},l(a){xe(e.$$.fragment,a)},m(a,o){pe(e,a,o),i=!0},p(a,[o]){const l={};o&258&&(l.$$scope={dirty:o,ctx:a}),!t&&o&4&&(t=!0,l.show=a[2],qt(()=>t=!1)),e.$set(l)},i(a){i||(U(e.$$.fragment,a),i=!0)},o(a){W(e.$$.fragment,a),i=!1},d(a){be(e,a)}}}function lae(n,e,t){let{$$slots:i={},$$scope:s}=e;as("i18n");const r=Xa();let{onClose:a=()=>{}}=e,{devices:o}=e,l=!1;const c=d=>{r("change",d.deviceId)};function h(d){l=d,t(2,l)}const u=d=>{d.detail===!1&&a()};return n.$$set=d=>{"onClose"in d&&t(0,a=d.onClose),"devices"in d&&t(1,o=d.devices),"$$scope"in d&&t(8,s=d.$$scope)},[a,o,l,r,i,c,h,u,s]}class cae extends Nt{constructor(e){super(),Ot(this,e,lae,oae,Ut,{onClose:0,devices:1})}}function rI(n){let e,t,i,s,r,a,o,l,c,h,u,d,f,g,m,x='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-5"><path d="M6.28 5.22a.75.75 0 0 0-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 1 0 1.06 1.06L10 11.06l3.72 3.72a.75.75 0 1 0 1.06-1.06L11.06 10l3.72-3.72a.75.75 0 0 0-1.06-1.06L10 8.94 6.28 5.22Z"></path></svg>',p,y,w,_=n[4]&&aI(n);function v(T,z){return T[4]?fae:gae}let C=v(n),k=C(n);const I=[yae,xae],S=[];function M(T,z){return T[4]?0:1}o=M(n),l=S[o]=I[o](n);function N(T,z){return T[1]?Cae:T[2]?kae:vae}let F=N(n),H=F(n);return{c(){e=ee("div"),_&&_.c(),t=Ce(),i=ee("div"),k.c(),s=Ce(),r=ee("div"),a=ee("div"),l.c(),c=Ce(),h=ee("div"),u=ee("button"),d=ee("div"),H.c(),f=Ce(),g=ee("div"),m=ee("button"),m.innerHTML=x,this.h()},l(T){e=te(T,"DIV",{class:!0});var z=q(e);_&&_.l(z),t=Ae(z),i=te(z,"DIV",{class:!0});var R=q(i);k.l(R),R.forEach(E),s=Ae(z),r=te(z,"DIV",{class:!0});var L=q(r);a=te(L,"DIV",{});var Y=q(a);l.l(Y),Y.forEach(E),c=Ae(L),h=te(L,"DIV",{});var j=q(h);u=te(j,"BUTTON",{type:!0});var J=q(u);d=te(J,"DIV",{class:!0});var G=q(d);H.l(G),G.forEach(E),J.forEach(E),j.forEach(E),f=Ae(L),g=te(L,"DIV",{});var se=q(g);m=te(se,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),ko(m)!=="svelte-1k5eavb"&&(m.innerHTML=x),se.forEach(E),L.forEach(E),z.forEach(E),this.h()},h(){A(i,"class","flex justify-center items-center flex-1 h-full w-full max-h-full"),A(d,"class","line-clamp-1 text-sm font-medium"),A(u,"type","button"),A(m,"class","p-3 rounded-full bg-gray-50 dark:bg-gray-900"),A(m,"type","button"),A(r,"class","flex justify-between items-center pb-2 w-full"),A(e,"class","max-w-lg w-full h-full max-h-[100dvh] flex flex-col justify-between p-3 md:p-6")},m(T,z){$(T,e,z),_&&_.m(e,null),K(e,t),K(e,i),k.m(i,null),K(e,s),K(e,r),K(r,a),S[o].m(a,null),K(r,c),K(r,h),K(h,u),K(u,d),H.m(d,null),K(r,f),K(r,g),K(g,m),p=!0,y||(w=[yt(u,"click",n[31]),yt(m,"click",n[32])],y=!0)},p(T,z){T[4]?_?_.p(T,z):(_=aI(T),_.c(),_.m(e,t)):_&&(_.d(1),_=null),C===(C=v(T))&&k?k.p(T,z):(k.d(1),k=C(T),k&&(k.c(),k.m(i,null)));let R=o;o=M(T),o===R?S[o].p(T,z):(bt(),W(S[R],1,1,()=>{S[R]=null}),xt(),l=S[o],l?l.p(T,z):(l=S[o]=I[o](T),l.c()),U(l,1),l.m(a,null)),F===(F=N(T))&&H?H.p(T,z):(H.d(1),H=F(T),H&&(H.c(),H.m(d,null)))},i(T){p||(U(l),p=!0)},o(T){W(l),p=!1},d(T){T&&E(e),_&&_.d(),k.d(),S[o].d(),H.d(),y=!1,Qr(w)}}}function aI(n){let e,t,i;function s(o,l){return o[3]?dae:o[1]||o[2]?uae:hae}let r=s(n),a=r(n);return{c(){e=ee("button"),a.c(),this.h()},l(o){e=te(o,"BUTTON",{type:!0,class:!0});var l=q(e);a.l(l),l.forEach(E),this.h()},h(){A(e,"type","button"),A(e,"class","flex justify-center items-center w-full h-20 min-h-20")},m(o,l){$(o,e,l),a.m(e,null),t||(i=yt(e,"click",n[26]),t=!0)},p(o,l){r===(r=s(o))&&a?a.p(o,l):(a.d(1),a=r(o),a&&(a.c(),a.m(e,null)))},d(o){o&&E(e),a.d(),t=!1,i()}}}function hae(n){let e,t,i;return{c(){e=ee("div"),this.h()},l(s){e=te(s,"DIV",{class:!0,style:!0}),q(e).forEach(E),this.h()},h(){var s,r,a,o,l,c,h,u,d;A(e,"class",t=(n[6]*100>4?" size-[4.5rem]":n[6]*100>2?" size-16":n[6]*100>1?"size-14":"size-12")+" transition-all rounded-full "+((((a=(r=(s=n[0])==null?void 0:s.info)==null?void 0:r.meta)==null?void 0:a.profile_image_url)??"/static/favicon.png")!=="/static/favicon.png"?" bg-cover bg-center bg-no-repeat":"bg-black dark:bg-white")+" bg-black dark:bg-white"),A(e,"style",i=(((c=(l=(o=n[0])==null?void 0:o.info)==null?void 0:l.meta)==null?void 0:c.profile_image_url)??"/static/favicon.png")!=="/static/favicon.png"?`background-image: url('${(d=(u=(h=n[0])==null?void 0:h.info)==null?void 0:u.meta)==null?void 0:d.profile_image_url}');`:"")},m(s,r){$(s,e,r)},p(s,r){var a,o,l,c,h,u,d,f,g;r[0]&65&&t!==(t=(s[6]*100>4?" size-[4.5rem]":s[6]*100>2?" size-16":s[6]*100>1?"size-14":"size-12")+" transition-all rounded-full "+((((l=(o=(a=s[0])==null?void 0:a.info)==null?void 0:o.meta)==null?void 0:l.profile_image_url)??"/static/favicon.png")!=="/static/favicon.png"?" bg-cover bg-center bg-no-repeat":"bg-black dark:bg-white")+" bg-black dark:bg-white")&&A(e,"class",t),r[0]&1&&i!==(i=(((u=(h=(c=s[0])==null?void 0:c.info)==null?void 0:h.meta)==null?void 0:u.profile_image_url)??"/static/favicon.png")!=="/static/favicon.png"?`background-image: url('${(g=(f=(d=s[0])==null?void 0:d.info)==null?void 0:f.meta)==null?void 0:g.profile_image_url}');`:"")&&A(e,"style",i)},d(s){s&&E(e)}}}function uae(n){let e,t,i,s,r,a;return{c(){e=at("svg"),t=at("style"),i=vt(`.spinner_qM83 {
								animation: spinner_8HQG 1.05s infinite;
							}
							.spinner_oXPr {
								animation-delay: 0.1s;
							}
							.spinner_ZTLf {
								animation-delay: 0.2s;
							}
							@keyframes spinner_8HQG {
								0%,
								57.14% {
									animation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);
									transform: translate(0);
								}
								28.57% {
									animation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);
									transform: translateY(-6px);
								}
								100% {
									transform: translate(0);
								}
							}
						`),s=at("circle"),r=at("circle"),a=at("circle"),this.h()},l(o){e=ot(o,"svg",{class:!0,viewBox:!0,fill:!0,xmlns:!0});var l=q(e);t=ot(l,"style",{});var c=q(t);i=kt(c,`.spinner_qM83 {
								animation: spinner_8HQG 1.05s infinite;
							}
							.spinner_oXPr {
								animation-delay: 0.1s;
							}
							.spinner_ZTLf {
								animation-delay: 0.2s;
							}
							@keyframes spinner_8HQG {
								0%,
								57.14% {
									animation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);
									transform: translate(0);
								}
								28.57% {
									animation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);
									transform: translateY(-6px);
								}
								100% {
									transform: translate(0);
								}
							}
						`),c.forEach(E),s=ot(l,"circle",{class:!0,cx:!0,cy:!0,r:!0}),q(s).forEach(E),r=ot(l,"circle",{class:!0,cx:!0,cy:!0,r:!0}),q(r).forEach(E),a=ot(l,"circle",{class:!0,cx:!0,cy:!0,r:!0}),q(a).forEach(E),l.forEach(E),this.h()},h(){A(s,"class","spinner_qM83"),A(s,"cx","4"),A(s,"cy","12"),A(s,"r","3"),A(r,"class","spinner_qM83 spinner_oXPr"),A(r,"cx","12"),A(r,"cy","12"),A(r,"r","3"),A(a,"class","spinner_qM83 spinner_ZTLf"),A(a,"cx","20"),A(a,"cy","12"),A(a,"r","3"),A(e,"class","size-12 text-gray-900 dark:text-gray-400"),A(e,"viewBox","0 0 24 24"),A(e,"fill","currentColor"),A(e,"xmlns","http://www.w3.org/2000/svg")},m(o,l){$(o,e,l),K(e,t),K(t,i),K(e,s),K(e,r),K(e,a)},p:Ct,d(o){o&&E(e)}}}function dae(n){let e,t;return{c(){e=ee("div"),t=vt(n[3]),this.h()},l(i){e=te(i,"DIV",{class:!0,style:!0});var s=q(e);t=kt(s,n[3]),s.forEach(E),this.h()},h(){A(e,"class","transition-all rounded-full"),nn(e,"font-size",(n[6]*100>4?"4.5":n[6]*100>2?"4.25":n[6]*100>1?"3.75":"3.5")+"rem"),nn(e,"width","100%"),nn(e,"text-align","center")},m(i,s){$(i,e,s),K(e,t)},p(i,s){s[0]&8&&Et(t,i[3]),s[0]&64&&nn(e,"font-size",(i[6]*100>4?"4.5":i[6]*100>2?"4.25":i[6]*100>1?"3.75":"3.5")+"rem")},d(i){i&&E(e)}}}function fae(n){let e,t,i,s,r,a,o,l='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-6"><path d="M5.28 4.22a.75.75 0 0 0-1.06 1.06L6.94 8l-2.72 2.72a.75.75 0 1 0 1.06 1.06L8 9.06l2.72 2.72a.75.75 0 1 0 1.06-1.06L9.06 8l2.72-2.72a.75.75 0 0 0-1.06-1.06L8 6.94 5.28 4.22Z"></path></svg>',c,h;return{c(){e=ee("div"),t=ee("video"),i=Ce(),s=ee("canvas"),r=Ce(),a=ee("div"),o=ee("button"),o.innerHTML=l,this.h()},l(u){e=te(u,"DIV",{class:!0});var d=q(e);t=te(d,"VIDEO",{id:!0,class:!0}),q(t).forEach(E),i=Ae(d),s=te(d,"CANVAS",{id:!0,style:!0}),q(s).forEach(E),r=Ae(d),a=te(d,"DIV",{class:!0});var f=q(a);o=te(f,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),ko(o)!=="svelte-16ul42n"&&(o.innerHTML=l),f.forEach(E),d.forEach(E),this.h()},h(){A(t,"id","camera-feed"),t.autoplay=!0,A(t,"class","rounded-2xl h-full min-w-full object-cover object-center"),t.playsInline=!0,A(s,"id","camera-canvas"),nn(s,"display","none"),A(o,"type","button"),A(o,"class","p-1.5 text-white cursor-pointer backdrop-blur-xl bg-black/10 rounded-full"),A(a,"class","absolute top-4 md:top-8 left-4"),A(e,"class","relative flex video-container w-full max-h-full pt-2 pb-4 md:py-6 px-2 h-full")},m(u,d){$(u,e,d),K(e,t),K(e,i),K(e,s),K(e,r),K(e,a),K(a,o),c||(h=yt(o,"click",n[28]),c=!0)},p:Ct,d(u){u&&E(e),c=!1,h()}}}function gae(n){let e,t,i;function s(o,l){return o[3]?bae:o[1]||o[2]?pae:mae}let r=s(n),a=r(n);return{c(){e=ee("button"),a.c(),this.h()},l(o){e=te(o,"BUTTON",{type:!0});var l=q(e);a.l(l),l.forEach(E),this.h()},h(){A(e,"type","button")},m(o,l){$(o,e,l),a.m(e,null),t||(i=yt(e,"click",n[27]),t=!0)},p(o,l){r===(r=s(o))&&a?a.p(o,l):(a.d(1),a=r(o),a&&(a.c(),a.m(e,null)))},d(o){o&&E(e),a.d(),t=!1,i()}}}function mae(n){let e,t,i;return{c(){e=ee("div"),this.h()},l(s){e=te(s,"DIV",{class:!0,style:!0}),q(e).forEach(E),this.h()},h(){var s,r,a,o,l,c,h,u,d;A(e,"class",t=(n[6]*100>4?" size-52":n[6]*100>2?"size-48":n[6]*100>1?"size-44":"size-40")+" transition-all rounded-full "+((((a=(r=(s=n[0])==null?void 0:s.info)==null?void 0:r.meta)==null?void 0:a.profile_image_url)??"/static/favicon.png")!=="/static/favicon.png"?" bg-cover bg-center bg-no-repeat":"bg-black dark:bg-white")),A(e,"style",i=(((c=(l=(o=n[0])==null?void 0:o.info)==null?void 0:l.meta)==null?void 0:c.profile_image_url)??"/static/favicon.png")!=="/static/favicon.png"?`background-image: url('${(d=(u=(h=n[0])==null?void 0:h.info)==null?void 0:u.meta)==null?void 0:d.profile_image_url}');`:"")},m(s,r){$(s,e,r)},p(s,r){var a,o,l,c,h,u,d,f,g;r[0]&65&&t!==(t=(s[6]*100>4?" size-52":s[6]*100>2?"size-48":s[6]*100>1?"size-44":"size-40")+" transition-all rounded-full "+((((l=(o=(a=s[0])==null?void 0:a.info)==null?void 0:o.meta)==null?void 0:l.profile_image_url)??"/static/favicon.png")!=="/static/favicon.png"?" bg-cover bg-center bg-no-repeat":"bg-black dark:bg-white"))&&A(e,"class",t),r[0]&1&&i!==(i=(((u=(h=(c=s[0])==null?void 0:c.info)==null?void 0:h.meta)==null?void 0:u.profile_image_url)??"/static/favicon.png")!=="/static/favicon.png"?`background-image: url('${(g=(f=(d=s[0])==null?void 0:d.info)==null?void 0:f.meta)==null?void 0:g.profile_image_url}');`:"")&&A(e,"style",i)},d(s){s&&E(e)}}}function pae(n){let e,t,i,s,r,a;return{c(){e=at("svg"),t=at("style"),i=vt(`.spinner_qM83 {
									animation: spinner_8HQG 1.05s infinite;
								}
								.spinner_oXPr {
									animation-delay: 0.1s;
								}
								.spinner_ZTLf {
									animation-delay: 0.2s;
								}
								@keyframes spinner_8HQG {
									0%,
									57.14% {
										animation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);
										transform: translate(0);
									}
									28.57% {
										animation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);
										transform: translateY(-6px);
									}
									100% {
										transform: translate(0);
									}
								}
							`),s=at("circle"),r=at("circle"),a=at("circle"),this.h()},l(o){e=ot(o,"svg",{class:!0,viewBox:!0,fill:!0,xmlns:!0});var l=q(e);t=ot(l,"style",{});var c=q(t);i=kt(c,`.spinner_qM83 {
									animation: spinner_8HQG 1.05s infinite;
								}
								.spinner_oXPr {
									animation-delay: 0.1s;
								}
								.spinner_ZTLf {
									animation-delay: 0.2s;
								}
								@keyframes spinner_8HQG {
									0%,
									57.14% {
										animation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);
										transform: translate(0);
									}
									28.57% {
										animation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);
										transform: translateY(-6px);
									}
									100% {
										transform: translate(0);
									}
								}
							`),c.forEach(E),s=ot(l,"circle",{class:!0,cx:!0,cy:!0,r:!0}),q(s).forEach(E),r=ot(l,"circle",{class:!0,cx:!0,cy:!0,r:!0}),q(r).forEach(E),a=ot(l,"circle",{class:!0,cx:!0,cy:!0,r:!0}),q(a).forEach(E),l.forEach(E),this.h()},h(){A(s,"class","spinner_qM83"),A(s,"cx","4"),A(s,"cy","12"),A(s,"r","3"),A(r,"class","spinner_qM83 spinner_oXPr"),A(r,"cx","12"),A(r,"cy","12"),A(r,"r","3"),A(a,"class","spinner_qM83 spinner_ZTLf"),A(a,"cx","20"),A(a,"cy","12"),A(a,"r","3"),A(e,"class","size-44 text-gray-900 dark:text-gray-400"),A(e,"viewBox","0 0 24 24"),A(e,"fill","currentColor"),A(e,"xmlns","http://www.w3.org/2000/svg")},m(o,l){$(o,e,l),K(e,t),K(t,i),K(e,s),K(e,r),K(e,a)},p:Ct,d(o){o&&E(e)}}}function bae(n){let e,t;return{c(){e=ee("div"),t=vt(n[3]),this.h()},l(i){e=te(i,"DIV",{class:!0,style:!0});var s=q(e);t=kt(s,n[3]),s.forEach(E),this.h()},h(){A(e,"class","transition-all rounded-full"),nn(e,"font-size",(n[6]*100>4?"13":n[6]*100>2?"12":n[6]*100>1?"11.5":"11")+"rem"),nn(e,"width","100%"),nn(e,"text-align","center")},m(i,s){$(i,e,s),K(e,t)},p(i,s){s[0]&8&&Et(t,i[3]),s[0]&64&&nn(e,"font-size",(i[6]*100>4?"13":i[6]*100>2?"12":i[6]*100>1?"11.5":"11")+"rem")},d(i){i&&E(e)}}}function xae(n){let e,t;return e=new wi({props:{content:n[11].t("Camera"),$$slots:{default:[wae]},$$scope:{ctx:n}}}),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p(i,s){const r={};s[0]&2048&&(r.content=i[11].t("Camera")),s[2]&16&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function yae(n){let e,t;return e=new cae({props:{devices:n[8],$$slots:{default:[_ae]},$$scope:{ctx:n}}}),e.$on("change",n[29]),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p(i,s){const r={};s[0]&256&&(r.devices=i[8]),s[2]&16&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function wae(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5"><path stroke-linecap="round" stroke-linejoin="round" d="M6.827 6.175A2.31 2.31 0 0 1 5.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 0 0-1.134-.175 2.31 2.31 0 0 1-1.64-1.055l-.822-1.316a2.192 2.192 0 0 0-1.736-1.039 48.774 48.774 0 0 0-5.232 0 2.192 2.192 0 0 0-1.736 1.039l-.821 1.316Z"></path><path stroke-linecap="round" stroke-linejoin="round" d="M16.5 12.75a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0ZM18.75 10.5h.008v.008h-.008V10.5Z"></path></svg>',i,s;return{c(){e=ee("button"),e.innerHTML=t,this.h()},l(r){e=te(r,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),ko(e)!=="svelte-1n1gs9g"&&(e.innerHTML=t),this.h()},h(){A(e,"class","p-3 rounded-full bg-gray-50 dark:bg-gray-900"),A(e,"type","button")},m(r,a){$(r,e,a),i||(s=yt(e,"click",n[30]),i=!0)},p:Ct,d(r){r&&E(e),i=!1,s()}}}function _ae(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-5"><path fill-rule="evenodd" d="M15.312 11.424a5.5 5.5 0 0 1-9.201 2.466l-.312-.311h2.433a.75.75 0 0 0 0-1.5H3.989a.75.75 0 0 0-.75.75v4.242a.75.75 0 0 0 1.5 0v-2.43l.31.31a7 7 0 0 0 11.712-3.138.75.75 0 0 0-1.449-.39Zm1.23-3.723a.75.75 0 0 0 .219-.53V2.929a.75.75 0 0 0-1.5 0V5.36l-.31-.31A7 7 0 0 0 3.239 8.188a.75.75 0 1 0 1.448.389A5.5 5.5 0 0 1 13.89 6.11l.311.31h-2.432a.75.75 0 0 0 0 1.5h4.243a.75.75 0 0 0 .53-.219Z" clip-rule="evenodd"></path></svg>';return{c(){e=ee("button"),e.innerHTML=t,this.h()},l(i){e=te(i,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),ko(e)!=="svelte-5e0pue"&&(e.innerHTML=t),this.h()},h(){A(e,"class","p-3 rounded-full bg-gray-50 dark:bg-gray-900"),A(e,"type","button")},m(i,s){$(i,e,s)},p:Ct,d(i){i&&E(e)}}}function vae(n){let e=n[11].t("Listening...")+"",t;return{c(){t=vt(e)},l(i){t=kt(i,e)},m(i,s){$(i,t,s)},p(i,s){s[0]&2048&&e!==(e=i[11].t("Listening...")+"")&&Et(t,e)},d(i){i&&E(t)}}}function kae(n){let e=n[11].t("Tap to interrupt")+"",t;return{c(){t=vt(e)},l(i){t=kt(i,e)},m(i,s){$(i,t,s)},p(i,s){s[0]&2048&&e!==(e=i[11].t("Tap to interrupt")+"")&&Et(t,e)},d(i){i&&E(t)}}}function Cae(n){let e=n[11].t("Thinking...")+"",t;return{c(){t=vt(e)},l(i){t=kt(i,e)},m(i,s){$(i,t,s)},p(i,s){s[0]&2048&&e!==(e=i[11].t("Thinking...")+"")&&Et(t,e)},d(i){i&&E(t)}}}function Aae(n){let e,t,i=n[10]&&rI(n);return{c(){i&&i.c(),e=zt()},l(s){i&&i.l(s),e=zt()},m(s,r){i&&i.m(s,r),$(s,e,r),t=!0},p(s,r){s[10]?i?(i.p(s,r),r[0]&1024&&U(i,1)):(i=rI(s),i.c(),U(i,1),i.m(e.parentNode,e)):i&&(bt(),W(i,1,1,()=>{i=null}),xt())},i(s){t||(U(i),t=!0)},o(s){W(i),t=!1},d(s){s&&E(e),i&&i.d(s)}}}function Sae(n,e,t){let i,s,r,a,o,l;Pe(n,Xg,Me=>t(45,i=Me)),Pe(n,Kg,Me=>t(46,s=Me)),Pe(n,Ga,Me=>t(47,r=Me)),Pe(n,Qw,Me=>t(48,a=Me)),Pe(n,Ba,Me=>t(10,o=Me));const c=Xa(),h=as("i18n");Pe(n,h,Me=>t(11,l=Me));let{eventTarget:u}=e,{submitPrompt:d}=e,{stopResponse:f}=e,{files:g}=e,{chatId:m}=e,{modelId:x}=e,p=null,y=null,w=!1,_=!1,v=!1,C=null,k=!1,I=null,S=!1,M=0,N=!1,F,H=null,T=[],z=[],R=null;const L=async()=>{const Me=await navigator.mediaDevices.enumerateDevices();t(8,z=Me.filter(Lt=>Lt.kind==="videoinput")),navigator.mediaDevices.getDisplayMedia&&t(8,z=[...z,{deviceId:"screen",label:"Screen Share"}]),R===null&&z.length>0&&t(9,R=z[0].deviceId)},Y=async()=>{if(await L(),I===null){t(4,k=!0),await hn();try{await j()}catch(Me){console.error("Error accessing webcam: ",Me)}}},j=async()=>{const Me=document.getElementById("camera-feed");Me&&(R==="screen"?t(5,I=await navigator.mediaDevices.getDisplayMedia({video:{cursor:"always"},audio:!1})):t(5,I=await navigator.mediaDevices.getUserMedia({video:{deviceId:R?{exact:R}:void 0}})),I&&(await L(),Me.srcObject=I,await Me.play()))},J=async()=>{I&&I.getTracks().forEach(Lt=>Lt.stop()),t(5,I=null)},G=()=>{const Me=document.getElementById("camera-feed"),Lt=document.getElementById("camera-canvas");if(!Lt)return;const dt=Lt.getContext("2d");Lt.width=Me.videoWidth,Lt.height=Me.videoHeight,dt.drawImage(Me,0,0,Me.videoWidth,Me.videoHeight);const Vt=Lt.toDataURL("image/png");return Vt},se=async()=>{await J(),t(4,k=!1)},de=-55,he=async Me=>{var Vt,Ln;await hn();const Lt=BD(Me,"recording.wav"),dt=await zF(localStorage.token,Lt,(Ln=(Vt=r==null?void 0:r.audio)==null?void 0:Vt.stt)==null?void 0:Ln.language).catch(Wn=>(Jt.error(`${Wn}`),null));if(dt&&(dt.text,dt.text!=="")){const Wn=await d(dt.text,{_raw:!0})}},we=async(Me=!0)=>{if(o){const Lt=T.slice(0);if(T=[],F=!1,Me&&ye(),_){if(t(1,w=!0),t(3,C=null),I){const Vt=G();t(20,g=[{type:"image",url:Vt}])}const dt=new Blob(Lt,{type:"audio/wav"});await he(dt),_=!1,t(1,w=!1)}}else T=[],F=!1,H&&H.getTracks().forEach(dt=>dt.stop()),t(7,H=null)},ye=async()=>{o&&(H||t(7,H=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}})),F=new MediaRecorder(H),F.onstart=()=>{T=[]},F.ondataavailable=Me=>{N&&T.push(Me.data)},F.onstop=Me=>{we()},re(H))},P=async()=>{try{F&&F.stop()}catch(Me){}H&&(H.getAudioTracks().forEach(function(Me){Me.stop()}),t(7,H=null))},V=Me=>{let Lt=0;for(let dt=0;dt<Me.length;dt++){const Vt=(Me[dt]-128)/128;Lt+=Vt*Vt}return Math.sqrt(Lt/Me.length)},re=Me=>{const Lt=new AudioContext,dt=Lt.createMediaStreamSource(Me),Vt=Lt.createAnalyser();Vt.minDecibels=de,dt.connect(Vt);const Ln=Vt.frequencyBinCount,Wn=new Uint8Array(Ln),hi=new Uint8Array(Vt.fftSize);let Gi=Date.now();N=!1,(()=>{const ui=()=>{if(!F||!o)return;if(v&&!((r==null?void 0:r.voiceInterruption)??!1)?(Vt.maxDecibels=0,Vt.minDecibels=-1):(Vt.minDecibels=de,Vt.maxDecibels=-30),Vt.getByteTimeDomainData(hi),Vt.getByteFrequencyData(Wn),t(6,M=V(hi)),Wn.some(_s=>_s>0)&&(F&&F.state!=="recording"&&F.start(),N||(N=!0,Ke()),Gi=Date.now()),N&&Date.now()-Gi>2e3&&(_=!0,F)){F.stop();return}window.requestAnimationFrame(ui)};window.requestAnimationFrame(ui)})()};let X={},ue=null,oe=null;const Q=Me=>o?new Promise(Lt=>{let dt=[];const Vt=setInterval(async()=>{var Ln,Wn,hi;if(dt=await speechSynthesis.getVoices(),dt.length>0){clearInterval(Vt);const Gi=((Ln=dt==null?void 0:dt.filter(ws=>{var ui,Wi,_s,Ci;return ws.voiceURI===(((Wi=(ui=r==null?void 0:r.audio)==null?void 0:ui.tts)==null?void 0:Wi.voice)??((Ci=(_s=s==null?void 0:s.audio)==null?void 0:_s.tts)==null?void 0:Ci.voice))}))==null?void 0:Ln.at(0))??void 0;oe=new SpeechSynthesisUtterance(Me),oe.rate=((hi=(Wn=r.audio)==null?void 0:Wn.tts)==null?void 0:hi.playbackRate)??1,Gi&&(oe.voice=Gi),speechSynthesis.speak(oe),oe.onend=async ws=>{await new Promise(ui=>setTimeout(ui,200)),Lt(ws)}}},100)}):Promise.resolve(),ae=Me=>o?new Promise(Lt=>{var Vt,Ln;const dt=document.getElementById("audioElement");dt&&(dt.src=Me.src,dt.muted=!0,dt.playbackRate=((Ln=(Vt=r.audio)==null?void 0:Vt.tts)==null?void 0:Ln.playbackRate)??1,dt.play().then(()=>{dt.muted=!1}).catch(Wn=>{console.error(Wn)}),dt.onended=async Wn=>{await new Promise(hi=>setTimeout(hi,100)),Lt(Wn)})}):Promise.resolve(),Ke=async()=>{t(2,v=!1),S&&f(),oe&&(speechSynthesis.cancel(),oe=null);const Me=document.getElementById("audioElement");Me&&(Me.muted=!0,Me.pause(),Me.currentTime=0)};let Ue=new AbortController;const De=new Map,je=new Map,ze=async Me=>{var Lt,dt,Vt,Ln,Wn,hi,Gi,ws,ui,Wi,_s,Ci,Rr,Xs;if(!De.has(Me))try{if((r==null?void 0:r.showEmojiInCall)??!1){const Es=await $D(localStorage.token,x,Me,m);Es&&je.set(Me,Es)}if(((dt=(Lt=r.audio)==null?void 0:Lt.tts)==null?void 0:dt.engine)==="browser-kokoro"){const Es=await a.generate({text:Me,voice:((Ln=(Vt=r==null?void 0:r.audio)==null?void 0:Vt.tts)==null?void 0:Ln.voice)??((hi=(Wn=s==null?void 0:s.audio)==null?void 0:Wn.tts)==null?void 0:hi.voice)}).catch(Ne=>{console.error(Ne),Jt.error(`${Ne}`)});Es&&De.set(Me,new Audio(Es))}else if(s.audio.tts.engine!==""){const Es=await HF(localStorage.token,((ws=(Gi=r==null?void 0:r.audio)==null?void 0:Gi.tts)==null?void 0:ws.defaultVoice)===s.audio.tts.voice?((Wi=(ui=r==null?void 0:r.audio)==null?void 0:ui.tts)==null?void 0:Wi.voice)??((Ci=(_s=s==null?void 0:s.audio)==null?void 0:_s.tts)==null?void 0:Ci.voice):(Xs=(Rr=s==null?void 0:s.audio)==null?void 0:Rr.tts)==null?void 0:Xs.voice,Me).catch(Ne=>(console.error(Ne),null));if(Es){const Ne=await Es.blob(),Ve=URL.createObjectURL(Ne);De.set(Me,new Audio(Ve))}}else De.set(Me,!0)}catch(Es){console.error("Error synthesizing speech:",Es)}return De.get(Me)};let Qe={};const ft=async(Me,Lt)=>{for(;!Lt.aborted;)if(Qe[Me]&&Qe[Me].length>0){const dt=Qe[Me].shift();if(De.has(dt))if(((r==null?void 0:r.showEmojiInCall)??!1)&&je.has(dt)?t(3,C=je.get(dt)):t(3,C=null),s.audio.tts.engine!=="")try{`${dt}`;const Vt=De.get(dt);await ae(Vt),`${dt}`,await new Promise(Ln=>setTimeout(Ln,200))}catch(Vt){console.error("Error playing audio:",Vt)}else await Q(dt);else Qe[Me].unshift(dt),`${dt}`,await new Promise(Vt=>setTimeout(Vt,200))}else if(X[Me]&&Qe[Me]&&Qe[Me].length===0){t(2,v=!1);break}else await new Promise(dt=>setTimeout(dt,200));`${Me}`},ut=async Me=>{const{id:Lt}=Me.detail;S=!0,ue!==Lt&&(`${Lt}`,ue=Lt,Ue&&Ue.abort(),Ue=new AbortController,t(2,v=!0),ft(Lt,Ue.signal))},Je=async Me=>{const{id:Lt,content:dt}=Me.detail;if(ue===Lt){`${Lt}${dt}`;try{Qe[Lt]===void 0?Qe[Lt]=[dt]:Qe[Lt].push(dt),ze(dt)}catch(Vt){console.error("Failed to fetch or play audio:",Vt)}}},rt=async Me=>{const{id:Lt,content:dt}=Me.detail;X[Lt]=!0,S=!1};ol(async()=>{const Me=async()=>{try{p=await navigator.wakeLock.request("screen")}catch(Lt){}p&&p.addEventListener("release",()=>{})};return"wakeLock"in navigator&&(await Me(),document.addEventListener("visibilitychange",async()=>{p!==null&&document.visibilityState==="visible"&&await Me()})),t(0,y=i.find(Lt=>Lt.id===x)),ye(),u.addEventListener("chat:start",ut),u.addEventListener("chat",Je),u.addEventListener("chat:finish",rt),async()=>{await Ke(),P(),u.removeEventListener("chat:start",ut),u.removeEventListener("chat",Je),u.removeEventListener("chat:finish",rt),Ue.abort(),await hn(),await Ke(),await we(!1),await se()}}),Kh(async()=>{await Ke(),await we(!1),await se(),await P(),u.removeEventListener("chat:start",ut),u.removeEventListener("chat",Je),u.removeEventListener("chat:finish",rt),Ue.abort(),await hn(),await Ke()});const ge=()=>{v&&Ke()},Pt=()=>{v&&Ke()},lt=()=>{se()},ct=async Me=>{Me.detail,t(9,R=Me.detail),await J(),await j()},Ge=async()=>{await navigator.mediaDevices.getUserMedia({video:!0}),Y()},Ft=()=>{v&&Ke()},sn=async()=>{await P(),await J(),Ba.set(!1),c("close")};return n.$$set=Me=>{"eventTarget"in Me&&t(21,u=Me.eventTarget),"submitPrompt"in Me&&t(22,d=Me.submitPrompt),"stopResponse"in Me&&t(23,f=Me.stopResponse),"files"in Me&&t(20,g=Me.files),"chatId"in Me&&t(24,m=Me.chatId),"modelId"in Me&&t(25,x=Me.modelId)},[y,w,v,C,k,I,M,H,z,R,o,l,c,h,Y,j,J,se,P,Ke,g,u,d,f,m,x,ge,Pt,lt,ct,Ge,Ft,sn]}class $O extends Nt{constructor(e){super(),Ot(this,e,Sae,Aae,Ut,{eventTarget:21,submitPrompt:22,stopResponse:23,files:20,chatId:24,modelId:25},null,[-1,-1,-1])}}function Iae(n){var _,v,C,k,I,S,M,N,F,H;let e,t,i,s,r,a,o=(((v=(_=n[0])==null?void 0:_.model)==null?void 0:v.name)??((k=(C=n[0])==null?void 0:C.message)==null?void 0:k.model)??"Assistant")+"",l,c,h,u,d,f,g,m,x;t=new zI({props:{src:((N=(M=(S=(I=n[0])==null?void 0:I.model)==null?void 0:S.info)==null?void 0:M.meta)==null?void 0:N.profile_image_url)??"",className:"size-5 -translate-y-[1px]"}}),u=new UF({props:{className:"size-3 "+((H=(F=n[0])==null?void 0:F.message)!=null&&H.favorite?"fill-red-500 stroke-red-500":"hover:fill-red-500 hover:stroke-red-500")+" ",strokeWidth:"2.5"}});function p(T,z){var R,L;return(L=(R=T[0])==null?void 0:R.message)!=null&&L.error?Rae:Tae}let y=p(n),w=y(n);return{c(){e=ee("div"),me(t.$$.fragment),i=Ce(),s=ee("div"),r=ee("div"),a=ee("div"),l=vt(o),c=Ce(),h=ee("button"),me(u.$$.fragment),f=Ce(),w.c(),this.h()},l(T){e=te(T,"DIV",{class:!0});var z=q(e);xe(t.$$.fragment,z),i=Ae(z),s=te(z,"DIV",{class:!0});var R=q(s);r=te(R,"DIV",{class:!0});var L=q(r);a=te(L,"DIV",{class:!0});var Y=q(a);l=kt(Y,o),Y.forEach(E),c=Ae(L),h=te(L,"BUTTON",{class:!0});var j=q(h);xe(u.$$.fragment,j),j.forEach(E),L.forEach(E),f=Ae(R),w.l(R),R.forEach(E),z.forEach(E),this.h()},h(){var T,z;A(a,"class","text-xs text-black dark:text-white font-medium line-clamp-1"),A(h,"class",d=(z=(T=n[0])==null?void 0:T.message)!=null&&z.favorite?"":"invisible group-hover:visible"),A(r,"class","flex justify-between items-center"),A(s,"class","ml-2"),A(e,"class","flex w-full")},m(T,z){$(T,e,z),pe(t,e,null),K(e,i),K(e,s),K(s,r),K(r,a),K(a,l),K(r,c),K(r,h),pe(u,h,null),K(s,f),w.m(s,null),g=!0,m||(x=yt(h,"click",n[1]),m=!0)},p(T,z){var Y,j,J,G,se,de,he,we,ye,P,V,re;const R={};z&1&&(R.src=((G=(J=(j=(Y=T[0])==null?void 0:Y.model)==null?void 0:j.info)==null?void 0:J.meta)==null?void 0:G.profile_image_url)??""),t.$set(R),(!g||z&1)&&o!==(o=(((de=(se=T[0])==null?void 0:se.model)==null?void 0:de.name)??((we=(he=T[0])==null?void 0:he.message)==null?void 0:we.model)??"Assistant")+"")&&Et(l,o);const L={};z&1&&(L.className="size-3 "+((P=(ye=T[0])==null?void 0:ye.message)!=null&&P.favorite?"fill-red-500 stroke-red-500":"hover:fill-red-500 hover:stroke-red-500")+" "),u.$set(L),(!g||z&1&&d!==(d=(re=(V=T[0])==null?void 0:V.message)!=null&&re.favorite?"":"invisible group-hover:visible"))&&A(h,"class",d),y===(y=p(T))&&w?w.p(T,z):(w.d(1),w=y(T),w&&(w.c(),w.m(s,null)))},i(T){g||(U(t.$$.fragment,T),U(u.$$.fragment,T),g=!0)},o(T){W(t.$$.fragment,T),W(u.$$.fragment,T),g=!1},d(T){T&&E(e),be(t),be(u),w.d(),m=!1,x()}}}function Eae(n){var g,m,x;let e,t,i,s,r,a,o=(((m=(g=n[0])==null?void 0:g.user)==null?void 0:m.name)??"User")+"",l,c,h;t=new zI({props:{src:((x=n[0].user)==null?void 0:x.profile_image_url)??`${Yo}/user.png`,className:"size-5 -translate-y-[1px]"}});function u(p,y){var w,_;return(_=(w=p[0])==null?void 0:w.message)!=null&&_.error?Pae:Mae}let d=u(n),f=d(n);return{c(){e=ee("div"),me(t.$$.fragment),i=Ce(),s=ee("div"),r=ee("div"),a=ee("div"),l=vt(o),c=Ce(),f.c(),this.h()},l(p){e=te(p,"DIV",{class:!0});var y=q(e);xe(t.$$.fragment,y),i=Ae(y),s=te(y,"DIV",{class:!0});var w=q(s);r=te(w,"DIV",{class:!0});var _=q(r);a=te(_,"DIV",{class:!0});var v=q(a);l=kt(v,o),v.forEach(E),_.forEach(E),c=Ae(w),f.l(w),w.forEach(E),y.forEach(E),this.h()},h(){A(a,"class","text-xs text-black dark:text-white font-medium line-clamp-1"),A(r,"class","flex justify-between items-center"),A(s,"class","ml-2"),A(e,"class","flex w-full")},m(p,y){$(p,e,y),pe(t,e,null),K(e,i),K(e,s),K(s,r),K(r,a),K(a,l),K(s,c),f.m(s,null),h=!0},p(p,y){var _,v,C;const w={};y&1&&(w.src=((_=p[0].user)==null?void 0:_.profile_image_url)??`${Yo}/user.png`),t.$set(w),(!h||y&1)&&o!==(o=(((C=(v=p[0])==null?void 0:v.user)==null?void 0:C.name)??"User")+"")&&Et(l,o),d===(d=u(p))&&f?f.p(p,y):(f.d(1),f=d(p),f&&(f.c(),f.m(s,null)))},i(p){h||(U(t.$$.fragment,p),h=!0)},o(p){W(t.$$.fragment,p),h=!1},d(p){p&&E(e),be(t),f.d()}}}function Tae(n){let e,t=n[0].message.content+"",i;return{c(){e=ee("div"),i=vt(t),this.h()},l(s){e=te(s,"DIV",{class:!0});var r=q(e);i=kt(r,t),r.forEach(E),this.h()},h(){A(e,"class","text-gray-500 line-clamp-2 text-xs mt-0.5")},m(s,r){$(s,e,r),K(e,i)},p(s,r){r&1&&t!==(t=s[0].message.content+"")&&Et(i,t)},d(s){s&&E(e)}}}function Rae(n){let e,t=n[0].message.error.content+"",i;return{c(){e=ee("div"),i=vt(t),this.h()},l(s){e=te(s,"DIV",{class:!0});var r=q(e);i=kt(r,t),r.forEach(E),this.h()},h(){A(e,"class","text-red-500 line-clamp-2 text-xs mt-0.5")},m(s,r){$(s,e,r),K(e,i)},p(s,r){r&1&&t!==(t=s[0].message.error.content+"")&&Et(i,t)},d(s){s&&E(e)}}}function Mae(n){let e,t=n[0].message.content+"",i;return{c(){e=ee("div"),i=vt(t),this.h()},l(s){e=te(s,"DIV",{class:!0});var r=q(e);i=kt(r,t),r.forEach(E),this.h()},h(){A(e,"class","text-gray-500 line-clamp-2 text-xs mt-0.5")},m(s,r){$(s,e,r),K(e,i)},p(s,r){r&1&&t!==(t=s[0].message.content+"")&&Et(i,t)},d(s){s&&E(e)}}}function Pae(n){let e,t=n[0].message.error.content+"",i;return{c(){e=ee("div"),i=vt(t),this.h()},l(s){e=te(s,"DIV",{class:!0});var r=q(e);i=kt(r,t),r.forEach(E),this.h()},h(){A(e,"class","text-red-500 line-clamp-2 text-xs mt-0.5")},m(s,r){$(s,e,r),K(e,i)},p(s,r){r&1&&t!==(t=s[0].message.error.content+"")&&Et(i,t)},d(s){s&&E(e)}}}function Nae(n){let e,t,i,s;const r=[Eae,Iae],a=[];function o(l,c){return l[0].message.role==="user"?0:1}return e=o(n),t=a[e]=r[e](n),{c(){t.c(),i=zt()},l(l){t.l(l),i=zt()},m(l,c){a[e].m(l,c),$(l,i,c),s=!0},p(l,c){let h=e;e=o(l),e===h?a[e].p(l,c):(bt(),W(a[h],1,1,()=>{a[h]=null}),xt(),t=a[e],t?t.p(l,c):(t=a[e]=r[e](l),t.c()),U(t,1),t.m(i.parentNode,i))},i(l){s||(U(t),s=!0)},o(l){W(t),s=!1},d(l){l&&E(i),a[e].d(l)}}}function Oae(n){var l,c;let e,t,i,s,r,a,o;return t=new wi({props:{content:(c=(l=n[0])==null?void 0:l.message)!=null&&c.error?n[0].message.error.content:n[0].message.content,class:"w-full",allowHTML:!1,$$slots:{default:[Nae]},$$scope:{ctx:n}}}),s=new Gg({props:{type:"target",position:pn.Top,class:"w-2 rounded-full dark:bg-gray-900"}}),a=new Gg({props:{type:"source",position:pn.Bottom,class:"w-2 rounded-full dark:bg-gray-900"}}),{c(){e=ee("div"),me(t.$$.fragment),i=Ce(),me(s.$$.fragment),r=Ce(),me(a.$$.fragment),this.h()},l(h){e=te(h,"DIV",{class:!0});var u=q(e);xe(t.$$.fragment,u),i=Ae(u),xe(s.$$.fragment,u),r=Ae(u),xe(a.$$.fragment,u),u.forEach(E),this.h()},h(){A(e,"class","px-4 py-3 shadow-md rounded-xl dark:bg-black bg-white border dark:border-gray-900 w-60 h-20 group")},m(h,u){$(h,e,u),pe(t,e,null),K(e,i),pe(s,e,null),K(e,r),pe(a,e,null),o=!0},p(h,[u]){var f,g;const d={};u&1&&(d.content=(g=(f=h[0])==null?void 0:f.message)!=null&&g.error?h[0].message.error.content:h[0].message.content),u&5&&(d.$$scope={dirty:u,ctx:h}),t.$set(d)},i(h){o||(U(t.$$.fragment,h),U(s.$$.fragment,h),U(a.$$.fragment,h),o=!0)},o(h){W(t.$$.fragment,h),W(s.$$.fragment,h),W(a.$$.fragment,h),o=!1},d(h){h&&E(e),be(t),be(s),be(a)}}}function Dae(n,e,t){let{data:i}=e;const s=()=>{var r;t(0,i.message.favorite=!(((r=i==null?void 0:i.message)==null?void 0:r.favorite)??!1),i)};return n.$$set=r=>{"data"in r&&t(0,i=r.data)},[i,s]}let Fae=class extends Nt{constructor(e){super(),Ot(this,e,Dae,Oae,Ut,{data:0})}};function Lae(n){let e,t,i,s;return e=new Ire({props:{showLock:!1}}),i=new Ure({props:{variant:f0.Dots}}),{c(){me(e.$$.fragment),t=Ce(),me(i.$$.fragment)},l(r){xe(e.$$.fragment,r),t=Ae(r),xe(i.$$.fragment,r)},m(r,a){pe(e,r,a),$(r,t,a),pe(i,r,a),s=!0},p:Ct,i(r){s||(U(e.$$.fragment,r),U(i.$$.fragment,r),s=!0)},o(r){W(e.$$.fragment,r),W(i.$$.fragment,r),s=!1},d(r){r&&E(t),be(e,r),be(i,r)}}}function Bae(n){let e,t;return e=new $se({props:{nodes:n[0],nodeTypes:n[1],edges:n[2],fitView:!0,minZoom:.001,colorMode:n[3].includes("dark")||n[3]==="system"&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",nodesConnectable:!1,nodesDraggable:!1,oninit:n[5],$$slots:{default:[Lae]},$$scope:{ctx:n}}}),e.$on("nodeclick",n[6]),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p(i,[s]){const r={};s&1&&(r.nodes=i[0]),s&2&&(r.nodeTypes=i[1]),s&4&&(r.edges=i[2]),s&8&&(r.colorMode=i[3].includes("dark")||i[3]==="system"&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),s&128&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function Uae(n,e,t){let i;Pe(n,AD,h=>t(3,i=h));const s=Xa();let{nodes:r}=e,{nodeTypes:a}=e,{edges:o}=e;const l=()=>{},c=h=>s("nodeclick",h.detail);return n.$$set=h=>{"nodes"in h&&t(0,r=h.nodes),"nodeTypes"in h&&t(1,a=h.nodeTypes),"edges"in h&&t(2,o=h.edges)},[r,a,o,i,s,l,c]}class Hae extends Nt{constructor(e){super(),Ot(this,e,Uae,Bae,Ut,{nodes:0,nodeTypes:1,edges:2})}}function zae(n){let e,t;return{c(){e=at("svg"),t=at("path"),this.h()},l(i){e=ot(i,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=q(e);t=ot(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),q(t).forEach(E),s.forEach(E),this.h()},h(){A(t,"stroke-linecap","round"),A(t,"stroke-linejoin","round"),A(t,"d","M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"fill","none"),A(e,"viewBox","0 0 24 24"),A(e,"stroke-width",n[1]),A(e,"stroke","currentColor"),A(e,"class",n[0])},m(i,s){$(i,e,s),K(e,t)},p(i,[s]){s&2&&A(e,"stroke-width",i[1]),s&1&&A(e,"class",i[0])},i:Ct,o:Ct,d(i){i&&E(e)}}}function jae(n,e,t){let{className:i="size-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,i=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[i,s]}class eD extends Nt{constructor(e){super(),Ot(this,e,jae,zae,Ut,{className:0,strokeWidth:1})}}function oI(n){let e,t;return e=new Hae({props:{nodes:n[6],nodeTypes:n[8],edges:n[7]}}),e.$on("nodeclick",n[12]),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p:Ct,i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function Gae(n){let e,t,i,s,r,a,o,l=n[1].t("Chat Overview")+"",c,h,u,d,f,g,m,x;r=new eD({props:{className:"size-3.5"}}),d=new sx({props:{className:"size-3.5"}});let p=n[2].length>0&&oI(n);return{c(){e=ee("div"),t=ee("div"),i=ee("div"),s=ee("button"),me(r.$$.fragment),a=Ce(),o=ee("div"),c=vt(l),h=Ce(),u=ee("button"),me(d.$$.fragment),f=Ce(),p&&p.c(),this.h()},l(y){e=te(y,"DIV",{class:!0});var w=q(e);t=te(w,"DIV",{class:!0});var _=q(t);i=te(_,"DIV",{class:!0});var v=q(i);s=te(v,"BUTTON",{class:!0});var C=q(s);xe(r.$$.fragment,C),C.forEach(E),a=Ae(v),o=te(v,"DIV",{class:!0});var k=q(o);c=kt(k,l),k.forEach(E),v.forEach(E),h=Ae(_),u=te(_,"BUTTON",{class:!0});var I=q(u);xe(d.$$.fragment,I),I.forEach(E),_.forEach(E),f=Ae(w),p&&p.l(w),w.forEach(E),this.h()},h(){A(s,"class","self-center p-0.5"),A(o,"class","text-lg font-medium self-center font-primary"),A(i,"class","flex items-center gap-2.5"),A(u,"class","self-center p-0.5"),A(t,"class","absolute z-50 w-full flex justify-between dark:text-gray-100 px-4 py-3.5"),A(e,"class","w-full h-full relative")},m(y,w){$(y,e,w),K(e,t),K(t,i),K(i,s),pe(r,s,null),K(i,a),K(i,o),K(o,c),K(t,h),K(t,u),pe(d,u,null),K(e,f),p&&p.m(e,null),g=!0,m||(x=[yt(s,"click",n[10]),yt(u,"click",n[11])],m=!0)},p(y,[w]){(!g||w&2)&&l!==(l=y[1].t("Chat Overview")+"")&&Et(c,l),y[2].length>0?p?(p.p(y,w),w&4&&U(p,1)):(p=oI(y),p.c(),U(p,1),p.m(e,null)):p&&(bt(),W(p,1,1,()=>{p=null}),xt())},i(y){g||(U(r.$$.fragment,y),U(d.$$.fragment,y),U(p),g=!0)},o(y){W(r.$$.fragment,y),W(d.$$.fragment,y),W(p),g=!1},d(y){y&&E(e),be(r),be(d),p&&p.d(),m=!1,Qr(x)}}}function Vae(n,e,t){let i,s,r,a;Pe(n,Xg,S=>t(13,i=S)),Pe(n,k0,S=>t(14,s=S));const o=Xa(),l=as("i18n");Pe(n,l,S=>t(1,r=S));const{width:c,height:h}=ts(),{fitView:u,getViewport:d}=Hre(),f=zre();let{history:g}=e,m=null;const x=en([]);Pe(n,x,S=>t(2,a=S));const p=en([]),y={custom:Fae},w=async()=>{m===null?await u({nodes:[{id:g.currentId}]}):await u({nodes:[{id:m}]}),t(0,m=null)},_=async()=>{const S=[],M=[];let H=new Map,T={};Object.keys(g.messages).forEach(z=>{var Y;const R=g.messages[z],L=R.parentId?(((Y=H.get(R.parentId))==null?void 0:Y.level)??-1)+1:0;T[L]||(T[L]=0),H.set(z,{id:R.id,level:L,position:T[L]++})}),Object.keys(g.messages).forEach(z=>{const R=H.get(z),L=R.position*250,Y=R.level*150,j=L;S.push({id:R.id,type:"custom",data:{user:s,message:g.messages[z],model:i.find(G=>G.id===g.messages[z].model)},position:{x:j,y:Y}});const J=g.messages[z].parentId;J&&M.push({id:J+"-"+R.id,source:J,target:R.id,selectable:!1,class:" dark:fill-gray-300 fill-gray-300",type:"smoothstep",animated:g.currentId===z||v(z,g.currentId)})}),await p.set([...M]),await x.set([...S])},v=(S,M)=>{const N=g.messages[S];return N.childrenIds&&N.childrenIds.some(F=>F===M||v(F,M))};ol(()=>{_(),f.subscribe(async S=>{S&&(await hn(),await u({nodes:[{id:g.currentId}]}))}),c.subscribe(S=>{S&&u({nodes:[{id:g.currentId}]})}),h.subscribe(S=>{S&&u({nodes:[{id:g.currentId}]})})}),Kh(()=>{x.set([]),p.set([])});const C=()=>{r0.set(!1)},k=()=>{o("close"),r0.set(!1)},I=S=>{S.detail.node.data,o("nodeclick",S.detail),t(0,m=S.detail.node.data.message.id),u({nodes:[{id:m}]})};return n.$$set=S=>{"history"in S&&t(9,g=S.history)},n.$$.update=()=>{n.$$.dirty&512&&g&&_(),n.$$.dirty&512&&g&&g.currentId&&w()},[m,r,a,o,l,u,x,p,y,g,C,k,I]}class tD extends Nt{constructor(e){super(),Ot(this,e,Vae,Gae,Ut,{history:9})}}function qae(n){let e,t;return{c(){e=at("svg"),t=at("path"),this.h()},l(i){e=ot(i,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=q(e);t=ot(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),q(t).forEach(E),s.forEach(E),this.h()},h(){A(t,"stroke-linecap","round"),A(t,"stroke-linejoin","round"),A(t,"d","M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75h-4.5m4.5 0v4.5m0-4.5L15 9m5.25 11.25h-4.5m4.5 0v-4.5m0 4.5L15 15"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"fill","none"),A(e,"viewBox","0 0 24 24"),A(e,"stroke-width",n[1]),A(e,"stroke","currentColor"),A(e,"class",n[0])},m(i,s){$(i,e,s),K(e,t)},p(i,[s]){s&2&&A(e,"stroke-width",i[1]),s&1&&A(e,"class",i[0])},i:Ct,o:Ct,d(i){i&&E(e)}}}function Wae(n,e,t){let{className:i="size-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,i=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[i,s]}class Kae extends Nt{constructor(e){super(),Ot(this,e,Wae,qae,Ut,{className:0,strokeWidth:1})}}function lI(n){let e,t,i,s,r,a,o,l,c,h,u,d,f,g=n[5].t("Version {{selectedVersion}} of {{totalVersions}}",{selectedVersion:n[2]+1,totalVersions:n[1].length})+"",m,x,p,y,w,_,v,C,k,I=(n[3]?n[5].t("Copied"):n[5].t("Copy"))+"",S,M,N,F,H,T,z,R,L,Y;i=new eD({props:{className:"size-3.5  text-gray-900 dark:text-white"}}),N=new wi({props:{content:n[5].t("Download"),$$slots:{default:[Xae]},$$scope:{ctx:n}}});let j=n[1][n[2]].type==="iframe"&&cI(n);return z=new sx({props:{className:"size-3.5 text-gray-900 dark:text-white"}}),{c(){e=ee("div"),t=ee("button"),me(i.$$.fragment),s=Ce(),r=ee("div"),a=ee("div"),o=ee("div"),l=ee("button"),c=at("svg"),h=at("path"),d=Ce(),f=ee("div"),m=vt(g),x=Ce(),p=ee("button"),y=at("svg"),w=at("path"),v=Ce(),C=ee("div"),k=ee("button"),S=vt(I),M=Ce(),me(N.$$.fragment),F=Ce(),j&&j.c(),H=Ce(),T=ee("button"),me(z.$$.fragment),this.h()},l(J){e=te(J,"DIV",{class:!0});var G=q(e);t=te(G,"BUTTON",{class:!0});var se=q(t);xe(i.$$.fragment,se),se.forEach(E),s=Ae(G),r=te(G,"DIV",{class:!0});var de=q(r);a=te(de,"DIV",{class:!0});var he=q(a);o=te(he,"DIV",{class:!0,dir:!0});var we=q(o);l=te(we,"BUTTON",{class:!0});var ye=q(l);c=ot(ye,"svg",{xmlns:!0,fill:!0,viewBox:!0,stroke:!0,"stroke-width":!0,class:!0});var P=q(c);h=ot(P,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),q(h).forEach(E),P.forEach(E),ye.forEach(E),d=Ae(we),f=te(we,"DIV",{class:!0});var V=q(f);m=kt(V,g),V.forEach(E),x=Ae(we),p=te(we,"BUTTON",{class:!0});var re=q(p);y=ot(re,"svg",{xmlns:!0,fill:!0,viewBox:!0,stroke:!0,"stroke-width":!0,class:!0});var X=q(y);w=ot(X,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),q(w).forEach(E),X.forEach(E),re.forEach(E),we.forEach(E),he.forEach(E),v=Ae(de),C=te(de,"DIV",{class:!0});var ue=q(C);k=te(ue,"BUTTON",{class:!0});var oe=q(k);S=kt(oe,I),oe.forEach(E),M=Ae(ue),xe(N.$$.fragment,ue),F=Ae(ue),j&&j.l(ue),ue.forEach(E),de.forEach(E),H=Ae(G),T=te(G,"BUTTON",{class:!0});var Q=q(T);xe(z.$$.fragment,Q),Q.forEach(E),G.forEach(E),this.h()},h(){A(t,"class","self-center pointer-events-auto p-1 rounded-full bg-white dark:bg-gray-850"),A(h,"stroke-linecap","round"),A(h,"stroke-linejoin","round"),A(h,"d","M15.75 19.5 8.25 12l7.5-7.5"),A(c,"xmlns","http://www.w3.org/2000/svg"),A(c,"fill","none"),A(c,"viewBox","0 0 24 24"),A(c,"stroke","currentColor"),A(c,"stroke-width","2.5"),A(c,"class","size-3.5"),A(l,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition disabled:cursor-not-allowed"),l.disabled=u=n[1].length<=1,A(f,"class","text-xs self-center dark:text-gray-100 min-w-fit"),A(w,"stroke-linecap","round"),A(w,"stroke-linejoin","round"),A(w,"d","m8.25 4.5 7.5 7.5-7.5 7.5"),A(y,"xmlns","http://www.w3.org/2000/svg"),A(y,"fill","none"),A(y,"viewBox","0 0 24 24"),A(y,"stroke","currentColor"),A(y,"stroke-width","2.5"),A(y,"class","size-3.5"),A(p,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition disabled:cursor-not-allowed"),p.disabled=_=n[1].length<=1,A(o,"class","flex items-center gap-0.5 self-center min-w-fit"),A(o,"dir","ltr"),A(a,"class","flex items-center space-x-2"),A(k,"class","copy-code-button bg-none border-none text-xs bg-gray-50 hover:bg-gray-100 dark:bg-gray-850 dark:hover:bg-gray-800 transition rounded-md px-1.5 py-0.5"),A(C,"class","flex items-center gap-1.5"),A(r,"class","flex-1 flex items-center justify-between pr-1"),A(T,"class","self-center pointer-events-auto p-1 rounded-full bg-white dark:bg-gray-850"),A(e,"class","pointer-events-auto z-20 flex justify-between items-center p-2.5 font-primar text-gray-900 dark:text-white")},m(J,G){$(J,e,G),K(e,t),pe(i,t,null),K(e,s),K(e,r),K(r,a),K(a,o),K(o,l),K(l,c),K(c,h),K(o,d),K(o,f),K(f,m),K(o,x),K(o,p),K(p,y),K(y,w),K(r,v),K(r,C),K(C,k),K(k,S),K(C,M),pe(N,C,null),K(C,F),j&&j.m(C,null),K(e,H),K(e,T),pe(z,T,null),R=!0,L||(Y=[yt(t,"click",n[14]),yt(l,"click",n[15]),yt(p,"click",n[16]),yt(k,"click",n[17]),yt(T,"click",n[18])],L=!0)},p(J,G){(!R||G&2&&u!==(u=J[1].length<=1))&&(l.disabled=u),(!R||G&38)&&g!==(g=J[5].t("Version {{selectedVersion}} of {{totalVersions}}",{selectedVersion:J[2]+1,totalVersions:J[1].length})+"")&&Et(m,g),(!R||G&2&&_!==(_=J[1].length<=1))&&(p.disabled=_),(!R||G&40)&&I!==(I=(J[3]?J[5].t("Copied"):J[5].t("Copy"))+"")&&Et(S,I);const se={};G&32&&(se.content=J[5].t("Download")),G&8388608&&(se.$$scope={dirty:G,ctx:J}),N.$set(se),J[1][J[2]].type==="iframe"?j?(j.p(J,G),G&6&&U(j,1)):(j=cI(J),j.c(),U(j,1),j.m(C,null)):j&&(bt(),W(j,1,1,()=>{j=null}),xt())},i(J){R||(U(i.$$.fragment,J),U(N.$$.fragment,J),U(j),U(z.$$.fragment,J),R=!0)},o(J){W(i.$$.fragment,J),W(N.$$.fragment,J),W(j),W(z.$$.fragment,J),R=!1},d(J){J&&E(e),be(i),be(N),j&&j.d(),be(z),L=!1,Qr(Y)}}}function Xae(n){let e,t,i,s,r;return t=new GF({props:{className:"size-3.5"}}),{c(){e=ee("button"),me(t.$$.fragment),this.h()},l(a){e=te(a,"BUTTON",{class:!0});var o=q(e);xe(t.$$.fragment,o),o.forEach(E),this.h()},h(){A(e,"class","bg-none border-none text-xs bg-gray-50 hover:bg-gray-100 dark:bg-gray-850 dark:hover:bg-gray-800 transition rounded-md p-0.5")},m(a,o){$(a,e,o),pe(t,e,null),i=!0,s||(r=yt(e,"click",n[12]),s=!0)},p:Ct,i(a){i||(U(t.$$.fragment,a),i=!0)},o(a){W(t.$$.fragment,a),i=!1},d(a){a&&E(e),be(t),s=!1,r()}}}function cI(n){let e,t;return e=new wi({props:{content:n[5].t("Open in full screen"),$$slots:{default:[Yae]},$$scope:{ctx:n}}}),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p(i,s){const r={};s&32&&(r.content=i[5].t("Open in full screen")),s&8388608&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function Yae(n){let e,t,i,s,r;return t=new Kae({props:{className:"size-3.5"}}),{c(){e=ee("button"),me(t.$$.fragment),this.h()},l(a){e=te(a,"BUTTON",{class:!0});var o=q(e);xe(t.$$.fragment,o),o.forEach(E),this.h()},h(){A(e,"class","bg-none border-none text-xs bg-gray-50 hover:bg-gray-100 dark:bg-gray-850 dark:hover:bg-gray-800 transition rounded-md p-0.5")},m(a,o){$(a,e,o),pe(t,e,null),i=!0,s||(r=yt(e,"click",n[11]),s=!0)},p:Ct,i(a){i||(U(t.$$.fragment,a),i=!0)},o(a){W(t.$$.fragment,a),i=!1},d(a){a&&E(e),be(t),s=!1,r()}}}function hI(n){let e;return{c(){e=ee("div"),this.h()},l(t){e=te(t,"DIV",{class:!0}),q(e).forEach(E),this.h()},h(){A(e,"class","absolute top-0 left-0 right-0 bottom-0 z-10")},m(t,i){$(t,e,i)},d(t){t&&E(e)}}}function Jae(n){let e,t=n[5].t("No HTML, CSS, or JavaScript content found.")+"",i;return{c(){e=ee("div"),i=vt(t),this.h()},l(s){e=te(s,"DIV",{class:!0});var r=q(e);i=kt(r,t),r.forEach(E),this.h()},h(){A(e,"class","m-auto font-medium text-xs text-gray-900 dark:text-white")},m(s,r){$(s,e,r),K(e,i)},p(s,r){r&32&&t!==(t=s[5].t("No HTML, CSS, or JavaScript content found.")+"")&&Et(i,t)},i:Ct,o:Ct,d(s){s&&E(e)}}}function Zae(n){let e,t,i,s;const r=[$ae,Qae],a=[];function o(l,c){return l[1][l[2]].type==="iframe"?0:l[1][l[2]].type==="svg"?1:-1}return~(t=o(n))&&(i=a[t]=r[t](n)),{c(){e=ee("div"),i&&i.c(),this.h()},l(l){e=te(l,"DIV",{class:!0});var c=q(e);i&&i.l(c),c.forEach(E),this.h()},h(){A(e,"class","max-w-full w-full h-full")},m(l,c){$(l,e,c),~t&&a[t].m(e,null),s=!0},p(l,c){let h=t;t=o(l),t===h?~t&&a[t].p(l,c):(i&&(bt(),W(a[h],1,1,()=>{a[h]=null}),xt()),~t?(i=a[t],i?i.p(l,c):(i=a[t]=r[t](l),i.c()),U(i,1),i.m(e,null)):i=null)},i(l){s||(U(i),s=!0)},o(l){W(i),s=!1},d(l){l&&E(e),~t&&a[t].d()}}}function Qae(n){let e,t;return e=new gD({props:{className:" w-full h-full max-h-full overflow-hidden",svg:n[1][n[2]].content}}),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p(i,s){const r={};s&6&&(r.svg=i[1][i[2]].content),e.$set(r)},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function $ae(n){let e,t,i,s,r;return{c(){e=ee("iframe"),this.h()},l(a){e=te(a,"IFRAME",{title:!0,srcdoc:!0,class:!0,sandbox:!0}),q(e).forEach(E),this.h()},h(){var a,o;A(e,"title","Content"),A(e,"srcdoc",t=n[1][n[2]].content),A(e,"class","w-full border-0 h-full rounded-none"),A(e,"sandbox",i="allow-scripts allow-downloads"+(((a=n[6])==null?void 0:a.iframeSandboxAllowForms)??!1?" allow-forms":"")+(((o=n[6])==null?void 0:o.iframeSandboxAllowSameOrigin)??!1?" allow-same-origin":""))},m(a,o){$(a,e,o),n[19](e),s||(r=yt(e,"load",n[10]),s=!0)},p(a,o){var l,c;o&6&&t!==(t=a[1][a[2]].content)&&A(e,"srcdoc",t),o&64&&i!==(i="allow-scripts allow-downloads"+(((l=a[6])==null?void 0:l.iframeSandboxAllowForms)??!1?" allow-forms":"")+(((c=a[6])==null?void 0:c.iframeSandboxAllowSameOrigin)??!1?" allow-same-origin":""))&&A(e,"sandbox",i)},i:Ct,o:Ct,d(a){a&&E(e),n[19](null),s=!1,r()}}}function eoe(n){let e,t,i,s,r,a,o,l,c,h=n[1].length>0&&lI(n),u=n[0]&&hI();const d=[Zae,Jae],f=[];function g(m,x){return m[1].length>0?0:1}return o=g(n),l=f[o]=d[o](n),{c(){e=ee("div"),t=ee("div"),h&&h.c(),i=Ce(),u&&u.c(),s=Ce(),r=ee("div"),a=ee("div"),l.c(),this.h()},l(m){e=te(m,"DIV",{class:!0});var x=q(e);t=te(x,"DIV",{class:!0});var p=q(t);h&&h.l(p),i=Ae(p),u&&u.l(p),s=Ae(p),r=te(p,"DIV",{class:!0});var y=q(r);a=te(y,"DIV",{class:!0});var w=q(a);l.l(w),w.forEach(E),y.forEach(E),p.forEach(E),x.forEach(E),this.h()},h(){A(a,"class","h-full flex flex-col"),A(r,"class","flex-1 w-full h-full"),A(t,"class","w-full h-full flex flex-col flex-1 relative"),A(e,"class","w-full h-full relative flex flex-col bg-gray-50 dark:bg-gray-850")},m(m,x){$(m,e,x),K(e,t),h&&h.m(t,null),K(t,i),u&&u.m(t,null),K(t,s),K(t,r),K(r,a),f[o].m(a,null),c=!0},p(m,[x]){m[1].length>0?h?(h.p(m,x),x&2&&U(h,1)):(h=lI(m),h.c(),U(h,1),h.m(t,i)):h&&(bt(),W(h,1,1,()=>{h=null}),xt()),m[0]?u||(u=hI(),u.c(),u.m(t,s)):u&&(u.d(1),u=null);let p=o;o=g(m),o===p?f[o].p(m,x):(bt(),W(f[p],1,1,()=>{f[p]=null}),xt(),l=f[o],l?l.p(m,x):(l=f[o]=d[o](m),l.c()),U(l,1),l.m(a,null))},i(m){c||(U(h),U(l),c=!0)},o(m){W(h),W(l),c=!1},d(m){m&&E(e),h&&h.d(),u&&u.d(),f[o].d()}}}function toe(n,e,t){let i,s,r;Pe(n,uu,M=>t(21,i=M)),Pe(n,Ga,M=>t(6,r=M));const a=as("i18n");Pe(n,a,M=>t(5,s=M));const o=Xa();let{overlay:l=!1}=e,{history:c}=e,h=[],u=[],d=0,f=!1,g;const m=()=>{t(1,u=[]),h.forEach(M=>{if((M==null?void 0:M.role)!=="user"&&(M!=null&&M.content)){const N=M.content.match(/```[\s\S]*?```/g);let F=[];N&&N.forEach(j=>{const J=j.split(`
`)[0].replace("```","").trim().toLowerCase(),G=j.replace(/```[\s\S]*?\n/,"").replace(/```$/,"");F.push({lang:J,code:G})});let H="",T="",z="";F.forEach(j=>{const{lang:J,code:G}=j;J==="html"?H+=G+`
`:J==="css"?T+=G+`
`:(J==="javascript"||J==="js")&&(z+=G+`
`)});const R=M.content.match(/<html>[\s\S]*?<\/html>/gi),L=M.content.match(/<style>[\s\S]*?<\/style>/gi),Y=M.content.match(/<script>[\s\S]*?<\/script>/gi);if(R&&R.forEach(j=>{const J=j.replace(/<\/?html>/gi,"");H+=J+`
`}),L&&L.forEach(j=>{const J=j.replace(/<\/?style>/gi,"");T+=J+`
`}),Y&&Y.forEach(j=>{const J=j.replace(/<\/?script>/gi,"");z+=J+`
`}),H||T||z){const j=`
                        <!DOCTYPE html>
                        <html lang="en">
                        <head>
                            <meta charset="UTF-8">
                            <meta name="viewport" content="width=device-width, initial-scale=1.0">
							<style>
								body {
									background-color: white; /* Ensure the iframe has a white background */
								}

								${T}
							</style>
                        </head>
                        <body>
                            ${H}

							<script>
                            	${z}
							<\/script>
                        </body>
                        </html>
                    `;t(1,u=[...u,{type:"iframe",content:j}])}else for(const j of F)(j.lang==="svg"||j.lang==="xml"&&j.code.includes("<svg"))&&t(1,u=[...u,{type:"svg",content:j.code}])}}),u.length===0&&(Xi.set(!1),Zl.set(!1)),t(2,d=u?u.length-1:0)};function x(M){t(2,d=M==="prev"?Math.max(d-1,0):Math.min(d+1,u.length-1))}const p=()=>{g.contentWindow.addEventListener("click",function(M){const N=M.target.closest("a");if(N&&N.href){M.preventDefault();const F=new URL(N.href,g.baseURI);F.origin===window.location.origin?g.contentWindow.history.pushState(null,"",F.pathname+F.search+F.hash):console.info("External navigation blocked:",F.href)}},!0),g.contentWindow.addEventListener("mouseenter",function(M){M.preventDefault(),g.contentWindow.addEventListener("dragstart",N=>{N.preventDefault()})})},y=()=>{g.requestFullscreen?g.requestFullscreen():g.webkitRequestFullscreen?g.webkitRequestFullscreen():g.msRequestFullscreen&&g.msRequestFullscreen()},w=()=>{const M=new Blob([u[d].content],{type:"text/html"}),N=URL.createObjectURL(M),F=document.createElement("a");F.href=N,F.download=`artifact-${i}-${d}.html`,document.body.appendChild(F),F.click(),document.body.removeChild(F),URL.revokeObjectURL(N)};ol(()=>{SD.subscribe(M=>{if(u){const N=u.findIndex(F=>F.content.includes(M));t(2,d=N!==-1?N:0)}})});const _=()=>{Zl.set(!1)},v=()=>x("prev"),C=()=>x("next"),k=()=>{t4(u[d].content),t(3,f=!0),setTimeout(()=>{t(3,f=!1)},2e3)},I=()=>{o("close"),Xi.set(!1),Zl.set(!1)};function S(M){It[M?"unshift":"push"](()=>{g=M,t(4,g)})}return n.$$set=M=>{"overlay"in M&&t(0,l=M.overlay),"history"in M&&t(13,c=M.history)},n.$$.update=()=>{n.$$.dirty&8192&&(c?(h=Da(c,c.currentId),m()):(h=[],m()))},[l,u,d,f,g,s,r,a,o,x,p,y,w,c,_,v,C,k,I,S]}class nD extends Nt{constructor(e){super(),Ot(this,e,toe,eoe,Ut,{overlay:0,history:13})}}function noe(n){let e,t,i,s,r=n[16]&&uI(n);function a(l){n[37](l)}let o={defaultSize:0,onResize:n[35],onCollapse:n[36],collapsible:!0,class:" z-10 ",$$slots:{default:[coe]},$$scope:{ctx:n}};return n[4]!==void 0&&(o.pane=n[4]),t=new PI({props:o}),It.push(()=>Wt(t,"pane",a)),{c(){r&&r.c(),e=Ce(),me(t.$$.fragment)},l(l){r&&r.l(l),e=Ae(l),xe(t.$$.fragment,l)},m(l,c){r&&r.m(l,c),$(l,e,c),pe(t,l,c),s=!0},p(l,c){l[16]?r?c[0]&65536&&U(r,1):(r=uI(l),r.c(),U(r,1),r.m(e.parentNode,e)):r&&(bt(),W(r,1,1,()=>{r=null}),xt());const h={};c[0]&81936&&(h.onResize=l[35]),c[0]&503791|c[1]&4096&&(h.$$scope={dirty:c,ctx:l}),!i&&c[0]&16&&(i=!0,h.pane=l[4],qt(()=>i=!1)),t.$set(h)},i(l){s||(U(r),U(t.$$.fragment,l),s=!0)},o(l){W(r),W(t.$$.fragment,l),s=!1},d(l){l&&E(e),r&&r.d(l),be(t,l)}}}function ioe(n){let e,t,i=n[16]&&fI(n);return{c(){i&&i.c(),e=zt()},l(s){i&&i.l(s),e=zt()},m(s,r){i&&i.m(s,r),$(s,e,r),t=!0},p(s,r){s[16]?i?(i.p(s,r),r[0]&65536&&U(i,1)):(i=fI(s),i.c(),U(i,1),i.m(e.parentNode,e)):i&&(bt(),W(i,1,1,()=>{i=null}),xt())},i(s){t||(U(i),t=!0)},o(s){W(i),t=!1},d(s){s&&E(e),i&&i.d(s)}}}function uI(n){let e,t;return e=new wD({props:{class:"relative flex w-2 items-center justify-center bg-background group",$$slots:{default:[soe]},$$scope:{ctx:n}}}),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function soe(n){let e,t,i;return t=new jF({props:{className:"size-4 invisible group-hover:visible"}}),{c(){e=ee("div"),me(t.$$.fragment),this.h()},l(s){e=te(s,"DIV",{class:!0});var r=q(e);xe(t.$$.fragment,r),r.forEach(E),this.h()},h(){A(e,"class","z-10 flex h-7 w-5 items-center justify-center rounded-xs")},m(s,r){$(s,e,r),pe(t,e,null),i=!0},p:Ct,i(s){i||(U(t.$$.fragment,s),i=!0)},o(s){W(t.$$.fragment,s),i=!1},d(s){s&&E(e),be(t)}}}function dI(n){let e,t,i,s,r,a;const o=[loe,ooe,aoe,roe],l=[];function c(h,u){return h[15]?0:h[18]?1:h[17]?2:3}return i=c(n),s=l[i]=o[i](n),{c(){e=ee("div"),t=ee("div"),s.c(),this.h()},l(h){e=te(h,"DIV",{class:!0});var u=q(e);t=te(u,"DIV",{class:!0});var d=q(t);s.l(d),d.forEach(E),u.forEach(E),this.h()},h(){A(t,"class",r="w-full "+((n[17]||n[18])&&!n[15]?" ":"px-4 py-4 bg-white dark:shadow-lg dark:bg-gray-850  border border-gray-100 dark:border-gray-850")+" z-40 pointer-events-auto overflow-y-auto scrollbar-hidden"),A(e,"class","flex max-h-full min-h-full")},m(h,u){$(h,e,u),K(e,t),l[i].m(t,null),a=!0},p(h,u){let d=i;i=c(h),i===d?l[i].p(h,u):(bt(),W(l[d],1,1,()=>{l[d]=null}),xt(),s=l[i],s?s.p(h,u):(s=l[i]=o[i](h),s.c()),U(s,1),s.m(t,null)),(!a||u[0]&425984&&r!==(r="w-full "+((h[17]||h[18])&&!h[15]?" ":"px-4 py-4 bg-white dark:shadow-lg dark:bg-gray-850  border border-gray-100 dark:border-gray-850")+" z-40 pointer-events-auto overflow-y-auto scrollbar-hidden"))&&A(t,"class",r)},i(h){a||(U(s),a=!0)},o(h){W(s),a=!1},d(h){h&&E(e),l[i].d()}}}function roe(n){let e,t,i,s;function r(l){n[32](l)}function a(l){n[33](l)}let o={models:n[5]};return n[1]!==void 0&&(o.chatFiles=n[1]),n[2]!==void 0&&(o.params=n[2]),e=new QO({props:o}),It.push(()=>Wt(e,"chatFiles",r)),It.push(()=>Wt(e,"params",a)),e.$on("close",n[34]),{c(){me(e.$$.fragment)},l(l){xe(e.$$.fragment,l)},m(l,c){pe(e,l,c),s=!0},p(l,c){const h={};c[0]&32&&(h.models=l[5]),!t&&c[0]&2&&(t=!0,h.chatFiles=l[1],qt(()=>t=!1)),!i&&c[0]&4&&(i=!0,h.params=l[2],qt(()=>i=!1)),e.$set(h)},i(l){s||(U(e.$$.fragment,l),s=!0)},o(l){W(e.$$.fragment,l),s=!1},d(l){be(e,l)}}}function aoe(n){let e,t;return e=new tD({props:{history:n[0]}}),e.$on("nodeclick",n[30]),e.$on("close",n[31]),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p(i,s){const r={};s[0]&1&&(r.history=i[0]),e.$set(r)},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function ooe(n){let e,t;return e=new nD({props:{history:n[0],overlay:n[13]}}),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p(i,s){const r={};s[0]&1&&(r.history=i[0]),s[0]&8192&&(r.overlay=i[13]),e.$set(r)},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function loe(n){let e,t,i,s;function r(o){n[28](o)}let a={submitPrompt:n[8],stopResponse:n[9],modelId:n[11],chatId:n[6],eventTarget:n[7]};return n[3]!==void 0&&(a.files=n[3]),t=new $O({props:a}),It.push(()=>Wt(t,"files",r)),t.$on("close",n[29]),{c(){e=ee("div"),me(t.$$.fragment),this.h()},l(o){e=te(o,"DIV",{class:!0});var l=q(e);xe(t.$$.fragment,l),l.forEach(E),this.h()},h(){A(e,"class","w-full h-full flex justify-center")},m(o,l){$(o,e,l),pe(t,e,null),s=!0},p(o,l){const c={};l[0]&256&&(c.submitPrompt=o[8]),l[0]&512&&(c.stopResponse=o[9]),l[0]&2048&&(c.modelId=o[11]),l[0]&64&&(c.chatId=o[6]),l[0]&128&&(c.eventTarget=o[7]),!i&&l[0]&8&&(i=!0,c.files=o[3],qt(()=>i=!1)),t.$set(c)},i(o){s||(U(t.$$.fragment,o),s=!0)},o(o){W(t.$$.fragment,o),s=!1},d(o){o&&E(e),be(t)}}}function coe(n){let e,t,i=n[16]&&dI(n);return{c(){i&&i.c(),e=zt()},l(s){i&&i.l(s),e=zt()},m(s,r){i&&i.m(s,r),$(s,e,r),t=!0},p(s,r){s[16]?i?(i.p(s,r),r[0]&65536&&U(i,1)):(i=dI(s),i.c(),U(i,1),i.m(e.parentNode,e)):i&&(bt(),W(i,1,1,()=>{i=null}),xt())},i(s){t||(U(i),t=!0)},o(s){W(i),t=!1},d(s){s&&E(e),i&&i.d(s)}}}function fI(n){let e,t;return e=new gF({props:{show:n[16],onClose:n[27],$$slots:{default:[goe]},$$scope:{ctx:n}}}),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p(i,s){const r={};s[0]&65536&&(r.show=i[16]),s[0]&430063|s[1]&4096&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function hoe(n){let e,t,i,s;function r(l){n[24](l)}function a(l){n[25](l)}let o={models:n[5]};return n[1]!==void 0&&(o.chatFiles=n[1]),n[2]!==void 0&&(o.params=n[2]),e=new QO({props:o}),It.push(()=>Wt(e,"chatFiles",r)),It.push(()=>Wt(e,"params",a)),e.$on("close",n[26]),{c(){me(e.$$.fragment)},l(l){xe(e.$$.fragment,l)},m(l,c){pe(e,l,c),s=!0},p(l,c){const h={};c[0]&32&&(h.models=l[5]),!t&&c[0]&2&&(t=!0,h.chatFiles=l[1],qt(()=>t=!1)),!i&&c[0]&4&&(i=!0,h.params=l[2],qt(()=>i=!1)),e.$set(h)},i(l){s||(U(e.$$.fragment,l),s=!0)},o(l){W(e.$$.fragment,l),s=!1},d(l){be(e,l)}}}function uoe(n){let e,t;return e=new tD({props:{history:n[0]}}),e.$on("nodeclick",n[22]),e.$on("close",n[23]),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p(i,s){const r={};s[0]&1&&(r.history=i[0]),e.$set(r)},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function doe(n){let e,t;return e=new nD({props:{history:n[0]}}),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p(i,s){const r={};s[0]&1&&(r.history=i[0]),e.$set(r)},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function foe(n){let e,t,i,s;function r(o){n[20](o)}let a={submitPrompt:n[8],stopResponse:n[9],modelId:n[11],chatId:n[6],eventTarget:n[7]};return n[3]!==void 0&&(a.files=n[3]),t=new $O({props:a}),It.push(()=>Wt(t,"files",r)),t.$on("close",n[21]),{c(){e=ee("div"),me(t.$$.fragment),this.h()},l(o){e=te(o,"DIV",{class:!0});var l=q(e);xe(t.$$.fragment,l),l.forEach(E),this.h()},h(){A(e,"class","h-full max-h-[100dvh] bg-white text-gray-700 dark:bg-black dark:text-gray-300 flex justify-center")},m(o,l){$(o,e,l),pe(t,e,null),s=!0},p(o,l){const c={};l[0]&256&&(c.submitPrompt=o[8]),l[0]&512&&(c.stopResponse=o[9]),l[0]&2048&&(c.modelId=o[11]),l[0]&64&&(c.chatId=o[6]),l[0]&128&&(c.eventTarget=o[7]),!i&&l[0]&8&&(i=!0,c.files=o[3],qt(()=>i=!1)),t.$set(c)},i(o){s||(U(t.$$.fragment,o),s=!0)},o(o){W(t.$$.fragment,o),s=!1},d(o){o&&E(e),be(t)}}}function goe(n){let e,t,i,s,r;const a=[foe,doe,uoe,hoe],o=[];function l(c,h){return c[15]?0:c[18]?1:c[17]?2:3}return t=l(n),i=o[t]=a[t](n),{c(){e=ee("div"),i.c(),this.h()},l(c){e=te(c,"DIV",{class:!0});var h=q(e);i.l(h),h.forEach(E),this.h()},h(){A(e,"class",s=(n[15]||n[17]||n[18]?" h-screen  w-full":"px-6 py-4")+" h-full")},m(c,h){$(c,e,h),o[t].m(e,null),r=!0},p(c,h){let u=t;t=l(c),t===u?o[t].p(c,h):(bt(),W(o[u],1,1,()=>{o[u]=null}),xt(),i=o[t],i?i.p(c,h):(i=o[t]=a[t](c),i.c()),U(i,1),i.m(e,null)),(!r||h[0]&425984&&s!==(s=(c[15]||c[17]||c[18]?" h-screen  w-full":"px-6 py-4")+" h-full"))&&A(e,"class",s)},i(c){r||(U(i),r=!0)},o(c){W(i),r=!1},d(c){c&&E(e),o[t].d()}}}function moe(n){let e,t,i,s;const r=[ioe,noe],a=[];function o(l,c){return l[12]?1:0}return e=o(n),t=a[e]=r[e](n),{c(){t.c(),i=zt()},l(l){t.l(l),i=zt()},m(l,c){a[e].m(l,c),$(l,i,c),s=!0},p(l,c){let h=e;e=o(l),e===h?a[e].p(l,c):(bt(),W(a[h],1,1,()=>{a[h]=null}),xt(),t=a[e],t?t.p(l,c):(t=a[e]=r[e](l),t.c()),U(t,1),t.m(i.parentNode,i))},i(l){s||(U(t),s=!0)},o(l){W(t),s=!1},d(l){l&&E(i),a[e].d(l)}}}function poe(n){let e,t;return e=new nre({props:{$$slots:{default:[moe]},$$scope:{ctx:n}}}),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p(i,s){const r={};s[0]&524287|s[1]&4096&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function boe(n,e,t){let i,s,r,a;Pe(n,Ba,X=>t(15,i=X)),Pe(n,Xi,X=>t(16,s=X)),Pe(n,r0,X=>t(17,r=X)),Pe(n,Zl,X=>t(18,a=X));let{history:o}=e,{models:l=[]}=e,{chatId:c=null}=e,{chatFiles:h=[]}=e,{params:u={}}=e,{eventTarget:d}=e,{submitPrompt:f}=e,{stopResponse:g}=e,{showMessage:m}=e,{files:x}=e,{modelId:p}=e,{pane:y}=e,w,_=!1,v=!1,C=0;const k=()=>{parseInt(localStorage==null?void 0:localStorage.chatControlsSize)?y.resize(parseInt(localStorage==null?void 0:localStorage.chatControlsSize)):y.resize(C)},I=async X=>{X.matches?(t(12,_=!0),i&&(Ba.set(!1),await hn(),Ba.set(!0))):(t(12,_=!1),i&&(Ba.set(!1),await hn(),Ba.set(!0)),t(4,y=null))},S=X=>{t(13,v=!0)},M=X=>{t(13,v=!1)};ol(()=>{w=window.matchMedia("(min-width: 1024px)"),w.addEventListener("change",I),I(w);const X=document.getElementById("chat-container");t(14,C=Math.floor(350/X.clientWidth*100)),new ResizeObserver(oe=>{for(let Q of oe){const Ke=350/Q.contentRect.width*100;t(14,C=Math.floor(Ke)),s&&y&&y.isExpanded()&&y.getSize()<C&&y.resize(C)}}).observe(X),document.addEventListener("mousedown",S),document.addEventListener("mouseup",M)}),Kh(()=>{Xi.set(!1),w.removeEventListener("change",I),document.removeEventListener("mousedown",S),document.removeEventListener("mouseup",M)});const N=()=>{Xi.set(!1),r0.set(!1),Zl.set(!1),i&&Ba.set(!1)};function F(X){x=X,t(3,x)}const H=()=>{Xi.set(!1)},T=X=>{m(X.detail.node.data.message)},z=()=>{Xi.set(!1)};function R(X){h=X,t(1,h)}function L(X){u=X,t(2,u)}const Y=()=>{Xi.set(!1)},j=()=>{Xi.set(!1)};function J(X){x=X,t(3,x)}const G=()=>{Xi.set(!1)},se=X=>{X.detail.node.data.message.favorite?t(0,o.messages[X.detail.node.data.message.id].favorite=!0,o):t(0,o.messages[X.detail.node.data.message.id].favorite=null,o),m(X.detail.node.data.message)},de=()=>{Xi.set(!1)};function he(X){h=X,t(1,h)}function we(X){u=X,t(2,u)}const ye=()=>{Xi.set(!1)},P=X=>{s&&y.isExpanded()&&(X<C&&y.resize(C),X<C?localStorage.chatControlsSize=0:localStorage.chatControlsSize=X)},V=()=>{Xi.set(!1)};function re(X){y=X,t(4,y)}return n.$$set=X=>{"history"in X&&t(0,o=X.history),"models"in X&&t(5,l=X.models),"chatId"in X&&t(6,c=X.chatId),"chatFiles"in X&&t(1,h=X.chatFiles),"params"in X&&t(2,u=X.params),"eventTarget"in X&&t(7,d=X.eventTarget),"submitPrompt"in X&&t(8,f=X.submitPrompt),"stopResponse"in X&&t(9,g=X.stopResponse),"showMessage"in X&&t(10,m=X.showMessage),"files"in X&&t(3,x=X.files),"modelId"in X&&t(11,p=X.modelId),"pane"in X&&t(4,y=X.pane)},n.$$.update=()=>{n.$$.dirty[0]&64&&(c||N())},[o,h,u,x,y,l,c,d,f,g,m,p,_,v,C,i,s,r,a,k,F,H,T,z,R,L,Y,j,J,G,se,de,he,we,ye,P,V,re]}class xoe extends Nt{constructor(e){super(),Ot(this,e,boe,poe,Ut,{history:0,models:5,chatId:6,chatFiles:1,params:2,eventTarget:7,submitPrompt:8,stopResponse:9,showMessage:10,files:3,modelId:11,pane:4,openPane:19},null,[-1,-1])}get openPane(){return this.$$.ctx[19]}}function gI(n,e,t){const i=n.slice();return i[6]=e[t],i[8]=t,i}function mI(n){let e,t,i=[],s=new Map,r=n[0].length===0&&pI(n),a=Zn(n[0]);const o=l=>l[6].id;for(let l=0;l<a.length;l+=1){let c=gI(n,a,l),h=o(c);s.set(h,i[l]=xI(h,c))}return{c(){e=ee("div"),r&&r.c(),t=Ce();for(let l=0;l<i.length;l+=1)i[l].c();this.h()},l(l){e=te(l,"DIV",{class:!0});var c=q(e);r&&r.l(c),t=Ae(c);for(let h=0;h<i.length;h+=1)i[h].l(c);c.forEach(E),this.h()},h(){A(e,"class","text-left text-sm w-full mb-3")},m(l,c){$(l,e,c),r&&r.m(e,null),K(e,t);for(let h=0;h<i.length;h+=1)i[h]&&i[h].m(e,null)},p(l,c){l[0].length===0?r?r.p(l,c):(r=pI(l),r.c(),r.m(e,t)):r&&(r.d(1),r=null),c&3&&(a=Zn(l[0]),i=ix(i,c,o,1,l,a,s,e,lF,xI,null,gI))},d(l){l&&E(e),r&&r.d();for(let c=0;c<i.length;c+=1)i[c].d()}}}function pI(n){let e,t=n[1].t("No chats found")+"",i;return{c(){e=ee("div"),i=vt(t),this.h()},l(s){e=te(s,"DIV",{class:!0});var r=q(e);i=kt(r,t),r.forEach(E),this.h()},h(){A(e,"class","text-xs text-gray-500 dark:text-gray-400 text-center px-5 min-h-20 w-full h-full flex justify-center items-center")},m(s,r){$(s,e,r),K(e,i)},p(s,r){r&2&&t!==(t=s[1].t("No chats found")+"")&&Et(i,t)},d(s){s&&E(e)}}}function bI(n){let e,t=n[1].t(n[6].time_range)+"",i,s;return{c(){e=ee("div"),i=vt(t),this.h()},l(r){e=te(r,"DIV",{class:!0});var a=q(e);i=kt(a,t),a.forEach(E),this.h()},h(){A(e,"class",s="w-full text-xs text-gray-500 dark:text-gray-500 font-medium "+(n[8]===0?"":"pt-5")+" pb-2 px-2")},m(r,a){$(r,e,a),K(e,i)},p(r,a){a&3&&t!==(t=r[1].t(r[6].time_range)+"")&&Et(i,t),a&1&&s!==(s="w-full text-xs text-gray-500 dark:text-gray-500 font-medium "+(r[8]===0?"":"pt-5")+" pb-2 px-2")&&A(e,"class",s)},d(r){r&&E(e)}}}function xI(n,e){var y,w,_;let t,i,s,r,a=((y=e[6])==null?void 0:y.title)+"",o,l,c,h,u=t8(((w=e[6])==null?void 0:w.updated_at)*1e3).calendar()+"",d,f,g,m,x,p=(e[8]===0||e[8]>0&&e[6].time_range!==e[0][e[8]-1].time_range)&&((_=e[6])==null?void 0:_.time_range)&&bI(e);return{key:n,first:null,c(){t=zt(),p&&p.c(),i=Ce(),s=ee("a"),r=ee("div"),o=vt(a),l=Ce(),c=ee("div"),h=ee("div"),d=vt(u),f=Ce(),this.h()},l(v){t=zt(),p&&p.l(v),i=Ae(v),s=te(v,"A",{class:!0,draggable:!0,href:!0});var C=q(s);r=te(C,"DIV",{class:!0});var k=q(r);o=kt(k,a),k.forEach(E),l=Ae(C),c=te(C,"DIV",{class:!0});var I=q(c);h=te(I,"DIV",{class:!0});var S=q(h);d=kt(S,u),S.forEach(E),I.forEach(E),f=Ae(C),C.forEach(E),this.h()},h(){A(r,"class","text-ellipsis line-clamp-1 w-full sm:basis-3/5"),A(h,"class","text-gray-500 dark:text-gray-400 text-xs"),A(c,"class","hidden sm:flex sm:basis-2/5 items-center justify-end"),A(s,"class","w-full flex justify-between items-center rounded-lg text-sm py-2 px-3 hover:bg-gray-50 dark:hover:bg-gray-850"),A(s,"draggable","false"),A(s,"href",g=`/c/${e[6].id}`),this.first=t},m(v,C){$(v,t,C),p&&p.m(v,C),$(v,i,C),$(v,s,C),K(s,r),K(r,o),K(s,l),K(s,c),K(c,h),K(h,d),K(s,f),m||(x=yt(s,"click",e[4]),m=!0)},p(v,C){var k,I,S;e=v,(e[8]===0||e[8]>0&&e[6].time_range!==e[0][e[8]-1].time_range)&&((k=e[6])!=null&&k.time_range)?p?p.p(e,C):(p=bI(e),p.c(),p.m(i.parentNode,i)):p&&(p.d(1),p=null),C&1&&a!==(a=((I=e[6])==null?void 0:I.title)+"")&&Et(o,a),C&1&&u!==(u=t8(((S=e[6])==null?void 0:S.updated_at)*1e3).calendar()+"")&&Et(d,u),C&1&&g!==(g=`/c/${e[6].id}`)&&A(s,"href",g)},d(v){v&&(E(t),E(i),E(s)),p&&p.d(v),m=!1,x()}}}function yoe(n){let e,t=n[0]&&mI(n);return{c(){t&&t.c(),e=zt()},l(i){t&&t.l(i),e=zt()},m(i,s){t&&t.m(i,s),$(i,e,s)},p(i,[s]){i[0]?t?t.p(i,s):(t=mI(i),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:Ct,o:Ct,d(i){i&&E(e),t&&t.d(i)}}}function woe(n,e,t){let i;const s=as("i18n");Pe(n,s,c=>t(1,i=c)),t8.extend(UD);let{chats:r=[]}=e,a=null;const o=async()=>{r.length===0?t(0,a=[]):t(0,a=r.map(c=>({...c,time_range:HD(c.updated_at)})))},l=()=>show=!1;return n.$$set=c=>{"chats"in c&&t(3,r=c.chats)},n.$$.update=()=>{n.$$.dirty&8&&r&&o()},[a,i,s,r,l]}class _oe extends Nt{constructor(e){super(),Ot(this,e,woe,yoe,Ut,{chats:3})}}class voe extends Nt{constructor(e){super(),Ot(this,e,null,null,Ut,{})}}function koe(n){var i,s;let e,t;return e=new _oe({props:{chats:((s=(i=n[0])==null?void 0:i.items)==null?void 0:s.chats)??[]}}),{c(){me(e.$$.fragment)},l(r){xe(e.$$.fragment,r)},m(r,a){pe(e,r,a),t=!0},p(r,a){var l,c;const o={};a&1&&(o.chats=((c=(l=r[0])==null?void 0:l.items)==null?void 0:c.chats)??[]),e.$set(o)},i(r){t||(U(e.$$.fragment,r),t=!0)},o(r){W(e.$$.fragment,r),t=!1},d(r){be(e,r)}}}function Coe(n){let e,t;return e=new voe({}),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p:Ct,i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function Aoe(n){let e,t,i,s,r;const a=[Coe,koe],o=[];function l(c,h){return 1}return~(i=l())&&(s=o[i]=a[i](n)),{c(){e=ee("div"),t=ee("div"),s&&s.c(),this.h()},l(c){e=te(c,"DIV",{});var h=q(e);t=te(h,"DIV",{class:!0});var u=q(t);s&&s.l(u),u.forEach(E),h.forEach(E),this.h()},h(){A(t,"class","")},m(c,h){$(c,e,h),K(e,t),~i&&o[i].m(t,null),r=!0},p(c,[h]){s&&s.p(c,h)},i(c){r||(U(s),r=!0)},o(c){W(s),r=!1},d(c){c&&E(e),~i&&o[i].d()}}}function Soe(n,e,t){as("i18n");let{folder:i=null}=e;return n.$$set=s=>{"folder"in s&&t(0,i=s.folder)},[i]}class Ioe extends Nt{constructor(e){super(),Ot(this,e,Soe,Aoe,Ut,{folder:0})}}function Eoe(n){let e,t;return{c(){e=at("svg"),t=at("path"),this.h()},l(i){e=ot(i,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=q(e);t=ot(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),q(t).forEach(E),s.forEach(E),this.h()},h(){A(t,"stroke-linecap","round"),A(t,"stroke-linejoin","round"),A(t,"d","M2.25 12.75V12A2.25 2.25 0 0 1 4.5 9.75h15A2.25 2.25 0 0 1 21.75 12v.75m-8.69-6.44-2.12-2.12a1.5 1.5 0 0 0-1.061-.44H4.5A2.25 2.25 0 0 0 2.25 6v12a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9a2.25 2.25 0 0 0-2.25-2.25h-5.379a1.5 1.5 0 0 1-1.06-.44Z"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"fill","none"),A(e,"viewBox","0 0 24 24"),A(e,"stroke-width",n[1]),A(e,"stroke","currentColor"),A(e,"class",n[0])},m(i,s){$(i,e,s),K(e,t)},p(i,[s]){s&2&&A(e,"stroke-width",i[1]),s&1&&A(e,"class",i[0])},i:Ct,o:Ct,d(i){i&&E(e)}}}function Toe(n,e,t){let{className:i="size-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,i=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[i,s]}class Roe extends Nt{constructor(e){super(),Ot(this,e,Toe,Eoe,Ut,{className:0,strokeWidth:1})}}function yI(n){let e,t,i,s,r,a,o,l,c,h,u,d,f=n[0].name+"",g,m,x,p,y;function w(k){n[10](k)}let _={edit:!0,folder:n[0],onSubmit:n[5]};n[1]!==void 0&&(_.show=n[1]),e=new CF({props:_}),It.push(()=>Wt(e,"show",w));function v(k){n[11](k)}let C={title:n[3].t("Delete folder?"),$$slots:{default:[Moe]},$$scope:{ctx:n}};return n[2]!==void 0&&(C.show=n[2]),s=new jI({props:C}),It.push(()=>Wt(s,"show",v)),s.$on("confirm",n[12]),h=new Roe({props:{className:"size-4.5",strokeWidth:"2"}}),p=new AF({props:{align:"end",onEdit:n[13],onDelete:n[14],onExport:n[15],$$slots:{default:[Poe]},$$scope:{ctx:n}}}),{c(){me(e.$$.fragment),i=Ce(),me(s.$$.fragment),a=Ce(),o=ee("div"),l=ee("div"),c=ee("div"),me(h.$$.fragment),u=Ce(),d=ee("div"),g=vt(f),m=Ce(),x=ee("div"),me(p.$$.fragment),this.h()},l(k){xe(e.$$.fragment,k),i=Ae(k),xe(s.$$.fragment,k),a=Ae(k),o=te(k,"DIV",{class:!0});var I=q(o);l=te(I,"DIV",{class:!0});var S=q(l);c=te(S,"DIV",{class:!0});var M=q(c);xe(h.$$.fragment,M),M.forEach(E),u=Ae(S),d=te(S,"DIV",{class:!0});var N=q(d);g=kt(N,f),N.forEach(E),S.forEach(E),m=Ae(I),x=te(I,"DIV",{class:!0});var F=q(x);xe(p.$$.fragment,F),F.forEach(E),I.forEach(E),this.h()},h(){A(c,"class","rounded-full bg-gray-50 dark:bg-gray-800 p-3 w-fit"),A(d,"class","text-3xl"),A(l,"class","text-center flex gap-3.5 items-center"),A(x,"class","flex items-center translate-x-2.5"),A(o,"class","mb-3 px-6 @md:max-w-3xl justify-between w-full flex relative group items-center")},m(k,I){pe(e,k,I),$(k,i,I),pe(s,k,I),$(k,a,I),$(k,o,I),K(o,l),K(l,c),pe(h,c,null),K(l,u),K(l,d),K(d,g),K(o,m),K(o,x),pe(p,x,null),y=!0},p(k,I){const S={};I&1&&(S.folder=k[0]),!t&&I&2&&(t=!0,S.show=k[1],qt(()=>t=!1)),e.$set(S);const M={};I&8&&(M.title=k[3].t("Delete folder?")),I&131081&&(M.$$scope={dirty:I,ctx:k}),!r&&I&4&&(r=!0,M.show=k[2],qt(()=>r=!1)),s.$set(M),(!y||I&1)&&f!==(f=k[0].name+"")&&Et(g,f);const N={};I&2&&(N.onEdit=k[13]),I&4&&(N.onDelete=k[14]),I&131072&&(N.$$scope={dirty:I,ctx:k}),p.$set(N)},i(k){y||(U(e.$$.fragment,k),U(s.$$.fragment,k),U(h.$$.fragment,k),U(p.$$.fragment,k),y=!0)},o(k){W(e.$$.fragment,k),W(s.$$.fragment,k),W(h.$$.fragment,k),W(p.$$.fragment,k),y=!1},d(k){k&&(E(i),E(a),E(o)),be(e,k),be(s,k),be(h),be(p)}}}function Moe(n){let e,t,i=g3.sanitize(n[3].t("This will delete <strong>{{NAME}}</strong> and <strong>all its contents</strong>.",{NAME:n[0].name}))+"";return{c(){e=ee("div"),t=new Q6(!1),this.h()},l(s){e=te(s,"DIV",{class:!0});var r=q(e);t=$6(r,!1),r.forEach(E),this.h()},h(){t.a=null,A(e,"class","text-sm text-gray-700 dark:text-gray-300 flex-1 line-clamp-3")},m(s,r){$(s,e,r),t.m(i,e)},p(s,r){r&9&&i!==(i=g3.sanitize(s[3].t("This will delete <strong>{{NAME}}</strong> and <strong>all its contents</strong>.",{NAME:s[0].name}))+"")&&t.p(i)},d(s){s&&E(e)}}}function Poe(n){let e,t,i,s,r;return t=new qF({props:{className:"size-4",strokeWidth:"2.5"}}),{c(){e=ee("button"),me(t.$$.fragment),this.h()},l(a){e=te(a,"BUTTON",{class:!0});var o=q(e);xe(t.$$.fragment,o),o.forEach(E),this.h()},h(){A(e,"class","p-1.5 dark:hover:bg-gray-850 rounded-full touch-auto")},m(a,o){$(a,e,o),pe(t,e,null),i=!0,s||(r=yt(e,"click",Ooe),s=!0)},p:Ct,i(a){i||(U(t.$$.fragment,a),i=!0)},o(a){W(t.$$.fragment,a),i=!1},d(a){a&&E(e),be(t),s=!1,r()}}}function Noe(n){let e,t,i=n[0]&&yI(n);return{c(){i&&i.c(),e=zt()},l(s){i&&i.l(s),e=zt()},m(s,r){i&&i.m(s,r),$(s,e,r),t=!0},p(s,[r]){s[0]?i?(i.p(s,r),r&1&&U(i,1)):(i=yI(s),i.c(),U(i,1),i.m(e.parentNode,e)):i&&(bt(),W(i,1,1,()=>{i=null}),xt())},i(s){t||(U(i),t=!0)},o(s){W(i),t=!1},d(s){s&&E(e),i&&i.d(s)}}}const Ooe=n=>{};function Doe(n,e,t){let i;const s=as("i18n");Pe(n,s,_=>t(3,i=_));const{saveAs:r}=UI;let{folder:a=null}=e,{onUpdate:o=_=>{}}=e,{onDelete:l=_=>{}}=e,c=!1,h=!1;const u=async({name:_,data:v})=>{if(_===""){Jt.error(i.t("Folder name cannot be empty."));return}const C=a.name;_=_.trim(),t(0,a.name=_,a),await SF(localStorage.token,a.id,{name:_,...v?{data:v}:{}}).catch(I=>(Jt.error(`${I}`),t(0,a.name=C,a),null))&&(t(0,a.name=_,a),v&&t(0,a.data=v,a),Jt.success(i.t("Folder updated successfully")),Jf.set(a),o(a))},d=async()=>{await IF(localStorage.token,a.id).catch(v=>(Jt.error(`${v}`),null))&&(Jt.success(i.t("Folder deleted successfully")),l(a))},f=async()=>{const _=await qD(localStorage.token,a.id).catch(C=>(Jt.error(`${C}`),null));if(!_)return;const v=new Blob([JSON.stringify(_)],{type:"application/json"});r(v,`folder-${a.name}-export-${Date.now()}.json`)};function g(_){c=_,t(1,c)}function m(_){h=_,t(2,h)}const x=()=>{d()},p=()=>{t(1,c=!0)},y=()=>{t(2,h=!0)},w=()=>{f()};return n.$$set=_=>{"folder"in _&&t(0,a=_.folder),"onUpdate"in _&&t(8,o=_.onUpdate),"onDelete"in _&&t(9,l=_.onDelete)},[a,c,h,i,s,u,d,f,o,l,g,m,x,p,y,w]}class Foe extends Nt{constructor(e){super(),Ot(this,e,Doe,Noe,Ut,{folder:0,onUpdate:8,onDelete:9})}}function wI(n,e,t){const i=n.slice();return i[46]=e[t],i[48]=t,i}function _I(n){let e,t;return e=new wi({props:{content:n[21].t("This chat won't appear in history and your messages will not be saved."),className:"w-full flex justify-center mb-0.5",placement:"top",$$slots:{default:[Loe]},$$scope:{ctx:n}}}),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p(i,s){const r={};s[0]&2097152&&(r.content=i[21].t("This chat won't appear in history and your messages will not be saved.")),s[0]&2097152|s[1]&262144&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function Loe(n){let e,t,i=n[21].t("Temporary Chat")+"",s,r;return t=new VF({props:{strokeWidth:"2.5",className:"size-5"}}),{c(){e=ee("div"),me(t.$$.fragment),s=vt(i),this.h()},l(a){e=te(a,"DIV",{class:!0});var o=q(e);xe(t.$$.fragment,o),s=kt(o,i),o.forEach(E),this.h()},h(){A(e,"class","flex items-center gap-2 text-gray-500 font-medium text-lg my-2 w-fit")},m(a,o){$(a,e,o),pe(t,e,null),K(e,s),r=!0},p(a,o){(!r||o[0]&2097152)&&i!==(i=a[21].t("Temporary Chat")+"")&&Et(s,i)},i(a){r||(U(t.$$.fragment,a),r=!0)},o(a){W(t.$$.fragment,a),r=!1},d(a){a&&E(e),be(t)}}}function Boe(n){var C,k,I;let e,t,i,s,r,a,o,l,c,h,u,d,f,g,m=Zn(n[18]),x=[];for(let S=0;S<m.length;S+=1)x[S]=vI(wI(n,m,S));const p=S=>W(x[S],1,1,()=>{x[S]=null}),y=[joe,zoe],w=[];function _(S,M){var N;return(N=S[18][S[19]])!=null&&N.name?0:1}o=_(n),l=w[o]=y[o](n);let v=(((I=(k=(C=n[18][n[19]])==null?void 0:C.info)==null?void 0:k.meta)==null?void 0:I.description)??null)&&kI(n);return{c(){e=ee("div"),t=ee("div"),i=ee("div");for(let S=0;S<x.length;S+=1)x[S].c();r=Ce(),a=ee("div"),l.c(),h=Ce(),u=ee("div"),d=ee("div"),v&&v.c(),this.h()},l(S){e=te(S,"DIV",{class:!0});var M=q(e);t=te(M,"DIV",{class:!0});var N=q(t);i=te(N,"DIV",{class:!0});var F=q(i);for(let R=0;R<x.length;R+=1)x[R].l(F);F.forEach(E),N.forEach(E),r=Ae(M),a=te(M,"DIV",{class:!0});var H=q(a);l.l(H),H.forEach(E),M.forEach(E),h=Ae(S),u=te(S,"DIV",{class:!0});var T=q(u);d=te(T,"DIV",{});var z=q(d);v&&v.l(z),z.forEach(E),T.forEach(E),this.h()},h(){A(i,"class","flex -space-x-4 mb-0.5"),A(t,"class","flex shrink-0 justify-center"),A(a,"class","text-3xl @sm:text-3xl line-clamp-1 flex items-center"),A(e,"class","flex flex-row justify-center gap-3 @sm:gap-3.5 w-fit px-5 max-w-xl"),A(u,"class","flex mt-1 mb-2")},m(S,M){$(S,e,M),K(e,t),K(t,i);for(let N=0;N<x.length;N+=1)x[N]&&x[N].m(i,null);K(e,r),K(e,a),w[o].m(a,null),$(S,h,M),$(S,u,M),K(u,d),v&&v.m(d,null),g=!0},p(S,M){var F,H,T;if(M[0]&2883584){m=Zn(S[18]);let z;for(z=0;z<m.length;z+=1){const R=wI(S,m,z);x[z]?(x[z].p(R,M),U(x[z],1)):(x[z]=vI(R),x[z].c(),U(x[z],1),x[z].m(i,null))}for(bt(),z=m.length;z<x.length;z+=1)p(z);xt()}let N=o;o=_(S),o===N?w[o].p(S,M):(bt(),W(w[N],1,1,()=>{w[N]=null}),xt(),l=w[o],l?l.p(S,M):(l=w[o]=y[o](S),l.c()),U(l,1),l.m(a,null)),((T=(H=(F=S[18][S[19]])==null?void 0:F.info)==null?void 0:H.meta)==null?void 0:T.description)??null?v?(v.p(S,M),M[0]&786432&&U(v,1)):(v=kI(S),v.c(),U(v,1),v.m(d,null)):v&&(bt(),W(v,1,1,()=>{v=null}),xt())},i(S){if(!g){for(let M=0;M<m.length;M+=1)U(x[M]);S&&(s||s0(()=>{s=Xf(i,Zf,{duration:100}),s.start()})),U(l),S&&(c||s0(()=>{c=Xf(a,Zf,{duration:100}),c.start()})),U(v),S&&(f||s0(()=>{f=Xf(d,Zf,{duration:100,delay:50}),f.start()})),g=!0}},o(S){x=x.filter(Boolean);for(let M=0;M<x.length;M+=1)W(x[M]);W(l),W(v),g=!1},d(S){S&&(E(e),E(h),E(u)),vo(x,S),w[o].d(),v&&v.d()}}}function Uoe(n){let e,t;return e=new Foe({props:{folder:n[22],onUpdate:n[29],onDelete:n[30]}}),{c(){me(e.$$.fragment)},l(i){xe(e.$$.fragment,i)},m(i,s){pe(e,i,s),t=!0},p(i,s){const r={};s[0]&4194304&&(r.folder=i[22]),s[0]&8388608&&(r.onUpdate=i[29]),s[0]&8388608&&(r.onDelete=i[30]),e.$set(r)},i(i){t||(U(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function Hoe(n){let e,t,i,s,r,a,o,l;function c(){return n[31](n[48])}return{c(){e=ee("button"),t=ee("img"),a=Ce(),this.h()},l(h){e=te(h,"BUTTON",{"aria-hidden":!0,"aria-label":!0});var u=q(e);t=te(u,"IMG",{crossorigin:!0,src:!0,class:!0,"aria-hidden":!0,draggable:!0}),u.forEach(E),a=Ae(h),this.h()},h(){var h,u,d,f;A(t,"crossorigin","anonymous"),b0(t.src,i=((d=(u=(h=n[46])==null?void 0:h.info)==null?void 0:u.meta)==null?void 0:d.profile_image_url)??(n[21].language==="dg-DG"?`${Yo}/doge.png`:`${Yo}/static/favicon.png`))||A(t,"src",i),A(t,"class","size-9 @sm:size-10 rounded-full border-[1px] border-gray-100 dark:border-none"),A(t,"aria-hidden","true"),A(t,"draggable","false"),A(e,"aria-hidden",s=n[18].length<=1),A(e,"aria-label",r=n[21].t("Get information on {{name}} in the UI",{name:(f=n[18][n[48]])==null?void 0:f.name}))},m(h,u){$(h,e,u),K(e,t),$(h,a,u),o||(l=yt(e,"click",c),o=!0)},p(h,u){var d,f,g,m;n=h,u[0]&2359296&&!b0(t.src,i=((g=(f=(d=n[46])==null?void 0:d.info)==null?void 0:f.meta)==null?void 0:g.profile_image_url)??(n[21].language==="dg-DG"?`${Yo}/doge.png`:`${Yo}/static/favicon.png`))&&A(t,"src",i),u[0]&262144&&s!==(s=n[18].length<=1)&&A(e,"aria-hidden",s),u[0]&2359296&&r!==(r=n[21].t("Get information on {{name}} in the UI",{name:(m=n[18][n[48]])==null?void 0:m.name}))&&A(e,"aria-label",r)},d(h){h&&(E(e),E(a)),o=!1,l()}}}function vI(n){var i,s,r;let e,t;return e=new wi({props:{content:(((r=(s=(i=n[18][n[48]])==null?void 0:i.info)==null?void 0:s.meta)==null?void 0:r.tags)??[]).map(AI).join(", "),placement:"top",$$slots:{default:[Hoe]},$$scope:{ctx:n}}}),{c(){me(e.$$.fragment)},l(a){xe(e.$$.fragment,a)},m(a,o){pe(e,a,o),t=!0},p(a,o){var c,h,u;const l={};o[0]&262144&&(l.content=(((u=(h=(c=a[18][a[48]])==null?void 0:c.info)==null?void 0:h.meta)==null?void 0:u.tags)??[]).map(AI).join(", ")),o[0]&2883584|o[1]&262144&&(l.$$scope={dirty:o,ctx:a}),e.$set(l)},i(a){t||(U(e.$$.fragment,a),t=!0)},o(a){W(e.$$.fragment,a),t=!1},d(a){be(e,a)}}}function zoe(n){var i;let e=n[21].t("Hello, {{name}}",{name:(i=n[24])==null?void 0:i.name})+"",t;return{c(){t=vt(e)},l(s){t=kt(s,e)},m(s,r){$(s,t,r)},p(s,r){var a;r[0]&18874368&&e!==(e=s[21].t("Hello, {{name}}",{name:(a=s[24])==null?void 0:a.name})+"")&&Et(t,e)},i:Ct,o:Ct,d(s){s&&E(t)}}}function joe(n){var i;let e,t;return e=new wi({props:{content:(i=n[18][n[19]])==null?void 0:i.name,placement:"top",className:" flex items-center ",$$slots:{default:[Goe]},$$scope:{ctx:n}}}),{c(){me(e.$$.fragment)},l(s){xe(e.$$.fragment,s)},m(s,r){pe(e,s,r),t=!0},p(s,r){var o;const a={};r[0]&786432&&(a.content=(o=s[18][s[19]])==null?void 0:o.name),r[0]&786432|r[1]&262144&&(a.$$scope={dirty:r,ctx:s}),e.$set(a)},i(s){t||(U(e.$$.fragment,s),t=!0)},o(s){W(e.$$.fragment,s),t=!1},d(s){be(e,s)}}}function Goe(n){var s;let e,t=((s=n[18][n[19]])==null?void 0:s.name)+"",i;return{c(){e=ee("span"),i=vt(t),this.h()},l(r){e=te(r,"SPAN",{class:!0});var a=q(e);i=kt(a,t),a.forEach(E),this.h()},h(){A(e,"class","line-clamp-1")},m(r,a){$(r,e,a),K(e,i)},p(r,a){var o;a[0]&786432&&t!==(t=((o=r[18][r[19]])==null?void 0:o.name)+"")&&Et(i,t)},d(r){r&&E(e)}}}function kI(n){var a,o,l,c,h,u;let e,t,i,s;e=new wi({props:{className:" w-fit",content:Sg.parse(m3(((l=(o=(a=n[18][n[19]])==null?void 0:a.info)==null?void 0:o.meta)==null?void 0:l.description)??"").replaceAll(`
`,"<br>")),placement:"top",$$slots:{default:[Voe]},$$scope:{ctx:n}}});let r=((u=(h=(c=n[18][n[19]])==null?void 0:c.info)==null?void 0:h.meta)==null?void 0:u.user)&&CI(n);return{c(){me(e.$$.fragment),t=Ce(),r&&r.c(),i=zt()},l(d){xe(e.$$.fragment,d),t=Ae(d),r&&r.l(d),i=zt()},m(d,f){pe(e,d,f),$(d,t,f),r&&r.m(d,f),$(d,i,f),s=!0},p(d,f){var m,x,p,y,w,_;const g={};f[0]&786432&&(g.content=Sg.parse(m3(((p=(x=(m=d[18][d[19]])==null?void 0:m.info)==null?void 0:x.meta)==null?void 0:p.description)??"").replaceAll(`
`,"<br>"))),f[0]&786432|f[1]&262144&&(g.$$scope={dirty:f,ctx:d}),e.$set(g),(_=(w=(y=d[18][d[19]])==null?void 0:y.info)==null?void 0:w.meta)!=null&&_.user?r?r.p(d,f):(r=CI(d),r.c(),r.m(i.parentNode,i)):r&&(r.d(1),r=null)},i(d){s||(U(e.$$.fragment,d),s=!0)},o(d){W(e.$$.fragment,d),s=!1},d(d){d&&(E(t),E(i)),be(e,d),r&&r.d(d)}}}function Voe(n){var s,r,a;let e,t,i=Sg.parse(m3(((a=(r=(s=n[18][n[19]])==null?void 0:s.info)==null?void 0:r.meta)==null?void 0:a.description)??"").replaceAll(`
`,"<br>"))+"";return{c(){e=ee("div"),t=new Q6(!1),this.h()},l(o){e=te(o,"DIV",{class:!0});var l=q(e);t=$6(l,!1),l.forEach(E),this.h()},h(){t.a=null,A(e,"class","mt-0.5 px-2 text-sm font-normal text-gray-500 dark:text-gray-400 line-clamp-2 max-w-xl markdown")},m(o,l){$(o,e,l),t.m(i,e)},p(o,l){var c,h,u;l[0]&786432&&i!==(i=Sg.parse(m3(((u=(h=(c=o[18][o[19]])==null?void 0:c.info)==null?void 0:h.meta)==null?void 0:u.description)??"").replaceAll(`
`,"<br>"))+"")&&t.p(i)},d(o){o&&E(e)}}}function CI(n){let e,t;function i(a,o){var l,c,h;return(h=(c=(l=a[18][a[19]])==null?void 0:l.info)==null?void 0:c.meta)!=null&&h.user.community?Woe:qoe}let s=i(n),r=s(n);return{c(){e=ee("div"),t=vt(`By
									`),r.c(),this.h()},l(a){e=te(a,"DIV",{class:!0});var o=q(e);t=kt(o,`By
									`),r.l(o),o.forEach(E),this.h()},h(){A(e,"class","mt-0.5 text-sm font-normal text-gray-400 dark:text-gray-500")},m(a,o){$(a,e,o),K(e,t),r.m(e,null)},p(a,o){s===(s=i(a))&&r?r.p(a,o):(r.d(1),r=s(a),r&&(r.c(),r.m(e,null)))},d(a){a&&E(e),r.d()}}}function qoe(n){var i,s,r;let e=((r=(s=(i=n[18][n[19]])==null?void 0:i.info)==null?void 0:s.meta)==null?void 0:r.user.name)+"",t;return{c(){t=vt(e)},l(a){t=kt(a,e)},m(a,o){$(a,t,o)},p(a,o){var l,c,h;o[0]&786432&&e!==(e=((h=(c=(l=a[18][a[19]])==null?void 0:l.info)==null?void 0:c.meta)==null?void 0:h.user.name)+"")&&Et(t,e)},d(a){a&&E(t)}}}function Woe(n){var r,a,o,l,c,h,u,d,f;let e,t=((o=(a=(r=n[18][n[19]])==null?void 0:r.info)==null?void 0:a.meta)!=null&&o.user.name?(h=(c=(l=n[18][n[19]])==null?void 0:l.info)==null?void 0:c.meta)==null?void 0:h.user.name:`@${(f=(d=(u=n[18][n[19]])==null?void 0:u.info)==null?void 0:d.meta)==null?void 0:f.user.username}`)+"",i,s;return{c(){e=ee("a"),i=vt(t),this.h()},l(g){e=te(g,"A",{href:!0});var m=q(e);i=kt(m,t),m.forEach(E),this.h()},h(){var g,m,x;A(e,"href",s="https://openwebui.com/m/"+((x=(m=(g=n[18][n[19]])==null?void 0:g.info)==null?void 0:m.meta)==null?void 0:x.user.username))},m(g,m){$(g,e,m),K(e,i)},p(g,m){var x,p,y,w,_,v,C,k,I,S,M,N;m[0]&786432&&t!==(t=((y=(p=(x=g[18][g[19]])==null?void 0:x.info)==null?void 0:p.meta)!=null&&y.user.name?(v=(_=(w=g[18][g[19]])==null?void 0:w.info)==null?void 0:_.meta)==null?void 0:v.user.name:`@${(I=(k=(C=g[18][g[19]])==null?void 0:C.info)==null?void 0:k.meta)==null?void 0:I.user.username}`)+"")&&Et(i,t),m[0]&786432&&s!==(s="https://openwebui.com/m/"+((N=(M=(S=g[18][g[19]])==null?void 0:S.info)==null?void 0:M.meta)==null?void 0:N.user.username))&&A(e,"href",s)},d(g){g&&E(e)}}}function Koe(n){var a,o,l,c,h,u,d;let e,t,i,s,r;return i=new wF({props:{suggestionPrompts:((l=(o=(a=n[1])==null?void 0:a.info)==null?void 0:o.meta)==null?void 0:l.suggestion_prompts)??((u=(h=(c=n[18][n[19]])==null?void 0:c.info)==null?void 0:h.meta)==null?void 0:u.suggestion_prompts)??((d=n[25])==null?void 0:d.default_prompt_suggestions)??[],inputValue:n[2],onSelect:n[16]}}),{c(){e=ee("div"),t=ee("div"),me(i.$$.fragment),this.h()},l(f){e=te(f,"DIV",{class:!0});var g=q(e);t=te(g,"DIV",{class:!0});var m=q(t);xe(i.$$.fragment,m),m.forEach(E),g.forEach(E),this.h()},h(){A(t,"class","mx-5"),A(e,"class","mx-auto max-w-2xl font-primary mt-2")},m(f,g){$(f,e,g),K(e,t),pe(i,t,null),r=!0},p(f,g){var x,p,y,w,_,v,C;const m={};g[0]&34340866&&(m.suggestionPrompts=((y=(p=(x=f[1])==null?void 0:x.info)==null?void 0:p.meta)==null?void 0:y.suggestion_prompts)??((v=(_=(w=f[18][f[19]])==null?void 0:w.info)==null?void 0:_.meta)==null?void 0:v.suggestion_prompts)??((C=f[25])==null?void 0:C.default_prompt_suggestions)??[]),g[0]&4&&(m.inputValue=f[2]),g[0]&65536&&(m.onSelect=f[16]),i.$set(m)},i(f){r||(U(i.$$.fragment,f),f&&(s||s0(()=>{s=Xf(e,Zf,{duration:200,delay:200}),s.start()})),r=!0)},o(f){W(i.$$.fragment,f),r=!1},d(f){f&&E(e),be(i)}}}function Xoe(n){let e,t,i,s;return t=new Ioe({props:{folder:n[22]}}),{c(){e=ee("div"),me(t.$$.fragment),this.h()},l(r){e=te(r,"DIV",{class:!0});var a=q(e);xe(t.$$.fragment,a),a.forEach(E),this.h()},h(){A(e,"class","mx-auto px-4 md:max-w-3xl md:px-6 font-primary min-h-62")},m(r,a){$(r,e,a),pe(t,e,null),s=!0},p(r,a){const o={};a[0]&4194304&&(o.folder=r[22]),t.$set(o)},i(r){s||(U(t.$$.fragment,r),r&&(i||s0(()=>{i=Xf(e,Zf,{duration:200,delay:200}),i.start()})),s=!0)},o(r){W(t.$$.fragment,r),s=!1},d(r){r&&E(e),be(t)}}}function Yoe(n){let e,t,i,s,r,a,o,l,c,h,u,d,f,g,m,x,p,y,w,_,v,C,k,I,S=n[20]&&_I(n);const M=[Uoe,Boe],N=[];function F(P,V){return P[22]?0:1}r=F(n),a=N[r]=M[r](n);function H(P){n[34](P)}function T(P){n[35](P)}function z(P){n[36](P)}function R(P){n[37](P)}function L(P){n[38](P)}function Y(P){n[39](P)}function j(P){n[40](P)}function J(P){n[41](P)}function G(P){n[42](P)}function se(P){n[43](P)}let de={history:n[15],selectedModels:n[14],toolServers:n[17],transparentBackground:n[11],stopResponse:n[13],createMessagePair:n[12],placeholder:n[21].t("How can I help you today?"),onChange:n[32]};n[3]!==void 0&&(de.files=n[3]),n[2]!==void 0&&(de.prompt=n[2]),n[0]!==void 0&&(de.autoScroll=n[0]),n[5]!==void 0&&(de.selectedToolIds=n[5]),n[6]!==void 0&&(de.selectedFilterIds=n[6]),n[8]!==void 0&&(de.imageGenerationEnabled=n[8]),n[9]!==void 0&&(de.codeInterpreterEnabled=n[9]),n[10]!==void 0&&(de.webSearchEnabled=n[10]),n[1]!==void 0&&(de.atSelectedModel=n[1]),n[7]!==void 0&&(de.showCommands=n[7]),c=new bO({props:de}),n[33](c),It.push(()=>Wt(c,"files",H)),It.push(()=>Wt(c,"prompt",T)),It.push(()=>Wt(c,"autoScroll",z)),It.push(()=>Wt(c,"selectedToolIds",R)),It.push(()=>Wt(c,"selectedFilterIds",L)),It.push(()=>Wt(c,"imageGenerationEnabled",Y)),It.push(()=>Wt(c,"codeInterpreterEnabled",j)),It.push(()=>Wt(c,"webSearchEnabled",J)),It.push(()=>Wt(c,"atSelectedModel",G)),It.push(()=>Wt(c,"showCommands",se)),c.$on("upload",n[44]),c.$on("submit",n[45]);const he=[Xoe,Koe],we=[];function ye(P,V){return P[22]?0:1}return C=ye(n),k=we[C]=he[C](n),{c(){e=ee("div"),S&&S.c(),t=Ce(),i=ee("div"),s=ee("div"),a.c(),o=Ce(),l=ee("div"),me(c.$$.fragment),v=Ce(),k.c(),this.h()},l(P){e=te(P,"DIV",{class:!0});var V=q(e);S&&S.l(V),t=Ae(V),i=te(V,"DIV",{class:!0});var re=q(i);s=te(re,"DIV",{class:!0});var X=q(s);a.l(X),o=Ae(X),l=te(X,"DIV",{class:!0});var ue=q(l);xe(c.$$.fragment,ue),ue.forEach(E),X.forEach(E),re.forEach(E),v=Ae(V),k.l(V),V.forEach(E),this.h()},h(){A(l,"class",_="text-base font-normal @md:max-w-3xl w-full py-3 "+(n[1]?"mt-2":"")),A(s,"class","w-full flex flex-col justify-center items-center"),A(i,"class","w-full text-3xl text-gray-800 dark:text-gray-100 text-center flex items-center gap-4 font-primary"),A(e,"class","m-auto w-full max-w-6xl px-2 @2xl:px-20 translate-y-6 py-24 text-center")},m(P,V){$(P,e,V),S&&S.m(e,null),K(e,t),K(e,i),K(i,s),N[r].m(s,null),K(s,o),K(s,l),pe(c,l,null),K(e,v),we[C].m(e,null),I=!0},p(P,V){P[20]?S?(S.p(P,V),V[0]&1048576&&U(S,1)):(S=_I(P),S.c(),U(S,1),S.m(e,t)):S&&(bt(),W(S,1,1,()=>{S=null}),xt());let re=r;r=F(P),r===re?N[r].p(P,V):(bt(),W(N[re],1,1,()=>{N[re]=null}),xt(),a=N[r],a?a.p(P,V):(a=N[r]=M[r](P),a.c()),U(a,1),a.m(s,o));const X={};V[0]&32768&&(X.history=P[15]),V[0]&16384&&(X.selectedModels=P[14]),V[0]&131072&&(X.toolServers=P[17]),V[0]&2048&&(X.transparentBackground=P[11]),V[0]&8192&&(X.stopResponse=P[13]),V[0]&4096&&(X.createMessagePair=P[12]),V[0]&2097152&&(X.placeholder=P[21].t("How can I help you today?")),V[0]&1048576&&(X.onChange=P[32]),!h&&V[0]&8&&(h=!0,X.files=P[3],qt(()=>h=!1)),!u&&V[0]&4&&(u=!0,X.prompt=P[2],qt(()=>u=!1)),!d&&V[0]&1&&(d=!0,X.autoScroll=P[0],qt(()=>d=!1)),!f&&V[0]&32&&(f=!0,X.selectedToolIds=P[5],qt(()=>f=!1)),!g&&V[0]&64&&(g=!0,X.selectedFilterIds=P[6],qt(()=>g=!1)),!m&&V[0]&256&&(m=!0,X.imageGenerationEnabled=P[8],qt(()=>m=!1)),!x&&V[0]&512&&(x=!0,X.codeInterpreterEnabled=P[9],qt(()=>x=!1)),!p&&V[0]&1024&&(p=!0,X.webSearchEnabled=P[10],qt(()=>p=!1)),!y&&V[0]&2&&(y=!0,X.atSelectedModel=P[1],qt(()=>y=!1)),!w&&V[0]&128&&(w=!0,X.showCommands=P[7],qt(()=>w=!1)),c.$set(X),(!I||V[0]&2&&_!==(_="text-base font-normal @md:max-w-3xl w-full py-3 "+(P[1]?"mt-2":"")))&&A(l,"class",_);let ue=C;C=ye(P),C===ue?we[C].p(P,V):(bt(),W(we[ue],1,1,()=>{we[ue]=null}),xt(),k=we[C],k?k.p(P,V):(k=we[C]=he[C](P),k.c()),U(k,1),k.m(e,null))},i(P){I||(U(S),U(a),U(c.$$.fragment,P),U(k),I=!0)},o(P){W(S),W(a),W(c.$$.fragment,P),W(k),I=!1},d(P){P&&E(e),S&&S.d(),N[r].d(),n[33](null),be(c),we[C].d()}}}const AI=n=>n.name.toUpperCase();function Joe(n,e,t){let i,s,r,a,o,l,c;Pe(n,Xg,Q=>t(28,i=Q)),Pe(n,Fd,Q=>t(20,s=Q)),Pe(n,Jf,Q=>t(22,a=Q)),Pe(n,kl,Q=>t(23,o=Q)),Pe(n,k0,Q=>t(24,l=Q)),Pe(n,Kg,Q=>t(25,c=Q));const h=Xa(),u=as("i18n");Pe(n,u,Q=>t(21,r=Q));let{transparentBackground:d=!1}=e,{createMessagePair:f}=e,{stopResponse:g}=e,{autoScroll:m=!1}=e,{atSelectedModel:x}=e,{selectedModels:p}=e,{history:y}=e,{prompt:w=""}=e,{files:_=[]}=e,{messageInput:v=null}=e,{selectedToolIds:C=[]}=e,{selectedFilterIds:k=[]}=e,{showCommands:I=!1}=e,{imageGenerationEnabled:S=!1}=e,{codeInterpreterEnabled:M=!1}=e,{webSearchEnabled:N=!1}=e,{onSelect:F=Q=>{}}=e,{toolServers:H=[]}=e,T=[],z=0;ol(()=>{});const R=async Q=>{Jf.set(Q),await mc.set(await T0(localStorage.token,o)),kl.set(1)},L=async()=>{await mc.set(await T0(localStorage.token,o)),kl.set(1),Jf.set(null)},Y=Q=>{t(19,z=Q)},j=Q=>{s||(Q.prompt!==null?sessionStorage.setItem("chat-input",JSON.stringify(Q)):sessionStorage.removeItem("chat-input"))};function J(Q){It[Q?"unshift":"push"](()=>{v=Q,t(4,v)})}function G(Q){_=Q,t(3,_)}function se(Q){w=Q,t(2,w)}function de(Q){m=Q,t(0,m)}function he(Q){C=Q,t(5,C)}function we(Q){k=Q,t(6,k)}function ye(Q){S=Q,t(8,S)}function P(Q){M=Q,t(9,M)}function V(Q){N=Q,t(10,N)}function re(Q){x=Q,t(1,x)}function X(Q){I=Q,t(7,I)}const ue=Q=>{h("upload",Q.detail)},oe=Q=>{h("submit",Q.detail)};return n.$$set=Q=>{"transparentBackground"in Q&&t(11,d=Q.transparentBackground),"createMessagePair"in Q&&t(12,f=Q.createMessagePair),"stopResponse"in Q&&t(13,g=Q.stopResponse),"autoScroll"in Q&&t(0,m=Q.autoScroll),"atSelectedModel"in Q&&t(1,x=Q.atSelectedModel),"selectedModels"in Q&&t(14,p=Q.selectedModels),"history"in Q&&t(15,y=Q.history),"prompt"in Q&&t(2,w=Q.prompt),"files"in Q&&t(3,_=Q.files),"messageInput"in Q&&t(4,v=Q.messageInput),"selectedToolIds"in Q&&t(5,C=Q.selectedToolIds),"selectedFilterIds"in Q&&t(6,k=Q.selectedFilterIds),"showCommands"in Q&&t(7,I=Q.showCommands),"imageGenerationEnabled"in Q&&t(8,S=Q.imageGenerationEnabled),"codeInterpreterEnabled"in Q&&t(9,M=Q.codeInterpreterEnabled),"webSearchEnabled"in Q&&t(10,N=Q.webSearchEnabled),"onSelect"in Q&&t(16,F=Q.onSelect),"toolServers"in Q&&t(17,H=Q.toolServers)},n.$$.update=()=>{n.$$.dirty[0]&268451840&&t(18,T=p.map(Q=>i.find(ae=>ae.id===Q))),n.$$.dirty[0]&278528&&p.length>0&&t(19,z=T.length-1)},[m,x,w,_,v,C,k,I,S,M,N,d,f,g,p,y,F,H,T,z,s,r,a,o,l,c,h,u,i,R,L,Y,j,J,G,se,de,he,we,ye,P,V,re,X,ue,oe]}class Zoe extends Nt{constructor(e){super(),Ot(this,e,Joe,Yoe,Ut,{transparentBackground:11,createMessagePair:12,stopResponse:13,autoScroll:0,atSelectedModel:1,selectedModels:14,history:15,prompt:2,files:3,messageInput:4,selectedToolIds:5,selectedFilterIds:6,showCommands:7,imageGenerationEnabled:8,codeInterpreterEnabled:9,webSearchEnabled:10,onSelect:16,toolServers:17},null,[-1,-1])}}const{document:Jw}=RI;function Qoe(n){let e,t,i,s;return i=new a4({props:{className:"size-5"}}),{c(){e=ee("div"),t=ee("div"),me(i.$$.fragment),this.h()},l(r){e=te(r,"DIV",{class:!0});var a=q(e);t=te(a,"DIV",{class:!0});var o=q(t);xe(i.$$.fragment,o),o.forEach(E),a.forEach(E),this.h()},h(){A(t,"class","m-auto"),A(e,"class","flex items-center justify-center h-full w-full")},m(r,a){$(r,e,a),K(e,t),pe(i,t,null),s=!0},p:Ct,i(r){s||(U(i.$$.fragment,r),s=!0)},o(r){W(i.$$.fragment,r),s=!1},d(r){r&&E(e),be(i)}}}function $oe(n){var o,l,c;let e,t,i,s,r,a=(((o=n[32])==null?void 0:o.backgroundImageUrl)??((c=(l=n[34])==null?void 0:l.license_metadata)==null?void 0:c.background_image_url)??null)&&SI(n);return i=new _D({props:{direction:"horizontal",class:"w-full h-full",$$slots:{default:[ile]},$$scope:{ctx:n}}}),{c(){e=ee("div"),a&&a.c(),t=Ce(),me(i.$$.fragment),this.h()},l(h){e=te(h,"DIV",{class:!0});var u=q(e);a&&a.l(u),t=Ae(u),xe(i.$$.fragment,u),u.forEach(E),this.h()},h(){A(e,"class","w-full h-full flex flex-col")},m(h,u){$(h,e,u),a&&a.m(e,null),K(e,t),pe(i,e,null),r=!0},p(h,u){var f,g,m;((f=h[32])==null?void 0:f.backgroundImageUrl)??((m=(g=h[34])==null?void 0:g.license_metadata)==null?void 0:m.background_image_url)??null?a?a.p(h,u):(a=SI(h),a.c(),a.m(e,t)):a&&(a.d(1),a=null);const d={};u[0]&2147353591|u[1]&63|u[4]&256&&(d.$$scope={dirty:u,ctx:h}),i.$set(d)},i(h){r||(U(i.$$.fragment,h),h&&(s||s0(()=>{s=Xf(e,Zf,{duration:50}),s.start()})),r=!0)},o(h){W(i.$$.fragment,h),r=!1},d(h){h&&E(e),a&&a.d(),be(i)}}}function SI(n){let e,t,i,s;return{c(){e=ee("div"),i=Ce(),s=ee("div"),this.h()},l(r){e=te(r,"DIV",{class:!0,style:!0}),q(e).forEach(E),i=Ae(r),s=te(r,"DIV",{class:!0}),q(s).forEach(E),this.h()},h(){var r,a,o;A(e,"class",t="absolute "+(n[38]?"md:max-w-[calc(100%-260px)] md:translate-x-[260px]":"")+" top-0 left-0 w-full h-full bg-cover bg-center bg-no-repeat"),nn(e,"background-image","url("+(((r=n[32])==null?void 0:r.backgroundImageUrl)??((o=(a=n[34])==null?void 0:a.license_metadata)==null?void 0:o.background_image_url))+")"),A(s,"class","absolute top-0 left-0 w-full h-full bg-linear-to-t from-white to-white/85 dark:from-gray-900 dark:to-gray-900/90 z-0")},m(r,a){$(r,e,a),$(r,i,a),$(r,s,a)},p(r,a){var o,l,c;a[1]&128&&t!==(t="absolute "+(r[38]?"md:max-w-[calc(100%-260px)] md:translate-x-[260px]":"")+" top-0 left-0 w-full h-full bg-cover bg-center bg-no-repeat")&&A(e,"class",t),a[1]&10&&nn(e,"background-image","url("+(((o=r[32])==null?void 0:o.backgroundImageUrl)??((c=(l=r[34])==null?void 0:l.license_metadata)==null?void 0:c.background_image_url))+")")},d(r){r&&(E(e),E(i),E(s))}}}function ele(n){var N,F,H;let e,t,i,s,r,a,o,l,c,h,u,d,f,g;function m(T){n[84](T)}function x(T){n[85](T)}function p(T){n[86](T)}function y(T){n[87](T)}function w(T){n[88](T)}function _(T){n[89](T)}function v(T){n[90](T)}function C(T){n[91](T)}function k(T){n[92](T)}function I(T){n[93](T)}function S(T){n[94](T)}let M={history:n[23],selectedModels:n[0],transparentBackground:((N=n[32])==null?void 0:N.backgroundImageUrl)??((H=(F=n[34])==null?void 0:F.license_metadata)==null?void 0:H.background_image_url)??!1,toolServers:n[35],stopResponse:n[52],createMessagePair:n[48],onSelect:n[41]};return n[6]!==void 0&&(M.messageInput=n[6]),n[27]!==void 0&&(M.files=n[27]),n[25]!==void 0&&(M.prompt=n[25]),n[7]!==void 0&&(M.autoScroll=n[7]),n[17]!==void 0&&(M.selectedToolIds=n[17]),n[18]!==void 0&&(M.selectedFilterIds=n[18]),n[19]!==void 0&&(M.imageGenerationEnabled=n[19]),n[21]!==void 0&&(M.codeInterpreterEnabled=n[21]),n[20]!==void 0&&(M.webSearchEnabled=n[20]),n[1]!==void 0&&(M.atSelectedModel=n[1]),n[22]!==void 0&&(M.showCommands=n[22]),t=new Zoe({props:M}),It.push(()=>Wt(t,"messageInput",m)),It.push(()=>Wt(t,"files",x)),It.push(()=>Wt(t,"prompt",p)),It.push(()=>Wt(t,"autoScroll",y)),It.push(()=>Wt(t,"selectedToolIds",w)),It.push(()=>Wt(t,"selectedFilterIds",_)),It.push(()=>Wt(t,"imageGenerationEnabled",v)),It.push(()=>Wt(t,"codeInterpreterEnabled",C)),It.push(()=>Wt(t,"webSearchEnabled",k)),It.push(()=>Wt(t,"atSelectedModel",I)),It.push(()=>Wt(t,"showCommands",S)),t.$on("upload",n[95]),t.$on("submit",n[96]),{c(){e=ee("div"),me(t.$$.fragment),this.h()},l(T){e=te(T,"DIV",{class:!0});var z=q(e);xe(t.$$.fragment,z),z.forEach(E),this.h()},h(){A(e,"class","flex items-center h-full")},m(T,z){$(T,e,z),pe(t,e,null),g=!0},p(T,z){var L,Y,j;const R={};z[0]&8388608&&(R.history=T[23]),z[0]&1&&(R.selectedModels=T[0]),z[1]&10&&(R.transparentBackground=((L=T[32])==null?void 0:L.backgroundImageUrl)??((j=(Y=T[34])==null?void 0:Y.license_metadata)==null?void 0:j.background_image_url)??!1),z[1]&16&&(R.toolServers=T[35]),!i&&z[0]&64&&(i=!0,R.messageInput=T[6],qt(()=>i=!1)),!s&&z[0]&134217728&&(s=!0,R.files=T[27],qt(()=>s=!1)),!r&&z[0]&33554432&&(r=!0,R.prompt=T[25],qt(()=>r=!1)),!a&&z[0]&128&&(a=!0,R.autoScroll=T[7],qt(()=>a=!1)),!o&&z[0]&131072&&(o=!0,R.selectedToolIds=T[17],qt(()=>o=!1)),!l&&z[0]&262144&&(l=!0,R.selectedFilterIds=T[18],qt(()=>l=!1)),!c&&z[0]&524288&&(c=!0,R.imageGenerationEnabled=T[19],qt(()=>c=!1)),!h&&z[0]&2097152&&(h=!0,R.codeInterpreterEnabled=T[21],qt(()=>h=!1)),!u&&z[0]&1048576&&(u=!0,R.webSearchEnabled=T[20],qt(()=>u=!1)),!d&&z[0]&2&&(d=!0,R.atSelectedModel=T[1],qt(()=>d=!1)),!f&&z[0]&4194304&&(f=!0,R.showCommands=T[22],qt(()=>f=!1)),t.$set(R)},i(T){g||(U(t.$$.fragment,T),g=!0)},o(T){W(t.$$.fragment,T),g=!1},d(T){T&&E(e),be(t)}}}function tle(n){var we,ye,P;let e,t,i,s,r,a,o,l,c,h,u,d,f,g,m,x,p,y,w,_,v,C="",k,I,S;function M(V){n[65](V)}function N(V){n[66](V)}function F(V){n[67](V)}let H={chatId:n[30],setInputText:n[64],selectedModels:n[0],atSelectedModel:n[1],sendPrompt:n[51],showMessage:n[42],submitMessage:n[53],continueResponse:n[55],regenerateResponse:n[54],mergeResponses:n[56],chatActionHandler:n[47],addMessages:n[49],bottomPadding:n[27].length>0,onSelect:n[41]};n[23]!==void 0&&(H.history=n[23]),n[7]!==void 0&&(H.autoScroll=n[7]),n[25]!==void 0&&(H.prompt=n[25]),i=new _F({props:H}),It.push(()=>Wt(i,"history",M)),It.push(()=>Wt(i,"autoScroll",N)),It.push(()=>Wt(i,"prompt",F));function T(V){n[72](V)}function z(V){n[73](V)}function R(V){n[74](V)}function L(V){n[75](V)}function Y(V){n[76](V)}function j(V){n[77](V)}function J(V){n[78](V)}function G(V){n[79](V)}function se(V){n[80](V)}function de(V){n[81](V)}let he={history:n[23],taskIds:n[24],selectedModels:n[0],toolServers:n[35],transparentBackground:((we=n[32])==null?void 0:we.backgroundImageUrl)??((P=(ye=n[34])==null?void 0:ye.license_metadata)==null?void 0:P.background_image_url)??!1,stopResponse:n[52],createMessagePair:n[48],onChange:n[70]};return n[27]!==void 0&&(he.files=n[27]),n[25]!==void 0&&(he.prompt=n[25]),n[7]!==void 0&&(he.autoScroll=n[7]),n[17]!==void 0&&(he.selectedToolIds=n[17]),n[18]!==void 0&&(he.selectedFilterIds=n[18]),n[19]!==void 0&&(he.imageGenerationEnabled=n[19]),n[21]!==void 0&&(he.codeInterpreterEnabled=n[21]),n[20]!==void 0&&(he.webSearchEnabled=n[20]),n[1]!==void 0&&(he.atSelectedModel=n[1]),n[22]!==void 0&&(he.showCommands=n[22]),c=new bO({props:he}),n[71](c),It.push(()=>Wt(c,"files",T)),It.push(()=>Wt(c,"prompt",z)),It.push(()=>Wt(c,"autoScroll",R)),It.push(()=>Wt(c,"selectedToolIds",L)),It.push(()=>Wt(c,"selectedFilterIds",Y)),It.push(()=>Wt(c,"imageGenerationEnabled",j)),It.push(()=>Wt(c,"codeInterpreterEnabled",J)),It.push(()=>Wt(c,"webSearchEnabled",G)),It.push(()=>Wt(c,"atSelectedModel",se)),It.push(()=>Wt(c,"showCommands",de)),c.$on("upload",n[82]),c.$on("submit",n[83]),{c(){e=ee("div"),t=ee("div"),me(i.$$.fragment),o=Ce(),l=ee("div"),me(c.$$.fragment),_=Ce(),v=ee("div"),v.innerHTML=C,this.h()},l(V){e=te(V,"DIV",{class:!0,id:!0});var re=q(e);t=te(re,"DIV",{class:!0});var X=q(t);xe(i.$$.fragment,X),X.forEach(E),re.forEach(E),o=Ae(V),l=te(V,"DIV",{class:!0});var ue=q(l);xe(c.$$.fragment,ue),_=Ae(ue),v=te(ue,"DIV",{class:!0,"data-svelte-h":!0}),ko(v)!=="svelte-ko82kn"&&(v.innerHTML=C),ue.forEach(E),this.h()},h(){A(t,"class","h-full w-full flex flex-col"),A(e,"class","pb-2.5 flex flex-col justify-between w-full flex-auto overflow-auto h-0 max-w-full z-10 scrollbar-hidden"),A(e,"id","messages-container"),A(v,"class","absolute bottom-1 text-xs text-gray-500 text-center line-clamp-1 right-0 left-0"),A(l,"class","pb-2")},m(V,re){$(V,e,re),K(e,t),pe(i,t,null),n[68](e),$(V,o,re),$(V,l,re),pe(c,l,null),K(l,_),K(l,v),k=!0,I||(S=yt(e,"scroll",n[69]),I=!0)},p(V,re){var oe,Q,ae;const X={};re[0]&1073741824&&(X.chatId=V[30]),re[0]&64&&(X.setInputText=V[64]),re[0]&1&&(X.selectedModels=V[0]),re[0]&2&&(X.atSelectedModel=V[1]),re[0]&134217728&&(X.bottomPadding=V[27].length>0),!s&&re[0]&8388608&&(s=!0,X.history=V[23],qt(()=>s=!1)),!r&&re[0]&128&&(r=!0,X.autoScroll=V[7],qt(()=>r=!1)),!a&&re[0]&33554432&&(a=!0,X.prompt=V[25],qt(()=>a=!1)),i.$set(X);const ue={};re[0]&8388608&&(ue.history=V[23]),re[0]&16777216&&(ue.taskIds=V[24]),re[0]&1&&(ue.selectedModels=V[0]),re[1]&16&&(ue.toolServers=V[35]),re[1]&10&&(ue.transparentBackground=((oe=V[32])==null?void 0:oe.backgroundImageUrl)??((ae=(Q=V[34])==null?void 0:Q.license_metadata)==null?void 0:ae.background_image_url)??!1),re[0]&1610612736&&(ue.onChange=V[70]),!h&&re[0]&134217728&&(h=!0,ue.files=V[27],qt(()=>h=!1)),!u&&re[0]&33554432&&(u=!0,ue.prompt=V[25],qt(()=>u=!1)),!d&&re[0]&128&&(d=!0,ue.autoScroll=V[7],qt(()=>d=!1)),!f&&re[0]&131072&&(f=!0,ue.selectedToolIds=V[17],qt(()=>f=!1)),!g&&re[0]&262144&&(g=!0,ue.selectedFilterIds=V[18],qt(()=>g=!1)),!m&&re[0]&524288&&(m=!0,ue.imageGenerationEnabled=V[19],qt(()=>m=!1)),!x&&re[0]&2097152&&(x=!0,ue.codeInterpreterEnabled=V[21],qt(()=>x=!1)),!p&&re[0]&1048576&&(p=!0,ue.webSearchEnabled=V[20],qt(()=>p=!1)),!y&&re[0]&2&&(y=!0,ue.atSelectedModel=V[1],qt(()=>y=!1)),!w&&re[0]&4194304&&(w=!0,ue.showCommands=V[22],qt(()=>w=!1)),c.$set(ue)},i(V){k||(U(i.$$.fragment,V),U(c.$$.fragment,V),k=!0)},o(V){W(i.$$.fragment,V),W(c.$$.fragment,V),k=!1},d(V){V&&(E(e),E(o),E(l)),be(i),n[68](null),n[71](null),be(c),I=!1,S()}}}function nle(n){let e,t,i,s,r,a,o,l;function c(g){n[63](g)}let h={chat:{id:n[30],chat:{title:n[36],models:n[0],system:n[32].system??void 0,params:n[28],history:n[23],timestamp:Date.now()}},history:n[23],title:n[36],shareEnabled:!!n[23].currentId,initNewChat:n[46],showBanners:!n[22]};n[0]!==void 0&&(h.selectedModels=n[0]),e=new nne({props:h}),n[62](e),It.push(()=>Wt(e,"selectedModels",c));const u=[tle,ele],d=[];function f(g,m){var x;return m[0]&8388608|m[1]&3&&(r=null),r==null&&(r=((x=g[32])==null?void 0:x.landingPageMode)==="chat"&&!g[31]||Da(g[23],g[23].currentId).length>0),r?0:1}return a=f(n,[-1,-1,-1,-1,-1]),o=d[a]=u[a](n),{c(){me(e.$$.fragment),i=Ce(),s=ee("div"),o.c(),this.h()},l(g){xe(e.$$.fragment,g),i=Ae(g),s=te(g,"DIV",{class:!0});var m=q(s);o.l(m),m.forEach(E),this.h()},h(){A(s,"class","flex flex-col flex-auto z-10 w-full @container overflow-auto")},m(g,m){pe(e,g,m),$(g,i,m),$(g,s,m),d[a].m(s,null),l=!0},p(g,m){const x={};m[0]&1350565889|m[1]&34&&(x.chat={id:g[30],chat:{title:g[36],models:g[0],system:g[32].system??void 0,params:g[28],history:g[23],timestamp:Date.now()}}),m[0]&8388608&&(x.history=g[23]),m[1]&32&&(x.title=g[36]),m[0]&8388608&&(x.shareEnabled=!!g[23].currentId),m[0]&4194304&&(x.showBanners=!g[22]),!t&&m[0]&1&&(t=!0,x.selectedModels=g[0],qt(()=>t=!1)),e.$set(x);let p=a;a=f(g,m),a===p?d[a].p(g,m):(bt(),W(d[p],1,1,()=>{d[p]=null}),xt(),o=d[a],o?o.p(g,m):(o=d[a]=u[a](g),o.c()),U(o,1),o.m(s,null))},i(g){l||(U(e.$$.fragment,g),U(o),l=!0)},o(g){W(e.$$.fragment,g),W(o),l=!1},d(g){g&&(E(i),E(s)),n[62](null),be(e,g),d[a].d()}}}function ile(n){var x;let e,t,i,s,r,a,o,l,c;e=new PI({props:{defaultSize:50,class:"h-full flex relative max-w-full flex-col",$$slots:{default:[nle]},$$scope:{ctx:n}}});function h(p){n[99](p)}function u(p){n[100](p)}function d(p){n[101](p)}function f(p){n[102](p)}function g(p){n[103](p)}let m={chatId:n[30],modelId:((x=n[2])==null?void 0:x.at(0))??null,models:n[2].reduce(n[97],[]),submitPrompt:n[50],stopResponse:n[52],showMessage:n[42],eventTarget:n[40]};return n[23]!==void 0&&(m.history=n[23]),n[26]!==void 0&&(m.chatFiles=n[26]),n[28]!==void 0&&(m.params=n[28]),n[27]!==void 0&&(m.files=n[27]),n[4]!==void 0&&(m.pane=n[4]),i=new xoe({props:m}),n[98](i),It.push(()=>Wt(i,"history",h)),It.push(()=>Wt(i,"chatFiles",u)),It.push(()=>Wt(i,"params",d)),It.push(()=>Wt(i,"files",f)),It.push(()=>Wt(i,"pane",g)),{c(){me(e.$$.fragment),t=Ce(),me(i.$$.fragment)},l(p){xe(e.$$.fragment,p),t=Ae(p),xe(i.$$.fragment,p)},m(p,y){pe(e,p,y),$(p,t,y),pe(i,p,y),c=!0},p(p,y){var v;const w={};y[0]&2080244675|y[1]&59|y[4]&256&&(w.$$scope={dirty:y,ctx:p}),e.$set(w);const _={};y[0]&1073741824&&(_.chatId=p[30]),y[0]&4&&(_.modelId=((v=p[2])==null?void 0:v.at(0))??null),y[0]&4|y[1]&4&&(_.models=p[2].reduce(p[97],[])),!s&&y[0]&8388608&&(s=!0,_.history=p[23],qt(()=>s=!1)),!r&&y[0]&67108864&&(r=!0,_.chatFiles=p[26],qt(()=>r=!1)),!a&&y[0]&268435456&&(a=!0,_.params=p[28],qt(()=>a=!1)),!o&&y[0]&134217728&&(o=!0,_.files=p[27],qt(()=>o=!1)),!l&&y[0]&16&&(l=!0,_.pane=p[4],qt(()=>l=!1)),i.$set(_)},i(p){c||(U(e.$$.fragment,p),U(i.$$.fragment,p),c=!0)},o(p){W(e.$$.fragment,p),W(i.$$.fragment,p),c=!1},d(p){p&&E(t),be(e,p),n[98](null),be(i,p)}}}function sle(n){let e,t,i,s,r,a,o,l,c,h,u,d,f;Jw.title=e=`
		`+(n[36]?`${n[36].length>30?`${n[36].slice(0,30)}...`:n[36]} • ${n[37]}`:`${n[37]}`)+`
	`;function g(w){n[59](w)}let m={title:n[11],message:n[12],input:n[13],inputPlaceholder:n[14],inputValue:n[15]};n[10]!==void 0&&(m.show=n[10]),a=new jI({props:m}),It.push(()=>Wt(a,"show",g)),a.$on("confirm",n[60]),a.$on("cancel",n[61]);const x=[$oe,Qoe],p=[];function y(w,_){return w[3]?w[3]?1:-1:0}return~(h=y(n))&&(u=p[h]=x[h](n)),{c(){t=Ce(),i=ee("audio"),r=Ce(),me(a.$$.fragment),l=Ce(),c=ee("div"),u&&u.c(),this.h()},l(w){lD("svelte-5280jy",Jw.head).forEach(E),t=Ae(w),i=te(w,"AUDIO",{id:!0,src:!0,style:!0}),q(i).forEach(E),r=Ae(w),xe(a.$$.fragment,w),l=Ae(w),c=te(w,"DIV",{class:!0,id:!0});var v=q(c);u&&u.l(v),v.forEach(E),this.h()},h(){A(i,"id","audioElement"),b0(i.src,s="")||A(i,"src",s),nn(i,"display","none"),A(c,"class",d="h-screen max-h-[100dvh] transition-width duration-200 ease-in-out "+(n[38]?"  md:max-w-[calc(100%-260px)]":" ")+" w-full max-w-full flex flex-col"),A(c,"id","chat-container")},m(w,_){$(w,t,_),$(w,i,_),$(w,r,_),pe(a,w,_),$(w,l,_),$(w,c,_),~h&&p[h].m(c,null),f=!0},p(w,_){(!f||_[1]&96)&&e!==(e=`
		`+(w[36]?`${w[36].length>30?`${w[36].slice(0,30)}...`:w[36]} • ${w[37]}`:`${w[37]}`)+`
	`)&&(Jw.title=e);const v={};_[0]&2048&&(v.title=w[11]),_[0]&4096&&(v.message=w[12]),_[0]&8192&&(v.input=w[13]),_[0]&16384&&(v.inputPlaceholder=w[14]),_[0]&32768&&(v.inputValue=w[15]),!o&&_[0]&1024&&(o=!0,v.show=w[10],qt(()=>o=!1)),a.$set(v);let C=h;h=y(w),h===C?~h&&p[h].p(w,_):(u&&(bt(),W(p[C],1,1,()=>{p[C]=null}),xt()),~h?(u=p[h],u?u.p(w,_):(u=p[h]=x[h](w),u.c()),U(u,1),u.m(c,null)):u=null),(!f||_[1]&128&&d!==(d="h-screen max-h-[100dvh] transition-width duration-200 ease-in-out "+(w[38]?"  md:max-w-[calc(100%-260px)]":" ")+" w-full max-w-full flex flex-col"))&&A(c,"class",d)},i(w){f||(U(a.$$.fragment,w),U(u),f=!0)},o(w){W(a.$$.fragment,w),W(u),f=!1},d(w){w&&(E(t),E(i),E(r),E(l),E(c)),be(a,w),~h&&p[h].d()}}}function rle(n,e,t){let i,s,r,a,o,l,c,h,u,d,f,g,m,x,p,y,w,_;Pe(n,kl,ne=>t(107,i=ne)),Pe(n,Fd,ne=>t(29,s=ne)),Pe(n,uu,ne=>t(30,r=ne)),Pe(n,Jf,ne=>t(31,a=ne)),Pe(n,Ga,ne=>t(32,o=ne)),Pe(n,Xg,ne=>t(33,c=ne)),Pe(n,ID,ne=>t(109,h=ne)),Pe(n,k0,ne=>t(110,u=ne)),Pe(n,Kg,ne=>t(34,d=ne)),Pe(n,NI,ne=>t(35,f=ne)),Pe(n,Ba,ne=>t(111,g=ne)),Pe(n,lv,ne=>t(112,m=ne)),Pe(n,nx,ne=>t(113,x=ne)),Pe(n,Gd,ne=>t(114,p=ne)),Pe(n,Tx,ne=>t(36,y=ne)),Pe(n,OI,ne=>t(37,w=ne)),Pe(n,$w,ne=>t(38,_=ne));const v=as("i18n");Pe(n,v,ne=>t(108,l=ne));let{chatIdProp:C=""}=e,k=!0;const I=new EventTarget;let S,M,N,F=!0,H,T,z=!1,R="",L="",Y=!1,j="",J="",G=null,se=[""],de,he=[],we=[],ye=[],P=!1,V=!1,re=!1,X=!1,ue=null,oe={messages:{},currentId:null},Q=null,ae="",Ke=[],Ue=[],De={};const je=async()=>{t(3,k=!0),t(25,ae=""),N==null||N.setText(""),t(27,Ue=[]),t(17,we=[]),t(18,ye=[]),t(20,V=!1),t(19,P=!1);const ne=sessionStorage.getItem(`chat-input${C?`-${C}`:""}`);if(C&&await Lt()){if(await hn(),t(3,k=!1),window.setTimeout(()=>dt(),0),await hn(),ne)try{const Ee=JSON.parse(ne);s||(N==null||N.setText(Ee.prompt),t(27,Ue=Ee.files),t(17,we=Ee.selectedToolIds),t(18,ye=Ee.selectedFilterIds),t(20,V=Ee.webSearchEnabled),t(19,P=Ee.imageGenerationEnabled),t(21,re=Ee.codeInterpreterEnabled))}catch{}const Re=document.getElementById("chat-input");Re==null||Re.focus()}else await ov("/")},ze=async ne=>{const{type:Re,data:Ee}=ne;Re==="prompt"&&(N==null||N.setText(Ee))},Qe=()=>{se.length===0||se.length===1&&se[0]===""||(sessionStorage.selectedModels=JSON.stringify(se),sessionStorage.selectedModels)};let ft=[""];const ut=()=>{ft.filter(ne=>ne).length>0&&Je(),t(58,ft=he)},Je=()=>{rt(),t(18,ye=[]),t(20,V=!1),t(19,P=!1),t(21,re=!1)},rt=async()=>{var Re,Ee,it,We;if(p||Gd.set(await n4(localStorage.token)),se.length!==1&&!de)return;const ne=de??c.find(Le=>Le.id===se[0]);ne&&((Ee=(Re=ne==null?void 0:ne.info)==null?void 0:Re.meta)!=null&&Ee.toolIds)?t(17,we=[...new Set([...((We=(it=ne==null?void 0:ne.info)==null?void 0:it.meta)==null?void 0:We.toolIds)??[]].filter(Le=>p.find(Ye=>Ye.id===Le)))]):t(17,we=[])},ge=async ne=>{await hn();const Re=JSON.parse(JSON.stringify(r));let Ee=JSON.parse(JSON.stringify(ne.id)),it=[];for(Ee===null?it=Object.keys(oe.messages).filter(We=>oe.messages[We].parentId===null):it=oe.messages[Ee].childrenIds;it.length!==0;)Ee=it.at(-1),it=oe.messages[Ee].childrenIds;if(t(23,oe.currentId=Ee,oe),await hn(),await hn(),await hn(),(o==null?void 0:o.scrollOnBranchChange)??!0){const We=document.getElementById(`message-${ne.id}`);We&&We.scrollIntoView({behavior:"smooth"})}await hn(),Xt(Re,oe)},Pt=async(ne,Re)=>{var Ee,it;if(ne.chat_id===r){await hn();let We=oe.messages[ne.message_id];if(We){const Le=((Ee=ne==null?void 0:ne.data)==null?void 0:Ee.type)??null,Ye=((it=ne==null?void 0:ne.data)==null?void 0:it.data)??null;if(Le==="status")We!=null&&We.statusHistory?We.statusHistory.push(Ye):We.statusHistory=[Ye];else if(Le==="chat:completion")ws(Ye,We,ne.chat_id);else if(Le==="chat:message:delta"||Le==="message")We.content+=Ye.content;else if(Le==="chat:message"||Le==="replace")We.content=Ye.content;else if(Le==="chat:message:files"||Le==="files")We.files=Ye.files;else if(Le==="chat:message:follow_ups")We.followUps=Ye.follow_ups,F&&dt("smooth");else if(Le==="chat:title")Tx.set(Ye),kl.set(1),await mc.set(await T0(localStorage.token,i));else if(Le==="chat:tags")ue=await e8(localStorage.token,r),ED.set(await KD(localStorage.token));else if(Le==="source"||Le==="citation")if((Ye==null?void 0:Ye.type)==="code_execution"){We!=null&&We.code_executions||(We.code_executions=[]);const At=We.code_executions.findIndex(Mt=>Mt.id===Ye.id);At!==-1?We.code_executions[At]=Ye:We.code_executions.push(Ye),We.code_executions=We.code_executions}else We!=null&&We.sources?We.sources.push(Ye):We.sources=[Ye];else if(Le==="notification"){const At=(Ye==null?void 0:Ye.type)??"info",Mt=(Ye==null?void 0:Ye.content)??"";At==="success"?Jt.success(Mt):At==="error"?Jt.error(Mt):At==="warning"?Jt.warning(Mt):Jt.info(Mt)}else if(Le==="confirmation")t(16,G=Re),t(13,Y=!1),t(10,z=!0),t(11,R=Ye.title),t(12,L=Ye.message);else if(Le==="execute"){t(16,G=Re);try{const Mt=await new Function(`return (async () => { ${Ye.code} })()`)();Re&&Re(Mt)}catch(At){console.error("Error executing code:",At)}}else Le==="input"&&(t(16,G=Re),t(13,Y=!0),t(10,z=!0),t(11,R=Ye.title),t(12,L=Ye.message),t(14,j=Ye.placeholder),t(15,J=(Ye==null?void 0:Ye.value)??""));t(23,oe.messages[ne.message_id]=We,oe)}}},lt=async ne=>{if(ne.origin===window.origin){if(ne.data.type==="input:prompt"){ne.data.text;const Re=document.getElementById("chat-input");Re&&(N==null||N.setText(ne.data.text),Re.focus())}ne.data.type==="action:submit"&&(ne.data.text,ae!==""&&(await hn(),ui(ae))),ne.data.type==="input:prompt:submit"&&(ne.data.text,ne.data.text!==""&&(await hn(),ui(ne.data.text)))}};let ct=null;ol(async()=>{t(3,k=!0),window.addEventListener("message",lt),h==null||h.on("chat-events",Pt),ct=lv.subscribe(async Ee=>{Ee.url.pathname==="/"&&(await hn(),Me())});const ne=sessionStorage.getItem(`chat-input${C?`-${C}`:""}`);if(C||(t(3,k=!1),await hn()),ne){t(25,ae=""),N==null||N.setText(""),t(27,Ue=[]),t(17,we=[]),t(18,ye=[]),t(20,V=!1),t(19,P=!1),t(21,re=!1);try{const Ee=JSON.parse(ne);s||(N==null||N.setText(Ee.prompt),t(27,Ue=Ee.files),t(17,we=Ee.selectedToolIds),t(18,ye=Ee.selectedFilterIds),t(20,V=Ee.webSearchEnabled),t(19,P=Ee.imageGenerationEnabled),t(21,re=Ee.codeInterpreterEnabled))}catch{}}Xi.subscribe(async Ee=>{if(S&&!x)try{Ee?M.openPane():S.collapse()}catch{}Ee||(Ba.set(!1),r0.set(!1),Zl.set(!1))});const Re=document.getElementById("chat-input");Re==null||Re.focus(),mc.subscribe(()=>{})}),Kh(()=>{ct(),window.removeEventListener("message",lt),h==null||h.off("chat-events",Pt)});const Ge=async ne=>{var it,We,Le,Ye,At,Mt;if(ne.id,ne.name,ne.url,`${token}`,!(ne!=null&&ne.id)||!(ne!=null&&ne.name)||!(ne!=null&&ne.url)||!((it=ne==null?void 0:ne.headers)!=null&&it.Authorization))throw new Error("Invalid file data provided");const Re=Cl(),Ee={type:"file",file:"",id:null,url:ne.url,name:ne.name,collection_name:"",status:"uploading",error:"",itemId:Re,size:0};try{t(27,Ue=[...Ue,Ee]),ne.url;const En={headers:{Authorization:ne.headers.Authorization,Accept:"*/*"},method:"GET"},xn=await fetch(ne.url,En);if(!xn.ok){const Ao=await xn.text();throw new Error(`Failed to fetch file (${xn.status}): ${Ao}`)}const cn=xn.headers.get("content-type")||"application/octet-stream",ii=await xn.blob();if(ii.size===0)throw new Error("Retrieved file is empty");ii.size,ii.type;const Ai=new File([ii],ne.name,{type:ii.type||cn});if(Ai.name,Ai.size,Ai.type,Ai.size===0)throw new Error("Created file is empty");let mr=null;(Ai.type.startsWith("audio/")||Ai.type.startsWith("video/"))&&((Le=(We=o==null?void 0:o.audio)==null?void 0:We.stt)!=null&&Le.language)&&(mr={language:(At=(Ye=o==null?void 0:o.audio)==null?void 0:Ye.stt)==null?void 0:At.language});const cs=await uploadFile(localStorage.token,Ai,mr);if(!cs)throw new Error("Server returned null response for file upload");Ee.status="uploaded",Ee.file=cs,Ee.id=cs.id,Ee.size=Ai.size,Ee.collection_name=(Mt=cs==null?void 0:cs.meta)==null?void 0:Mt.collection_name,Ee.url=`${WEBUI_API_BASE_URL}/files/${cs.id}`,t(27,Ue),Jt.success(l.t("File uploaded successfully"))}catch(En){console.error("Error uploading file:",En),t(27,Ue=Ue.filter(xn=>xn.itemId!==Re)),Jt.error(l.t("Error uploading file: {{error}}",{error:En.message||"Unknown error"}))}},Ft=async ne=>{const Re={type:"doc",name:ne,collection_name:"",status:"uploading",url:ne,error:""};try{t(27,Ue=[...Ue,Re]);const Ee=await JD(localStorage.token,"",ne);Ee&&(Re.status="uploaded",Re.collection_name=Ee.collection_name,Re.file={...Ee.file,...Re.file},t(27,Ue))}catch(Ee){t(27,Ue=Ue.filter(it=>it.name!==ne)),Jt.error(JSON.stringify(Ee))}},sn=async ne=>{const Re={type:"doc",name:ne,collection_name:"",status:"uploading",context:"full",url:ne,error:""};try{t(27,Ue=[...Ue,Re]);const Ee=await ZD(localStorage.token,ne);Ee&&(Re.status="uploaded",Re.collection_name=Ee.collection_name,Re.file={...Ee.file,...Re.file},t(27,Ue))}catch(Ee){t(27,Ue=Ue.filter(it=>it.name!==ne)),Jt.error(`${Ee}`)}},Me=async()=>{var it,We,Le,Ye,At;(u==null?void 0:u.role)!=="admin"&&((We=(it=u==null?void 0:u.permissions)==null?void 0:it.chat)!=null&&We.temporary_enforced)&&await Fd.set(!0);const ne=c.filter(Mt=>{var En,xn;return!(((xn=(En=Mt==null?void 0:Mt.info)==null?void 0:En.meta)==null?void 0:xn.hidden)??!1)}).map(Mt=>Mt.id);if(m.url.searchParams.get("models")||m.url.searchParams.get("model")){const Mt=(Le=m.url.searchParams.get("models")||m.url.searchParams.get("model")||"")==null?void 0:Le.split(",");if(Mt.length===1)if(c.find(xn=>xn.id===Mt[0]))t(0,se=Mt);else{const xn=document.getElementById("model-selector-0-button");if(xn){xn.click(),await hn();const cn=document.getElementById("model-search-input");cn&&(cn.focus(),cn.value=Mt[0],cn.dispatchEvent(new Event("input")))}}else t(0,se=Mt);t(0,se=se.filter(En=>c.map(xn=>xn.id).includes(En)))}else sessionStorage.selectedModels?(t(0,se=JSON.parse(sessionStorage.selectedModels)),sessionStorage.removeItem("selectedModels")):o!=null&&o.models?t(0,se=o==null?void 0:o.models):d!=null&&d.default_models&&(d==null||d.default_models.split(","),t(0,se=d==null?void 0:d.default_models.split(","))),t(0,se=se.filter(Mt=>ne.includes(Mt)));if((se.length===0||se.length===1&&se[0]==="")&&(ne.length>0?t(0,se=[(ne==null?void 0:ne.at(0))??""]):t(0,se=[""])),await Xi.set(!1),await Ba.set(!1),await r0.set(!1),await Zl.set(!1),m.url.pathname.includes("/c/")&&window.history.replaceState(oe.state,"","/"),t(7,F=!0),Je(),await uu.set(""),await Tx.set(""),t(23,oe={messages:{},currentId:null}),t(26,Ke=[]),t(28,De={}),m.url.searchParams.get("youtube")&&sn(`https://www.youtube.com/watch?v=${m.url.searchParams.get("youtube")}`),m.url.searchParams.get("load-url")&&await Ft(m.url.searchParams.get("load-url")),m.url.searchParams.get("web-search")==="true"&&t(20,V=!0),m.url.searchParams.get("image-generation")==="true"&&t(19,P=!0),m.url.searchParams.get("code-interpreter")==="true"&&t(21,re=!0),m.url.searchParams.get("tools")?t(17,we=(Ye=m.url.searchParams.get("tools"))==null?void 0:Ye.split(",").map(Mt=>Mt.trim()).filter(Mt=>Mt)):m.url.searchParams.get("tool-ids")&&t(17,we=(At=m.url.searchParams.get("tool-ids"))==null?void 0:At.split(",").map(Mt=>Mt.trim()).filter(Mt=>Mt)),m.url.searchParams.get("call")==="true"&&(Ba.set(!0),Xi.set(!0)),m.url.searchParams.get("q")){const Mt=m.url.searchParams.get("q")??"";N==null||N.setText(Mt),Mt&&(m.url.searchParams.get("submit")??"true")==="true"&&(await hn(),ui(Mt))}t(0,se=se.map(Mt=>c.map(En=>En.id).includes(Mt)?Mt:""));const Re=await fv(localStorage.token);Re?Ga.set(Re.ui):Ga.set(JSON.parse(localStorage.getItem("settings")??"{}"));const Ee=document.getElementById("chat-input");setTimeout(()=>Ee==null?void 0:Ee.focus(),0)},Lt=async()=>{var ne,Re;if(uu.set(C),s&&Fd.set(!1),ue=await e8(localStorage.token,r).catch(async Ee=>(await ov("/"),null)),ue){await XD(localStorage.token,r).catch(async it=>[]);const Ee=ue.chat;if(Ee){t(0,se=((Ee==null?void 0:Ee.models)??void 0)!==void 0?Ee.models:[Ee.models??""]),(u==null?void 0:u.role)==="admin"||(((Re=(ne=u==null?void 0:u.permissions)==null?void 0:ne.chat)==null?void 0:Re.multiple_models)??!0)||t(0,se=se.length>0?[se[0]]:[""]),t(58,ft=se),t(23,oe=((Ee==null?void 0:Ee.history)??void 0)!==void 0?Ee.history:VD(Ee.messages)),Tx.set(Ee.title);const it=await fv(localStorage.token);if(it?await Ga.set(it.ui):await Ga.set(JSON.parse(localStorage.getItem("settings")??"{}")),t(28,De=(Ee==null?void 0:Ee.params)??{}),t(26,Ke=(Ee==null?void 0:Ee.files)??[]),t(7,F=!0),await hn(),oe.currentId)for(const Le of Object.values(oe.messages))Le.role==="assistant"&&(Le.done=!0);const We=await eF(localStorage.token,r).catch(Le=>null);return We&&t(24,Q=We.task_ids),await hn(),!0}else return null}},dt=async(ne="auto")=>{await hn(),H&&H.scrollTo({top:H.scrollHeight,behavior:ne})},Vt=async(ne,Re,Ee,it)=>{const We=await sF(localStorage.token,{model:Re,messages:it.map(Le=>({id:Le.id,role:Le.role,content:Le.content,info:Le.info?Le.info:void 0,timestamp:Le.timestamp,...Le.usage?{usage:Le.usage}:{},...Le.sources?{sources:Le.sources}:{}})),filter_ids:ye.length>0?ye:void 0,model_item:c.find(Le=>Le.id===Re),chat_id:ne,session_id:h==null?void 0:h.id,id:Ee}).catch(Le=>(Jt.error(`${Le}`),it.at(-1).error={content:Le},null));if(We!==null&&We.messages)for(const Le of We.messages)Le!=null&&Le.id&&t(23,oe.messages[Le.id]={...oe.messages[Le.id],...oe.messages[Le.id].content!==Le.content?{originalContent:oe.messages[Le.id].content}:{},...Le},oe);await hn(),r==ne&&(s||(ue=await nw(localStorage.token,ne,{models:se,messages:it,history:oe,params:De,files:Ke}),kl.set(1),await mc.set(await T0(localStorage.token,i)))),t(24,Q=null)},Ln=async(ne,Re,Ee,it,We=null)=>{const Le=Da(oe,it),Ye=await tF(localStorage.token,Re,{model:Ee,messages:Le.map(At=>({id:At.id,role:At.role,content:At.content,info:At.info?At.info:void 0,timestamp:At.timestamp,...At.sources?{sources:At.sources}:{}})),...We?{event:We}:{},model_item:c.find(At=>At.id===Ee),chat_id:ne,session_id:h==null?void 0:h.id,id:it}).catch(At=>(Jt.error(`${At}`),Le.at(-1).error={content:At},null));if(Ye!==null&&Ye.messages)for(const At of Ye.messages)t(23,oe.messages[At.id]={...oe.messages[At.id],...oe.messages[At.id].content!==At.content?{originalContent:oe.messages[At.id].content}:{},...At},oe);r==ne&&(s||(ue=await nw(localStorage.token,ne,{models:se,messages:Le,history:oe,params:De,files:Ke}),kl.set(1),await mc.set(await T0(localStorage.token,i))))},Wn=async(ne,Re="")=>setInterval(()=>{h==null||h.emit("usage",{action:"chat",model:ne,chat_id:Re})},1e3),hi=async ne=>{if(N==null||N.setText(""),se.length===0)Jt.error(l.t("Model not selected"));else{const Re=se[0],Ee=c.filter(En=>En.id===Re).at(0),it=Da(oe,oe.currentId),We=it.length!==0?it.at(-1):null,Le=Cl(),Ye=Cl(),At={id:Le,parentId:We?We.id:null,childrenIds:[Ye],role:"user",content:ne||`[PROMPT] ${Le}`,timestamp:Math.floor(Date.now()/1e3)},Mt={id:Ye,parentId:Le,childrenIds:[],role:"assistant",content:`[RESPONSE] ${Ye}`,done:!0,model:Re,modelName:Ee.name??Ee.id,modelIdx:0,timestamp:Math.floor(Date.now()/1e3)};We&&(We.childrenIds.push(Le),t(23,oe.messages[We.id]=We,oe)),t(23,oe.messages[Le]=At,oe),t(23,oe.messages[Ye]=Mt,oe),t(23,oe.currentId=Ye,oe),await hn(),F&&dt(),it.length===0?await ht(oe):await Xt(r,oe)}},Gi=async({modelId:ne,parentId:Re,messages:Ee})=>{const it=c.filter(Ye=>Ye.id===ne).at(0);let We=oe.messages[Re],Le=We?We.id:null;for(const Ye of Ee){let At=Cl();if(Ye.role==="user"){const Mt={id:At,parentId:Le,childrenIds:[],timestamp:Math.floor(Date.now()/1e3),...Ye};We&&(We.childrenIds.push(At),t(23,oe.messages[We.id]=We,oe)),t(23,oe.messages[At]=Mt,oe),We=Mt,Le=At}else{const Mt={id:At,parentId:Le,childrenIds:[],done:!0,model:it.id,modelName:it.name??it.id,modelIdx:0,timestamp:Math.floor(Date.now()/1e3),...Ye};We&&(We.childrenIds.push(At),t(23,oe.messages[We.id]=We,oe)),t(23,oe.messages[At]=Mt,oe),We=Mt,Le=At}}t(23,oe.currentId=Le,oe),await hn(),F&&dt(),Ee.length===0?await ht(oe):await Xt(r,oe)},ws=async(ne,Re,Ee)=>{var cn,ii,Ai,mr,cs,Ao,fl,C0,Yh,A0,Jh,pm,bm,xm;const{id:it,done:We,choices:Le,content:Ye,sources:At,selected_model_id:Mt,error:En,usage:xn}=ne;if(En&&await Ci(En,Re),At&&!(Re!=null&&Re.sources)&&(Re.sources=At),Le)if((ii=(cn=Le[0])==null?void 0:cn.message)!=null&&ii.content)Re.content+=(mr=(Ai=Le[0])==null?void 0:Ai.message)==null?void 0:mr.content;else{let Ys=((Ao=(cs=Le[0])==null?void 0:cs.delta)==null?void 0:Ao.content)??"";if(!(Re.content==""&&Ys==`
`)){Re.content+=Ys,navigator.vibrate&&((o==null?void 0:o.hapticFeedback)??!1)&&navigator.vibrate(5);const So=ew(tw(Re.content),((C0=(fl=d==null?void 0:d.audio)==null?void 0:fl.tts)==null?void 0:C0.split_on)??"punctuation");So.pop(),So.length>0&&So[So.length-1]!==Re.lastSentence&&(Re.lastSentence=So[So.length-1],I.dispatchEvent(new CustomEvent("chat",{detail:{id:Re.id,content:So[So.length-1]}})))}}if(Ye){Re.content=Ye,navigator.vibrate&&((o==null?void 0:o.hapticFeedback)??!1)&&navigator.vibrate(5);const Ys=ew(tw(Re.content),((A0=(Yh=d==null?void 0:d.audio)==null?void 0:Yh.tts)==null?void 0:A0.split_on)??"punctuation");Ys.pop(),Ys.length>0&&Ys[Ys.length-1]!==Re.lastSentence&&(Re.lastSentence=Ys[Ys.length-1],I.dispatchEvent(new CustomEvent("chat",{detail:{id:Re.id,content:Ys[Ys.length-1]}})))}if(Mt&&(Re.selectedModelId=Mt,Re.arena=!0),xn&&(Re.usage=xn),t(23,oe.messages[Re.id]=Re,oe),We){Re.done=!0,o.responseAutoCopy&&t4(Re.content),o.responseAutoPlayback&&!g&&(await hn(),(Jh=document.getElementById(`speak-button-${Re.id}`))==null||Jh.click());let Ys=((xm=ew(tw(Re.content),((bm=(pm=d==null?void 0:d.audio)==null?void 0:pm.tts)==null?void 0:bm.split_on)??"punctuation"))==null?void 0:xm.at(-1))??"";Ys&&I.dispatchEvent(new CustomEvent("chat",{detail:{id:Re.id,content:Ys}})),I.dispatchEvent(new CustomEvent("chat:finish",{detail:{id:Re.id,content:Re.content}})),t(23,oe.messages[Re.id]=Re,oe),await hn(),F&&dt(),await Vt(Ee,Re.model,Re.id,Da(oe,Re.id))}await hn(),F&&dt()},ui=async(ne,{_raw:Re=!1}={})=>{var Mt,En,xn;const Ee=Da(oe,oe.currentId),it=se.map(cn=>c.map(ii=>ii.id).includes(cn)?cn:"");if(JSON.stringify(se)!==JSON.stringify(it)&&t(0,se=it),ne===""&&Ue.length===0){Jt.error(l.t("Please enter a prompt"));return}if(se.includes("")){Jt.error(l.t("Model not selected"));return}if(Ee.length!=0&&Ee.at(-1).done!=!0)return;if(Ee.length!=0&&Ee.at(-1).error&&!Ee.at(-1).content){Jt.error(l.t("Oops! There was an error in the previous response."));return}if(Ue.length>0&&Ue.filter(cn=>cn.type!=="image"&&cn.status==="uploading").length>0){Jt.error(l.t("Oops! There are files still uploading. Please wait for the upload to complete."));return}if((((Mt=d==null?void 0:d.file)==null?void 0:Mt.max_count)??null)!==null&&Ue.length+Ke.length>((En=d==null?void 0:d.file)==null?void 0:En.max_count)){Jt.error(l.t("You can only chat with a maximum of {{maxCount}} file(s) at a time.",{maxCount:(xn=d==null?void 0:d.file)==null?void 0:xn.max_count}));return}if(N==null||N.setText(""),!((o==null?void 0:o.richTextInput)??!0)){const cn=document.getElementById("chat-input");cn&&(await hn(),cn.style.height="")}const We=JSON.parse(JSON.stringify(Ue));Ke.push(...We.filter(cn=>["doc","file","collection"].includes(cn.type))),t(26,Ke=Ke.filter((cn,ii,Ai)=>Ai.findIndex(mr=>JSON.stringify(mr)===JSON.stringify(cn))===ii)),t(27,Ue=[]),N==null||N.setText("");let Le=Cl(),Ye={id:Le,parentId:Ee.length!==0?Ee.at(-1).id:null,childrenIds:[],role:"user",content:ne,files:We.length>0?We:void 0,timestamp:Math.floor(Date.now()/1e3),models:se};t(23,oe.messages[Le]=Ye,oe),t(23,oe.currentId=Le,oe),Ee.length!==0&&oe.messages[Ee.at(-1).id].childrenIds.push(Le);const At=document.getElementById("chat-input");At==null||At.focus(),Qe(),await Wi(oe,ne,Le,{newChat:!0})},Wi=async(ne,Re,Ee,{modelId:it=null,modelIdx:We=null,newChat:Le=!1}={})=>{F&&dt();let Ye=JSON.parse(JSON.stringify(r));ne=JSON.parse(JSON.stringify(ne));const At={};let Mt=it?[it]:de!==void 0?[de.id]:se;for(const[En,xn]of Mt.entries()){const cn=c.filter(ii=>ii.id===xn).at(0);if(cn){let ii=Cl(),Ai={parentId:Ee,id:ii,childrenIds:[],role:"assistant",content:"",model:cn.id,modelName:cn.name??cn.id,modelIdx:We||En,timestamp:Math.floor(Date.now()/1e3)};t(23,oe.messages[ii]=Ai,oe),t(23,oe.currentId=ii,oe),Ee!==null&&oe.messages[Ee]&&t(23,oe.messages[Ee].childrenIds=[...oe.messages[Ee].childrenIds,ii],oe),At[`${xn}-${We||En}`]=ii}}t(23,oe),Le&&ne.messages[ne.currentId].parentId===null&&(Ye=await ht(ne)),await hn(),ne=JSON.parse(JSON.stringify(oe)),await Xt(Ye,ne),await Promise.all(Mt.map(async(En,xn)=>{var ii,Ai,mr;const cn=c.filter(cs=>cs.id===En).at(0);if(cn){Da(ne,Ee).some(Yh=>{var A0;return(A0=Yh.files)==null?void 0:A0.some(Jh=>Jh.type==="image")})&&!(((mr=(Ai=(ii=cn.info)==null?void 0:ii.meta)==null?void 0:Ai.capabilities)==null?void 0:mr.vision)??!0)&&Jt.error(l.t("Model {{modelName}} is not vision capable",{modelName:cn.name??cn.id}));let fl=At[`${En}-${We||xn}`];const C0=await Wn(cn.id,Ye);dt(),await _s(ne,cn,fl),C0&&clearInterval(C0)}else Jt.error(l.t("Model {{modelId}} not found",{modelId:En}))})),kl.set(1),mc.set(await T0(localStorage.token,i))},_s=async(ne,Re,Ee,it)=>{var ii,Ai,mr,cs,Ao,fl,C0,Yh,A0,Jh,pm,bm,xm,Ys,So,Z_,Q_,$_,ev;const We=Da(oe,oe.currentId),Le=ne.messages[Ee],Ye=ne.messages[Le.parentId],At=We.filter(fn=>fn.files).flatMap(fn=>fn.files);t(26,Ke=Ke.filter(fn=>At.some(Sx=>Sx.id===fn.id)));let Mt=JSON.parse(JSON.stringify(Ke));Mt.push(...((Ye==null?void 0:Ye.files)??[]).filter(fn=>["doc","text","file","note","collection"].includes(fn.type))),Mt=Mt.filter((fn,hf,Sx)=>Sx.findIndex(Ix=>JSON.stringify(Ix)===JSON.stringify(fn))===hf),dt(),I.dispatchEvent(new CustomEvent("chat:start",{detail:{id:Ee}})),await hn();const En=((Ai=(ii=Re==null?void 0:Re.info)==null?void 0:ii.params)==null?void 0:Ai.stream_response)??((mr=o==null?void 0:o.params)==null?void 0:mr.stream_response)??(De==null?void 0:De.stream_response)??!0;let xn=[De!=null&&De.system||o.system?{role:"system",content:`${zD((De==null?void 0:De.system)??(o==null?void 0:o.system)??"",u==null?void 0:u.name,o!=null&&o.userLocation?await gv(localStorage.token).catch(fn=>{console.error(fn)}):void 0)}`}:void 0,...Da(ne,Ee).map(fn=>({...fn,content:jD(fn.content)}))].filter(fn=>fn);xn=xn.map((fn,hf,Sx)=>{var Ix,tv,nv;return{role:fn.role,...((Ix=fn.files)==null?void 0:Ix.filter(ym=>ym.type==="image").length)>0&&fn.role==="user"?{content:[{type:"text",text:((tv=fn==null?void 0:fn.merged)==null?void 0:tv.content)??fn.content},...fn.files.filter(ym=>ym.type==="image").map(ym=>({type:"image_url",image_url:{url:ym.url}}))]}:{content:((nv=fn==null?void 0:fn.merged)==null?void 0:nv.content)??fn.content}}}).filter(fn=>{var hf;return(fn==null?void 0:fn.role)==="user"||((hf=fn==null?void 0:fn.content)==null?void 0:hf.trim())});const cn=await YD(localStorage.token,{stream:En,model:Re.id,messages:xn,params:{...o==null?void 0:o.params,...De,stop:(De==null?void 0:De.stop)??((cs=o==null?void 0:o.params)==null?void 0:cs.stop)??void 0?((De==null?void 0:De.stop.split(",").map(fn=>fn.trim()))??o.params.stop).map(fn=>decodeURIComponent(JSON.parse('"'+fn.replace(/\"/g,'\\"')+'"'))):void 0},files:((Mt==null?void 0:Mt.length)??0)>0?Mt:void 0,filter_ids:ye.length>0?ye:void 0,tool_ids:we.length>0?we:void 0,tool_servers:f,features:{image_generation:(Ao=d==null?void 0:d.features)!=null&&Ao.enable_image_generation&&((u==null?void 0:u.role)==="admin"||(C0=(fl=u==null?void 0:u.permissions)==null?void 0:fl.features)!=null&&C0.image_generation)?P:!1,code_interpreter:(Yh=d==null?void 0:d.features)!=null&&Yh.enable_code_interpreter&&((u==null?void 0:u.role)==="admin"||(Jh=(A0=u==null?void 0:u.permissions)==null?void 0:A0.features)!=null&&Jh.code_interpreter)?re:!1,web_search:(pm=d==null?void 0:d.features)!=null&&pm.enable_web_search&&((u==null?void 0:u.role)==="admin"||(xm=(bm=u==null?void 0:u.permissions)==null?void 0:bm.features)!=null&&xm.web_search)?V||((o==null?void 0:o.webSearch)??!1)==="always":!1,memory:(o==null?void 0:o.memory)??!1},variables:{...GD(u==null?void 0:u.name,o!=null&&o.userLocation?await gv(localStorage.token).catch(fn=>{console.error(fn)}):void 0)},model_item:c.find(fn=>fn.id===Re.id),session_id:h==null?void 0:h.id,chat_id:r,id:Ee,background_tasks:{...!s&&(xn.length==1||xn.length==2&&((Ys=xn.at(0))==null?void 0:Ys.role)==="system"&&((So=xn.at(1))==null?void 0:So.role)==="user")&&(se[0]===Re.id||de!==void 0)?{title_generation:((Z_=o==null?void 0:o.title)==null?void 0:Z_.auto)??!0,tags_generation:(o==null?void 0:o.autoTags)??!0}:{},follow_up_generation:(o==null?void 0:o.autoFollowUps)??!0},...En&&(((ev=($_=(Q_=Re.info)==null?void 0:Q_.meta)==null?void 0:$_.capabilities)==null?void 0:ev.usage)??!1)?{stream_options:{include_usage:!0}}:{}},`${Yo}/api`).catch(async fn=>(Jt.error(`${fn}`),Le.error={content:fn},Le.done=!0,t(23,oe.messages[Ee]=Le,oe),t(23,oe.currentId=Ee,oe),null));cn&&(cn.error?await Ci(cn.error,Le):Q?Q.push(cn.task_id):t(24,Q=[cn.task_id])),await hn(),dt()},Ci=async(ne,Re)=>{let Ee="",it;ne&&(it=ne),console.error(it),"detail"in it?(Jt.error(it.detail),Ee=it.detail):"error"in it?"message"in it.error?(Jt.error(it.error.message),Ee=it.error.message):(Jt.error(it.error),Ee=it.error):"message"in it&&(Jt.error(it.message),Ee=it.message),Re.error={content:l.t("Uh-oh! There was an issue with the response.")+`
`+Ee},Re.done=!0,Re.statusHistory&&(Re.statusHistory=Re.statusHistory.filter(We=>We.action!=="knowledge_search")),t(23,oe.messages[Re.id]=Re,oe)},Rr=async()=>{if(Q){for(const Re of Q)await nF(localStorage.token,Re).catch(Ee=>(Jt.error(`${Ee}`),null));t(24,Q=null);const ne=oe.messages[oe.currentId];for(const Re of oe.messages[ne.parentId].childrenIds)t(23,oe.messages[Re].done=!0,oe);t(23,oe.messages[oe.currentId]=ne,oe),F&&dt()}},Xs=async(ne,Re)=>{let Ee=Re,it=Cl(),We={id:it,parentId:ne,childrenIds:[],role:"user",content:Ee,models:se,timestamp:Math.floor(Date.now()/1e3)};ne!==null&&t(23,oe.messages[ne].childrenIds=[...oe.messages[ne].childrenIds,it],oe),t(23,oe.messages[it]=We,oe),t(23,oe.currentId=it,oe),await hn(),F&&dt(),await Wi(oe,Ee,it)},Es=async ne=>{if(oe.currentId){let Re=oe.messages[ne.parentId],Ee=Re.content;F&&dt(),((Re==null?void 0:Re.models)??[...se]).length==1?await Wi(oe,Ee,Re.id):await Wi(oe,Ee,Re.id,{modelId:ne.model,modelIdx:ne.modelIdx})}},Ne=async()=>{if(JSON.parse(JSON.stringify(r)),oe.currentId&&oe.messages[oe.currentId].done==!0){const ne=oe.messages[oe.currentId];ne.done=!1,await hn();const Re=c.filter(Ee=>Ee.id===((ne==null?void 0:ne.selectedModelId)??ne.model)).at(0);Re&&await _s(oe,Re,ne.id)}},Ve=async(ne,Re,Ee)=>{const it=oe.messages[ne],We={status:!0,content:""};it.merged=We,t(23,oe.messages[ne]=it,oe);try{const[Le,Ye]=await iF(localStorage.token,it.model,oe.messages[it.parentId].content,Re);if(Le&&Le.ok&&Le.body){const At=await fL(Le.body,o.splitLargeChunks);for await(const Mt of At){const{value:En,done:xn,sources:cn,error:ii,usage:Ai}=Mt;if(ii||xn)break;We.content==""&&En==`
`||(We.content+=En,t(23,oe.messages[ne]=it,oe),F&&dt())}await Xt(Ee,oe)}else console.error(Le)}catch(Le){console.error(Le)}},ht=async ne=>{let Re=r;return s?(Re="local",await uu.set("local")):(ue=await WD(localStorage.token,{id:Re,title:l.t("New Chat"),models:se,system:o.system??void 0,params:De,history:ne,messages:Da(ne,ne.currentId),tags:[],timestamp:Date.now()},a==null?void 0:a.id),Re=ue.id,await uu.set(Re),window.history.replaceState(ne.state,"",`/c/${Re}`),await hn(),await mc.set(await T0(localStorage.token,i)),kl.set(1),Jf.set(null)),await hn(),Re},Xt=async(ne,Re)=>{r==ne&&(s||(ue=await nw(localStorage.token,ne,{models:se,history:Re,messages:Da(Re,Re.currentId),params:De,files:Ke}),kl.set(1),await mc.set(await T0(localStorage.token,i))))};function an(ne){z=ne,t(10,z)}const Bn=ne=>{ne.detail?G(ne.detail):G(!0)},Cn=()=>{G(!1)};function Un(ne){It[ne?"unshift":"push"](()=>{T=ne,t(9,T)})}function zn(ne){se=ne,t(0,se)}const dl=ne=>{N==null||N.setText(ne)};function gr(ne){oe=ne,t(23,oe)}function tm(ne){F=ne,t(7,F)}function nm(ne){ae=ne,t(25,ae)}function im(ne){It[ne?"unshift":"push"](()=>{H=ne,t(8,H)})}const sm=ne=>{t(7,F=H.scrollHeight-H.scrollTop<=H.clientHeight+5)},rm=ne=>{s||(ne.prompt!==null?sessionStorage.setItem(`chat-input${r?`-${r}`:""}`,JSON.stringify(ne)):sessionStorage.removeItem(`chat-input${r?`-${r}`:""}`))};function am(ne){It[ne?"unshift":"push"](()=>{N=ne,t(6,N)})}function om(ne){Ue=ne,t(27,Ue)}function lm(ne){ae=ne,t(25,ae)}function cm(ne){F=ne,t(7,F)}function hm(ne){we=ne,t(17,we)}function um(ne){ye=ne,t(18,ye)}function dm(ne){P=ne,t(19,P)}function fm(ne){re=ne,t(21,re)}function gm(ne){V=ne,t(20,V)}function mm(ne){de=ne,t(1,de)}function ke(ne){X=ne,t(22,X)}const Fy=async ne=>{const{type:Re,data:Ee}=ne.detail;Re==="web"?await Ft(Ee):Re==="youtube"?await sn(Ee):Re==="google-drive"&&await Ge(Ee)},Ly=async ne=>{(ne.detail||Ue.length>0)&&(await hn(),ui((o==null?void 0:o.richTextInput)??!0?ne.detail.replaceAll(`

`,`
`):ne.detail))};function By(ne){N=ne,t(6,N)}function Uy(ne){Ue=ne,t(27,Ue)}function Hy(ne){ae=ne,t(25,ae)}function zy(ne){F=ne,t(7,F)}function jy(ne){we=ne,t(17,we)}function Gy(ne){ye=ne,t(18,ye)}function Vy(ne){P=ne,t(19,P)}function qy(ne){re=ne,t(21,re)}function Wy(ne){V=ne,t(20,V)}function Ky(ne){de=ne,t(1,de)}function Xy(ne){X=ne,t(22,X)}const Yy=async ne=>{const{type:Re,data:Ee}=ne.detail;Re==="web"?await Ft(Ee):Re==="youtube"&&await sn(Ee)},Jy=async ne=>{(ne.detail||Ue.length>0)&&(await hn(),ui((o==null?void 0:o.richTextInput)??!0?ne.detail.replaceAll(`

`,`
`):ne.detail))},Z=(ne,Re,Ee,it)=>{const We=c.find(Le=>Le.id===Re);return We?[...ne,We]:ne};function Xe(ne){It[ne?"unshift":"push"](()=>{M=ne,t(5,M)})}function wt(ne){oe=ne,t(23,oe)}function _t(ne){Ke=ne,t(26,Ke)}function tt(ne){De=ne,t(28,De)}function Rt(ne){Ue=ne,t(27,Ue)}function ni(ne){S=ne,t(4,S)}return n.$$set=ne=>{"chatIdProp"in ne&&t(57,C=ne.chatIdProp)},n.$$.update=()=>{n.$$.dirty[0]&3&&t(2,he=de!==void 0?[de.id]:se),n.$$.dirty[1]&67108864&&C&&je(),n.$$.dirty[0]&1|n.$$.dirty[1]&67108864&&se&&C!==""&&Qe(),n.$$.dirty[0]&4|n.$$.dirty[1]&134217728&&JSON.stringify(he)!==JSON.stringify(ft)&&ut()},[se,de,he,k,S,M,N,F,H,T,z,R,L,Y,j,J,G,we,ye,P,V,re,X,oe,Q,ae,Ke,Ue,De,s,r,a,o,c,d,f,y,w,_,v,I,ze,ge,Ge,Ft,sn,Me,Ln,hi,Gi,ui,Wi,Rr,Xs,Es,Ne,Ve,C,ft,an,Bn,Cn,Un,zn,dl,gr,tm,nm,im,sm,rm,am,om,lm,cm,hm,um,dm,fm,gm,mm,ke,Fy,Ly,By,Uy,Hy,zy,jy,Gy,Vy,qy,Wy,Ky,Xy,Yy,Jy,Z,Xe,wt,_t,tt,Rt,ni]}class Cce extends Nt{constructor(e){super(),Ot(this,e,rle,sle,Ut,{chatIdProp:57},null,[-1,-1,-1,-1,-1])}}export{Cce as C};
//# sourceMappingURL=Dw65qIt7.js.map
