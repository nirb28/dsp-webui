var yr=Object.defineProperty;var Ir=(n,e,t)=>e in n?yr(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var vt=(n,e,t)=>Ir(n,typeof e!="symbol"?e+"":e,t);import{s as Se,k as H,e as w,t as W,o as z,c as y,a as k,b as q,d as m,f as d,i as E,g as b,B as ut,u as he,h as Z,S as qe,G as $e,j as Ne,p as Fe,W as Vt,q as yt,y as ze,A as Xe,r as Mr,v as Er,w as Nr,x as Dr,F as lt,l as ce,n as De,D as pe,E as ve,U as At,C as Te,J as Vr,an as Tr,K as Et,Z as Lt,X as Cr,Y as Sr}from"./osRMcaoZ.js";import{S as Ae,i as Le,b as Y,d as $,m as x,t as v,a as M,e as ee,f as Ye,g as te,c as le,h as Nt}from"./Cz_TVcYH.js";import{e as Ve,u as Ht,o as Kt,d as Br}from"./DCwEHxc-.js";import{m as zt,d as gl,j as zn,a as bt,h as Or,G as _l,H as bl,J as Rr,K as Pr,c as Un,T as pl,u as Ut,n as Zt,e as Qe,W as Ar,b as vl,D as kl,F as Lr}from"./DUlFqCOB.js";import{t as je}from"./CvcJvn8o.js";import{h as jr,u as Hr,j as zr}from"./BiJCbRrE.js";import{a as Gt,D as wl,d as Wn,E as Ur,w as kt,B as wt,l as qn,m as jt,v as yl}from"./C3cxvGum.js";import{d as it}from"./I1CDPYOB.js";import"./BFK-koEx.js";import{u as Il,c as Wr}from"./CxViFWrp.js";import{d as qr}from"./D5SIsFJr.js";import{s as Fr}from"./Dx8G6d6m.js";import{i as Jr}from"./BLmrKv22.js";import{P as Fn,N as Qt}from"./UzcSbTlA.js";import{S as Xt,a as Gr}from"./DuxTsn3k.js";import{aG as Jn,aV as Kr,aL as Tt,aW as Zr,aq as Yt,aX as Qr}from"./RzT9Pn6s.js";import{T as Be}from"./BOoEfdYa.js";import{T as Xr}from"./pvJazfKD.js";import{X as Wt}from"./YHUoul5_.js";import{C as Gn}from"./WR5NVTQu.js";import{C as Kn}from"./D0wlPick.js";import{S as Yr}from"./CgIHmX5r.js";import{C as Zn}from"./CxRe37LO.js";import{I as $r}from"./FlRup1wW.js";import{M as Qn}from"./BbL-Ydhu.js";import{S as $t}from"./XYvaYOQu.js";import{B as xt}from"./B1Cm1oGM.js";import{C as xr}from"./DymEVbxd.js";import{E as ei}from"./B2AZZEdi.js";import{c as Ml}from"./-Lmj9_YH.js";import{F as el}from"./5RhMWXVw.js";import{f as Dt}from"./DMHG7wso.js";import{L as ti}from"./6yqafMIy.js";import{F as li}from"./CU2r43ac.js";import{E as si}from"./CHRctSa9.js";function El(n,e,t){const l=n.slice();return l[23]=e[t],l}function Nl(n,e,t){const l=n.slice();return l[26]=e[t],l}function Dl(n){var s;let e,t=n[8].t('This response was generated by "{{model}}"',{model:n[7]?((s=n[7])==null?void 0:s.name)??n[7].id:n[1].selectedModelId})+"",l;return{c(){e=w("div"),l=W(t),this.h()},l(r){e=y(r,"DIV",{class:!0});var i=k(e);l=q(i,t),i.forEach(m),this.h()},h(){d(e,"class","text-xs font-medium pt-1.5 -mb-0.5")},m(r,i){E(r,e,i),b(e,l)},p(r,i){var o;i&386&&t!==(t=r[8].t('This response was generated by "{{model}}"',{model:r[7]?((o=r[7])==null?void 0:o.name)??r[7].id:r[1].selectedModelId})+"")&&Z(l,t)},d(r){r&&m(e)}}}function Vl(n){let e,t=n[26]+"",l,s,r,i,o,a;function f(){return n[12](n[26])}return{c(){e=w("button"),l=W(t),s=H(),this.h()},l(u){e=y(u,"BUTTON",{class:!0});var c=k(e);l=q(c,t),s=z(c),c.forEach(m),this.h()},h(){var u,c;d(e,"class",r="size-7 text-sm border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(n[6]===n[26]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-full disabled:cursor-not-allowed disabled:text-gray-500 disabled:bg-white dark:disabled:bg-gray-900"),e.disabled=i=((c=(u=n[1])==null?void 0:u.annotation)==null?void 0:c.rating)===-1?n[26]>5:n[26]<6},m(u,c){E(u,e,c),b(e,l),b(e,s),o||(a=he(e,"click",f),o=!0)},p(u,c){var g,h;n=u,c&64&&r!==(r="size-7 text-sm border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(n[6]===n[26]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-full disabled:cursor-not-allowed disabled:text-gray-500 disabled:bg-white dark:disabled:bg-gray-900")&&d(e,"class",r),c&2&&i!==(i=((h=(g=n[1])==null?void 0:g.annotation)==null?void 0:h.rating)===-1?n[26]>5:n[26]<6)&&(e.disabled=i)},d(u){u&&m(e),o=!1,a()}}}function Tl(n){let e,t=n[8].t("Why?")+"",l,s,r,i=Ve(n[3]),o=[];for(let a=0;a<i.length;a+=1)o[a]=Cl(El(n,i,a));return{c(){e=w("div"),l=W(t),s=H(),r=w("div");for(let a=0;a<o.length;a+=1)o[a].c();this.h()},l(a){e=y(a,"DIV",{class:!0});var f=k(e);l=q(f,t),f.forEach(m),s=z(a),r=y(a,"DIV",{class:!0});var u=k(r);for(let c=0;c<o.length;c+=1)o[c].l(u);u.forEach(m),this.h()},h(){d(e,"class","text-sm mt-1.5 font-medium"),d(r,"class","flex flex-wrap gap-1.5 text-sm mt-1.5")},m(a,f){E(a,e,f),b(e,l),E(a,s,f),E(a,r,f);for(let u=0;u<o.length;u+=1)o[u]&&o[u].m(r,null)},p(a,f){if(f&256&&t!==(t=a[8].t("Why?")+"")&&Z(l,t),f&280){i=Ve(a[3]);let u;for(u=0;u<i.length;u+=1){const c=El(a,i,u);o[u]?o[u].p(c,f):(o[u]=Cl(c),o[u].c(),o[u].m(r,null))}for(;u<o.length;u+=1)o[u].d(1);o.length=i.length}},d(a){a&&(m(e),m(s),m(r)),qe(o,a)}}}function ni(n){let e=n[23]+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){E(l,t,s)},p(l,s){s&8&&e!==(e=l[23]+"")&&Z(t,e)},d(l){l&&m(t)}}}function ri(n){let e=n[8].t("Other")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){E(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Other")+"")&&Z(t,e)},d(l){l&&m(t)}}}function ii(n){let e=n[8].t("Being lazy")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){E(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Being lazy")+"")&&Z(t,e)},d(l){l&&m(t)}}}function ai(n){let e=n[8].t("Refused when it shouldn't have")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){E(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Refused when it shouldn't have")+"")&&Z(t,e)},d(l){l&&m(t)}}}function oi(n){let e=n[8].t("Didn't fully follow instructions")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){E(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Didn't fully follow instructions")+"")&&Z(t,e)},d(l){l&&m(t)}}}function fi(n){let e=n[8].t("Not factually correct")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){E(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Not factually correct")+"")&&Z(t,e)},d(l){l&&m(t)}}}function ui(n){let e=n[8].t("Not helpful")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){E(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Not helpful")+"")&&Z(t,e)},d(l){l&&m(t)}}}function ci(n){let e=n[8].t("Too verbose")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){E(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Too verbose")+"")&&Z(t,e)},d(l){l&&m(t)}}}function di(n){let e=n[8].t("Don't like the style")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){E(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Don't like the style")+"")&&Z(t,e)},d(l){l&&m(t)}}}function hi(n){let e=n[8].t("Thorough explanation")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){E(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Thorough explanation")+"")&&Z(t,e)},d(l){l&&m(t)}}}function mi(n){let e=n[8].t("Attention to detail")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){E(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Attention to detail")+"")&&Z(t,e)},d(l){l&&m(t)}}}function gi(n){let e=n[8].t("Positive attitude")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){E(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Positive attitude")+"")&&Z(t,e)},d(l){l&&m(t)}}}function _i(n){let e=n[8].t("Showcased creativity")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){E(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Showcased creativity")+"")&&Z(t,e)},d(l){l&&m(t)}}}function bi(n){let e=n[8].t("Followed instructions perfectly")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){E(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Followed instructions perfectly")+"")&&Z(t,e)},d(l){l&&m(t)}}}function pi(n){let e=n[8].t("Accurate information")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){E(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Accurate information")+"")&&Z(t,e)},d(l){l&&m(t)}}}function Cl(n){let e,t,l,s,r;function i(u,c){return u[23]==="accurate_information"?pi:u[23]==="followed_instructions_perfectly"?bi:u[23]==="showcased_creativity"?_i:u[23]==="positive_attitude"?gi:u[23]==="attention_to_detail"?mi:u[23]==="thorough_explanation"?hi:u[23]==="dont_like_the_style"?di:u[23]==="too_verbose"?ci:u[23]==="not_helpful"?ui:u[23]==="not_factually_correct"?fi:u[23]==="didnt_fully_follow_instructions"?oi:u[23]==="refused_when_it_shouldnt_have"?ai:u[23]==="being_lazy"?ii:u[23]==="other"?ri:ni}let o=i(n),a=o(n);function f(){return n[13](n[23])}return{c(){e=w("button"),a.c(),t=H(),this.h()},l(u){e=y(u,"BUTTON",{class:!0});var c=k(e);a.l(c),t=z(c),c.forEach(m),this.h()},h(){d(e,"class",l="px-3 py-0.5 border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(n[4]===n[23]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-xl")},m(u,c){E(u,e,c),a.m(e,null),b(e,t),s||(r=he(e,"click",f),s=!0)},p(u,c){n=u,o===(o=i(n))&&a?a.p(n,c):(a.d(1),a=o(n),a&&(a.c(),a.m(e,t))),c&24&&l!==(l="px-3 py-0.5 border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(n[4]===n[23]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-xl")&&d(e,"class",l)},d(u){u&&m(e),a.d(),s=!1,r()}}}function vi(n){var K;let e,t,l,s,r=n[8].t("How would you rate this response?")+"",i,o,a,f,u,c,g,h,_,T,p,D,V=n[8].t("Awful")+"",L,O,P,I,N=n[8].t("Amazing")+"",S,C,B,F,R,Q,_e,U,ne,fe,ue,we,X,re=n[8].t("Save")+"",ge,ie,de,ke,ye,J=((K=n[1])==null?void 0:K.arena)&&Dl(n);f=new Wt({props:{className:"size-4"}});let me=Ve(Array.from({length:10}).map(Sl)),ae=[];for(let G=0;G<me.length;G+=1)ae[G]=Vl(Nl(n,me,G));let A=n[3].length>0&&Tl(n);return ue=new Xr({props:{tags:n[2]}}),ue.$on("delete",n[15]),ue.$on("add",n[16]),{c(){J&&J.c(),e=H(),t=w("div"),l=w("div"),s=w("div"),i=W(r),o=H(),a=w("button"),Y(f.$$.fragment),u=H(),c=w("div"),g=w("div"),h=w("div");for(let G=0;G<ae.length;G+=1)ae[G].c();_=H(),T=w("div"),p=w("div"),D=W("1 - "),L=W(V),O=H(),P=w("div"),I=W("10 - "),S=W(N),C=H(),B=w("div"),A&&A.c(),F=H(),R=w("div"),Q=w("textarea"),U=H(),ne=w("div"),fe=w("div"),Y(ue.$$.fragment),we=H(),X=w("button"),ge=W(re),this.h()},l(G){J&&J.l(G),e=z(G),t=y(G,"DIV",{class:!0,id:!0});var oe=k(t);l=y(oe,"DIV",{class:!0});var be=k(l);s=y(be,"DIV",{class:!0});var Ee=k(s);i=q(Ee,r),Ee.forEach(m),o=z(be),a=y(be,"BUTTON",{});var Me=k(a);$(f.$$.fragment,Me),Me.forEach(m),be.forEach(m),u=z(oe),c=y(oe,"DIV",{class:!0});var Oe=k(c);g=y(Oe,"DIV",{class:!0});var Ue=k(g);h=y(Ue,"DIV",{class:!0});var He=k(h);for(let ot=0;ot<ae.length;ot+=1)ae[ot].l(He);He.forEach(m),_=z(Ue),T=y(Ue,"DIV",{class:!0});var se=k(T);p=y(se,"DIV",{});var Ge=k(p);D=q(Ge,"1 - "),L=q(Ge,V),Ge.forEach(m),O=z(se),P=y(se,"DIV",{});var Ke=k(P);I=q(Ke,"10 - "),S=q(Ke,N),Ke.forEach(m),se.forEach(m),Ue.forEach(m),Oe.forEach(m),C=z(oe),B=y(oe,"DIV",{});var Je=k(B);A&&A.l(Je),Je.forEach(m),F=z(oe),R=y(oe,"DIV",{class:!0});var xe=k(R);Q=y(xe,"TEXTAREA",{class:!0,placeholder:!0,rows:!0}),k(Q).forEach(m),xe.forEach(m),U=z(oe),ne=y(oe,"DIV",{class:!0});var at=k(ne);fe=y(at,"DIV",{class:!0});var ct=k(fe);$(ue.$$.fragment,ct),ct.forEach(m),we=z(at),X=y(at,"BUTTON",{class:!0});var dt=k(X);ge=q(dt,re),dt.forEach(m),at.forEach(m),oe.forEach(m),this.h()},h(){d(s,"class","text-sm font-medium"),d(l,"class","flex justify-between items-center"),d(h,"class","mt-1.5 w-fit flex gap-1 pb-2"),d(T,"class","sticky top-0 bottom-0 left-0 right-0 flex justify-between text-xs"),d(g,"class","relative w-fit overflow-x-auto scrollbar-none"),d(c,"class","w-full flex justify-center"),d(Q,"class","w-full text-sm px-1 py-2 bg-transparent outline-hidden resize-none rounded-xl"),d(Q,"placeholder",_e=n[8].t("Feel free to add specific details")),d(Q,"rows","3"),d(R,"class","mt-2"),d(fe,"class","flex items-end group"),d(X,"class","px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full"),d(ne,"class","mt-2 gap-1.5 flex justify-between"),d(t,"class","my-2.5 rounded-xl px-4 py-3 border border-gray-100 dark:border-gray-850"),d(t,"id",ie="message-feedback-"+n[1].id)},m(G,oe){J&&J.m(G,oe),E(G,e,oe),E(G,t,oe),b(t,l),b(l,s),b(s,i),b(l,o),b(l,a),x(f,a,null),b(t,u),b(t,c),b(c,g),b(g,h);for(let be=0;be<ae.length;be+=1)ae[be]&&ae[be].m(h,null);b(g,_),b(g,T),b(T,p),b(p,D),b(p,L),b(T,O),b(T,P),b(P,I),b(P,S),b(t,C),b(t,B),A&&A.m(B,null),b(t,F),b(t,R),b(R,Q),ut(Q,n[5]),b(t,U),b(t,ne),b(ne,fe),x(ue,fe,null),b(ne,we),b(ne,X),b(X,ge),de=!0,ke||(ye=[he(a,"click",n[11]),he(Q,"input",n[14]),he(X,"click",n[17])],ke=!0)},p(G,[oe]){var Ee;if((Ee=G[1])!=null&&Ee.arena?J?J.p(G,oe):(J=Dl(G),J.c(),J.m(e.parentNode,e)):J&&(J.d(1),J=null),(!de||oe&256)&&r!==(r=G[8].t("How would you rate this response?")+"")&&Z(i,r),oe&66){me=Ve(Array.from({length:10}).map(Sl));let Me;for(Me=0;Me<me.length;Me+=1){const Oe=Nl(G,me,Me);ae[Me]?ae[Me].p(Oe,oe):(ae[Me]=Vl(Oe),ae[Me].c(),ae[Me].m(h,null))}for(;Me<ae.length;Me+=1)ae[Me].d(1);ae.length=me.length}(!de||oe&256)&&V!==(V=G[8].t("Awful")+"")&&Z(L,V),(!de||oe&256)&&N!==(N=G[8].t("Amazing")+"")&&Z(S,N),G[3].length>0?A?A.p(G,oe):(A=Tl(G),A.c(),A.m(B,null)):A&&(A.d(1),A=null),(!de||oe&256&&_e!==(_e=G[8].t("Feel free to add specific details")))&&d(Q,"placeholder",_e),oe&32&&ut(Q,G[5]);const be={};oe&4&&(be.tags=G[2]),ue.$set(be),(!de||oe&256)&&re!==(re=G[8].t("Save")+"")&&Z(ge,re),(!de||oe&2&&ie!==(ie="message-feedback-"+G[1].id))&&d(t,"id",ie)},i(G){de||(v(f.$$.fragment,G),v(ue.$$.fragment,G),de=!0)},o(G){M(f.$$.fragment,G),M(ue.$$.fragment,G),de=!1},d(G){G&&(m(e),m(t)),J&&J.d(G),ee(f),qe(ae,G),A&&A.d(),ee(ue),ke=!1,$e(ye)}}}const Sl=(n,e)=>e+1;function ki(n,e,t){let l,s;Ne(n,zt,B=>t(18,s=B));const r=Fe("i18n");Ne(n,r,B=>t(8,l=B));const i=Vt();let{message:o}=e,{show:a=!1}=e,f=["accurate_information","followed_instructions_perfectly","showcased_creativity","positive_attitude","attention_to_detail","thorough_explanation","other"],u=["dont_like_the_style","too_verbose","not_helpful","not_factually_correct","didnt_fully_follow_instructions","refused_when_it_shouldnt_have","being_lazy","other"],c=[],g=[],h=null,_="",T=null,p=null;const D=()=>{var B,F,R,Q,_e;h||t(4,h=((B=o==null?void 0:o.annotation)==null?void 0:B.reason)??""),_||t(5,_=((F=o==null?void 0:o.annotation)==null?void 0:F.comment)??""),t(2,c=(((R=o==null?void 0:o.annotation)==null?void 0:R.tags)??[]).map(U=>({name:U}))),T||t(6,T=((_e=(Q=o==null?void 0:o.annotation)==null?void 0:Q.details)==null?void 0:_e.rating)??null)};yt(()=>{o!=null&&o.arena&&(t(7,p=s.find(B=>B.id===o.selectedModelId)),je.success(l.t('This response was generated by "{{model}}"',{model:p?(p==null?void 0:p.name)??p.id:o.selectedModelId})))});const V=()=>{i("save",{reason:h,comment:_,tags:c.map(B=>B.name),details:{rating:T}}),je.success(l.t("Thanks for your feedback!")),t(0,a=!1)},L=()=>{t(0,a=!1)},O=B=>{t(6,T=B)},P=B=>{t(4,h=B)};function I(){_=this.value,t(5,_)}const N=B=>{t(2,c=c.filter(F=>F.name.replaceAll(" ","_").toLowerCase()!==B.detail.replaceAll(" ","_").toLowerCase()))},S=B=>{t(2,c=[...c,{name:B.detail}])},C=()=>{V()};return n.$$set=B=>{"message"in B&&t(1,o=B.message),"show"in B&&t(0,a=B.show)},n.$$.update=()=>{var B,F;n.$$.dirty&2&&(((B=o==null?void 0:o.annotation)==null?void 0:B.rating)===1?t(3,g=f):((F=o==null?void 0:o.annotation)==null?void 0:F.rating)===-1&&t(3,g=u)),n.$$.dirty&2&&o&&D()},[a,o,c,g,h,_,T,p,l,r,V,L,O,P,I,N,S,C]}class wi extends Ae{constructor(e){super(),Le(this,e,ki,vi,Se,{message:1,show:0})}}function Bl(n,e,t){const l=n.slice();return l[5]=e[t],l[7]=t,l}function yi(n){let e,t;return e=new Gn({props:{strokeWidth:"3.5",className:"size-3.5 "}}),{c(){Y(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function Ii(n){let e,t;return e=new Kn({props:{strokeWidth:"3.5",className:"size-3.5 "}}),{c(){Y(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function Mi(n){let e,t,l,s,r;const i=n[2].default,o=Mr(i,n,n[4],null),a=[Ii,yi],f=[];function u(c,g){return c[1]?0:1}return l=u(n),s=f[l]=a[l](n),{c(){e=w("div"),o&&o.c(),t=H(),s.c(),this.h()},l(c){e=y(c,"DIV",{class:!0});var g=k(e);o&&o.l(g),t=z(g),s.l(g),g.forEach(m),this.h()},h(){d(e,"class","flex items-center gap-2 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 transition")},m(c,g){E(c,e,g),o&&o.m(e,null),b(e,t),f[l].m(e,null),r=!0},p(c,g){o&&o.p&&(!r||g&16)&&Er(o,i,c,c[4],r?Dr(i,c[4],g,null):Nr(c[4]),null);let h=l;l=u(c),l!==h&&(te(),M(f[h],1,1,()=>{f[h]=null}),le(),s=f[l],s||(s=f[l]=a[l](c),s.c()),v(s,1),s.m(e,null))},i(c){r||(v(o,c),v(s),r=!0)},o(c){M(o,c),M(s),r=!1},d(c){c&&m(e),o&&o.d(c),f[l].d()}}}function Ol(n){let e,t,l,s,r,i=n[0].query+"",o,a,f,u='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg>',c,g;return l=new Yr({}),{c(){e=w("a"),t=w("div"),Y(l.$$.fragment),s=H(),r=w("div"),o=W(i),a=H(),f=w("div"),f.innerHTML=u,this.h()},l(h){e=y(h,"A",{href:!0,target:!0,class:!0});var _=k(e);t=y(_,"DIV",{class:!0});var T=k(t);$(l.$$.fragment,T),s=z(T),r=y(T,"DIV",{class:!0});var p=k(r);o=q(p,i),p.forEach(m),T.forEach(m),a=z(_),f=y(_,"DIV",{class:!0,"data-svelte-h":!0}),lt(f)!=="svelte-14xjows"&&(f.innerHTML=u),_.forEach(m),this.h()},h(){d(r,"class","line-clamp-1"),d(t,"class","flex gap-2 items-center"),d(f,"class","ml-1 text-white dark:text-gray-900 group-hover/item:text-gray-600 dark:group-hover/item:text-white transition"),d(e,"href",c="https://www.google.com/search?q="+n[0].query),d(e,"target","_blank"),d(e,"class","flex w-full items-center p-3 px-4 border-b border-gray-300/30 dark:border-gray-700/50 group/item justify-between font-normal text-gray-800 dark:text-gray-300 no-underline")},m(h,_){E(h,e,_),b(e,t),x(l,t,null),b(t,s),b(t,r),b(r,o),b(e,a),b(e,f),g=!0},p(h,_){(!g||_&1)&&i!==(i=h[0].query+"")&&Z(o,i),(!g||_&1&&c!==(c="https://www.google.com/search?q="+h[0].query))&&d(e,"href",c)},i(h){g||(v(l.$$.fragment,h),g=!0)},o(h){M(l.$$.fragment,h),g=!1},d(h){h&&m(e),ee(l)}}}function Rl(n){let e,t,l=n[5]+"",s,r,i,o='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg>',a,f,u;return{c(){e=w("a"),t=w("div"),s=W(l),r=H(),i=w("div"),i.innerHTML=o,a=H(),this.h()},l(c){e=y(c,"A",{href:!0,target:!0,class:!0});var g=k(e);t=y(g,"DIV",{class:!0});var h=k(t);s=q(h,l),h.forEach(m),r=z(g),i=y(g,"DIV",{class:!0,"data-svelte-h":!0}),lt(i)!=="svelte-14xjows"&&(i.innerHTML=o),a=z(g),g.forEach(m),this.h()},h(){d(t,"class","line-clamp-1"),d(i,"class","ml-1 text-white dark:text-gray-900 group-hover/item:text-gray-600 dark:group-hover/item:text-white transition"),d(e,"href",f=n[5]),d(e,"target","_blank"),d(e,"class",u="flex w-full items-center p-3 px-4 "+(n[7]===n[0].urls.length-1?"":"border-b border-gray-300/30 dark:border-gray-700/50")+" group/item justify-between font-normal text-gray-800 dark:text-gray-300")},m(c,g){E(c,e,g),b(e,t),b(t,s),b(e,r),b(e,i),b(e,a)},p(c,g){g&1&&l!==(l=c[5]+"")&&Z(s,l),g&1&&f!==(f=c[5])&&d(e,"href",f),g&1&&u!==(u="flex w-full items-center p-3 px-4 "+(c[7]===c[0].urls.length-1?"":"border-b border-gray-300/30 dark:border-gray-700/50")+" group/item justify-between font-normal text-gray-800 dark:text-gray-300")&&d(e,"class",u)},d(c){c&&m(e)}}}function Ei(n){var o;let e,t,l,s=((o=n[0])==null?void 0:o.query)&&Ol(n),r=Ve(n[0].urls),i=[];for(let a=0;a<r.length;a+=1)i[a]=Rl(Bl(n,r,a));return{c(){e=w("div"),s&&s.c(),t=H();for(let a=0;a<i.length;a+=1)i[a].c();this.h()},l(a){e=y(a,"DIV",{class:!0,slot:!0});var f=k(e);s&&s.l(f),t=z(f);for(let u=0;u<i.length;u+=1)i[u].l(f);f.forEach(m),this.h()},h(){d(e,"class","text-sm border border-gray-300/30 dark:border-gray-700/50 rounded-xl mb-1.5"),d(e,"slot","content")},m(a,f){E(a,e,f),s&&s.m(e,null),b(e,t);for(let u=0;u<i.length;u+=1)i[u]&&i[u].m(e,null);l=!0},p(a,f){var u;if((u=a[0])!=null&&u.query?s?(s.p(a,f),f&1&&v(s,1)):(s=Ol(a),s.c(),v(s,1),s.m(e,t)):s&&(te(),M(s,1,1,()=>{s=null}),le()),f&1){r=Ve(a[0].urls);let c;for(c=0;c<r.length;c+=1){const g=Bl(a,r,c);i[c]?i[c].p(g,f):(i[c]=Rl(g),i[c].c(),i[c].m(e,null))}for(;c<i.length;c+=1)i[c].d(1);i.length=r.length}},i(a){l||(v(s),l=!0)},o(a){M(s),l=!1},d(a){a&&m(e),s&&s.d(),qe(i,a)}}}function Ni(n){let e,t,l;function s(i){n[3](i)}let r={className:"w-full space-y-1",$$slots:{content:[Ei],default:[Mi]},$$scope:{ctx:n}};return n[1]!==void 0&&(r.open=n[1]),e=new Jn({props:r}),ze.push(()=>Ye(e,"open",s)),{c(){Y(e.$$.fragment)},l(i){$(e.$$.fragment,i)},m(i,o){x(e,i,o),l=!0},p(i,[o]){const a={};o&19&&(a.$$scope={dirty:o,ctx:i}),!t&&o&2&&(t=!0,a.open=i[1],Xe(()=>t=!1)),e.$set(a)},i(i){l||(v(e.$$.fragment,i),l=!0)},o(i){M(e.$$.fragment,i),l=!1},d(i){ee(e,i)}}}function Di(n,e,t){let{$$slots:l={},$$scope:s}=e,{status:r={urls:[],query:""}}=e,i=!1;function o(a){i=a,t(1,i)}return n.$$set=a=>{"status"in a&&t(0,r=a.status),"$$scope"in a&&t(4,s=a.$$scope)},[r,i,l,o,s]}class Vi extends Ae{constructor(e){super(),Le(this,e,Di,Ni,Se,{status:0})}}function Ti(n){let e,t,l,s,r,i=(typeof n[0]=="string"?n[0]:JSON.stringify(n[0]))+"",o,a;return l=new $r({props:{className:"size-5 text-red-700 dark:text-red-400"}}),{c(){e=w("div"),t=w("div"),Y(l.$$.fragment),s=H(),r=w("div"),o=W(i),this.h()},l(f){e=y(f,"DIV",{class:!0});var u=k(e);t=y(u,"DIV",{class:!0});var c=k(t);$(l.$$.fragment,c),c.forEach(m),s=z(u),r=y(u,"DIV",{class:!0});var g=k(r);o=q(g,i),g.forEach(m),u.forEach(m),this.h()},h(){d(t,"class","self-start mt-0.5"),d(r,"class","self-center text-sm"),d(e,"class","flex my-2 gap-2.5 border px-4 py-3 border-red-600/10 bg-red-600/10 rounded-lg")},m(f,u){E(f,e,u),b(e,t),x(l,t,null),b(e,s),b(e,r),b(r,o),a=!0},p(f,[u]){(!a||u&1)&&i!==(i=(typeof f[0]=="string"?f[0]:JSON.stringify(f[0]))+"")&&Z(o,i)},i(f){a||(v(l.$$.fragment,f),a=!0)},o(f){M(l.$$.fragment,f),a=!1},d(f){f&&m(e),ee(l)}}}function Ci(n,e,t){let{content:l=""}=e;return n.$$set=s=>{"content"in s&&t(0,l=s.content)},[l]}let Si=class extends Ae{constructor(e){super(),Le(this,e,Ci,Ti,Se,{content:0})}};function Pl(n,e,t){const l=n.slice();return l[10]=e[t],l[12]=t,l}function Bi(n){const e=n.slice(),t=Fi(e[10].distance);return e[13]=t,e}function Oi(n){let e,t=n[4].t("No source available")+"",l;return{c(){e=w("div"),l=W(t),this.h()},l(s){e=y(s,"DIV",{class:!0});var r=k(e);l=q(r,t),r.forEach(m),this.h()},h(){d(e,"class","text-sm dark:text-gray-400")},m(s,r){E(s,e,r),b(e,l)},p(s,r){r&16&&t!==(t=s[4].t("No source available")+"")&&Z(l,t)},i:De,o:De,d(s){s&&m(e)}}}function Ri(n){var a;let e,t,l,s,r;e=new Be({props:{className:"w-fit",content:n[4].t("Open file"),placement:"top-start",tippyOptions:{duration:[500,0]},$$slots:{default:[Pi]},$$scope:{ctx:n}}});let i=((a=n[10].metadata)==null?void 0:a.parameters)&&Ll(n),o=n[2]&&jl(n);return{c(){Y(e.$$.fragment),t=H(),i&&i.c(),l=H(),o&&o.c(),s=ce()},l(f){$(e.$$.fragment,f),t=z(f),i&&i.l(f),l=z(f),o&&o.l(f),s=ce()},m(f,u){x(e,f,u),E(f,t,u),i&&i.m(f,u),E(f,l,u),o&&o.m(f,u),E(f,s,u),r=!0},p(f,u){var g;const c={};u&16&&(c.content=f[4].t("Open file")),u&16408&&(c.$$scope={dirty:u,ctx:f}),e.$set(c),(g=f[10].metadata)!=null&&g.parameters?i?i.p(f,u):(i=Ll(f),i.c(),i.m(l.parentNode,l)):i&&(i.d(1),i=null),f[2]?o?(o.p(f,u),u&4&&v(o,1)):(o=jl(f),o.c(),v(o,1),o.m(s.parentNode,s)):o&&(te(),M(o,1,1,()=>{o=null}),le())},i(f){r||(v(e.$$.fragment,f),v(o),r=!0)},o(f){M(e.$$.fragment,f),M(o),r=!1},d(f){f&&(m(t),m(l),m(s)),ee(e,f),i&&i.d(f),o&&o.d(f)}}}function Al(n){let e,t,l=n[4].t("page")+"",s,r,i=n[10].metadata.page+1+"",o,a;return{c(){e=w("span"),t=W("("),s=W(l),r=H(),o=W(i),a=W(")"),this.h()},l(f){e=y(f,"SPAN",{class:!0});var u=k(e);t=q(u,"("),s=q(u,l),r=z(u),o=q(u,i),a=q(u,")"),u.forEach(m),this.h()},h(){d(e,"class","text-xs text-gray-500 dark:text-gray-400")},m(f,u){E(f,e,u),b(e,t),b(e,s),b(e,r),b(e,o),b(e,a)},p(f,u){u&16&&l!==(l=f[4].t("page")+"")&&Z(s,l),u&8&&i!==(i=f[10].metadata.page+1+"")&&Z(o,i)},d(f){f&&m(e)}}}function Pi(n){var f,u,c,g;let e,t,l=n[6](((u=(f=n[10])==null?void 0:f.metadata)==null?void 0:u.name)??n[10].source.name)+"",s,r,i,o=Number.isInteger((g=(c=n[10])==null?void 0:c.metadata)==null?void 0:g.page),a=o&&Al(n);return{c(){e=w("div"),t=w("a"),s=W(l),i=H(),a&&a.c(),this.h()},l(h){e=y(h,"DIV",{class:!0});var _=k(e);t=y(_,"A",{class:!0,href:!0,target:!0});var T=k(t);s=q(T,l),T.forEach(m),i=z(_),a&&a.l(_),_.forEach(m),this.h()},h(){var h,_,T,p,D,V,L,O;d(t,"class","hover:text-gray-500 dark:hover:text-gray-100 underline grow"),d(t,"href",r=(_=(h=n[10])==null?void 0:h.metadata)!=null&&_.file_id?`${gl}/files/${(p=(T=n[10])==null?void 0:T.metadata)==null?void 0:p.file_id}/content${((V=(D=n[10])==null?void 0:D.metadata)==null?void 0:V.page)!==void 0?`#page=${n[10].metadata.page+1}`:""}`:(O=(L=n[10].source)==null?void 0:L.url)!=null&&O.includes("http")?n[10].source.url:"#"),d(t,"target","_blank"),d(e,"class","text-sm dark:text-gray-400 flex items-center gap-2 w-fit")},m(h,_){E(h,e,_),b(e,t),b(t,s),b(e,i),a&&a.m(e,null)},p(h,_){var T,p,D,V,L,O,P,I,N,S,C,B;_&8&&l!==(l=h[6](((p=(T=h[10])==null?void 0:T.metadata)==null?void 0:p.name)??h[10].source.name)+"")&&Z(s,l),_&8&&r!==(r=(V=(D=h[10])==null?void 0:D.metadata)!=null&&V.file_id?`${gl}/files/${(O=(L=h[10])==null?void 0:L.metadata)==null?void 0:O.file_id}/content${((I=(P=h[10])==null?void 0:P.metadata)==null?void 0:I.page)!==void 0?`#page=${h[10].metadata.page+1}`:""}`:(S=(N=h[10].source)==null?void 0:N.url)!=null&&S.includes("http")?h[10].source.url:"#")&&d(t,"href",r),_&8&&(o=Number.isInteger((B=(C=h[10])==null?void 0:C.metadata)==null?void 0:B.page)),o?a?a.p(h,_):(a=Al(h),a.c(),a.m(e,null)):a&&(a.d(1),a=null)},d(h){h&&m(e),a&&a.d()}}}function Ll(n){let e,t=n[4].t("Parameters")+"",l,s,r,i=JSON.stringify(n[10].metadata.parameters,null,2)+"",o;return{c(){e=w("div"),l=W(t),s=H(),r=w("pre"),o=W(i),this.h()},l(a){e=y(a,"DIV",{class:!0});var f=k(e);l=q(f,t),f.forEach(m),s=z(a),r=y(a,"PRE",{class:!0});var u=k(r);o=q(u,i),u.forEach(m),this.h()},h(){d(e,"class","text-sm font-medium dark:text-gray-300 mt-2"),d(r,"class","text-sm dark:text-gray-400 bg-gray-50 dark:bg-gray-800 p-2 rounded-md overflow-auto max-h-40")},m(a,f){E(a,e,f),b(e,l),E(a,s,f),E(a,r,f),b(r,o)},p(a,f){f&16&&t!==(t=a[4].t("Parameters")+"")&&Z(l,t),f&8&&i!==(i=JSON.stringify(a[10].metadata.parameters,null,2)+"")&&Z(o,i)},d(a){a&&(m(e),m(s),m(r))}}}function jl(n){let e,t=n[4].t("Relevance")+"",l,s,r,i,o,a;const f=[Li,Ai],u=[];function c(g,h){return g[10].distance!==void 0?0:1}return r=c(n),i=u[r]=f[r](n),{c(){e=w("div"),l=W(t),s=H(),i.c(),o=ce(),this.h()},l(g){e=y(g,"DIV",{class:!0});var h=k(e);l=q(h,t),h.forEach(m),s=z(g),i.l(g),o=ce(),this.h()},h(){d(e,"class","text-sm font-medium dark:text-gray-300 mt-2")},m(g,h){E(g,e,h),b(e,l),E(g,s,h),u[r].m(g,h),E(g,o,h),a=!0},p(g,h){(!a||h&16)&&t!==(t=g[4].t("Relevance")+"")&&Z(l,t);let _=r;r=c(g),r===_?u[r].p(g,h):(te(),M(u[_],1,1,()=>{u[_]=null}),le(),i=u[r],i?i.p(g,h):(i=u[r]=f[r](g),i.c()),v(i,1),i.m(o.parentNode,o))},i(g){a||(v(i),a=!0)},o(g){M(i),a=!1},d(g){g&&(m(e),m(s),m(o)),u[r].d(g)}}}function Ai(n){let e,t=n[4].t("No distance available")+"",l;return{c(){e=w("div"),l=W(t),this.h()},l(s){e=y(s,"DIV",{class:!0});var r=k(e);l=q(r,t),r.forEach(m),this.h()},h(){d(e,"class","text-sm dark:text-gray-400")},m(s,r){E(s,e,r),b(e,l)},p(s,r){r&16&&t!==(t=s[4].t("No distance available")+"")&&Z(l,t)},i:De,o:De,d(s){s&&m(e)}}}function Li(n){let e,t;return e=new Be({props:{className:"w-fit",content:n[4].t("Semantic distance to query"),placement:"top-start",tippyOptions:{duration:[500,0]},$$slots:{default:[Hi]},$$scope:{ctx:n}}}),{c(){Y(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},p(l,s){const r={};s&16&&(r.content=l[4].t("Semantic distance to query")),s&16394&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function ji(n){var i;let e,t,l=(((i=n[10])==null?void 0:i.distance)??0).toFixed(4)+"",s,r;return{c(){e=w("span"),t=W("("),s=W(l),r=W(")"),this.h()},l(o){e=y(o,"SPAN",{class:!0});var a=k(e);t=q(a,"("),s=q(a,l),r=q(a,")"),a.forEach(m),this.h()},h(){d(e,"class","text-gray-500 dark:text-gray-500")},m(o,a){E(o,e,a),b(e,t),b(e,s),b(e,r)},p(o,a){var f;a&8&&l!==(l=(((f=o[10])==null?void 0:f.distance)??0).toFixed(4)+"")&&Z(s,l)},d(o){o&&m(e)}}}function Hl(n){var r;let e,t,l=typeof n[13]=="number"&&zl(n),s=typeof((r=n[10])==null?void 0:r.distance)=="number"&&Ul(n);return{c(){l&&l.c(),e=H(),s&&s.c(),t=ce()},l(i){l&&l.l(i),e=z(i),s&&s.l(i),t=ce()},m(i,o){l&&l.m(i,o),E(i,e,o),s&&s.m(i,o),E(i,t,o)},p(i,o){var a;typeof i[13]=="number"?l?l.p(i,o):(l=zl(i),l.c(),l.m(e.parentNode,e)):l&&(l.d(1),l=null),typeof((a=i[10])==null?void 0:a.distance)=="number"?s?s.p(i,o):(s=Ul(i),s.c(),s.m(t.parentNode,t)):s&&(s.d(1),s=null)},d(i){i&&(m(e),m(t)),l&&l.d(i),s&&s.d(i)}}}function zl(n){let e,t=n[13].toFixed(2)+"",l,s,r;return{c(){e=w("span"),l=W(t),s=W("%"),this.h()},l(i){e=y(i,"SPAN",{class:!0});var o=k(e);l=q(o,t),s=q(o,"%"),o.forEach(m),this.h()},h(){d(e,"class",r=`px-1 rounded-sm font-medium ${Fl(n[13])}`)},m(i,o){E(i,e,o),b(e,l),b(e,s)},p(i,o){o&8&&t!==(t=i[13].toFixed(2)+"")&&Z(l,t),o&8&&r!==(r=`px-1 rounded-sm font-medium ${Fl(i[13])}`)&&d(e,"class",r)},d(i){i&&m(e)}}}function Ul(n){var i;let e,t,l=(((i=n[10])==null?void 0:i.distance)??0).toFixed(4)+"",s,r;return{c(){e=w("span"),t=W("("),s=W(l),r=W(")"),this.h()},l(o){e=y(o,"SPAN",{class:!0});var a=k(e);t=q(a,"("),s=q(a,l),r=q(a,")"),a.forEach(m),this.h()},h(){d(e,"class","text-gray-500 dark:text-gray-500")},m(o,a){E(o,e,a),b(e,t),b(e,s),b(e,r)},p(o,a){var f;a&8&&l!==(l=(((f=o[10])==null?void 0:f.distance)??0).toFixed(4)+"")&&Z(s,l)},d(o){o&&m(e)}}}function Hi(n){let e;function t(i,o){var a;if(i[1])return Hl;if(typeof((a=i[10])==null?void 0:a.distance)=="number")return ji}function l(i,o){return o===Hl?Bi(i):i}let s=t(n),r=s&&s(l(n,s));return{c(){e=w("div"),r&&r.c(),this.h()},l(i){e=y(i,"DIV",{class:!0});var o=k(e);r&&r.l(o),o.forEach(m),this.h()},h(){d(e,"class","text-sm my-1 dark:text-gray-400 flex items-center gap-2 w-fit")},m(i,o){E(i,e,o),r&&r.m(e,null)},p(i,o){s===(s=t(i))&&r?r.p(l(i,s),o):(r&&r.d(1),r=s&&s(l(i,s)),r&&(r.c(),r.m(e,null)))},d(i){i&&m(e),r&&r.d()}}}function zi(n){let e,t,l=n[10].document+"",s,r;return{c(){e=w("pre"),t=W("                "),s=W(l),r=W(`
              `),this.h()},l(i){e=y(i,"PRE",{class:!0});var o=k(e);t=q(o,"                "),s=q(o,l),r=q(o,`
              `),o.forEach(m),this.h()},h(){d(e,"class","text-sm dark:text-gray-400 whitespace-pre-line")},m(i,o){E(i,e,o),b(e,t),b(e,s),b(e,r)},p(i,o){o&8&&l!==(l=i[10].document+"")&&Z(s,l)},d(i){i&&m(e)}}}function Ui(n){let e,t,l;return{c(){e=w("iframe"),this.h()},l(s){e=y(s,"IFRAME",{class:!0,sandbox:!0,srcdoc:!0,title:!0}),k(e).forEach(m),this.h()},h(){d(e,"class","w-full border-0 h-auto rounded-none"),d(e,"sandbox","allow-scripts allow-forms allow-same-origin"),d(e,"srcdoc",t=n[10].document),d(e,"title",l=n[4].t("Content"))},m(s,r){E(s,e,r)},p(s,r){r&8&&t!==(t=s[10].document)&&d(e,"srcdoc",t),r&16&&l!==(l=s[4].t("Content"))&&d(e,"title",l)},d(s){s&&m(e)}}}function Wl(n){let e;return{c(){e=w("hr"),this.h()},l(t){e=y(t,"HR",{class:!0}),this.h()},h(){d(e,"class","border-gray-100 dark:border-gray-850 my-3")},m(t,l){E(t,e,l)},d(t){t&&m(e)}}}function ql(n){let e,t,l=n[4].t("Source")+"",s,r,i,o,a,f,u,c=n[4].t("Content")+"",g,h,_,T,p;const D=[Ri,Oi],V=[];function L(S,C){var B;return(B=S[10].source)!=null&&B.name?0:1}i=L(n),o=V[i]=D[i](n);function O(S,C){var B;return(B=S[10].metadata)!=null&&B.html?Ui:zi}let P=O(n),I=P(n),N=n[12]!==n[3].length-1&&Wl();return{c(){e=w("div"),t=w("div"),s=W(l),r=H(),o.c(),a=H(),f=w("div"),u=w("div"),g=W(c),h=H(),I.c(),_=H(),N&&N.c(),T=ce(),this.h()},l(S){e=y(S,"DIV",{class:!0});var C=k(e);t=y(C,"DIV",{class:!0});var B=k(t);s=q(B,l),B.forEach(m),r=z(C),o.l(C),C.forEach(m),a=z(S),f=y(S,"DIV",{class:!0});var F=k(f);u=y(F,"DIV",{class:!0});var R=k(u);g=q(R,c),R.forEach(m),h=z(F),I.l(F),F.forEach(m),_=z(S),N&&N.l(S),T=ce(),this.h()},h(){d(t,"class","text-sm font-medium dark:text-gray-300"),d(e,"class","flex flex-col w-full"),d(u,"class","text-sm font-medium dark:text-gray-300 mt-2"),d(f,"class","flex flex-col w-full")},m(S,C){E(S,e,C),b(e,t),b(t,s),b(e,r),V[i].m(e,null),E(S,a,C),E(S,f,C),b(f,u),b(u,g),b(f,h),I.m(f,null),E(S,_,C),N&&N.m(S,C),E(S,T,C),p=!0},p(S,C){(!p||C&16)&&l!==(l=S[4].t("Source")+"")&&Z(s,l);let B=i;i=L(S),i===B?V[i].p(S,C):(te(),M(V[B],1,1,()=>{V[B]=null}),le(),o=V[i],o?o.p(S,C):(o=V[i]=D[i](S),o.c()),v(o,1),o.m(e,null)),(!p||C&16)&&c!==(c=S[4].t("Content")+"")&&Z(g,c),P===(P=O(S))&&I?I.p(S,C):(I.d(1),I=P(S),I&&(I.c(),I.m(f,null))),S[12]!==S[3].length-1?N||(N=Wl(),N.c(),N.m(T.parentNode,T)):N&&(N.d(1),N=null)},i(S){p||(v(o),p=!0)},o(S){M(o),p=!1},d(S){S&&(m(e),m(a),m(f),m(_),m(T)),V[i].d(),I.d(),N&&N.d(S)}}}function Wi(n){let e,t,l,s=n[4].t("Citation")+"",r,i,o,a,f,u,c,g,h,_;a=new Wt({props:{className:"size-5"}});let T=Ve(n[3]),p=[];for(let V=0;V<T.length;V+=1)p[V]=ql(Pl(n,T,V));const D=V=>M(p[V],1,1,()=>{p[V]=null});return{c(){e=w("div"),t=w("div"),l=w("div"),r=W(s),i=H(),o=w("button"),Y(a.$$.fragment),f=H(),u=w("div"),c=w("div");for(let V=0;V<p.length;V+=1)p[V].c();this.h()},l(V){e=y(V,"DIV",{});var L=k(e);t=y(L,"DIV",{class:!0});var O=k(t);l=y(O,"DIV",{class:!0});var P=k(l);r=q(P,s),P.forEach(m),i=z(O),o=y(O,"BUTTON",{class:!0});var I=k(o);$(a.$$.fragment,I),I.forEach(m),O.forEach(m),f=z(L),u=y(L,"DIV",{class:!0});var N=k(u);c=y(N,"DIV",{class:!0});var S=k(c);for(let C=0;C<p.length;C+=1)p[C].l(S);S.forEach(m),N.forEach(m),L.forEach(m),this.h()},h(){d(l,"class","text-lg font-medium self-center capitalize"),d(o,"class","self-center"),d(t,"class","flex justify-between dark:text-gray-300 px-5 pt-4 pb-2"),d(c,"class","flex flex-col w-full dark:text-gray-200 overflow-y-scroll max-h-[22rem] scrollbar-hidden"),d(u,"class","flex flex-col md:flex-row w-full px-6 pb-5 md:space-x-4")},m(V,L){E(V,e,L),b(e,t),b(t,l),b(l,r),b(t,i),b(t,o),x(a,o,null),b(e,f),b(e,u),b(u,c);for(let O=0;O<p.length;O+=1)p[O]&&p[O].m(c,null);g=!0,h||(_=he(o,"click",n[8]),h=!0)},p(V,L){if((!g||L&16)&&s!==(s=V[4].t("Citation")+"")&&Z(r,s),L&94){T=Ve(V[3]);let O;for(O=0;O<T.length;O+=1){const P=Pl(V,T,O);p[O]?(p[O].p(P,L),v(p[O],1)):(p[O]=ql(P),p[O].c(),v(p[O],1),p[O].m(c,null))}for(te(),O=T.length;O<p.length;O+=1)D(O);le()}},i(V){if(!g){v(a.$$.fragment,V);for(let L=0;L<T.length;L+=1)v(p[L]);g=!0}},o(V){M(a.$$.fragment,V),p=p.filter(Boolean);for(let L=0;L<p.length;L+=1)M(p[L]);g=!1},d(V){V&&m(e),ee(a),qe(p,V),h=!1,_()}}}function qi(n){let e,t,l;function s(i){n[9](i)}let r={size:"lg",$$slots:{default:[Wi]},$$scope:{ctx:n}};return n[0]!==void 0&&(r.show=n[0]),e=new Qn({props:r}),ze.push(()=>Ye(e,"show",s)),{c(){Y(e.$$.fragment)},l(i){$(e.$$.fragment,i)},m(i,o){x(e,i,o),l=!0},p(i,[o]){const a={};o&16415&&(a.$$scope={dirty:o,ctx:i}),!t&&o&1&&(t=!0,a.show=i[0],Xe(()=>t=!1)),e.$set(a)},i(i){l||(v(e.$$.fragment,i),l=!0)},o(i){M(e.$$.fragment,i),l=!1},d(i){ee(e,i)}}}function Fi(n){return typeof n!="number"?null:n<0?0:n>1?100:Math.round(n*1e4)/100}function Fl(n){return n>=80?"bg-green-200 dark:bg-green-800 text-green-800 dark:text-green-200":n>=60?"bg-yellow-200 dark:bg-yellow-800 text-yellow-800 dark:text-yellow-200":n>=40?"bg-orange-200 dark:bg-orange-800 text-orange-800 dark:text-orange-200":"bg-red-200 dark:bg-red-800 text-red-800 dark:text-red-200"}function Ji(n,e,t){let l;const s=Fe("i18n");Ne(n,s,h=>t(4,l=h));let{show:r=!1}=e,{citation:i}=e,{showPercentage:o=!1}=e,{showRelevance:a=!0}=e,f=[];const u=h=>{try{return decodeURIComponent(h)}catch{return h}},c=()=>{t(0,r=!1)};function g(h){r=h,t(0,r)}return n.$$set=h=>{"show"in h&&t(0,r=h.show),"citation"in h&&t(7,i=h.citation),"showPercentage"in h&&t(1,o=h.showPercentage),"showRelevance"in h&&t(2,a=h.showRelevance)},n.$$.update=()=>{var h;n.$$.dirty&136&&i&&(t(3,f=(h=i.document)==null?void 0:h.map((_,T)=>{var p,D;return{source:i.source,document:_,metadata:(p=i.metadata)==null?void 0:p[T],distance:(D=i.distances)==null?void 0:D[T]}})),f.every(_=>_.distance!==void 0)&&t(3,f=f.sort((_,T)=>(T.distance??1/0)-(_.distance??1/0))))},[r,o,a,f,l,s,u,i,c,g]}class Gi extends Ae{constructor(e){super(),Le(this,e,Ji,qi,Se,{show:0,citation:7,showPercentage:1,showRelevance:2})}}function Jl(n,e,t){const l=n.slice();return l[19]=e[t],l[21]=t,l}function Gl(n,e,t){const l=n.slice();return l[19]=e[t],l[21]=t,l}function Kl(n,e,t){const l=n.slice();return l[19]=e[t],l[21]=t,l}function Zl(n){let e,t,l,s;const r=[Zi,Ki],i=[];function o(a,f){return a[1].length<=3?0:1}return t=o(n),l=i[t]=r[t](n),{c(){e=w("div"),l.c(),this.h()},l(a){e=y(a,"DIV",{class:!0});var f=k(e);l.l(f),f.forEach(m),this.h()},h(){d(e,"class","py-0.5 -mx-0.5 w-full flex gap-1 items-center flex-wrap")},m(a,f){E(a,e,f),i[t].m(e,null),s=!0},p(a,f){let u=t;t=o(a),t===u?i[t].p(a,f):(te(),M(i[u],1,1,()=>{i[u]=null}),le(),l=i[t],l?l.p(a,f):(l=i[t]=r[t](a),l.c()),v(l,1),l.m(e,null))},i(a){s||(v(l),s=!0)},o(a){M(l),s=!1},d(a){a&&m(e),i[t].d()}}}function Ki(n){let e,t,l;function s(i){n[18](i)}let r={id:`collapsible-${n[0]}`,className:"w-full max-w-full ",buttonClassName:"w-fit max-w-full",$$slots:{content:[$i],default:[Yi]},$$scope:{ctx:n}};return n[6]!==void 0&&(r.open=n[6]),e=new Jn({props:r}),ze.push(()=>Ye(e,"open",s)),{c(){Y(e.$$.fragment)},l(i){$(e.$$.fragment,i)},m(i,o){x(e,i,o),l=!0},p(i,o){const a={};o&1&&(a.id=`collapsible-${i[0]}`),o&16777458&&(a.$$scope={dirty:o,ctx:i}),!t&&o&64&&(t=!0,a.open=i[6],Xe(()=>t=!1)),e.$set(a)},i(i){l||(v(e.$$.fragment,i),l=!0)},o(i){M(e.$$.fragment,i),l=!1},d(i){ee(e,i)}}}function Zi(n){let e,t=Ve(n[1]),l=[];for(let s=0;s<t.length;s+=1)l[s]=es(Kl(n,t,s));return{c(){e=w("div");for(let s=0;s<l.length;s+=1)l[s].c();this.h()},l(s){e=y(s,"DIV",{class:!0});var r=k(e);for(let i=0;i<l.length;i+=1)l[i].l(r);r.forEach(m),this.h()},h(){d(e,"class","flex text-xs font-medium flex-wrap")},m(s,r){E(s,e,r);for(let i=0;i<l.length;i+=1)l[i]&&l[i].m(e,null)},p(s,r){if(r&563){t=Ve(s[1]);let i;for(i=0;i<t.length;i+=1){const o=Kl(s,t,i);l[i]?l[i].p(o,r):(l[i]=es(o),l[i].c(),l[i].m(e,null))}for(;i<l.length;i+=1)l[i].d(1);l.length=t.length}},i:De,o:De,d(s){s&&m(e),qe(l,s)}}}function Ql(n){let e,t=n[21]+1+"",l;return{c(){e=w("div"),l=W(t),this.h()},l(s){e=y(s,"DIV",{class:!0});var r=k(e);l=q(r,t),r.forEach(m),this.h()},h(){d(e,"class","bg-gray-50 dark:bg-gray-800 rounded-full size-4")},m(s,r){E(s,e,r),b(e,l)},d(s){s&&m(e)}}}function Xl(n){let e,t=n[1].every(n[13]),l,s,r=n[9](n[19].source.name)+"",i,o,a,f,u=t&&Ql(n);function c(){return n[17](n[19])}return{c(){e=w("button"),u&&u.c(),l=H(),s=w("div"),i=W(r),o=H(),this.h()},l(g){e=y(g,"BUTTON",{class:!0});var h=k(e);u&&u.l(h),l=z(h),s=y(h,"DIV",{class:!0});var _=k(s);i=q(_,r),_.forEach(m),o=z(h),h.forEach(m),this.h()},h(){d(s,"class","flex-1 mx-1 truncate"),d(e,"class","no-toggle outline-hidden flex dark:text-gray-300 p-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-900 dark:hover:bg-gray-850 transition rounded-xl max-w-96")},m(g,h){E(g,e,h),u&&u.m(e,null),b(e,l),b(e,s),b(s,i),b(e,o),a||(f=[he(e,"click",c),he(e,"pointerup",la)],a=!0)},p(g,h){n=g,h&2&&(t=n[1].every(n[13])),t?u||(u=Ql(n),u.c(),u.m(e,l)):u&&(u.d(1),u=null),h&2&&r!==(r=n[9](n[19].source.name)+"")&&Z(i,r)},d(g){g&&m(e),u&&u.d(),a=!1,$e(f)}}}function Qi(n){let e,t;return e=new Gn({props:{strokeWidth:"3.5",className:"size-3.5"}}),{c(){Y(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function Xi(n){let e,t;return e=new Kn({props:{strokeWidth:"3.5",className:"size-3.5"}}),{c(){Y(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function Yi(n){let e,t,l,s=n[7].t("References from")+"",r,i,o,a,f,u,c,g=n[7].t("and")+"",h,_,T=n[1].length-2+"",p,D,V,L=n[7].t("more")+"",O,P,I,N,S,C,B=Ve(n[1].slice(0,2)),F=[];for(let U=0;U<B.length;U+=1)F[U]=Xl(Jl(n,B,U));const R=[Xi,Qi],Q=[];function _e(U,ne){return U[6]?0:1}return N=_e(n),S=Q[N]=R[N](n),{c(){e=w("div"),t=w("div"),l=w("span"),r=W(s),i=H(),o=w("div"),a=w("div");for(let U=0;U<F.length;U+=1)F[U].c();f=H(),u=w("div"),c=w("span"),h=W(g),_=H(),p=W(T),D=H(),V=w("span"),O=W(L),P=H(),I=w("div"),S.c(),this.h()},l(U){e=y(U,"DIV",{class:!0});var ne=k(e);t=y(ne,"DIV",{class:!0});var fe=k(t);l=y(fe,"SPAN",{class:!0});var ue=k(l);r=q(ue,s),ue.forEach(m),i=z(fe),o=y(fe,"DIV",{class:!0});var we=k(o);a=y(we,"DIV",{class:!0});var X=k(a);for(let ke=0;ke<F.length;ke+=1)F[ke].l(X);X.forEach(m),we.forEach(m),f=z(fe),u=y(fe,"DIV",{class:!0});var re=k(u);c=y(re,"SPAN",{class:!0});var ge=k(c);h=q(ge,g),ge.forEach(m),_=z(re),p=q(re,T),D=z(re),V=y(re,"SPAN",{});var ie=k(V);O=q(ie,L),ie.forEach(m),re.forEach(m),fe.forEach(m),P=z(ne),I=y(ne,"DIV",{class:!0});var de=k(I);S.l(de),de.forEach(m),ne.forEach(m),this.h()},h(){d(l,"class","whitespace-nowrap hidden sm:inline shrink-0"),d(a,"class","flex text-xs font-medium items-center"),d(o,"class","flex items-center overflow-auto scrollbar-none w-full max-w-full flex-1"),d(c,"class","hidden sm:inline"),d(u,"class","flex items-center gap-1 whitespace-nowrap shrink-0"),d(t,"class","flex-1 flex items-center gap-1 overflow-auto scrollbar-none w-full max-w-full"),d(I,"class","shrink-0"),d(e,"class","flex w-full overflow-auto items-center gap-2 text-gray-500 hover:text-gray-600 dark:hover:text-gray-400 transition cursor-pointer")},m(U,ne){E(U,e,ne),b(e,t),b(t,l),b(l,r),b(t,i),b(t,o),b(o,a);for(let fe=0;fe<F.length;fe+=1)F[fe]&&F[fe].m(a,null);b(t,f),b(t,u),b(u,c),b(c,h),b(u,_),b(u,p),b(u,D),b(u,V),b(V,O),b(e,P),b(e,I),Q[N].m(I,null),C=!0},p(U,ne){if((!C||ne&128)&&s!==(s=U[7].t("References from")+"")&&Z(r,s),ne&562){B=Ve(U[1].slice(0,2));let ue;for(ue=0;ue<B.length;ue+=1){const we=Jl(U,B,ue);F[ue]?F[ue].p(we,ne):(F[ue]=Xl(we),F[ue].c(),F[ue].m(a,null))}for(;ue<F.length;ue+=1)F[ue].d(1);F.length=B.length}(!C||ne&128)&&g!==(g=U[7].t("and")+"")&&Z(h,g),(!C||ne&2)&&T!==(T=U[1].length-2+"")&&Z(p,T),(!C||ne&128)&&L!==(L=U[7].t("more")+"")&&Z(O,L);let fe=N;N=_e(U),N!==fe&&(te(),M(Q[fe],1,1,()=>{Q[fe]=null}),le(),S=Q[N],S||(S=Q[N]=R[N](U),S.c()),v(S,1),S.m(I,null))},i(U){C||(v(S),C=!0)},o(U){M(S),C=!1},d(U){U&&m(e),qe(F,U),Q[N].d()}}}function Yl(n){let e,t=n[21]+3+"",l;return{c(){e=w("div"),l=W(t),this.h()},l(s){e=y(s,"DIV",{class:!0});var r=k(e);l=q(r,t),r.forEach(m),this.h()},h(){d(e,"class","bg-gray-50 dark:bg-gray-800 rounded-full size-4")},m(s,r){E(s,e,r),b(e,l)},d(s){s&&m(e)}}}function $l(n){let e,t=n[1].every(n[12]),l,s,r=n[9](n[19].source.name)+"",i,o,a,f,u=t&&Yl(n);function c(){return n[16](n[19])}return{c(){e=w("button"),u&&u.c(),l=H(),s=w("div"),i=W(r),o=H(),this.h()},l(g){e=y(g,"BUTTON",{class:!0});var h=k(e);u&&u.l(h),l=z(h),s=y(h,"DIV",{class:!0});var _=k(s);i=q(_,r),_.forEach(m),o=z(h),h.forEach(m),this.h()},h(){d(s,"class","flex-1 mx-1 truncate"),d(e,"class","no-toggle outline-hidden flex dark:text-gray-300 p-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-900 dark:hover:bg-gray-850 transition rounded-xl max-w-96")},m(g,h){E(g,e,h),u&&u.m(e,null),b(e,l),b(e,s),b(s,i),b(e,o),a||(f=he(e,"click",c),a=!0)},p(g,h){n=g,h&2&&(t=n[1].every(n[12])),t?u||(u=Yl(n),u.c(),u.m(e,l)):u&&(u.d(1),u=null),h&2&&r!==(r=n[9](n[19].source.name)+"")&&Z(i,r)},d(g){g&&m(e),u&&u.d(),a=!1,f()}}}function $i(n){let e,t,l=Ve(n[1].slice(2)),s=[];for(let r=0;r<l.length;r+=1)s[r]=$l(Gl(n,l,r));return{c(){e=w("div"),t=w("div");for(let r=0;r<s.length;r+=1)s[r].c();this.h()},l(r){e=y(r,"DIV",{slot:!0});var i=k(e);t=y(i,"DIV",{class:!0});var o=k(t);for(let a=0;a<s.length;a+=1)s[a].l(o);o.forEach(m),i.forEach(m),this.h()},h(){d(t,"class","flex text-xs font-medium flex-wrap"),d(e,"slot","content")},m(r,i){E(r,e,i),b(e,t);for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(t,null)},p(r,i){if(i&562){l=Ve(r[1].slice(2));let o;for(o=0;o<l.length;o+=1){const a=Gl(r,l,o);s[o]?s[o].p(a,i):(s[o]=$l(a),s[o].c(),s[o].m(t,null))}for(;o<s.length;o+=1)s[o].d(1);s.length=l.length}},d(r){r&&m(e),qe(s,r)}}}function xl(n){let e,t=n[21]+1+"",l;return{c(){e=w("div"),l=W(t),this.h()},l(s){e=y(s,"DIV",{class:!0});var r=k(e);l=q(r,t),r.forEach(m),this.h()},h(){d(e,"class","bg-gray-50 dark:bg-gray-800 rounded-full size-4")},m(s,r){E(s,e,r),b(e,l)},d(s){s&&m(e)}}}function es(n){let e,t=n[1].every(n[11]),l,s,r=n[9](n[19].source.name)+"",i,o,a,f,u,c=t&&xl(n);function g(){return n[15](n[19])}return{c(){e=w("button"),c&&c.c(),l=H(),s=w("div"),i=W(r),o=H(),this.h()},l(h){e=y(h,"BUTTON",{id:!0,class:!0});var _=k(e);c&&c.l(_),l=z(_),s=y(_,"DIV",{class:!0});var T=k(s);i=q(T,r),T.forEach(m),o=z(_),_.forEach(m),this.h()},h(){d(s,"class","flex-1 mx-1 truncate text-black/60 hover:text-black dark:text-white/60 dark:hover:text-white transition"),d(e,"id",a=`source-${n[0]}-${n[21]+1}`),d(e,"class","no-toggle outline-hidden flex dark:text-gray-300 p-1 bg-white dark:bg-gray-900 rounded-xl max-w-96")},m(h,_){E(h,e,_),c&&c.m(e,null),b(e,l),b(e,s),b(s,i),b(e,o),f||(u=he(e,"click",g),f=!0)},p(h,_){n=h,_&2&&(t=n[1].every(n[11])),t?c||(c=xl(n),c.c(),c.m(e,l)):c&&(c.d(1),c=null),_&2&&r!==(r=n[9](n[19].source.name)+"")&&Z(i,r),_&1&&a!==(a=`source-${n[0]}-${n[21]+1}`)&&d(e,"id",a)},d(h){h&&m(e),c&&c.d(),f=!1,u()}}}function xi(n){let e,t,l,s,r;function i(f){n[14](f)}let o={citation:n[5],showPercentage:n[2],showRelevance:n[3]};n[4]!==void 0&&(o.show=n[4]),e=new Gi({props:o}),ze.push(()=>Ye(e,"show",i));let a=n[1].length>0&&Zl(n);return{c(){Y(e.$$.fragment),l=H(),a&&a.c(),s=ce()},l(f){$(e.$$.fragment,f),l=z(f),a&&a.l(f),s=ce()},m(f,u){x(e,f,u),E(f,l,u),a&&a.m(f,u),E(f,s,u),r=!0},p(f,[u]){const c={};u&32&&(c.citation=f[5]),u&4&&(c.showPercentage=f[2]),u&8&&(c.showRelevance=f[3]),!t&&u&16&&(t=!0,c.show=f[4],Xe(()=>t=!1)),e.$set(c),f[1].length>0?a?(a.p(f,u),u&2&&v(a,1)):(a=Zl(f),a.c(),v(a,1),a.m(s.parentNode,s)):a&&(te(),M(a,1,1,()=>{a=null}),le())},i(f){r||(v(e.$$.fragment,f),v(a),r=!0)},o(f){M(e.$$.fragment,f),M(a),r=!1},d(f){f&&(m(l),m(s)),ee(e,f),a&&a.d(f)}}}function ea(n){const e=n.flatMap(s=>s.distances??[]),t=e.filter(s=>s!==void 0&&s>=-1&&s<=1).length,l=e.filter(s=>s!==void 0&&(s<-1||s>1)).length;return!(e.length===0||t===e.length-1&&l===1||l===e.length-1&&t===1)}function ta(n){return n.flatMap(t=>t.distances??[]).every(t=>t!==void 0&&t>=-1&&t<=1)}const la=n=>{n.stopPropagation()};function sa(n,e,t){let l;const s=Fe("i18n");Ne(n,s,I=>t(7,l=I));let{id:r=""}=e,{sources:i=[]}=e,o=[],a=!1,f=!0,u=!1,c=null,g=!1;const h=I=>{try{return decodeURIComponent(I)}catch{return I}},_=I=>I.distances!==void 0,T=I=>I.distances!==void 0,p=I=>I.distances!==void 0;function D(I){u=I,t(4,u)}const V=I=>{t(4,u=!0),t(5,c=I)},L=I=>{t(4,u=!0),t(5,c=I)},O=I=>{t(4,u=!0),t(5,c=I)};function P(I){g=I,t(6,g)}return n.$$set=I=>{"id"in I&&t(0,r=I.id),"sources"in I&&t(10,i=I.sources)},n.$$.update=()=>{n.$$.dirty&1026&&(t(1,o=i.reduce((I,N)=>(Object.keys(N).length===0||N.document.forEach((S,C)=>{var U,ne,fe;const B=(U=N.metadata)==null?void 0:U[C],F=(ne=N.distances)==null?void 0:ne[C],R=(B==null?void 0:B.source)??((fe=N==null?void 0:N.source)==null?void 0:fe.id)??"N/A";let Q=N==null?void 0:N.source;B!=null&&B.name&&(Q={...Q,name:B.name}),(R.startsWith("http://")||R.startsWith("https://"))&&(Q={...Q,name:R,url:R});const _e=I.find(ue=>ue.id===R);_e?(_e.document.push(S),_e.metadata.push(B),F!==void 0&&_e.distances.push(F)):I.push({id:R,source:Q,document:[S],metadata:B?[B]:[],distances:F!==void 0?[F]:void 0})}),I),[])),t(3,f=ea(o)),t(2,a=ta(o)))},[r,o,a,f,u,c,g,l,s,h,i,_,T,p,D,V,L,O,P]}class na extends Ae{constructor(e){super(),Le(this,e,sa,xi,Se,{id:0,sources:10})}}function ts(n,e,t){const l=n.slice();return l[6]=e[t],l}function ls(n){let e,t,l,s;const r=[aa,ia,ra],i=[];function o(a,f){var u,c;return(u=a[1].result)!=null&&u.error?0:(c=a[1].result)!=null&&c.output?1:2}return t=o(n),l=i[t]=r[t](n),{c(){e=w("div"),l.c()},l(a){e=y(a,"DIV",{});var f=k(e);l.l(f),f.forEach(m)},m(a,f){E(a,e,f),i[t].m(e,null),s=!0},p(a,f){let u=t;t=o(a),t!==u&&(te(),M(i[u],1,1,()=>{i[u]=null}),le(),l=i[t],l||(l=i[t]=r[t](a),l.c()),v(l,1),l.m(e,null))},i(a){s||(v(l),s=!0)},o(a){M(l),s=!1},d(a){a&&m(e),i[t].d()}}}function ra(n){let e,t;return e=new xt({props:{type:"warning",content:"incomplete"}}),{c(){Y(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function ia(n){let e,t;return e=new xt({props:{type:"success",content:"success"}}),{c(){Y(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function aa(n){let e,t;return e=new xt({props:{type:"error",content:"error"}}),{c(){Y(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function ss(n){let e,t,l;return t=new $t({props:{className:"size-4"}}),{c(){e=w("div"),Y(t.$$.fragment)},l(s){e=y(s,"DIV",{});var r=k(e);$(t.$$.fragment,r),r.forEach(m)},m(s,r){E(s,e,r),x(t,e,null),l=!0},i(s){l||(v(t.$$.fragment,s),l=!0)},o(s){M(t.$$.fragment,s),l=!1},d(s){s&&m(e),ee(t)}}}function oa(n){let e=n[2].t("Code execution")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){E(l,t,s)},p(l,s){s&4&&e!==(e=l[2].t("Code execution")+"")&&Z(t,e)},d(l){l&&m(t)}}}function fa(n){var i;let e=n[2].t("Code execution")+"",t,l,s=((i=n[1])==null?void 0:i.name)+"",r;return{c(){t=W(e),l=W(": "),r=W(s)},l(o){t=q(o,e),l=q(o,": "),r=q(o,s)},m(o,a){E(o,t,a),E(o,l,a),E(o,r,a)},p(o,a){var f;a&4&&e!==(e=o[2].t("Code execution")+"")&&Z(t,e),a&2&&s!==(s=((f=o[1])==null?void 0:f.name)+"")&&Z(r,s)},d(o){o&&(m(t),m(l),m(r))}}}function ns(n){var r,i,o,a;let e,t,l=((i=(r=n[1])==null?void 0:r.result)==null?void 0:i.error)&&rs(n),s=((a=(o=n[1])==null?void 0:o.result)==null?void 0:a.output)&&is(n);return{c(){e=w("div"),l&&l.c(),t=H(),s&&s.c(),this.h()},l(f){e=y(f,"DIV",{class:!0});var u=k(e);l&&l.l(u),t=z(u),s&&s.l(u),u.forEach(m),this.h()},h(){d(e,"class","dark:bg-[#202123] dark:text-white px-4 py-4 rounded-b-lg flex flex-col gap-3")},m(f,u){E(f,e,u),l&&l.m(e,null),b(e,t),s&&s.m(e,null)},p(f,u){var c,g,h,_;(g=(c=f[1])==null?void 0:c.result)!=null&&g.error?l?l.p(f,u):(l=rs(f),l.c(),l.m(e,t)):l&&(l.d(1),l=null),(_=(h=f[1])==null?void 0:h.result)!=null&&_.output?s?s.p(f,u):(s=is(f),s.c(),s.m(e,null)):s&&(s.d(1),s=null)},d(f){f&&m(e),l&&l.d(),s&&s.d()}}}function rs(n){var f,u;let e,t,l=n[2].t("ERROR")+"",s,r,i,o=((u=(f=n[1])==null?void 0:f.result)==null?void 0:u.error)+"",a;return{c(){e=w("div"),t=w("div"),s=W(l),r=H(),i=w("div"),a=W(o),this.h()},l(c){e=y(c,"DIV",{});var g=k(e);t=y(g,"DIV",{class:!0});var h=k(t);s=q(h,l),h.forEach(m),r=z(g),i=y(g,"DIV",{class:!0});var _=k(i);a=q(_,o),_.forEach(m),g.forEach(m),this.h()},h(){d(t,"class","text-gray-500 text-xs mb-1"),d(i,"class","text-sm")},m(c,g){E(c,e,g),b(e,t),b(t,s),b(e,r),b(e,i),b(i,a)},p(c,g){var h,_;g&4&&l!==(l=c[2].t("ERROR")+"")&&Z(s,l),g&2&&o!==(o=((_=(h=c[1])==null?void 0:h.result)==null?void 0:_.error)+"")&&Z(a,o)},d(c){c&&m(e)}}}function is(n){var f,u;let e,t,l=n[2].t("OUTPUT")+"",s,r,i,o=((u=(f=n[1])==null?void 0:f.result)==null?void 0:u.output)+"",a;return{c(){e=w("div"),t=w("div"),s=W(l),r=H(),i=w("div"),a=W(o),this.h()},l(c){e=y(c,"DIV",{});var g=k(e);t=y(g,"DIV",{class:!0});var h=k(t);s=q(h,l),h.forEach(m),r=z(g),i=y(g,"DIV",{class:!0});var _=k(i);a=q(_,o),_.forEach(m),g.forEach(m),this.h()},h(){d(t,"class","text-gray-500 text-xs mb-1"),d(i,"class","text-sm")},m(c,g){E(c,e,g),b(e,t),b(t,s),b(e,r),b(e,i),b(i,a)},p(c,g){var h,_;g&4&&l!==(l=c[2].t("OUTPUT")+"")&&Z(s,l),g&2&&o!==(o=((_=(h=c[1])==null?void 0:h.result)==null?void 0:_.output)+"")&&Z(a,o)},d(c){c&&m(e)}}}function as(n){var c,g;let e,t,l,s,r=n[2].t("Files")+"",i,o,a,f=Ve((g=(c=n[1])==null?void 0:c.result)==null?void 0:g.files),u=[];for(let h=0;h<f.length;h+=1)u[h]=os(ts(n,f,h));return{c(){e=w("div"),t=w("hr"),l=H(),s=w("div"),i=W(r),o=H(),a=w("ul");for(let h=0;h<u.length;h+=1)u[h].c();this.h()},l(h){e=y(h,"DIV",{class:!0});var _=k(e);t=y(_,"HR",{class:!0}),l=z(_),s=y(_,"DIV",{class:!0});var T=k(s);i=q(T,r),T.forEach(m),o=z(_),a=y(_,"UL",{class:!0});var p=k(a);for(let D=0;D<u.length;D+=1)u[D].l(p);p.forEach(m),_.forEach(m),this.h()},h(){d(t,"class","border-gray-100 dark:border-gray-850 my-2"),d(s,"class","text-sm font-medium dark:text-gray-300"),d(a,"class","mt-1 list-disc pl-4 text-xs"),d(e,"class","flex flex-col w-full")},m(h,_){E(h,e,_),b(e,t),b(e,l),b(e,s),b(s,i),b(e,o),b(e,a);for(let T=0;T<u.length;T+=1)u[T]&&u[T].m(a,null)},p(h,_){var T,p;if(_&4&&r!==(r=h[2].t("Files")+"")&&Z(i,r),_&2){f=Ve((p=(T=h[1])==null?void 0:T.result)==null?void 0:p.files);let D;for(D=0;D<f.length;D+=1){const V=ts(h,f,D);u[D]?u[D].p(V,_):(u[D]=os(V),u[D].c(),u[D].m(a,null))}for(;D<u.length;D+=1)u[D].d(1);u.length=f.length}},d(h){h&&m(e),qe(u,h)}}}function os(n){let e,t,l=n[6].name+"",s,r,i;return{c(){e=w("li"),t=w("a"),s=W(l),i=H(),this.h()},l(o){e=y(o,"LI",{});var a=k(e);t=y(a,"A",{href:!0,target:!0});var f=k(t);s=q(f,l),f.forEach(m),i=z(a),a.forEach(m),this.h()},h(){d(t,"href",r=n[6].url),d(t,"target","_blank")},m(o,a){E(o,e,a),b(e,t),b(t,s),b(e,i)},p(o,a){a&2&&l!==(l=o[6].name+"")&&Z(s,l),a&2&&r!==(r=o[6].url)&&d(t,"href",r)},d(o){o&&m(e)}}}function ua(n){var R,Q,_e,U,ne,fe,ue,we,X,re,ge,ie,de,ke,ye,J,me,ae,A;let e,t,l,s,r,i,o,a,f,u,c,g,h,_,T,p,D,V,L,O,P=((R=n[1])==null?void 0:R.result)&&ls(n),I=!((Q=n[1])!=null&&Q.result)&&ss();function N(K,G){var oe;return(oe=K[1])!=null&&oe.name?fa:oa}let S=N(n),C=S(n);u=new Wt({props:{className:"size-5"}}),T=new Kr({props:{id:"code-exec-"+((_e=n[1])==null?void 0:_e.id)+"-code",lang:((U=n[1])==null?void 0:U.language)??"",code:((ne=n[1])==null?void 0:ne.code)??"",className:"",editorClassName:(fe=n[1])!=null&&fe.result&&((we=(ue=n[1])==null?void 0:ue.result)!=null&&we.error||(re=(X=n[1])==null?void 0:X.result)!=null&&re.output)?"rounded-b-none":"",stickyButtonsClassName:"top-0",run:!1}});let B=((ge=n[1])==null?void 0:ge.result)&&(((de=(ie=n[1])==null?void 0:ie.result)==null?void 0:de.error)||((ye=(ke=n[1])==null?void 0:ke.result)==null?void 0:ye.output))&&ns(n),F=((me=(J=n[1])==null?void 0:J.result)==null?void 0:me.files)&&((A=(ae=n[1])==null?void 0:ae.result)==null?void 0:A.files.length)>0&&as(n);return{c(){e=w("div"),t=w("div"),l=w("div"),P&&P.c(),s=H(),r=w("div"),I&&I.c(),i=H(),o=w("div"),C.c(),a=H(),f=w("button"),Y(u.$$.fragment),c=H(),g=w("div"),h=w("div"),_=w("div"),Y(T.$$.fragment),p=H(),B&&B.c(),D=H(),F&&F.c(),this.h()},l(K){e=y(K,"DIV",{});var G=k(e);t=y(G,"DIV",{class:!0});var oe=k(t);l=y(oe,"DIV",{class:!0});var be=k(l);P&&P.l(be),s=z(be),r=y(be,"DIV",{class:!0});var Ee=k(r);I&&I.l(Ee),i=z(Ee),o=y(Ee,"DIV",{});var Me=k(o);C.l(Me),Me.forEach(m),Ee.forEach(m),be.forEach(m),a=z(oe),f=y(oe,"BUTTON",{class:!0});var Oe=k(f);$(u.$$.fragment,Oe),Oe.forEach(m),oe.forEach(m),c=z(G),g=y(G,"DIV",{class:!0});var Ue=k(g);h=y(Ue,"DIV",{class:!0});var He=k(h);_=y(He,"DIV",{class:!0});var se=k(_);$(T.$$.fragment,se),se.forEach(m),p=z(He),B&&B.l(He),D=z(He),F&&F.l(He),He.forEach(m),Ue.forEach(m),G.forEach(m),this.h()},h(){d(r,"class","flex gap-2 items-center"),d(l,"class","text-lg font-medium self-center flex flex-col gap-0.5 capitalize"),d(f,"class","self-center"),d(t,"class","flex justify-between dark:text-gray-300 px-5 pt-4 pb-2"),d(_,"class","flex flex-col w-full"),d(h,"class","flex flex-col w-full dark:text-gray-200 overflow-y-scroll max-h-[22rem] scrollbar-hidden"),d(g,"class","flex flex-col md:flex-row w-full px-4 pb-5")},m(K,G){E(K,e,G),b(e,t),b(t,l),P&&P.m(l,null),b(l,s),b(l,r),I&&I.m(r,null),b(r,i),b(r,o),C.m(o,null),b(t,a),b(t,f),x(u,f,null),b(e,c),b(e,g),b(g,h),b(h,_),x(T,_,null),b(h,p),B&&B.m(h,null),b(h,D),F&&F.m(h,null),V=!0,L||(O=he(f,"click",n[4]),L=!0)},p(K,G){var be,Ee,Me,Oe,Ue,He,se,Ge,Ke,Je,xe,at,ct,dt,ot,Ct,St,Bt,Ot;(be=K[1])!=null&&be.result?P?(P.p(K,G),G&2&&v(P,1)):(P=ls(K),P.c(),v(P,1),P.m(l,s)):P&&(te(),M(P,1,1,()=>{P=null}),le()),(Ee=K[1])!=null&&Ee.result?I&&(te(),M(I,1,1,()=>{I=null}),le()):I?G&2&&v(I,1):(I=ss(),I.c(),v(I,1),I.m(r,i)),S===(S=N(K))&&C?C.p(K,G):(C.d(1),C=S(K),C&&(C.c(),C.m(o,null)));const oe={};G&2&&(oe.id="code-exec-"+((Me=K[1])==null?void 0:Me.id)+"-code"),G&2&&(oe.lang=((Oe=K[1])==null?void 0:Oe.language)??""),G&2&&(oe.code=((Ue=K[1])==null?void 0:Ue.code)??""),G&2&&(oe.editorClassName=(He=K[1])!=null&&He.result&&((Ge=(se=K[1])==null?void 0:se.result)!=null&&Ge.error||(Je=(Ke=K[1])==null?void 0:Ke.result)!=null&&Je.output)?"rounded-b-none":""),T.$set(oe),(xe=K[1])!=null&&xe.result&&((ct=(at=K[1])==null?void 0:at.result)!=null&&ct.error||(ot=(dt=K[1])==null?void 0:dt.result)!=null&&ot.output)?B?B.p(K,G):(B=ns(K),B.c(),B.m(h,D)):B&&(B.d(1),B=null),(St=(Ct=K[1])==null?void 0:Ct.result)!=null&&St.files&&((Ot=(Bt=K[1])==null?void 0:Bt.result)==null?void 0:Ot.files.length)>0?F?F.p(K,G):(F=as(K),F.c(),F.m(h,null)):F&&(F.d(1),F=null)},i(K){V||(v(P),v(I),v(u.$$.fragment,K),v(T.$$.fragment,K),V=!0)},o(K){M(P),M(I),M(u.$$.fragment,K),M(T.$$.fragment,K),V=!1},d(K){K&&m(e),P&&P.d(),I&&I.d(),C.d(),ee(u),ee(T),B&&B.d(),F&&F.d(),L=!1,O()}}}function ca(n){let e,t,l;function s(i){n[5](i)}let r={size:"lg",$$slots:{default:[ua]},$$scope:{ctx:n}};return n[0]!==void 0&&(r.show=n[0]),e=new Qn({props:r}),ze.push(()=>Ye(e,"show",s)),{c(){Y(e.$$.fragment)},l(i){$(e.$$.fragment,i)},m(i,o){x(e,i,o),l=!0},p(i,[o]){const a={};o&519&&(a.$$scope={dirty:o,ctx:i}),!t&&o&1&&(t=!0,a.show=i[0],Xe(()=>t=!1)),e.$set(a)},i(i){l||(v(e.$$.fragment,i),l=!0)},o(i){M(e.$$.fragment,i),l=!1},d(i){ee(e,i)}}}function da(n,e,t){let l;const s=Fe("i18n");Ne(n,s,f=>t(2,l=f));let{show:r=!1}=e,{codeExecution:i=null}=e;const o=()=>{t(0,r=!1),t(1,i=null)};function a(f){r=f,t(0,r)}return n.$$set=f=>{"show"in f&&t(0,r=f.show),"codeExecution"in f&&t(1,i=f.codeExecution)},[r,i,l,s,o,a]}class ha extends Ae{constructor(e){super(),Le(this,e,da,ca,Se,{show:0,codeExecution:1})}}function fs(n,e,t){const l=n.slice();return l[6]=e[t],l}function us(n){let e,t=[],l=new Map,s,r=Ve(n[0]);const i=o=>o[6].id;for(let o=0;o<r.length;o+=1){let a=fs(n,r,o),f=i(a);l.set(f,t[o]=cs(f,a))}return{c(){e=w("div");for(let o=0;o<t.length;o+=1)t[o].c();this.h()},l(o){e=y(o,"DIV",{class:!0});var a=k(e);for(let f=0;f<t.length;f+=1)t[f].l(a);a.forEach(m),this.h()},h(){d(e,"class","mt-1 mb-2 w-full flex gap-1 items-center flex-wrap")},m(o,a){E(o,e,a);for(let f=0;f<t.length;f+=1)t[f]&&t[f].m(e,null);s=!0},p(o,a){a&7&&(r=Ve(o[0]),te(),t=Ht(t,a,i,1,o,r,l,e,Kt,cs,null,fs),le())},i(o){if(!s){for(let a=0;a<r.length;a+=1)v(t[a]);s=!0}},o(o){for(let a=0;a<t.length;a+=1)M(t[a]);s=!1},d(o){o&&m(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}function ma(n){let e,t;return e=new $t({props:{className:"size-4"}}),{c(){Y(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},p:De,i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function ga(n){let e,t,l,s;const r=[pa,ba,_a],i=[];function o(a,f){var u,c;return(u=a[6].result)!=null&&u.error?0:(c=a[6].result)!=null&&c.output?1:2}return e=o(n),t=i[e]=r[e](n),{c(){t.c(),l=ce()},l(a){t.l(a),l=ce()},m(a,f){i[e].m(a,f),E(a,l,f),s=!0},p(a,f){let u=e;e=o(a),e!==u&&(te(),M(i[u],1,1,()=>{i[u]=null}),le(),t=i[e],t||(t=i[e]=r[e](a),t.c()),v(t,1),t.m(l.parentNode,l))},i(a){s||(v(t),s=!0)},o(a){M(t),s=!1},d(a){a&&m(l),i[e].d(a)}}}function _a(n){let e,t;return e=new ei({}),{c(){Y(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function ba(n){let e,t;return e=new xr({props:{strokeWidth:"3",className:"size-3"}}),{c(){Y(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function pa(n){let e,t;return e=new Wt({}),{c(){Y(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function cs(n,e){let t,l,s,r,i,o,a,f=e[6].name+"",u,c,g,h,_,T;const p=[ga,ma],D=[];function V(O,P){var I;return(I=O[6])!=null&&I.result?0:1}r=V(e),i=D[r]=p[r](e);function L(){return e[4](e[6])}return{key:n,first:null,c(){t=w("div"),l=w("button"),s=w("div"),i.c(),o=H(),a=w("div"),u=W(f),g=H(),this.h()},l(O){t=y(O,"DIV",{class:!0});var P=k(t);l=y(P,"BUTTON",{class:!0});var I=k(l);s=y(I,"DIV",{class:!0});var N=k(s);i.l(N),N.forEach(m),o=z(I),a=y(I,"DIV",{class:!0});var S=k(a);u=q(S,f),S.forEach(m),I.forEach(m),g=z(P),P.forEach(m),this.h()},h(){var O;d(s,"class","bg-white dark:bg-gray-700 rounded-full size-4 flex items-center justify-center"),d(a,"class",c="flex-1 mx-2 line-clamp-1 code-execution-name "+((O=e[6])!=null&&O.result?"":"pulse")+" svelte-1gvtig2"),d(l,"class","flex dark:text-gray-300 py-1 px-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-850 dark:hover:bg-gray-800 transition rounded-xl max-w-96"),d(t,"class","flex gap-1 text-xs font-semibold"),this.first=t},m(O,P){E(O,t,P),b(t,l),b(l,s),D[r].m(s,null),b(l,o),b(l,a),b(a,u),b(t,g),h=!0,_||(T=he(l,"click",L),_=!0)},p(O,P){var N;e=O;let I=r;r=V(e),r===I?D[r].p(e,P):(te(),M(D[I],1,1,()=>{D[I]=null}),le(),i=D[r],i?i.p(e,P):(i=D[r]=p[r](e),i.c()),v(i,1),i.m(s,null)),(!h||P&1)&&f!==(f=e[6].name+"")&&Z(u,f),(!h||P&1&&c!==(c="flex-1 mx-2 line-clamp-1 code-execution-name "+((N=e[6])!=null&&N.result?"":"pulse")+" svelte-1gvtig2"))&&d(a,"class",c)},i(O){h||(v(i),h=!0)},o(O){M(i),h=!1},d(O){O&&m(t),D[r].d(),_=!1,T()}}}function va(n){let e,t,l,s,r;function i(f){n[3](f)}let o={codeExecution:n[1]};n[2]!==void 0&&(o.show=n[2]),e=new ha({props:o}),ze.push(()=>Ye(e,"show",i));let a=n[0].length>0&&us(n);return{c(){Y(e.$$.fragment),l=H(),a&&a.c(),s=ce()},l(f){$(e.$$.fragment,f),l=z(f),a&&a.l(f),s=ce()},m(f,u){x(e,f,u),E(f,l,u),a&&a.m(f,u),E(f,s,u),r=!0},p(f,[u]){const c={};u&2&&(c.codeExecution=f[1]),!t&&u&4&&(t=!0,c.show=f[2],Xe(()=>t=!1)),e.$set(c),f[0].length>0?a?(a.p(f,u),u&1&&v(a,1)):(a=us(f),a.c(),v(a,1),a.m(s.parentNode,s)):a&&(te(),M(a,1,1,()=>{a=null}),le())},i(f){r||(v(e.$$.fragment,f),v(a),r=!0)},o(f){M(e.$$.fragment,f),M(a),r=!1},d(f){f&&(m(l),m(s)),ee(e,f),a&&a.d(f)}}}function ka(n,e,t){let{codeExecutions:l=[]}=e,s=null,r=!1;const i=()=>{s&&t(1,s=l.find(f=>f.id===s.id))};function o(f){r=f,t(2,r)}const a=f=>{t(1,s=f),t(2,r=!0)};return n.$$set=f=>{"codeExecutions"in f&&t(0,l=f.codeExecutions)},n.$$.update=()=>{n.$$.dirty&1&&l&&i()},[l,s,r,o,a]}class wa extends Ae{constructor(e){super(),Le(this,e,ka,va,Se,{codeExecutions:0})}}function ya(n){let e,t;return{c(){e=pe("svg"),t=pe("path"),this.h()},l(l){e=ve(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=ve(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(m),s.forEach(m),this.h()},h(){d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"d","M8.625 12a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H8.25m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H12m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0h-.375M21 12c0 4.556-4.03 8.25-9 8.25a9.764 9.764 0 0 1-2.555-.337A5.972 5.972 0 0 1 5.41 20.97a5.969 5.969 0 0 1-.474-.065 4.48 4.48 0 0 0 .978-2.025c.09-.457-.133-.901-.467-1.226C3.93 16.178 3 14.189 3 12c0-4.556 4.03-8.25 9-8.25s9 3.694 9 8.25Z"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"fill","none"),d(e,"viewBox","0 0 24 24"),d(e,"stroke-width",n[1]),d(e,"stroke","currentColor"),d(e,"class",n[0])},m(l,s){E(l,e,s),b(e,t)},p(l,[s]){s&2&&d(e,"stroke-width",l[1]),s&1&&d(e,"class",l[0])},i:De,o:De,d(l){l&&m(e)}}}function Ia(n,e,t){let{className:l="size-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,l=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[l,s]}class Ma extends Ae{constructor(e){super(),Le(this,e,Ia,ya,Se,{className:0,strokeWidth:1})}}function Ea(n){let e,t,l,s,r,i,o,a,f,u,c,g;s=new Tt({props:{id:`${n[0]}-float-prompt`,content:n[4]}});const h=[Va,Da],_=[];function T(D,V){return V&32&&(a=null),a==null&&(a=D[5].trim()===""),a?0:1}f=T(n,-1),u=_[f]=h[f](n);let p=n[6]&&ds(n);return{c(){e=w("div"),t=w("div"),l=w("div"),Y(s.$$.fragment),r=H(),i=w("div"),o=w("div"),u.c(),c=H(),p&&p.c(),this.h()},l(D){e=y(D,"DIV",{class:!0});var V=k(e);t=y(V,"DIV",{class:!0});var L=k(t);l=y(L,"DIV",{class:!0});var O=k(l);$(s.$$.fragment,O),O.forEach(m),L.forEach(m),r=z(V),i=y(V,"DIV",{class:!0});var P=k(i);o=y(P,"DIV",{class:!0,id:!0});var I=k(o);u.l(I),c=z(I),p&&p.l(I),I.forEach(m),P.forEach(m),V.forEach(m),this.h()},h(){d(l,"class","font-medium"),d(t,"class","bg-gray-50/50 dark:bg-gray-800 dark:text-gray-100 text-medium rounded-xl px-3.5 py-3 w-full"),d(o,"class","max-h-80 overflow-y-auto w-full markdown-prose-xs"),d(o,"id","response-container"),d(i,"class","bg-white dark:bg-gray-850 dark:text-gray-100 text-medium rounded-xl px-3.5 py-3 w-full"),d(e,"class","bg-white dark:bg-gray-850 dark:text-gray-100 rounded-xl shadow-xl w-80 max-w-full")},m(D,V){E(D,e,V),b(e,t),b(t,l),x(s,l,null),b(e,r),b(e,i),b(i,o),_[f].m(o,null),b(o,c),p&&p.m(o,null),g=!0},p(D,V){const L={};V&1&&(L.id=`${D[0]}-float-prompt`),V&16&&(L.content=D[4]),s.$set(L);let O=f;f=T(D,V),f===O?_[f].p(D,V):(te(),M(_[O],1,1,()=>{_[O]=null}),le(),u=_[f],u?u.p(D,V):(u=_[f]=h[f](D),u.c()),v(u,1),u.m(o,c)),D[6]?p?p.p(D,V):(p=ds(D),p.c(),p.m(o,null)):p&&(p.d(1),p=null)},i(D){g||(v(s.$$.fragment,D),v(u),g=!0)},o(D){M(s.$$.fragment,D),M(u),g=!1},d(D){D&&m(e),ee(s),_[f].d(),p&&p.d()}}}function Na(n){let e,t,l,s;const r=[Ca,Ta],i=[];function o(a,f){return a[1]?1:0}return e=o(n),t=i[e]=r[e](n),{c(){t.c(),l=ce()},l(a){t.l(a),l=ce()},m(a,f){i[e].m(a,f),E(a,l,f),s=!0},p(a,f){let u=e;e=o(a),e===u?i[e].p(a,f):(te(),M(i[u],1,1,()=>{i[u]=null}),le(),t=i[e],t?t.p(a,f):(t=i[e]=r[e](a),t.c()),v(t,1),t.m(l.parentNode,l))},i(a){s||(v(t),s=!0)},o(a){M(t),s=!1},d(a){a&&m(l),i[e].d(a)}}}function Da(n){let e,t;return e=new Tt({props:{id:`${n[0]}-float-response`,content:n[5]}}),{c(){Y(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},p(l,s){const r={};s&1&&(r.id=`${l[0]}-float-response`),s&32&&(r.content=l[5]),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function Va(n){let e,t;return e=new Xt({props:{size:"sm"}}),{c(){Y(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},p:De,i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function ds(n){let e,t,l=n[7].t("Add")+"",s,r,i;return{c(){e=w("div"),t=w("button"),s=W(l),this.h()},l(o){e=y(o,"DIV",{class:!0});var a=k(e);t=y(a,"BUTTON",{class:!0});var f=k(t);s=q(f,l),f.forEach(m),a.forEach(m),this.h()},h(){d(t,"class","px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full"),d(e,"class","flex justify-end pt-3 text-sm font-medium")},m(o,a){E(o,e,a),b(e,t),b(t,s),r||(i=he(t,"click",n[11]),r=!0)},p(o,a){a&128&&l!==(l=o[7].t("Add")+"")&&Z(s,l)},d(o){o&&m(e),r=!1,i()}}}function Ta(n){let e,t,l,s,r,i,o,a,f,u,c;return{c(){e=w("div"),t=w("input"),s=H(),r=w("div"),i=w("button"),o=pe("svg"),a=pe("path"),this.h()},l(g){e=y(g,"DIV",{class:!0});var h=k(e);t=y(h,"INPUT",{type:!0,id:!0,class:!0,placeholder:!0}),s=z(h),r=y(h,"DIV",{class:!0});var _=k(r);i=y(_,"BUTTON",{class:!0});var T=k(i);o=ve(T,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var p=k(o);a=ve(p,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),k(a).forEach(m),p.forEach(m),T.forEach(m),_.forEach(m),h.forEach(m),this.h()},h(){d(t,"type","text"),d(t,"id","floating-message-input"),d(t,"class","ml-5 bg-transparent outline-hidden w-full flex-1 text-sm"),d(t,"placeholder",l=n[7].t("Ask a question")),d(a,"fill-rule","evenodd"),d(a,"d","M8 14a.75.75 0 0 1-.75-.75V4.56L4.03 7.78a.75.75 0 0 1-1.06-1.06l4.5-4.5a.75.75 0 0 1 1.06 0l4.5 4.5a.75.75 0 0 1-1.06 1.06L8.75 4.56v8.69A.75.75 0 0 1 8 14Z"),d(a,"clip-rule","evenodd"),d(o,"xmlns","http://www.w3.org/2000/svg"),d(o,"viewBox","0 0 16 16"),d(o,"fill","currentColor"),d(o,"class","size-4"),d(i,"class",f=(n[3]!==""?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled")+" transition rounded-full p-1.5 m-0.5 self-center"),d(r,"class","ml-1 mr-2"),d(e,"class","py-1 flex dark:text-gray-100 bg-gray-50 dark:bg-gray-800 border border-gray-100 dark:border-gray-850 w-72 rounded-full shadow-xl")},m(g,h){E(g,e,h),b(e,t),ut(t,n[3]),b(e,s),b(e,r),b(r,i),b(i,o),b(o,a),u||(c=[he(t,"input",n[18]),he(t,"keydown",n[19]),he(i,"click",n[20])],u=!0)},p(g,h){h&128&&l!==(l=g[7].t("Ask a question"))&&d(t,"placeholder",l),h&8&&t.value!==g[3]&&ut(t,g[3]),h&8&&f!==(f=(g[3]!==""?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled")+" transition rounded-full p-1.5 m-0.5 self-center")&&d(i,"class",f)},i:De,o:De,d(g){g&&m(e),u=!1,$e(c)}}}function Ca(n){let e,t,l,s,r,i=n[7].t("Ask")+"",o,a,f,u,c,g,h=n[7].t("Explain")+"",_,T,p,D;return l=new Ma({props:{className:"size-3 shrink-0"}}),u=new Zr({props:{className:"size-3 shrink-0"}}),{c(){e=w("div"),t=w("button"),Y(l.$$.fragment),s=H(),r=w("div"),o=W(i),a=H(),f=w("button"),Y(u.$$.fragment),c=H(),g=w("div"),_=W(h),this.h()},l(V){e=y(V,"DIV",{class:!0});var L=k(e);t=y(L,"BUTTON",{class:!0});var O=k(t);$(l.$$.fragment,O),s=z(O),r=y(O,"DIV",{class:!0});var P=k(r);o=q(P,i),P.forEach(m),O.forEach(m),a=z(L),f=y(L,"BUTTON",{class:!0});var I=k(f);$(u.$$.fragment,I),c=z(I),g=y(I,"DIV",{class:!0});var N=k(g);_=q(N,h),N.forEach(m),I.forEach(m),L.forEach(m),this.h()},h(){d(r,"class","shrink-0"),d(t,"class","px-1 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-sm flex items-center gap-1 min-w-fit"),d(g,"class","shrink-0"),d(f,"class","px-1 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-sm flex items-center gap-1 min-w-fit"),d(e,"class","flex flex-row gap-0.5 shrink-0 p-1 bg-white dark:bg-gray-850 dark:text-gray-100 text-medium rounded-lg shadow-xl")},m(V,L){E(V,e,L),b(e,t),x(l,t,null),b(t,s),b(t,r),b(r,o),b(e,a),b(e,f),x(u,f,null),b(f,c),b(f,g),b(g,_),T=!0,p||(D=[he(t,"click",n[16]),he(f,"click",n[17])],p=!0)},p(V,L){(!T||L&128)&&i!==(i=V[7].t("Ask")+"")&&Z(o,i),(!T||L&128)&&h!==(h=V[7].t("Explain")+"")&&Z(_,h)},i(V){T||(v(l.$$.fragment,V),v(u.$$.fragment,V),T=!0)},o(V){M(l.$$.fragment,V),M(u.$$.fragment,V),T=!1},d(V){V&&m(e),ee(l),ee(u),p=!1,$e(D)}}}function Sa(n){let e,t,l,s,r;const i=[Na,Ea],o=[];function a(f,u){return f[5]===null?0:1}return t=a(n),l=o[t]=i[t](n),{c(){e=w("div"),l.c(),this.h()},l(f){e=y(f,"DIV",{id:!0,class:!0,style:!0});var u=k(e);l.l(u),u.forEach(m),this.h()},h(){d(e,"id",s=`floating-buttons-${n[0]}`),d(e,"class","absolute rounded-lg mt-1 text-xs z-9999"),At(e,"display","none")},m(f,u){E(f,e,u),o[t].m(e,null),r=!0},p(f,[u]){let c=t;t=a(f),t===c?o[t].p(f,u):(te(),M(o[c],1,1,()=>{o[c]=null}),le(),l=o[t],l?l.p(f,u):(l=o[t]=i[t](f),l.c()),v(l,1),l.m(e,null)),(!r||u&1&&s!==(s=`floating-buttons-${f[0]}`))&&d(e,"id",s)},i(f){r||(v(l),r=!0)},o(f){M(l),r=!1},d(f){f&&m(e),o[t].d()}}}function Ba(n,e,t){let l;const s=Fe("i18n");Ne(n,s,C=>t(7,l=C));let{id:r=""}=e,{model:i=null}=e,{messages:o=[]}=e,{onAdd:a=()=>{}}=e,f=!1,u="",c="",g="",h=null,_=!1;const T=async()=>{const C=document.getElementById("response-container");C.scrollHeight-C.clientHeight<=C.scrollTop+50&&(C.scrollTop=C.scrollHeight)},p=async()=>{if(!i){je.error("Model not selected");return}t(4,g=[...u.split(`
`).map(F=>`> ${F}`),"",c].join(`
`)),t(3,c=""),t(5,h="");const[C,B]=await Ml(localStorage.token,{model:i,messages:[...o,{role:"user",content:g}].map(F=>({role:F.role,content:F.content})),stream:!0});if(C&&C.ok){const F=C.body.getReader(),R=new TextDecoder;await(async()=>{var _e,U;for(;;){const{done:ne,value:fe}=await F.read();if(ne)break;const we=R.decode(fe,{stream:!0}).split(`
`).filter(X=>X.trim()!=="");for(const X of we)if(X.startsWith("data: "))if(X.startsWith("data: [DONE]")){t(6,_=!0),await Te(),T();continue}else try{const re=JSON.parse(X.slice(6));re.choices&&((U=(_e=re.choices[0])==null?void 0:_e.delta)!=null&&U.content)&&(t(5,h+=re.choices[0].delta.content),T())}catch(re){console.error(re)}}})()}else je.error("An error occurred while fetching the explanation")},D=async()=>{if(!i){je.error("Model not selected");return}const C=u.split(`
`).map(R=>`> ${R}`).join(`
`);t(4,g=`${C}

Explain`),t(5,h="");const[B,F]=await Ml(localStorage.token,{model:i,messages:[...o,{role:"user",content:g}].map(R=>({role:R.role,content:R.content})),stream:!0});if(B&&B.ok){const R=B.body.getReader(),Q=new TextDecoder;await(async()=>{var U,ne;for(;;){const{done:fe,value:ue}=await R.read();if(fe)break;const X=Q.decode(ue,{stream:!0}).split(`
`).filter(re=>re.trim()!=="");for(const re of X)if(re.startsWith("data: "))if(re.startsWith("data: [DONE]")){t(6,_=!0),await Te(),T();continue}else try{const ge=JSON.parse(re.slice(6));ge.choices&&((ne=(U=ge.choices[0])==null?void 0:U.delta)!=null&&ne.content)&&(t(5,h+=ge.choices[0].delta.content),T())}catch(ge){console.error(ge)}}})()}else je.error("An error occurred while fetching the explanation")},V=async()=>{a({modelId:i,parentId:r,messages:[{role:"user",content:g},{role:"assistant",content:h}]})},L=()=>{t(5,h=null),t(6,_=!1),t(1,f=!1),t(3,c="")},O=async()=>{t(2,u=window.getSelection().toString()),t(1,f=!0),await Te(),setTimeout(()=>{const C=document.getElementById("floating-message-input");C&&C.focus()},0)},P=()=>{t(2,u=window.getSelection().toString()),D()};function I(){c=this.value,t(3,c)}const N=C=>{C.key==="Enter"&&p()},S=()=>{p()};return n.$$set=C=>{"id"in C&&t(0,r=C.id),"model"in C&&t(12,i=C.model),"messages"in C&&t(13,o=C.messages),"onAdd"in C&&t(14,a=C.onAdd)},[r,f,u,c,g,h,_,l,s,p,D,V,i,o,a,L,O,P,I,N,S]}class Oa extends Ae{constructor(e){super(),Le(this,e,Ba,Sa,Se,{id:0,model:12,messages:13,onAdd:14,closeHandler:15})}get closeHandler(){return this.$$.ctx[15]}}function hs(n){var s,r,i;let e,t,l={id:n[0],model:(n[3]??[]).includes((s=n[5])==null?void 0:s.id)?(r=n[5])==null?void 0:r.id:(n[3]??[]).length>0?n[3].at(0):(i=n[5])==null?void 0:i.id,messages:Gt(n[2],n[0]),onAdd:n[24]};return e=new Oa({props:l}),n[25](e),{c(){Y(e.$$.fragment)},l(o){$(e.$$.fragment,o)},m(o,a){x(e,o,a),t=!0},p(o,a){var u,c,g;const f={};a&1&&(f.id=o[0]),a&40&&(f.model=(o[3]??[]).includes((u=o[5])==null?void 0:u.id)?(c=o[5])==null?void 0:c.id:(o[3]??[]).length>0?o[3].at(0):(g=o[5])==null?void 0:g.id),a&5&&(f.messages=Gt(o[2],o[0])),a&8192&&(f.onAdd=o[24]),e.$set(f)},i(o){t||(v(e.$$.fragment,o),t=!0)},o(o){M(e.$$.fragment,o),t=!1},d(o){n[25](null),ee(e,o)}}}function Ra(n){let e,t,l,s,r;t=new Tt({props:{id:n[0],content:n[1],model:n[5],save:n[7],preview:n[8],done:n[4],sourceIds:(n[6]??[]).reduce(n[20],[]),onSourceClick:n[11],onTaskClick:n[12],onSave:n[10],onUpdate:n[21],onPreview:n[22]}});let i=n[9]&&n[5]&&hs(n);return{c(){e=w("div"),Y(t.$$.fragment),l=H(),i&&i.c(),s=ce()},l(o){e=y(o,"DIV",{});var a=k(e);$(t.$$.fragment,a),a.forEach(m),l=z(o),i&&i.l(o),s=ce()},m(o,a){E(o,e,a),x(t,e,null),n[23](e),E(o,l,a),i&&i.m(o,a),E(o,s,a),r=!0},p(o,[a]){const f={};a&1&&(f.id=o[0]),a&2&&(f.content=o[1]),a&32&&(f.model=o[5]),a&128&&(f.save=o[7]),a&256&&(f.preview=o[8]),a&16&&(f.done=o[4]),a&96&&(f.sourceIds=(o[6]??[]).reduce(o[20],[])),a&2048&&(f.onSourceClick=o[11]),a&4096&&(f.onTaskClick=o[12]),a&1024&&(f.onSave=o[10]),a&458752&&(f.onUpdate=o[21]),t.$set(f),o[9]&&o[5]?i?(i.p(o,a),a&544&&v(i,1)):(i=hs(o),i.c(),v(i,1),i.m(s.parentNode,s)):i&&(te(),M(i,1,1,()=>{i=null}),le())},i(o){r||(v(t.$$.fragment,o),v(i),r=!0)},o(o){M(t.$$.fragment,o),M(i),r=!1},d(o){o&&(m(e),m(l),m(s)),ee(t),n[23](null),i&&i.d(o)}}}function Pa(n,e,t){let l,s,r;Ne(n,zn,U=>t(16,l=U)),Ne(n,bt,U=>t(17,s=U)),Ne(n,Or,U=>t(18,r=U)),Fe("i18n");let{id:i}=e,{content:o}=e,{history:a}=e,{selectedModels:f=[]}=e,{done:u=!0}=e,{model:c=null}=e,{sources:g=null}=e,{save:h=!1}=e,{preview:_=!1}=e,{floatingButtons:T=!0}=e,{onSave:p=U=>{}}=e,{onSourceClick:D=U=>{}}=e,{onTaskClick:V=U=>{}}=e,{onAddMessages:L=U=>{}}=e,O,P;const I=U=>{const ne=document.getElementById(`floating-buttons-${i}`);if(!(O!=null&&O.contains(U.target))&&!(ne!=null&&ne.contains(U.target))){N();return}setTimeout(async()=>{if(await Te(),!(O!=null&&O.contains(U.target)))return;let fe=window.getSelection();if(fe.toString().trim().length>0){const we=fe.getRangeAt(0).getBoundingClientRect(),X=O.getBoundingClientRect(),re=we.bottom-X.top,ge=we.left-X.left;if(ne){ne.style.display="block";const ie=X.width-ge;let de=l?window.innerWidth/2:window.innerWidth/3;if(ie<de){const ke=X.right-we.right;ne.style.right=`${ke}px`,ne.style.left="auto"}else ne.style.left=`${ge}px`,ne.style.right="auto";ne.style.top=`${re+5}px`}}else N()},0)},N=()=>{const U=document.getElementById(`floating-buttons-${i}`);U&&(U.style.display="none"),P&&typeof(P==null?void 0:P.closeHandler)=="function"&&(P==null||P.closeHandler())},S=U=>{U.key==="Escape"&&N()};yt(()=>{T&&(O==null||O.addEventListener("mouseup",I),document.addEventListener("mouseup",I),document.addEventListener("keydown",S))}),Vr(()=>{T&&(O==null||O.removeEventListener("mouseup",I),document.removeEventListener("mouseup",I),document.removeEventListener("keydown",S))});const C=(U,ne)=>{let fe=[];return ne.document.forEach((ue,we)=>{var ge,ie,de,ke,ye;if(((de=(ie=(ge=c==null?void 0:c.info)==null?void 0:ge.meta)==null?void 0:ie.capabilities)==null?void 0:de.citations)==!1)return fe.push("N/A"),fe;const X=(ke=ne.metadata)==null?void 0:ke[we],re=(X==null?void 0:X.source)??"N/A";return X!=null&&X.name?(fe.push(X.name),fe):(re.startsWith("http://")||re.startsWith("https://")?fe.push(re):fe.push(((ye=ne==null?void 0:ne.source)==null?void 0:ye.name)??re),fe)}),U=[...U,...fe],U.filter((ue,we)=>U.indexOf(ue)===we)},B=U=>{const{lang:ne,text:fe}=U;((s==null?void 0:s.detectArtifacts)??!0)&&(["html","svg"].includes(ne)||ne==="xml"&&fe.includes("svg"))&&!l&&r&&(_l.set(!0),bl.set(!0))},F=async U=>{await Rr.set(U),await bl.set(!0),await _l.set(!0),await Pr.set(!1)};function R(U){ze[U?"unshift":"push"](()=>{O=U,t(14,O)})}const Q=({modelId:U,parentId:ne,messages:fe})=>{L({modelId:U,parentId:ne,messages:fe}),N()};function _e(U){ze[U?"unshift":"push"](()=>{P=U,t(15,P)})}return n.$$set=U=>{"id"in U&&t(0,i=U.id),"content"in U&&t(1,o=U.content),"history"in U&&t(2,a=U.history),"selectedModels"in U&&t(3,f=U.selectedModels),"done"in U&&t(4,u=U.done),"model"in U&&t(5,c=U.model),"sources"in U&&t(6,g=U.sources),"save"in U&&t(7,h=U.save),"preview"in U&&t(8,_=U.preview),"floatingButtons"in U&&t(9,T=U.floatingButtons),"onSave"in U&&t(10,p=U.onSave),"onSourceClick"in U&&t(11,D=U.onSourceClick),"onTaskClick"in U&&t(12,V=U.onTaskClick),"onAddMessages"in U&&t(13,L=U.onAddMessages)},[i,o,a,f,u,c,g,h,_,T,p,D,V,L,O,P,l,s,r,N,C,B,F,R,Q,_e]}class Aa extends Ae{constructor(e){super(),Le(this,e,Pa,Ra,Se,{id:0,content:1,history:2,selectedModels:3,done:4,model:5,sources:6,save:7,preview:8,floatingButtons:9,onSave:10,onSourceClick:11,onTaskClick:12,onAddMessages:13})}}function La(n){return new Worker(""+new URL("../workers/kokoro.worker-C3fj7GC4.js",import.meta.url).href,{type:"module",name:n==null?void 0:n.name})}class ja{constructor(e="fp32"){vt(this,"worker",null);vt(this,"initialized",!1);vt(this,"dtype");vt(this,"requestQueue",[]);vt(this,"processing",!1);this.dtype=e}async init(){if(this.worker){console.warn("KokoroWorker is already initialized.");return}return this.worker=new La,this.worker.onmessage=e=>{const{status:t,error:l,audioUrl:s}=e.data;if(t==="init:complete")this.initialized=!0;else if(t==="init:error")console.error(l),this.initialized=!1;else if(t==="generate:complete"){const r=this.requestQueue.shift();r&&(r.resolve(s),this.processNextRequest())}else if(t==="generate:error"){const r=this.requestQueue.shift();r&&(r.reject(new Error(l)),this.processNextRequest())}},new Promise((e,t)=>{this.worker.postMessage({type:"init",payload:{dtype:this.dtype}});const l=s=>{s.data.status==="init:complete"?(this.worker.removeEventListener("message",l),this.initialized=!0,e()):s.data.status==="init:error"&&(this.worker.removeEventListener("message",l),t(new Error(s.data.error)))};this.worker.addEventListener("message",l)})}async generate({text:e,voice:t}){if(!this.initialized||!this.worker)throw new Error("KokoroTTS Worker is not initialized yet.");return new Promise((l,s)=>{this.requestQueue.push({text:e,voice:t,resolve:l,reject:s}),this.processing||this.processNextRequest()})}processNextRequest(){if(this.requestQueue.length===0){this.processing=!1;return}this.processing=!0;const{text:e,voice:t}=this.requestQueue[0];this.worker.postMessage({type:"generate",payload:{text:e,voice:t}})}terminate(){this.worker&&(this.worker.terminate(),this.worker=null,this.initialized=!1,this.requestQueue=[],this.processing=!1)}}function Ha(n){let e,t;return{c(){e=pe("svg"),t=pe("path"),this.h()},l(l){e=ve(l,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var s=k(e);t=ve(s,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),k(t).forEach(m),s.forEach(m),this.h()},h(){d(t,"fill-rule","evenodd"),d(t,"d","M2.75 2a.75.75 0 0 1 .75.75v6.5h7.94l-.97-.97a.75.75 0 0 1 1.06-1.06l2.25 2.25a.75.75 0 0 1 0 1.06l-2.25 2.25a.75.75 0 1 1-1.06-1.06l.97-.97H2.75A.75.75 0 0 1 2 10V2.75A.75.75 0 0 1 2.75 2Z"),d(t,"clip-rule","evenodd"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"viewBox","0 0 16 16"),d(e,"fill","currentColor"),d(e,"class",n[0])},m(l,s){E(l,e,s),b(e,t)},p(l,[s]){s&1&&d(e,"class",l[0])},i:De,o:De,d(l){l&&m(e)}}}function za(n,e,t){let{className:l="size-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,l=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[l,s]}class Ua extends Ae{constructor(e){super(),Le(this,e,za,Ha,Se,{className:0,strokeWidth:1})}}function ms(n,e,t){const l=n.slice();return l[5]=e[t],l[7]=t,l}function gs(n){let e;return{c(){e=w("hr"),this.h()},l(t){e=y(t,"HR",{class:!0}),this.h()},h(){d(e,"class","border-gray-100 dark:border-gray-850")},m(t,l){E(t,e,l)},d(t){t&&m(e)}}}function _s(n,e){let t,l,s,r,i=e[5]+"",o,a,f,u,c,g,h,_;l=new Ua({props:{className:"size-3.5"}});function T(){return e[4](e[5])}let p=e[7]<e[0].length-1&&gs();return{key:n,first:null,c(){t=w("div"),Y(l.$$.fragment),s=H(),r=w("div"),o=W(i),u=H(),p&&p.c(),c=ce(),this.h()},l(D){t=y(D,"DIV",{class:!0,title:!0,"aria-label":!0});var V=k(t);$(l.$$.fragment,V),s=z(V),r=y(V,"DIV",{class:!0});var L=k(r);o=q(L,i),L.forEach(m),V.forEach(m),u=z(D),p&&p.l(D),c=ce(),this.h()},h(){d(r,"class","line-clamp-1"),d(t,"class","mr-2 py-1.5 bg-transparent text-left text-sm flex items-center gap-2 px-1.5 text-gray-500 dark:text-gray-400 hover:text-black dark:hover:text-white transition cursor-pointer"),d(t,"title",a=e[5]),d(t,"aria-label",f=e[5]),this.first=t},m(D,V){E(D,t,V),x(l,t,null),b(t,s),b(t,r),b(r,o),E(D,u,V),p&&p.m(D,V),E(D,c,V),g=!0,h||(_=he(t,"click",T),h=!0)},p(D,V){e=D,(!g||V&1)&&i!==(i=e[5]+"")&&Z(o,i),(!g||V&1&&a!==(a=e[5]))&&d(t,"title",a),(!g||V&1&&f!==(f=e[5]))&&d(t,"aria-label",f),e[7]<e[0].length-1?p||(p=gs(),p.c(),p.m(c.parentNode,c)):p&&(p.d(1),p=null)},i(D){g||(v(l.$$.fragment,D),g=!0)},o(D){M(l.$$.fragment,D),g=!1},d(D){D&&(m(t),m(u),m(c)),ee(l),p&&p.d(D),h=!1,_()}}}function Wa(n){let e,t,l=n[2].t("Follow up")+"",s,r,i,o=[],a=new Map,f,u=Ve(n[0]);const c=g=>g[7];for(let g=0;g<u.length;g+=1){let h=ms(n,u,g),_=c(h);a.set(_,o[g]=_s(_,h))}return{c(){e=w("div"),t=w("div"),s=W(l),r=H(),i=w("div");for(let g=0;g<o.length;g+=1)o[g].c();this.h()},l(g){e=y(g,"DIV",{class:!0});var h=k(e);t=y(h,"DIV",{class:!0});var _=k(t);s=q(_,l),_.forEach(m),r=z(h),i=y(h,"DIV",{class:!0});var T=k(i);for(let p=0;p<o.length;p+=1)o[p].l(T);T.forEach(m),h.forEach(m),this.h()},h(){d(t,"class","text-sm font-medium"),d(i,"class","flex flex-col text-left gap-1 mt-1.5"),d(e,"class","mt-4")},m(g,h){E(g,e,h),b(e,t),b(t,s),b(e,r),b(e,i);for(let _=0;_<o.length;_+=1)o[_]&&o[_].m(i,null);f=!0},p(g,[h]){(!f||h&4)&&l!==(l=g[2].t("Follow up")+"")&&Z(s,l),h&3&&(u=Ve(g[0]),te(),o=Ht(o,h,c,1,g,u,a,i,Kt,_s,null,ms),le())},i(g){if(!f){for(let h=0;h<u.length;h+=1)v(o[h]);f=!0}},o(g){for(let h=0;h<o.length;h+=1)M(o[h]);f=!1},d(g){g&&m(e);for(let h=0;h<o.length;h+=1)o[h].d()}}}function qa(n,e,t){let l;const s=Fe("i18n");Ne(n,s,a=>t(2,l=a));let{followUps:r=[]}=e,{onClick:i=()=>{}}=e;const o=a=>i(a);return n.$$set=a=>{"followUps"in a&&t(0,r=a.followUps),"onClick"in a&&t(1,i=a.onClick)},[r,i,l,s,o]}class Fa extends Ae{constructor(e){super(),Le(this,e,qa,Wa,Se,{followUps:0,onClick:1})}}function bs(n,e,t){const l=n.slice();return l[91]=e[t],l}function ps(n,e,t){const l=n.slice();return l[94]=e[t],l}function qt(n){var l,s,r;const e=n.slice(),t=(((l=e[15])==null?void 0:l.statusHistory)??[...(s=e[15])!=null&&s.status?[(r=e[15])==null?void 0:r.status]:[]]).at(-1);return e[97]=t,e}function Ja(n){var s;let e,t=(((s=n[19])==null?void 0:s.name)??n[15].model)+"",l;return{c(){e=w("span"),l=W(t),this.h()},l(r){e=y(r,"SPAN",{class:!0});var i=k(e);l=q(i,t),i.forEach(m),this.h()},h(){d(e,"class","line-clamp-1 text-black dark:text-white")},m(r,i){E(r,e,i),b(e,l)},p(r,i){var o;i[0]&557056&&t!==(t=(((o=r[19])==null?void 0:o.name)??r[15].model)+"")&&Z(l,t)},d(r){r&&m(e)}}}function vs(n){let e,t,l;return t=new Be({props:{content:it(n[15].timestamp*1e3).format("LLLL"),$$slots:{default:[Ga]},$$scope:{ctx:n}}}),{c(){e=w("div"),Y(t.$$.fragment),this.h()},l(s){e=y(s,"DIV",{class:!0});var r=k(e);$(t.$$.fragment,r),r.forEach(m),this.h()},h(){d(e,"class","self-center text-xs invisible group-hover:visible text-gray-400 font-medium first-letter:capitalize ml-0.5 translate-y-[1px]")},m(s,r){E(s,e,r),x(t,e,null),l=!0},p(s,r){const i={};r[0]&32768&&(i.content=it(s[15].timestamp*1e3).format("LLLL")),r[0]&32768|r[3]&32&&(i.$$scope={dirty:r,ctx:s}),t.$set(i)},i(s){l||(v(t.$$.fragment,s),l=!0)},o(s){M(t.$$.fragment,s),l=!1},d(s){s&&m(e),ee(t)}}}function Ga(n){let e,t=wt(n[15].timestamp*1e3)+"",l;return{c(){e=w("span"),l=W(t),this.h()},l(s){e=y(s,"SPAN",{class:!0});var r=k(e);l=q(r,t),r.forEach(m),this.h()},h(){d(e,"class","line-clamp-1")},m(s,r){E(s,e,r),b(e,l)},p(s,r){r[0]&32768&&t!==(t=wt(s[15].timestamp*1e3)+"")&&Z(l,t)},d(s){s&&m(e)}}}function Ka(n){var i;let e,t,l,s;e=new Be({props:{content:((i=n[19])==null?void 0:i.name)??n[15].model,placement:"top-start",$$slots:{default:[Ja]},$$scope:{ctx:n}}});let r=n[15].timestamp&&vs(n);return{c(){Y(e.$$.fragment),t=H(),r&&r.c(),l=ce()},l(o){$(e.$$.fragment,o),t=z(o),r&&r.l(o),l=ce()},m(o,a){x(e,o,a),E(o,t,a),r&&r.m(o,a),E(o,l,a),s=!0},p(o,a){var u;const f={};a[0]&557056&&(f.content=((u=o[19])==null?void 0:u.name)??o[15].model),a[0]&557056|a[3]&32&&(f.$$scope={dirty:a,ctx:o}),e.$set(f),o[15].timestamp?r?(r.p(o,a),a[0]&32768&&v(r,1)):(r=vs(o),r.c(),v(r,1),r.m(l.parentNode,l)):r&&(te(),M(r,1,1,()=>{r=null}),le())},i(o){s||(v(e.$$.fragment,o),v(r),s=!0)},o(o){M(e.$$.fragment,o),M(r),s=!1},d(o){o&&(m(t),m(l)),ee(e,o),r&&r.d(o)}}}function ks(n){var s;let e,t,l=!((s=n[97])!=null&&s.hidden)&&ws(n);return{c(){l&&l.c(),e=ce()},l(r){l&&l.l(r),e=ce()},m(r,i){l&&l.m(r,i),E(r,e,i),t=!0},p(r,i){var o;(o=r[97])!=null&&o.hidden?l&&(te(),M(l,1,1,()=>{l=null}),le()):l?(l.p(r,i),i[0]&32768&&v(l,1)):(l=ws(r),l.c(),v(l,1),l.m(e.parentNode,e))},i(r){t||(v(l),t=!0)},o(r){M(l),t=!1},d(r){r&&m(e),l&&l.d(r)}}}function ws(n){let e,t,l,s;const r=[Xa,Qa,Za],i=[];function o(a,f){var u,c,g;return((u=a[97])==null?void 0:u.action)==="web_search"&&((c=a[97])!=null&&c.urls)?0:((g=a[97])==null?void 0:g.action)==="knowledge_search"?1:2}return t=o(n),l=i[t]=r[t](n),{c(){e=w("div"),l.c(),this.h()},l(a){e=y(a,"DIV",{class:!0});var f=k(e);l.l(f),f.forEach(m),this.h()},h(){d(e,"class","status-description flex items-center gap-2 py-0.5")},m(a,f){E(a,e,f),i[t].m(e,null),s=!0},p(a,f){let u=t;t=o(a),t===u?i[t].p(a,f):(te(),M(i[u],1,1,()=>{i[u]=null}),le(),l=i[t],l?l.p(a,f):(l=i[t]=r[t](a),l.c()),v(l,1),l.m(e,null))},i(a){s||(v(l),s=!0)},o(a){M(l),s=!1},d(a){a&&m(e),i[t].d()}}}function Za(n){let e,t,l,s;function r(a,f){var u,c,g,h;return f[0]&32768&&(l=null),l==null&&(l=!!((u=a[97])!=null&&u.description.includes("{{searchQuery}}"))),l?to:((c=a[97])==null?void 0:c.description)==="No search query generated"?eo:((g=a[97])==null?void 0:g.description)==="Generating search query"?xa:((h=a[97])==null?void 0:h.description)==="Searching the web"?$a:Ya}let i=r(n,[-1,-1,-1,-1]),o=i(n);return{c(){e=w("div"),t=w("div"),o.c(),this.h()},l(a){e=y(a,"DIV",{class:!0});var f=k(e);t=y(f,"DIV",{class:!0});var u=k(t);o.l(u),u.forEach(m),f.forEach(m),this.h()},h(){var a;d(t,"class",s=(((a=n[97])==null?void 0:a.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap"),d(e,"class","flex flex-col justify-center -space-y-0.5")},m(a,f){E(a,e,f),b(e,t),o.m(t,null)},p(a,f){var u;i===(i=r(a,f))&&o?o.p(a,f):(o.d(1),o=i(a),o&&(o.c(),o.m(t,null))),f[0]&32768&&s!==(s=(((u=a[97])==null?void 0:u.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap")&&d(t,"class",s)},i:De,o:De,d(a){a&&m(e),o.d()}}}function Qa(n){let e,t,l=n[30].t('Searching Knowledge for "{{searchQuery}}"',{searchQuery:n[97].query})+"",s,r;return{c(){e=w("div"),t=w("div"),s=W(l),this.h()},l(i){e=y(i,"DIV",{class:!0});var o=k(e);t=y(o,"DIV",{class:!0});var a=k(t);s=q(a,l),a.forEach(m),o.forEach(m),this.h()},h(){var i;d(t,"class",r=(((i=n[97])==null?void 0:i.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap"),d(e,"class","flex flex-col justify-center -space-y-0.5")},m(i,o){E(i,e,o),b(e,t),b(t,s)},p(i,o){var a;o[0]&1073774592&&l!==(l=i[30].t('Searching Knowledge for "{{searchQuery}}"',{searchQuery:i[97].query})+"")&&Z(s,l),o[0]&32768&&r!==(r=(((a=i[97])==null?void 0:a.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap")&&d(t,"class",r)},i:De,o:De,d(i){i&&m(e)}}}function Xa(n){let e,t;return e=new Vi({props:{status:n[97],$$slots:{default:[io]},$$scope:{ctx:n}}}),{c(){Y(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},p(l,s){const r={};s[0]&32768&&(r.status=l[97]),s[0]&1073774592|s[3]&32&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function Ya(n){var l;let e=((l=n[97])==null?void 0:l.description)+"",t;return{c(){t=W(e)},l(s){t=q(s,e)},m(s,r){E(s,t,r)},p(s,r){var i;r[0]&32768&&e!==(e=((i=s[97])==null?void 0:i.description)+"")&&Z(t,e)},d(s){s&&m(t)}}}function $a(n){let e=n[30].t("Searching the web...")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){E(l,t,s)},p(l,s){s[0]&1073741824&&e!==(e=l[30].t("Searching the web...")+"")&&Z(t,e)},d(l){l&&m(t)}}}function xa(n){let e=n[30].t("Generating search query")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){E(l,t,s)},p(l,s){s[0]&1073741824&&e!==(e=l[30].t("Generating search query")+"")&&Z(t,e)},d(l){l&&m(t)}}}function eo(n){let e=n[30].t("No search query generated")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){E(l,t,s)},p(l,s){s[0]&1073741824&&e!==(e=l[30].t("No search query generated")+"")&&Z(t,e)},d(l){l&&m(t)}}}function to(n){var l,s;let e=n[30].t((l=n[97])==null?void 0:l.description,{searchQuery:(s=n[97])==null?void 0:s.query})+"",t;return{c(){t=W(e)},l(r){t=q(r,e)},m(r,i){E(r,t,i)},p(r,i){var o,a;i[0]&1073774592&&e!==(e=r[30].t((o=r[97])==null?void 0:o.description,{searchQuery:(a=r[97])==null?void 0:a.query})+"")&&Z(t,e)},d(r){r&&m(t)}}}function lo(n){var l;let e=((l=n[97])==null?void 0:l.description)+"",t;return{c(){t=W(e)},l(s){t=q(s,e)},m(s,r){E(s,t,r)},p(s,r){var i;r[0]&32768&&e!==(e=((i=s[97])==null?void 0:i.description)+"")&&Z(t,e)},d(s){s&&m(t)}}}function so(n){let e=n[30].t("Generating search query")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){E(l,t,s)},p(l,s){s[0]&1073741824&&e!==(e=l[30].t("Generating search query")+"")&&Z(t,e)},d(l){l&&m(t)}}}function no(n){let e=n[30].t("No search query generated")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){E(l,t,s)},p(l,s){s[0]&1073741824&&e!==(e=l[30].t("No search query generated")+"")&&Z(t,e)},d(l){l&&m(t)}}}function ro(n){var l,s;let e=n[30].t((l=n[97])==null?void 0:l.description,{count:(s=n[97])==null?void 0:s.urls.length})+"",t;return{c(){t=W(e)},l(r){t=q(r,e)},m(r,i){E(r,t,i)},p(r,i){var o,a;i[0]&1073774592&&e!==(e=r[30].t((o=r[97])==null?void 0:o.description,{count:(a=r[97])==null?void 0:a.urls.length})+"")&&Z(t,e)},d(r){r&&m(t)}}}function io(n){let e,t,l,s;function r(a,f){var u,c,g;return f[0]&32768&&(l=null),l==null&&(l=!!((u=a[97])!=null&&u.description.includes("{{count}}"))),l?ro:((c=a[97])==null?void 0:c.description)==="No search query generated"?no:((g=a[97])==null?void 0:g.description)==="Generating search query"?so:lo}let i=r(n,[-1,-1,-1,-1]),o=i(n);return{c(){e=w("div"),t=w("div"),o.c(),this.h()},l(a){e=y(a,"DIV",{class:!0});var f=k(e);t=y(f,"DIV",{class:!0});var u=k(t);o.l(u),u.forEach(m),f.forEach(m),this.h()},h(){var a;d(t,"class",s=(((a=n[97])==null?void 0:a.done)===!1?"shimmer":"")+" text-base line-clamp-1 text-wrap"),d(e,"class","flex flex-col justify-center -space-y-0.5")},m(a,f){E(a,e,f),b(e,t),o.m(t,null)},p(a,f){var u;i===(i=r(a,f))&&o?o.p(a,f):(o.d(1),o=i(a),o&&(o.c(),o.m(t,null))),f[0]&32768&&s!==(s=(((u=a[97])==null?void 0:u.done)===!1?"shimmer":"")+" text-base line-clamp-1 text-wrap")&&d(t,"class",s)},d(a){a&&m(e),o.d()}}}function ys(n){let e,t,l=Ve(n[15].files),s=[];for(let i=0;i<l.length;i+=1)s[i]=Is(ps(n,l,i));const r=i=>M(s[i],1,1,()=>{s[i]=null});return{c(){e=w("div");for(let i=0;i<s.length;i+=1)s[i].c();this.h()},l(i){e=y(i,"DIV",{class:!0});var o=k(e);for(let a=0;a<s.length;a+=1)s[a].l(o);o.forEach(m),this.h()},h(){d(e,"class","my-1 w-full flex overflow-x-auto gap-2 flex-wrap")},m(i,o){E(i,e,o);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);t=!0},p(i,o){if(o[0]&32768){l=Ve(i[15].files);let a;for(a=0;a<l.length;a+=1){const f=ps(i,l,a);s[a]?(s[a].p(f,o),v(s[a],1)):(s[a]=Is(f),s[a].c(),v(s[a],1),s[a].m(e,null))}for(te(),a=l.length;a<s.length;a+=1)r(a);le()}},i(i){if(!t){for(let o=0;o<l.length;o+=1)v(s[o]);t=!0}},o(i){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)M(s[o]);t=!1},d(i){i&&m(e),qe(s,i)}}}function ao(n){var l;let e,t;return e=new el({props:{item:n[94],url:n[94].url,name:n[94].name,type:n[94].type,size:(l=n[94])==null?void 0:l.size,colorClassName:"bg-white dark:bg-gray-850 "}}),{c(){Y(e.$$.fragment)},l(s){$(e.$$.fragment,s)},m(s,r){x(e,s,r),t=!0},p(s,r){var o;const i={};r[0]&32768&&(i.item=s[94]),r[0]&32768&&(i.url=s[94].url),r[0]&32768&&(i.name=s[94].name),r[0]&32768&&(i.type=s[94].type),r[0]&32768&&(i.size=(o=s[94])==null?void 0:o.size),e.$set(i)},i(s){t||(v(e.$$.fragment,s),t=!0)},o(s){M(e.$$.fragment,s),t=!1},d(s){ee(e,s)}}}function oo(n){let e,t;return e=new Yt({props:{src:n[94].url,alt:n[15].content}}),{c(){Y(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},p(l,s){const r={};s[0]&32768&&(r.src=l[94].url),s[0]&32768&&(r.alt=l[15].content),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function Is(n){let e,t,l,s,r;const i=[oo,ao],o=[];function a(f,u){return f[94].type==="image"?0:1}return t=a(n),l=o[t]=i[t](n),{c(){e=w("div"),l.c(),s=H()},l(f){e=y(f,"DIV",{});var u=k(e);l.l(u),s=z(u),u.forEach(m)},m(f,u){E(f,e,u),o[t].m(e,null),b(e,s),r=!0},p(f,u){let c=t;t=a(f),t===c?o[t].p(f,u):(te(),M(o[c],1,1,()=>{o[c]=null}),le(),l=o[t],l?l.p(f,u):(l=o[t]=i[t](f),l.c()),v(l,1),l.m(e,s))},i(f){r||(v(l),r=!0)},o(f){M(l),r=!1},d(f){f&&m(e),o[t].d()}}}function fo(n){var _,T,p,D,V,L,O;let e,t,l,s,r,i,o;const a=[ho,co],f=[];function u(P,I){var N,S,C;return P[15].content===""&&!P[15].error&&(((N=P[15])==null?void 0:N.statusHistory)??[...(S=P[15])!=null&&S.status?[(C=P[15])==null?void 0:C.status]:[]]).length===0?0:P[15].content&&P[15].error!==!0?1:-1}~(t=u(n))&&(l=f[t]=a[t](n));let c=((_=n[15])==null?void 0:_.error)&&Ms(n),g=(((T=n[15])==null?void 0:T.sources)||((p=n[15])==null?void 0:p.citations))&&(((O=(L=(V=(D=n[19])==null?void 0:D.info)==null?void 0:V.meta)==null?void 0:L.capabilities)==null?void 0:O.citations)??!0)&&Es(n),h=n[15].code_executions&&Ns(n);return{c(){e=w("div"),l&&l.c(),s=H(),c&&c.c(),r=H(),g&&g.c(),i=H(),h&&h.c(),this.h()},l(P){e=y(P,"DIV",{class:!0,id:!0});var I=k(e);l&&l.l(I),s=z(I),c&&c.l(I),r=z(I),g&&g.l(I),i=z(I),h&&h.l(I),I.forEach(m),this.h()},h(){d(e,"class","w-full flex flex-col relative"),d(e,"id","response-content-container")},m(P,I){E(P,e,I),~t&&f[t].m(e,null),b(e,s),c&&c.m(e,null),b(e,r),g&&g.m(e,null),b(e,i),h&&h.m(e,null),o=!0},p(P,I){var S,C,B,F,R,Q,_e;let N=t;t=u(P),t===N?~t&&f[t].p(P,I):(l&&(te(),M(f[N],1,1,()=>{f[N]=null}),le()),~t?(l=f[t],l?l.p(P,I):(l=f[t]=a[t](P),l.c()),v(l,1),l.m(e,s)):l=null),(S=P[15])!=null&&S.error?c?(c.p(P,I),I[0]&32768&&v(c,1)):(c=Ms(P),c.c(),v(c,1),c.m(e,r)):c&&(te(),M(c,1,1,()=>{c=null}),le()),((C=P[15])!=null&&C.sources||(B=P[15])!=null&&B.citations)&&(((_e=(Q=(R=(F=P[19])==null?void 0:F.info)==null?void 0:R.meta)==null?void 0:Q.capabilities)==null?void 0:_e.citations)??!0)?g?(g.p(P,I),I[0]&557056&&v(g,1)):(g=Es(P),g.c(),v(g,1),g.m(e,i)):g&&(te(),M(g,1,1,()=>{g=null}),le()),P[15].code_executions?h?(h.p(P,I),I[0]&32768&&v(h,1)):(h=Ns(P),h.c(),v(h,1),h.m(e,null)):h&&(te(),M(h,1,1,()=>{h=null}),le())},i(P){o||(v(l),v(c),v(g),v(h),o=!0)},o(P){M(l),M(c),M(g),M(h),o=!1},d(P){P&&m(e),~t&&f[t].d(),c&&c.d(),g&&g.d(),h&&h.d()}}}function uo(n){let e,t,l,s,r,i,o,a=n[30].t("Save As Copy")+"",f,u,c,g,h=n[30].t("Cancel")+"",_,T,p,D=n[30].t("Save")+"",V,L,O;return{c(){e=w("div"),t=w("textarea"),s=H(),r=w("div"),i=w("div"),o=w("button"),f=W(a),u=H(),c=w("div"),g=w("button"),_=W(h),T=H(),p=w("button"),V=W(D),this.h()},l(P){e=y(P,"DIV",{class:!0});var I=k(e);t=y(I,"TEXTAREA",{id:!0,class:!0}),k(t).forEach(m),s=z(I),r=y(I,"DIV",{class:!0});var N=k(r);i=y(N,"DIV",{});var S=k(i);o=y(S,"BUTTON",{id:!0,class:!0});var C=k(o);f=q(C,a),C.forEach(m),S.forEach(m),u=z(N),c=y(N,"DIV",{class:!0});var B=k(c);g=y(B,"BUTTON",{id:!0,class:!0});var F=k(g);_=q(F,h),F.forEach(m),T=z(B),p=y(B,"BUTTON",{id:!0,class:!0});var R=k(p);V=q(R,D),R.forEach(m),B.forEach(m),N.forEach(m),I.forEach(m),this.h()},h(){d(t,"id",l="message-edit-"+n[15].id),d(t,"class","bg-transparent outline-hidden w-full resize-none"),d(o,"id","save-new-message-button"),d(o,"class","px-4 py-2 bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 border border-gray-100 dark:border-gray-700 text-gray-700 dark:text-gray-200 transition rounded-3xl"),d(g,"id","close-edit-message-button"),d(g,"class","px-4 py-2 bg-white dark:bg-gray-900 hover:bg-gray-100 text-gray-800 dark:text-gray-100 transition rounded-3xl"),d(p,"id","confirm-edit-message-button"),d(p,"class","px-4 py-2 bg-gray-900 dark:bg-white hover:bg-gray-850 text-gray-100 dark:text-gray-800 transition rounded-3xl"),d(c,"class","flex space-x-1.5"),d(r,"class","mt-2 mb-1 flex justify-between text-sm font-medium"),d(e,"class","w-full bg-gray-50 dark:bg-gray-800 rounded-3xl px-5 py-3 my-2")},m(P,I){E(P,e,I),b(e,t),n[53](t),ut(t,n[20]),b(e,s),b(e,r),b(r,i),b(i,o),b(o,f),b(r,u),b(r,c),b(c,g),b(g,_),b(c,T),b(c,p),b(p,V),L||(O=[he(t,"input",n[54]),he(t,"input",Po),he(t,"keydown",n[55]),he(o,"click",n[56]),he(g,"click",n[57]),he(p,"click",n[58])],L=!0)},p(P,I){I[0]&32768&&l!==(l="message-edit-"+P[15].id)&&d(t,"id",l),I[0]&1048576&&ut(t,P[20]),I[0]&1073741824&&a!==(a=P[30].t("Save As Copy")+"")&&Z(f,a),I[0]&1073741824&&h!==(h=P[30].t("Cancel")+"")&&Z(_,h),I[0]&1073741824&&D!==(D=P[30].t("Save")+"")&&Z(V,D)},i:De,o:De,d(P){P&&m(e),n[53](null),L=!1,$e(O)}}}function co(n){var l,s,r;let e,t;return e=new Aa({props:{id:n[15].id,history:n[0],selectedModels:n[1],content:n[15].content,sources:n[15].sources,floatingButtons:((l=n[15])==null?void 0:l.done)&&!n[14],save:!n[14],preview:!n[14],done:((s=n[28])==null?void 0:s.chatFadeStreamingText)??!0?((r=n[15])==null?void 0:r.done)??!1:!0,model:n[19],onTaskClick:n[59],onSourceClick:n[60],onAddMessages:n[61],onSave:n[62]}}),{c(){Y(e.$$.fragment)},l(i){$(e.$$.fragment,i)},m(i,o){x(e,i,o),t=!0},p(i,o){var f,u,c;const a={};o[0]&32768&&(a.id=i[15].id),o[0]&1&&(a.history=i[0]),o[0]&2&&(a.selectedModels=i[1]),o[0]&32768&&(a.content=i[15].content),o[0]&32768&&(a.sources=i[15].sources),o[0]&49152&&(a.floatingButtons=((f=i[15])==null?void 0:f.done)&&!i[14]),o[0]&16384&&(a.save=!i[14]),o[0]&16384&&(a.preview=!i[14]),o[0]&268468224&&(a.done=((u=i[28])==null?void 0:u.chatFadeStreamingText)??!0?((c=i[15])==null?void 0:c.done)??!1:!0),o[0]&524288&&(a.model=i[19]),o[0]&32768&&(a.onSourceClick=i[60]),o[0]&4096&&(a.onAddMessages=i[61]),o[0]&32897&&(a.onSave=i[62]),e.$set(a)},i(i){t||(v(e.$$.fragment,i),t=!0)},o(i){M(e.$$.fragment,i),t=!1},d(i){ee(e,i)}}}function ho(n){let e,t;return e=new Xt({}),{c(){Y(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},p:De,i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function Ms(n){var l,s;let e,t;return e=new Si({props:{content:((s=(l=n[15])==null?void 0:l.error)==null?void 0:s.content)??n[15].content}}),{c(){Y(e.$$.fragment)},l(r){$(e.$$.fragment,r)},m(r,i){x(e,r,i),t=!0},p(r,i){var a,f;const o={};i[0]&32768&&(o.content=((f=(a=r[15])==null?void 0:a.error)==null?void 0:f.content)??r[15].content),e.$set(o)},i(r){t||(v(e.$$.fragment,r),t=!0)},o(r){M(e.$$.fragment,r),t=!1},d(r){ee(e,r)}}}function Es(n){var l,s,r;let e,t;return e=new na({props:{id:(l=n[15])==null?void 0:l.id,sources:((s=n[15])==null?void 0:s.sources)??((r=n[15])==null?void 0:r.citations)}}),{c(){Y(e.$$.fragment)},l(i){$(e.$$.fragment,i)},m(i,o){x(e,i,o),t=!0},p(i,o){var f,u,c;const a={};o[0]&32768&&(a.id=(f=i[15])==null?void 0:f.id),o[0]&32768&&(a.sources=((u=i[15])==null?void 0:u.sources)??((c=i[15])==null?void 0:c.citations)),e.$set(a)},i(i){t||(v(e.$$.fragment,i),t=!0)},o(i){M(e.$$.fragment,i),t=!1},d(i){ee(e,i)}}}function Ns(n){let e,t;return e=new wa({props:{codeExecutions:n[15].code_executions}}),{c(){Y(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},p(l,s){const r={};s[0]&32768&&(r.codeExecutions=l[15].code_executions),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function Ds(n){var f,u;let e,t,l,s,r,i=(n[15].done||n[2].length>1)&&Vs(n),o=n[15].done&&n[26]&&Ws(n),a=(n[13]||(((f=n[28])==null?void 0:f.keepFollowUpPrompts)??!1))&&n[15].done&&!n[14]&&(((u=n[15])==null?void 0:u.followUps)??[]).length>0&&qs(n);return{c(){e=w("div"),i&&i.c(),t=H(),o&&o.c(),l=H(),a&&a.c(),s=ce(),this.h()},l(c){e=y(c,"DIV",{class:!0});var g=k(e);i&&i.l(g),g.forEach(m),t=z(c),o&&o.l(c),l=z(c),a&&a.l(c),s=ce(),this.h()},h(){d(e,"class","flex justify-start overflow-x-auto buttons text-gray-600 dark:text-gray-500 mt-0.5 svelte-1u5gq5j")},m(c,g){E(c,e,g),i&&i.m(e,null),n[79](e),E(c,t,g),o&&o.m(c,g),E(c,l,g),a&&a.m(c,g),E(c,s,g),r=!0},p(c,g){var h,_;c[15].done||c[2].length>1?i?(i.p(c,g),g[0]&32772&&v(i,1)):(i=Vs(c),i.c(),v(i,1),i.m(e,null)):i&&(te(),M(i,1,1,()=>{i=null}),le()),c[15].done&&c[26]?o?(o.p(c,g),g[0]&67141632&&v(o,1)):(o=Ws(c),o.c(),v(o,1),o.m(l.parentNode,l)):o&&(te(),M(o,1,1,()=>{o=null}),le()),(c[13]||(((h=c[28])==null?void 0:h.keepFollowUpPrompts)??!1))&&c[15].done&&!c[14]&&(((_=c[15])==null?void 0:_.followUps)??[]).length>0?a?(a.p(c,g),g[0]&268492800&&v(a,1)):(a=qs(c),a.c(),v(a,1),a.m(s.parentNode,s)):a&&(te(),M(a,1,1,()=>{a=null}),le())},i(c){r||(v(i),v(o),v(a),r=!0)},o(c){M(i),M(o),M(a),r=!1},d(c){c&&(m(e),m(t),m(l),m(s)),i&&i.d(),n[79](null),o&&o.d(c),a&&a.d(c)}}}function Vs(n){let e,t,l,s=n[2].length>1&&Ts(n),r=n[15].done&&Cs(n);return{c(){s&&s.c(),e=H(),r&&r.c(),t=ce()},l(i){s&&s.l(i),e=z(i),r&&r.l(i),t=ce()},m(i,o){s&&s.m(i,o),E(i,e,o),r&&r.m(i,o),E(i,t,o),l=!0},p(i,o){i[2].length>1?s?s.p(i,o):(s=Ts(i),s.c(),s.m(e.parentNode,e)):s&&(s.d(1),s=null),i[15].done?r?(r.p(i,o),o[0]&32768&&v(r,1)):(r=Cs(i),r.c(),v(r,1),r.m(t.parentNode,t)):r&&(te(),M(r,1,1,()=>{r=null}),le())},i(i){l||(v(r),l=!0)},o(i){M(r),l=!1},d(i){i&&(m(e),m(t)),s&&s.d(i),r&&r.d(i)}}}function Ts(n){let e,t,l,s,r,i,o,a,f,u,c,g,h;function _(D,V){return D[22]?go:mo}let T=_(n),p=T(n);return{c(){e=w("div"),t=w("button"),l=pe("svg"),s=pe("path"),i=H(),p.c(),o=H(),a=w("button"),f=pe("svg"),u=pe("path"),this.h()},l(D){e=y(D,"DIV",{class:!0,dir:!0});var V=k(e);t=y(V,"BUTTON",{"aria-label":!0,class:!0});var L=k(t);l=ve(L,"svg",{"aria-hidden":!0,xmlns:!0,fill:!0,viewBox:!0,stroke:!0,"stroke-width":!0,class:!0});var O=k(l);s=ve(O,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(s).forEach(m),O.forEach(m),L.forEach(m),i=z(V),p.l(V),o=z(V),a=y(V,"BUTTON",{class:!0,"aria-label":!0});var P=k(a);f=ve(P,"svg",{xmlns:!0,fill:!0,"aria-hidden":!0,viewBox:!0,stroke:!0,"stroke-width":!0,class:!0});var I=k(f);u=ve(I,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(u).forEach(m),I.forEach(m),P.forEach(m),V.forEach(m),this.h()},h(){d(s,"stroke-linecap","round"),d(s,"stroke-linejoin","round"),d(s,"d","M15.75 19.5 8.25 12l7.5-7.5"),d(l,"aria-hidden","true"),d(l,"xmlns","http://www.w3.org/2000/svg"),d(l,"fill","none"),d(l,"viewBox","0 0 24 24"),d(l,"stroke","currentColor"),d(l,"stroke-width","2.5"),d(l,"class","size-3.5"),d(t,"aria-label",r=n[30].t("Previous message")),d(t,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),d(u,"stroke-linecap","round"),d(u,"stroke-linejoin","round"),d(u,"d","m8.25 4.5 7.5 7.5-7.5 7.5"),d(f,"xmlns","http://www.w3.org/2000/svg"),d(f,"fill","none"),d(f,"aria-hidden","true"),d(f,"viewBox","0 0 24 24"),d(f,"stroke","currentColor"),d(f,"stroke-width","2.5"),d(f,"class","size-3.5"),d(a,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),d(a,"aria-label",c=n[30].t("Next message")),d(e,"class","flex self-center min-w-fit"),d(e,"dir","ltr")},m(D,V){E(D,e,V),b(e,t),b(t,l),b(l,s),b(e,i),p.m(e,null),b(e,o),b(e,a),b(a,f),b(f,u),g||(h=[he(t,"click",n[63]),he(a,"click",n[67])],g=!0)},p(D,V){V[0]&1073741824&&r!==(r=D[30].t("Previous message"))&&d(t,"aria-label",r),T===(T=_(D))&&p?p.p(D,V):(p.d(1),p=T(D),p&&(p.c(),p.m(e,o))),V[0]&1073741824&&c!==(c=D[30].t("Next message"))&&d(a,"aria-label",c)},d(D){D&&m(e),p.d(),g=!1,$e(h)}}}function mo(n){let e,t=n[2].indexOf(n[15].id)+1+"",l,s,r=n[2].length+"",i,o,a;return{c(){e=w("div"),l=W(t),s=W("/"),i=W(r),this.h()},l(f){e=y(f,"DIV",{class:!0});var u=k(e);l=q(u,t),s=q(u,"/"),i=q(u,r),u.forEach(m),this.h()},h(){d(e,"class","text-sm tracking-widest font-semibold self-center dark:text-gray-100 min-w-fit")},m(f,u){E(f,e,u),b(e,l),b(e,s),b(e,i),o||(a=he(e,"dblclick",n[66]),o=!0)},p(f,u){u[0]&32772&&t!==(t=f[2].indexOf(f[15].id)+1+"")&&Z(l,t),u[0]&4&&r!==(r=f[2].length+"")&&Z(i,r)},d(f){f&&m(e),o=!1,a()}}}function go(n){let e,t,l,s,r,i,o=n[2].length+"",a,f,u;return{c(){e=w("div"),t=w("input"),i=W("/"),a=W(o),this.h()},l(c){e=y(c,"DIV",{class:!0});var g=k(e);t=y(g,"INPUT",{id:!0,type:!0,min:!0,max:!0,class:!0}),i=q(g,"/"),a=q(g,o),g.forEach(m),this.h()},h(){d(t,"id",l="message-index-input-"+n[15].id),d(t,"type","number"),t.value=s=n[2].indexOf(n[15].id)+1,d(t,"min","1"),d(t,"max",r=n[2].length),d(t,"class","bg-transparent font-semibold self-center dark:text-gray-100 min-w-fit outline-hidden"),d(e,"class","text-sm flex justify-center font-semibold self-center dark:text-gray-100 min-w-fit")},m(c,g){E(c,e,g),b(e,t),b(e,i),b(e,a),f||(u=[he(t,"focus",Ao),he(t,"blur",n[64]),he(t,"keydown",n[65])],f=!0)},p(c,g){g[0]&32768&&l!==(l="message-index-input-"+c[15].id)&&d(t,"id",l),g[0]&32772&&s!==(s=c[2].indexOf(c[15].id)+1)&&t.value!==s&&(t.value=s),g[0]&4&&r!==(r=c[2].length)&&d(t,"max",r),g[0]&4&&o!==(o=c[2].length+"")&&Z(a,o)},d(c){c&&m(e),f=!1,$e(u)}}}function Cs(n){var _,T,p,D,V,L,O,P,I;let e,t,l,s,r,i,o,a,f=!n[14]&&Ss(n);t=new Be({props:{content:n[30].t("Copy"),placement:"bottom",$$slots:{default:[bo]},$$scope:{ctx:n}}});let u=(((_=n[31])==null?void 0:_.role)==="admin"||(((D=(p=(T=n[31])==null?void 0:T.permissions)==null?void 0:p.chat)==null?void 0:D.tts)??!0))&&Os(n),c=((V=n[29])==null?void 0:V.features.enable_image_generation)&&(((L=n[31])==null?void 0:L.role)==="admin"||((I=(P=(O=n[31])==null?void 0:O.permissions)==null?void 0:P.features)==null?void 0:I.image_generation))&&!n[14]&&Rs(n),g=n[15].usage&&Ps(n),h=!n[14]&&As(n);return{c(){f&&f.c(),e=H(),Y(t.$$.fragment),l=H(),u&&u.c(),s=H(),c&&c.c(),r=H(),g&&g.c(),i=H(),h&&h.c(),o=ce()},l(N){f&&f.l(N),e=z(N),$(t.$$.fragment,N),l=z(N),u&&u.l(N),s=z(N),c&&c.l(N),r=z(N),g&&g.l(N),i=z(N),h&&h.l(N),o=ce()},m(N,S){f&&f.m(N,S),E(N,e,S),x(t,N,S),E(N,l,S),u&&u.m(N,S),E(N,s,S),c&&c.m(N,S),E(N,r,S),g&&g.m(N,S),E(N,i,S),h&&h.m(N,S),E(N,o,S),a=!0},p(N,S){var B,F,R,Q,_e,U,ne,fe,ue;N[14]?f&&(te(),M(f,1,1,()=>{f=null}),le()):f?(f.p(N,S),S[0]&16384&&v(f,1)):(f=Ss(N),f.c(),v(f,1),f.m(e.parentNode,e));const C={};S[0]&1073741824&&(C.content=N[30].t("Copy")),S[0]&1073782784|S[3]&32&&(C.$$scope={dirty:S,ctx:N}),t.$set(C),((B=N[31])==null?void 0:B.role)==="admin"||(((Q=(R=(F=N[31])==null?void 0:F.permissions)==null?void 0:R.chat)==null?void 0:Q.tts)??!0)?u?(u.p(N,S),S[1]&1&&v(u,1)):(u=Os(N),u.c(),v(u,1),u.m(s.parentNode,s)):u&&(te(),M(u,1,1,()=>{u=null}),le()),(_e=N[29])!=null&&_e.features.enable_image_generation&&(((U=N[31])==null?void 0:U.role)==="admin"||(ue=(fe=(ne=N[31])==null?void 0:ne.permissions)==null?void 0:fe.features)!=null&&ue.image_generation)&&!N[14]?c?(c.p(N,S),S[0]&536887296|S[1]&1&&v(c,1)):(c=Rs(N),c.c(),v(c,1),c.m(r.parentNode,r)):c&&(te(),M(c,1,1,()=>{c=null}),le()),N[15].usage?g?(g.p(N,S),S[0]&32768&&v(g,1)):(g=Ps(N),g.c(),v(g,1),g.m(i.parentNode,i)):g&&(te(),M(g,1,1,()=>{g=null}),le()),N[14]?h&&(te(),M(h,1,1,()=>{h=null}),le()):h?(h.p(N,S),S[0]&16384&&v(h,1)):(h=As(N),h.c(),v(h,1),h.m(o.parentNode,o))},i(N){a||(v(f),v(t.$$.fragment,N),v(u),v(c),v(g),v(h),a=!0)},o(N){M(f),M(t.$$.fragment,N),M(u),M(c),M(g),M(h),a=!1},d(N){N&&(m(e),m(l),m(s),m(r),m(i),m(o)),f&&f.d(N),ee(t,N),u&&u.d(N),c&&c.d(N),g&&g.d(N),h&&h.d(N)}}}function Ss(n){var s,r,i,o;let e,t,l=(((s=n[31])==null?void 0:s.role)==="user"?((o=(i=(r=n[31])==null?void 0:r.permissions)==null?void 0:i.chat)==null?void 0:o.edit)??!0:!0)&&Bs(n);return{c(){l&&l.c(),e=ce()},l(a){l&&l.l(a),e=ce()},m(a,f){l&&l.m(a,f),E(a,e,f),t=!0},p(a,f){var u,c,g,h;((u=a[31])==null?void 0:u.role)!=="user"||(((h=(g=(c=a[31])==null?void 0:c.permissions)==null?void 0:g.chat)==null?void 0:h.edit)??!0)?l?(l.p(a,f),f[1]&1&&v(l,1)):(l=Bs(a),l.c(),v(l,1),l.m(e.parentNode,e)):l&&(te(),M(l,1,1,()=>{l=null}),le())},i(a){t||(v(l),t=!0)},o(a){M(l),t=!1},d(a){a&&m(e),l&&l.d(a)}}}function Bs(n){let e,t;return e=new Be({props:{content:n[30].t("Edit"),placement:"bottom",$$slots:{default:[_o]},$$scope:{ctx:n}}}),{c(){Y(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},p(l,s){const r={};s[0]&1073741824&&(r.content=l[30].t("Edit")),s[0]&1073750016|s[3]&32&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function _o(n){let e,t,l,s,r,i,o;return{c(){e=w("button"),t=pe("svg"),l=pe("path"),this.h()},l(a){e=y(a,"BUTTON",{"aria-label":!0,class:!0});var f=k(e);t=ve(f,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,"aria-hidden":!0,stroke:!0,class:!0});var u=k(t);l=ve(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(m),u.forEach(m),f.forEach(m),this.h()},h(){d(l,"stroke-linecap","round"),d(l,"stroke-linejoin","round"),d(l,"d","M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"),d(t,"xmlns","http://www.w3.org/2000/svg"),d(t,"fill","none"),d(t,"viewBox","0 0 24 24"),d(t,"stroke-width","2.3"),d(t,"aria-hidden","true"),d(t,"stroke","currentColor"),d(t,"class","w-4 h-4"),d(e,"aria-label",s=n[30].t("Edit")),d(e,"class",r=(n[13]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(a,f){E(a,e,f),b(e,t),b(t,l),i||(o=he(e,"click",n[68]),i=!0)},p(a,f){f[0]&1073741824&&s!==(s=a[30].t("Edit"))&&d(e,"aria-label",s),f[0]&8192&&r!==(r=(a[13]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")&&d(e,"class",r)},d(a){a&&m(e),i=!1,o()}}}function bo(n){let e,t,l,s,r,i,o;return{c(){e=w("button"),t=pe("svg"),l=pe("path"),this.h()},l(a){e=y(a,"BUTTON",{"aria-label":!0,class:!0});var f=k(e);t=ve(f,"svg",{xmlns:!0,fill:!0,"aria-hidden":!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var u=k(t);l=ve(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(m),u.forEach(m),f.forEach(m),this.h()},h(){d(l,"stroke-linecap","round"),d(l,"stroke-linejoin","round"),d(l,"d","M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184"),d(t,"xmlns","http://www.w3.org/2000/svg"),d(t,"fill","none"),d(t,"aria-hidden","true"),d(t,"viewBox","0 0 24 24"),d(t,"stroke-width","2.3"),d(t,"stroke","currentColor"),d(t,"class","w-4 h-4"),d(e,"aria-label",s=n[30].t("Copy")),d(e,"class",r=(n[13]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition copy-response-button")},m(a,f){E(a,e,f),b(e,t),b(t,l),i||(o=he(e,"click",n[69]),i=!0)},p(a,f){f[0]&1073741824&&s!==(s=a[30].t("Copy"))&&d(e,"aria-label",s),f[0]&8192&&r!==(r=(a[13]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition copy-response-button")&&d(e,"class",r)},d(a){a&&m(e),i=!1,o()}}}function Os(n){let e,t;return e=new Be({props:{content:n[30].t("Read Aloud"),placement:"bottom",$$slots:{default:[wo]},$$scope:{ctx:n}}}),{c(){Y(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},p(l,s){const r={};s[0]&1073741824&&(r.content=l[30].t("Read Aloud")),s[0]&1098948608|s[3]&32&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function po(n){let e,t;return{c(){e=pe("svg"),t=pe("path"),this.h()},l(l){e=ve(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"aria-hidden":!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=ve(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(m),s.forEach(m),this.h()},h(){d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"d","M19.114 5.636a9 9 0 010 12.728M16.463 8.288a5.25 5.25 0 010 7.424M6.75 8.25l4.72-4.72a.75.75 0 011.28.53v15.88a.75.75 0 01-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.01 9.01 0 012.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75z"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"fill","none"),d(e,"viewBox","0 0 24 24"),d(e,"aria-hidden","true"),d(e,"stroke-width","2.3"),d(e,"stroke","currentColor"),d(e,"class","w-4 h-4")},m(l,s){E(l,e,s),b(e,t)},d(l){l&&m(e)}}}function vo(n){let e,t;return{c(){e=pe("svg"),t=pe("path"),this.h()},l(l){e=ve(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"aria-hidden":!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=ve(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(m),s.forEach(m),this.h()},h(){d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"d","M17.25 9.75 19.5 12m0 0 2.25 2.25M19.5 12l2.25-2.25M19.5 12l-2.25 2.25m-10.5-6 4.72-4.72a.75.75 0 0 1 1.28.53v15.88a.75.75 0 0 1-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.009 9.009 0 0 1 2.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75Z"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"fill","none"),d(e,"viewBox","0 0 24 24"),d(e,"aria-hidden","true"),d(e,"stroke-width","2.3"),d(e,"stroke","currentColor"),d(e,"class","w-4 h-4")},m(l,s){E(l,e,s),b(e,t)},d(l){l&&m(e)}}}function ko(n){let e,t,l,s,r,i;return{c(){e=pe("svg"),t=pe("style"),l=W(`.spinner_S1WN {
															animation: spinner_MGfb 0.8s linear infinite;
															animation-delay: -0.8s;
														}

														.spinner_Km9P {
															animation-delay: -0.65s;
														}

														.spinner_JApP {
															animation-delay: -0.5s;
														}

														@keyframes spinner_MGfb {
															93.75%,
															100% {
																opacity: 0.2;
															}
														}
													`),s=pe("circle"),r=pe("circle"),i=pe("circle"),this.h()},l(o){e=ve(o,"svg",{class:!0,fill:!0,viewBox:!0,"aria-hidden":!0,xmlns:!0});var a=k(e);t=ve(a,"style",{});var f=k(t);l=q(f,`.spinner_S1WN {
															animation: spinner_MGfb 0.8s linear infinite;
															animation-delay: -0.8s;
														}

														.spinner_Km9P {
															animation-delay: -0.65s;
														}

														.spinner_JApP {
															animation-delay: -0.5s;
														}

														@keyframes spinner_MGfb {
															93.75%,
															100% {
																opacity: 0.2;
															}
														}
													`),f.forEach(m),s=ve(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(s).forEach(m),r=ve(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(r).forEach(m),i=ve(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(i).forEach(m),a.forEach(m),this.h()},h(){d(s,"class","spinner_S1WN"),d(s,"cx","4"),d(s,"cy","12"),d(s,"r","3"),d(r,"class","spinner_S1WN spinner_Km9P"),d(r,"cx","12"),d(r,"cy","12"),d(r,"r","3"),d(i,"class","spinner_S1WN spinner_JApP"),d(i,"cx","20"),d(i,"cy","12"),d(i,"r","3"),d(e,"class","w-4 h-4"),d(e,"fill","currentColor"),d(e,"viewBox","0 0 24 24"),d(e,"aria-hidden","true"),d(e,"xmlns","http://www.w3.org/2000/svg")},m(o,a){E(o,e,a),b(e,t),b(t,l),b(e,s),b(e,r),b(e,i)},d(o){o&&m(e)}}}function wo(n){let e,t,l,s,r,i;function o(u,c){return u[24]?ko:u[23]?vo:po}let a=o(n),f=a(n);return{c(){e=w("button"),f.c(),this.h()},l(u){e=y(u,"BUTTON",{"aria-label":!0,id:!0,class:!0});var c=k(e);f.l(c),c.forEach(m),this.h()},h(){d(e,"aria-label",t=n[30].t("Read Aloud")),d(e,"id",l="speak-button-"+n[15].id),d(e,"class",s=(n[13]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(u,c){E(u,e,c),f.m(e,null),r||(i=he(e,"click",n[70]),r=!0)},p(u,c){a!==(a=o(u))&&(f.d(1),f=a(u),f&&(f.c(),f.m(e,null))),c[0]&1073741824&&t!==(t=u[30].t("Read Aloud"))&&d(e,"aria-label",t),c[0]&32768&&l!==(l="speak-button-"+u[15].id)&&d(e,"id",l),c[0]&8192&&s!==(s=(u[13]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")&&d(e,"class",s)},d(u){u&&m(e),f.d(),r=!1,i()}}}function Rs(n){let e,t;return e=new Be({props:{content:n[30].t("Generate Image"),placement:"bottom",$$slots:{default:[Mo]},$$scope:{ctx:n}}}),{c(){Y(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},p(l,s){const r={};s[0]&1073741824&&(r.content=l[30].t("Generate Image")),s[0]&1107337216|s[3]&32&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function yo(n){let e,t;return{c(){e=pe("svg"),t=pe("path"),this.h()},l(l){e=ve(l,"svg",{xmlns:!0,fill:!0,"aria-hidden":!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=ve(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(m),s.forEach(m),this.h()},h(){d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"d","m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"fill","none"),d(e,"aria-hidden","true"),d(e,"viewBox","0 0 24 24"),d(e,"stroke-width","2.3"),d(e,"stroke","currentColor"),d(e,"class","w-4 h-4")},m(l,s){E(l,e,s),b(e,t)},d(l){l&&m(e)}}}function Io(n){let e,t,l,s,r,i;return{c(){e=pe("svg"),t=pe("style"),l=W(`.spinner_S1WN {
															animation: spinner_MGfb 0.8s linear infinite;
															animation-delay: -0.8s;
														}

														.spinner_Km9P {
															animation-delay: -0.65s;
														}

														.spinner_JApP {
															animation-delay: -0.5s;
														}

														@keyframes spinner_MGfb {
															93.75%,
															100% {
																opacity: 0.2;
															}
														}
													`),s=pe("circle"),r=pe("circle"),i=pe("circle"),this.h()},l(o){e=ve(o,"svg",{"aria-hidden":!0,class:!0,fill:!0,viewBox:!0,xmlns:!0});var a=k(e);t=ve(a,"style",{});var f=k(t);l=q(f,`.spinner_S1WN {
															animation: spinner_MGfb 0.8s linear infinite;
															animation-delay: -0.8s;
														}

														.spinner_Km9P {
															animation-delay: -0.65s;
														}

														.spinner_JApP {
															animation-delay: -0.5s;
														}

														@keyframes spinner_MGfb {
															93.75%,
															100% {
																opacity: 0.2;
															}
														}
													`),f.forEach(m),s=ve(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(s).forEach(m),r=ve(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(r).forEach(m),i=ve(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(i).forEach(m),a.forEach(m),this.h()},h(){d(s,"class","spinner_S1WN"),d(s,"cx","4"),d(s,"cy","12"),d(s,"r","3"),d(r,"class","spinner_S1WN spinner_Km9P"),d(r,"cx","12"),d(r,"cy","12"),d(r,"r","3"),d(i,"class","spinner_S1WN spinner_JApP"),d(i,"cx","20"),d(i,"cy","12"),d(i,"r","3"),d(e,"aria-hidden","true"),d(e,"class","w-4 h-4"),d(e,"fill","currentColor"),d(e,"viewBox","0 0 24 24"),d(e,"xmlns","http://www.w3.org/2000/svg")},m(o,a){E(o,e,a),b(e,t),b(t,l),b(e,s),b(e,r),b(e,i)},d(o){o&&m(e)}}}function Mo(n){let e,t,l,s,r;function i(f,u){return f[25]?Io:yo}let o=i(n),a=o(n);return{c(){e=w("button"),a.c(),this.h()},l(f){e=y(f,"BUTTON",{"aria-label":!0,class:!0});var u=k(e);a.l(u),u.forEach(m),this.h()},h(){d(e,"aria-label",t=n[30].t("Generate Image")),d(e,"class",l=(n[13]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(f,u){E(f,e,u),a.m(e,null),s||(r=he(e,"click",n[71]),s=!0)},p(f,u){o!==(o=i(f))&&(a.d(1),a=o(f),a&&(a.c(),a.m(e,null))),u[0]&1073741824&&t!==(t=f[30].t("Generate Image"))&&d(e,"aria-label",t),u[0]&8192&&l!==(l=(f[13]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")&&d(e,"class",l)},d(f){f&&m(e),a.d(),s=!1,r()}}}function Ps(n){let e,t;return e=new Be({props:{content:n[15].usage?`<pre>${kt(JSON.stringify(n[15].usage,null,2).replace(/"([^(")"]+)":/g,"$1:").slice(1,-1).split(`
`).map(Ks).map(Zs).join(`
`))}</pre>`:"",placement:"bottom",$$slots:{default:[Eo]},$$scope:{ctx:n}}}),{c(){Y(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},p(l,s){const r={};s[0]&32768&&(r.content=l[15].usage?`<pre>${kt(JSON.stringify(l[15].usage,null,2).replace(/"([^(")"]+)":/g,"$1:").slice(1,-1).split(`
`).map(Ks).map(Zs).join(`
`))}</pre>`:""),s[0]&40960|s[3]&32&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function Eo(n){let e,t,l,s,r,i,o;return{c(){e=w("button"),t=pe("svg"),l=pe("path"),this.h()},l(a){e=y(a,"BUTTON",{"aria-hidden":!0,class:!0,id:!0});var f=k(e);t=ve(f,"svg",{"aria-hidden":!0,xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var u=k(t);l=ve(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(m),u.forEach(m),f.forEach(m),this.h()},h(){d(l,"stroke-linecap","round"),d(l,"stroke-linejoin","round"),d(l,"d","M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"),d(t,"aria-hidden","true"),d(t,"xmlns","http://www.w3.org/2000/svg"),d(t,"fill","none"),d(t,"viewBox","0 0 24 24"),d(t,"stroke-width","2.3"),d(t,"stroke","currentColor"),d(t,"class","w-4 h-4"),d(e,"aria-hidden","true"),d(e,"class",s=(n[13]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition whitespace-pre-wrap"),d(e,"id",r="info-"+n[15].id)},m(a,f){E(a,e,f),b(e,t),b(t,l),i||(o=he(e,"click",n[72]),i=!0)},p(a,f){f[0]&8192&&s!==(s=(a[13]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition whitespace-pre-wrap")&&d(e,"class",s),f[0]&32768&&r!==(r="info-"+a[15].id)&&d(e,"id",r)},d(a){a&&m(e),i=!1,o()}}}function As(n){var g;let e,t,l,s,r,i,o,a=!n[32]&&(((g=n[29])==null?void 0:g.features.enable_message_rating)??!0)&&Ls(n),f=n[13]&&js(n);l=new Be({props:{content:n[30].t("Regenerate"),placement:"bottom",$$slots:{default:[To]},$$scope:{ctx:n}}});let u=n[2].length>1&&Hs(n),c=n[13]&&zs(n);return{c(){a&&a.c(),e=H(),f&&f.c(),t=H(),Y(l.$$.fragment),s=H(),u&&u.c(),r=H(),c&&c.c(),i=ce()},l(h){a&&a.l(h),e=z(h),f&&f.l(h),t=z(h),$(l.$$.fragment,h),s=z(h),u&&u.l(h),r=z(h),c&&c.l(h),i=ce()},m(h,_){a&&a.m(h,_),E(h,e,_),f&&f.m(h,_),E(h,t,_),x(l,h,_),E(h,s,_),u&&u.m(h,_),E(h,r,_),c&&c.m(h,_),E(h,i,_),o=!0},p(h,_){var p;!h[32]&&(((p=h[29])==null?void 0:p.features.enable_message_rating)??!0)?a?(a.p(h,_),_[0]&536870912|_[1]&2&&v(a,1)):(a=Ls(h),a.c(),v(a,1),a.m(e.parentNode,e)):a&&(te(),M(a,1,1,()=>{a=null}),le()),h[13]?f?(f.p(h,_),_[0]&8192&&v(f,1)):(f=js(h),f.c(),v(f,1),f.m(t.parentNode,t)):f&&(te(),M(f,1,1,()=>{f=null}),le());const T={};_[0]&1073741824&&(T.content=h[30].t("Regenerate")),_[0]&1141417984|_[3]&32&&(T.$$scope={dirty:_,ctx:h}),l.$set(T),h[2].length>1?u?(u.p(h,_),_[0]&4&&v(u,1)):(u=Hs(h),u.c(),v(u,1),u.m(r.parentNode,r)):u&&(te(),M(u,1,1,()=>{u=null}),le()),h[13]?c?(c.p(h,_),_[0]&8192&&v(c,1)):(c=zs(h),c.c(),v(c,1),c.m(i.parentNode,i)):c&&(te(),M(c,1,1,()=>{c=null}),le())},i(h){o||(v(a),v(f),v(l.$$.fragment,h),v(u),v(c),o=!0)},o(h){M(a),M(f),M(l.$$.fragment,h),M(u),M(c),o=!1},d(h){h&&(m(e),m(t),m(s),m(r),m(i)),a&&a.d(h),f&&f.d(h),ee(l,h),u&&u.d(h),c&&c.d(h)}}}function Ls(n){let e,t,l,s;return e=new Be({props:{content:n[30].t("Good Response"),placement:"bottom",$$slots:{default:[No]},$$scope:{ctx:n}}}),l=new Be({props:{content:n[30].t("Bad Response"),placement:"bottom",$$slots:{default:[Do]},$$scope:{ctx:n}}}),{c(){Y(e.$$.fragment),t=H(),Y(l.$$.fragment)},l(r){$(e.$$.fragment,r),t=z(r),$(l.$$.fragment,r)},m(r,i){x(e,r,i),E(r,t,i),x(l,r,i),s=!0},p(r,i){const o={};i[0]&1073741824&&(o.content=r[30].t("Good Response")),i[0]&1208000512|i[3]&32&&(o.$$scope={dirty:i,ctx:r}),e.$set(o);const a={};i[0]&1073741824&&(a.content=r[30].t("Bad Response")),i[0]&1208000512|i[3]&32&&(a.$$scope={dirty:i,ctx:r}),l.$set(a)},i(r){s||(v(e.$$.fragment,r),v(l.$$.fragment,r),s=!0)},o(r){M(e.$$.fragment,r),M(l.$$.fragment,r),s=!1},d(r){r&&m(t),ee(e,r),ee(l,r)}}}function No(n){let e,t,l,s,r,i,o;return{c(){e=w("button"),t=pe("svg"),l=pe("path"),this.h()},l(a){e=y(a,"BUTTON",{"aria-label":!0,class:!0});var f=k(e);t=ve(f,"svg",{"aria-hidden":!0,stroke:!0,fill:!0,"stroke-width":!0,viewBox:!0,"stroke-linecap":!0,"stroke-linejoin":!0,class:!0,xmlns:!0});var u=k(t);l=ve(u,"path",{d:!0}),k(l).forEach(m),u.forEach(m),f.forEach(m),this.h()},h(){var a,f;d(l,"d","M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"),d(t,"aria-hidden","true"),d(t,"stroke","currentColor"),d(t,"fill","none"),d(t,"stroke-width","2.3"),d(t,"viewBox","0 0 24 24"),d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"class","w-4 h-4"),d(t,"xmlns","http://www.w3.org/2000/svg"),d(e,"aria-label",s=n[30].t("Good Response")),d(e,"class",r=(n[13]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((f=(a=n[15])==null?void 0:a.annotation)==null?void 0:f.rating)??"").toString()==="1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent"),e.disabled=n[27]},m(a,f){E(a,e,f),b(e,t),b(t,l),i||(o=he(e,"click",n[73]),i=!0)},p(a,f){var u,c;f[0]&1073741824&&s!==(s=a[30].t("Good Response"))&&d(e,"aria-label",s),f[0]&40960&&r!==(r=(a[13]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((c=(u=a[15])==null?void 0:u.annotation)==null?void 0:c.rating)??"").toString()==="1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent")&&d(e,"class",r),f[0]&134217728&&(e.disabled=a[27])},d(a){a&&m(e),i=!1,o()}}}function Do(n){let e,t,l,s,r,i,o;return{c(){e=w("button"),t=pe("svg"),l=pe("path"),this.h()},l(a){e=y(a,"BUTTON",{"aria-label":!0,class:!0});var f=k(e);t=ve(f,"svg",{"aria-hidden":!0,stroke:!0,fill:!0,"stroke-width":!0,viewBox:!0,"stroke-linecap":!0,"stroke-linejoin":!0,class:!0,xmlns:!0});var u=k(t);l=ve(u,"path",{d:!0}),k(l).forEach(m),u.forEach(m),f.forEach(m),this.h()},h(){var a,f;d(l,"d","M10 15v4a3 3 0 0 0 3 3l4-9V2H5.72a2 2 0 0 0-2 1.7l-1.38 9a2 2 0 0 0 2 2.3zm7-13h2.67A2.31 2.31 0 0 1 22 4v7a2.31 2.31 0 0 1-2.33 2H17"),d(t,"aria-hidden","true"),d(t,"stroke","currentColor"),d(t,"fill","none"),d(t,"stroke-width","2.3"),d(t,"viewBox","0 0 24 24"),d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"class","w-4 h-4"),d(t,"xmlns","http://www.w3.org/2000/svg"),d(e,"aria-label",s=n[30].t("Bad Response")),d(e,"class",r=(n[13]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((f=(a=n[15])==null?void 0:a.annotation)==null?void 0:f.rating)??"").toString()==="-1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent"),e.disabled=n[27]},m(a,f){E(a,e,f),b(e,t),b(t,l),i||(o=he(e,"click",n[74]),i=!0)},p(a,f){var u,c;f[0]&1073741824&&s!==(s=a[30].t("Bad Response"))&&d(e,"aria-label",s),f[0]&40960&&r!==(r=(a[13]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((c=(u=a[15])==null?void 0:u.annotation)==null?void 0:c.rating)??"").toString()==="-1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent")&&d(e,"class",r),f[0]&134217728&&(e.disabled=a[27])},d(a){a&&m(e),i=!1,o()}}}function js(n){let e,t;return e=new Be({props:{content:n[30].t("Continue Response"),placement:"bottom",$$slots:{default:[Vo]},$$scope:{ctx:n}}}),{c(){Y(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},p(l,s){const r={};s[0]&1073741824&&(r.content=l[30].t("Continue Response")),s[0]&1073751040|s[3]&32&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function Vo(n){let e,t,l,s,r,i,o,a;return{c(){e=w("button"),t=pe("svg"),l=pe("path"),s=pe("path"),this.h()},l(f){e=y(f,"BUTTON",{"aria-label":!0,type:!0,id:!0,class:!0});var u=k(e);t=ve(u,"svg",{"aria-hidden":!0,xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var c=k(t);l=ve(c,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(m),s=ve(c,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(s).forEach(m),c.forEach(m),u.forEach(m),this.h()},h(){d(l,"stroke-linecap","round"),d(l,"stroke-linejoin","round"),d(l,"d","M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"),d(s,"stroke-linecap","round"),d(s,"stroke-linejoin","round"),d(s,"d","M15.91 11.672a.375.375 0 0 1 0 .656l-5.603 3.113a.375.375 0 0 1-.557-.328V8.887c0-.286.307-.466.557-.327l5.603 3.112Z"),d(t,"aria-hidden","true"),d(t,"xmlns","http://www.w3.org/2000/svg"),d(t,"fill","none"),d(t,"viewBox","0 0 24 24"),d(t,"stroke-width","2.3"),d(t,"stroke","currentColor"),d(t,"class","w-4 h-4"),d(e,"aria-label",r=n[30].t("Continue Response")),d(e,"type","button"),d(e,"id","continue-response-button"),d(e,"class",i=(n[13]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(f,u){E(f,e,u),b(e,t),b(t,l),b(t,s),o||(a=he(e,"click",n[75]),o=!0)},p(f,u){u[0]&1073741824&&r!==(r=f[30].t("Continue Response"))&&d(e,"aria-label",r),u[0]&8192&&i!==(i=(f[13]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")&&d(e,"class",i)},d(f){f&&m(e),o=!1,a()}}}function To(n){let e,t,l,s,r,i,o;return{c(){e=w("button"),t=pe("svg"),l=pe("path"),this.h()},l(a){e=y(a,"BUTTON",{type:!0,"aria-label":!0,class:!0});var f=k(e);t=ve(f,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,"aria-hidden":!0,stroke:!0,class:!0});var u=k(t);l=ve(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(m),u.forEach(m),f.forEach(m),this.h()},h(){d(l,"stroke-linecap","round"),d(l,"stroke-linejoin","round"),d(l,"d","M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99"),d(t,"xmlns","http://www.w3.org/2000/svg"),d(t,"fill","none"),d(t,"viewBox","0 0 24 24"),d(t,"stroke-width","2.3"),d(t,"aria-hidden","true"),d(t,"stroke","currentColor"),d(t,"class","w-4 h-4"),d(e,"type","button"),d(e,"aria-label",s=n[30].t("Regenerate")),d(e,"class",r=(n[13]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(a,f){E(a,e,f),b(e,t),b(t,l),i||(o=he(e,"click",n[76]),i=!0)},p(a,f){f[0]&1073741824&&s!==(s=a[30].t("Regenerate"))&&d(e,"aria-label",s),f[0]&8192&&r!==(r=(a[13]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")&&d(e,"class",r)},d(a){a&&m(e),i=!1,o()}}}function Hs(n){let e,t;return e=new Be({props:{content:n[30].t("Delete"),placement:"bottom",$$slots:{default:[Co]},$$scope:{ctx:n}}}),{c(){Y(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},p(l,s){const r={};s[0]&1073741824&&(r.content=l[30].t("Delete")),s[0]&1074012160|s[3]&32&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function Co(n){let e,t,l,s,r,i,o;return{c(){e=w("button"),t=pe("svg"),l=pe("path"),this.h()},l(a){e=y(a,"BUTTON",{type:!0,"aria-label":!0,id:!0,class:!0});var f=k(e);t=ve(f,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,"aria-hidden":!0,class:!0});var u=k(t);l=ve(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(m),u.forEach(m),f.forEach(m),this.h()},h(){d(l,"stroke-linecap","round"),d(l,"stroke-linejoin","round"),d(l,"d","m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"),d(t,"xmlns","http://www.w3.org/2000/svg"),d(t,"fill","none"),d(t,"viewBox","0 0 24 24"),d(t,"stroke-width","2"),d(t,"stroke","currentColor"),d(t,"aria-hidden","true"),d(t,"class","w-4 h-4"),d(e,"type","button"),d(e,"aria-label",s=n[30].t("Delete")),d(e,"id","delete-response-button"),d(e,"class",r=(n[13]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(a,f){E(a,e,f),b(e,t),b(t,l),i||(o=he(e,"click",n[77]),i=!0)},p(a,f){f[0]&1073741824&&s!==(s=a[30].t("Delete"))&&d(e,"aria-label",s),f[0]&8192&&r!==(r=(a[13]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")&&d(e,"class",r)},d(a){a&&m(e),i=!1,o()}}}function zs(n){var i;let e,t,l=Ve(((i=n[19])==null?void 0:i.actions)??[]),s=[];for(let o=0;o<l.length;o+=1)s[o]=Us(bs(n,l,o));const r=o=>M(s[o],1,1,()=>{s[o]=null});return{c(){for(let o=0;o<s.length;o+=1)s[o].c();e=ce()},l(o){for(let a=0;a<s.length;a+=1)s[a].l(o);e=ce()},m(o,a){for(let f=0;f<s.length;f+=1)s[f]&&s[f].m(o,a);E(o,e,a),t=!0},p(o,a){var f;if(a[0]&565504){l=Ve(((f=o[19])==null?void 0:f.actions)??[]);let u;for(u=0;u<l.length;u+=1){const c=bs(o,l,u);s[u]?(s[u].p(c,a),v(s[u],1)):(s[u]=Us(c),s[u].c(),v(s[u],1),s[u].m(e.parentNode,e))}for(te(),u=l.length;u<s.length;u+=1)r(u);le()}},i(o){if(!t){for(let a=0;a<l.length;a+=1)v(s[a]);t=!0}},o(o){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)M(s[a]);t=!1},d(o){o&&m(e),qe(s,o)}}}function So(n){let e,t;return e=new Gr({props:{strokeWidth:"2.1",className:"size-4"}}),{c(){Y(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},p:De,i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function Bo(n){let e,t,l,s,r;return{c(){e=w("div"),t=w("img"),this.h()},l(i){e=y(i,"DIV",{class:!0});var o=k(e);t=y(o,"IMG",{src:!0,class:!0,style:!0,alt:!0}),o.forEach(m),this.h()},h(){Lt(t.src,l=n[91].icon)||d(t,"src",l),d(t,"class",s="w-4 h-4 "+(n[91].icon.includes("svg")?"dark:invert-[80%]":"")),At(t,"fill","currentColor"),d(t,"alt",r=n[91].name),d(e,"class","size-4")},m(i,o){E(i,e,o),b(e,t)},p(i,o){o[0]&524288&&!Lt(t.src,l=i[91].icon)&&d(t,"src",l),o[0]&524288&&s!==(s="w-4 h-4 "+(i[91].icon.includes("svg")?"dark:invert-[80%]":""))&&d(t,"class",s),o[0]&524288&&r!==(r=i[91].name)&&d(t,"alt",r)},i:De,o:De,d(i){i&&m(e)}}}function Oo(n){let e,t,l,s,r,i,o,a,f;const u=[Bo,So],c=[];function g(_,T){var p;return(p=_[91])!=null&&p.icon?0:1}t=g(n),l=c[t]=u[t](n);function h(){return n[78](n[91])}return{c(){e=w("button"),l.c(),i=H(),this.h()},l(_){e=y(_,"BUTTON",{type:!0,"aria-label":!0,class:!0});var T=k(e);l.l(T),T.forEach(m),i=z(_),this.h()},h(){d(e,"type","button"),d(e,"aria-label",s=n[91].name),d(e,"class",r=(n[13]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(_,T){E(_,e,T),c[t].m(e,null),E(_,i,T),o=!0,a||(f=he(e,"click",h),a=!0)},p(_,T){n=_;let p=t;t=g(n),t===p?c[t].p(n,T):(te(),M(c[p],1,1,()=>{c[p]=null}),le(),l=c[t],l?l.p(n,T):(l=c[t]=u[t](n),l.c()),v(l,1),l.m(e,null)),(!o||T[0]&524288&&s!==(s=n[91].name))&&d(e,"aria-label",s),(!o||T[0]&8192&&r!==(r=(n[13]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition"))&&d(e,"class",r)},i(_){o||(v(l),o=!0)},o(_){M(l),o=!1},d(_){_&&(m(e),m(i)),c[t].d(),a=!1,f()}}}function Us(n){let e,t;return e=new Be({props:{content:n[91].name,placement:"bottom",$$slots:{default:[Oo]},$$scope:{ctx:n}}}),{c(){Y(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},p(l,s){const r={};s[0]&524288&&(r.content=l[91].name),s[0]&565504|s[3]&32&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function Ws(n){let e,t,l,s;function r(a){n[80](a)}function i(a){n[81](a)}let o={};return n[15]!==void 0&&(o.message=n[15]),n[26]!==void 0&&(o.show=n[26]),e=new wi({props:o}),ze.push(()=>Ye(e,"message",r)),ze.push(()=>Ye(e,"show",i)),e.$on("save",n[82]),{c(){Y(e.$$.fragment)},l(a){$(e.$$.fragment,a)},m(a,f){x(e,a,f),s=!0},p(a,f){const u={};!t&&f[0]&32768&&(t=!0,u.message=a[15],Xe(()=>t=!1)),!l&&f[0]&67108864&&(l=!0,u.show=a[26],Xe(()=>l=!1)),e.$set(u)},i(a){s||(v(e.$$.fragment,a),s=!0)},o(a){M(e.$$.fragment,a),s=!1},d(a){ee(e,a)}}}function qs(n){var r;let e,t,l,s;return t=new Fa({props:{followUps:(r=n[15])==null?void 0:r.followUps,onClick:n[83]}}),{c(){e=w("div"),Y(t.$$.fragment),this.h()},l(i){e=y(i,"DIV",{class:!0});var o=k(e);$(t.$$.fragment,o),o.forEach(m),this.h()},h(){d(e,"class","mt-2.5")},m(i,o){E(i,e,o),x(t,e,null),s=!0},p(i,o){var f;const a={};o[0]&32768&&(a.followUps=(f=i[15])==null?void 0:f.followUps),o[0]&268468744&&(a.onClick=i[83]),t.$set(a)},i(i){s||(v(t.$$.fragment,i),i&&(l||Et(()=>{l=Nt(e,Dt,{duration:100}),l.start()})),s=!0)},o(i){M(t.$$.fragment,i),s=!1},d(i){i&&m(e),ee(t)}}}function Fs(n){var s;let e,t=(((s=n[15])==null?void 0:s.content)??"")+"",l;return{c(){e=w("div"),l=W(t),this.h()},l(r){e=y(r,"DIV",{"aria-live":!0,class:!0});var i=k(e);l=q(i,t),i.forEach(m),this.h()},h(){d(e,"aria-live","polite"),d(e,"class","sr-only")},m(r,i){E(r,e,i),b(e,l)},p(r,i){var o;i[0]&32768&&t!==(t=(((o=r[15])==null?void 0:o.content)??"")+"")&&Z(l,t)},d(r){r&&m(e)}}}function Js(n){var _e,U,ne,fe,ue,we,X,re,ge;let e,t,l,s,r,i,o,a,f,u,c,g=((_e=n[15])==null?void 0:_e.files)&&((U=n[15].files)==null?void 0:U.filter(Gs).length)>0,h,_,T,p,D,V,L,O,P,I;l=new Fn({props:{src:((ue=(fe=(ne=n[19])==null?void 0:ne.info)==null?void 0:fe.meta)==null?void 0:ue.profile_image_url)??(n[30].language==="dg-DG"?`${Qe}/doge.png`:`${Qe}/favicon.png`),className:"size-8 assistant-message-profile-image"}}),i=new Qt({props:{$$slots:{default:[Ka]},$$scope:{ctx:n}}});let N=(((we=n[15])==null?void 0:we.statusHistory)??[...(X=n[15])!=null&&X.status?[(re=n[15])==null?void 0:re.status]:[]]).length>0&&ks(qt(n)),S=g&&ys(n);const C=[uo,fo],B=[];function F(ie,de){return ie[16]===!0?0:1}_=F(n),T=B[_]=C[_](n);let R=!n[16]&&Ds(n),Q=((ge=n[15])==null?void 0:ge.done)&&Fs(n);return{c(){e=w("div"),t=w("div"),Y(l.$$.fragment),s=H(),r=w("div"),Y(i.$$.fragment),o=H(),a=w("div"),f=w("div"),u=w("div"),N&&N.c(),c=H(),S&&S.c(),h=H(),T.c(),D=H(),R&&R.c(),V=H(),Q&&Q.c(),this.h()},l(ie){e=y(ie,"DIV",{class:!0,id:!0,dir:!0});var de=k(e);t=y(de,"DIV",{class:!0});var ke=k(t);$(l.$$.fragment,ke),ke.forEach(m),s=z(de),r=y(de,"DIV",{class:!0});var ye=k(r);$(i.$$.fragment,ye),o=z(ye),a=y(ye,"DIV",{});var J=k(a);f=y(J,"DIV",{class:!0});var me=k(f);u=y(me,"DIV",{});var ae=k(u);N&&N.l(ae),c=z(ae),S&&S.l(ae),h=z(ae),T.l(ae),ae.forEach(m),me.forEach(m),D=z(J),R&&R.l(J),J.forEach(m),V=z(ye),Q&&Q.l(ye),ye.forEach(m),de.forEach(m),this.h()},h(){d(t,"class",Tr("shrink-0 ltr:mr-3 rtl:ml-3 hidden @lg:flex mt-1 ")+" svelte-1u5gq5j"),d(f,"class",p="chat-"+n[15].role+" w-full min-w-full markdown-prose svelte-1u5gq5j"),d(r,"class","flex-auto w-0 pl-1 relative"),d(e,"class",L="flex w-full message-"+n[15].id+" svelte-1u5gq5j"),d(e,"id",O="message-"+n[15].id),d(e,"dir",P=n[28].chatDirection)},m(ie,de){E(ie,e,de),b(e,t),x(l,t,null),b(e,s),b(e,r),x(i,r,null),b(r,o),b(r,a),b(a,f),b(f,u),N&&N.m(u,null),b(u,c),S&&S.m(u,null),b(u,h),B[_].m(u,null),b(a,D),R&&R.m(a,null),b(r,V),Q&&Q.m(r,null),I=!0},p(ie,de){var me,ae,A,K,G,oe,be,Ee,Me;const ke={};de[0]&1074266112&&(ke.src=((A=(ae=(me=ie[19])==null?void 0:me.info)==null?void 0:ae.meta)==null?void 0:A.profile_image_url)??(ie[30].language==="dg-DG"?`${Qe}/doge.png`:`${Qe}/favicon.png`)),l.$set(ke);const ye={};de[0]&557056|de[3]&32&&(ye.$$scope={dirty:de,ctx:ie}),i.$set(ye),(((K=ie[15])==null?void 0:K.statusHistory)??[...(G=ie[15])!=null&&G.status?[(oe=ie[15])==null?void 0:oe.status]:[]]).length>0?N?(N.p(qt(ie),de),de[0]&32768&&v(N,1)):(N=ks(qt(ie)),N.c(),v(N,1),N.m(u,c)):N&&(te(),M(N,1,1,()=>{N=null}),le()),de[0]&32768&&(g=((be=ie[15])==null?void 0:be.files)&&((Ee=ie[15].files)==null?void 0:Ee.filter(Gs).length)>0),g?S?(S.p(ie,de),de[0]&32768&&v(S,1)):(S=ys(ie),S.c(),v(S,1),S.m(u,h)):S&&(te(),M(S,1,1,()=>{S=null}),le());let J=_;_=F(ie),_===J?B[_].p(ie,de):(te(),M(B[J],1,1,()=>{B[J]=null}),le(),T=B[_],T?T.p(ie,de):(T=B[_]=C[_](ie),T.c()),v(T,1),T.m(u,null)),(!I||de[0]&32768&&p!==(p="chat-"+ie[15].role+" w-full min-w-full markdown-prose svelte-1u5gq5j"))&&d(f,"class",p),ie[16]?R&&(te(),M(R,1,1,()=>{R=null}),le()):R?(R.p(ie,de),de[0]&65536&&v(R,1)):(R=Ds(ie),R.c(),v(R,1),R.m(a,null)),(Me=ie[15])!=null&&Me.done?Q?Q.p(ie,de):(Q=Fs(ie),Q.c(),Q.m(r,null)):Q&&(Q.d(1),Q=null),(!I||de[0]&32768&&L!==(L="flex w-full message-"+ie[15].id+" svelte-1u5gq5j"))&&d(e,"class",L),(!I||de[0]&32768&&O!==(O="message-"+ie[15].id))&&d(e,"id",O),(!I||de[0]&268435456&&P!==(P=ie[28].chatDirection))&&d(e,"dir",P)},i(ie){I||(v(l.$$.fragment,ie),v(i.$$.fragment,ie),v(N),v(S),v(T),v(R),I=!0)},o(ie){M(l.$$.fragment,ie),M(i.$$.fragment,ie),M(N),M(S),M(T),M(R),I=!1},d(ie){ie&&m(e),ee(l),ee(i),N&&N.d(),S&&S.d(),B[_].d(),R&&R.d(),Q&&Q.d()}}}function Ro(n){let e,t,l,s=n[15].id,r,i;function o(u){n[51](u)}let a={title:n[30].t("Delete message?")};n[18]!==void 0&&(a.show=n[18]),e=new Zn({props:a}),ze.push(()=>Ye(e,"show",o)),e.$on("confirm",n[52]);let f=Js(n);return{c(){Y(e.$$.fragment),l=H(),f.c(),r=ce()},l(u){$(e.$$.fragment,u),l=z(u),f.l(u),r=ce()},m(u,c){x(e,u,c),E(u,l,c),f.m(u,c),E(u,r,c),i=!0},p(u,c){const g={};c[0]&1073741824&&(g.title=u[30].t("Delete message?")),!t&&c[0]&262144&&(t=!0,g.show=u[18],Xe(()=>t=!1)),e.$set(g),c[0]&32768&&Se(s,s=u[15].id)?(te(),M(f,1,1,De),le(),f=Js(u),f.c(),v(f,1),f.m(r.parentNode,r)):f.p(u,c)},i(u){i||(v(e.$$.fragment,u),v(f),i=!0)},o(u){M(e.$$.fragment,u),M(f),i=!1},d(u){u&&(m(l),m(r)),ee(e,u),f.d(u)}}}const Gs=n=>n.type==="image",Po=n=>{n.target.style.height="",n.target.style.height=`${n.target.scrollHeight}px`},Ao=n=>{n.target.select()},Ks=n=>n.slice(2),Zs=n=>n.endsWith(",")?n.slice(0,-1):n;function Lo(n,e,t){let l,s,r,i,o,a,f;Ne(n,zt,j=>t(50,l=j)),Ne(n,bt,j=>t(28,s=j)),Ne(n,Un,j=>t(29,r=j)),Ne(n,pl,j=>t(87,i=j)),Ne(n,Ut,j=>t(31,a=j)),Ne(n,Zt,j=>t(32,f=j));const u=Fe("i18n");Ne(n,u,j=>t(30,o=j));const c=Vt();let{chatId:g=""}=e,{history:h}=e,{messageId:_}=e,{selectedModels:T=[]}=e,p=JSON.parse(JSON.stringify(h.messages[_])),{siblings:D}=e,{setInputText:V=()=>{}}=e,{gotoMessage:L=()=>{}}=e,{showPreviousMessage:O}=e,{showNextMessage:P}=e,{updateChat:I}=e,{editMessage:N}=e,{saveMessage:S}=e,{rateMessage:C}=e,{actionMessage:B}=e,{deleteMessage:F}=e,{submitMessage:R}=e,{continueResponse:Q}=e,{regenerateResponse:_e}=e,{addMessages:U}=e,{isLastMessage:ne=!0}=e,{readOnly:fe=!1}=e,ue,we=!1,X=null,re=!1,ge="",ie,de=!1,ke={},ye=!1,J,me=!1,ae=!1,A=!1;const K=async j=>{var Ie,Re;j=wl(j),(((Ie=r==null?void 0:r.ui)==null?void 0:Ie.response_watermark)??"").trim()!==""&&(j=`${j}

${(Re=r==null?void 0:r.ui)==null?void 0:Re.response_watermark}`),await Wn(j,null,(s==null?void 0:s.copyFormatted)??!1)&&je.success(o.t("Copying to clipboard was successful!"))},G=j=>new Promise(Ce=>{J=j;const Ie=ke[j];if(!Ie)return Ce();Ie.play(),Ie.onended=async()=>{await new Promise(Re=>setTimeout(Re,300)),Object.keys(ke).length-1===j&&t(23,ye=!1),Ce()}}),oe=async()=>{var Ce,Ie,Re,st,nt,Rt,ht,It,Pe,Ze,ft,Mt,Pt,tl,ll,sl,nl,rl,il,al,ol,fl,ul;if(ye){try{speechSynthesis.cancel(),J!==void 0&&ke[J]&&(ke[J].pause(),ke[J].currentTime=0)}catch{}t(23,ye=!1),J=void 0;return}if(!((p==null?void 0:p.content)??"").trim().length){je.info(o.t("No content to speak"));return}t(23,ye=!0);const j=wl(p.content);if(r.audio.tts.engine===""){let et=[];const pt=setInterval(()=>{var tt,mt,rt;if(et=speechSynthesis.getVoices(),et.length>0){clearInterval(pt);const We=((tt=et==null?void 0:et.filter(_t=>{var cl,dl,hl,ml;return _t.voiceURI===(((dl=(cl=s==null?void 0:s.audio)==null?void 0:cl.tts)==null?void 0:dl.voice)??((ml=(hl=r==null?void 0:r.audio)==null?void 0:hl.tts)==null?void 0:ml.voice))}))==null?void 0:tt.at(0))??void 0,gt=new SpeechSynthesisUtterance(j);gt.rate=((rt=(mt=s.audio)==null?void 0:mt.tts)==null?void 0:rt.playbackRate)??1,gt.onend=()=>{var _t;t(23,ye=!1),s.conversationMode&&((_t=document.getElementById("voice-input-button"))==null||_t.click())},We&&(gt.voice=We),speechSynthesis.speak(gt)}},100)}else{t(24,me=!0);const et=Ur(j,((Ie=(Ce=r==null?void 0:r.audio)==null?void 0:Ce.tts)==null?void 0:Ie.split_on)??"punctuation");if(!et.length){je.info(o.t("No content to speak")),t(23,ye=!1),t(24,me=!1);return}ke=et.reduce((tt,mt,rt)=>(tt[rt]=null,tt),{});let pt=Promise.resolve();if(((st=(Re=s.audio)==null?void 0:Re.tts)==null?void 0:st.engine)==="browser-kokoro"){i||(await pl.set(new ja({dtype:((ht=(Rt=(nt=s.audio)==null?void 0:nt.tts)==null?void 0:Rt.engineConfig)==null?void 0:ht.dtype)??"fp32"})),await i.init());for(const[tt,mt]of et.entries()){const rt=await i.generate({text:mt,voice:((Pe=(It=s==null?void 0:s.audio)==null?void 0:It.tts)==null?void 0:Pe.voice)??((ft=(Ze=r==null?void 0:r.audio)==null?void 0:Ze.tts)==null?void 0:ft.voice)}).catch(We=>{console.error(We),je.error(`${We}`),t(23,ye=!1),t(24,me=!1)});if(rt){const We=new Audio(rt);We.playbackRate=((Pt=(Mt=s.audio)==null?void 0:Mt.tts)==null?void 0:Pt.playbackRate)??1,ke[tt]=We,t(24,me=!1),pt=pt.then(()=>G(tt))}}}else for(const[tt,mt]of et.entries()){const rt=await Fr(localStorage.token,((ll=(tl=s==null?void 0:s.audio)==null?void 0:tl.tts)==null?void 0:ll.defaultVoice)===r.audio.tts.voice?((nl=(sl=s==null?void 0:s.audio)==null?void 0:sl.tts)==null?void 0:nl.voice)??((il=(rl=r==null?void 0:r.audio)==null?void 0:rl.tts)==null?void 0:il.voice):(ol=(al=r==null?void 0:r.audio)==null?void 0:al.tts)==null?void 0:ol.voice,mt).catch(We=>{console.error(We),je.error(`${We}`),t(23,ye=!1),t(24,me=!1)});if(rt){const We=await rt.blob(),gt=URL.createObjectURL(We),_t=new Audio(gt);_t.playbackRate=((ul=(fl=s.audio)==null?void 0:fl.tts)==null?void 0:ul.playbackRate)??1,ke[tt]=_t,t(24,me=!1),pt=pt.then(()=>G(tt))}}}};let be=[];function Ee(j){const Ce=[];let Ie=0;return j=j.replace(/<details[\s\S]*?<\/details>/gi,Re=>(Ce.push(Re),`<details id="__DETAIL_${Ie++}__"/>`)),be=Ce,j}function Me(j){return j.replace(/<details id="__DETAIL_(\d+)__"\/>/g,(Ie,Re)=>be[parseInt(Re)]||"")}const Oe=async()=>{t(16,re=!0),t(20,ge=Ee(p.content)),await Te(),t(21,ie.style.height="",ie),t(21,ie.style.height=`${ie.scrollHeight}px`,ie)},Ue=async()=>{const j=Me(ge||"");N(p.id,{content:j},!1),t(16,re=!1),t(20,ge=""),await Te()},He=async()=>{const j=Me(ge||"");N(p.id,{content:j}),t(16,re=!1),t(20,ge=""),await Te()},se=async()=>{t(16,re=!1),t(20,ge=""),await Te()},Ge=async j=>{t(25,ae=!0);const Ce=await Jr(localStorage.token,j.content).catch(Ie=>{je.error(`${Ie}`)});if(Ce){const Ie=Ce.map(Re=>({type:"image",url:`${Re.url}`}));S(j.id,{...j,files:Ie})}t(25,ae=!1)};let Ke=!1;const Je=async(j=null,Ce=null)=>{var It;t(27,Ke=!0);const Ie={...p,annotation:{...(p==null?void 0:p.annotation)??{},...j!==null?{rating:j}:{},...Ce||{}}},Re=await jr(localStorage.token,g).catch(Pe=>{je.error(`${Pe}`)});if(!Re)return;const st=Gt(h,p.id);let nt={type:"rating",data:{...Ie!=null&&Ie.annotation?Ie.annotation:{},model_id:(p==null?void 0:p.selectedModelId)??p.model,...h.messages[p.parentId].childrenIds.length>1?{sibling_model_ids:h.messages[p.parentId].childrenIds.filter(Pe=>Pe!==p.id).map(Pe=>{var Ze;return((Ze=h.messages[Pe])==null?void 0:Ze.selectedModelId)??h.messages[Pe].model})}:{}},meta:{arena:p?p.arena:!1,model_id:p.model,message_id:p.id,message_index:st.length,chat_id:g},snapshot:{chat:Re}};const Rt=[nt.data.model_id,...nt.data.sibling_model_ids??[]].reduce((Pe,Ze)=>{var Mt;const ft=l.find(Pt=>Pt.id===Ze);return ft?Pe[ft.id]=((Mt=ft==null?void 0:ft.info)==null?void 0:Mt.base_model_id)??null:console.warn(`Model with ID ${Ze} not found`),Pe},{});nt.meta.base_models=Rt;let ht=null;if(p!=null&&p.feedbackId?ht=await Il(localStorage.token,p.feedbackId,nt).catch(Pe=>{je.error(`${Pe}`)}):(ht=await Wr(localStorage.token,nt).catch(Pe=>{je.error(`${Pe}`)}),ht&&(Ie.feedbackId=ht.id)),S(p.id,Ie),await Te(),!Ce&&(t(26,A=!0),!((It=Ie.annotation)!=null&&It.tags))){const Pe=await qr(localStorage.token,p.model,st,g).catch(Ze=>(console.error(Ze),[]));Pe&&(Ie.annotation.tags=Pe,nt.data.tags=Pe,S(p.id,Ie),await Il(localStorage.token,Ie.feedbackId,nt).catch(Ze=>{je.error(`${Ze}`)}))}t(27,Ke=!1)},xe=async()=>{F(p.id)};yt(async()=>{await Te(),ue&&ue.addEventListener("wheel",function(j){ue.scrollWidth<=ue.clientWidth||(j.preventDefault(),j.deltaY!==0&&t(17,ue.scrollLeft+=j.deltaY,ue))})});function at(j){we=j,t(18,we)}const ct=()=>{xe()};function dt(j){ze[j?"unshift":"push"](()=>{ie=j,t(21,ie)})}function ot(){ge=this.value,t(20,ge)}const Ct=j=>{var Re,st;j.key==="Escape"&&((Re=document.getElementById("close-edit-message-button"))==null||Re.click());const Ce=j.metaKey||j.ctrlKey,Ie=j.key==="Enter";Ce&&Ie&&((st=document.getElementById("confirm-edit-message-button"))==null||st.click())},St=()=>{He()},Bt=()=>{se()},Ot=()=>{Ue()},Yn=async j=>{},$n=async(j,Ce)=>{let Ie=document.getElementById(`source-${p.id}-${Ce}`);const Re=document.getElementById(`collapsible-${p.id}`);Ie?Ie.click():Re&&(Re.querySelector("div:first-child").dispatchEvent(new PointerEvent("pointerup",{})),await new Promise(st=>{requestAnimationFrame(()=>{requestAnimationFrame(st)})}),Ie=document.getElementById(`source-${p.id}-${Ce}`),Ie&&Ie.click())},xn=({modelId:j,parentId:Ce,messages:Ie})=>{U({modelId:j,parentId:Ce,messages:Ie})},er=({raw:j,oldContent:Ce,newContent:Ie})=>{t(0,h.messages[p.id].content=h.messages[p.id].content.replace(j,j.replace(Ce,Ie)),h),I()},tr=()=>{O(p)},lr=j=>{L(p,j.target.value-1),t(22,de=!1)},sr=j=>{j.key==="Enter"&&(L(p,j.target.value-1),t(22,de=!1))},nr=async()=>{t(22,de=!0),await Te();const j=document.getElementById(`message-index-input-${p.id}`);j&&(j.focus(),j.select())},rr=()=>{P(p)},ir=()=>{Oe()},ar=()=>{K(p.content)},or=()=>{me||oe()},fr=()=>{ae||Ge(p)},ur=()=>{},cr=async()=>{await Je(1),window.setTimeout(()=>{var j;(j=document.getElementById(`message-feedback-${p.id}`))==null||j.scrollIntoView()},0)},dr=async()=>{await Je(-1),window.setTimeout(()=>{var j;(j=document.getElementById(`message-feedback-${p.id}`))==null||j.scrollIntoView()},0)},hr=()=>{Q()},mr=()=>{t(26,A=!1),_e(p),((X==null?void 0:X.actions)??[]).forEach(j=>{c("action",{id:j.id,event:{id:"regenerate-response",data:{messageId:p.id}}})})},gr=()=>{t(18,we=!0)},_r=j=>{B(j.id,p)};function br(j){ze[j?"unshift":"push"](()=>{ue=j,t(17,ue)})}function pr(j){p=j,t(15,p),t(0,h),t(45,_)}function vr(j){A=j,t(26,A)}const kr=async j=>{await Je(null,{...j.detail})},wr=j=>{(s==null?void 0:s.insertFollowUpPrompt)??!1?V(j):R(p==null?void 0:p.id,j)};return n.$$set=j=>{"chatId"in j&&t(44,g=j.chatId),"history"in j&&t(0,h=j.history),"messageId"in j&&t(45,_=j.messageId),"selectedModels"in j&&t(1,T=j.selectedModels),"siblings"in j&&t(2,D=j.siblings),"setInputText"in j&&t(3,V=j.setInputText),"gotoMessage"in j&&t(4,L=j.gotoMessage),"showPreviousMessage"in j&&t(5,O=j.showPreviousMessage),"showNextMessage"in j&&t(6,P=j.showNextMessage),"updateChat"in j&&t(7,I=j.updateChat),"editMessage"in j&&t(46,N=j.editMessage),"saveMessage"in j&&t(47,S=j.saveMessage),"rateMessage"in j&&t(48,C=j.rateMessage),"actionMessage"in j&&t(8,B=j.actionMessage),"deleteMessage"in j&&t(49,F=j.deleteMessage),"submitMessage"in j&&t(9,R=j.submitMessage),"continueResponse"in j&&t(10,Q=j.continueResponse),"regenerateResponse"in j&&t(11,_e=j.regenerateResponse),"addMessages"in j&&t(12,U=j.addMessages),"isLastMessage"in j&&t(13,ne=j.isLastMessage),"readOnly"in j&&t(14,fe=j.readOnly)},n.$$.update=()=>{n.$$.dirty[0]&32769|n.$$.dirty[1]&16384&&h.messages&&JSON.stringify(p)!==JSON.stringify(h.messages[_])&&t(15,p=JSON.parse(JSON.stringify(h.messages[_]))),n.$$.dirty[0]&32768|n.$$.dirty[1]&524288&&t(19,X=l.find(j=>j.id===p.model)),n.$$.dirty[0]&65536&&(re||(async()=>await Te())())},[h,T,D,V,L,O,P,I,B,R,Q,_e,U,ne,fe,p,re,ue,we,X,ge,ie,de,ye,me,ae,A,Ke,s,r,o,a,f,u,c,K,oe,Oe,Ue,He,se,Ge,Je,xe,g,_,N,S,C,F,l,at,ct,dt,ot,Ct,St,Bt,Ot,Yn,$n,xn,er,tr,lr,sr,nr,rr,ir,ar,or,fr,ur,cr,dr,hr,mr,gr,_r,br,pr,vr,kr,wr]}class Xn extends Ae{constructor(e){super(),Le(this,e,Lo,Ro,Se,{chatId:44,history:0,messageId:45,selectedModels:1,siblings:2,setInputText:3,gotoMessage:4,showPreviousMessage:5,showNextMessage:6,updateChat:7,editMessage:46,saveMessage:47,rateMessage:48,actionMessage:8,deleteMessage:49,submitMessage:9,continueResponse:10,regenerateResponse:11,addMessages:12,isLastMessage:13,readOnly:14},null,[-1,-1,-1,-1])}}function jo(n){let e,t;return{c(){e=pe("svg"),t=pe("path"),this.h()},l(l){e=ve(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=ve(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(m),s.forEach(m),this.h()},h(){d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"d","M8 8v8m0-8a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm0 8a2 2 0 1 0 0 4 2 2 0 0 0 0-4Zm6-2a2 2 0 1 1 4 0 2 2 0 0 1-4 0Zm0 0h-1a5 5 0 0 1-5-5v-.5"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"fill","none"),d(e,"viewBox","0 0 24 24"),d(e,"stroke-width",n[1]),d(e,"stroke","currentColor"),d(e,"class",n[0])},m(l,s){E(l,e,s),b(e,t)},p(l,[s]){s&2&&d(e,"stroke-width",l[1]),s&1&&d(e,"class",l[0])},i:De,o:De,d(l){l&&m(e)}}}function Ho(n,e,t){let{className:l="w-4 h-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,l=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[l,s]}class zo extends Ae{constructor(e){super(),Le(this,e,Ho,jo,Se,{className:0,strokeWidth:1})}}function Ft(n){var l;const e=n.slice(),t=(l=e[0].messages[e[2]])==null?void 0:l.merged;return e[17]=t,e}function Qs(n,e,t){const l=n.slice();return l[41]=e[t],l}function Jt(n){const e=n.slice(),t=e[20][e[41]].messageIds[e[21][e[41]]];return e[44]=t,e}function Xs(n){let e,t,l,s,r,i=Ve(Object.keys(n[20])),o=[];for(let u=0;u<i.length;u+=1)o[u]=en(Qs(n,i,u));const a=u=>M(o[u],1,1,()=>{o[u]=null});let f=!n[5]&&tn(n);return{c(){e=w("div"),t=w("div");for(let u=0;u<o.length;u+=1)o[u].c();s=H(),f&&f.c(),this.h()},l(u){e=y(u,"DIV",{});var c=k(e);t=y(c,"DIV",{class:!0,id:!0});var g=k(t);for(let h=0;h<o.length;h+=1)o[h].l(g);g.forEach(m),s=z(c),f&&f.l(c),c.forEach(m),this.h()},h(){d(t,"class","flex snap-x snap-mandatory overflow-x-auto scrollbar-hidden"),d(t,"id",l="responses-container-"+n[1]+"-"+n[19].id)},m(u,c){E(u,e,c),b(e,t);for(let g=0;g<o.length;g+=1)o[g]&&o[g].m(t,null);b(e,s),f&&f.m(e,null),r=!0},p(u,c){if(c[0]&242483183){i=Ve(Object.keys(u[20]));let g;for(g=0;g<i.length;g+=1){const h=Qs(u,i,g);o[g]?(o[g].p(h,c),v(o[g],1)):(o[g]=en(h),o[g].c(),v(o[g],1),o[g].m(t,null))}for(te(),g=i.length;g<o.length;g+=1)a(g);le()}(!r||c[0]&524290&&l!==(l="responses-container-"+u[1]+"-"+u[19].id))&&d(t,"id",l),u[5]?f&&(te(),M(f,1,1,()=>{f=null}),le()):f?(f.p(u,c),c[0]&32&&v(f,1)):(f=tn(u),f.c(),v(f,1),f.m(e,null))},i(u){if(!r){for(let c=0;c<i.length;c+=1)v(o[c]);v(f),r=!0}},o(u){o=o.filter(Boolean);for(let c=0;c<o.length;c+=1)M(o[c]);M(f),r=!1},d(u){u&&m(e),qe(o,u),f&&f.d()}}}function Ys(n){let e,t=n[0].currentId,l,s,r,i,o,a=xs(n);function f(){return n[36](n[44])}return{c(){e=w("div"),a.c(),l=H(),this.h()},l(u){e=y(u,"DIV",{class:!0});var c=k(e);a.l(c),l=z(c),c.forEach(m),this.h()},h(){var u;d(e,"class",s="snap-center w-full max-w-full m-1 border "+(((u=n[0].messages[n[2]])==null?void 0:u.modelIdx)==n[41]?`bg-gray-50 dark:bg-gray-850 border-gray-100 dark:border-gray-800 border-2 ${n[22]?"min-w-full":"min-w-80"}`:`border-gray-100 dark:border-gray-850 border-dashed ${n[22]?"min-w-full":"min-w-80"}`)+" transition-all p-5 rounded-2xl")},m(u,c){E(u,e,c),a.m(e,null),b(e,l),r=!0,i||(o=he(e,"click",f),i=!0)},p(u,c){var g;n=u,c[0]&1&&Se(t,t=n[0].currentId)?(te(),M(a,1,1,De),le(),a=xs(n),a.c(),v(a,1),a.m(e,l)):a.p(n,c),(!r||c[0]&5242885&&s!==(s="snap-center w-full max-w-full m-1 border "+(((g=n[0].messages[n[2]])==null?void 0:g.modelIdx)==n[41]?`bg-gray-50 dark:bg-gray-850 border-gray-100 dark:border-gray-800 border-2 ${n[22]?"min-w-full":"min-w-80"}`:`border-gray-100 dark:border-gray-850 border-dashed ${n[22]?"min-w-full":"min-w-80"}`)+" transition-all p-5 rounded-2xl"))&&d(e,"class",s)},i(u){r||(v(a),r=!0)},o(u){M(a),r=!1},d(u){u&&m(e),a.d(u),i=!1,o()}}}function $s(n){let e,t;function l(...o){return n[32](n[41],...o)}function s(){return n[33](n[41])}function r(){return n[34](n[41])}function i(...o){return n[35](n[41],...o)}return e=new Xn({props:{chatId:n[1],history:n[0],messageId:n[44],selectedModels:n[3],isLastMessage:!0,siblings:n[20][n[41]].messageIds,gotoMessage:l,showPreviousMessage:s,showNextMessage:r,setInputText:n[6],updateChat:n[7],editMessage:n[8],saveMessage:n[9],rateMessage:n[10],deleteMessage:n[13],actionMessage:n[11],submitMessage:n[12],continueResponse:n[14],regenerateResponse:i,addMessages:n[16],readOnly:n[5]}}),{c(){Y(e.$$.fragment)},l(o){$(e.$$.fragment,o)},m(o,a){x(e,o,a),t=!0},p(o,a){n=o;const f={};a[0]&2&&(f.chatId=n[1]),a[0]&1&&(f.history=n[0]),a[0]&3145728&&(f.messageId=n[44]),a[0]&8&&(f.selectedModels=n[3]),a[0]&1048576&&(f.siblings=n[20][n[41]].messageIds),a[0]&1048576&&(f.gotoMessage=l),a[0]&1048576&&(f.showPreviousMessage=s),a[0]&1048576&&(f.showNextMessage=r),a[0]&64&&(f.setInputText=n[6]),a[0]&128&&(f.updateChat=n[7]),a[0]&256&&(f.editMessage=n[8]),a[0]&512&&(f.saveMessage=n[9]),a[0]&1024&&(f.rateMessage=n[10]),a[0]&8192&&(f.deleteMessage=n[13]),a[0]&2048&&(f.actionMessage=n[11]),a[0]&4096&&(f.submitMessage=n[12]),a[0]&16384&&(f.continueResponse=n[14]),a[0]&3178496&&(f.regenerateResponse=i),a[0]&65536&&(f.addMessages=n[16]),a[0]&32&&(f.readOnly=n[5]),e.$set(f)},i(o){t||(v(e.$$.fragment,o),t=!0)},o(o){M(e.$$.fragment,o),t=!1},d(o){ee(e,o)}}}function xs(n){let e,t,l=n[17]&&$s(n);return{c(){l&&l.c(),e=ce()},l(s){l&&l.l(s),e=ce()},m(s,r){l&&l.m(s,r),E(s,e,r),t=!0},p(s,r){s[17]?l?(l.p(s,r),r[0]&131072&&v(l,1)):(l=$s(s),l.c(),v(l,1),l.m(e.parentNode,e)):l&&(te(),M(l,1,1,()=>{l=null}),le())},i(s){t||(v(l),t=!0)},o(s){M(l),t=!1},d(s){s&&m(e),l&&l.d(s)}}}function en(n){let e,t,l=n[21][n[41]]!==void 0&&n[20][n[41]].messageIds.length>0&&Ys(Jt(n));return{c(){l&&l.c(),e=ce()},l(s){l&&l.l(s),e=ce()},m(s,r){l&&l.m(s,r),E(s,e,r),t=!0},p(s,r){s[21][s[41]]!==void 0&&s[20][s[41]].messageIds.length>0?l?(l.p(Jt(s),r),r[0]&3145728&&v(l,1)):(l=Ys(Jt(s)),l.c(),v(l,1),l.m(e.parentNode,e)):l&&(te(),M(l,1,1,()=>{l=null}),le())},i(s){t||(v(l),t=!0)},o(s){M(l),t=!1},d(s){s&&m(e),l&&l.d(s)}}}function tn(n){let e=!Object.keys(n[20]).find(n[31]),t,l,s=e&&ln(n);return{c(){s&&s.c(),t=ce()},l(r){s&&s.l(r),t=ce()},m(r,i){s&&s.m(r,i),E(r,t,i),l=!0},p(r,i){i[0]&3145729&&(e=!Object.keys(r[20]).find(r[31])),e?s?(s.p(r,i),i[0]&3145729&&v(s,1)):(s=ln(r),s.c(),v(s,1),s.m(t.parentNode,t)):s&&(te(),M(s,1,1,()=>{s=null}),le())},i(r){l||(v(s),l=!0)},o(r){M(s),l=!1},d(r){r&&m(t),s&&s.d(r)}}}function ln(n){var o,a;let e,t,l,s,r=((a=(o=n[0].messages[n[2]])==null?void 0:o.merged)==null?void 0:a.status)&&sn(Ft(n)),i=n[4]&&rn(n);return{c(){e=w("div"),t=w("div"),r&&r.c(),l=H(),i&&i.c(),this.h()},l(f){e=y(f,"DIV",{class:!0});var u=k(e);t=y(u,"DIV",{class:!0});var c=k(t);r&&r.l(c),c.forEach(m),l=z(u),i&&i.l(u),u.forEach(m),this.h()},h(){d(t,"class","w-full"),d(e,"class","flex justify-end")},m(f,u){E(f,e,u),b(e,t),r&&r.m(t,null),b(e,l),i&&i.m(e,null),s=!0},p(f,u){var c,g;(g=(c=f[0].messages[f[2]])==null?void 0:c.merged)!=null&&g.status?r?(r.p(Ft(f),u),u[0]&5&&v(r,1)):(r=sn(Ft(f)),r.c(),v(r,1),r.m(t,null)):r&&(te(),M(r,1,1,()=>{r=null}),le()),f[4]?i?(i.p(f,u),u[0]&16&&v(i,1)):(i=rn(f),i.c(),v(i,1),i.m(e,null)):i&&(te(),M(i,1,1,()=>{i=null}),le())},i(f){s||(v(r),v(i),s=!0)},o(f){M(r),M(i),s=!1},d(f){f&&m(e),r&&r.d(),i&&i.d()}}}function sn(n){let e,t,l,s,r,i,o;t=new Qt({props:{$$slots:{default:[Uo]},$$scope:{ctx:n}}});const a=[qo,Wo],f=[];function u(c,g){var h;return(((h=c[17])==null?void 0:h.content)??"")===""?0:1}return r=u(n),i=f[r]=a[r](n),{c(){e=w("div"),Y(t.$$.fragment),l=H(),s=w("div"),i.c(),this.h()},l(c){e=y(c,"DIV",{class:!0});var g=k(e);$(t.$$.fragment,g),l=z(g),s=y(g,"DIV",{class:!0});var h=k(s);i.l(h),h.forEach(m),g.forEach(m),this.h()},h(){d(s,"class","mt-1 markdown-prose w-full min-w-full"),d(e,"class","w-full rounded-xl pl-5 pr-2 py-2")},m(c,g){E(c,e,g),x(t,e,null),b(e,l),b(e,s),f[r].m(s,null),o=!0},p(c,g){const h={};g[0]&8388613|g[1]&16384&&(h.$$scope={dirty:g,ctx:c}),t.$set(h);let _=r;r=u(c),r===_?f[r].p(c,g):(te(),M(f[_],1,1,()=>{f[_]=null}),le(),i=f[r],i?i.p(c,g):(i=f[r]=a[r](c),i.c()),v(i,1),i.m(s,null))},i(c){o||(v(t.$$.fragment,c),v(i),o=!0)},o(c){M(t.$$.fragment,c),M(i),o=!1},d(c){c&&m(e),ee(t),f[r].d()}}}function nn(n){let e,t=it(n[17].timestamp*1e3).format("LT")+"",l;return{c(){e=w("span"),l=W(t),this.h()},l(s){e=y(s,"SPAN",{class:!0});var r=k(e);l=q(r,t),r.forEach(m),this.h()},h(){d(e,"class","self-center invisible group-hover:visible text-gray-400 text-xs font-medium uppercase ml-0.5 -mt-0.5")},m(s,r){E(s,e,r),b(e,l)},p(s,r){r[0]&5&&t!==(t=it(s[17].timestamp*1e3).format("LT")+"")&&Z(l,t)},d(s){s&&m(e)}}}function Uo(n){let e=n[23].t("Merged Response")+"",t,l,s,r=n[17].timestamp&&nn(n);return{c(){t=W(e),l=H(),r&&r.c(),s=ce()},l(i){t=q(i,e),l=z(i),r&&r.l(i),s=ce()},m(i,o){E(i,t,o),E(i,l,o),r&&r.m(i,o),E(i,s,o)},p(i,o){o[0]&8388608&&e!==(e=i[23].t("Merged Response")+"")&&Z(t,e),i[17].timestamp?r?r.p(i,o):(r=nn(i),r.c(),r.m(s.parentNode,s)):r&&(r.d(1),r=null)},d(i){i&&(m(t),m(l),m(s)),r&&r.d(i)}}}function Wo(n){let e,t;return e=new Tt({props:{id:"merged",content:n[17].content??""}}),{c(){Y(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},p(l,s){const r={};s[0]&5&&(r.content=l[17].content??""),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function qo(n){let e,t;return e=new Xt({}),{c(){Y(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},p:De,i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function rn(n){let e,t,l;return t=new Be({props:{content:n[23].t("Merge Responses"),placement:"bottom",$$slots:{default:[Fo]},$$scope:{ctx:n}}}),{c(){e=w("div"),Y(t.$$.fragment),this.h()},l(s){e=y(s,"DIV",{class:!0});var r=k(e);$(t.$$.fragment,r),r.forEach(m),this.h()},h(){d(e,"class","shrink-0 text-gray-600 dark:text-gray-500 mt-1")},m(s,r){E(s,e,r),x(t,e,null),l=!0},p(s,r){const i={};r[0]&8388608&&(i.content=s[23].t("Merge Responses")),r[1]&16384&&(i.$$scope={dirty:r,ctx:s}),t.$set(i)},i(s){l||(v(t.$$.fragment,s),l=!0)},o(s){M(t.$$.fragment,s),l=!1},d(s){s&&m(e),ee(t)}}}function Fo(n){let e,t,l,s,r;return t=new zo({props:{className:" size-5 "}}),{c(){e=w("button"),Y(t.$$.fragment),this.h()},l(i){e=y(i,"BUTTON",{type:!0,id:!0,class:!0});var o=k(e);$(t.$$.fragment,o),o.forEach(m),this.h()},h(){d(e,"type","button"),d(e,"id","merge-response-button"),d(e,"class","visible p-1 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(i,o){E(i,e,o),x(t,e,null),l=!0,s||(r=he(e,"click",n[37]),s=!0)},p:De,i(i){l||(v(t.$$.fragment,i),l=!0)},o(i){M(t.$$.fragment,i),l=!1},d(i){i&&m(e),ee(t),s=!1,r()}}}function Jo(n){let e,t,l=n[19]&&Xs(n);return{c(){l&&l.c(),e=ce()},l(s){l&&l.l(s),e=ce()},m(s,r){l&&l.m(s,r),E(s,e,r),t=!0},p(s,r){s[19]?l?(l.p(s,r),r[0]&524288&&v(l,1)):(l=Xs(s),l.c(),v(l,1),l.m(e.parentNode,e)):l&&(te(),M(l,1,1,()=>{l=null}),le())},i(s){t||(v(l),t=!0)},o(s){M(l),t=!1},d(s){s&&m(e),l&&l.d(s)}}}function Go(n,e,t){let l,s,r;Ne(n,bt,J=>t(38,l=J)),Ne(n,zn,J=>t(22,s=J));const i=Fe("i18n");Ne(n,i,J=>t(23,r=J)),it.extend(qn);let{chatId:o}=e,{history:a}=e,{messageId:f}=e,{selectedModels:u=[]}=e,{isLastMessage:c}=e,{readOnly:g=!1}=e,{setInputText:h=()=>{}}=e,{updateChat:_}=e,{editMessage:T}=e,{saveMessage:p}=e,{rateMessage:D}=e,{actionMessage:V}=e,{submitMessage:L}=e,{deleteMessage:O}=e,{continueResponse:P}=e,{regenerateResponse:I}=e,{mergeResponses:N}=e,{addMessages:S}=e,{triggerScroll:C}=e;Vt();let B,F,R={},Q={},_e=JSON.parse(JSON.stringify(a.messages[f]));const U=async(J,me)=>{t(21,Q[J]=Math.max(0,Math.min(me,R[J].messageIds.length-1)),Q);let ae=R[J].messageIds[Q[J]],A=a.messages[ae].childrenIds;for(;A.length!==0;)ae=A.at(-1),A=a.messages[ae].childrenIds;t(0,a.currentId=ae,a),await Te(),await _(),C()},ne=async J=>{t(21,Q[J]=Math.max(0,Q[J]-1),Q);let me=R[J].messageIds[Q[J]],ae=a.messages[me].childrenIds;for(;ae.length!==0;)me=ae.at(-1),ae=a.messages[me].childrenIds;t(0,a.currentId=me,a),await Te(),await _(),C()},fe=async J=>{t(21,Q[J]=Math.min(R[J].messageIds.length-1,Q[J]+1),Q);let me=R[J].messageIds[Q[J]],ae=a.messages[me].childrenIds;for(;ae.length!==0;)me=ae.at(-1),ae=a.messages[me].childrenIds;t(0,a.currentId=me,a),await Te(),await _(),C()},ue=async()=>{await Te(),t(18,B=f),t(19,F=a.messages[f].parentId?a.messages[a.messages[f].parentId]:null),t(20,R=F==null?void 0:F.models.reduce((J,me,ae)=>{let A=F==null?void 0:F.childrenIds.map(K=>a.messages[K]).filter(K=>(K==null?void 0:K.modelIdx)===ae).map(K=>K.id);if(A.length===0){let K=F==null?void 0:F.childrenIds.map(G=>a.messages[G]).filter(G=>(G==null?void 0:G.model)===me);K.forEach(G=>{G.modelIdx=ae}),A=K.map(G=>G.id)}return{...J,[ae]:{messageIds:A}}},{})),t(21,Q=F==null?void 0:F.models.reduce((J,me,ae)=>{const A=R[ae].messageIds.findIndex(K=>K===f);return A!==-1?{...J,[ae]:A}:{...J,[ae]:R[ae].messageIds.length-1}},{})),await Te()},we=async()=>{const J=Object.keys(R).map(me=>{const{messageIds:ae}=R[me],A=ae[Q[me]];return a.messages[A].content});N(f,J,o)};yt(async()=>{if(await ue(),await Te(),(l==null?void 0:l.scrollOnBranchChange)??!0){const J=document.getElementById(`message-${f}`);J&&J.scrollIntoView({block:"start"})}});const X=J=>{var A;const{messageIds:me}=R[J],ae=me[Q[J]];return!((A=a.messages[ae])!=null&&A.done)},re=(J,me,ae)=>U(J,ae),ge=J=>ne(J),ie=J=>fe(J),de=async(J,me)=>{I(me),await Te(),t(21,Q[J]=R[J].messageIds.length-1,Q)},ke=async J=>{if(f!=J){let me=J,ae=a.messages[me].childrenIds;for(;ae.length!==0;)me=ae.at(-1),ae=a.messages[me].childrenIds;t(0,a.currentId=me,a)}},ye=()=>{we()};return n.$$set=J=>{"chatId"in J&&t(1,o=J.chatId),"history"in J&&t(0,a=J.history),"messageId"in J&&t(2,f=J.messageId),"selectedModels"in J&&t(3,u=J.selectedModels),"isLastMessage"in J&&t(4,c=J.isLastMessage),"readOnly"in J&&t(5,g=J.readOnly),"setInputText"in J&&t(6,h=J.setInputText),"updateChat"in J&&t(7,_=J.updateChat),"editMessage"in J&&t(8,T=J.editMessage),"saveMessage"in J&&t(9,p=J.saveMessage),"rateMessage"in J&&t(10,D=J.rateMessage),"actionMessage"in J&&t(11,V=J.actionMessage),"submitMessage"in J&&t(12,L=J.submitMessage),"deleteMessage"in J&&t(13,O=J.deleteMessage),"continueResponse"in J&&t(14,P=J.continueResponse),"regenerateResponse"in J&&t(15,I=J.regenerateResponse),"mergeResponses"in J&&t(29,N=J.mergeResponses),"addMessages"in J&&t(16,S=J.addMessages),"triggerScroll"in J&&t(30,C=J.triggerScroll)},n.$$.update=()=>{n.$$.dirty[0]&131077&&a.messages&&JSON.stringify(_e)!==JSON.stringify(a.messages[f])&&t(17,_e=JSON.parse(JSON.stringify(a.messages[f])))},[a,o,f,u,c,g,h,_,T,p,D,V,L,O,P,I,S,_e,B,F,R,Q,s,r,i,U,ne,fe,we,N,C,X,re,ge,ie,de,ke,ye]}class Ko extends Ae{constructor(e){super(),Le(this,e,Go,Jo,Se,{chatId:1,history:0,messageId:2,selectedModels:3,isLastMessage:4,readOnly:5,setInputText:6,updateChat:7,editMessage:8,saveMessage:9,rateMessage:10,actionMessage:11,submitMessage:12,deleteMessage:13,continueResponse:14,regenerateResponse:15,mergeResponses:29,addMessages:16,triggerScroll:30},null,[-1,-1])}}function an(n,e,t){const l=n.slice();return l[53]=e[t],l[55]=t,l}function on(n,e,t){const l=n.slice();return l[53]=e[t],l}function fn(n){var s,r,i,o;let e,t,l;return t=new Fn({props:{src:n[7].user?((i=(r=(s=n[16].find(n[30]))==null?void 0:s.info)==null?void 0:r.meta)==null?void 0:i.profile_image_url)??`${Qe}/user.png`:((o=n[0])==null?void 0:o.profile_image_url)??`${Qe}/user.png`,className:"size-8 user-message-profile-image"}}),{c(){e=w("div"),Y(t.$$.fragment),this.h()},l(a){e=y(a,"DIV",{class:!0});var f=k(e);$(t.$$.fragment,f),f.forEach(m),this.h()},h(){d(e,"class","shrink-0 ltr:mr-3 rtl:ml-3 mt-1")},m(a,f){E(a,e,f),x(t,e,null),l=!0},p(a,f){var c,g,h,_;const u={};f[0]&65665&&(u.src=a[7].user?((h=(g=(c=a[16].find(a[30]))==null?void 0:c.info)==null?void 0:g.meta)==null?void 0:h.profile_image_url)??`${Qe}/user.png`:((_=a[0])==null?void 0:_.profile_image_url)??`${Qe}/user.png`),t.$set(u)},i(a){l||(v(t.$$.fragment,a),l=!0)},o(a){M(t.$$.fragment,a),l=!1},d(a){a&&m(e),ee(t)}}}function Zo(n){let e,t,l,s;return l=new Be({props:{content:it(n[7].timestamp*1e3).format("LLLL"),$$slots:{default:[Xo]},$$scope:{ctx:n}}}),{c(){e=w("div"),t=w("div"),Y(l.$$.fragment),this.h()},l(r){e=y(r,"DIV",{class:!0});var i=k(e);t=y(i,"DIV",{class:!0});var o=k(t);$(l.$$.fragment,o),o.forEach(m),i.forEach(m),this.h()},h(){d(t,"class","text-[0.65rem] invisible group-hover:visible text-gray-400 font-medium first-letter:capitalize mb-0.5"),d(e,"class","flex justify-end pr-2 text-xs")},m(r,i){E(r,e,i),b(e,t),x(l,t,null),s=!0},p(r,i){const o={};i[0]&128&&(o.content=it(r[7].timestamp*1e3).format("LLLL")),i[0]&128|i[1]&134217728&&(o.$$scope={dirty:i,ctx:r}),l.$set(o)},i(r){s||(v(l.$$.fragment,r),s=!0)},o(r){M(l.$$.fragment,r),s=!1},d(r){r&&m(e),ee(l)}}}function Qo(n){let e,t,l;return t=new Qt({props:{$$slots:{default:[tf]},$$scope:{ctx:n}}}),{c(){e=w("div"),Y(t.$$.fragment)},l(s){e=y(s,"DIV",{});var r=k(e);$(t.$$.fragment,r),r.forEach(m)},m(s,r){E(s,e,r),x(t,e,null),l=!0},p(s,r){const i={};r[0]&180353|r[1]&134217728&&(i.$$scope={dirty:r,ctx:s}),t.$set(i)},i(s){l||(v(t.$$.fragment,s),l=!0)},o(s){M(t.$$.fragment,s),l=!1},d(s){s&&m(e),ee(t)}}}function Xo(n){let e,t=wt(n[7].timestamp*1e3)+"",l;return{c(){e=w("span"),l=W(t),this.h()},l(s){e=y(s,"SPAN",{class:!0});var r=k(e);l=q(r,t),r.forEach(m),this.h()},h(){d(e,"class","line-clamp-1")},m(s,r){E(s,e,r),b(e,l)},p(s,r){r[0]&128&&t!==(t=wt(s[7].timestamp*1e3)+"")&&Z(l,t)},d(s){s&&m(e)}}}function Yo(n){let e=n[14].t("You")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){E(l,t,s)},p(l,s){s[0]&16384&&e!==(e=l[14].t("You")+"")&&Z(t,e)},d(l){l&&m(t)}}}function $o(n){let e=n[0].name+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){E(l,t,s)},p(l,s){s[0]&1&&e!==(e=l[0].name+"")&&Z(t,e)},d(l){l&&m(t)}}}function xo(n){var o;let e=n[14].t("You")+"",t,l,s,r=(((o=n[7])==null?void 0:o.user)??"")+"",i;return{c(){t=W(e),l=H(),s=w("span"),i=W(r),this.h()},l(a){t=q(a,e),l=z(a),s=y(a,"SPAN",{class:!0});var f=k(s);i=q(f,r),f.forEach(m),this.h()},h(){d(s,"class","text-gray-500 text-sm font-medium")},m(a,f){E(a,t,f),E(a,l,f),E(a,s,f),b(s,i)},p(a,f){var u;f[0]&16384&&e!==(e=a[14].t("You")+"")&&Z(t,e),f[0]&128&&r!==(r=(((u=a[7])==null?void 0:u.user)??"")+"")&&Z(i,r)},d(a){a&&(m(t),m(l),m(s))}}}function un(n){let e,t,l;return t=new Be({props:{content:it(n[7].timestamp*1e3).format("LLLL"),$$slots:{default:[ef]},$$scope:{ctx:n}}}),{c(){e=w("div"),Y(t.$$.fragment),this.h()},l(s){e=y(s,"DIV",{class:!0});var r=k(e);$(t.$$.fragment,r),r.forEach(m),this.h()},h(){d(e,"class","self-center text-xs invisible group-hover:visible text-gray-400 font-medium first-letter:capitalize ml-0.5 translate-y-[1px]")},m(s,r){E(s,e,r),x(t,e,null),l=!0},p(s,r){const i={};r[0]&128&&(i.content=it(s[7].timestamp*1e3).format("LLLL")),r[0]&128|r[1]&134217728&&(i.$$scope={dirty:r,ctx:s}),t.$set(i)},i(s){l||(v(t.$$.fragment,s),l=!0)},o(s){M(t.$$.fragment,s),l=!1},d(s){s&&m(e),ee(t)}}}function ef(n){let e,t=wt(n[7].timestamp*1e3)+"",l;return{c(){e=w("span"),l=W(t),this.h()},l(s){e=y(s,"SPAN",{class:!0});var r=k(e);l=q(r,t),r.forEach(m),this.h()},h(){d(e,"class","line-clamp-1")},m(s,r){E(s,e,r),b(e,l)},p(s,r){r[0]&128&&t!==(t=wt(s[7].timestamp*1e3)+"")&&Z(l,t)},d(s){s&&m(e)}}}function tf(n){let e,t,l;function s(a,f){return a[7].user?xo:a[15].showUsername||a[17].name!==a[0].name?$o:Yo}let r=s(n),i=r(n),o=n[7].timestamp&&un(n);return{c(){i.c(),e=H(),o&&o.c(),t=ce()},l(a){i.l(a),e=z(a),o&&o.l(a),t=ce()},m(a,f){i.m(a,f),E(a,e,f),o&&o.m(a,f),E(a,t,f),l=!0},p(a,f){r===(r=s(a))&&i?i.p(a,f):(i.d(1),i=r(a),i&&(i.c(),i.m(e.parentNode,e))),a[7].timestamp?o?(o.p(a,f),f[0]&128&&v(o,1)):(o=un(a),o.c(),v(o,1),o.m(t.parentNode,t)):o&&(te(),M(o,1,1,()=>{o=null}),le())},i(a){l||(v(o),l=!0)},o(a){M(o),l=!1},d(a){a&&(m(e),m(t)),i.d(a),o&&o.d(a)}}}function cn(n){let e,t,l=n[7].files&&dn(n);return{c(){l&&l.c(),e=ce()},l(s){l&&l.l(s),e=ce()},m(s,r){l&&l.m(s,r),E(s,e,r),t=!0},p(s,r){s[7].files?l?(l.p(s,r),r[0]&128&&v(l,1)):(l=dn(s),l.c(),v(l,1),l.m(e.parentNode,e)):l&&(te(),M(l,1,1,()=>{l=null}),le())},i(s){t||(v(l),t=!0)},o(s){M(l),t=!1},d(s){s&&m(e),l&&l.d(s)}}}function dn(n){let e,t,l=Ve(n[7].files),s=[];for(let i=0;i<l.length;i+=1)s[i]=hn(on(n,l,i));const r=i=>M(s[i],1,1,()=>{s[i]=null});return{c(){e=w("div");for(let i=0;i<s.length;i+=1)s[i].c();this.h()},l(i){e=y(i,"DIV",{class:!0});var o=k(e);for(let a=0;a<s.length;a+=1)s[a].l(o);o.forEach(m),this.h()},h(){d(e,"class","mb-1 w-full flex flex-col justify-end overflow-x-auto gap-1 flex-wrap")},m(i,o){E(i,e,o);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);t=!0},p(i,o){if(o[0]&32896){l=Ve(i[7].files);let a;for(a=0;a<l.length;a+=1){const f=on(i,l,a);s[a]?(s[a].p(f,o),v(s[a],1)):(s[a]=hn(f),s[a].c(),v(s[a],1),s[a].m(e,null))}for(te(),a=l.length;a<s.length;a+=1)r(a);le()}},i(i){if(!t){for(let o=0;o<l.length;o+=1)v(s[o]);t=!0}},o(i){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)M(s[o]);t=!1},d(i){i&&m(e),qe(s,i)}}}function lf(n){var l;let e,t;return e=new el({props:{item:n[53],url:n[53].url,name:n[53].name,type:n[53].type,size:(l=n[53])==null?void 0:l.size,colorClassName:"bg-white dark:bg-gray-850 "}}),{c(){Y(e.$$.fragment)},l(s){$(e.$$.fragment,s)},m(s,r){x(e,s,r),t=!0},p(s,r){var o;const i={};r[0]&128&&(i.item=s[53]),r[0]&128&&(i.url=s[53].url),r[0]&128&&(i.name=s[53].name),r[0]&128&&(i.type=s[53].type),r[0]&128&&(i.size=(o=s[53])==null?void 0:o.size),e.$set(i)},i(s){t||(v(e.$$.fragment,s),t=!0)},o(s){M(e.$$.fragment,s),t=!1},d(s){ee(e,s)}}}function sf(n){let e,t;return e=new Yt({props:{src:n[53].url,imageClassName:" max-h-96 rounded-lg"}}),{c(){Y(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},p(l,s){const r={};s[0]&128&&(r.src=l[53].url),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function hn(n){let e,t,l,s,r,i;const o=[sf,lf],a=[];function f(u,c){return u[53].type==="image"?0:1}return t=f(n),l=a[t]=o[t](n),{c(){e=w("div"),l.c(),s=H(),this.h()},l(u){e=y(u,"DIV",{class:!0});var c=k(e);l.l(c),s=z(c),c.forEach(m),this.h()},h(){var u;d(e,"class",r=((u=n[15])==null?void 0:u.chatBubble)??!0?"self-end":"")},m(u,c){E(u,e,c),a[t].m(e,null),b(e,s),i=!0},p(u,c){var h;let g=t;t=f(u),t===g?a[t].p(u,c):(te(),M(a[g],1,1,()=>{a[g]=null}),le(),l=a[t],l?l.p(u,c):(l=a[t]=o[t](u),l.c()),v(l,1),l.m(e,s)),(!i||c[0]&32768&&r!==(r=((h=u[15])==null?void 0:h.chatBubble)??!0?"self-end":""))&&d(e,"class",r)},i(u){i||(v(l),i=!0)},o(u){M(l),i=!1},d(u){u&&m(e),a[t].d()}}}function mn(n){let e,t,l,s;const r=[rf,nf],i=[];function o(a,f){return a[10]===!0?0:1}return e=o(n),t=i[e]=r[e](n),{c(){t.c(),l=ce()},l(a){t.l(a),l=ce()},m(a,f){i[e].m(a,f),E(a,l,f),s=!0},p(a,f){let u=e;e=o(a),e===u?i[e].p(a,f):(te(),M(i[u],1,1,()=>{i[u]=null}),le(),t=i[e],t?t.p(a,f):(t=i[e]=r[e](a),t.c()),v(t,1),t.m(l.parentNode,l))},i(a){s||(v(t),s=!0)},o(a){M(t),s=!1},d(a){a&&m(l),i[e].d(a)}}}function nf(n){var O,P;let e,t,l,s,r,i,o,a,f,u,c,g,h,_,T=n[7].content&&gn(n),p=!(((O=n[15])==null?void 0:O.chatBubble)??!0)&&_n(n),D=!n[6]&&pn(n);u=new Be({props:{content:n[14].t("Copy"),placement:"bottom",$$slots:{default:[uf]},$$scope:{ctx:n}}});let V=!n[6]&&(!n[5]||n[1].length>1)&&vn(n),L=(((P=n[15])==null?void 0:P.chatBubble)??!0)&&kn(n);return{c(){e=w("div"),t=w("div"),l=w("div"),T&&T.c(),i=H(),o=w("div"),p&&p.c(),a=H(),D&&D.c(),f=H(),Y(u.$$.fragment),c=H(),V&&V.c(),g=H(),L&&L.c(),this.h()},l(I){e=y(I,"DIV",{class:!0});var N=k(e);t=y(N,"DIV",{class:!0});var S=k(t);l=y(S,"DIV",{class:!0});var C=k(l);T&&T.l(C),C.forEach(m),S.forEach(m),i=z(N),o=y(N,"DIV",{class:!0});var B=k(o);p&&p.l(B),a=z(B),D&&D.l(B),f=z(B),$(u.$$.fragment,B),c=z(B),V&&V.l(B),g=z(B),L&&L.l(B),B.forEach(m),N.forEach(m),this.h()},h(){var I,N,S;d(l,"class",s="rounded-3xl "+(((I=n[15])==null?void 0:I.chatBubble)??!0?`max-w-[90%] px-5 py-2  bg-gray-50 dark:bg-gray-850 ${n[7].files?"rounded-tr-lg":""}`:" w-full")),d(t,"class",r="flex "+(((N=n[15])==null?void 0:N.chatBubble)??!0?"justify-end pb-1":"w-full")),d(o,"class",h="flex "+(((S=n[15])==null?void 0:S.chatBubble)??!0?"justify-end":"")+" text-gray-600 dark:text-gray-500"),d(e,"class","w-full")},m(I,N){E(I,e,N),b(e,t),b(t,l),T&&T.m(l,null),b(e,i),b(e,o),p&&p.m(o,null),b(o,a),D&&D.m(o,null),b(o,f),x(u,o,null),b(o,c),V&&V.m(o,null),b(o,g),L&&L.m(o,null),_=!0},p(I,N){var C,B,F,R,Q;I[7].content?T?(T.p(I,N),N[0]&128&&v(T,1)):(T=gn(I),T.c(),v(T,1),T.m(l,null)):T&&(te(),M(T,1,1,()=>{T=null}),le()),(!_||N[0]&32896&&s!==(s="rounded-3xl "+(((C=I[15])==null?void 0:C.chatBubble)??!0?`max-w-[90%] px-5 py-2  bg-gray-50 dark:bg-gray-850 ${I[7].files?"rounded-tr-lg":""}`:" w-full")))&&d(l,"class",s),(!_||N[0]&32768&&r!==(r="flex "+(((B=I[15])==null?void 0:B.chatBubble)??!0?"justify-end pb-1":"w-full")))&&d(t,"class",r),((F=I[15])==null?void 0:F.chatBubble)??!0?p&&(p.d(1),p=null):p?p.p(I,N):(p=_n(I),p.c(),p.m(o,a)),I[6]?D&&(te(),M(D,1,1,()=>{D=null}),le()):D?(D.p(I,N),N[0]&64&&v(D,1)):(D=pn(I),D.c(),v(D,1),D.m(o,f));const S={};N[0]&16384&&(S.content=I[14].t("Copy")),N[0]&128|N[1]&134217728&&(S.$$scope={dirty:N,ctx:I}),u.$set(S),!I[6]&&(!I[5]||I[1].length>1)?V?(V.p(I,N),N[0]&98&&v(V,1)):(V=vn(I),V.c(),v(V,1),V.m(o,g)):V&&(te(),M(V,1,1,()=>{V=null}),le()),((R=I[15])==null?void 0:R.chatBubble)??!0?L?L.p(I,N):(L=kn(I),L.c(),L.m(o,null)):L&&(L.d(1),L=null),(!_||N[0]&32768&&h!==(h="flex "+(((Q=I[15])==null?void 0:Q.chatBubble)??!0?"justify-end":"")+" text-gray-600 dark:text-gray-500"))&&d(o,"class",h)},i(I){_||(v(T),v(D),v(u.$$.fragment,I),v(V),_=!0)},o(I){M(T),M(D),M(u.$$.fragment,I),M(V),_=!1},d(I){I&&m(e),T&&T.d(),p&&p.d(),D&&D.d(),ee(u),V&&V.d(),L&&L.d()}}}function rf(n){let e,t,l,s,r,i,o,a,f,u=n[14].t("Save")+"",c,g,h,_,T=n[14].t("Cancel")+"",p,D,V,L=n[14].t("Send")+"",O,P,I,N,S=(n[12]??[]).length>0&&yn(n);return{c(){e=w("div"),S&&S.c(),t=H(),l=w("div"),s=w("textarea"),i=H(),o=w("div"),a=w("div"),f=w("button"),c=W(u),g=H(),h=w("div"),_=w("button"),p=W(T),D=H(),V=w("button"),O=W(L),this.h()},l(C){e=y(C,"DIV",{class:!0});var B=k(e);S&&S.l(B),t=z(B),l=y(B,"DIV",{class:!0});var F=k(l);s=y(F,"TEXTAREA",{id:!0,class:!0}),k(s).forEach(m),F.forEach(m),i=z(B),o=y(B,"DIV",{class:!0});var R=k(o);a=y(R,"DIV",{});var Q=k(a);f=y(Q,"BUTTON",{id:!0,class:!0});var _e=k(f);c=q(_e,u),_e.forEach(m),Q.forEach(m),g=z(R),h=y(R,"DIV",{class:!0});var U=k(h);_=y(U,"BUTTON",{id:!0,class:!0});var ne=k(_);p=q(ne,T),ne.forEach(m),D=z(U),V=y(U,"BUTTON",{id:!0,class:!0});var fe=k(V);O=q(fe,L),fe.forEach(m),U.forEach(m),R.forEach(m),B.forEach(m),this.h()},h(){d(s,"id",r="message-edit-"+n[7].id),d(s,"class","bg-transparent outline-hidden w-full resize-none"),d(l,"class","max-h-96 overflow-auto"),d(f,"id","save-edit-message-button"),d(f,"class","px-4 py-2 bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 border border-gray-100 dark:border-gray-700 text-gray-700 dark:text-gray-200 transition rounded-3xl"),d(_,"id","close-edit-message-button"),d(_,"class","px-4 py-2 bg-white dark:bg-gray-900 hover:bg-gray-100 text-gray-800 dark:text-gray-100 transition rounded-3xl"),d(V,"id","confirm-edit-message-button"),d(V,"class","px-4 py-2 bg-gray-900 dark:bg-white hover:bg-gray-850 text-gray-100 dark:text-gray-800 transition rounded-3xl"),d(h,"class","flex space-x-1.5"),d(o,"class","mt-2 mb-1 flex justify-between text-sm font-medium"),d(e,"class","w-full bg-gray-50 dark:bg-gray-800 rounded-3xl px-5 py-3 mb-2")},m(C,B){E(C,e,B),S&&S.m(e,null),b(e,t),b(e,l),b(l,s),n[34](s),ut(s,n[11]),b(e,i),b(e,o),b(o,a),b(a,f),b(f,c),b(o,g),b(o,h),b(h,_),b(_,p),b(h,D),b(h,V),b(V,O),P=!0,I||(N=[he(s,"input",n[35]),he(s,"input",bf),he(s,"keydown",n[36]),he(f,"click",n[37]),he(_,"click",n[38]),he(V,"click",n[39])],I=!0)},p(C,B){(C[12]??[]).length>0?S?(S.p(C,B),B[0]&4096&&v(S,1)):(S=yn(C),S.c(),v(S,1),S.m(e,t)):S&&(te(),M(S,1,1,()=>{S=null}),le()),(!P||B[0]&128&&r!==(r="message-edit-"+C[7].id))&&d(s,"id",r),B[0]&2048&&ut(s,C[11]),(!P||B[0]&16384)&&u!==(u=C[14].t("Save")+"")&&Z(c,u),(!P||B[0]&16384)&&T!==(T=C[14].t("Cancel")+"")&&Z(p,T),(!P||B[0]&16384)&&L!==(L=C[14].t("Send")+"")&&Z(O,L)},i(C){P||(v(S),P=!0)},o(C){M(S),P=!1},d(C){C&&m(e),S&&S.d(),n[34](null),I=!1,$e(N)}}}function gn(n){let e,t;return e=new Tt({props:{id:n[7].id,content:n[7].content}}),{c(){Y(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},p(l,s){const r={};s[0]&128&&(r.id=l[7].id),s[0]&128&&(r.content=l[7].content),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function _n(n){let e,t=n[1].length>1&&bn(n);return{c(){t&&t.c(),e=ce()},l(l){t&&t.l(l),e=ce()},m(l,s){t&&t.m(l,s),E(l,e,s)},p(l,s){l[1].length>1?t?t.p(l,s):(t=bn(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){l&&m(e),t&&t.d(l)}}}function bn(n){let e,t,l='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg>',s,r,i,o='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path></svg>',a,f;function u(h,_){return h[9]?of:af}let c=u(n),g=c(n);return{c(){e=w("div"),t=w("button"),t.innerHTML=l,s=H(),g.c(),r=H(),i=w("button"),i.innerHTML=o,this.h()},l(h){e=y(h,"DIV",{class:!0,dir:!0});var _=k(e);t=y(_,"BUTTON",{class:!0,"data-svelte-h":!0}),lt(t)!=="svelte-buado9"&&(t.innerHTML=l),s=z(_),g.l(_),r=z(_),i=y(_,"BUTTON",{class:!0,"data-svelte-h":!0}),lt(i)!=="svelte-4phel2"&&(i.innerHTML=o),_.forEach(m),this.h()},h(){d(t,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),d(i,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),d(e,"class","flex self-center"),d(e,"dir","ltr")},m(h,_){E(h,e,_),b(e,t),b(e,s),g.m(e,null),b(e,r),b(e,i),a||(f=[he(t,"click",n[40]),he(i,"click",n[44])],a=!0)},p(h,_){c===(c=u(h))&&g?g.p(h,_):(g.d(1),g=c(h),g&&(g.c(),g.m(e,r)))},d(h){h&&m(e),g.d(),a=!1,$e(f)}}}function af(n){let e,t=n[1].indexOf(n[7].id)+1+"",l,s,r=n[1].length+"",i,o,a;return{c(){e=w("div"),l=W(t),s=W("/"),i=W(r),this.h()},l(f){e=y(f,"DIV",{class:!0});var u=k(e);l=q(u,t),s=q(u,"/"),i=q(u,r),u.forEach(m),this.h()},h(){d(e,"class","text-sm tracking-widest font-semibold self-center dark:text-gray-100 min-w-fit")},m(f,u){E(f,e,u),b(e,l),b(e,s),b(e,i),o||(a=he(e,"dblclick",n[43]),o=!0)},p(f,u){u[0]&130&&t!==(t=f[1].indexOf(f[7].id)+1+"")&&Z(l,t),u[0]&2&&r!==(r=f[1].length+"")&&Z(i,r)},d(f){f&&m(e),o=!1,a()}}}function of(n){let e,t,l,s,r,i,o=n[1].length+"",a,f,u;return{c(){e=w("div"),t=w("input"),i=W("/"),a=W(o),this.h()},l(c){e=y(c,"DIV",{class:!0});var g=k(e);t=y(g,"INPUT",{id:!0,type:!0,min:!0,max:!0,class:!0}),i=q(g,"/"),a=q(g,o),g.forEach(m),this.h()},h(){d(t,"id",l="message-index-input-"+n[7].id),d(t,"type","number"),t.value=s=n[1].indexOf(n[7].id)+1,d(t,"min","1"),d(t,"max",r=n[1].length),d(t,"class","bg-transparent font-semibold self-center dark:text-gray-100 min-w-fit outline-hidden"),d(e,"class","text-sm flex justify-center font-semibold self-center dark:text-gray-100 min-w-fit")},m(c,g){E(c,e,g),b(e,t),b(e,i),b(e,a),f||(u=[he(t,"focus",pf),he(t,"blur",n[41]),he(t,"keydown",n[42])],f=!0)},p(c,g){g[0]&128&&l!==(l="message-index-input-"+c[7].id)&&d(t,"id",l),g[0]&130&&s!==(s=c[1].indexOf(c[7].id)+1)&&t.value!==s&&(t.value=s),g[0]&2&&r!==(r=c[1].length)&&d(t,"max",r),g[0]&2&&o!==(o=c[1].length+"")&&Z(a,o)},d(c){c&&m(e),f=!1,$e(u)}}}function pn(n){let e,t;return e=new Be({props:{content:n[14].t("Edit"),placement:"bottom",$$slots:{default:[ff]},$$scope:{ctx:n}}}),{c(){Y(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},p(l,s){const r={};s[0]&16384&&(r.content=l[14].t("Edit")),s[1]&134217728&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function ff(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.3" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"></path></svg>',l,s;return{c(){e=w("button"),e.innerHTML=t,this.h()},l(r){e=y(r,"BUTTON",{class:!0,"data-svelte-h":!0}),lt(e)!=="svelte-tlrz1q"&&(e.innerHTML=t),this.h()},h(){d(e,"class","invisible group-hover:visible p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition edit-user-message-button")},m(r,i){E(r,e,i),l||(s=he(e,"click",n[45]),l=!0)},p:De,d(r){r&&m(e),l=!1,s()}}}function uf(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.3" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184"></path></svg>',l,s;return{c(){e=w("button"),e.innerHTML=t,this.h()},l(r){e=y(r,"BUTTON",{class:!0,"data-svelte-h":!0}),lt(e)!=="svelte-1ivgdx2"&&(e.innerHTML=t),this.h()},h(){d(e,"class","invisible group-hover:visible p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(r,i){E(r,e,i),l||(s=he(e,"click",n[46]),l=!0)},p:De,d(r){r&&m(e),l=!1,s()}}}function vn(n){let e,t;return e=new Be({props:{content:n[14].t("Delete"),placement:"bottom",$$slots:{default:[cf]},$$scope:{ctx:n}}}),{c(){Y(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},p(l,s){const r={};s[0]&16384&&(r.content=l[14].t("Delete")),s[0]&256|s[1]&134217728&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function cf(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"></path></svg>',l,s;return{c(){e=w("button"),e.innerHTML=t,this.h()},l(r){e=y(r,"BUTTON",{class:!0,"data-svelte-h":!0}),lt(e)!=="svelte-146x2zz"&&(e.innerHTML=t),this.h()},h(){d(e,"class","invisible group-hover:visible p-1 rounded-sm dark:hover:text-white hover:text-black transition")},m(r,i){E(r,e,i),l||(s=he(e,"click",n[47]),l=!0)},p:De,d(r){r&&m(e),l=!1,s()}}}function kn(n){let e,t=n[1].length>1&&wn(n);return{c(){t&&t.c(),e=ce()},l(l){t&&t.l(l),e=ce()},m(l,s){t&&t.m(l,s),E(l,e,s)},p(l,s){l[1].length>1?t?t.p(l,s):(t=wn(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){l&&m(e),t&&t.d(l)}}}function wn(n){let e,t,l='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg>',s,r,i,o='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path></svg>',a,f;function u(h,_){return h[9]?hf:df}let c=u(n),g=c(n);return{c(){e=w("div"),t=w("button"),t.innerHTML=l,s=H(),g.c(),r=H(),i=w("button"),i.innerHTML=o,this.h()},l(h){e=y(h,"DIV",{class:!0,dir:!0});var _=k(e);t=y(_,"BUTTON",{class:!0,"data-svelte-h":!0}),lt(t)!=="svelte-buado9"&&(t.innerHTML=l),s=z(_),g.l(_),r=z(_),i=y(_,"BUTTON",{class:!0,"data-svelte-h":!0}),lt(i)!=="svelte-4phel2"&&(i.innerHTML=o),_.forEach(m),this.h()},h(){d(t,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),d(i,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),d(e,"class","flex self-center"),d(e,"dir","ltr")},m(h,_){E(h,e,_),b(e,t),b(e,s),g.m(e,null),b(e,r),b(e,i),a||(f=[he(t,"click",n[48]),he(i,"click",n[52])],a=!0)},p(h,_){c===(c=u(h))&&g?g.p(h,_):(g.d(1),g=c(h),g&&(g.c(),g.m(e,r)))},d(h){h&&m(e),g.d(),a=!1,$e(f)}}}function df(n){let e,t=n[1].indexOf(n[7].id)+1+"",l,s,r=n[1].length+"",i,o,a;return{c(){e=w("div"),l=W(t),s=W("/"),i=W(r),this.h()},l(f){e=y(f,"DIV",{class:!0});var u=k(e);l=q(u,t),s=q(u,"/"),i=q(u,r),u.forEach(m),this.h()},h(){d(e,"class","text-sm tracking-widest font-semibold self-center dark:text-gray-100 min-w-fit")},m(f,u){E(f,e,u),b(e,l),b(e,s),b(e,i),o||(a=he(e,"dblclick",n[51]),o=!0)},p(f,u){u[0]&130&&t!==(t=f[1].indexOf(f[7].id)+1+"")&&Z(l,t),u[0]&2&&r!==(r=f[1].length+"")&&Z(i,r)},d(f){f&&m(e),o=!1,a()}}}function hf(n){let e,t,l,s,r,i,o=n[1].length+"",a,f,u;return{c(){e=w("div"),t=w("input"),i=W("/"),a=W(o),this.h()},l(c){e=y(c,"DIV",{class:!0});var g=k(e);t=y(g,"INPUT",{id:!0,type:!0,min:!0,max:!0,class:!0}),i=q(g,"/"),a=q(g,o),g.forEach(m),this.h()},h(){d(t,"id",l="message-index-input-"+n[7].id),d(t,"type","number"),t.value=s=n[1].indexOf(n[7].id)+1,d(t,"min","1"),d(t,"max",r=n[1].length),d(t,"class","bg-transparent font-semibold self-center dark:text-gray-100 min-w-fit outline-hidden"),d(e,"class","text-sm flex justify-center font-semibold self-center dark:text-gray-100 min-w-fit")},m(c,g){E(c,e,g),b(e,t),b(e,i),b(e,a),f||(u=[he(t,"focus",vf),he(t,"blur",n[49]),he(t,"keydown",n[50])],f=!0)},p(c,g){g[0]&128&&l!==(l="message-index-input-"+c[7].id)&&d(t,"id",l),g[0]&130&&s!==(s=c[1].indexOf(c[7].id)+1)&&t.value!==s&&(t.value=s),g[0]&2&&r!==(r=c[1].length)&&d(t,"max",r),g[0]&2&&o!==(o=c[1].length+"")&&Z(a,o)},d(c){c&&m(e),f=!1,$e(u)}}}function yn(n){let e,t,l=Ve(n[12]),s=[];for(let i=0;i<l.length;i+=1)s[i]=In(an(n,l,i));const r=i=>M(s[i],1,1,()=>{s[i]=null});return{c(){e=w("div");for(let i=0;i<s.length;i+=1)s[i].c();this.h()},l(i){e=y(i,"DIV",{class:!0});var o=k(e);for(let a=0;a<s.length;a+=1)s[a].l(o);o.forEach(m),this.h()},h(){d(e,"class","flex items-center flex-wrap gap-2 -mx-2 mb-1")},m(i,o){E(i,e,o);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);t=!0},p(i,o){if(o[0]&4096){l=Ve(i[12]);let a;for(a=0;a<l.length;a+=1){const f=an(i,l,a);s[a]?(s[a].p(f,o),v(s[a],1)):(s[a]=In(f),s[a].c(),v(s[a],1),s[a].m(e,null))}for(te(),a=l.length;a<s.length;a+=1)r(a);le()}},i(i){if(!t){for(let o=0;o<l.length;o+=1)v(s[o]);t=!0}},o(i){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)M(s[o]);t=!1},d(i){i&&m(e),qe(s,i)}}}function mf(n){var r;let e,t;function l(){return n[32](n[55])}function s(){return n[33](n[53])}return e=new el({props:{item:n[53],name:n[53].name,type:n[53].type,size:(r=n[53])==null?void 0:r.size,loading:n[53].status==="uploading",dismissible:!0,edit:!0}}),e.$on("dismiss",l),e.$on("click",s),{c(){Y(e.$$.fragment)},l(i){$(e.$$.fragment,i)},m(i,o){x(e,i,o),t=!0},p(i,o){var f;n=i;const a={};o[0]&4096&&(a.item=n[53]),o[0]&4096&&(a.name=n[53].name),o[0]&4096&&(a.type=n[53].type),o[0]&4096&&(a.size=(f=n[53])==null?void 0:f.size),o[0]&4096&&(a.loading=n[53].status==="uploading"),e.$set(a)},i(i){t||(v(e.$$.fragment,i),t=!0)},o(i){M(e.$$.fragment,i),t=!1},d(i){ee(e,i)}}}function gf(n){let e,t,l,s,r,i,o='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-4"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg>',a,f,u,c;l=new Yt({props:{src:n[53].url,alt:"input",imageClassName:" size-14 rounded-xl object-cover"}});function g(){return n[31](n[55])}return{c(){e=w("div"),t=w("div"),Y(l.$$.fragment),s=H(),r=w("div"),i=w("button"),i.innerHTML=o,a=H(),this.h()},l(h){e=y(h,"DIV",{class:!0});var _=k(e);t=y(_,"DIV",{class:!0});var T=k(t);$(l.$$.fragment,T),T.forEach(m),s=z(_),r=y(_,"DIV",{class:!0});var p=k(r);i=y(p,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),lt(i)!=="svelte-1ki5d3w"&&(i.innerHTML=o),p.forEach(m),a=z(_),_.forEach(m),this.h()},h(){d(t,"class","relative flex items-center"),d(i,"class","bg-white text-black border border-white rounded-full group-hover:visible invisible transition"),d(i,"type","button"),d(r,"class","absolute -top-1 -right-1"),d(e,"class","relative group")},m(h,_){E(h,e,_),b(e,t),x(l,t,null),b(e,s),b(e,r),b(r,i),b(e,a),f=!0,u||(c=he(i,"click",g),u=!0)},p(h,_){n=h;const T={};_[0]&4096&&(T.src=n[53].url),l.$set(T)},i(h){f||(v(l.$$.fragment,h),f=!0)},o(h){M(l.$$.fragment,h),f=!1},d(h){h&&m(e),ee(l),u=!1,c()}}}function In(n){let e,t,l,s;const r=[gf,mf],i=[];function o(a,f){return a[53].type==="image"?0:1}return e=o(n),t=i[e]=r[e](n),{c(){t.c(),l=ce()},l(a){t.l(a),l=ce()},m(a,f){i[e].m(a,f),E(a,l,f),s=!0},p(a,f){let u=e;e=o(a),e===u?i[e].p(a,f):(te(),M(i[u],1,1,()=>{i[u]=null}),le(),t=i[e],t?t.p(a,f):(t=i[e]=r[e](a),t.c()),v(t,1),t.m(l.parentNode,l))},i(a){s||(v(t),s=!0)},o(a){M(t),s=!1},d(a){a&&m(l),i[e].d(a)}}}function _f(n){var S;let e,t,l,s,r,i,o,a,f,u,c,g,h,_,T;function p(C){n[28](C)}let D={title:n[14].t("Delete message?")};n[8]!==void 0&&(D.show=n[8]),e=new Zn({props:D}),ze.push(()=>Ye(e,"show",p)),e.$on("confirm",n[29]);let V=!(((S=n[15])==null?void 0:S.chatBubble)??!0)&&fn(n);const L=[Qo,Zo],O=[];function P(C,B){var F;return((F=C[15])==null?void 0:F.chatBubble)??!0?C[7].timestamp?1:-1:0}~(o=P(n))&&(a=O[o]=L[o](n));let I=n[10]!==!0&&cn(n),N=n[7].content!==""&&mn(n);return{c(){Y(e.$$.fragment),l=H(),s=w("div"),V&&V.c(),r=H(),i=w("div"),a&&a.c(),f=H(),u=w("div"),I&&I.c(),c=H(),N&&N.c(),this.h()},l(C){$(e.$$.fragment,C),l=z(C),s=y(C,"DIV",{class:!0,dir:!0,id:!0});var B=k(s);V&&V.l(B),r=z(B),i=y(B,"DIV",{class:!0});var F=k(i);a&&a.l(F),f=z(F),u=y(F,"DIV",{class:!0});var R=k(u);I&&I.l(R),c=z(R),N&&N.l(R),R.forEach(m),F.forEach(m),B.forEach(m),this.h()},h(){d(u,"class",g="chat-"+n[7].role+" w-full min-w-full markdown-prose"),d(i,"class","flex-auto w-0 max-w-full pl-1"),d(s,"class","flex w-full user-message group"),d(s,"dir",h=n[15].chatDirection),d(s,"id",_="message-"+n[7].id)},m(C,B){x(e,C,B),E(C,l,B),E(C,s,B),V&&V.m(s,null),b(s,r),b(s,i),~o&&O[o].m(i,null),b(i,f),b(i,u),I&&I.m(u,null),b(u,c),N&&N.m(u,null),T=!0},p(C,B){var Q;const F={};B[0]&16384&&(F.title=C[14].t("Delete message?")),!t&&B[0]&256&&(t=!0,F.show=C[8],Xe(()=>t=!1)),e.$set(F),((Q=C[15])==null?void 0:Q.chatBubble)??!0?V&&(te(),M(V,1,1,()=>{V=null}),le()):V?(V.p(C,B),B[0]&32768&&v(V,1)):(V=fn(C),V.c(),v(V,1),V.m(s,r));let R=o;o=P(C),o===R?~o&&O[o].p(C,B):(a&&(te(),M(O[R],1,1,()=>{O[R]=null}),le()),~o?(a=O[o],a?a.p(C,B):(a=O[o]=L[o](C),a.c()),v(a,1),a.m(i,f)):a=null),C[10]!==!0?I?(I.p(C,B),B[0]&1024&&v(I,1)):(I=cn(C),I.c(),v(I,1),I.m(u,c)):I&&(te(),M(I,1,1,()=>{I=null}),le()),C[7].content!==""?N?(N.p(C,B),B[0]&128&&v(N,1)):(N=mn(C),N.c(),v(N,1),N.m(u,null)):N&&(te(),M(N,1,1,()=>{N=null}),le()),(!T||B[0]&128&&g!==(g="chat-"+C[7].role+" w-full min-w-full markdown-prose"))&&d(u,"class",g),(!T||B[0]&32768&&h!==(h=C[15].chatDirection))&&d(s,"dir",h),(!T||B[0]&128&&_!==(_="message-"+C[7].id))&&d(s,"id",_)},i(C){T||(v(e.$$.fragment,C),v(V),v(a),v(I),v(N),T=!0)},o(C){M(e.$$.fragment,C),M(V),M(a),M(I),M(N),T=!1},d(C){C&&(m(l),m(s)),ee(e,C),V&&V.d(),~o&&O[o].d(),I&&I.d(),N&&N.d()}}}const bf=n=>{n.target.style.height="",n.target.style.height=`${n.target.scrollHeight}px`},pf=n=>{n.target.select()},vf=n=>{n.target.select()};function kf(n,e,t){let l,s,r,i;Ne(n,bt,se=>t(15,s=se)),Ne(n,zt,se=>t(16,r=se)),Ne(n,Ut,se=>t(17,i=se));const o=Fe("i18n");Ne(n,o,se=>t(14,l=se)),it.extend(qn);let{user:a}=e,{history:f}=e,{messageId:u}=e,{siblings:c}=e,{gotoMessage:g}=e,{showPreviousMessage:h}=e,{showNextMessage:_}=e,{editMessage:T}=e,{deleteMessage:p}=e,{isFirstMessage:D}=e,{readOnly:V}=e,L=!1,O=!1,P=!1,I="",N=[],S,C=JSON.parse(JSON.stringify(f.messages[u]));const B=async se=>{await Wn(se)&&je.success(l.t("Copying to clipboard was successful!"))},F=async()=>{t(10,P=!0),t(11,I=C.content),t(12,N=C.files),await Te(),S&&(t(13,S.style.height="",S),t(13,S.style.height=`${S.scrollHeight}px`,S),S==null||S.focus())},R=async(se=!0)=>{T(C.id,{content:I,files:N},se),t(10,P=!1),t(11,I=""),t(12,N=[])},Q=()=>{t(10,P=!1),t(11,I=""),t(12,N=[])},_e=async()=>{p(C.id)};yt(()=>{});function U(se){L=se,t(8,L)}const ne=()=>{_e()},fe=se=>se.id===C.user,ue=se=>{N.splice(se,1),t(12,N)},we=async se=>{N.splice(se,1),t(12,N)},X=se=>{};function re(se){ze[se?"unshift":"push"](()=>{S=se,t(13,S)})}function ge(){I=this.value,t(11,I)}const ie=se=>{var Je,xe;se.key==="Escape"&&((Je=document.getElementById("close-edit-message-button"))==null||Je.click());const Ge=se.metaKey||se.ctrlKey,Ke=se.key==="Enter";Ge&&Ke&&((xe=document.getElementById("confirm-edit-message-button"))==null||xe.click())},de=()=>{R(!1)},ke=()=>{Q()},ye=()=>{R()},J=()=>{h(C)},me=se=>{g(C,se.target.value-1),t(9,O=!1)},ae=se=>{se.key==="Enter"&&(g(C,se.target.value-1),t(9,O=!1))},A=async()=>{t(9,O=!0),await Te();const se=document.getElementById(`message-index-input-${C.id}`);se&&(se.focus(),se.select())},K=()=>{_(C)},G=()=>{F()},oe=()=>{B(C.content)},be=()=>{t(8,L=!0)},Ee=()=>{h(C)},Me=se=>{g(C,se.target.value-1),t(9,O=!1)},Oe=se=>{se.key==="Enter"&&(g(C,se.target.value-1),t(9,O=!1))},Ue=async()=>{t(9,O=!0),await Te();const se=document.getElementById(`message-index-input-${C.id}`);se&&(se.focus(),se.select())},He=()=>{_(C)};return n.$$set=se=>{"user"in se&&t(0,a=se.user),"history"in se&&t(24,f=se.history),"messageId"in se&&t(25,u=se.messageId),"siblings"in se&&t(1,c=se.siblings),"gotoMessage"in se&&t(2,g=se.gotoMessage),"showPreviousMessage"in se&&t(3,h=se.showPreviousMessage),"showNextMessage"in se&&t(4,_=se.showNextMessage),"editMessage"in se&&t(26,T=se.editMessage),"deleteMessage"in se&&t(27,p=se.deleteMessage),"isFirstMessage"in se&&t(5,D=se.isFirstMessage),"readOnly"in se&&t(6,V=se.readOnly)},n.$$.update=()=>{n.$$.dirty[0]&50331776&&f.messages&&JSON.stringify(C)!==JSON.stringify(f.messages[u])&&t(7,C=JSON.parse(JSON.stringify(f.messages[u])))},[a,c,g,h,_,D,V,C,L,O,P,I,N,S,l,s,r,i,o,B,F,R,Q,_e,f,u,T,p,U,ne,fe,ue,we,X,re,ge,ie,de,ke,ye,J,me,ae,A,K,G,oe,be,Ee,Me,Oe,Ue,He]}class wf extends Ae{constructor(e){super(),Le(this,e,kf,_f,Se,{user:0,history:24,messageId:25,siblings:1,gotoMessage:2,showPreviousMessage:3,showNextMessage:4,editMessage:26,deleteMessage:27,isFirstMessage:5,readOnly:6},null,[-1,-1])}}function Mn(n){let e,t,l,s;const r=[Mf,If,yf],i=[];function o(a,f){var u,c;return a[0].messages[a[4]].role==="user"?0:(((c=(u=a[0].messages[a[0].messages[a[4]].parentId])==null?void 0:u.models)==null?void 0:c.length)??1)===1?1:2}return e=o(n),t=i[e]=r[e](n),{c(){t.c(),l=ce()},l(a){t.l(a),l=ce()},m(a,f){i[e].m(a,f),E(a,l,f),s=!0},p(a,f){let u=e;e=o(a),e===u?i[e].p(a,f):(te(),M(i[u],1,1,()=>{i[u]=null}),le(),t=i[e],t?t.p(a,f):(t=i[e]=r[e](a),t.c()),v(t,1),t.m(l.parentNode,l))},i(a){s||(v(t),s=!0)},o(a){M(t),s=!1},d(a){a&&m(l),i[e].d(a)}}}function yf(n){var i;let e,t,l;function s(o){n[24](o)}let r={chatId:n[1],messageId:n[4],selectedModels:n[2],isLastMessage:n[4]===((i=n[0])==null?void 0:i.currentId),setInputText:n[6],updateChat:n[10],editMessage:n[11],saveMessage:n[12],rateMessage:n[14],actionMessage:n[15],submitMessage:n[16],deleteMessage:n[13],continueResponse:n[18],regenerateResponse:n[17],mergeResponses:n[19],triggerScroll:n[21],addMessages:n[20],readOnly:n[22]};return n[0]!==void 0&&(r.history=n[0]),e=new Ko({props:r}),ze.push(()=>Ye(e,"history",s)),{c(){Y(e.$$.fragment)},l(o){$(e.$$.fragment,o)},m(o,a){x(e,o,a),l=!0},p(o,a){var u;const f={};a&2&&(f.chatId=o[1]),a&16&&(f.messageId=o[4]),a&4&&(f.selectedModels=o[2]),a&17&&(f.isLastMessage=o[4]===((u=o[0])==null?void 0:u.currentId)),a&64&&(f.setInputText=o[6]),a&1024&&(f.updateChat=o[10]),a&2048&&(f.editMessage=o[11]),a&4096&&(f.saveMessage=o[12]),a&16384&&(f.rateMessage=o[14]),a&32768&&(f.actionMessage=o[15]),a&65536&&(f.submitMessage=o[16]),a&8192&&(f.deleteMessage=o[13]),a&262144&&(f.continueResponse=o[18]),a&131072&&(f.regenerateResponse=o[17]),a&524288&&(f.mergeResponses=o[19]),a&2097152&&(f.triggerScroll=o[21]),a&1048576&&(f.addMessages=o[20]),a&4194304&&(f.readOnly=o[22]),!t&&a&1&&(t=!0,f.history=o[0],Xe(()=>t=!1)),e.$set(f)},i(o){l||(v(e.$$.fragment,o),l=!0)},o(o){M(e.$$.fragment,o),l=!1},d(o){ee(e,o)}}}function If(n){var l;let e,t;return e=new Xn({props:{chatId:n[1],history:n[0],messageId:n[4],selectedModels:n[2],isLastMessage:n[4]===n[0].currentId,siblings:((l=n[0].messages[n[0].messages[n[4]].parentId])==null?void 0:l.childrenIds)??[],setInputText:n[6],gotoMessage:n[7],showPreviousMessage:n[8],showNextMessage:n[9],updateChat:n[10],editMessage:n[11],saveMessage:n[12],rateMessage:n[14],actionMessage:n[15],submitMessage:n[16],deleteMessage:n[13],continueResponse:n[18],regenerateResponse:n[17],addMessages:n[20],readOnly:n[22]}}),{c(){Y(e.$$.fragment)},l(s){$(e.$$.fragment,s)},m(s,r){x(e,s,r),t=!0},p(s,r){var o;const i={};r&2&&(i.chatId=s[1]),r&1&&(i.history=s[0]),r&16&&(i.messageId=s[4]),r&4&&(i.selectedModels=s[2]),r&17&&(i.isLastMessage=s[4]===s[0].currentId),r&17&&(i.siblings=((o=s[0].messages[s[0].messages[s[4]].parentId])==null?void 0:o.childrenIds)??[]),r&64&&(i.setInputText=s[6]),r&128&&(i.gotoMessage=s[7]),r&256&&(i.showPreviousMessage=s[8]),r&512&&(i.showNextMessage=s[9]),r&1024&&(i.updateChat=s[10]),r&2048&&(i.editMessage=s[11]),r&4096&&(i.saveMessage=s[12]),r&16384&&(i.rateMessage=s[14]),r&32768&&(i.actionMessage=s[15]),r&65536&&(i.submitMessage=s[16]),r&8192&&(i.deleteMessage=s[13]),r&262144&&(i.continueResponse=s[18]),r&131072&&(i.regenerateResponse=s[17]),r&1048576&&(i.addMessages=s[20]),r&4194304&&(i.readOnly=s[22]),e.$set(i)},i(s){t||(v(e.$$.fragment,s),t=!0)},o(s){M(e.$$.fragment,s),t=!1},d(s){ee(e,s)}}}function Mf(n){var l;let e,t;return e=new wf({props:{user:n[5],history:n[0],messageId:n[4],isFirstMessage:n[3]===0,siblings:n[0].messages[n[4]].parentId!==null?((l=n[0].messages[n[0].messages[n[4]].parentId])==null?void 0:l.childrenIds)??[]:Object.values(n[0].messages).filter(En).map(Nn)??[],gotoMessage:n[7],showPreviousMessage:n[8],showNextMessage:n[9],editMessage:n[11],deleteMessage:n[13],readOnly:n[22]}}),{c(){Y(e.$$.fragment)},l(s){$(e.$$.fragment,s)},m(s,r){x(e,s,r),t=!0},p(s,r){var o;const i={};r&32&&(i.user=s[5]),r&1&&(i.history=s[0]),r&16&&(i.messageId=s[4]),r&8&&(i.isFirstMessage=s[3]===0),r&17&&(i.siblings=s[0].messages[s[4]].parentId!==null?((o=s[0].messages[s[0].messages[s[4]].parentId])==null?void 0:o.childrenIds)??[]:Object.values(s[0].messages).filter(En).map(Nn)??[]),r&128&&(i.gotoMessage=s[7]),r&256&&(i.showPreviousMessage=s[8]),r&512&&(i.showNextMessage=s[9]),r&2048&&(i.editMessage=s[11]),r&8192&&(i.deleteMessage=s[13]),r&4194304&&(i.readOnly=s[22]),e.$set(i)},i(s){t||(v(e.$$.fragment,s),t=!0)},o(s){M(e.$$.fragment,s),t=!1},d(s){ee(e,s)}}}function Ef(n){let e,t,l,s=n[0].messages[n[4]]&&Mn(n);return{c(){e=w("div"),s&&s.c(),this.h()},l(r){e=y(r,"DIV",{class:!0});var i=k(e);s&&s.l(i),i.forEach(m),this.h()},h(){var r;d(e,"class",t="flex flex-col justify-between px-5 mb-3 w-full "+(((r=n[23])==null?void 0:r.widescreenMode)??null?"max-w-full":"max-w-5xl")+" mx-auto rounded-lg group")},m(r,i){E(r,e,i),s&&s.m(e,null),l=!0},p(r,[i]){var o;r[0].messages[r[4]]?s?(s.p(r,i),i&17&&v(s,1)):(s=Mn(r),s.c(),v(s,1),s.m(e,null)):s&&(te(),M(s,1,1,()=>{s=null}),le()),(!l||i&8388608&&t!==(t="flex flex-col justify-between px-5 mb-3 w-full "+(((o=r[23])==null?void 0:o.widescreenMode)??null?"max-w-full":"max-w-5xl")+" mx-auto rounded-lg group"))&&d(e,"class",t)},i(r){l||(v(s),l=!0)},o(r){M(s),l=!1},d(r){r&&m(e),s&&s.d()}}}const En=n=>n.parentId===null,Nn=n=>n.id;function Nf(n,e,t){let l;Ne(n,bt,R=>t(23,l=R)),Vt(),Fe("i18n");let{chatId:s}=e,{selectedModels:r=[]}=e,{idx:i=0}=e,{history:o}=e,{messageId:a}=e,{user:f}=e,{setInputText:u=()=>{}}=e,{gotoMessage:c}=e,{showPreviousMessage:g}=e,{showNextMessage:h}=e,{updateChat:_}=e,{editMessage:T}=e,{saveMessage:p}=e,{deleteMessage:D}=e,{rateMessage:V}=e,{actionMessage:L}=e,{submitMessage:O}=e,{regenerateResponse:P}=e,{continueResponse:I}=e,{mergeResponses:N}=e,{addMessages:S}=e,{triggerScroll:C}=e,{readOnly:B=!1}=e;function F(R){o=R,t(0,o)}return n.$$set=R=>{"chatId"in R&&t(1,s=R.chatId),"selectedModels"in R&&t(2,r=R.selectedModels),"idx"in R&&t(3,i=R.idx),"history"in R&&t(0,o=R.history),"messageId"in R&&t(4,a=R.messageId),"user"in R&&t(5,f=R.user),"setInputText"in R&&t(6,u=R.setInputText),"gotoMessage"in R&&t(7,c=R.gotoMessage),"showPreviousMessage"in R&&t(8,g=R.showPreviousMessage),"showNextMessage"in R&&t(9,h=R.showNextMessage),"updateChat"in R&&t(10,_=R.updateChat),"editMessage"in R&&t(11,T=R.editMessage),"saveMessage"in R&&t(12,p=R.saveMessage),"deleteMessage"in R&&t(13,D=R.deleteMessage),"rateMessage"in R&&t(14,V=R.rateMessage),"actionMessage"in R&&t(15,L=R.actionMessage),"submitMessage"in R&&t(16,O=R.submitMessage),"regenerateResponse"in R&&t(17,P=R.regenerateResponse),"continueResponse"in R&&t(18,I=R.continueResponse),"mergeResponses"in R&&t(19,N=R.mergeResponses),"addMessages"in R&&t(20,S=R.addMessages),"triggerScroll"in R&&t(21,C=R.triggerScroll),"readOnly"in R&&t(22,B=R.readOnly)},[o,s,r,i,a,f,u,c,g,h,_,T,p,D,V,L,O,P,I,N,S,C,B,l,F]}class Df extends Ae{constructor(e){super(),Le(this,e,Nf,Ef,Se,{chatId:1,selectedModels:2,idx:3,history:0,messageId:4,user:5,setInputText:6,gotoMessage:7,showPreviousMessage:8,showNextMessage:9,updateChat:10,editMessage:11,saveMessage:12,deleteMessage:13,rateMessage:14,actionMessage:15,submitMessage:16,regenerateResponse:17,continueResponse:18,mergeResponses:19,addMessages:20,triggerScroll:21,readOnly:22})}}function Dn(n,e,t){const l=n.slice();return l[14]=e[t],l[16]=t,l}function Vf(n){let e,t,l,s,r;return{c(){e=w("div"),t=W(n[5]),l=W(" ‧ v"),s=W(vl),this.h()},l(i){e=y(i,"DIV",{class:!0});var o=k(e);t=q(o,n[5]),l=q(o," ‧ v"),s=q(o,vl),o.forEach(m),this.h()},h(){var i;d(e,"class",r="flex w-full "+(((i=n[4])==null?void 0:i.landingPageMode)==="chat"?" -mt-1":"text-center items-center justify-center")+" self-start text-gray-600 dark:text-gray-400")},m(i,o){E(i,e,o),b(e,t),b(e,l),b(e,s)},p(i,o){var a;o&32&&Z(t,i[5]),o&16&&r!==(r="flex w-full "+(((a=i[4])==null?void 0:a.landingPageMode)==="chat"?" -mt-1":"text-center items-center justify-center")+" self-start text-gray-600 dark:text-gray-400")&&d(e,"class",r)},i:De,o:De,d(i){i&&m(e)}}}function Tf(n){let e,t,l=n[3].t("Suggested")+"",s,r;return e=new Qr({}),{c(){Y(e.$$.fragment),t=H(),s=W(l)},l(i){$(e.$$.fragment,i),t=z(i),s=q(i,l)},m(i,o){x(e,i,o),E(i,t,o),E(i,s,o),r=!0},p(i,o){(!r||o&8)&&l!==(l=i[3].t("Suggested")+"")&&Z(s,l)},i(i){r||(v(e.$$.fragment,i),r=!0)},o(i){M(e.$$.fragment,i),r=!1},d(i){i&&(m(t),m(s)),ee(e,i)}}}function Vn(n){let e,t=[],l=new Map,s,r=Ve(n[2]);const i=o=>o[14].id||o[14].content;for(let o=0;o<r.length;o+=1){let a=Dn(n,r,o),f=i(a);l.set(f,t[o]=Tn(f,a))}return{c(){e=w("div");for(let o=0;o<t.length;o+=1)t[o].c();this.h()},l(o){e=y(o,"DIV",{role:!0,class:!0});var a=k(e);for(let f=0;f<t.length;f+=1)t[f].l(a);a.forEach(m),this.h()},h(){d(e,"role","list"),d(e,"class",s="max-h-40 overflow-auto scrollbar-none items-start "+n[0]+" svelte-1co34if")},m(o,a){E(o,e,a);for(let f=0;f<t.length;f+=1)t[f]&&t[f].m(e,null)},p(o,a){a&14&&(r=Ve(o[2]),t=Ht(t,a,i,1,o,r,l,e,Br,Tn,null,Dn)),a&1&&s!==(s="max-h-40 overflow-auto scrollbar-none items-start "+o[0]+" svelte-1co34if")&&d(e,"class",s)},d(o){o&&m(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}function Cf(n){let e,t=n[14].content+"",l,s,r,i=n[3].t("Prompt")+"",o;return{c(){e=w("div"),l=W(t),s=H(),r=w("div"),o=W(i),this.h()},l(a){e=y(a,"DIV",{class:!0});var f=k(e);l=q(f,t),f.forEach(m),s=z(a),r=y(a,"DIV",{class:!0});var u=k(r);o=q(u,i),u.forEach(m),this.h()},h(){d(e,"class","font-medium dark:text-gray-300 dark:group-hover:text-gray-200 transition line-clamp-1"),d(r,"class","text-xs text-gray-600 dark:text-gray-400 font-normal line-clamp-1")},m(a,f){E(a,e,f),b(e,l),E(a,s,f),E(a,r,f),b(r,o)},p(a,f){f&4&&t!==(t=a[14].content+"")&&Z(l,t),f&8&&i!==(i=a[3].t("Prompt")+"")&&Z(o,i)},d(a){a&&(m(e),m(s),m(r))}}}function Sf(n){let e,t=n[14].title[0]+"",l,s,r,i=n[14].title[1]+"",o;return{c(){e=w("div"),l=W(t),s=H(),r=w("div"),o=W(i),this.h()},l(a){e=y(a,"DIV",{class:!0});var f=k(e);l=q(f,t),f.forEach(m),s=z(a),r=y(a,"DIV",{class:!0});var u=k(r);o=q(u,i),u.forEach(m),this.h()},h(){d(e,"class","font-medium dark:text-gray-300 dark:group-hover:text-gray-200 transition line-clamp-1"),d(r,"class","text-xs text-gray-600 dark:text-gray-400 font-normal line-clamp-1")},m(a,f){E(a,e,f),b(e,l),E(a,s,f),E(a,r,f),b(r,o)},p(a,f){f&4&&t!==(t=a[14].title[0]+"")&&Z(l,t),f&4&&i!==(i=a[14].title[1]+"")&&Z(o,i)},d(a){a&&(m(e),m(s),m(r))}}}function Tn(n,e){let t,l,s,r,i;function o(c,g){return c[14].title&&c[14].title[0]!==""?Sf:Cf}let a=o(e),f=a(e);function u(){return e[10](e[14])}return{key:n,first:null,c(){t=w("button"),l=w("div"),f.c(),s=H(),this.h()},l(c){t=y(c,"BUTTON",{role:!0,class:!0,style:!0});var g=k(t);l=y(g,"DIV",{class:!0});var h=k(l);f.l(h),h.forEach(m),s=z(g),g.forEach(m),this.h()},h(){d(l,"class","flex flex-col text-left"),d(t,"role","listitem"),d(t,"class","waterfall flex flex-col flex-1 shrink-0 w-full justify-between px-3 py-2 rounded-xl bg-transparent hover:bg-black/5 dark:hover:bg-white/5 transition group svelte-1co34if"),At(t,"animation-delay",e[16]*60+"ms"),this.first=t},m(c,g){E(c,t,g),b(t,l),f.m(l,null),b(t,s),r||(i=he(t,"click",u),r=!0)},p(c,g){e=c,a===(a=o(e))&&f?f.p(e,g):(f.d(1),f=a(e),f&&(f.c(),f.m(l,null))),g&4&&At(t,"animation-delay",e[16]*60+"ms")},d(c){c&&m(t),f.d(),r=!1,i()}}}function Bf(n){let e,t,l,s,r,i;const o=[Tf,Vf],a=[];function f(c,g){return c[2].length>0?0:1}t=f(n),l=a[t]=o[t](n);let u=n[2].length>0&&Vn(n);return{c(){e=w("div"),l.c(),s=H(),r=w("div"),u&&u.c(),this.h()},l(c){e=y(c,"DIV",{class:!0});var g=k(e);l.l(g),g.forEach(m),s=z(c),r=y(c,"DIV",{class:!0});var h=k(r);u&&u.l(h),h.forEach(m),this.h()},h(){d(e,"class","mb-1 flex gap-1 text-xs font-medium items-center text-gray-600 dark:text-gray-400"),d(r,"class","h-40 w-full")},m(c,g){E(c,e,g),a[t].m(e,null),E(c,s,g),E(c,r,g),u&&u.m(r,null),i=!0},p(c,[g]){let h=t;t=f(c),t===h?a[t].p(c,g):(te(),M(a[h],1,1,()=>{a[h]=null}),le(),l=a[t],l?l.p(c,g):(l=a[t]=o[t](c),l.c()),v(l,1),l.m(e,null)),c[2].length>0?u?u.p(c,g):(u=Vn(c),u.c(),u.m(r,null)):u&&(u.d(1),u=null)},i(c){i||(v(l),i=!0)},o(c){M(l),i=!1},d(c){c&&(m(e),m(s),m(r)),a[t].d(),u&&u.d()}}}function Of(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if((n[t].id??n[t].content)!==(e[t].id??e[t].content))return!1;return!0}function Rf(n,e,t){let l,s,r;Ne(n,bt,D=>t(4,s=D)),Ne(n,Ar,D=>t(5,r=D));const i=Fe("i18n");Ne(n,i,D=>t(3,l=D));let{suggestionPrompts:o=[]}=e,{className:a=""}=e,{inputValue:f=""}=e,{onSelect:u=D=>{}}=e,c=[];const g={keys:["content","title"],threshold:.5};let h,_=[];const T=D=>{if(D.length>500)t(2,_=[]);else{const V=D.trim()&&h?h.search(D.trim()).map(L=>L.item):c;Of(_,V)||t(2,_=V)}},p=D=>u({type:"prompt",data:D.content});return n.$$set=D=>{"suggestionPrompts"in D&&t(7,o=D.suggestionPrompts),"className"in D&&t(0,a=D.className),"inputValue"in D&&t(8,f=D.inputValue),"onSelect"in D&&t(1,u=D.onSelect)},n.$$.update=()=>{n.$$.dirty&384&&o&&(t(9,c=[...o??[]].sort(()=>Math.random()-.5)),T(f)),n.$$.dirty&512&&(h=new li(c,g)),n.$$.dirty&256&&T(f)},[a,u,_,l,s,r,i,o,f,c,p]}class Pf extends Ae{constructor(e){super(),Le(this,e,Rf,Bf,Se,{suggestionPrompts:7,className:0,inputValue:8,onSelect:1})}}function Cn(n,e,t){const l=n.slice();return l[13]=e[t],l[15]=t,l}function Af(n){let e,t;return{c(){e=w("img"),this.h()},l(l){e=y(l,"IMG",{crossorigin:!0,src:!0,class:!0,alt:!0,draggable:!0}),this.h()},h(){var l,s,r;d(e,"crossorigin","anonymous"),Lt(e.src,t=((r=(s=(l=n[13])==null?void 0:l.info)==null?void 0:s.meta)==null?void 0:r.profile_image_url)??(n[5].language==="dg-DG"?`${Qe}/doge.png`:`${Qe}/static/favicon.png`))||d(e,"src",t),d(e,"class","size-[2.7rem] rounded-full border-[1px] border-gray-100 dark:border-none"),d(e,"alt","logo"),d(e,"draggable","false")},m(l,s){E(l,e,s)},p(l,s){var r,i,o;s&33&&!Lt(e.src,t=((o=(i=(r=l[13])==null?void 0:r.info)==null?void 0:i.meta)==null?void 0:o.profile_image_url)??(l[5].language==="dg-DG"?`${Qe}/doge.png`:`${Qe}/static/favicon.png`))&&d(e,"src",t)},d(l){l&&m(e)}}}function Sn(n){var a,f,u;let e,t,l,s,r,i;t=new Be({props:{content:jt.parse(kt(((u=(f=(a=n[0][n[4]])==null?void 0:a.info)==null?void 0:f.meta)==null?void 0:u.description)??"").replaceAll(`
`,"<br>")),placement:"right",$$slots:{default:[Af]},$$scope:{ctx:n}}});function o(){return n[12](n[15])}return{c(){e=w("button"),Y(t.$$.fragment),l=H()},l(c){e=y(c,"BUTTON",{});var g=k(e);$(t.$$.fragment,g),l=z(g),g.forEach(m)},m(c,g){E(c,e,g),x(t,e,null),b(e,l),s=!0,r||(i=he(e,"click",o),r=!0)},p(c,g){var _,T,p;n=c;const h={};g&17&&(h.content=jt.parse(kt(((p=(T=(_=n[0][n[4]])==null?void 0:_.info)==null?void 0:T.meta)==null?void 0:p.description)??"").replaceAll(`
`,"<br>"))),g&65569&&(h.$$scope={dirty:g,ctx:n}),t.$set(h)},i(c){s||(v(t.$$.fragment,c),s=!0)},o(c){M(t.$$.fragment,c),s=!1},d(c){c&&m(e),ee(t),r=!1,i()}}}function Bn(n){let e,t;return e=new Be({props:{content:n[5].t("This chat won't appear in history and your messages will not be saved."),className:"w-full flex justify-start mb-0.5",placement:"top",$$slots:{default:[Lf]},$$scope:{ctx:n}}}),{c(){Y(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},p(l,s){const r={};s&32&&(r.content=l[5].t("This chat won't appear in history and your messages will not be saved.")),s&65568&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function Lf(n){let e,t,l=n[5].t("Temporary Chat")+"",s,r;return t=new si({props:{strokeWidth:"2.5",className:"size-5"}}),{c(){e=w("div"),Y(t.$$.fragment),s=W(l),this.h()},l(i){e=y(i,"DIV",{class:!0});var o=k(e);$(t.$$.fragment,o),s=q(o,l),o.forEach(m),this.h()},h(){d(e,"class","flex items-center gap-2 text-gray-500 font-medium text-lg mt-2 w-fit")},m(i,o){E(i,e,o),x(t,e,null),b(e,s),r=!0},p(i,o){(!r||o&32)&&l!==(l=i[5].t("Temporary Chat")+"")&&Z(s,l)},i(i){r||(v(t.$$.fragment,i),r=!0)},o(i){M(t.$$.fragment,i),r=!1},d(i){i&&m(e),ee(t)}}}function jf(n){var l;let e=n[5].t("Hello, {{name}}",{name:(l=n[7])==null?void 0:l.name})+"",t;return{c(){t=W(e)},l(s){t=q(s,e)},m(s,r){E(s,t,r)},p(s,r){var i;r&160&&e!==(e=s[5].t("Hello, {{name}}",{name:(i=s[7])==null?void 0:i.name})+"")&&Z(t,e)},d(s){s&&m(t)}}}function Hf(n){var l;let e=((l=n[0][n[4]])==null?void 0:l.name)+"",t;return{c(){t=W(e)},l(s){t=q(s,e)},m(s,r){E(s,t,r)},p(s,r){var i;r&17&&e!==(e=((i=s[0][s[4]])==null?void 0:i.name)+"")&&Z(t,e)},d(s){s&&m(t)}}}function zf(n){let e,t=n[5].t("How can I help you today?")+"",l;return{c(){e=w("div"),l=W(t),this.h()},l(s){e=y(s,"DIV",{class:!0});var r=k(e);l=q(r,t),r.forEach(m),this.h()},h(){d(e,"class","font-medium text-gray-400 dark:text-gray-500 line-clamp-1 font-p")},m(s,r){E(s,e,r),b(e,l)},p(s,r){r&32&&t!==(t=s[5].t("How can I help you today?")+"")&&Z(l,t)},d(s){s&&m(e)}}}function Uf(n){var o,a,f,u,c,g;let e,t,l=jt.parse(kt((f=(a=(o=n[0][n[4]])==null?void 0:o.info)==null?void 0:a.meta)==null?void 0:f.description).replaceAll(`
`,"<br>"))+"",s,r,i=((g=(c=(u=n[0][n[4]])==null?void 0:u.info)==null?void 0:c.meta)==null?void 0:g.user)&&On(n);return{c(){e=w("div"),t=new Cr(!1),s=H(),i&&i.c(),r=ce(),this.h()},l(h){e=y(h,"DIV",{class:!0});var _=k(e);t=Sr(_,!1),_.forEach(m),s=z(h),i&&i.l(h),r=ce(),this.h()},h(){t.a=null,d(e,"class","mt-0.5 text-base font-normal text-gray-500 dark:text-gray-400 line-clamp-3 markdown")},m(h,_){E(h,e,_),t.m(l,e),E(h,s,_),i&&i.m(h,_),E(h,r,_)},p(h,_){var T,p,D,V,L,O;_&17&&l!==(l=jt.parse(kt((D=(p=(T=h[0][h[4]])==null?void 0:T.info)==null?void 0:p.meta)==null?void 0:D.description).replaceAll(`
`,"<br>"))+"")&&t.p(l),(O=(L=(V=h[0][h[4]])==null?void 0:V.info)==null?void 0:L.meta)!=null&&O.user?i?i.p(h,_):(i=On(h),i.c(),i.m(r.parentNode,r)):i&&(i.d(1),i=null)},d(h){h&&(m(e),m(s),m(r)),i&&i.d(h)}}}function On(n){let e,t;function l(i,o){var a,f,u;return(u=(f=(a=i[0][i[4]])==null?void 0:a.info)==null?void 0:f.meta)!=null&&u.user.community?qf:Wf}let s=l(n),r=s(n);return{c(){e=w("div"),t=W(`By
								`),r.c(),this.h()},l(i){e=y(i,"DIV",{class:!0});var o=k(e);t=q(o,`By
								`),r.l(o),o.forEach(m),this.h()},h(){d(e,"class","mt-0.5 text-sm font-normal text-gray-400 dark:text-gray-500")},m(i,o){E(i,e,o),b(e,t),r.m(e,null)},p(i,o){s===(s=l(i))&&r?r.p(i,o):(r.d(1),r=s(i),r&&(r.c(),r.m(e,null)))},d(i){i&&m(e),r.d()}}}function Wf(n){var l,s,r;let e=((r=(s=(l=n[0][n[4]])==null?void 0:l.info)==null?void 0:s.meta)==null?void 0:r.user.name)+"",t;return{c(){t=W(e)},l(i){t=q(i,e)},m(i,o){E(i,t,o)},p(i,o){var a,f,u;o&17&&e!==(e=((u=(f=(a=i[0][i[4]])==null?void 0:a.info)==null?void 0:f.meta)==null?void 0:u.user.name)+"")&&Z(t,e)},d(i){i&&m(t)}}}function qf(n){var r,i,o,a,f,u,c,g,h;let e,t=((o=(i=(r=n[0][n[4]])==null?void 0:r.info)==null?void 0:i.meta)!=null&&o.user.name?(u=(f=(a=n[0][n[4]])==null?void 0:a.info)==null?void 0:f.meta)==null?void 0:u.user.name:`@${(h=(g=(c=n[0][n[4]])==null?void 0:c.info)==null?void 0:g.meta)==null?void 0:h.user.username}`)+"",l,s;return{c(){e=w("a"),l=W(t),this.h()},l(_){e=y(_,"A",{href:!0});var T=k(e);l=q(T,t),T.forEach(m),this.h()},h(){var _,T,p;d(e,"href",s="https://openwebui.com/m/"+((p=(T=(_=n[0][n[4]])==null?void 0:_.info)==null?void 0:T.meta)==null?void 0:p.user.username))},m(_,T){E(_,e,T),b(e,l)},p(_,T){var p,D,V,L,O,P,I,N,S,C,B,F;T&17&&t!==(t=((V=(D=(p=_[0][_[4]])==null?void 0:p.info)==null?void 0:D.meta)!=null&&V.user.name?(P=(O=(L=_[0][_[4]])==null?void 0:L.info)==null?void 0:O.meta)==null?void 0:P.user.name:`@${(S=(N=(I=_[0][_[4]])==null?void 0:I.info)==null?void 0:N.meta)==null?void 0:S.user.username}`)+"")&&Z(l,t),T&17&&s!==(s="https://openwebui.com/m/"+((F=(B=(C=_[0][_[4]])==null?void 0:C.info)==null?void 0:B.meta)==null?void 0:F.user.username))&&d(e,"href",s)},d(_){_&&m(e)}}}function Rn(n){var Q,_e,U,ne,fe,ue,we;let e,t,l,s,r,i,o,a,f,u,c,g,h,_,T,p,D,V,L=Ve(n[0]),O=[];for(let X=0;X<L.length;X+=1)O[X]=Sn(Cn(n,L,X));const P=X=>M(O[X],1,1,()=>{O[X]=null});let I=n[6]&&Bn(n);function N(X,re){var ge;return(ge=X[0][X[4]])!=null&&ge.name?Hf:jf}let S=N(n),C=S(n);function B(X,re){var ge,ie,de;return((de=(ie=(ge=X[0][X[4]])==null?void 0:ge.info)==null?void 0:ie.meta)==null?void 0:de.description)??null?Uf:zf}let F=B(n),R=F(n);return p=new Pf({props:{className:"grid grid-cols-2",suggestionPrompts:((U=(_e=(Q=n[1])==null?void 0:Q.info)==null?void 0:_e.meta)==null?void 0:U.suggestion_prompts)??((ue=(fe=(ne=n[0][n[4]])==null?void 0:ne.info)==null?void 0:fe.meta)==null?void 0:ue.suggestion_prompts)??((we=n[8])==null?void 0:we.default_prompt_suggestions)??[],onSelect:n[2]}}),{c(){e=w("div"),t=w("div"),l=w("div");for(let X=0;X<O.length;X+=1)O[X].c();r=H(),I&&I.c(),i=H(),o=w("div"),a=w("div"),f=w("div"),C.c(),c=H(),g=w("div"),R.c(),_=H(),T=w("div"),Y(p.$$.fragment),this.h()},l(X){e=y(X,"DIV",{class:!0});var re=k(e);t=y(re,"DIV",{class:!0});var ge=k(t);l=y(ge,"DIV",{class:!0});var ie=k(l);for(let ae=0;ae<O.length;ae+=1)O[ae].l(ie);ie.forEach(m),ge.forEach(m),r=z(re),I&&I.l(re),i=z(re),o=y(re,"DIV",{class:!0});var de=k(o);a=y(de,"DIV",{});var ke=k(a);f=y(ke,"DIV",{class:!0});var ye=k(f);C.l(ye),ye.forEach(m),c=z(ke),g=y(ke,"DIV",{});var J=k(g);R.l(J),J.forEach(m),ke.forEach(m),de.forEach(m),_=z(re),T=y(re,"DIV",{class:!0});var me=k(T);$(p.$$.fragment,me),me.forEach(m),re.forEach(m),this.h()},h(){d(l,"class","flex -space-x-4 mb-0.5"),d(t,"class","flex justify-start"),d(f,"class","capitalize line-clamp-1"),d(o,"class","mt-2 mb-4 text-3xl text-gray-800 dark:text-gray-100 font-medium text-left flex items-center gap-4 font-primary"),d(T,"class","w-full font-primary"),d(e,"class","m-auto w-full max-w-6xl px-8 lg:px-20")},m(X,re){E(X,e,re),b(e,t),b(t,l);for(let ge=0;ge<O.length;ge+=1)O[ge]&&O[ge].m(l,null);b(e,r),I&&I.m(e,null),b(e,i),b(e,o),b(o,a),b(a,f),C.m(f,null),b(a,c),b(a,g),R.m(g,null),b(e,_),b(e,T),x(p,T,null),V=!0},p(X,re){var ie,de,ke,ye,J,me,ae;if(re&49){L=Ve(X[0]);let A;for(A=0;A<L.length;A+=1){const K=Cn(X,L,A);O[A]?(O[A].p(K,re),v(O[A],1)):(O[A]=Sn(K),O[A].c(),v(O[A],1),O[A].m(l,null))}for(te(),A=L.length;A<O.length;A+=1)P(A);le()}X[6]?I?(I.p(X,re),re&64&&v(I,1)):(I=Bn(X),I.c(),v(I,1),I.m(e,i)):I&&(te(),M(I,1,1,()=>{I=null}),le()),S===(S=N(X))&&C?C.p(X,re):(C.d(1),C=S(X),C&&(C.c(),C.m(f,null))),F===(F=B(X))&&R?R.p(X,re):(R.d(1),R=F(X),R&&(R.c(),R.m(g,null)));const ge={};re&275&&(ge.suggestionPrompts=((ke=(de=(ie=X[1])==null?void 0:ie.info)==null?void 0:de.meta)==null?void 0:ke.suggestion_prompts)??((me=(J=(ye=X[0][X[4]])==null?void 0:ye.info)==null?void 0:J.meta)==null?void 0:me.suggestion_prompts)??((ae=X[8])==null?void 0:ae.default_prompt_suggestions)??[]),re&4&&(ge.onSelect=X[2]),p.$set(ge)},i(X){if(!V){for(let re=0;re<L.length;re+=1)v(O[re]);X&&(s||Et(()=>{s=Nt(l,Dt,{duration:200}),s.start()})),v(I),X&&(u||Et(()=>{u=Nt(f,Dt,{duration:200}),u.start()})),X&&(h||Et(()=>{h=Nt(g,Dt,{duration:200,delay:200}),h.start()})),v(p.$$.fragment,X),X&&(D||Et(()=>{D=Nt(T,Dt,{duration:200,delay:300}),D.start()})),V=!0}},o(X){O=O.filter(Boolean);for(let re=0;re<O.length;re+=1)M(O[re]);M(I),M(p.$$.fragment,X),V=!1},d(X){X&&m(e),qe(O,X),I&&I.d(),C.d(),R.d(),ee(p)}}}function Ff(n){let e=n[3],t,l,s=Rn(n);return{c(){s.c(),t=ce()},l(r){s.l(r),t=ce()},m(r,i){s.m(r,i),E(r,t,i),l=!0},p(r,[i]){i&8&&Se(e,e=r[3])?(te(),M(s,1,1,De),le(),s=Rn(r),s.c(),v(s,1),s.m(t.parentNode,t)):s.p(r,i)},i(r){l||(v(s),l=!0)},o(r){M(s),l=!1},d(r){r&&m(t),s.d(r)}}}function Jf(n,e,t){let l,s,r,i,o;Ne(n,zt,p=>t(11,l=p)),Ne(n,Zt,p=>t(6,r=p)),Ne(n,Ut,p=>t(7,i=p)),Ne(n,Un,p=>t(8,o=p));const a=Fe("i18n");Ne(n,a,p=>t(5,s=p));let{modelIds:f=[]}=e,{models:u=[]}=e,{atSelectedModel:c}=e,{onSelect:g=p=>{}}=e,h=!1,_=0;yt(()=>{t(3,h=!0)});const T=p=>{t(4,_=p)};return n.$$set=p=>{"modelIds"in p&&t(10,f=p.modelIds),"models"in p&&t(0,u=p.models),"atSelectedModel"in p&&t(1,c=p.atSelectedModel),"onSelect"in p&&t(2,g=p.onSelect)},n.$$.update=()=>{n.$$.dirty&3072&&t(0,u=f.map(p=>l.find(D=>D.id===p))),n.$$.dirty&1025&&f.length>0&&t(4,_=u.length-1)},[u,c,g,h,_,s,r,i,o,a,f,l,T]}class Gf extends Ae{constructor(e){super(),Le(this,e,Jf,Ff,Se,{modelIds:10,models:0,atSelectedModel:1,onSelect:2})}}function Pn(n,e,t){const l=n.slice();return l[44]=e[t],l[46]=t,l}function Kf(n){let e,t=n[2],l,s=Hn(n);return{c(){e=w("div"),s.c(),this.h()},l(r){e=y(r,"DIV",{class:!0});var i=k(e);s.l(i),i.forEach(m),this.h()},h(){d(e,"class","w-full pt-2")},m(r,i){E(r,e,i),s.m(e,null),l=!0},p(r,i){i[0]&4&&Se(t,t=r[2])?(te(),M(s,1,1,De),le(),s=Hn(r),s.c(),v(s,1),s.m(e,null)):s.p(r,i)},i(r){l||(v(s),l=!0)},o(r){M(s),l=!1},d(r){r&&m(e),s.d(r)}}}function Zf(n){let e,t;return e=new Gf({props:{modelIds:n[4],atSelectedModel:n[5],onSelect:n[14]}}),{c(){Y(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},p(l,s){const r={};s[0]&16&&(r.modelIds=l[4]),s[0]&32&&(r.atSelectedModel=l[5]),s[0]&16384&&(r.onSelect=l[14]),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function An(n){let e,t;return e=new ti({props:{$$slots:{default:[Qf]},$$scope:{ctx:n}}}),e.$on("visible",n[35]),{c(){Y(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},p(l,s){const r={};s[1]&65536&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function Qf(n){let e,t,l,s,r="Loading...",i;return t=new $t({props:{className:" size-4"}}),{c(){e=w("div"),Y(t.$$.fragment),l=H(),s=w("div"),s.textContent=r,this.h()},l(o){e=y(o,"DIV",{class:!0});var a=k(e);$(t.$$.fragment,a),l=z(a),s=y(a,"DIV",{class:!0,"data-svelte-h":!0}),lt(s)!=="svelte-17uns3n"&&(s.textContent=r),a.forEach(m),this.h()},h(){d(s,"class",""),d(e,"class","w-full flex justify-center py-1 text-xs animate-pulse items-center gap-2")},m(o,a){E(o,e,a),x(t,e,null),b(e,l),b(e,s),i=!0},p:De,i(o){i||(v(t.$$.fragment,o),i=!0)},o(o){M(t.$$.fragment,o),i=!1},d(o){o&&m(e),ee(t)}}}function Ln(n,e){let t,l,s,r;function i(a){e[36](a)}let o={chatId:e[2],selectedModels:e[4],messageId:e[44].id,idx:e[46],user:e[3],setInputText:e[6],gotoMessage:e[20],showPreviousMessage:e[21],showNextMessage:e[22],updateChat:e[19],editMessage:e[24],deleteMessage:e[27],rateMessage:e[23],actionMessage:e[25],saveMessage:e[26],submitMessage:e[10],regenerateResponse:e[8],continueResponse:e[7],mergeResponses:e[9],addMessages:e[11],triggerScroll:e[28],readOnly:e[12]};return e[0]!==void 0&&(o.history=e[0]),l=new Df({props:o}),ze.push(()=>Ye(l,"history",i)),{key:n,first:null,c(){t=ce(),Y(l.$$.fragment),this.h()},l(a){t=ce(),$(l.$$.fragment,a),this.h()},h(){this.first=t},m(a,f){E(a,t,f),x(l,a,f),r=!0},p(a,f){e=a;const u={};f[0]&4&&(u.chatId=e[2]),f[0]&16&&(u.selectedModels=e[4]),f[0]&32768&&(u.messageId=e[44].id),f[0]&32768&&(u.idx=e[46]),f[0]&8&&(u.user=e[3]),f[0]&64&&(u.setInputText=e[6]),f[0]&1024&&(u.submitMessage=e[10]),f[0]&256&&(u.regenerateResponse=e[8]),f[0]&128&&(u.continueResponse=e[7]),f[0]&512&&(u.mergeResponses=e[9]),f[0]&2048&&(u.addMessages=e[11]),f[0]&4096&&(u.readOnly=e[12]),!s&&f[0]&1&&(s=!0,u.history=e[0],Xe(()=>s=!1)),l.$set(u)},i(a){r||(v(l.$$.fragment,a),r=!0)},o(a){M(l.$$.fragment,a),r=!1},d(a){a&&m(t),ee(l,a)}}}function jn(n){let e;return{c(){e=w("div"),this.h()},l(t){e=y(t,"DIV",{class:!0}),k(e).forEach(m),this.h()},h(){d(e,"class","pb-6")},m(t,l){E(t,e,l)},d(t){t&&m(e)}}}function Hn(n){var T;let e,t=((T=n[15].at(0))==null?void 0:T.parentId)!==null,l,s=[],r=new Map,i,o,a,f,u,c=t&&An(n),g=Ve(n[15]);const h=p=>p[44].id;for(let p=0;p<g.length;p+=1){let D=Pn(n,g,p),V=h(D);r.set(V,s[p]=Ln(V,D))}let _=n[13]&&jn();return{c(){e=w("div"),c&&c.c(),l=H();for(let p=0;p<s.length;p+=1)s[p].c();i=H(),o=w("div"),a=H(),_&&_.c(),f=ce(),this.h()},l(p){e=y(p,"DIV",{class:!0});var D=k(e);c&&c.l(D),l=z(D);for(let V=0;V<s.length;V+=1)s[V].l(D);D.forEach(m),i=z(p),o=y(p,"DIV",{class:!0}),k(o).forEach(m),a=z(p),_&&_.l(p),f=ce(),this.h()},h(){d(e,"class","w-full"),d(o,"class","pb-12")},m(p,D){E(p,e,D),c&&c.m(e,null),b(e,l);for(let V=0;V<s.length;V+=1)s[V]&&s[V].m(e,null);E(p,i,D),E(p,o,D),E(p,a,D),_&&_.m(p,D),E(p,f,D),u=!0},p(p,D){var V;D[0]&32768&&(t=((V=p[15].at(0))==null?void 0:V.parentId)!==null),t?c?(c.p(p,D),D[0]&32768&&v(c,1)):(c=An(p),c.c(),v(c,1),c.m(e,l)):c&&(te(),M(c,1,1,()=>{c=null}),le()),D[0]&536387549&&(g=Ve(p[15]),te(),s=Ht(s,D,h,1,p,g,r,e,Kt,Ln,null,Pn),le()),p[13]?_||(_=jn(),_.c(),_.m(f.parentNode,f)):_&&(_.d(1),_=null)},i(p){if(!u){v(c);for(let D=0;D<g.length;D+=1)v(s[D]);u=!0}},o(p){M(c);for(let D=0;D<s.length;D+=1)M(s[D]);u=!1},d(p){p&&(m(e),m(i),m(o),m(a),m(f)),c&&c.d();for(let D=0;D<s.length;D+=1)s[D].d();_&&_.d(p)}}}function Xf(n){let e,t,l,s,r;const i=[Zf,Kf],o=[];function a(f,u){var c;return u[0]&1&&(t=null),t==null&&(t=Object.keys(((c=f[0])==null?void 0:c.messages)??{}).length==0),t?0:1}return l=a(n,[-1,-1]),s=o[l]=i[l](n),{c(){e=w("div"),s.c(),this.h()},l(f){e=y(f,"DIV",{class:!0});var u=k(e);s.l(u),u.forEach(m),this.h()},h(){d(e,"class",n[1])},m(f,u){E(f,e,u),o[l].m(e,null),r=!0},p(f,u){let c=l;l=a(f,u),l===c?o[l].p(f,u):(te(),M(o[c],1,1,()=>{o[c]=null}),le(),s=o[l],s?s.p(f,u):(s=o[l]=i[l](f),s.c()),v(s,1),s.m(e,null)),(!r||u[0]&2)&&d(e,"class",f[1])},i(f){r||(v(s),r=!0)},o(f){M(s),r=!1},d(f){f&&m(e),o[l].d()}}}function Yf(n,e,t){let l,s,r,i,o;Ne(n,bt,A=>t(38,s=A)),Ne(n,kl,A=>t(39,r=A)),Ne(n,Zt,A=>t(40,i=A)),Ne(n,Ut,A=>t(41,o=A)),Vt();const a=Fe("i18n");Ne(n,a,A=>t(37,l=A));let{className:f="h-full flex pt-8"}=e,{chatId:u=""}=e,{user:c=o}=e,{prompt:g}=e,{history:h={}}=e,{selectedModels:_}=e,{atSelectedModel:T}=e,p=[],{setInputText:D=()=>{}}=e,{sendPrompt:V}=e,{continueResponse:L}=e,{regenerateResponse:O}=e,{mergeResponses:P}=e,{chatActionHandler:I}=e,{showMessage:N=()=>{}}=e,{submitMessage:S=()=>{}}=e,{addMessages:C=()=>{}}=e,{readOnly:B=!1}=e,{bottomPadding:F=!1}=e,{autoScroll:R}=e,{onSelect:Q=A=>{}}=e,_e=20,U=!1;const ne=async()=>{const A=document.getElementById("messages-container");A.scrollTop=A.scrollTop+100,t(16,U=!0),t(34,_e+=20),await Te(),t(16,U=!1)},fe=()=>{const A=document.getElementById("messages-container");A.scrollTop=A.scrollHeight},ue=async()=>{i||(t(0,h),await Te(),await Hr(localStorage.token,u,{history:h,messages:p}),kl.set(1),await Lr.set(await zr(localStorage.token,r)))},we=async(A,K)=>{let G;A.parentId!==null?G=h.messages[A.parentId].childrenIds:G=Object.values(h.messages).filter(be=>be.parentId===null).map(be=>be.id),K=Math.max(0,Math.min(K,G.length-1));let oe=G[K];if(A.id!==oe){let be=h.messages[oe].childrenIds;for(;be.length!==0;)oe=be.at(-1),be=h.messages[oe].childrenIds;t(0,h.currentId=oe,h)}if(await Te(),(s==null?void 0:s.scrollOnBranchChange)??!0){const be=document.getElementById("messages-container");t(29,R=be.scrollHeight-be.scrollTop<=be.clientHeight+50),setTimeout(()=>{fe()},100)}},X=async A=>{if(A.parentId!==null){let K=h.messages[A.parentId].childrenIds[Math.max(h.messages[A.parentId].childrenIds.indexOf(A.id)-1,0)];if(A.id!==K){let G=h.messages[K].childrenIds;for(;G.length!==0;)K=G.at(-1),G=h.messages[K].childrenIds;t(0,h.currentId=K,h)}}else{let K=Object.values(h.messages).filter(oe=>oe.parentId===null).map(oe=>oe.id),G=K[Math.max(K.indexOf(A.id)-1,0)];if(A.id!==G){let oe=h.messages[G].childrenIds;for(;oe.length!==0;)G=oe.at(-1),oe=h.messages[G].childrenIds;t(0,h.currentId=G,h)}}if(await Te(),(s==null?void 0:s.scrollOnBranchChange)??!0){const K=document.getElementById("messages-container");t(29,R=K.scrollHeight-K.scrollTop<=K.clientHeight+50),setTimeout(()=>{fe()},100)}},re=async A=>{if(A.parentId!==null){let K=h.messages[A.parentId].childrenIds[Math.min(h.messages[A.parentId].childrenIds.indexOf(A.id)+1,h.messages[A.parentId].childrenIds.length-1)];if(A.id!==K){let G=h.messages[K].childrenIds;for(;G.length!==0;)K=G.at(-1),G=h.messages[K].childrenIds;t(0,h.currentId=K,h)}}else{let K=Object.values(h.messages).filter(oe=>oe.parentId===null).map(oe=>oe.id),G=K[Math.min(K.indexOf(A.id)+1,K.length-1)];if(A.id!==G){let oe=h.messages[G].childrenIds;for(;oe.length!==0;)G=oe.at(-1),oe=h.messages[G].childrenIds;t(0,h.currentId=G,h)}}if(await Te(),(s==null?void 0:s.scrollOnBranchChange)??!0){const K=document.getElementById("messages-container");t(29,R=K.scrollHeight-K.scrollTop<=K.clientHeight+50),setTimeout(()=>{fe()},100)}},ge=async(A,K)=>{t(0,h.messages[A].annotation={...h.messages[A].annotation,rating:K},h),await ue()},ie=async(A,{content:K,files:G},oe=!0)=>{if((_??[]).filter(be=>be).length===0){je.error(l.t("Model not selected"));return}if(h.messages[A].role==="user")if(oe){let be=K,Ee=yl(),Me={id:Ee,parentId:h.messages[A].parentId,childrenIds:[],role:"user",content:be,...G&&{files:G},models:_,timestamp:Math.floor(Date.now()/1e3)},Oe=h.messages[A].parentId;Oe!==null&&t(0,h.messages[Oe].childrenIds=[...h.messages[Oe].childrenIds,Ee],h),t(0,h.messages[Ee]=Me,h),t(0,h.currentId=Ee,h),await Te(),await V(h,be,Ee)}else t(0,h.messages[A].content=K,h),t(0,h.messages[A].files=G,h),await ue();else if(oe){const be=yl(),Ee=h.messages[A],Me=Ee.parentId,Oe={...Ee,id:be,parentId:Me,childrenIds:[],files:void 0,content:K,timestamp:Math.floor(Date.now()/1e3)};t(0,h.messages[be]=Oe,h),t(0,h.currentId=be,h),Me!==null&&t(0,h.messages[Me].childrenIds=[...h.messages[Me].childrenIds,be],h),await ue()}else t(0,h.messages[A].originalContent=h.messages[A].content,h),t(0,h.messages[A].content=K,h),await ue()},de=async(A,K,G=null)=>{await I(u,A,K.model,K.id,G)},ke=async(A,K)=>{t(0,h.messages[A]=K,h),await ue()},ye=async A=>{const K=h.messages[A],G=K.parentId,oe=K.childrenIds??[],be=oe.flatMap(Ee=>{var Me;return((Me=h.messages[Ee])==null?void 0:Me.childrenIds)??[]});G&&h.messages[G]&&t(0,h.messages[G].childrenIds=[...h.messages[G].childrenIds.filter(Ee=>Ee!==A),...be],h),be.forEach(Ee=>{h.messages[Ee]&&t(0,h.messages[Ee].parentId=G,h)}),[A,...oe].forEach(Ee=>{delete h.messages[Ee]}),await Te(),N({id:G}),await ue()},J=()=>{if(R){const A=document.getElementById("messages-container");t(29,R=A.scrollHeight-A.scrollTop<=A.clientHeight+50),setTimeout(()=>{fe()},100)}},me=A=>{U||ne()};function ae(A){h=A,t(0,h)}return n.$$set=A=>{"className"in A&&t(1,f=A.className),"chatId"in A&&t(2,u=A.chatId),"user"in A&&t(3,c=A.user),"prompt"in A&&t(30,g=A.prompt),"history"in A&&t(0,h=A.history),"selectedModels"in A&&t(4,_=A.selectedModels),"atSelectedModel"in A&&t(5,T=A.atSelectedModel),"setInputText"in A&&t(6,D=A.setInputText),"sendPrompt"in A&&t(31,V=A.sendPrompt),"continueResponse"in A&&t(7,L=A.continueResponse),"regenerateResponse"in A&&t(8,O=A.regenerateResponse),"mergeResponses"in A&&t(9,P=A.mergeResponses),"chatActionHandler"in A&&t(32,I=A.chatActionHandler),"showMessage"in A&&t(33,N=A.showMessage),"submitMessage"in A&&t(10,S=A.submitMessage),"addMessages"in A&&t(11,C=A.addMessages),"readOnly"in A&&t(12,B=A.readOnly),"bottomPadding"in A&&t(13,F=A.bottomPadding),"autoScroll"in A&&t(29,R=A.autoScroll),"onSelect"in A&&t(14,Q=A.onSelect)},n.$$.update=()=>{if(n.$$.dirty[0]&1|n.$$.dirty[1]&8)if(h.currentId){let A=[],K=h.messages[h.currentId];for(;K&&A.length<=_e;)A.unshift({...K}),K=K.parentId!==null?h.messages[K.parentId]:null;t(15,p=A)}else t(15,p=[]);n.$$.dirty[0]&536879104&&R&&F&&(async()=>(await Te(),fe()))()},[h,f,u,c,_,T,D,L,O,P,S,C,B,F,Q,p,U,a,ne,ue,we,X,re,ge,ie,de,ke,ye,J,R,g,V,I,N,_e,me,ae]}class Pu extends Ae{constructor(e){super(),Le(this,e,Yf,Xf,Se,{className:1,chatId:2,user:3,prompt:30,history:0,selectedModels:4,atSelectedModel:5,setInputText:6,sendPrompt:31,continueResponse:7,regenerateResponse:8,mergeResponses:9,chatActionHandler:32,showMessage:33,submitMessage:10,addMessages:11,readOnly:12,bottomPadding:13,autoScroll:29,onSelect:14},null,[-1,-1])}}export{ja as K,Pu as M,Pf as S};
//# sourceMappingURL=CQwG-mXl.js.map
